var x7=Object.create;var mm=Object.defineProperty,E7=Object.defineProperties,_7=Object.getOwnPropertyDescriptor,b7=Object.getOwnPropertyDescriptors,M7=Object.getOwnPropertyNames,oR=Object.getOwnPropertySymbols,w7=Object.getPrototypeOf,cR=Object.prototype.hasOwnProperty,C7=Object.prototype.propertyIsEnumerable;var aR=(n,e,t)=>e in n?mm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,di=(n,e)=>{for(var t in e||={})cR.call(e,t)&&aR(n,t,e[t]);if(oR)for(var t of oR(e))C7.call(e,t)&&aR(n,t,e[t]);return n},As=(n,e)=>E7(n,b7(e));var zc=(n,e)=>()=>(n&&(e=n(n=0)),e);var Cr=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),S7=(n,e)=>{for(var t in e)mm(n,t,{get:e[t],enumerable:!0})},lR=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of M7(e))!cR.call(n,s)&&s!==t&&mm(n,s,{get:()=>e[s],enumerable:!(i=_7(e,s))||i.enumerable});return n};var uR=(n,e,t)=>(t=n!=null?x7(w7(n)):{},lR(e||!n||!n.__esModule?mm(t,"default",{value:n,enumerable:!0}):t,n)),h1=n=>lR(mm({},"__esModule",{value:!0}),n);var So=(n,e,t)=>new Promise((i,s)=>{var o=u=>{try{l(t.next(u))}catch(h){s(h)}},c=u=>{try{l(t.throw(u))}catch(h){s(h)}},l=u=>u.done?i(u.value):Promise.resolve(u.value).then(o,c);l((t=t.apply(n,e)).next())});var LP=Cr((iy,aw)=>{"use strict";(function(e,t){typeof iy=="object"&&typeof aw=="object"?aw.exports=t():typeof define=="function"&&define.amd?define([],t):typeof iy=="object"?iy.AFRAME=t():e.AFRAME=t()})(self,()=>(()=>{var n={"./node_modules/@ungap/custom-elements/index.js":()=>{(function(){"use strict";var s=function(en,xt){var jt=function(Kn){for(var Gn=0,fi=Kn.length;Gn<fi;Gn++)Pn(Kn[Gn])},Pn=function(Kn){var Gn=Kn.target,fi=Kn.attributeName,xi=Kn.oldValue;Gn.attributeChangedCallback(fi,xi,Gn.getAttribute(fi))};return function(In,Kn){var Gn=In.constructor.observedAttributes;return Gn&&en(Kn).then(function(){new xt(jt).observe(In,{attributes:!0,attributeOldValue:!0,attributeFilter:Gn});for(var fi=0,xi=Gn.length;fi<xi;fi++)In.hasAttribute(Gn[fi])&&Pn({target:In,attributeName:Gn[fi],oldValue:null})}),In}};function o(en,xt){if(en){if(typeof en=="string")return c(en,xt);var jt=Object.prototype.toString.call(en).slice(8,-1);if(jt==="Object"&&en.constructor&&(jt=en.constructor.name),jt==="Map"||jt==="Set")return Array.from(en);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return c(en,xt)}}function c(en,xt){(xt==null||xt>en.length)&&(xt=en.length);for(var jt=0,Pn=new Array(xt);jt<xt;jt++)Pn[jt]=en[jt];return Pn}function l(en,xt){var jt=typeof Symbol<"u"&&en[Symbol.iterator]||en["@@iterator"];if(!jt){if(Array.isArray(en)||(jt=o(en))||xt&&en&&typeof en.length=="number"){jt&&(en=jt);var Pn=0,In=function(){};return{s:In,n:function(){return Pn>=en.length?{done:!0}:{done:!1,value:en[Pn++]}},e:function(xi){throw xi},f:In}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Kn=!0,Gn=!1,fi;return{s:function(){jt=jt.call(en)},n:function(){var xi=jt.next();return Kn=xi.done,xi},e:function(xi){Gn=!0,fi=xi},f:function(){try{!Kn&&jt.return!=null&&jt.return()}finally{if(Gn)throw fi}}}}var u=!0,h=!1,p="querySelectorAll",f=function(xt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,Pn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:MutationObserver,In=arguments.length>3&&arguments[3]!==void 0?arguments[3]:["*"],Kn=function xi(Ti,ir,dr,Ai,Mi,ne){var Y=l(Ti),le;try{for(Y.s();!(le=Y.n()).done;){var me=le.value;(ne||p in me)&&(Mi?dr.has(me)||(dr.add(me),Ai.delete(me),xt(me,Mi)):Ai.has(me)||(Ai.add(me),dr.delete(me),xt(me,Mi)),ne||xi(me[p](ir),ir,dr,Ai,Mi,u))}}catch(_e){Y.e(_e)}finally{Y.f()}},Gn=new Pn(function(xi){if(In.length){var Ti=In.join(","),ir=new Set,dr=new Set,Ai=l(xi),Mi;try{for(Ai.s();!(Mi=Ai.n()).done;){var ne=Mi.value,Y=ne.addedNodes,le=ne.removedNodes;Kn(le,Ti,ir,dr,h,h),Kn(Y,Ti,ir,dr,u,h)}}catch(me){Ai.e(me)}finally{Ai.f()}}}),fi=Gn.observe;return(Gn.observe=function(xi){return fi.call(Gn,xi,{subtree:u,childList:u})})(jt),Gn},m="querySelectorAll",A=self,y=A.document,E=A.Element,x=A.MutationObserver,v=A.Set,w=A.WeakMap,M=function(xt){return m in xt},T=[].filter,D=function(en){var xt=new w,jt=function(Ai){for(var Mi=0,ne=Ai.length;Mi<ne;Mi++)xt.delete(Ai[Mi])},Pn=function(){for(var Ai=Ti.takeRecords(),Mi=0,ne=Ai.length;Mi<ne;Mi++)Gn(T.call(Ai[Mi].removedNodes,M),!1),Gn(T.call(Ai[Mi].addedNodes,M),!0)},In=function(Ai){return Ai.matches||Ai.webkitMatchesSelector||Ai.msMatchesSelector},Kn=function(Ai,Mi){var ne;if(Mi)for(var Y,le=In(Ai),me=0,_e=fi.length;me<_e;me++)le.call(Ai,Y=fi[me])&&(xt.has(Ai)||xt.set(Ai,new v),ne=xt.get(Ai),ne.has(Y)||(ne.add(Y),en.handle(Ai,Mi,Y)));else xt.has(Ai)&&(ne=xt.get(Ai),xt.delete(Ai),ne.forEach(function(Xe){en.handle(Ai,Mi,Xe)}))},Gn=function(Ai){for(var Mi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ne=0,Y=Ai.length;ne<Y;ne++)Kn(Ai[ne],Mi)},fi=en.query,xi=en.root||y,Ti=f(Kn,xi,x,fi),ir=E.prototype.attachShadow;return ir&&(E.prototype.attachShadow=function(dr){var Ai=ir.call(this,dr);return Ti.observe(Ai),Ai}),fi.length&&Gn(xi[m](fi)),{drop:jt,flush:Pn,observer:Ti,parse:Gn}},L=self,I=L.document,F=L.Map,R=L.MutationObserver,N=L.Object,X=L.Set,$=L.WeakMap,te=L.Element,U=L.HTMLElement,P=L.Node,k=L.Error,z=L.TypeError,Q=L.Reflect,Z=N.defineProperty,ce=N.keys,Me=N.getOwnPropertyNames,xe=N.setPrototypeOf,be=!self.customElements,Fe=function(xt){for(var jt=ce(xt),Pn=[],In=jt.length,Kn=0;Kn<In;Kn++)Pn[Kn]=xt[jt[Kn]],delete xt[jt[Kn]];return function(){for(var Gn=0;Gn<In;Gn++)xt[jt[Gn]]=Pn[Gn]}};if(be){var Ze=function(){var xt=this.constructor;if(!it.has(xt))throw new z("Illegal constructor");var jt=it.get(xt);if(Vt)return xn(Vt,jt);var Pn=ut.call(I,jt);return xn(xe(Pn,xt.prototype),jt)},ut=I.createElement,it=new F,gt=new F,Rt=new F,It=new F,Ft=[],Ne=function(xt,jt,Pn){var In=Rt.get(Pn);if(jt&&!In.isPrototypeOf(xt)){var Kn=Fe(xt);Vt=xe(xt,In);try{new In.constructor}finally{Vt=null,Kn()}}var Gn="".concat(jt?"":"dis","connectedCallback");Gn in In&&xt[Gn]()},pn=D({query:Ft,handle:Ne}),St=pn.parse,Vt=null,Ot=function(xt){if(!gt.has(xt)){var jt,Pn=new Promise(function(In){jt=In});gt.set(xt,{$:Pn,_:jt})}return gt.get(xt).$},xn=s(Ot,R);Z(self,"customElements",{configurable:!0,value:{define:function(xt,jt){if(It.has(xt))throw new k('the name "'.concat(xt,'" has already been used with this registry'));it.set(jt,xt),Rt.set(xt,jt.prototype),It.set(xt,jt),Ft.push(xt),Ot(xt).then(function(){St(I.querySelectorAll(xt))}),gt.get(xt)._(jt)},get:function(xt){return It.get(xt)},whenDefined:Ot}}),Z(Ze.prototype=U.prototype,"constructor",{value:Ze}),Z(self,"HTMLElement",{configurable:!0,value:Ze}),Z(I,"createElement",{configurable:!0,value:function(xt,jt){var Pn=jt&&jt.is,In=Pn?It.get(Pn):It.get(xt);return In?new In:ut.call(I,xt)}}),"isConnected"in P.prototype||Z(P.prototype,"isConnected",{configurable:!0,get:function(){return!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}else if(be=!self.customElements.get("extends-li"),be)try{var Jt=function en(){return self.Reflect.construct(HTMLLIElement,[],en)};Jt.prototype=HTMLLIElement.prototype;var Oe="extends-li";self.customElements.define("extends-li",Jt,{extends:"li"}),be=I.createElement("li",{is:Oe}).outerHTML.indexOf(Oe)<0;var Ie=self.customElements,yt=Ie.get,kt=Ie.whenDefined;Z(self.customElements,"whenDefined",{configurable:!0,value:function(xt){var jt=this;return kt.call(this,xt).then(function(Pn){return Pn||yt.call(jt,xt)})}})}catch{}if(be){var De=function(xt){var jt=ze.get(xt);ot(jt.querySelectorAll(this),xt.isConnected)},he=self.customElements,ae=I.createElement,de=he.define,we=he.get,Ae=he.upgrade,Le=Q||{construct:function(xt){return xt.call(this)}},Ee=Le.construct,ze=new $,Ge=new X,ee=new F,V=new F,G=new F,pe=new F,Ue=[],Qe=[],$e=function(xt){return pe.get(xt)||we.call(he,xt)},nt=function(xt,jt,Pn){var In=G.get(Pn);if(jt&&!In.isPrototypeOf(xt)){var Kn=Fe(xt);Cn=xe(xt,In);try{new In.constructor}finally{Cn=null,Kn()}}var Gn="".concat(jt?"":"dis","connectedCallback");Gn in In&&xt[Gn]()},ge=D({query:Qe,handle:nt}),ot=ge.parse,et=D({query:Ue,handle:function(xt,jt){ze.has(xt)&&(jt?Ge.add(xt):Ge.delete(xt),Qe.length&&De.call(Qe,xt))}}),tt=et.parse,_t=te.prototype.attachShadow;_t&&(te.prototype.attachShadow=function(en){var xt=_t.call(this,en);return ze.set(this,xt),xt});var tn=function(xt){if(!V.has(xt)){var jt,Pn=new Promise(function(In){jt=In});V.set(xt,{$:Pn,_:jt})}return V.get(xt).$},En=s(tn,R),Cn=null;Me(self).filter(function(en){return/^HTML.*Element$/.test(en)}).forEach(function(en){var xt=self[en];function jt(){var Pn=this.constructor;if(!ee.has(Pn))throw new z("Illegal constructor");var In=ee.get(Pn),Kn=In.is,Gn=In.tag;if(Kn){if(Cn)return En(Cn,Kn);var fi=ae.call(I,Gn);return fi.setAttribute("is",Kn),En(xe(fi,Pn.prototype),Kn)}else return Ee.call(this,xt,[],Pn)}Z(jt.prototype=xt.prototype,"constructor",{value:jt}),Z(self,en,{value:jt})}),Z(I,"createElement",{configurable:!0,value:function(xt,jt){var Pn=jt&&jt.is;if(Pn){var In=pe.get(Pn);if(In&&ee.get(In).tag===xt)return new In}var Kn=ae.call(I,xt);return Pn&&Kn.setAttribute("is",Pn),Kn}}),Z(he,"get",{configurable:!0,value:$e}),Z(he,"whenDefined",{configurable:!0,value:tn}),Z(he,"upgrade",{configurable:!0,value:function(xt){var jt=xt.getAttribute("is");if(jt){var Pn=pe.get(jt);if(Pn){En(xe(xt,Pn.prototype),jt);return}}Ae.call(he,xt)}}),Z(he,"define",{configurable:!0,value:function(xt,jt,Pn){if($e(xt))throw new k("'".concat(xt,"' has already been defined as a custom element"));var In,Kn=Pn&&Pn.extends;ee.set(jt,Kn?{is:xt,tag:Kn}:{is:"",tag:xt}),Kn?(In="".concat(Kn,'[is="').concat(xt,'"]'),G.set(In,jt.prototype),pe.set(xt,jt),Qe.push(In)):(de.apply(he,arguments),Ue.push(In=xt)),tn(xt).then(function(){Kn?(ot(I.querySelectorAll(In)),Ge.forEach(De,[In])):tt(I.querySelectorAll(In))}),V.get(xt)._(jt)}})}})()},"./node_modules/an-array/index.js":s=>{var o=Object.prototype.toString;s.exports=c;function c(l){return l.BYTES_PER_ELEMENT&&o.call(l.buffer)==="[object ArrayBuffer]"||Array.isArray(l)}},"./node_modules/as-number/index.js":s=>{s.exports=function(c,l){return typeof c=="number"?c:typeof l=="number"?l:0}},"./node_modules/base64-js/index.js":(s,o)=>{"use strict";o.byteLength=A,o.toByteArray=E,o.fromByteArray=w;for(var c=[],l=[],u=typeof Uint8Array<"u"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,f=h.length;p<f;++p)c[p]=h[p],l[h.charCodeAt(p)]=p;l[45]=62,l[95]=63;function m(M){var T=M.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var D=M.indexOf("=");D===-1&&(D=T);var L=D===T?0:4-D%4;return[D,L]}function A(M){var T=m(M),D=T[0],L=T[1];return(D+L)*3/4-L}function y(M,T,D){return(T+D)*3/4-D}function E(M){var T,D=m(M),L=D[0],I=D[1],F=new u(y(M,L,I)),R=0,N=I>0?L-4:L,X;for(X=0;X<N;X+=4)T=l[M.charCodeAt(X)]<<18|l[M.charCodeAt(X+1)]<<12|l[M.charCodeAt(X+2)]<<6|l[M.charCodeAt(X+3)],F[R++]=T>>16&255,F[R++]=T>>8&255,F[R++]=T&255;return I===2&&(T=l[M.charCodeAt(X)]<<2|l[M.charCodeAt(X+1)]>>4,F[R++]=T&255),I===1&&(T=l[M.charCodeAt(X)]<<10|l[M.charCodeAt(X+1)]<<4|l[M.charCodeAt(X+2)]>>2,F[R++]=T>>8&255,F[R++]=T&255),F}function x(M){return c[M>>18&63]+c[M>>12&63]+c[M>>6&63]+c[M&63]}function v(M,T,D){for(var L,I=[],F=T;F<D;F+=3)L=(M[F]<<16&16711680)+(M[F+1]<<8&65280)+(M[F+2]&255),I.push(x(L));return I.join("")}function w(M){for(var T,D=M.length,L=D%3,I=[],F=16383,R=0,N=D-L;R<N;R+=F)I.push(v(M,R,R+F>N?N:R+F));return L===1?(T=M[D-1],I.push(c[T>>2]+c[T<<4&63]+"==")):L===2&&(T=(M[D-2]<<8)+M[D-1],I.push(c[T>>10]+c[T>>4&63]+c[T<<2&63]+"=")),I.join("")}},"./node_modules/buffer-equal/index.js":(s,o,c)=>{var l=c("./node_modules/buffer/index.js").Buffer;s.exports=function(u,h){if(l.isBuffer(u)&&l.isBuffer(h)){if(typeof u.equals=="function")return u.equals(h);if(u.length!==h.length)return!1;for(var p=0;p<u.length;p++)if(u[p]!==h[p])return!1;return!0}}},"./node_modules/buffer/index.js":(s,o,c)=>{"use strict";let l=c("./node_modules/base64-js/index.js"),u=c("./node_modules/ieee754/index.js"),h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;o.Buffer=A,o.SlowBuffer=F,o.INSPECT_MAX_BYTES=50;let p=2147483647;o.kMaxLength=p,A.TYPED_ARRAY_SUPPORT=f(),!A.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{let ee=new Uint8Array(1),V={foo:function(){return 42}};return Object.setPrototypeOf(V,Uint8Array.prototype),Object.setPrototypeOf(ee,V),ee.foo()===42}catch{return!1}}Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.buffer}}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.byteOffset}});function m(ee){if(ee>p)throw new RangeError('The value "'+ee+'" is invalid for option "size"');let V=new Uint8Array(ee);return Object.setPrototypeOf(V,A.prototype),V}function A(ee,V,G){if(typeof ee=="number"){if(typeof V=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(ee)}return y(ee,V,G)}A.poolSize=8192;function y(ee,V,G){if(typeof ee=="string")return w(ee,V);if(ArrayBuffer.isView(ee))return T(ee);if(ee==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee);if(Ae(ee,ArrayBuffer)||ee&&Ae(ee.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ae(ee,SharedArrayBuffer)||ee&&Ae(ee.buffer,SharedArrayBuffer)))return D(ee,V,G);if(typeof ee=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let pe=ee.valueOf&&ee.valueOf();if(pe!=null&&pe!==ee)return A.from(pe,V,G);let Ue=L(ee);if(Ue)return Ue;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ee[Symbol.toPrimitive]=="function")return A.from(ee[Symbol.toPrimitive]("string"),V,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee)}A.from=function(ee,V,G){return y(ee,V,G)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array);function E(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be of type number');if(ee<0)throw new RangeError('The value "'+ee+'" is invalid for option "size"')}function x(ee,V,G){return E(ee),ee<=0?m(ee):V!==void 0?typeof G=="string"?m(ee).fill(V,G):m(ee).fill(V):m(ee)}A.alloc=function(ee,V,G){return x(ee,V,G)};function v(ee){return E(ee),m(ee<0?0:I(ee)|0)}A.allocUnsafe=function(ee){return v(ee)},A.allocUnsafeSlow=function(ee){return v(ee)};function w(ee,V){if((typeof V!="string"||V==="")&&(V="utf8"),!A.isEncoding(V))throw new TypeError("Unknown encoding: "+V);let G=R(ee,V)|0,pe=m(G),Ue=pe.write(ee,V);return Ue!==G&&(pe=pe.slice(0,Ue)),pe}function M(ee){let V=ee.length<0?0:I(ee.length)|0,G=m(V);for(let pe=0;pe<V;pe+=1)G[pe]=ee[pe]&255;return G}function T(ee){if(Ae(ee,Uint8Array)){let V=new Uint8Array(ee);return D(V.buffer,V.byteOffset,V.byteLength)}return M(ee)}function D(ee,V,G){if(V<0||ee.byteLength<V)throw new RangeError('"offset" is outside of buffer bounds');if(ee.byteLength<V+(G||0))throw new RangeError('"length" is outside of buffer bounds');let pe;return V===void 0&&G===void 0?pe=new Uint8Array(ee):G===void 0?pe=new Uint8Array(ee,V):pe=new Uint8Array(ee,V,G),Object.setPrototypeOf(pe,A.prototype),pe}function L(ee){if(A.isBuffer(ee)){let V=I(ee.length)|0,G=m(V);return G.length===0||ee.copy(G,0,0,V),G}if(ee.length!==void 0)return typeof ee.length!="number"||Le(ee.length)?m(0):M(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return M(ee.data)}function I(ee){if(ee>=p)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+p.toString(16)+" bytes");return ee|0}function F(ee){return+ee!=ee&&(ee=0),A.alloc(+ee)}A.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==A.prototype},A.compare=function(V,G){if(Ae(V,Uint8Array)&&(V=A.from(V,V.offset,V.byteLength)),Ae(G,Uint8Array)&&(G=A.from(G,G.offset,G.byteLength)),!A.isBuffer(V)||!A.isBuffer(G))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===G)return 0;let pe=V.length,Ue=G.length;for(let Qe=0,$e=Math.min(pe,Ue);Qe<$e;++Qe)if(V[Qe]!==G[Qe]){pe=V[Qe],Ue=G[Qe];break}return pe<Ue?-1:Ue<pe?1:0},A.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(V,G){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return A.alloc(0);let pe;if(G===void 0)for(G=0,pe=0;pe<V.length;++pe)G+=V[pe].length;let Ue=A.allocUnsafe(G),Qe=0;for(pe=0;pe<V.length;++pe){let $e=V[pe];if(Ae($e,Uint8Array))Qe+$e.length>Ue.length?(A.isBuffer($e)||($e=A.from($e)),$e.copy(Ue,Qe)):Uint8Array.prototype.set.call(Ue,$e,Qe);else if(A.isBuffer($e))$e.copy(Ue,Qe);else throw new TypeError('"list" argument must be an Array of Buffers');Qe+=$e.length}return Ue};function R(ee,V){if(A.isBuffer(ee))return ee.length;if(ArrayBuffer.isView(ee)||Ae(ee,ArrayBuffer))return ee.byteLength;if(typeof ee!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ee);let G=ee.length,pe=arguments.length>2&&arguments[2]===!0;if(!pe&&G===0)return 0;let Ue=!1;for(;;)switch(V){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return De(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G*2;case"hex":return G>>>1;case"base64":return de(ee).length;default:if(Ue)return pe?-1:De(ee).length;V=(""+V).toLowerCase(),Ue=!0}}A.byteLength=R;function N(ee,V,G){let pe=!1;if((V===void 0||V<0)&&(V=0),V>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0,V>>>=0,G<=V))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return Ze(this,V,G);case"utf8":case"utf-8":return ce(this,V,G);case"ascii":return be(this,V,G);case"latin1":case"binary":return Fe(this,V,G);case"base64":return Z(this,V,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,V,G);default:if(pe)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),pe=!0}}A.prototype._isBuffer=!0;function X(ee,V,G){let pe=ee[V];ee[V]=ee[G],ee[G]=pe}A.prototype.swap16=function(){let V=this.length;if(V%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let G=0;G<V;G+=2)X(this,G,G+1);return this},A.prototype.swap32=function(){let V=this.length;if(V%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let G=0;G<V;G+=4)X(this,G,G+3),X(this,G+1,G+2);return this},A.prototype.swap64=function(){let V=this.length;if(V%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let G=0;G<V;G+=8)X(this,G,G+7),X(this,G+1,G+6),X(this,G+2,G+5),X(this,G+3,G+4);return this},A.prototype.toString=function(){let V=this.length;return V===0?"":arguments.length===0?ce(this,0,V):N.apply(this,arguments)},A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=function(V){if(!A.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V?!0:A.compare(this,V)===0},A.prototype.inspect=function(){let V="",G=o.INSPECT_MAX_BYTES;return V=this.toString("hex",0,G).replace(/(.{2})/g,"$1 ").trim(),this.length>G&&(V+=" ... "),"<Buffer "+V+">"},h&&(A.prototype[h]=A.prototype.inspect),A.prototype.compare=function(V,G,pe,Ue,Qe){if(Ae(V,Uint8Array)&&(V=A.from(V,V.offset,V.byteLength)),!A.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(G===void 0&&(G=0),pe===void 0&&(pe=V?V.length:0),Ue===void 0&&(Ue=0),Qe===void 0&&(Qe=this.length),G<0||pe>V.length||Ue<0||Qe>this.length)throw new RangeError("out of range index");if(Ue>=Qe&&G>=pe)return 0;if(Ue>=Qe)return-1;if(G>=pe)return 1;if(G>>>=0,pe>>>=0,Ue>>>=0,Qe>>>=0,this===V)return 0;let $e=Qe-Ue,nt=pe-G,ge=Math.min($e,nt),ot=this.slice(Ue,Qe),et=V.slice(G,pe);for(let tt=0;tt<ge;++tt)if(ot[tt]!==et[tt]){$e=ot[tt],nt=et[tt];break}return $e<nt?-1:nt<$e?1:0};function $(ee,V,G,pe,Ue){if(ee.length===0)return-1;if(typeof G=="string"?(pe=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),G=+G,Le(G)&&(G=Ue?0:ee.length-1),G<0&&(G=ee.length+G),G>=ee.length){if(Ue)return-1;G=ee.length-1}else if(G<0)if(Ue)G=0;else return-1;if(typeof V=="string"&&(V=A.from(V,pe)),A.isBuffer(V))return V.length===0?-1:te(ee,V,G,pe,Ue);if(typeof V=="number")return V=V&255,typeof Uint8Array.prototype.indexOf=="function"?Ue?Uint8Array.prototype.indexOf.call(ee,V,G):Uint8Array.prototype.lastIndexOf.call(ee,V,G):te(ee,[V],G,pe,Ue);throw new TypeError("val must be string, number or Buffer")}function te(ee,V,G,pe,Ue){let Qe=1,$e=ee.length,nt=V.length;if(pe!==void 0&&(pe=String(pe).toLowerCase(),pe==="ucs2"||pe==="ucs-2"||pe==="utf16le"||pe==="utf-16le")){if(ee.length<2||V.length<2)return-1;Qe=2,$e/=2,nt/=2,G/=2}function ge(et,tt){return Qe===1?et[tt]:et.readUInt16BE(tt*Qe)}let ot;if(Ue){let et=-1;for(ot=G;ot<$e;ot++)if(ge(ee,ot)===ge(V,et===-1?0:ot-et)){if(et===-1&&(et=ot),ot-et+1===nt)return et*Qe}else et!==-1&&(ot-=ot-et),et=-1}else for(G+nt>$e&&(G=$e-nt),ot=G;ot>=0;ot--){let et=!0;for(let tt=0;tt<nt;tt++)if(ge(ee,ot+tt)!==ge(V,tt)){et=!1;break}if(et)return ot}return-1}A.prototype.includes=function(V,G,pe){return this.indexOf(V,G,pe)!==-1},A.prototype.indexOf=function(V,G,pe){return $(this,V,G,pe,!0)},A.prototype.lastIndexOf=function(V,G,pe){return $(this,V,G,pe,!1)};function U(ee,V,G,pe){G=Number(G)||0;let Ue=ee.length-G;pe?(pe=Number(pe),pe>Ue&&(pe=Ue)):pe=Ue;let Qe=V.length;pe>Qe/2&&(pe=Qe/2);let $e;for($e=0;$e<pe;++$e){let nt=parseInt(V.substr($e*2,2),16);if(Le(nt))return $e;ee[G+$e]=nt}return $e}function P(ee,V,G,pe){return we(De(V,ee.length-G),ee,G,pe)}function k(ee,V,G,pe){return we(he(V),ee,G,pe)}function z(ee,V,G,pe){return we(de(V),ee,G,pe)}function Q(ee,V,G,pe){return we(ae(V,ee.length-G),ee,G,pe)}A.prototype.write=function(V,G,pe,Ue){if(G===void 0)Ue="utf8",pe=this.length,G=0;else if(pe===void 0&&typeof G=="string")Ue=G,pe=this.length,G=0;else if(isFinite(G))G=G>>>0,isFinite(pe)?(pe=pe>>>0,Ue===void 0&&(Ue="utf8")):(Ue=pe,pe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let Qe=this.length-G;if((pe===void 0||pe>Qe)&&(pe=Qe),V.length>0&&(pe<0||G<0)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ue||(Ue="utf8");let $e=!1;for(;;)switch(Ue){case"hex":return U(this,V,G,pe);case"utf8":case"utf-8":return P(this,V,G,pe);case"ascii":case"latin1":case"binary":return k(this,V,G,pe);case"base64":return z(this,V,G,pe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,V,G,pe);default:if($e)throw new TypeError("Unknown encoding: "+Ue);Ue=(""+Ue).toLowerCase(),$e=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Z(ee,V,G){return V===0&&G===ee.length?l.fromByteArray(ee):l.fromByteArray(ee.slice(V,G))}function ce(ee,V,G){G=Math.min(ee.length,G);let pe=[],Ue=V;for(;Ue<G;){let Qe=ee[Ue],$e=null,nt=Qe>239?4:Qe>223?3:Qe>191?2:1;if(Ue+nt<=G){let ge,ot,et,tt;switch(nt){case 1:Qe<128&&($e=Qe);break;case 2:ge=ee[Ue+1],(ge&192)===128&&(tt=(Qe&31)<<6|ge&63,tt>127&&($e=tt));break;case 3:ge=ee[Ue+1],ot=ee[Ue+2],(ge&192)===128&&(ot&192)===128&&(tt=(Qe&15)<<12|(ge&63)<<6|ot&63,tt>2047&&(tt<55296||tt>57343)&&($e=tt));break;case 4:ge=ee[Ue+1],ot=ee[Ue+2],et=ee[Ue+3],(ge&192)===128&&(ot&192)===128&&(et&192)===128&&(tt=(Qe&15)<<18|(ge&63)<<12|(ot&63)<<6|et&63,tt>65535&&tt<1114112&&($e=tt))}}$e===null?($e=65533,nt=1):$e>65535&&($e-=65536,pe.push($e>>>10&1023|55296),$e=56320|$e&1023),pe.push($e),Ue+=nt}return xe(pe)}let Me=4096;function xe(ee){let V=ee.length;if(V<=Me)return String.fromCharCode.apply(String,ee);let G="",pe=0;for(;pe<V;)G+=String.fromCharCode.apply(String,ee.slice(pe,pe+=Me));return G}function be(ee,V,G){let pe="";G=Math.min(ee.length,G);for(let Ue=V;Ue<G;++Ue)pe+=String.fromCharCode(ee[Ue]&127);return pe}function Fe(ee,V,G){let pe="";G=Math.min(ee.length,G);for(let Ue=V;Ue<G;++Ue)pe+=String.fromCharCode(ee[Ue]);return pe}function Ze(ee,V,G){let pe=ee.length;(!V||V<0)&&(V=0),(!G||G<0||G>pe)&&(G=pe);let Ue="";for(let Qe=V;Qe<G;++Qe)Ue+=Ee[ee[Qe]];return Ue}function ut(ee,V,G){let pe=ee.slice(V,G),Ue="";for(let Qe=0;Qe<pe.length-1;Qe+=2)Ue+=String.fromCharCode(pe[Qe]+pe[Qe+1]*256);return Ue}A.prototype.slice=function(V,G){let pe=this.length;V=~~V,G=G===void 0?pe:~~G,V<0?(V+=pe,V<0&&(V=0)):V>pe&&(V=pe),G<0?(G+=pe,G<0&&(G=0)):G>pe&&(G=pe),G<V&&(G=V);let Ue=this.subarray(V,G);return Object.setPrototypeOf(Ue,A.prototype),Ue};function it(ee,V,G){if(ee%1!==0||ee<0)throw new RangeError("offset is not uint");if(ee+V>G)throw new RangeError("Trying to access beyond buffer length")}A.prototype.readUintLE=A.prototype.readUIntLE=function(V,G,pe){V=V>>>0,G=G>>>0,pe||it(V,G,this.length);let Ue=this[V],Qe=1,$e=0;for(;++$e<G&&(Qe*=256);)Ue+=this[V+$e]*Qe;return Ue},A.prototype.readUintBE=A.prototype.readUIntBE=function(V,G,pe){V=V>>>0,G=G>>>0,pe||it(V,G,this.length);let Ue=this[V+--G],Qe=1;for(;G>0&&(Qe*=256);)Ue+=this[V+--G]*Qe;return Ue},A.prototype.readUint8=A.prototype.readUInt8=function(V,G){return V=V>>>0,G||it(V,1,this.length),this[V]},A.prototype.readUint16LE=A.prototype.readUInt16LE=function(V,G){return V=V>>>0,G||it(V,2,this.length),this[V]|this[V+1]<<8},A.prototype.readUint16BE=A.prototype.readUInt16BE=function(V,G){return V=V>>>0,G||it(V,2,this.length),this[V]<<8|this[V+1]},A.prototype.readUint32LE=A.prototype.readUInt32LE=function(V,G){return V=V>>>0,G||it(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+this[V+3]*16777216},A.prototype.readUint32BE=A.prototype.readUInt32BE=function(V,G){return V=V>>>0,G||it(V,4,this.length),this[V]*16777216+(this[V+1]<<16|this[V+2]<<8|this[V+3])},A.prototype.readBigUInt64LE=ze(function(V){V=V>>>0,Oe(V,"offset");let G=this[V],pe=this[V+7];(G===void 0||pe===void 0)&&Ie(V,this.length-8);let Ue=G+this[++V]*2**8+this[++V]*2**16+this[++V]*2**24,Qe=this[++V]+this[++V]*2**8+this[++V]*2**16+pe*2**24;return BigInt(Ue)+(BigInt(Qe)<<BigInt(32))}),A.prototype.readBigUInt64BE=ze(function(V){V=V>>>0,Oe(V,"offset");let G=this[V],pe=this[V+7];(G===void 0||pe===void 0)&&Ie(V,this.length-8);let Ue=G*2**24+this[++V]*2**16+this[++V]*2**8+this[++V],Qe=this[++V]*2**24+this[++V]*2**16+this[++V]*2**8+pe;return(BigInt(Ue)<<BigInt(32))+BigInt(Qe)}),A.prototype.readIntLE=function(V,G,pe){V=V>>>0,G=G>>>0,pe||it(V,G,this.length);let Ue=this[V],Qe=1,$e=0;for(;++$e<G&&(Qe*=256);)Ue+=this[V+$e]*Qe;return Qe*=128,Ue>=Qe&&(Ue-=Math.pow(2,8*G)),Ue},A.prototype.readIntBE=function(V,G,pe){V=V>>>0,G=G>>>0,pe||it(V,G,this.length);let Ue=G,Qe=1,$e=this[V+--Ue];for(;Ue>0&&(Qe*=256);)$e+=this[V+--Ue]*Qe;return Qe*=128,$e>=Qe&&($e-=Math.pow(2,8*G)),$e},A.prototype.readInt8=function(V,G){return V=V>>>0,G||it(V,1,this.length),this[V]&128?(255-this[V]+1)*-1:this[V]},A.prototype.readInt16LE=function(V,G){V=V>>>0,G||it(V,2,this.length);let pe=this[V]|this[V+1]<<8;return pe&32768?pe|4294901760:pe},A.prototype.readInt16BE=function(V,G){V=V>>>0,G||it(V,2,this.length);let pe=this[V+1]|this[V]<<8;return pe&32768?pe|4294901760:pe},A.prototype.readInt32LE=function(V,G){return V=V>>>0,G||it(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},A.prototype.readInt32BE=function(V,G){return V=V>>>0,G||it(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},A.prototype.readBigInt64LE=ze(function(V){V=V>>>0,Oe(V,"offset");let G=this[V],pe=this[V+7];(G===void 0||pe===void 0)&&Ie(V,this.length-8);let Ue=this[V+4]+this[V+5]*2**8+this[V+6]*2**16+(pe<<24);return(BigInt(Ue)<<BigInt(32))+BigInt(G+this[++V]*256+this[++V]*65536+this[++V]*16777216)}),A.prototype.readBigInt64BE=ze(function(V){V=V>>>0,Oe(V,"offset");let G=this[V],pe=this[V+7];(G===void 0||pe===void 0)&&Ie(V,this.length-8);let Ue=(G<<24)+this[++V]*2**16+this[++V]*2**8+this[++V];return(BigInt(Ue)<<BigInt(32))+BigInt(this[++V]*16777216+this[++V]*65536+this[++V]*256+pe)}),A.prototype.readFloatLE=function(V,G){return V=V>>>0,G||it(V,4,this.length),u.read(this,V,!0,23,4)},A.prototype.readFloatBE=function(V,G){return V=V>>>0,G||it(V,4,this.length),u.read(this,V,!1,23,4)},A.prototype.readDoubleLE=function(V,G){return V=V>>>0,G||it(V,8,this.length),u.read(this,V,!0,52,8)},A.prototype.readDoubleBE=function(V,G){return V=V>>>0,G||it(V,8,this.length),u.read(this,V,!1,52,8)};function gt(ee,V,G,pe,Ue,Qe){if(!A.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(V>Ue||V<Qe)throw new RangeError('"value" argument is out of bounds');if(G+pe>ee.length)throw new RangeError("Index out of range")}A.prototype.writeUintLE=A.prototype.writeUIntLE=function(V,G,pe,Ue){if(V=+V,G=G>>>0,pe=pe>>>0,!Ue){let nt=Math.pow(2,8*pe)-1;gt(this,V,G,pe,nt,0)}let Qe=1,$e=0;for(this[G]=V&255;++$e<pe&&(Qe*=256);)this[G+$e]=V/Qe&255;return G+pe},A.prototype.writeUintBE=A.prototype.writeUIntBE=function(V,G,pe,Ue){if(V=+V,G=G>>>0,pe=pe>>>0,!Ue){let nt=Math.pow(2,8*pe)-1;gt(this,V,G,pe,nt,0)}let Qe=pe-1,$e=1;for(this[G+Qe]=V&255;--Qe>=0&&($e*=256);)this[G+Qe]=V/$e&255;return G+pe},A.prototype.writeUint8=A.prototype.writeUInt8=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,1,255,0),this[G]=V&255,G+1},A.prototype.writeUint16LE=A.prototype.writeUInt16LE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,2,65535,0),this[G]=V&255,this[G+1]=V>>>8,G+2},A.prototype.writeUint16BE=A.prototype.writeUInt16BE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,2,65535,0),this[G]=V>>>8,this[G+1]=V&255,G+2},A.prototype.writeUint32LE=A.prototype.writeUInt32LE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,4,4294967295,0),this[G+3]=V>>>24,this[G+2]=V>>>16,this[G+1]=V>>>8,this[G]=V&255,G+4},A.prototype.writeUint32BE=A.prototype.writeUInt32BE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,4,4294967295,0),this[G]=V>>>24,this[G+1]=V>>>16,this[G+2]=V>>>8,this[G+3]=V&255,G+4};function Rt(ee,V,G,pe,Ue){Jt(V,pe,Ue,ee,G,7);let Qe=Number(V&BigInt(4294967295));ee[G++]=Qe,Qe=Qe>>8,ee[G++]=Qe,Qe=Qe>>8,ee[G++]=Qe,Qe=Qe>>8,ee[G++]=Qe;let $e=Number(V>>BigInt(32)&BigInt(4294967295));return ee[G++]=$e,$e=$e>>8,ee[G++]=$e,$e=$e>>8,ee[G++]=$e,$e=$e>>8,ee[G++]=$e,G}function It(ee,V,G,pe,Ue){Jt(V,pe,Ue,ee,G,7);let Qe=Number(V&BigInt(4294967295));ee[G+7]=Qe,Qe=Qe>>8,ee[G+6]=Qe,Qe=Qe>>8,ee[G+5]=Qe,Qe=Qe>>8,ee[G+4]=Qe;let $e=Number(V>>BigInt(32)&BigInt(4294967295));return ee[G+3]=$e,$e=$e>>8,ee[G+2]=$e,$e=$e>>8,ee[G+1]=$e,$e=$e>>8,ee[G]=$e,G+8}A.prototype.writeBigUInt64LE=ze(function(V,G=0){return Rt(this,V,G,BigInt(0),BigInt("0xffffffffffffffff"))}),A.prototype.writeBigUInt64BE=ze(function(V,G=0){return It(this,V,G,BigInt(0),BigInt("0xffffffffffffffff"))}),A.prototype.writeIntLE=function(V,G,pe,Ue){if(V=+V,G=G>>>0,!Ue){let ge=Math.pow(2,8*pe-1);gt(this,V,G,pe,ge-1,-ge)}let Qe=0,$e=1,nt=0;for(this[G]=V&255;++Qe<pe&&($e*=256);)V<0&&nt===0&&this[G+Qe-1]!==0&&(nt=1),this[G+Qe]=(V/$e>>0)-nt&255;return G+pe},A.prototype.writeIntBE=function(V,G,pe,Ue){if(V=+V,G=G>>>0,!Ue){let ge=Math.pow(2,8*pe-1);gt(this,V,G,pe,ge-1,-ge)}let Qe=pe-1,$e=1,nt=0;for(this[G+Qe]=V&255;--Qe>=0&&($e*=256);)V<0&&nt===0&&this[G+Qe+1]!==0&&(nt=1),this[G+Qe]=(V/$e>>0)-nt&255;return G+pe},A.prototype.writeInt8=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,1,127,-128),V<0&&(V=255+V+1),this[G]=V&255,G+1},A.prototype.writeInt16LE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,2,32767,-32768),this[G]=V&255,this[G+1]=V>>>8,G+2},A.prototype.writeInt16BE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,2,32767,-32768),this[G]=V>>>8,this[G+1]=V&255,G+2},A.prototype.writeInt32LE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,4,2147483647,-2147483648),this[G]=V&255,this[G+1]=V>>>8,this[G+2]=V>>>16,this[G+3]=V>>>24,G+4},A.prototype.writeInt32BE=function(V,G,pe){return V=+V,G=G>>>0,pe||gt(this,V,G,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[G]=V>>>24,this[G+1]=V>>>16,this[G+2]=V>>>8,this[G+3]=V&255,G+4},A.prototype.writeBigInt64LE=ze(function(V,G=0){return Rt(this,V,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),A.prototype.writeBigInt64BE=ze(function(V,G=0){return It(this,V,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ft(ee,V,G,pe,Ue,Qe){if(G+pe>ee.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function Ne(ee,V,G,pe,Ue){return V=+V,G=G>>>0,Ue||Ft(ee,V,G,4,34028234663852886e22,-34028234663852886e22),u.write(ee,V,G,pe,23,4),G+4}A.prototype.writeFloatLE=function(V,G,pe){return Ne(this,V,G,!0,pe)},A.prototype.writeFloatBE=function(V,G,pe){return Ne(this,V,G,!1,pe)};function pn(ee,V,G,pe,Ue){return V=+V,G=G>>>0,Ue||Ft(ee,V,G,8,17976931348623157e292,-17976931348623157e292),u.write(ee,V,G,pe,52,8),G+8}A.prototype.writeDoubleLE=function(V,G,pe){return pn(this,V,G,!0,pe)},A.prototype.writeDoubleBE=function(V,G,pe){return pn(this,V,G,!1,pe)},A.prototype.copy=function(V,G,pe,Ue){if(!A.isBuffer(V))throw new TypeError("argument should be a Buffer");if(pe||(pe=0),!Ue&&Ue!==0&&(Ue=this.length),G>=V.length&&(G=V.length),G||(G=0),Ue>0&&Ue<pe&&(Ue=pe),Ue===pe||V.length===0||this.length===0)return 0;if(G<0)throw new RangeError("targetStart out of bounds");if(pe<0||pe>=this.length)throw new RangeError("Index out of range");if(Ue<0)throw new RangeError("sourceEnd out of bounds");Ue>this.length&&(Ue=this.length),V.length-G<Ue-pe&&(Ue=V.length-G+pe);let Qe=Ue-pe;return this===V&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(G,pe,Ue):Uint8Array.prototype.set.call(V,this.subarray(pe,Ue),G),Qe},A.prototype.fill=function(V,G,pe,Ue){if(typeof V=="string"){if(typeof G=="string"?(Ue=G,G=0,pe=this.length):typeof pe=="string"&&(Ue=pe,pe=this.length),Ue!==void 0&&typeof Ue!="string")throw new TypeError("encoding must be a string");if(typeof Ue=="string"&&!A.isEncoding(Ue))throw new TypeError("Unknown encoding: "+Ue);if(V.length===1){let $e=V.charCodeAt(0);(Ue==="utf8"&&$e<128||Ue==="latin1")&&(V=$e)}}else typeof V=="number"?V=V&255:typeof V=="boolean"&&(V=Number(V));if(G<0||this.length<G||this.length<pe)throw new RangeError("Out of range index");if(pe<=G)return this;G=G>>>0,pe=pe===void 0?this.length:pe>>>0,V||(V=0);let Qe;if(typeof V=="number")for(Qe=G;Qe<pe;++Qe)this[Qe]=V;else{let $e=A.isBuffer(V)?V:A.from(V,Ue),nt=$e.length;if(nt===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(Qe=0;Qe<pe-G;++Qe)this[Qe+G]=$e[Qe%nt]}return this};let St={};function Vt(ee,V,G){St[ee]=class extends G{constructor(){super(),Object.defineProperty(this,"message",{value:V.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ee}]`,this.stack,delete this.name}get code(){return ee}set code(Ue){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ue,writable:!0})}toString(){return`${this.name} [${ee}]: ${this.message}`}}}Vt("ERR_BUFFER_OUT_OF_BOUNDS",function(ee){return ee?`${ee} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Vt("ERR_INVALID_ARG_TYPE",function(ee,V){return`The "${ee}" argument must be of type number. Received type ${typeof V}`},TypeError),Vt("ERR_OUT_OF_RANGE",function(ee,V,G){let pe=`The value of "${ee}" is out of range.`,Ue=G;return Number.isInteger(G)&&Math.abs(G)>4294967296?Ue=Ot(String(G)):typeof G=="bigint"&&(Ue=String(G),(G>BigInt(2)**BigInt(32)||G<-(BigInt(2)**BigInt(32)))&&(Ue=Ot(Ue)),Ue+="n"),pe+=` It must be ${V}. Received ${Ue}`,pe},RangeError);function Ot(ee){let V="",G=ee.length,pe=ee[0]==="-"?1:0;for(;G>=pe+4;G-=3)V=`_${ee.slice(G-3,G)}${V}`;return`${ee.slice(0,G)}${V}`}function xn(ee,V,G){Oe(V,"offset"),(ee[V]===void 0||ee[V+G]===void 0)&&Ie(V,ee.length-(G+1))}function Jt(ee,V,G,pe,Ue,Qe){if(ee>G||ee<V){let $e=typeof V=="bigint"?"n":"",nt;throw Qe>3?V===0||V===BigInt(0)?nt=`>= 0${$e} and < 2${$e} ** ${(Qe+1)*8}${$e}`:nt=`>= -(2${$e} ** ${(Qe+1)*8-1}${$e}) and < 2 ** ${(Qe+1)*8-1}${$e}`:nt=`>= ${V}${$e} and <= ${G}${$e}`,new St.ERR_OUT_OF_RANGE("value",nt,ee)}xn(pe,Ue,Qe)}function Oe(ee,V){if(typeof ee!="number")throw new St.ERR_INVALID_ARG_TYPE(V,"number",ee)}function Ie(ee,V,G){throw Math.floor(ee)!==ee?(Oe(ee,G),new St.ERR_OUT_OF_RANGE(G||"offset","an integer",ee)):V<0?new St.ERR_BUFFER_OUT_OF_BOUNDS:new St.ERR_OUT_OF_RANGE(G||"offset",`>= ${G?1:0} and <= ${V}`,ee)}let yt=/[^+/0-9A-Za-z-_]/g;function kt(ee){if(ee=ee.split("=")[0],ee=ee.trim().replace(yt,""),ee.length<2)return"";for(;ee.length%4!==0;)ee=ee+"=";return ee}function De(ee,V){V=V||1/0;let G,pe=ee.length,Ue=null,Qe=[];for(let $e=0;$e<pe;++$e){if(G=ee.charCodeAt($e),G>55295&&G<57344){if(!Ue){if(G>56319){(V-=3)>-1&&Qe.push(239,191,189);continue}else if($e+1===pe){(V-=3)>-1&&Qe.push(239,191,189);continue}Ue=G;continue}if(G<56320){(V-=3)>-1&&Qe.push(239,191,189),Ue=G;continue}G=(Ue-55296<<10|G-56320)+65536}else Ue&&(V-=3)>-1&&Qe.push(239,191,189);if(Ue=null,G<128){if((V-=1)<0)break;Qe.push(G)}else if(G<2048){if((V-=2)<0)break;Qe.push(G>>6|192,G&63|128)}else if(G<65536){if((V-=3)<0)break;Qe.push(G>>12|224,G>>6&63|128,G&63|128)}else if(G<1114112){if((V-=4)<0)break;Qe.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw new Error("Invalid code point")}return Qe}function he(ee){let V=[];for(let G=0;G<ee.length;++G)V.push(ee.charCodeAt(G)&255);return V}function ae(ee,V){let G,pe,Ue,Qe=[];for(let $e=0;$e<ee.length&&!((V-=2)<0);++$e)G=ee.charCodeAt($e),pe=G>>8,Ue=G%256,Qe.push(Ue),Qe.push(pe);return Qe}function de(ee){return l.toByteArray(kt(ee))}function we(ee,V,G,pe){let Ue;for(Ue=0;Ue<pe&&!(Ue+G>=V.length||Ue>=ee.length);++Ue)V[Ue+G]=ee[Ue];return Ue}function Ae(ee,V){return ee instanceof V||ee!=null&&ee.constructor!=null&&ee.constructor.name!=null&&ee.constructor.name===V.name}function Le(ee){return ee!==ee}let Ee=function(){let ee="0123456789abcdef",V=new Array(256);for(let G=0;G<16;++G){let pe=G*16;for(let Ue=0;Ue<16;++Ue)V[pe+Ue]=ee[G]+ee[Ue]}return V}();function ze(ee){return typeof BigInt>"u"?Ge:ee}function Ge(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":s=>{"use strict";s.exports=function(o){var c=[];return c.toString=function(){return this.map(function(u){var h="",p=typeof u[5]<"u";return u[4]&&(h+="@supports (".concat(u[4],") {")),u[2]&&(h+="@media ".concat(u[2]," {")),p&&(h+="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {")),h+=o(u),p&&(h+="}"),u[2]&&(h+="}"),u[4]&&(h+="}"),h}).join("")},c.i=function(u,h,p,f,m){typeof u=="string"&&(u=[[null,u,void 0]]);var A={};if(p)for(var y=0;y<this.length;y++){var E=this[y][0];E!=null&&(A[E]=!0)}for(var x=0;x<u.length;x++){var v=[].concat(u[x]);p&&A[v[0]]||(typeof m<"u"&&(typeof v[5]>"u"||(v[1]="@layer".concat(v[5].length>0?" ".concat(v[5]):""," {").concat(v[1],"}")),v[5]=m),h&&(v[2]&&(v[1]="@media ".concat(v[2]," {").concat(v[1],"}")),v[2]=h),f&&(v[4]?(v[1]="@supports (".concat(v[4],") {").concat(v[1],"}"),v[4]=f):v[4]="".concat(f)),c.push(v))}},c}},"./node_modules/css-loader/dist/runtime/getUrl.js":s=>{"use strict";s.exports=function(o,c){return c||(c={}),o&&(o=String(o.__esModule?o.default:o),/^['"].*['"]$/.test(o)&&(o=o.slice(1,-1)),c.hash&&(o+=c.hash),/["'() \t\n]|(%20)/.test(o)||c.needQuotes?'"'.concat(o.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):o)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":s=>{"use strict";s.exports=function(o){var c=o[1],l=o[3];if(!l)return c;if(typeof btoa=="function"){var u=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(u),p="/*# ".concat(h," */");return[c].concat([p]).join(`
`)}return[c].join(`
`)}},"./node_modules/custom-event-polyfill/polyfill.js":()=>{(function(){if(!(typeof window>"u"))try{var s=new window.CustomEvent("test",{cancelable:!0});if(s.preventDefault(),s.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var o=function(l,u){var h,p;return u=u||{},u.bubbles=!!u.bubbles,u.cancelable=!!u.cancelable,h=document.createEvent("CustomEvent"),h.initCustomEvent(l,u.bubbles,u.cancelable,u.detail),p=h.preventDefault,h.preventDefault=function(){p.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},h};o.prototype=window.Event.prototype,window.CustomEvent=o}})()},"./node_modules/debug/browser.js":(s,o,c)=>{o=s.exports=c("./node_modules/debug/debug.js"),o.log=h,o.formatArgs=u,o.save=p,o.load=f,o.useColors=l,o.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:m(),o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function l(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}o.formatters.j=function(A){return JSON.stringify(A)};function u(){var A=arguments,y=this.useColors;if(A[0]=(y?"%c":"")+this.namespace+(y?" %c":" ")+A[0]+(y?"%c ":" "),!y)return A;var E="color: "+this.color;A=[A[0],E,"color: inherit"].concat(Array.prototype.slice.call(A,1));var x=0,v=0;return A[0].replace(/%[a-z%]/g,function(w){w!=="%%"&&(x++,w==="%c"&&(v=x))}),A.splice(v,0,E),A}function h(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function p(A){try{A==null?o.storage.removeItem("debug"):o.storage.debug=A}catch{}}function f(){var A;try{A=o.storage.debug}catch{}return A}o.enable(f());function m(){try{return window.localStorage}catch{}}},"./node_modules/debug/debug.js":(s,o)=>{o=s.exports=u,o.coerce=m,o.disable=p,o.enable=h,o.enabled=f,o.names=[],o.skips=[],o.formatters={};var c=0;function l(){return o.colors[c++%o.colors.length]}function u(A){function y(){}y.enabled=!1;function E(){var v=E;v.useColors==null&&(v.useColors=o.useColors()),v.color==null&&v.useColors&&(v.color=l());var w=Array.prototype.slice.call(arguments);w[0]=o.coerce(w[0]),typeof w[0]!="string"&&(w=["%o"].concat(w));var M=0;w[0]=w[0].replace(/%([a-z%])/g,function(D,L){if(D==="%%")return D;M++;var I=o.formatters[L];if(typeof I=="function"){var F=w[M];D=I.call(v,F),w.splice(M,1),M--}return D}),typeof o.formatArgs=="function"&&(w=o.formatArgs.apply(v,w));var T=E.log||o.log||console.log.bind(console);T.apply(v,w)}E.enabled=!0;var x=o.enabled(A)?E:y;return x.namespace=A,x}function h(A){o.save(A);for(var y=(A||"").split(/[\s,]+/),E=y.length,x=0;x<E;x++)y[x]&&(A=y[x].replace(/\*/g,".*?"),A[0]==="-"?o.skips.push(new RegExp("^"+A.substr(1)+"$")):o.names.push(new RegExp("^"+A+"$")))}function p(){o.enable("")}function f(A){var y,E;for(y=0,E=o.skips.length;y<E;y++)if(o.skips[y].test(A))return!1;for(y=0,E=o.names.length;y<E;y++)if(o.names[y].test(A))return!0;return!1}function m(A){return A instanceof Error?A.stack||A.message:A}},"./node_modules/deep-assign/index.js":(s,o,c)=>{"use strict";var l=c("./node_modules/is-obj/index.js"),u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function p(A){if(A==null)throw new TypeError("Sources cannot be null or undefined");return Object(A)}function f(A,y,E){var x=y[E];if(x!=null){if(u.call(A,E)&&(A[E]===void 0||A[E]===null))throw new TypeError("Cannot convert undefined or null to object ("+E+")");!u.call(A,E)||!l(x)?A[E]=x:A[E]=m(Object(A[E]),y[E])}}function m(A,y){if(A===y)return A;y=Object(y);for(var E in y)u.call(y,E)&&f(A,y,E);if(Object.getOwnPropertySymbols)for(var x=Object.getOwnPropertySymbols(y),v=0;v<x.length;v++)h.call(y,x[v])&&f(A,y,x[v]);return A}s.exports=function(y){y=p(y);for(var E=1;E<arguments.length;E++)m(y,arguments[E]);return y}},"./node_modules/dtype/index.js":s=>{s.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(s,o,c)=>{var l;typeof window<"u"?l=window:typeof c.g<"u"?l=c.g:typeof self<"u"?l=self:l={},s.exports=l},"./node_modules/ieee754/index.js":(s,o)=>{o.read=function(c,l,u,h,p){var f,m,A=p*8-h-1,y=(1<<A)-1,E=y>>1,x=-7,v=u?p-1:0,w=u?-1:1,M=c[l+v];for(v+=w,f=M&(1<<-x)-1,M>>=-x,x+=A;x>0;f=f*256+c[l+v],v+=w,x-=8);for(m=f&(1<<-x)-1,f>>=-x,x+=h;x>0;m=m*256+c[l+v],v+=w,x-=8);if(f===0)f=1-E;else{if(f===y)return m?NaN:(M?-1:1)*(1/0);m=m+Math.pow(2,h),f=f-E}return(M?-1:1)*m*Math.pow(2,f-h)},o.write=function(c,l,u,h,p,f){var m,A,y,E=f*8-p-1,x=(1<<E)-1,v=x>>1,w=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=h?0:f-1,T=h?1:-1,D=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(A=isNaN(l)?1:0,m=x):(m=Math.floor(Math.log(l)/Math.LN2),l*(y=Math.pow(2,-m))<1&&(m--,y*=2),m+v>=1?l+=w/y:l+=w*Math.pow(2,1-v),l*y>=2&&(m++,y/=2),m+v>=x?(A=0,m=x):m+v>=1?(A=(l*y-1)*Math.pow(2,p),m=m+v):(A=l*Math.pow(2,v-1)*Math.pow(2,p),m=0));p>=8;c[u+M]=A&255,M+=T,A/=256,p-=8);for(m=m<<p|A,E+=p;E>0;c[u+M]=m&255,M+=T,m/=256,E-=8);c[u+M-T]|=D*128}},"./node_modules/is-buffer/index.js":s=>{s.exports=function(l){return l!=null&&(o(l)||c(l)||!!l._isBuffer)};function o(l){return!!l.constructor&&typeof l.constructor.isBuffer=="function"&&l.constructor.isBuffer(l)}function c(l){return typeof l.readFloatLE=="function"&&typeof l.slice=="function"&&o(l.slice(0,0))}},"./node_modules/is-function/index.js":s=>{s.exports=c;var o=Object.prototype.toString;function c(l){if(!l)return!1;var u=o.call(l);return u==="[object Function]"||typeof l=="function"&&u!=="[object RegExp]"||typeof window<"u"&&(l===window.setTimeout||l===window.alert||l===window.confirm||l===window.prompt)}},"./node_modules/is-obj/index.js":s=>{"use strict";s.exports=function(o){var c=typeof o;return o!==null&&(c==="object"||c==="function")}},"./node_modules/layout-bmfont-text/index.js":(s,o,c)=>{var l=c("./node_modules/word-wrapper/index.js"),u=c("./node_modules/xtend/immutable.js"),h=c("./node_modules/as-number/index.js"),p=["x","e","a","o","n","s","r","c","u","m","v","w","z"],f=["m","w"],m=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],A=9,y=32,E=0,x=1,v=2;s.exports=function(te){return new w(te)};function w($){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update($)}w.prototype.update=function($){if($=u({measure:this._measure},$),this._opt=$,this._opt.tabSize=h(this._opt.tabSize,4),!$.font)throw new Error("must provide a valid bitmap font");var te=this.glyphs,U=$.text||"",P=$.font;this._setupSpaceGlyphs(P);var k=l.lines(U,$),z=$.width||0;te.length=0;var Q=k.reduce(function(gt,Rt){return Math.max(gt,Rt.width,z)},0),Z=0,ce=0,Me=h($.lineHeight,P.common.lineHeight),xe=P.common.base,be=Me-xe,Fe=$.letterSpacing||0,Ze=Me*k.length-be,ut=N(this._opt.align);ce-=Ze,this._width=Q,this._height=Ze,this._descender=Me-xe,this._baseline=xe,this._xHeight=L(P),this._capHeight=F(P),this._lineHeight=Me,this._ascender=Me-be-this._xHeight;var it=this;k.forEach(function(gt,Rt){for(var It=gt.start,Ft=gt.end,Ne=gt.width,pn,St=It;St<Ft;St++){var Vt=U.charCodeAt(St),Ot=it.getGlyph(P,Vt);if(Ot){pn&&(Z+=R(P,pn.id,Ot.id));var xn=Z;ut===x?xn+=(Q-Ne)/2:ut===v&&(xn+=Q-Ne),te.push({position:[xn,ce],data:Ot,index:St,line:Rt}),Z+=Ot.xadvance+Fe,pn=Ot}}ce+=Me,Z=0}),this._linesTotal=k.length},w.prototype._setupSpaceGlyphs=function($){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!$.chars||$.chars.length===0)){var te=D($,y)||I($)||$.chars[0],U=this._opt.tabSize*te.xadvance;this._fallbackSpaceGlyph=te,this._fallbackTabGlyph=u(te,{x:0,y:0,xadvance:U,id:A,xoffset:0,yoffset:0,width:0,height:0})}},w.prototype.getGlyph=function($,te){var U=D($,te);return U||(te===A?this._fallbackTabGlyph:te===y?this._fallbackSpaceGlyph:null)},w.prototype.computeMetrics=function($,te,U,P){var k=this._opt.letterSpacing||0,z=this._opt.font,Q=0,Z=0,ce=0,Me,xe;if(!z.chars||z.chars.length===0)return{start:te,end:te,width:0};U=Math.min($.length,U);for(var be=te;be<U;be++){var Fe=$.charCodeAt(be),Me=this.getGlyph(z,Fe);if(Me){var Ze=Me.xoffset,ut=xe?R(z,xe.id,Me.id):0;Q+=ut;var it=Q+Me.xadvance+k,gt=Q+Me.width;if(gt>=P||it>=P)break;Q=it,Z=gt,xe=Me}ce++}return xe&&(Z+=xe.xoffset),{start:te,end:te+ce,width:Z}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(M);function M($){Object.defineProperty(w.prototype,$,{get:T($),configurable:!0})}function T($){return new Function(["return function "+$+"() {","  return this._"+$,"}"].join(`
`))()}function D($,te){if(!$.chars||$.chars.length===0)return null;var U=X($.chars,te);return U>=0?$.chars[U]:null}function L($){for(var te=0;te<p.length;te++){var U=p[te].charCodeAt(0),P=X($.chars,U);if(P>=0)return $.chars[P].height}return 0}function I($){for(var te=0;te<f.length;te++){var U=f[te].charCodeAt(0),P=X($.chars,U);if(P>=0)return $.chars[P]}return 0}function F($){for(var te=0;te<m.length;te++){var U=m[te].charCodeAt(0),P=X($.chars,U);if(P>=0)return $.chars[P].height}return 0}function R($,te,U){if(!$.kernings||$.kernings.length===0)return 0;for(var P=$.kernings,k=0;k<P.length;k++){var z=P[k];if(z.first===te&&z.second===U)return z.amount}return 0}function N($){return $==="center"?x:$==="right"?v:E}function X($,te,U){U=U||0;for(var P=U;P<$.length;P++)if($[P].id===te)return P;return-1}},"./node_modules/load-bmfont/browser.js":(s,o,c)=>{var l=c("./node_modules/buffer/index.js").Buffer,u=c("./node_modules/xhr/index.js"),h=function(){},p=c("./node_modules/parse-bmfont-ascii/index.js"),f=c("./node_modules/parse-bmfont-xml/lib/browser.js"),m=c("./node_modules/parse-bmfont-binary/index.js"),A=c("./node_modules/load-bmfont/lib/is-binary.js"),y=c("./node_modules/xtend/immutable.js"),E=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();s.exports=function(w,M){M=typeof M=="function"?M:h,typeof w=="string"?w={uri:w}:w||(w={});var T=w.binary;T&&(w=v(w)),u(w,function(D,L,I){if(D)return M(D);if(!/^2/.test(L.statusCode))return M(new Error("http status code: "+L.statusCode));if(!I)return M(new Error("no body result"));var F=!1;if(x(I)){var R=new Uint8Array(I);I=l.from(R,"binary")}A(I)&&(F=!0,typeof I=="string"&&(I=l.from(I,"binary"))),F||(l.isBuffer(I)&&(I=I.toString(w.encoding)),I=I.trim());var N;try{var X=L.headers["content-type"];F?N=m(I):/json/.test(X)||I.charAt(0)==="{"?N=JSON.parse(I):/xml/.test(X)||I.charAt(0)==="<"?N=f(I):N=p(I)}catch($){M(new Error("error parsing font "+$.message)),M=h}M(null,N)})};function x(w){var M=Object.prototype.toString;return M.call(w)==="[object ArrayBuffer]"}function v(w){if(E)return y(w,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var M=new self.XMLHttpRequest;return M.overrideMimeType("text/plain; charset=x-user-defined"),y({xhr:M},w)}},"./node_modules/load-bmfont/lib/is-binary.js":(s,o,c)=>{var l=c("./node_modules/buffer/index.js").Buffer,u=c("./node_modules/buffer-equal/index.js"),h=l.from([66,77,70,3]);s.exports=function(p){return typeof p=="string"?p.substring(0,3)==="BMF":p.length>4&&u(p.slice(0,4),h)}},"./node_modules/object-assign/index.js":s=>{"use strict";var o=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;function u(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function h(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var f={},m=0;m<10;m++)f["_"+String.fromCharCode(m)]=m;var A=Object.getOwnPropertyNames(f).map(function(E){return f[E]});if(A.join("")!=="0123456789")return!1;var y={};return"abcdefghijklmnopqrst".split("").forEach(function(E){y[E]=E}),Object.keys(Object.assign({},y)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s.exports=h()?Object.assign:function(p,f){for(var m,A=u(p),y,E=1;E<arguments.length;E++){m=Object(arguments[E]);for(var x in m)c.call(m,x)&&(A[x]=m[x]);if(o){y=o(m);for(var v=0;v<y.length;v++)l.call(m,y[v])&&(A[y[v]]=m[y[v]])}}return A}},"./node_modules/parse-bmfont-ascii/index.js":s=>{s.exports=function(h){if(!h)throw new Error("no data provided");h=h.toString().trim();var p={pages:[],chars:[],kernings:[]},f=h.split(/\r\n?|\n/g);if(f.length===0)throw new Error("no data in BMFont file");for(var m=0;m<f.length;m++){var A=o(f[m],m);if(A)if(A.key==="page"){if(typeof A.data.id!="number")throw new Error("malformed file at line "+m+" -- needs page id=N");if(typeof A.data.file!="string")throw new Error("malformed file at line "+m+' -- needs page file="path"');p.pages[A.data.id]=A.data.file}else A.key==="chars"||A.key==="kernings"||(A.key==="char"?p.chars.push(A.data):A.key==="kerning"?p.kernings.push(A.data):p[A.key]=A.data)}return p};function o(u,h){if(u=u.replace(/\t+/g," ").trim(),!u)return null;var p=u.indexOf(" ");if(p===-1)throw new Error("no named row at line "+h);var f=u.substring(0,p);u=u.substring(p+1),u=u.replace(/letter=[\'\"]\S+[\'\"]/gi,""),u=u.split("="),u=u.map(function(x){return x.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var m=[],A=0;A<u.length;A++){var y=u[A];A===0?m.push({key:y[0],data:""}):A===u.length-1?m[m.length-1].data=c(y[0]):(m[m.length-1].data=c(y[0]),m.push({key:y[1],data:""}))}var E={key:f,data:{}};return m.forEach(function(x){E.data[x.key]=x.data}),E}function c(u){return!u||u.length===0?"":u.indexOf('"')===0||u.indexOf("'")===0?u.substring(1,u.length-1):u.indexOf(",")!==-1?l(u):parseInt(u,10)}function l(u){return u.split(",").map(function(h){return parseInt(h,10)})}},"./node_modules/parse-bmfont-binary/index.js":s=>{var o=[66,77,70];s.exports=function(E){if(E.length<6)throw new Error("invalid buffer length for BMFont");var x=o.every(function(D,L){return E.readUInt8(L)===D});if(!x)throw new Error("BMFont missing BMF byte header");var v=3,w=E.readUInt8(v++);if(w>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var M={kernings:[],chars:[]},T=0;T<5;T++)v+=c(M,E,v);return M};function c(y,E,x){if(x>E.length-1)return 0;var v=E.readUInt8(x++),w=E.readInt32LE(x);switch(x+=4,v){case 1:y.info=l(E,x);break;case 2:y.common=u(E,x);break;case 3:y.pages=h(E,x,w);break;case 4:y.chars=p(E,x,w);break;case 5:y.kernings=f(E,x,w);break}return 5+w}function l(y,E){var x={};x.size=y.readInt16LE(E);var v=y.readUInt8(E+2);return x.smooth=v>>7&1,x.unicode=v>>6&1,x.italic=v>>5&1,x.bold=v>>4&1,v>>3&1&&(x.fixedHeight=1),x.charset=y.readUInt8(E+3)||"",x.stretchH=y.readUInt16LE(E+4),x.aa=y.readUInt8(E+6),x.padding=[y.readInt8(E+7),y.readInt8(E+8),y.readInt8(E+9),y.readInt8(E+10)],x.spacing=[y.readInt8(E+11),y.readInt8(E+12)],x.outline=y.readUInt8(E+13),x.face=A(y,E+14),x}function u(y,E){var x={};x.lineHeight=y.readUInt16LE(E),x.base=y.readUInt16LE(E+2),x.scaleW=y.readUInt16LE(E+4),x.scaleH=y.readUInt16LE(E+6),x.pages=y.readUInt16LE(E+8);var v=y.readUInt8(E+10);return x.packed=0,x.alphaChnl=y.readUInt8(E+11),x.redChnl=y.readUInt8(E+12),x.greenChnl=y.readUInt8(E+13),x.blueChnl=y.readUInt8(E+14),x}function h(y,E,x){for(var v=[],w=m(y,E),M=w.length+1,T=x/M,D=0;D<T;D++)v[D]=y.slice(E,E+w.length).toString("utf8"),E+=M;return v}function p(y,E,x){for(var v=[],w=x/20,M=0;M<w;M++){var T={},D=M*20;T.id=y.readUInt32LE(E+0+D),T.x=y.readUInt16LE(E+4+D),T.y=y.readUInt16LE(E+6+D),T.width=y.readUInt16LE(E+8+D),T.height=y.readUInt16LE(E+10+D),T.xoffset=y.readInt16LE(E+12+D),T.yoffset=y.readInt16LE(E+14+D),T.xadvance=y.readInt16LE(E+16+D),T.page=y.readUInt8(E+18+D),T.chnl=y.readUInt8(E+19+D),v[M]=T}return v}function f(y,E,x){for(var v=[],w=x/10,M=0;M<w;M++){var T={},D=M*10;T.first=y.readUInt32LE(E+0+D),T.second=y.readUInt32LE(E+4+D),T.amount=y.readInt16LE(E+8+D),v[M]=T}return v}function m(y,E){for(var x=E;x<y.length&&y[x]!==0;x++);return y.slice(E,x)}function A(y,E){return m(y,E).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(s,o,c)=>{var l=c("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),u=c("./node_modules/xml-parse-from-string/index.js"),h={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};s.exports=function(y){y=y.toString();var E=u(y),x={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(I){var F=E.getElementsByTagName(I)[0];F&&(x[I]=l(p(F)))});var v=E.getElementsByTagName("pages")[0];if(!v)throw new Error("malformed file -- no <pages> element");for(var w=v.getElementsByTagName("page"),M=0;M<w.length;M++){var T=w[M],D=parseInt(T.getAttribute("id"),10),L=T.getAttribute("file");if(isNaN(D))throw new Error('malformed file -- page "id" attribute is NaN');if(!L)throw new Error('malformed file -- needs page "file" attribute');x.pages[parseInt(D,10)]=L}return["chars","kernings"].forEach(function(I){var F=E.getElementsByTagName(I)[0];if(F)for(var R=I.substring(0,I.length-1),N=F.getElementsByTagName(R),X=0;X<N.length;X++){var $=N[X];x[I].push(l(p($)))}}),x};function p(A){var y=f(A);return y.reduce(function(E,x){var v=m(x.nodeName);return E[v]=x.nodeValue,E},{})}function f(A){for(var y=[],E=0;E<A.attributes.length;E++)y.push(A.attributes[E]);return y}function m(A){return h[A.toLowerCase()]||A}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":s=>{var o="chasrset";s.exports=function(u){o in u&&(u.charset=u[o],delete u[o]);for(var h in u)h==="face"||h==="charset"||(h==="padding"||h==="spacing"?u[h]=c(u[h]):u[h]=parseInt(u[h],10));return u};function c(l){return l.split(",").map(function(u){return parseInt(u,10)})}},"./node_modules/parse-headers/parse-headers.js":s=>{var o=function(l){return l.replace(/^\s+|\s+$/g,"")},c=function(l){return Object.prototype.toString.call(l)==="[object Array]"};s.exports=function(l){if(!l)return{};for(var u={},h=o(l).split(`
`),p=0;p<h.length;p++){var f=h[p],m=f.indexOf(":"),A=o(f.slice(0,m)).toLowerCase(),y=o(f.slice(m+1));typeof u[A]>"u"?u[A]=y:c(u[A])?u[A].push(y):u[A]=[u[A],y]}return u}},"./node_modules/present/lib/present-browser.js":(s,o,c)=>{var l=c.g.performance||{},u=function(){for(var h=["now","webkitNow","msNow","mozNow","oNow"];h.length;){var p=h.shift();if(p in l)return l[p].bind(l)}var f=Date.now||function(){return new Date().getTime()},m=(l.timing||{}).navigationStart||f();return function(){return f()-m}}();u.performanceNow=l.now,u.noConflict=function(){l.now=u.performanceNow},u.conflict=function(){l.now=u},u.conflict(),s.exports=u},"./node_modules/process/browser.js":s=>{var o=s.exports={},c,l;function u(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=u}catch{c=u}try{typeof clearTimeout=="function"?l=clearTimeout:l=h}catch{l=h}})();function p(T){if(c===setTimeout)return setTimeout(T,0);if((c===u||!c)&&setTimeout)return c=setTimeout,setTimeout(T,0);try{return c(T,0)}catch{try{return c.call(null,T,0)}catch{return c.call(this,T,0)}}}function f(T){if(l===clearTimeout)return clearTimeout(T);if((l===h||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(T);try{return l(T)}catch{try{return l.call(null,T)}catch{return l.call(this,T)}}}var m=[],A=!1,y,E=-1;function x(){!A||!y||(A=!1,y.length?m=y.concat(m):E=-1,m.length&&v())}function v(){if(!A){var T=p(x);A=!0;for(var D=m.length;D;){for(y=m,m=[];++E<D;)y&&y[E].run();E=-1,D=m.length}y=null,A=!1,f(T)}}o.nextTick=function(T){var D=new Array(arguments.length-1);if(arguments.length>1)for(var L=1;L<arguments.length;L++)D[L-1]=arguments[L];m.push(new w(T,D)),m.length===1&&!A&&p(v)};function w(T,D){this.fun=T,this.array=D}w.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={};function M(){}o.on=M,o.addListener=M,o.once=M,o.off=M,o.removeListener=M,o.removeAllListeners=M,o.emit=M,o.prependListener=M,o.prependOnceListener=M,o.listeners=function(T){return[]},o.binding=function(T){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(T){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/promise-polyfill/Promise.js":function(s){(function(o){var c=setTimeout,l=typeof setImmediate=="function"&&setImmediate||function(v){c(v,1)};function u(v,w){return function(){v.apply(w,arguments)}}var h=Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"};function p(v){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof v!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],x(v,u(m,this),u(A,this))}function f(v){var w=this;if(this._state===null){this._deferreds.push(v);return}l(function(){var M=w._state?v.onFulfilled:v.onRejected;if(M===null){(w._state?v.resolve:v.reject)(w._value);return}var T;try{T=M(w._value)}catch(D){v.reject(D);return}v.resolve(T)})}function m(v){try{if(v===this)throw new TypeError("A promise cannot be resolved with itself.");if(v&&(typeof v=="object"||typeof v=="function")){var w=v.then;if(typeof w=="function"){x(u(w,v),u(m,this),u(A,this));return}}this._state=!0,this._value=v,y.call(this)}catch(M){A.call(this,M)}}function A(v){this._state=!1,this._value=v,y.call(this)}function y(){for(var v=0,w=this._deferreds.length;v<w;v++)f.call(this,this._deferreds[v]);this._deferreds=null}function E(v,w,M,T){this.onFulfilled=typeof v=="function"?v:null,this.onRejected=typeof w=="function"?w:null,this.resolve=M,this.reject=T}function x(v,w,M){var T=!1;try{v(function(D){T||(T=!0,w(D))},function(D){T||(T=!0,M(D))})}catch(D){if(T)return;T=!0,M(D)}}p.prototype.catch=function(v){return this.then(null,v)},p.prototype.then=function(v,w){var M=this;return new p(function(T,D){f.call(M,new E(v,w,T,D))})},p.all=function(){var v=Array.prototype.slice.call(arguments.length===1&&h(arguments[0])?arguments[0]:arguments);return new p(function(w,M){if(v.length===0)return w([]);var T=v.length;function D(I,F){try{if(F&&(typeof F=="object"||typeof F=="function")){var R=F.then;if(typeof R=="function"){R.call(F,function(N){D(I,N)},M);return}}v[I]=F,--T===0&&w(v)}catch(N){M(N)}}for(var L=0;L<v.length;L++)D(L,v[L])})},p.resolve=function(v){return v&&typeof v=="object"&&v.constructor===p?v:new p(function(w){w(v)})},p.reject=function(v){return new p(function(w,M){M(v)})},p.race=function(v){return new p(function(w,M){for(var T=0,D=v.length;T<D;T++)v[T].then(w,M)})},p._setImmediateFn=function(w){l=w},s.exports?s.exports=p:o.Promise||(o.Promise=p)})(this)},"./node_modules/quad-indices/index.js":(s,o,c)=>{var l=c("./node_modules/dtype/index.js"),u=c("./node_modules/an-array/index.js"),h=c("./node_modules/is-buffer/index.js"),p=[0,2,3],f=[2,1,3];s.exports=function(A,y){(!A||!(u(A)||h(A)))&&(y=A||{},A=null),typeof y=="number"?y={count:y}:y=y||{};for(var E=typeof y.type=="string"?y.type:"uint16",x=typeof y.count=="number"?y.count:1,v=y.start||0,w=y.clockwise!==!1?p:f,M=w[0],T=w[1],D=w[2],L=x*6,I=A||new(l(E))(L),F=0,R=0;F<L;F+=6,R+=4){var N=F+v;I[N+0]=R+0,I[N+1]=R+1,I[N+2]=R+2,I[N+3]=R+M,I[N+4]=R+T,I[N+5]=R+D}return I}},"./node_modules/super-animejs/lib/anime.es.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>ne});var l={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},u={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},h=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],p={CSS:{},springs:{}};function f(Y,le,me){return Math.min(Math.max(Y,le),me)}function m(Y,le){return Y.indexOf(le)>-1}function A(Y,le){return Y.apply(null,le)}var y=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,E=/^rgb/,x=/^hsl/,v={arr:function(Y){return Array.isArray(Y)},obj:function(Y){return m(Object.prototype.toString.call(Y),"Object")},pth:function(Y){return v.obj(Y)&&Y.hasOwnProperty("totalLength")},svg:function(Y){return Y instanceof SVGElement},inp:function(Y){return Y instanceof HTMLInputElement},dom:function(Y){return Y.nodeType||v.svg(Y)},str:function(Y){return typeof Y=="string"},fnc:function(Y){return typeof Y=="function"},und:function(Y){return typeof Y>"u"},hex:function(Y){return y.test(Y)},rgb:function(Y){return E.test(Y)},hsl:function(Y){return x.test(Y)},col:function(Y){return v.hex(Y)||v.rgb(Y)||v.hsl(Y)},key:function(Y){return!l.hasOwnProperty(Y)&&!u.hasOwnProperty(Y)&&Y!=="targets"&&Y!=="keyframes"}},w=/\(([^)]+)\)/;function M(Y){var le=w.exec(Y);return le?le[1].split(",").map(function(me){return parseFloat(me)}):[]}function T(Y,le){var me=M(Y),_e=f(v.und(me[0])?1:me[0],.1,100),Xe=f(v.und(me[1])?100:me[1],.1,100),rt=f(v.und(me[2])?10:me[2],.1,100),At=f(v.und(me[3])?0:me[3],.1,100),Ct=Math.sqrt(Xe/_e),Tt=rt/(2*Math.sqrt(Xe*_e)),mt=Tt<1?Ct*Math.sqrt(1-Tt*Tt):0,Bt=1,cn=Tt<1?(Tt*Ct+-At)/mt:-At+Ct;function Ln(Wn){var mn=le?le*Wn/1e3:Wn;return Tt<1?mn=Math.exp(-mn*Tt*Ct)*(Bt*Math.cos(mt*mn)+cn*Math.sin(mt*mn)):mn=(Bt+cn*mn)*Math.exp(-mn*Ct),Wn===0||Wn===1?Wn:1-mn}function Hn(){var Wn=p.springs[Y];if(Wn)return Wn;for(var mn=1/6,Yt=0,lr=0;;)if(Yt+=mn,Ln(Yt)===1){if(lr++,lr>=16)break}else lr=0;var zn=Yt*mn*1e3;return p.springs[Y]=zn,zn}return le?Ln:Hn}function D(Y,le){Y===void 0&&(Y=1),le===void 0&&(le=.5);var me=f(Y,1,10),_e=f(le,.1,2);return function(Xe){return Xe===0||Xe===1?Xe:-me*Math.pow(2,10*(Xe-1))*Math.sin((Xe-1-_e/(Math.PI*2)*Math.asin(1/me))*(Math.PI*2)/_e)}}function L(Y){return Y===void 0&&(Y=10),function(le){return Math.round(le*Y)*(1/Y)}}var I=function(){var Y=11,le=1/(Y-1);function me(Bt,cn){return 1-3*cn+3*Bt}function _e(Bt,cn){return 3*cn-6*Bt}function Xe(Bt){return 3*Bt}function rt(Bt,cn,Ln){return((me(cn,Ln)*Bt+_e(cn,Ln))*Bt+Xe(cn))*Bt}function At(Bt,cn,Ln){return 3*me(cn,Ln)*Bt*Bt+2*_e(cn,Ln)*Bt+Xe(cn)}function Ct(Bt,cn,Ln,Hn,Wn){var mn,Yt,lr=0;do Yt=cn+(Ln-cn)/2,mn=rt(Yt,Hn,Wn)-Bt,mn>0?Ln=Yt:cn=Yt;while(Math.abs(mn)>1e-7&&++lr<10);return Yt}function Tt(Bt,cn,Ln,Hn){for(var Wn=0;Wn<4;++Wn){var mn=At(cn,Ln,Hn);if(mn===0)return cn;var Yt=rt(cn,Ln,Hn)-Bt;cn-=Yt/mn}return cn}function mt(Bt,cn,Ln,Hn){if(!(0<=Bt&&Bt<=1&&0<=Ln&&Ln<=1))return;var Wn=new Float32Array(Y);if(Bt!==cn||Ln!==Hn)for(var mn=0;mn<Y;++mn)Wn[mn]=rt(mn*le,Bt,Ln);function Yt(lr){for(var zn=0,yn=1,Ei=Y-1;yn!==Ei&&Wn[yn]<=lr;++yn)zn+=le;--yn;var ur=(lr-Wn[yn])/(Wn[yn+1]-Wn[yn]),$n=zn+ur*le,q=At($n,Bt,Ln);return q>=.001?Tt(lr,$n,Bt,Ln):q===0?$n:Ct(lr,zn,zn+le,Bt,Ln)}return function(lr){return Bt===cn&&Ln===Hn||lr===0||lr===1?lr:rt(Yt(lr),cn,Hn)}}return mt}(),F=function(){var Y=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],le={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],D],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(At,Ct){return function(Tt){return 1-D(At,Ct)(1-Tt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(At,Ct){return function(Tt){return Tt<.5?D(At,Ct)(Tt*2)/2:1-D(At,Ct)(Tt*-2+2)/2}}]},me={linear:[.25,.25,.75,.75]};for(var _e in le)for(var Xe=0,rt=le[_e].length;Xe<rt;Xe++)me["ease"+_e+Y[Xe]]=le[_e][Xe];return me}();function R(Y,le){if(v.fnc(Y))return Y;var me=Y.split("(")[0],_e=F[me],Xe=M(Y);switch(me){case"spring":return T(Y,le);case"cubicBezier":return A(I,Xe);case"steps":return A(L,Xe);default:return v.fnc(_e)?A(_e,Xe):A(I,_e)}}function N(Y){try{var le=document.querySelectorAll(Y);return le}catch{return}}var X=[];function $(Y,le){for(var me=X,_e=Y.length,Xe=arguments.length>=2?arguments[1]:void 0,rt=0;rt<_e;rt++)if(rt in Y){var At=Y[rt];le.call(Xe,At,rt,Y)&&me.push(At)}return X=Y,X.length=0,me}function te(Y,le){le||(le=[]);for(var me=0,_e=Y.length;me<_e;me++){var Xe=Y[me];Array.isArray(Xe)?te(Xe,le):le.push(Xe)}return le}function U(Y){return v.arr(Y)?Y:(v.str(Y)&&(Y=N(Y)||Y),Y instanceof NodeList||Y instanceof HTMLCollection?[].slice.call(Y):[Y])}function P(Y,le){return Y.some(function(me){return me===le})}function k(Y){var le={};for(var me in Y)le[me]=Y[me];return le}function z(Y,le){var me=k(Y);for(var _e in Y)me[_e]=le.hasOwnProperty(_e)?le[_e]:Y[_e];return me}function Q(Y,le){var me=k(Y);for(var _e in le)me[_e]=v.und(Y[_e])?le[_e]:Y[_e];return me}var Z=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function ce(Y){var le=Z.exec(Y);return le?"rgba("+le[1]+",1)":Y}var Me=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,xe=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function be(Y){var le=Y.replace(Me,function(At,Ct,Tt,mt){return Ct+Ct+Tt+Tt+mt+mt}),me=xe.exec(le),_e=parseInt(me[1],16),Xe=parseInt(me[2],16),rt=parseInt(me[3],16);return"rgba("+_e+","+Xe+","+rt+",1)"}var Fe=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Ze=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function ut(Y){var le=Fe.exec(Y)||Ze.exec(Y),me=parseInt(le[1],10)/360,_e=parseInt(le[2],10)/100,Xe=parseInt(le[3],10)/100,rt=le[4]||1;function At(Ln,Hn,Wn){return Wn<0&&(Wn+=1),Wn>1&&(Wn-=1),Wn<.16666666666666666?Ln+(Hn-Ln)*6*Wn:Wn<.5?Hn:Wn<.6666666666666666?Ln+(Hn-Ln)*(.6666666666666666-Wn)*6:Ln}var Ct,Tt,mt;if(_e==0)Ct=Tt=mt=Xe;else{var Bt=Xe<.5?Xe*(1+_e):Xe+_e-Xe*_e,cn=2*Xe-Bt;Ct=At(cn,Bt,me+.3333333333333333),Tt=At(cn,Bt,me),mt=At(cn,Bt,me-.3333333333333333)}return"rgba("+Ct*255+","+Tt*255+","+mt*255+","+rt+")"}function it(Y){if(v.rgb(Y))return ce(Y);if(v.hex(Y))return be(Y);if(v.hsl(Y))return ut(Y)}var gt=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Rt(Y){var le=gt.exec(Y);if(le)return le[2]}function It(Y){if(m(Y,"translate")||Y==="perspective")return"px";if(m(Y,"rotate")||m(Y,"skew"))return"deg"}function Ft(Y,le){return v.fnc(Y)?Y(le.target,le.id,le.total):Y}function Ne(Y,le){return Y.getAttribute(le)}function pn(Y,le,me){var _e=Rt(le);if(P([me,"deg","rad","turn"],_e))return le;var Xe=p.CSS[le+me];if(!v.und(Xe))return Xe;var rt=100,At=document.createElement(Y.tagName),Ct=Y.parentNode&&Y.parentNode!==document?Y.parentNode:document.body;Ct.appendChild(At),At.style.position="absolute",At.style.width=rt+me;var Tt=rt/At.offsetWidth;Ct.removeChild(At);var mt=Tt*parseFloat(le);return p.CSS[le+me]=mt,mt}function St(Y,le,me){if(le in Y.style){var _e=le.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Xe=Y.style[le]||getComputedStyle(Y).getPropertyValue(_e)||"0";return me?pn(Y,Xe,me):Xe}}function Vt(Y,le){if(v.dom(Y)&&!v.inp(Y)&&(Ne(Y,le)||v.svg(Y)&&Y[le]))return"attribute";if(v.dom(Y)&&P(h,le))return"transform";if(v.dom(Y)&&le!=="transform"&&St(Y,le))return"css";if(Y[le]!=null)return"object"}var Ot=/(\w+)\(([^)]*)\)/g;function xn(Y){if(v.dom(Y)){for(var le=Y.style.transform||"",me=new Map,_e;_e=Ot.exec(le);)me.set(_e[1],_e[2]);return me}}function Jt(Y,le,me,_e){var Xe=m(le,"scale")?1:0+It(le),rt=xn(Y).get(le)||Xe;return me&&(me.transforms.list.set(le,rt),me.transforms.last=le),_e?pn(Y,rt,_e):rt}function Oe(Y,le,me,_e){switch(Vt(Y,le)){case"transform":return Jt(Y,le,_e,me);case"css":return St(Y,le,me);case"attribute":return Ne(Y,le);default:return Y[le]||0}}var Ie=/^(\*=|\+=|-=)/;function yt(Y,le){var me=Ie.exec(Y);if(!me)return Y;var _e=Rt(Y)||0,Xe=parseFloat(le),rt=parseFloat(Y.replace(me[0],""));switch(me[0][0]){case"+":return Xe+rt+_e;case"-":return Xe-rt+_e;case"*":return Xe*rt+_e}}var kt=/\s/g;function De(Y,le){if(v.col(Y))return it(Y);var me=Rt(Y),_e=me?Y.substr(0,Y.length-me.length):Y;return le&&!kt.test(Y)?_e+le:_e}function he(Y,le){return Math.sqrt(Math.pow(le.x-Y.x,2)+Math.pow(le.y-Y.y,2))}function ae(Y){return Math.PI*2*Ne(Y,"r")}function de(Y){return Ne(Y,"width")*2+Ne(Y,"height")*2}function we(Y){return he({x:Ne(Y,"x1"),y:Ne(Y,"y1")},{x:Ne(Y,"x2"),y:Ne(Y,"y2")})}function Ae(Y){for(var le=Y.points,me=0,_e,Xe=0;Xe<le.numberOfItems;Xe++){var rt=le.getItem(Xe);Xe>0&&(me+=he(_e,rt)),_e=rt}return me}function Le(Y){var le=Y.points;return Ae(Y)+he(le.getItem(le.numberOfItems-1),le.getItem(0))}function Ee(Y){if(Y.getTotalLength)return Y.getTotalLength();switch(Y.tagName.toLowerCase()){case"circle":return ae(Y);case"rect":return de(Y);case"line":return we(Y);case"polyline":return Ae(Y);case"polygon":return Le(Y)}}function ze(Y){var le=Ee(Y);return Y.setAttribute("stroke-dasharray",le),le}function Ge(Y){for(var le=Y.parentNode;v.svg(le)&&(le=le.parentNode,!!v.svg(le.parentNode)););return le}function ee(Y,le){var me=le||{},_e=me.el||Ge(Y),Xe=_e.getBoundingClientRect(),rt=Ne(_e,"viewBox"),At=Xe.width,Ct=Xe.height,Tt=me.viewBox||(rt?rt.split(" "):[0,0,At,Ct]);return{el:_e,viewBox:Tt,x:Tt[0]/1,y:Tt[1]/1,w:At/Tt[2],h:Ct/Tt[3]}}function V(Y,le){var me=v.str(Y)?N(Y)[0]:Y,_e=le||100;return function(Xe){return{property:Xe,el:me,svg:ee(me),totalLength:Ee(me)*(_e/100)}}}function G(Y,le){function me(Ct){Ct===void 0&&(Ct=0);var Tt=le+Ct>=1?le+Ct:0;return Y.el.getPointAtLength(Tt)}var _e=ee(Y.el,Y.svg),Xe=me(),rt=me(-1),At=me(1);switch(Y.property){case"x":return(Xe.x-_e.x)*_e.w;case"y":return(Xe.y-_e.y)*_e.h;case"angle":return Math.atan2(At.y-rt.y,At.x-rt.x)*180/Math.PI}}var pe=/-?\d*\.?\d+/g;function Ue(Y,le){var me=De(v.pth(Y)?Y.totalLength:Y,le)+"";return{original:me,numbers:me.match(pe)?me.match(pe).map(Number):[0],strings:v.str(Y)||le?me.split(pe):[]}}function Qe(Y){var le=Y?te(v.arr(Y)?Y.map(U):U(Y)):[];return $(le,function(me,_e,Xe){return Xe.indexOf(me)===_e})}function $e(Y){var le=Qe(Y);return le.map(function(me,_e){return{target:me,id:_e,total:le.length,transforms:{list:xn(me)}}})}var nt=/^spring/;function ge(Y,le){var me=k(le);if(nt.test(me.easing)&&(me.duration=T(me.easing)),v.arr(Y)){var _e=Y.length,Xe=_e===2&&!v.obj(Y[0]);Xe?Y={value:Y}:v.fnc(le.duration)||(me.duration=le.duration/_e)}var rt=v.arr(Y)?Y:[Y];return rt.map(function(At,Ct){var Tt=v.obj(At)&&!v.pth(At)?At:{value:At};return v.und(Tt.delay)&&(Tt.delay=Ct?0:le.delay),v.und(Tt.endDelay)&&(Tt.endDelay=Ct===rt.length-1?le.endDelay:0),Tt}).map(function(At){return Q(At,me)})}function ot(Y){for(var le=$(te(Y.map(function(rt){return Object.keys(rt)})),function(rt){return v.key(rt)}).reduce(function(rt,At){return rt.indexOf(At)<0&&rt.push(At),rt},[]),me={},_e=function(rt){var At=le[rt];me[At]=Y.map(function(Ct){var Tt={};for(var mt in Ct)v.key(mt)?mt==At&&(Tt.value=Ct[mt]):Tt[mt]=Ct[mt];return Tt})},Xe=0;Xe<le.length;Xe++)_e(Xe);return me}function et(Y,le){var me=[],_e=le.keyframes;_e&&(le=Q(ot(_e),le));for(var Xe in le)v.key(Xe)&&me.push({name:Xe,tweens:ge(le[Xe],Y)});return me}function tt(Y,le){var me={};for(var _e in Y){var Xe=Ft(Y[_e],le);v.arr(Xe)&&(Xe=Xe.map(function(rt){return Ft(rt,le)}),Xe.length===1&&(Xe=Xe[0])),me[_e]=Xe}return me.duration=parseFloat(me.duration),me.delay=parseFloat(me.delay),me}function _t(Y,le){var me;return Y.tweens.map(function(_e){var Xe=tt(_e,le),rt=Xe.value,At=v.arr(rt)?rt[1]:rt,Ct=Rt(At),Tt=Oe(le.target,Y.name,Ct,le),mt=me?me.to.original:Tt,Bt=v.arr(rt)?rt[0]:mt,cn=Rt(Bt)||Rt(Tt),Ln=Ct||cn;return v.und(At)&&(At=mt),Xe.from=Ue(Bt,Ln),Xe.to=Ue(yt(At,Bt),Ln),Xe.start=me?me.end:0,Xe.end=Xe.start+Xe.delay+Xe.duration+Xe.endDelay,Xe.easing=R(Xe.easing,Xe.duration),Xe.isPath=v.pth(rt),Xe.isColor=v.col(Xe.from.original),Xe.isColor&&(Xe.round=1),me=Xe,Xe})}var tn={css:function(Y,le,me){return Y.style[le]=me},attribute:function(Y,le,me){return Y.setAttribute(le,me)},object:function(Y,le,me){return Y[le]=me},transform:function(Y,le,me,_e,Xe){if(_e.list.set(le,me),le===_e.last||Xe){var rt="";_e.list.forEach(function(At,Ct){rt+=Ct+"("+At+") "}),Y.style.transform=rt}}};function En(Y,le){for(var me=$e(Y),_e=0,Xe=me.length;_e<Xe;_e++){var rt=me[_e];for(var At in le){var Ct=Ft(le[At],rt),Tt=rt.target,mt=Rt(Ct),Bt=Oe(Tt,At,mt,rt),cn=mt||Rt(Bt),Ln=yt(De(Ct,cn),Bt),Hn=Vt(Tt,At);tn[Hn](Tt,At,Ln,rt.transforms,!0)}}}function Cn(Y,le){var me=Vt(Y.target,le.name);if(me){var _e=_t(le,Y),Xe=_e[_e.length-1];return{type:me,property:le.name,animatable:Y,tweens:_e,duration:Xe.end,delay:_e[0].delay,endDelay:Xe.endDelay}}}function en(Y,le){return $(te(Y.map(function(me){return le.map(function(_e){return Cn(me,_e)})})),function(me){return!v.und(me)})}function xt(Y,le){var me=Y.length,_e=function(rt){return rt.timelineOffset?rt.timelineOffset:0},Xe={};return Xe.duration=me?Math.max.apply(Math,Y.map(function(rt){return _e(rt)+rt.duration})):le.duration,Xe.delay=me?Math.min.apply(Math,Y.map(function(rt){return _e(rt)+rt.delay})):le.delay,Xe.endDelay=me?Xe.duration-Math.max.apply(Math,Y.map(function(rt){return _e(rt)+rt.duration-rt.endDelay})):le.endDelay,Xe}var jt=0;function Pn(Y){var le=z(l,Y),me=z(u,Y),_e=et(me,Y),Xe=$e(Y.targets),rt=en(Xe,_e),At=xt(rt,me),Ct=jt;return jt++,Q(le,{id:Ct,children:[],animatables:Xe,animations:rt,duration:At.duration,delay:At.delay,endDelay:At.endDelay})}var In=[],Kn=[],Gn,fi=function(){function Y(){Gn=requestAnimationFrame(le)}function le(me){var _e=In.length;if(_e){for(var Xe=0;Xe<_e;){var rt=In[Xe];if(!rt.paused)rt.tick(me);else{var At=In.indexOf(rt);At>-1&&(In.splice(At,1),_e=In.length)}Xe++}Y()}else Gn=cancelAnimationFrame(Gn)}return Y}();function xi(){if(document.hidden){for(var Y=0,le=In.length;Y<le;Y++)activeInstance[Y].pause();Kn=In.slice(0),In=[]}else for(var me=0,_e=Kn.length;me<_e;me++)Kn[me].play()}document.addEventListener("visibilitychange",xi);function Ti(Y){Y===void 0&&(Y={});var le=0,me=0,_e=0,Xe,rt=0,At=null;function Ct(){return window.Promise&&new Promise(function(yn){return At=yn})}var Tt=Ct(),mt=Pn(Y);function Bt(){mt.reversed=!mt.reversed;for(var yn=0,Ei=Xe.length;yn<Ei;yn++)Xe[yn].reversed=mt.reversed}function cn(yn){return mt.reversed?mt.duration-yn:yn}function Ln(){le=0,me=cn(mt.currentTime)*(1/Ti.speed)}function Hn(yn,Ei){Ei&&Ei.seek(yn-Ei.timelineOffset)}function Wn(yn){if(mt.reversePlayback)for(var ur=rt;ur--;)Hn(yn,Xe[ur]);else for(var Ei=0;Ei<rt;Ei++)Hn(yn,Xe[Ei])}function mn(yn){for(var Ei=0,ur=mt.animations,$n=ur.length;Ei<$n;){var q=ur[Ei],re=q.animatable,ye=q.tweens,Se=ye.length-1,He=ye[Se];Se&&(He=$(ye,function(Jn){return yn<Jn.end})[0]||He);for(var at=f(yn-He.start-He.delay,0,He.duration)/He.duration,vt=isNaN(at)?1:He.easing(at),bt=He.to.strings,qt=He.round,oe=[],ue=He.to.numbers.length,Ce=void 0,Be=0;Be<ue;Be++){var Re=void 0,pt=He.to.numbers[Be],Pt=He.from.numbers[Be]||0;He.isPath?Re=G(He.value,vt*pt):Re=Pt+vt*(pt-Pt),qt&&(He.isColor&&Be>2||(Re=Math.round(Re*qt)/qt)),oe.push(Re)}var Gt=bt.length;if(!Gt)Ce=oe[0];else{Ce=bt[0];for(var Wt=0;Wt<Gt;Wt++){var Rn=bt[Wt],sn=bt[Wt+1],Sn=oe[Wt];isNaN(Sn)||(sn?Ce+=Sn+sn:Ce+=Sn+" ")}}tn[q.type](re.target,q.property,Ce,re.transforms),q.currentValue=Ce,Ei++}}function Yt(yn){mt[yn]&&!mt.passThrough&&mt[yn](mt)}function lr(){mt.remaining&&mt.remaining!==!0&&mt.remaining--}function zn(yn){var Ei=mt.duration,ur=mt.delay,$n=Ei-mt.endDelay,q=cn(yn);mt.progress=f(q/Ei*100,0,100),mt.reversePlayback=q<mt.currentTime,Xe&&Wn(q),!mt.began&&mt.currentTime>0&&(mt.began=!0,Yt("begin"),Yt("loopBegin")),q<=ur&&mt.currentTime!==0&&mn(0),(q>=$n&&mt.currentTime!==Ei||!Ei)&&mn(Ei),q>ur&&q<$n?(mt.changeBegan||(mt.changeBegan=!0,mt.changeCompleted=!1,Yt("changeBegin")),Yt("change"),mn(q)):mt.changeBegan&&(mt.changeCompleted=!0,mt.changeBegan=!1,Yt("changeComplete")),mt.currentTime=f(q,0,Ei),mt.began&&Yt("update"),yn>=Ei&&(me=0,lr(),mt.remaining?(le=_e,Yt("loopComplete"),Yt("loopBegin"),mt.direction==="alternate"&&Bt()):(mt.paused=!0,mt.completed||(mt.completed=!0,Yt("loopComplete"),Yt("complete"),"Promise"in window&&(At(),Tt=Ct()))))}return mt.reset=function(){var yn=mt.direction;mt.passThrough=!1,mt.currentTime=0,mt.progress=0,mt.paused=!0,mt.began=!1,mt.changeBegan=!1,mt.completed=!1,mt.changeCompleted=!1,mt.reversePlayback=!1,mt.reversed=yn==="reverse",mt.remaining=mt.loop,Xe=mt.children,rt=Xe.length;for(var Ei=rt;Ei--;)mt.children[Ei].reset();(mt.reversed&&mt.loop!==!0||yn==="alternate"&&mt.loop===1)&&mt.remaining++,mn(0)},mt.set=function(yn,Ei){return En(yn,Ei),mt},mt.tick=function(yn){_e=yn,le||(le=_e),zn((_e+(me-le))*Ti.speed)},mt.seek=function(yn){zn(cn(yn))},mt.pause=function(){mt.paused=!0,Ln()},mt.play=function(){mt.paused&&(mt.paused=!1,In.push(mt),Ln(),Gn||fi())},mt.reverse=function(){Bt(),Ln()},mt.restart=function(){mt.reset(),mt.play()},mt.finished=Tt,mt.reset(),mt.autoplay&&mt.play(),mt}function ir(Y,le){for(var me=le.length;me--;)P(Y,le[me].animatable.target)&&le.splice(me,1)}function dr(Y){for(var le=Qe(Y),me=In.length;me--;){var _e=In[me],Xe=_e.animations,rt=_e.children;ir(le,Xe);for(var At=rt.length;At--;){var Ct=rt[At],Tt=Ct.animations;ir(le,Tt),!Tt.length&&!Ct.children.length&&rt.splice(At,1)}!Xe.length&&!rt.length&&_e.pause()}}function Ai(Y,le){le===void 0&&(le={});var me=le.direction||"normal",_e=le.easing?R(le.easing):null,Xe=le.grid,rt=le.axis,At=le.from||0,Ct=At==="first",Tt=At==="center",mt=At==="last",Bt=v.arr(Y),cn=parseFloat(Bt?Y[0]:Y),Ln=Bt?parseFloat(Y[1]):0,Hn=Rt(Bt?Y[1]:Y)||0,Wn=le.start||0+(Bt?cn:0),mn=[],Yt=0;return function(lr,zn,yn){if(Ct&&(At=0),Tt&&(At=(yn-1)/2),mt&&(At=yn-1),!mn.length){for(var Ei=0;Ei<yn;Ei++){if(!Xe)mn.push(Math.abs(At-Ei));else{var ur=Tt?(Xe[0]-1)/2:At%Xe[0],$n=Tt?(Xe[1]-1)/2:Math.floor(At/Xe[0]),q=Ei%Xe[0],re=Math.floor(Ei/Xe[0]),ye=ur-q,Se=$n-re,He=Math.sqrt(ye*ye+Se*Se);rt==="x"&&(He=-ye),rt==="y"&&(He=-Se),mn.push(He)}Yt=Math.max.apply(Math,mn)}_e&&(mn=mn.map(function(vt){return _e(vt/Yt)*Yt})),me==="reverse"&&(mn=mn.map(function(vt){return rt?vt<0?vt*-1:-vt:Math.abs(Yt-vt)}))}var at=Bt?(Ln-cn)/Yt:cn;return Wn+at*(Math.round(mn[zn]*100)/100)+Hn}}function Mi(Y){Y===void 0&&(Y={});var le=Ti(Y);return le.duration=0,le.add=function(me,_e){var Xe=In.indexOf(le),rt=le.children;Xe>-1&&In.splice(Xe,1);function At(Ln){Ln.passThrough=!0}for(var Ct=0;Ct<rt.length;Ct++)At(rt[Ct]);var Tt=Q(me,z(u,Y));Tt.targets=Tt.targets||Y.targets;var mt=le.duration;Tt.autoplay=!1,Tt.direction=le.direction,Tt.timelineOffset=v.und(_e)?mt:yt(_e,mt),At(le),le.seek(Tt.timelineOffset);var Bt=Ti(Tt);At(Bt),rt.push(Bt);var cn=xt(rt,Y);return le.delay=cn.delay,le.endDelay=cn.endDelay,le.duration=cn.duration,le.seek(0),le.reset(),le.autoplay&&le.play(),le},le}Ti.version="3.0.0",Ti.speed=1,Ti.running=In,Ti.remove=dr,Ti.get=Oe,Ti.set=En,Ti.convertPx=pn,Ti.path=V,Ti.setDashoffset=ze,Ti.stagger=Ai,Ti.timeline=Mi,Ti.easing=R,Ti.penner=F,Ti.random=function(Y,le){return Math.floor(Math.random()*(le-Y+1))+Y};let ne=Ti},"./node_modules/three-bmfont-text/index.js":(s,o,c)=>{var l=c("./node_modules/layout-bmfont-text/index.js"),u=c("./node_modules/quad-indices/index.js"),h=c("./node_modules/three-bmfont-text/lib/vertices.js"),p=c("./node_modules/three-bmfont-text/lib/utils.js");s.exports=function(A){return new f(A)};class f extends THREE.BufferGeometry{constructor(A){super(),typeof A=="string"&&(A={text:A}),this._opt=Object.assign({},A),A&&this.update(A)}update(A){if(typeof A=="string"&&(A={text:A}),A=Object.assign({},this._opt,A),!A.font)throw new TypeError("must specify a { font } in options");this.layout=l(A);var y=A.flipY!==!1,E=A.font,x=E.common.scaleW,v=E.common.scaleH,w=this.layout.glyphs.filter(function(I){var F=I.data;return F.width*F.height>0});this.visibleGlyphs=w;var M=h.positions(w),T=h.uvs(w,x,v,y),D=u([],{clockwise:!0,type:"uint16",count:w.length});if(this.setIndex(D),this.setAttribute("position",new THREE.BufferAttribute(M,2)),this.setAttribute("uv",new THREE.BufferAttribute(T,2)),!A.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(A.multipage){var L=h.pages(w);this.setAttribute("page",new THREE.BufferAttribute(L,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var A=this.attributes.position.array,y=this.attributes.position.itemSize;if(!A||!y||A.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}p.computeSphere(A,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var A=this.boundingBox,y=this.attributes.position.array,E=this.attributes.position.itemSize;if(!y||!E||y.length<2){A.makeEmpty();return}p.computeBox(y,A)}}},"./node_modules/three-bmfont-text/lib/utils.js":s=>{var o=2,c={min:[0,0],max:[0,0]};function l(u){var h=u.length/o;c.min[0]=u[0],c.min[1]=u[1],c.max[0]=u[0],c.max[1]=u[1];for(var p=0;p<h;p++){var f=u[p*o+0],m=u[p*o+1];c.min[0]=Math.min(f,c.min[0]),c.min[1]=Math.min(m,c.min[1]),c.max[0]=Math.max(f,c.max[0]),c.max[1]=Math.max(m,c.max[1])}}s.exports.computeBox=function(u,h){l(u),h.min.set(c.min[0],c.min[1],0),h.max.set(c.max[0],c.max[1],0)},s.exports.computeSphere=function(u,h){l(u);var p=c.min[0],f=c.min[1],m=c.max[0],A=c.max[1],y=m-p,E=A-f,x=Math.sqrt(y*y+E*E);h.center.set(p+y/2,f+E/2,0),h.radius=x/2}},"./node_modules/three-bmfont-text/lib/vertices.js":s=>{s.exports.pages=function(c){var l=new Float32Array(c.length*4*1),u=0;return c.forEach(function(h){var p=h.data.page||0;l[u++]=p,l[u++]=p,l[u++]=p,l[u++]=p}),l},s.exports.uvs=function(c,l,u,h){var p=new Float32Array(c.length*4*2),f=0;return c.forEach(function(m){var A=m.data,y=A.x+A.width,E=A.y+A.height,x=A.x/l,v=A.y/u,w=y/l,M=E/u;h&&(v=(u-A.y)/u,M=(u-E)/u),p[f++]=x,p[f++]=v,p[f++]=x,p[f++]=M,p[f++]=w,p[f++]=M,p[f++]=w,p[f++]=v}),p},s.exports.positions=function(c){var l=new Float32Array(c.length*4*2),u=0;return c.forEach(function(h){var p=h.data,f=h.position[0]+p.xoffset,m=h.position[1]+p.yoffset,A=p.width,y=p.height;l[u++]=f,l[u++]=m,l[u++]=f,l[u++]=m+y,l[u++]=f+A,l[u++]=m+y,l[u++]=f+A,l[u++]=m}),l}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(s,o,c){(function(l,u){s.exports=u()})(this,function(){"use strict";var l=typeof window<"u"?window:typeof c.g<"u"?c.g:typeof self<"u"?self:{};function u(D){return D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D}function h(D,L){return L={exports:{}},D(L,L.exports),L.exports}var p=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},f=function(L,I){for(var F=0,R=L.length;F<R;F++)I[F]=L[F]},m=function(L,I){for(var F in I)I.hasOwnProperty(F)&&(L[F]=I[F]);return L},A=h(function(D,L){(function(I,F){D.exports=F()})(l,function(){var I=function(q,re){if(!(q instanceof re))throw new TypeError("Cannot call a class as a function")},F=function(){function q(re,ye){for(var Se=0;Se<ye.length;Se++){var He=ye[Se];He.enumerable=He.enumerable||!1,He.configurable=!0,"value"in He&&(He.writable=!0),Object.defineProperty(re,He.key,He)}}return function(re,ye,Se){return ye&&q(re.prototype,ye),Se&&q(re,Se),re}}(),R=function(){function q(re,ye){var Se=[],He=!0,at=!1,vt=void 0;try{for(var bt=re[Symbol.iterator](),qt;!(He=(qt=bt.next()).done)&&(Se.push(qt.value),!(ye&&Se.length===ye));He=!0);}catch(oe){at=!0,vt=oe}finally{try{!He&&bt.return&&bt.return()}finally{if(at)throw vt}}return Se}return function(re,ye){if(Array.isArray(re))return re;if(Symbol.iterator in Object(re))return q(re,ye);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),N=.001,X=1,$=function(re,ye){return"data:"+re+","+encodeURIComponent(ye)},te=function(re,ye,Se){return re+(ye-re)*Se},U=function(){var q=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return q}}(),P=function(){var q=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return q}}(),k=function(){var q=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return q}}(),z=function(){var q=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return q}}(),Q=function(){var q=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),re=q?parseInt(q[1],10):null;return function(){return re}}(),Z=function(){var q=!1;return q=U()&&k()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return q}}(),ce=function(){var q=!1;if(Q()===65){var re=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(re){var ye=re[1].split("."),Se=R(ye,4),He=Se[0],at=Se[1],vt=Se[2],bt=Se[3];q=parseInt(vt,10)===3325&&parseInt(bt,10)<148}}return function(){return q}}(),Me=function(){var q=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return q}}(),xe=function(){var re=window.orientation==90||window.orientation==-90;return Me()?!re:re},be=function(re){return!(isNaN(re)||re<=N||re>X)},Fe=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Ze=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},ut=function(re){if(P())return!1;if(re.requestFullscreen)re.requestFullscreen();else if(re.webkitRequestFullscreen)re.webkitRequestFullscreen();else if(re.mozRequestFullScreen)re.mozRequestFullScreen();else if(re.msRequestFullscreen)re.msRequestFullscreen();else return!1;return!0},it=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},gt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Rt=function(re,ye,Se,He){var at=re.createShader(re.VERTEX_SHADER);re.shaderSource(at,ye),re.compileShader(at);var vt=re.createShader(re.FRAGMENT_SHADER);re.shaderSource(vt,Se),re.compileShader(vt);var bt=re.createProgram();re.attachShader(bt,at),re.attachShader(bt,vt);for(var qt in He)re.bindAttribLocation(bt,He[qt],qt);return re.linkProgram(bt),re.deleteShader(at),re.deleteShader(vt),bt},It=function(re,ye){for(var Se={},He=re.getProgramParameter(ye,re.ACTIVE_UNIFORMS),at="",vt=0;vt<He;vt++){var bt=re.getActiveUniform(ye,vt);at=bt.name.replace("[0]",""),Se[at]=re.getUniformLocation(ye,at)}return Se},Ft=function(re,ye,Se,He,at,vt,bt){var qt=1/(ye-Se),oe=1/(He-at),ue=1/(vt-bt);return re[0]=-2*qt,re[1]=0,re[2]=0,re[3]=0,re[4]=0,re[5]=-2*oe,re[6]=0,re[7]=0,re[8]=0,re[9]=0,re[10]=2*ue,re[11]=0,re[12]=(ye+Se)*qt,re[13]=(at+He)*oe,re[14]=(bt+vt)*ue,re[15]=1,re},Ne=function(){var re=!1;return function(ye){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(ye)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ye.substr(0,4)))&&(re=!0)}(navigator.userAgent||navigator.vendor||window.opera),re},pn=function(re,ye){for(var Se in ye)ye.hasOwnProperty(Se)&&(re[Se]=ye[Se]);return re},St=function(re){if(U()){var ye=re.style.width,Se=re.style.height;re.style.width=parseInt(ye)+1+"px",re.style.height=parseInt(Se)+"px",setTimeout(function(){re.style.width=ye,re.style.height=Se},100)}window.canvas=re},Vt=function(){var q=Math.PI/180,re=Math.PI*.25;function ye(oe,ue,Ce,Be){var Re=Math.tan(ue?ue.upDegrees*q:re),pt=Math.tan(ue?ue.downDegrees*q:re),Pt=Math.tan(ue?ue.leftDegrees*q:re),Gt=Math.tan(ue?ue.rightDegrees*q:re),Wt=2/(Pt+Gt),Rn=2/(Re+pt);return oe[0]=Wt,oe[1]=0,oe[2]=0,oe[3]=0,oe[4]=0,oe[5]=Rn,oe[6]=0,oe[7]=0,oe[8]=-((Pt-Gt)*Wt*.5),oe[9]=(Re-pt)*Rn*.5,oe[10]=Be/(Ce-Be),oe[11]=-1,oe[12]=0,oe[13]=0,oe[14]=Be*Ce/(Ce-Be),oe[15]=0,oe}function Se(oe,ue,Ce){var Be=ue[0],Re=ue[1],pt=ue[2],Pt=ue[3],Gt=Be+Be,Wt=Re+Re,Rn=pt+pt,sn=Be*Gt,Sn=Be*Wt,Jn=Be*Rn,Zn=Re*Wt,ri=Re*Rn,On=pt*Rn,oi=Pt*Gt,ci=Pt*Wt,Pi=Pt*Rn;return oe[0]=1-(Zn+On),oe[1]=Sn+Pi,oe[2]=Jn-ci,oe[3]=0,oe[4]=Sn-Pi,oe[5]=1-(sn+On),oe[6]=ri+oi,oe[7]=0,oe[8]=Jn+ci,oe[9]=ri-oi,oe[10]=1-(sn+Zn),oe[11]=0,oe[12]=Ce[0],oe[13]=Ce[1],oe[14]=Ce[2],oe[15]=1,oe}function He(oe,ue,Ce){var Be=Ce[0],Re=Ce[1],pt=Ce[2],Pt,Gt,Wt,Rn,sn,Sn,Jn,Zn,ri,On,oi,ci;return ue===oe?(oe[12]=ue[0]*Be+ue[4]*Re+ue[8]*pt+ue[12],oe[13]=ue[1]*Be+ue[5]*Re+ue[9]*pt+ue[13],oe[14]=ue[2]*Be+ue[6]*Re+ue[10]*pt+ue[14],oe[15]=ue[3]*Be+ue[7]*Re+ue[11]*pt+ue[15]):(Pt=ue[0],Gt=ue[1],Wt=ue[2],Rn=ue[3],sn=ue[4],Sn=ue[5],Jn=ue[6],Zn=ue[7],ri=ue[8],On=ue[9],oi=ue[10],ci=ue[11],oe[0]=Pt,oe[1]=Gt,oe[2]=Wt,oe[3]=Rn,oe[4]=sn,oe[5]=Sn,oe[6]=Jn,oe[7]=Zn,oe[8]=ri,oe[9]=On,oe[10]=oi,oe[11]=ci,oe[12]=Pt*Be+sn*Re+ri*pt+ue[12],oe[13]=Gt*Be+Sn*Re+On*pt+ue[13],oe[14]=Wt*Be+Jn*Re+oi*pt+ue[14],oe[15]=Rn*Be+Zn*Re+ci*pt+ue[15]),oe}function at(oe,ue){var Ce=ue[0],Be=ue[1],Re=ue[2],pt=ue[3],Pt=ue[4],Gt=ue[5],Wt=ue[6],Rn=ue[7],sn=ue[8],Sn=ue[9],Jn=ue[10],Zn=ue[11],ri=ue[12],On=ue[13],oi=ue[14],ci=ue[15],Pi=Ce*Gt-Be*Pt,vr=Ce*Wt-Re*Pt,Fr=Ce*Rn-pt*Pt,Ii=Be*Wt-Re*Gt,Qr=Be*Rn-pt*Gt,ai=Re*Rn-pt*Wt,Oo=sn*On-Sn*ri,xo=sn*oi-Jn*ri,Os=sn*ci-Zn*ri,cc=Sn*oi-Jn*On,ls=Sn*ci-Zn*On,Gr=Jn*ci-Zn*oi,Sr=Pi*Gr-vr*ls+Fr*cc+Ii*Os-Qr*xo+ai*Oo;return Sr?(Sr=1/Sr,oe[0]=(Gt*Gr-Wt*ls+Rn*cc)*Sr,oe[1]=(Re*ls-Be*Gr-pt*cc)*Sr,oe[2]=(On*ai-oi*Qr+ci*Ii)*Sr,oe[3]=(Jn*Qr-Sn*ai-Zn*Ii)*Sr,oe[4]=(Wt*Os-Pt*Gr-Rn*xo)*Sr,oe[5]=(Ce*Gr-Re*Os+pt*xo)*Sr,oe[6]=(oi*Fr-ri*ai-ci*vr)*Sr,oe[7]=(sn*ai-Jn*Fr+Zn*vr)*Sr,oe[8]=(Pt*ls-Gt*Os+Rn*Oo)*Sr,oe[9]=(Be*Os-Ce*ls-pt*Oo)*Sr,oe[10]=(ri*Qr-On*Fr+ci*Pi)*Sr,oe[11]=(Sn*Fr-sn*Qr-Zn*Pi)*Sr,oe[12]=(Gt*xo-Pt*cc-Wt*Oo)*Sr,oe[13]=(Ce*cc-Be*xo+Re*Oo)*Sr,oe[14]=(On*vr-ri*Ii-oi*Pi)*Sr,oe[15]=(sn*Ii-Sn*vr+Jn*Pi)*Sr,oe):null}var vt=new Float32Array([0,0,0,1]),bt=new Float32Array([0,0,0]);function qt(oe,ue,Ce,Be,Re,pt){ye(oe,Be||null,pt.depthNear,pt.depthFar);var Pt=Ce.orientation||vt,Gt=Ce.position||bt;Se(ue,Pt,Gt),Re&&He(ue,ue,Re),at(ue,ue)}return function(oe,ue,Ce){return!oe||!ue?!1:(oe.pose=ue,oe.timestamp=ue.timestamp,qt(oe.leftProjectionMatrix,oe.leftViewMatrix,ue,Ce._getFieldOfView("left"),Ce._getEyeOffset("left"),Ce),qt(oe.rightProjectionMatrix,oe.rightViewMatrix,ue,Ce._getFieldOfView("right"),Ce._getEyeOffset("right"),Ce),!0)}}(),Ot=function(){var re=window.self!==window.top,ye=xn(document.referrer),Se=xn(window.location.href);return re&&ye!==Se},xn=function(re){var ye,Se=re.indexOf("://");Se!==-1?ye=Se+3:ye=0;var He=re.indexOf("/",ye);return He===-1&&(He=re.length),re.substring(0,He)},Jt=function(re){if(re.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var ye=2*Math.acos(re.w);return ye},Oe=function(){var q={};return function(re,ye){q[re]===void 0&&(console.warn("webvr-polyfill: "+ye),q[re]=!0)}}(),Ie=function(re,ye){var Se=ye?"Please use "+ye+" instead.":"";Oe(re,re+" has been deprecated. This may not work on native WebVR displays. "+Se)};function yt(q,re,ye){if(!re){ye(q);return}for(var Se=[],He=null,at=0;at<re.length;++at){var vt=re[at];switch(vt){case q.TEXTURE_BINDING_2D:case q.TEXTURE_BINDING_CUBE_MAP:var bt=re[++at];if(bt<q.TEXTURE0||bt>q.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),Se.push(null,null);break}He||(He=q.getParameter(q.ACTIVE_TEXTURE)),q.activeTexture(bt),Se.push(q.getParameter(vt),null);break;case q.ACTIVE_TEXTURE:He=q.getParameter(q.ACTIVE_TEXTURE),Se.push(null);break;default:Se.push(q.getParameter(vt));break}}ye(q);for(var at=0;at<re.length;++at){var vt=re[at],qt=Se[at];switch(vt){case q.ACTIVE_TEXTURE:break;case q.ARRAY_BUFFER_BINDING:q.bindBuffer(q.ARRAY_BUFFER,qt);break;case q.COLOR_CLEAR_VALUE:q.clearColor(qt[0],qt[1],qt[2],qt[3]);break;case q.COLOR_WRITEMASK:q.colorMask(qt[0],qt[1],qt[2],qt[3]);break;case q.CURRENT_PROGRAM:q.useProgram(qt);break;case q.ELEMENT_ARRAY_BUFFER_BINDING:q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,qt);break;case q.FRAMEBUFFER_BINDING:q.bindFramebuffer(q.FRAMEBUFFER,qt);break;case q.RENDERBUFFER_BINDING:q.bindRenderbuffer(q.RENDERBUFFER,qt);break;case q.TEXTURE_BINDING_2D:var bt=re[++at];if(bt<q.TEXTURE0||bt>q.TEXTURE31)break;q.activeTexture(bt),q.bindTexture(q.TEXTURE_2D,qt);break;case q.TEXTURE_BINDING_CUBE_MAP:var bt=re[++at];if(bt<q.TEXTURE0||bt>q.TEXTURE31)break;q.activeTexture(bt),q.bindTexture(q.TEXTURE_CUBE_MAP,qt);break;case q.VIEWPORT:q.viewport(qt[0],qt[1],qt[2],qt[3]);break;case q.BLEND:case q.CULL_FACE:case q.DEPTH_TEST:case q.SCISSOR_TEST:case q.STENCIL_TEST:qt?q.enable(vt):q.disable(vt);break;default:console.log("No GL restore behavior for 0x"+vt.toString(16));break}He&&q.activeTexture(He)}}var kt=yt,De=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),he=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function ae(q,re,ye,Se){this.gl=q,this.cardboardUI=re,this.bufferScale=ye,this.dirtySubmitFrameBindings=Se,this.ctxAttribs=q.getContextAttributes(),this.instanceExt=q.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=q.drawingBufferWidth,this.bufferHeight=q.drawingBufferHeight,this.realBindFramebuffer=q.bindFramebuffer,this.realEnable=q.enable,this.realDisable=q.disable,this.realColorMask=q.colorMask,this.realClearColor=q.clearColor,this.realViewport=q.viewport,U()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(q.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(q.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Rt(q,De,he,this.attribs),this.uniforms=It(q,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=q.createBuffer(),this.indexBuffer=q.createBuffer(),this.indexCount=0,this.renderTarget=q.createTexture(),this.framebuffer=q.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=q.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=q.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=q.createRenderbuffer()),this.patch(),this.onResize()}ae.prototype.destroy=function(){var q=this.gl;this.unpatch(),q.deleteProgram(this.program),q.deleteBuffer(this.vertexBuffer),q.deleteBuffer(this.indexBuffer),q.deleteTexture(this.renderTarget),q.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&q.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&q.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&q.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},ae.prototype.onResize=function(){var q=this.gl,re=this,ye=[q.RENDERBUFFER_BINDING,q.TEXTURE_BINDING_2D,q.TEXTURE0];kt(q,ye,function(Se){re.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,null),re.scissorTest&&re.realDisable.call(Se,Se.SCISSOR_TEST),re.realColorMask.call(Se,!0,!0,!0,!0),re.realViewport.call(Se,0,0,Se.drawingBufferWidth,Se.drawingBufferHeight),re.realClearColor.call(Se,0,0,0,1),Se.clear(Se.COLOR_BUFFER_BIT),re.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,re.framebuffer),Se.bindTexture(Se.TEXTURE_2D,re.renderTarget),Se.texImage2D(Se.TEXTURE_2D,0,re.ctxAttribs.alpha?Se.RGBA:Se.RGB,re.bufferWidth,re.bufferHeight,0,re.ctxAttribs.alpha?Se.RGBA:Se.RGB,Se.UNSIGNED_BYTE,null),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MAG_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MIN_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_S,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_T,Se.CLAMP_TO_EDGE),Se.framebufferTexture2D(Se.FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_2D,re.renderTarget,0),re.ctxAttribs.depth&&re.ctxAttribs.stencil?(Se.bindRenderbuffer(Se.RENDERBUFFER,re.depthStencilBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.DEPTH_STENCIL,re.bufferWidth,re.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.DEPTH_STENCIL_ATTACHMENT,Se.RENDERBUFFER,re.depthStencilBuffer)):re.ctxAttribs.depth?(Se.bindRenderbuffer(Se.RENDERBUFFER,re.depthBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.DEPTH_COMPONENT16,re.bufferWidth,re.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.DEPTH_ATTACHMENT,Se.RENDERBUFFER,re.depthBuffer)):re.ctxAttribs.stencil&&(Se.bindRenderbuffer(Se.RENDERBUFFER,re.stencilBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.STENCIL_INDEX8,re.bufferWidth,re.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.STENCIL_ATTACHMENT,Se.RENDERBUFFER,re.stencilBuffer)),!Se.checkFramebufferStatus(Se.FRAMEBUFFER)===Se.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),re.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,re.lastBoundFramebuffer),re.scissorTest&&re.realEnable.call(Se,Se.SCISSOR_TEST),re.realColorMask.apply(Se,re.colorMask),re.realViewport.apply(Se,re.viewport),re.realClearColor.apply(Se,re.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},ae.prototype.patch=function(){if(!this.isPatched){var q=this,re=this.gl.canvas,ye=this.gl;U()||(re.width=Fe()*this.bufferScale,re.height=Ze()*this.bufferScale,Object.defineProperty(re,"width",{configurable:!0,enumerable:!0,get:function(){return q.bufferWidth},set:function(He){q.bufferWidth=He,q.realCanvasWidth.set.call(re,He),q.onResize()}}),Object.defineProperty(re,"height",{configurable:!0,enumerable:!0,get:function(){return q.bufferHeight},set:function(He){q.bufferHeight=He,q.realCanvasHeight.set.call(re,He),q.onResize()}})),this.lastBoundFramebuffer=ye.getParameter(ye.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(ye.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(Se,He){q.lastBoundFramebuffer=He||q.framebuffer,q.realBindFramebuffer.call(ye,Se,q.lastBoundFramebuffer)},this.cullFace=ye.getParameter(ye.CULL_FACE),this.depthTest=ye.getParameter(ye.DEPTH_TEST),this.blend=ye.getParameter(ye.BLEND),this.scissorTest=ye.getParameter(ye.SCISSOR_TEST),this.stencilTest=ye.getParameter(ye.STENCIL_TEST),ye.enable=function(Se){switch(Se){case ye.CULL_FACE:q.cullFace=!0;break;case ye.DEPTH_TEST:q.depthTest=!0;break;case ye.BLEND:q.blend=!0;break;case ye.SCISSOR_TEST:q.scissorTest=!0;break;case ye.STENCIL_TEST:q.stencilTest=!0;break}q.realEnable.call(ye,Se)},ye.disable=function(Se){switch(Se){case ye.CULL_FACE:q.cullFace=!1;break;case ye.DEPTH_TEST:q.depthTest=!1;break;case ye.BLEND:q.blend=!1;break;case ye.SCISSOR_TEST:q.scissorTest=!1;break;case ye.STENCIL_TEST:q.stencilTest=!1;break}q.realDisable.call(ye,Se)},this.colorMask=ye.getParameter(ye.COLOR_WRITEMASK),ye.colorMask=function(Se,He,at,vt){q.colorMask[0]=Se,q.colorMask[1]=He,q.colorMask[2]=at,q.colorMask[3]=vt,q.realColorMask.call(ye,Se,He,at,vt)},this.clearColor=ye.getParameter(ye.COLOR_CLEAR_VALUE),ye.clearColor=function(Se,He,at,vt){q.clearColor[0]=Se,q.clearColor[1]=He,q.clearColor[2]=at,q.clearColor[3]=vt,q.realClearColor.call(ye,Se,He,at,vt)},this.viewport=ye.getParameter(ye.VIEWPORT),ye.viewport=function(Se,He,at,vt){q.viewport[0]=Se,q.viewport[1]=He,q.viewport[2]=at,q.viewport[3]=vt,q.realViewport.call(ye,Se,He,at,vt)},this.isPatched=!0,St(re)}},ae.prototype.unpatch=function(){if(this.isPatched){var q=this.gl,re=this.gl.canvas;U()||(Object.defineProperty(re,"width",this.realCanvasWidth),Object.defineProperty(re,"height",this.realCanvasHeight)),re.width=this.bufferWidth,re.height=this.bufferHeight,q.bindFramebuffer=this.realBindFramebuffer,q.enable=this.realEnable,q.disable=this.realDisable,q.colorMask=this.realColorMask,q.clearColor=this.realClearColor,q.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&q.bindFramebuffer(q.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){St(re)},1)}},ae.prototype.setTextureBounds=function(q,re){q||(q=[0,0,.5,1]),re||(re=[.5,0,.5,1]),this.viewportOffsetScale[0]=q[0],this.viewportOffsetScale[1]=q[1],this.viewportOffsetScale[2]=q[2],this.viewportOffsetScale[3]=q[3],this.viewportOffsetScale[4]=re[0],this.viewportOffsetScale[5]=re[1],this.viewportOffsetScale[6]=re[2],this.viewportOffsetScale[7]=re[3]},ae.prototype.submitFrame=function(){var q=this.gl,re=this,ye=[];if(this.dirtySubmitFrameBindings||ye.push(q.CURRENT_PROGRAM,q.ARRAY_BUFFER_BINDING,q.ELEMENT_ARRAY_BUFFER_BINDING,q.TEXTURE_BINDING_2D,q.TEXTURE0),kt(q,ye,function(He){re.realBindFramebuffer.call(He,He.FRAMEBUFFER,null);var at=0,vt=0;re.instanceExt&&(at=He.getVertexAttrib(re.attribs.position,re.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),vt=He.getVertexAttrib(re.attribs.texCoord,re.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),re.cullFace&&re.realDisable.call(He,He.CULL_FACE),re.depthTest&&re.realDisable.call(He,He.DEPTH_TEST),re.blend&&re.realDisable.call(He,He.BLEND),re.scissorTest&&re.realDisable.call(He,He.SCISSOR_TEST),re.stencilTest&&re.realDisable.call(He,He.STENCIL_TEST),re.realColorMask.call(He,!0,!0,!0,!0),re.realViewport.call(He,0,0,He.drawingBufferWidth,He.drawingBufferHeight),(re.ctxAttribs.alpha||U())&&(re.realClearColor.call(He,0,0,0,1),He.clear(He.COLOR_BUFFER_BIT)),He.useProgram(re.program),He.bindBuffer(He.ELEMENT_ARRAY_BUFFER,re.indexBuffer),He.bindBuffer(He.ARRAY_BUFFER,re.vertexBuffer),He.enableVertexAttribArray(re.attribs.position),He.enableVertexAttribArray(re.attribs.texCoord),He.vertexAttribPointer(re.attribs.position,2,He.FLOAT,!1,20,0),He.vertexAttribPointer(re.attribs.texCoord,3,He.FLOAT,!1,20,8),re.instanceExt&&(at!=0&&re.instanceExt.vertexAttribDivisorANGLE(re.attribs.position,0),vt!=0&&re.instanceExt.vertexAttribDivisorANGLE(re.attribs.texCoord,0)),He.activeTexture(He.TEXTURE0),He.uniform1i(re.uniforms.diffuse,0),He.bindTexture(He.TEXTURE_2D,re.renderTarget),He.uniform4fv(re.uniforms.viewportOffsetScale,re.viewportOffsetScale),He.drawElements(He.TRIANGLES,re.indexCount,He.UNSIGNED_SHORT,0),re.cardboardUI&&re.cardboardUI.renderNoState(),re.realBindFramebuffer.call(re.gl,He.FRAMEBUFFER,re.framebuffer),re.ctxAttribs.preserveDrawingBuffer||(re.realClearColor.call(He,0,0,0,0),He.clear(He.COLOR_BUFFER_BIT)),re.dirtySubmitFrameBindings||re.realBindFramebuffer.call(He,He.FRAMEBUFFER,re.lastBoundFramebuffer),re.cullFace&&re.realEnable.call(He,He.CULL_FACE),re.depthTest&&re.realEnable.call(He,He.DEPTH_TEST),re.blend&&re.realEnable.call(He,He.BLEND),re.scissorTest&&re.realEnable.call(He,He.SCISSOR_TEST),re.stencilTest&&re.realEnable.call(He,He.STENCIL_TEST),re.realColorMask.apply(He,re.colorMask),re.realViewport.apply(He,re.viewport),(re.ctxAttribs.alpha||!re.ctxAttribs.preserveDrawingBuffer)&&re.realClearColor.apply(He,re.clearColor),re.instanceExt&&(at!=0&&re.instanceExt.vertexAttribDivisorANGLE(re.attribs.position,at),vt!=0&&re.instanceExt.vertexAttribDivisorANGLE(re.attribs.texCoord,vt))}),U()){var Se=q.canvas;(Se.width!=re.bufferWidth||Se.height!=re.bufferHeight)&&(re.bufferWidth=Se.width,re.bufferHeight=Se.height,re.onResize())}},ae.prototype.updateDeviceInfo=function(q){var re=this.gl,ye=this,Se=[re.ARRAY_BUFFER_BINDING,re.ELEMENT_ARRAY_BUFFER_BINDING];kt(re,Se,function(He){var at=ye.computeMeshVertices_(ye.meshWidth,ye.meshHeight,q);if(He.bindBuffer(He.ARRAY_BUFFER,ye.vertexBuffer),He.bufferData(He.ARRAY_BUFFER,at,He.STATIC_DRAW),!ye.indexCount){var vt=ye.computeMeshIndices_(ye.meshWidth,ye.meshHeight);He.bindBuffer(He.ELEMENT_ARRAY_BUFFER,ye.indexBuffer),He.bufferData(He.ELEMENT_ARRAY_BUFFER,vt,He.STATIC_DRAW),ye.indexCount=vt.length}})},ae.prototype.computeMeshVertices_=function(q,re,ye){for(var Se=new Float32Array(2*q*re*5),He=ye.getLeftEyeVisibleTanAngles(),at=ye.getLeftEyeNoLensTanAngles(),vt=ye.getLeftEyeVisibleScreenRect(at),bt=0,qt=0;qt<2;qt++){for(var oe=0;oe<re;oe++)for(var ue=0;ue<q;ue++,bt++){var Ce=ue/(q-1),Be=oe/(re-1),Re=Ce,pt=Be,Pt=te(He[0],He[2],Ce),Gt=te(He[3],He[1],Be),Wt=Math.sqrt(Pt*Pt+Gt*Gt),Rn=ye.distortion.distortInverse(Wt),sn=Pt*Rn/Wt,Sn=Gt*Rn/Wt;Ce=(sn-at[0])/(at[2]-at[0]),Be=(Sn-at[3])/(at[1]-at[3]),Ce=(vt.x+Ce*vt.width-.5)*2,Be=(vt.y+Be*vt.height-.5)*2,Se[bt*5+0]=Ce,Se[bt*5+1]=Be,Se[bt*5+2]=Re,Se[bt*5+3]=pt,Se[bt*5+4]=qt}var Jn=He[2]-He[0];He[0]=-(Jn+He[0]),He[2]=Jn-He[2],Jn=at[2]-at[0],at[0]=-(Jn+at[0]),at[2]=Jn-at[2],vt.x=1-(vt.x+vt.width)}return Se},ae.prototype.computeMeshIndices_=function(q,re){for(var ye=new Uint16Array(2*(q-1)*(re-1)*6),Se=q/2,He=re/2,at=0,vt=0,bt=0;bt<2;bt++)for(var qt=0;qt<re;qt++)for(var oe=0;oe<q;oe++,at++)oe==0||qt==0||(oe<=Se==qt<=He?(ye[vt++]=at,ye[vt++]=at-q-1,ye[vt++]=at-q,ye[vt++]=at-q-1,ye[vt++]=at,ye[vt++]=at-1):(ye[vt++]=at-1,ye[vt++]=at-q,ye[vt++]=at,ye[vt++]=at-q,ye[vt++]=at-1,ye[vt++]=at-q-1));return ye},ae.prototype.getOwnPropertyDescriptor_=function(q,re){var ye=Object.getOwnPropertyDescriptor(q,re);return(ye.get===void 0||ye.set===void 0)&&(ye.configurable=!0,ye.enumerable=!0,ye.get=function(){return this.getAttribute(re)},ye.set=function(Se){this.setAttribute(re,Se)}),ye};var de=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),we=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),Ae=Math.PI/180,Le=60,Ee=12,ze=20,Ge=1,ee=.75,V=.3125,G=4,pe=28,Ue=1.5;function Qe(q){this.gl=q,this.attribs={position:0},this.program=Rt(q,de,we,this.attribs),this.uniforms=It(q,this.program),this.vertexBuffer=q.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Qe.prototype.destroy=function(){var q=this.gl;this.listener&&q.canvas.removeEventListener("click",this.listener,!1),q.deleteProgram(this.program),q.deleteBuffer(this.vertexBuffer)},Qe.prototype.listen=function(q,re){var ye=this.gl.canvas;this.listener=function(Se){var He=ye.clientWidth/2,at=pe*Ue;Se.clientX>He-at&&Se.clientX<He+at&&Se.clientY>ye.clientHeight-at?q(Se):Se.clientX<at&&Se.clientY<at&&re(Se)},ye.addEventListener("click",this.listener,!1)},Qe.prototype.onResize=function(){var q=this.gl,re=this,ye=[q.ARRAY_BUFFER_BINDING];kt(q,ye,function(Se){var He=[],at=Se.drawingBufferWidth/2,vt=Math.max(screen.width,screen.height)*window.devicePixelRatio,bt=Se.drawingBufferWidth/vt,qt=bt*window.devicePixelRatio,oe=G*qt/2,ue=pe*Ue*qt,Ce=pe*qt/2,Be=(pe*Ue-pe)*qt;He.push(at-oe,ue),He.push(at-oe,Se.drawingBufferHeight),He.push(at+oe,ue),He.push(at+oe,Se.drawingBufferHeight),re.gearOffset=He.length/2;function Re(Rn,sn){var Sn=(90-Rn)*Ae,Jn=Math.cos(Sn),Zn=Math.sin(Sn);He.push(V*Jn*Ce+at,V*Zn*Ce+Ce),He.push(sn*Jn*Ce+at,sn*Zn*Ce+Ce)}for(var pt=0;pt<=6;pt++){var Pt=pt*Le;Re(Pt,Ge),Re(Pt+Ee,Ge),Re(Pt+ze,ee),Re(Pt+(Le-ze),ee),Re(Pt+(Le-Ee),Ge)}re.gearVertexCount=He.length/2-re.gearOffset,re.arrowOffset=He.length/2;function Gt(Rn,sn){He.push(Be+Rn,Se.drawingBufferHeight-Be-sn)}var Wt=oe/Math.sin(45*Ae);Gt(0,Ce),Gt(Ce,0),Gt(Ce+Wt,Wt),Gt(Wt,Ce+Wt),Gt(Wt,Ce-Wt),Gt(0,Ce),Gt(Ce,Ce*2),Gt(Ce+Wt,Ce*2-Wt),Gt(Wt,Ce-Wt),Gt(0,Ce),Gt(Wt,Ce-oe),Gt(pe*qt,Ce-oe),Gt(Wt,Ce+oe),Gt(pe*qt,Ce+oe),re.arrowVertexCount=He.length/2-re.arrowOffset,Se.bindBuffer(Se.ARRAY_BUFFER,re.vertexBuffer),Se.bufferData(Se.ARRAY_BUFFER,new Float32Array(He),Se.STATIC_DRAW)})},Qe.prototype.render=function(){var q=this.gl,re=this,ye=[q.CULL_FACE,q.DEPTH_TEST,q.BLEND,q.SCISSOR_TEST,q.STENCIL_TEST,q.COLOR_WRITEMASK,q.VIEWPORT,q.CURRENT_PROGRAM,q.ARRAY_BUFFER_BINDING];kt(q,ye,function(Se){Se.disable(Se.CULL_FACE),Se.disable(Se.DEPTH_TEST),Se.disable(Se.BLEND),Se.disable(Se.SCISSOR_TEST),Se.disable(Se.STENCIL_TEST),Se.colorMask(!0,!0,!0,!0),Se.viewport(0,0,Se.drawingBufferWidth,Se.drawingBufferHeight),re.renderNoState()})},Qe.prototype.renderNoState=function(){var q=this.gl;q.useProgram(this.program),q.bindBuffer(q.ARRAY_BUFFER,this.vertexBuffer),q.enableVertexAttribArray(this.attribs.position),q.vertexAttribPointer(this.attribs.position,2,q.FLOAT,!1,8,0),q.uniform4f(this.uniforms.color,1,1,1,1),Ft(this.projMat,0,q.drawingBufferWidth,0,q.drawingBufferHeight,.1,1024),q.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),q.drawArrays(q.TRIANGLE_STRIP,0,4),q.drawArrays(q.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),q.drawArrays(q.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function $e(q){this.coefficients=q}$e.prototype.distortInverse=function(q){for(var re=0,ye=1,Se=q-this.distort(re);Math.abs(ye-re)>1e-4;){var He=q-this.distort(ye),at=ye-He*((ye-re)/(He-Se));re=ye,ye=at,Se=He}return ye},$e.prototype.distort=function(q){for(var re=q*q,ye=0,Se=0;Se<this.coefficients.length;Se++)ye=re*(ye+this.coefficients[Se]);return(ye+1)*q};var nt=Math.PI/180,ge=180/Math.PI,ot=function(re,ye,Se){this.x=re||0,this.y=ye||0,this.z=Se||0};ot.prototype={constructor:ot,set:function(re,ye,Se){return this.x=re,this.y=ye,this.z=Se,this},copy:function(re){return this.x=re.x,this.y=re.y,this.z=re.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var re=this.length();if(re!==0){var ye=1/re;this.multiplyScalar(ye)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(re){this.x*=re,this.y*=re,this.z*=re},applyQuaternion:function(re){var ye=this.x,Se=this.y,He=this.z,at=re.x,vt=re.y,bt=re.z,qt=re.w,oe=qt*ye+vt*He-bt*Se,ue=qt*Se+bt*ye-at*He,Ce=qt*He+at*Se-vt*ye,Be=-at*ye-vt*Se-bt*He;return this.x=oe*qt+Be*-at+ue*-bt-Ce*-vt,this.y=ue*qt+Be*-vt+Ce*-at-oe*-bt,this.z=Ce*qt+Be*-bt+oe*-vt-ue*-at,this},dot:function(re){return this.x*re.x+this.y*re.y+this.z*re.z},crossVectors:function(re,ye){var Se=re.x,He=re.y,at=re.z,vt=ye.x,bt=ye.y,qt=ye.z;return this.x=He*qt-at*bt,this.y=at*vt-Se*qt,this.z=Se*bt-He*vt,this}};var et=function(re,ye,Se,He){this.x=re||0,this.y=ye||0,this.z=Se||0,this.w=He!==void 0?He:1};et.prototype={constructor:et,set:function(re,ye,Se,He){return this.x=re,this.y=ye,this.z=Se,this.w=He,this},copy:function(re){return this.x=re.x,this.y=re.y,this.z=re.z,this.w=re.w,this},setFromEulerXYZ:function(re,ye,Se){var He=Math.cos(re/2),at=Math.cos(ye/2),vt=Math.cos(Se/2),bt=Math.sin(re/2),qt=Math.sin(ye/2),oe=Math.sin(Se/2);return this.x=bt*at*vt+He*qt*oe,this.y=He*qt*vt-bt*at*oe,this.z=He*at*oe+bt*qt*vt,this.w=He*at*vt-bt*qt*oe,this},setFromEulerYXZ:function(re,ye,Se){var He=Math.cos(re/2),at=Math.cos(ye/2),vt=Math.cos(Se/2),bt=Math.sin(re/2),qt=Math.sin(ye/2),oe=Math.sin(Se/2);return this.x=bt*at*vt+He*qt*oe,this.y=He*qt*vt-bt*at*oe,this.z=He*at*oe-bt*qt*vt,this.w=He*at*vt+bt*qt*oe,this},setFromAxisAngle:function(re,ye){var Se=ye/2,He=Math.sin(Se);return this.x=re.x*He,this.y=re.y*He,this.z=re.z*He,this.w=Math.cos(Se),this},multiply:function(re){return this.multiplyQuaternions(this,re)},multiplyQuaternions:function(re,ye){var Se=re.x,He=re.y,at=re.z,vt=re.w,bt=ye.x,qt=ye.y,oe=ye.z,ue=ye.w;return this.x=Se*ue+vt*bt+He*oe-at*qt,this.y=He*ue+vt*qt+at*bt-Se*oe,this.z=at*ue+vt*oe+Se*qt-He*bt,this.w=vt*ue-Se*bt-He*qt-at*oe,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var re=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return re===0?(this.x=0,this.y=0,this.z=0,this.w=1):(re=1/re,this.x=this.x*re,this.y=this.y*re,this.z=this.z*re,this.w=this.w*re),this},slerp:function(re,ye){if(ye===0)return this;if(ye===1)return this.copy(re);var Se=this.x,He=this.y,at=this.z,vt=this.w,bt=vt*re.w+Se*re.x+He*re.y+at*re.z;if(bt<0?(this.w=-re.w,this.x=-re.x,this.y=-re.y,this.z=-re.z,bt=-bt):this.copy(re),bt>=1)return this.w=vt,this.x=Se,this.y=He,this.z=at,this;var qt=Math.acos(bt),oe=Math.sqrt(1-bt*bt);if(Math.abs(oe)<.001)return this.w=.5*(vt+this.w),this.x=.5*(Se+this.x),this.y=.5*(He+this.y),this.z=.5*(at+this.z),this;var ue=Math.sin((1-ye)*qt)/oe,Ce=Math.sin(ye*qt)/oe;return this.w=vt*ue+this.w*Ce,this.x=Se*ue+this.x*Ce,this.y=He*ue+this.y*Ce,this.z=at*ue+this.z*Ce,this},setFromUnitVectors:function(){var q,re,ye=1e-6;return function(Se,He){return q===void 0&&(q=new ot),re=Se.dot(He)+1,re<ye?(re=0,Math.abs(Se.x)>Math.abs(Se.z)?q.set(-Se.y,Se.x,0):q.set(0,-Se.z,Se.y)):q.crossVectors(Se,He),this.x=q.x,this.y=q.y,this.z=q.z,this.w=re,this.normalize(),this}}()};function tt(q){this.width=q.width||Fe(),this.height=q.height||Ze(),this.widthMeters=q.widthMeters,this.heightMeters=q.heightMeters,this.bevelMeters=q.bevelMeters}var _t=new tt({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),tn=new tt({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),En={CardboardV1:new en({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new en({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Cn(q,re){this.viewer=En.CardboardV2,this.updateDeviceParams(q),this.distortion=new $e(this.viewer.distortionCoefficients);for(var ye=0;ye<re.length;ye++){var Se=re[ye];En[Se.id]=new en(Se)}}Cn.prototype.updateDeviceParams=function(q){this.device=this.determineDevice_(q)||this.device},Cn.prototype.getDevice=function(){return this.device},Cn.prototype.setViewer=function(q){this.viewer=q,this.distortion=new $e(this.viewer.distortionCoefficients)},Cn.prototype.determineDevice_=function(q){if(!q)return U()?(console.warn("Using fallback iOS device measurements."),tn):(console.warn("Using fallback Android device measurements."),_t);var re=.0254,ye=re/q.xdpi,Se=re/q.ydpi,He=Fe(),at=Ze();return new tt({widthMeters:ye*He,heightMeters:Se*at,bevelMeters:q.bevelMm*.001})},Cn.prototype.getDistortedFieldOfViewLeftEye=function(){var q=this.viewer,re=this.device,ye=this.distortion,Se=q.screenLensDistance,He=(re.widthMeters-q.interLensDistance)/2,at=q.interLensDistance/2,vt=q.baselineLensDistance-re.bevelMeters,bt=re.heightMeters-vt,qt=ge*Math.atan(ye.distort(He/Se)),oe=ge*Math.atan(ye.distort(at/Se)),ue=ge*Math.atan(ye.distort(vt/Se)),Ce=ge*Math.atan(ye.distort(bt/Se));return{leftDegrees:Math.min(qt,q.fov),rightDegrees:Math.min(oe,q.fov),downDegrees:Math.min(ue,q.fov),upDegrees:Math.min(Ce,q.fov)}},Cn.prototype.getLeftEyeVisibleTanAngles=function(){var q=this.viewer,re=this.device,ye=this.distortion,Se=Math.tan(-nt*q.fov),He=Math.tan(nt*q.fov),at=Math.tan(nt*q.fov),vt=Math.tan(-nt*q.fov),bt=re.widthMeters/4,qt=re.heightMeters/2,oe=q.baselineLensDistance-re.bevelMeters-qt,ue=q.interLensDistance/2-bt,Ce=-oe,Be=q.screenLensDistance,Re=ye.distort((ue-bt)/Be),pt=ye.distort((Ce+qt)/Be),Pt=ye.distort((ue+bt)/Be),Gt=ye.distort((Ce-qt)/Be),Wt=new Float32Array(4);return Wt[0]=Math.max(Se,Re),Wt[1]=Math.min(He,pt),Wt[2]=Math.min(at,Pt),Wt[3]=Math.max(vt,Gt),Wt},Cn.prototype.getLeftEyeNoLensTanAngles=function(){var q=this.viewer,re=this.device,ye=this.distortion,Se=new Float32Array(4),He=ye.distortInverse(Math.tan(-nt*q.fov)),at=ye.distortInverse(Math.tan(nt*q.fov)),vt=ye.distortInverse(Math.tan(nt*q.fov)),bt=ye.distortInverse(Math.tan(-nt*q.fov)),qt=re.widthMeters/4,oe=re.heightMeters/2,ue=q.baselineLensDistance-re.bevelMeters-oe,Ce=q.interLensDistance/2-qt,Be=-ue,Re=q.screenLensDistance,pt=(Ce-qt)/Re,Pt=(Be+oe)/Re,Gt=(Ce+qt)/Re,Wt=(Be-oe)/Re;return Se[0]=Math.max(He,pt),Se[1]=Math.min(at,Pt),Se[2]=Math.min(vt,Gt),Se[3]=Math.max(bt,Wt),Se},Cn.prototype.getLeftEyeVisibleScreenRect=function(q){var re=this.viewer,ye=this.device,Se=re.screenLensDistance,He=(ye.widthMeters-re.interLensDistance)/2,at=re.baselineLensDistance-ye.bevelMeters,vt=(q[0]*Se+He)/ye.widthMeters,bt=(q[1]*Se+at)/ye.heightMeters,qt=(q[2]*Se+He)/ye.widthMeters,oe=(q[3]*Se+at)/ye.heightMeters;return{x:vt,y:oe,width:qt-vt,height:bt-oe}},Cn.prototype.getFieldOfViewLeftEye=function(q){return q?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Cn.prototype.getFieldOfViewRightEye=function(q){var re=this.getFieldOfViewLeftEye(q);return{leftDegrees:re.rightDegrees,rightDegrees:re.leftDegrees,upDegrees:re.upDegrees,downDegrees:re.downDegrees}},Cn.prototype.getUndistortedFieldOfViewLeftEye=function(){var q=this.getUndistortedParams_();return{leftDegrees:ge*Math.atan(q.outerDist),rightDegrees:ge*Math.atan(q.innerDist),downDegrees:ge*Math.atan(q.bottomDist),upDegrees:ge*Math.atan(q.topDist)}},Cn.prototype.getUndistortedViewportLeftEye=function(){var q=this.getUndistortedParams_(),re=this.viewer,ye=this.device,Se=re.screenLensDistance,He=ye.widthMeters/Se,at=ye.heightMeters/Se,vt=ye.width/He,bt=ye.height/at,qt=Math.round((q.eyePosX-q.outerDist)*vt),oe=Math.round((q.eyePosY-q.bottomDist)*bt);return{x:qt,y:oe,width:Math.round((q.eyePosX+q.innerDist)*vt)-qt,height:Math.round((q.eyePosY+q.topDist)*bt)-oe}},Cn.prototype.getUndistortedParams_=function(){var q=this.viewer,re=this.device,ye=this.distortion,Se=q.screenLensDistance,He=q.interLensDistance/2/Se,at=re.widthMeters/Se,vt=re.heightMeters/Se,bt=at/2-He,qt=(q.baselineLensDistance-re.bevelMeters)/Se,oe=q.fov,ue=ye.distortInverse(Math.tan(nt*oe)),Ce=Math.min(bt,ue),Be=Math.min(He,ue),Re=Math.min(qt,ue),pt=Math.min(vt-qt,ue);return{outerDist:Ce,innerDist:Be,topDist:pt,bottomDist:Re,eyePosX:bt,eyePosY:qt}};function en(q){this.id=q.id,this.label=q.label,this.fov=q.fov,this.interLensDistance=q.interLensDistance,this.baselineLensDistance=q.baselineLensDistance,this.screenLensDistance=q.screenLensDistance,this.distortionCoefficients=q.distortionCoefficients,this.inverseCoefficients=q.inverseCoefficients}Cn.Viewers=En;var xt=1,jt="2019-11-09T17:36:14Z",Pn=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],In={format:xt,last_updated:jt,devices:Pn};function Kn(q,re){if(this.dpdb=In,this.recalculateDeviceParams_(),q){this.onDeviceParamsUpdated=re;var ye=new XMLHttpRequest,Se=this;ye.open("GET",q,!0),ye.addEventListener("load",function(){Se.loading=!1,ye.status>=200&&ye.status<=299?(Se.dpdb=JSON.parse(ye.response),Se.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),ye.send()}}Kn.prototype.getDeviceParams=function(){return this.deviceParams},Kn.prototype.recalculateDeviceParams_=function(){var q=this.calcDeviceParams_();q?(this.deviceParams=q,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Kn.prototype.calcDeviceParams_=function(){var q=this.dpdb;if(!q)return console.error("DPDB not available."),null;if(q.format!=1)return console.error("DPDB has unexpected format version."),null;if(!q.devices||!q.devices.length)return console.error("DPDB does not have a devices section."),null;var re=navigator.userAgent||navigator.vendor||window.opera,ye=Fe(),Se=Ze();if(!q.devices)return console.error("DPDB has no devices section."),null;for(var He=0;He<q.devices.length;He++){var at=q.devices[He];if(!at.rules){console.warn("Device["+He+"] has no rules section.");continue}if(at.type!="ios"&&at.type!="android"){console.warn("Device["+He+"] has invalid type.");continue}if(U()==(at.type=="ios")){for(var vt=!1,bt=0;bt<at.rules.length;bt++){var qt=at.rules[bt];if(this.ruleMatches_(qt,re,ye,Se)){vt=!0;break}}if(vt){var oe=at.dpi[0]||at.dpi,ue=at.dpi[1]||at.dpi;return new Gn({xdpi:oe,ydpi:ue,bevelMm:at.bw})}}}return console.warn("No DPDB device match."),null},Kn.prototype.ruleMatches_=function(q,re,ye,Se){if(!q.ua&&!q.res||(q.ua&&q.ua.substring(0,2)==="SM"&&(q.ua=q.ua.substring(0,7)),q.ua&&re.indexOf(q.ua)<0))return!1;if(q.res){if(!q.res[0]||!q.res[1])return!1;var He=q.res[0],at=q.res[1];if(Math.min(ye,Se)!=Math.min(He,at)||Math.max(ye,Se)!=Math.max(He,at))return!1}return!0};function Gn(q){this.xdpi=q.xdpi,this.ydpi=q.ydpi,this.bevelMm=q.bevelMm}function fi(q,re){this.set(q,re)}fi.prototype.set=function(q,re){this.sample=q,this.timestampS=re},fi.prototype.copy=function(q){this.set(q.sample,q.timestampS)};function xi(q,re){this.kFilter=q,this.isDebug=re,this.currentAccelMeasurement=new fi,this.currentGyroMeasurement=new fi,this.previousGyroMeasurement=new fi,U()?this.filterQ=new et(-1,0,0,1):this.filterQ=new et(1,0,0,1),this.previousFilterQ=new et,this.previousFilterQ.copy(this.filterQ),this.accelQ=new et,this.isOrientationInitialized=!1,this.estimatedGravity=new ot,this.measuredGravity=new ot,this.gyroIntegralQ=new et}xi.prototype.addAccelMeasurement=function(q,re){this.currentAccelMeasurement.set(q,re)},xi.prototype.addGyroMeasurement=function(q,re){this.currentGyroMeasurement.set(q,re);var ye=re-this.previousGyroMeasurement.timestampS;be(ye)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},xi.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var q=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,re=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,q);this.gyroIntegralQ.multiply(re),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(re);var ye=new et;ye.copy(this.filterQ),ye.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(ye),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var Se=new et;Se.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),Se.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ge*Jt(Se),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var He=new et;He.copy(this.filterQ),He.multiply(Se),this.filterQ.slerp(He,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},xi.prototype.getOrientation=function(){return this.filterQ},xi.prototype.accelToQuaternion_=function(q){var re=new ot;re.copy(q),re.normalize();var ye=new et;return ye.setFromUnitVectors(new ot(0,0,-1),re),ye.inverse(),ye},xi.prototype.gyroToQuaternionDelta_=function(q,re){var ye=new et,Se=new ot;return Se.copy(q),Se.normalize(),ye.setFromAxisAngle(Se,q.length()*re),ye};function Ti(q,re){this.predictionTimeS=q,this.isDebug=re,this.previousQ=new et,this.previousTimestampS=null,this.deltaQ=new et,this.outQ=new et}Ti.prototype.getPrediction=function(q,re,ye){if(!this.previousTimestampS)return this.previousQ.copy(q),this.previousTimestampS=ye,q;var Se=new ot;Se.copy(re),Se.normalize();var He=re.length();if(He<nt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(ge*He).toFixed(1)),this.outQ.copy(q),this.previousQ.copy(q),this.outQ;var at=He*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(Se,at),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(q),this.previousTimestampS=ye,this.outQ};function ir(q,re,ye,Se){this.yawOnly=ye,this.accelerometer=new ot,this.gyroscope=new ot,this.filter=new xi(q,Se),this.posePredictor=new Ti(re,Se),this.isFirefoxAndroid=z(),this.isIOS=U();var He=Q();this.isDeviceMotionInRadians=!this.isIOS&&He&&He<66,this.isWithoutDeviceMotion=ce()||Z(),this.filterToWorldQ=new et,U()?this.filterToWorldQ.setFromAxisAngle(new ot(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new ot(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new et,this.worldToScreenQ=new et,this.originalPoseAdjustQ=new et,this.originalPoseAdjustQ.setFromAxisAngle(new ot(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),xe()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new et,this.orientationOut_=new Float32Array(4),this.start()}ir.prototype.getPosition=function(){return null},ir.prototype.getOrientation=function(){var q=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var He=new et().setFromAxisAngle(new ot(0,0,-1),0),at=new et;return window.orientation===-90?at.setFromAxisAngle(new ot(0,1,0),Math.PI/-2):at.setFromAxisAngle(new ot(0,1,0),Math.PI/2),He.multiply(at)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var He=new et;return He.setFromAxisAngle(new ot(1,0,0),-Math.PI/2),He}(),q=this._deviceOrientationQ;var ye=new et;return ye.copy(q),ye.multiply(this.deviceOrientationFilterToWorldQ),ye.multiply(this.resetQ),ye.multiply(this.worldToScreenQ),ye.multiplyQuaternions(this.deviceOrientationFixQ,ye),this.yawOnly&&(ye.x=0,ye.z=0,ye.normalize()),this.orientationOut_[0]=ye.x,this.orientationOut_[1]=ye.y,this.orientationOut_[2]=ye.z,this.orientationOut_[3]=ye.w,this.orientationOut_}else{var re=this.filter.getOrientation();q=this.posePredictor.getPrediction(re,this.gyroscope,this.previousTimestampS)}var ye=new et;return ye.copy(this.filterToWorldQ),ye.multiply(this.resetQ),ye.multiply(q),ye.multiply(this.worldToScreenQ),this.yawOnly&&(ye.x=0,ye.z=0,ye.normalize()),this.orientationOut_[0]=ye.x,this.orientationOut_[1]=ye.y,this.orientationOut_[2]=ye.z,this.orientationOut_[3]=ye.w,this.orientationOut_},ir.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),xe()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ir.prototype.onDeviceOrientation_=function(q){this._deviceOrientationQ=this._deviceOrientationQ||new et;var re=q.alpha,ye=q.beta,Se=q.gamma;re=(re||0)*Math.PI/180,ye=(ye||0)*Math.PI/180,Se=(Se||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(ye,re,-Se)},ir.prototype.onDeviceMotion_=function(q){this.updateDeviceMotion_(q)},ir.prototype.updateDeviceMotion_=function(q){var re=q.accelerationIncludingGravity,ye=q.rotationRate,Se=q.timeStamp/1e3,He=Se-this.previousTimestampS;if(He<0){Oe("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=Se;return}else if(He<=N||He>X){Oe("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=Se;return}this.accelerometer.set(-re.x,-re.y,-re.z),ye&&(Me()?this.gyroscope.set(-ye.beta,ye.alpha,ye.gamma):this.gyroscope.set(ye.alpha,ye.beta,ye.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,Se)),this.filter.addAccelMeasurement(this.accelerometer,Se),this.previousTimestampS=Se},ir.prototype.onOrientationChange_=function(q){this.setScreenTransform_()},ir.prototype.onMessage_=function(q){var re=q.data;if(!(!re||!re.type)){var ye=re.type.toLowerCase();ye==="devicemotion"&&this.updateDeviceMotion_(re.deviceMotionEvent)}},ir.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new ot(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new ot(0,0,1),Math.PI/2);break;case 180:break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ir.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),U()&&Ot()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ir.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var dr=60,Ai=new ot(1,0,0),Mi=new ot(0,0,1),ne=new et;ne.setFromAxisAngle(Ai,-Math.PI/2),ne.multiply(new et().setFromAxisAngle(Mi,Math.PI/2));var Y=function(){function q(re){I(this,q),this.config=re,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new et,this._outQ=new et,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return F(q,[{key:"init",value:function(){var ye=null;try{ye=new RelativeOrientationSensor({frequency:dr,referenceFrame:"screen"}),ye.addEventListener("error",this._onSensorError)}catch(Se){this.errors.push(Se),Se.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):Se.name==="ReferenceError"?this.useDeviceMotion():console.error(Se)}ye&&(this.api="sensor",this.sensor=ye,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ir(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var ye=this.sensor.quaternion;this._sensorQ.set(ye[0],ye[1],ye[2],ye[3]);var Se=this._outQ;return Se.copy(ne),Se.multiply(this._sensorQ),this.config.YAW_ONLY&&(Se.x=Se.z=0,Se.normalize()),this._out[0]=Se.x,this._out[1]=Se.y,this._out[2]=Se.z,this._out[3]=Se.w,this._out}},{key:"_onSensorError",value:function(ye){this.errors.push(ye.error),ye.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):ye.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(ye.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),q}(),le="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function me(){this.loadIcon_();var q=document.createElement("div"),vt=q.style;vt.position="fixed",vt.top=0,vt.right=0,vt.bottom=0,vt.left=0,vt.backgroundColor="gray",vt.fontFamily="sans-serif",vt.zIndex=1e6;var re=document.createElement("img");re.src=this.icon;var vt=re.style;vt.marginLeft="25%",vt.marginTop="25%",vt.width="50%",q.appendChild(re);var ye=document.createElement("div"),vt=ye.style;vt.textAlign="center",vt.fontSize="16px",vt.lineHeight="24px",vt.margin="24px 25%",vt.width="50%",ye.innerHTML="Place your phone into your Cardboard viewer.",q.appendChild(ye);var Se=document.createElement("div"),vt=Se.style;vt.backgroundColor="#CFD8DC",vt.position="fixed",vt.bottom=0,vt.width="100%",vt.height="48px",vt.padding="14px 24px",vt.boxSizing="border-box",vt.color="#656A6B",q.appendChild(Se);var He=document.createElement("div");He.style.float="left",He.innerHTML="No Cardboard viewer?";var at=document.createElement("a");at.href="https://www.google.com/get/cardboard/get-cardboard/",at.innerHTML="get one",at.target="_blank";var vt=at.style;vt.float="right",vt.fontWeight=600,vt.textTransform="uppercase",vt.borderLeft="1px solid gray",vt.paddingLeft="24px",vt.textDecoration="none",vt.color="#656A6B",Se.appendChild(He),Se.appendChild(at),this.overlay=q,this.text=ye,this.hide()}me.prototype.show=function(q){!q&&!this.overlay.parentElement?document.body.appendChild(this.overlay):q&&(this.overlay.parentElement&&this.overlay.parentElement!=q&&this.overlay.parentElement.removeChild(this.overlay),q.appendChild(this.overlay)),this.overlay.style.display="block";var re=this.overlay.querySelector("img"),ye=re.style;xe()?(ye.width="20%",ye.marginLeft="40%",ye.marginTop="3%"):(ye.width="50%",ye.marginLeft="25%",ye.marginTop="25%")},me.prototype.hide=function(){this.overlay.style.display="none"},me.prototype.showTemporarily=function(q,re){this.show(re),this.timer=setTimeout(this.hide.bind(this),q)},me.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},me.prototype.update=function(){this.disableShowTemporarily(),!xe()&&Ne()?this.show():this.hide()},me.prototype.loadIcon_=function(){this.icon=$("image/svg+xml",le)};var _e="CardboardV1",Xe="WEBVR_CARDBOARD_VIEWER",rt="webvr-polyfill-viewer-selector";function At(q){try{this.selectedKey=localStorage.getItem(Xe)}catch(re){console.error("Failed to load viewer profile: %s",re)}this.selectedKey||(this.selectedKey=q||_e),this.dialog=this.createDialog_(Cn.Viewers),this.root=null,this.onChangeCallbacks_=[]}At.prototype.show=function(q){this.root=q,q.appendChild(this.dialog);var re=this.dialog.querySelector("#"+this.selectedKey);re.checked=!0,this.dialog.style.display="block"},At.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},At.prototype.getCurrentViewer=function(){return Cn.Viewers[this.selectedKey]},At.prototype.getSelectedKey_=function(){var q=this.dialog.querySelector("input[name=field]:checked");return q?q.id:null},At.prototype.onChange=function(q){this.onChangeCallbacks_.push(q)},At.prototype.fireOnChange_=function(q){for(var re=0;re<this.onChangeCallbacks_.length;re++)this.onChangeCallbacks_[re](q)},At.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Cn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Cn.Viewers[this.selectedKey]);try{localStorage.setItem(Xe,this.selectedKey)}catch(q){console.error("Failed to save viewer profile: %s",q)}this.hide()},At.prototype.createDialog_=function(q){var re=document.createElement("div");re.classList.add(rt),re.style.display="none";var ye=document.createElement("div"),at=ye.style;at.position="fixed",at.left=0,at.top=0,at.width="100%",at.height="100%",at.background="rgba(0, 0, 0, 0.3)",ye.addEventListener("click",this.hide.bind(this));var Se=280,He=document.createElement("div"),at=He.style;at.boxSizing="border-box",at.position="fixed",at.top="24px",at.left="50%",at.marginLeft=-Se/2+"px",at.width=Se+"px",at.padding="24px",at.overflow="hidden",at.background="#fafafa",at.fontFamily="'Roboto', sans-serif",at.boxShadow="0px 5px 20px #666",He.appendChild(this.createH1_("Select your viewer"));for(var vt in q)He.appendChild(this.createChoice_(vt,q[vt].label));return He.appendChild(this.createButton_("Save",this.onSave_.bind(this))),re.appendChild(ye),re.appendChild(He),re},At.prototype.createH1_=function(q){var re=document.createElement("h1"),ye=re.style;return ye.color="black",ye.fontSize="20px",ye.fontWeight="bold",ye.marginTop=0,ye.marginBottom="24px",re.innerHTML=q,re},At.prototype.createChoice_=function(q,re){var ye=document.createElement("div");ye.style.marginTop="8px",ye.style.color="black";var Se=document.createElement("input");Se.style.fontSize="30px",Se.setAttribute("id",q),Se.setAttribute("type","radio"),Se.setAttribute("value",q),Se.setAttribute("name","field");var He=document.createElement("label");return He.style.marginLeft="4px",He.setAttribute("for",q),He.innerHTML=re,ye.appendChild(Se),ye.appendChild(He),ye},At.prototype.createButton_=function(q,re){var ye=document.createElement("button");ye.innerHTML=q;var Se=ye.style;return Se.float="right",Se.textTransform="uppercase",Se.color="#1094f7",Se.fontSize="14px",Se.letterSpacing=0,Se.border=0,Se.background="none",Se.marginTop="16px",ye.addEventListener("click",re),ye};var Ct=typeof window<"u"?window:typeof l<"u"?l:typeof self<"u"?self:{};function Tt(q){return q&&q.__esModule&&Object.prototype.hasOwnProperty.call(q,"default")?q.default:q}function mt(q,re){return re={exports:{}},q(re,re.exports),re.exports}var Bt=mt(function(q,re){(function(Se,He){q.exports=He()})(Ct,function(){return function(ye){var Se={};function He(at){if(Se[at])return Se[at].exports;var vt=Se[at]={i:at,l:!1,exports:{}};return ye[at].call(vt.exports,vt,vt.exports,He),vt.l=!0,vt.exports}return He.m=ye,He.c=Se,He.d=function(at,vt,bt){He.o(at,vt)||Object.defineProperty(at,vt,{configurable:!1,enumerable:!0,get:bt})},He.n=function(at){var vt=at&&at.__esModule?function(){return at.default}:function(){return at};return He.d(vt,"a",vt),vt},He.o=function(at,vt){return Object.prototype.hasOwnProperty.call(at,vt)},He.p="",He(He.s=0)}([function(ye,Se,He){var at=function(){function ue(Ce,Be){for(var Re=0;Re<Be.length;Re++){var pt=Be[Re];pt.enumerable=pt.enumerable||!1,pt.configurable=!0,"value"in pt&&(pt.writable=!0),Object.defineProperty(Ce,pt.key,pt)}}return function(Ce,Be,Re){return Be&&ue(Ce.prototype,Be),Re&&ue(Ce,Re),Ce}}();function vt(ue,Ce){if(!(ue instanceof Ce))throw new TypeError("Cannot call a class as a function")}var bt=He(1),qt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,oe=function(){function ue(){vt(this,ue),qt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",bt),this.noSleepVideo.addEventListener("timeupdate",(function(Ce){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return at(ue,[{key:"enable",value:function(){qt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){qt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),ue}();ye.exports=oe},function(ye,Se,He){ye.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),cn=Tt(Bt),Ln=1e3,Hn=[0,0,.5,1],Wn=[.5,0,.5,1],mn=window.requestAnimationFrame,Yt=window.cancelAnimationFrame;function lr(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function zn(q){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:q.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:q.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:q.canPresent},maxLayers:{writable:!1,enumerable:!0,value:q.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Ie("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),q.hasOrientation}}})}function yn(q){q=q||{};var re="wakelock"in q?q.wakelock:!0;this.isPolyfilled=!0,this.displayId=Ln++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Ie("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new zn({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,re&&Ne()&&(this.wakelock_=new cn)}yn.prototype.getFrameData=function(q){return Vt(q,this._getPose(),this)},yn.prototype.getPose=function(){return Ie("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},yn.prototype.resetPose=function(){return Ie("VRDisplay.prototype.resetPose"),this._resetPose()},yn.prototype.getImmediatePose=function(){return Ie("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},yn.prototype.requestAnimationFrame=function(q){return mn(q)},yn.prototype.cancelAnimationFrame=function(q){return Yt(q)},yn.prototype.wrapForFullscreen=function(q){if(U())return q;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var re=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",re.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==q)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=q,this.originalParent_=q.parentElement,this.originalParent_||document.body.appendChild(q),!this.fullscreenWrapper_.parentElement){var ye=this.fullscreenElement_.parentElement;ye.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),ye.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var Se=this;function He(){if(Se.fullscreenElement_){var at=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];Se.fullscreenElement_.setAttribute("style",at.join("; ")+";")}}return He(),this.fullscreenWrapper_},yn.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var q=this.fullscreenElement_;this.fullscreenElementCachedStyle_?q.setAttribute("style",this.fullscreenElementCachedStyle_):q.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var re=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(q),this.originalParent_===re?re.insertBefore(q,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(q),re.removeChild(this.fullscreenWrapper_),q}},yn.prototype.requestPresent=function(q){var re=this.isPresenting,ye=this;return q instanceof Array||(Ie("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),q=[q]),new Promise(function(Se,He){if(!ye.capabilities.canPresent){He(new Error("VRDisplay is not capable of presenting."));return}if(q.length==0||q.length>ye.capabilities.maxLayers){He(new Error("Invalid number of layers."));return}var at=q[0];if(!at.source){Se();return}var vt=at.leftBounds||Hn,bt=at.rightBounds||Wn;if(re){var qt=ye.layer_;qt.source!==at.source&&(qt.source=at.source);for(var oe=0;oe<4;oe++)qt.leftBounds[oe]=vt[oe],qt.rightBounds[oe]=bt[oe];ye.wrapForFullscreen(ye.layer_.source),ye.updatePresent_(),Se();return}if(ye.layer_={predistorted:at.predistorted,source:at.source,leftBounds:vt.slice(0),rightBounds:bt.slice(0)},ye.waitingForPresent_=!1,ye.layer_&&ye.layer_.source){var ue=ye.wrapForFullscreen(ye.layer_.source),Ce=function(){var pt=gt();ye.isPresenting=ue===pt,ye.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Pt){console.error("screen.orientation.lock() failed due to",Pt.message)}),ye.waitingForPresent_=!1,ye.beginPresent_(),Se()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),ye.removeFullscreenWrapper(),ye.disableWakeLock(),ye.endPresent_(),ye.removeFullscreenListeners_()),ye.fireVRDisplayPresentChange_()},Be=function(){ye.waitingForPresent_&&(ye.removeFullscreenWrapper(),ye.removeFullscreenListeners_(),ye.disableWakeLock(),ye.waitingForPresent_=!1,ye.isPresenting=!1,He(new Error("Unable to present.")))};ye.addFullscreenListeners_(ue,Ce,Be),ut(ue)?(ye.enableWakeLock(),ye.waitingForPresent_=!0):(U()||P())&&(ye.enableWakeLock(),ye.isPresenting=!0,ye.beginPresent_(),ye.fireVRDisplayPresentChange_(),Se())}!ye.waitingForPresent_&&!U()&&(it(),He(new Error("Unable to present.")))})},yn.prototype.exitPresent=function(){var q=this.isPresenting,re=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(ye,Se){q?(!it()&&U()&&(re.endPresent_(),re.fireVRDisplayPresentChange_()),P()&&(re.removeFullscreenWrapper(),re.removeFullscreenListeners_(),re.endPresent_(),re.fireVRDisplayPresentChange_()),ye()):Se(new Error("Was not presenting to VRDisplay."))})},yn.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},yn.prototype.fireVRDisplayPresentChange_=function(){var q=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(q)},yn.prototype.fireVRDisplayConnect_=function(){var q=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(q)},yn.prototype.addFullscreenListeners_=function(q,re,ye){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=q,this.fullscreenChangeHandler_=re,this.fullscreenErrorHandler_=ye,re&&(document.fullscreenEnabled?q.addEventListener("fullscreenchange",re,!1):document.webkitFullscreenEnabled?q.addEventListener("webkitfullscreenchange",re,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",re,!1):document.msFullscreenEnabled&&q.addEventListener("msfullscreenchange",re,!1)),ye&&(document.fullscreenEnabled?q.addEventListener("fullscreenerror",ye,!1):document.webkitFullscreenEnabled?q.addEventListener("webkitfullscreenerror",ye,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",ye,!1):document.msFullscreenEnabled&&q.addEventListener("msfullscreenerror",ye,!1))},yn.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var q=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var re=this.fullscreenChangeHandler_;q.removeEventListener("fullscreenchange",re,!1),q.removeEventListener("webkitfullscreenchange",re,!1),document.removeEventListener("mozfullscreenchange",re,!1),q.removeEventListener("msfullscreenchange",re,!1)}if(this.fullscreenErrorHandler_){var ye=this.fullscreenErrorHandler_;q.removeEventListener("fullscreenerror",ye,!1),q.removeEventListener("webkitfullscreenerror",ye,!1),document.removeEventListener("mozfullscreenerror",ye,!1),q.removeEventListener("msfullscreenerror",ye,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},yn.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},yn.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},yn.prototype.beginPresent_=function(){},yn.prototype.endPresent_=function(){},yn.prototype.submitFrame=function(q){},yn.prototype.getEyeParameters=function(q){return null};var Ei={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},ur={LEFT:"left",RIGHT:"right"};function $n(q){var re=pn({},Ei);q=pn(re,q||{}),yn.call(this,{wakelock:q.MOBILE_WAKE_LOCK}),this.config=q,this.displayName="Cardboard VRDisplay",this.capabilities=new zn({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Y(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Kn(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Cn(this.dpdb_.getDeviceParams(),q.ADDITIONAL_VIEWERS),this.viewerSelector_=new At(q.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new me),U()&&window.addEventListener("resize",this.onResize_.bind(this))}return $n.prototype=Object.create(yn.prototype),$n.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},$n.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},$n.prototype._getFieldOfView=function(q){var re;if(q==ur.LEFT)re=this.deviceInfo_.getFieldOfViewLeftEye();else if(q==ur.RIGHT)re=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",q),null;return re},$n.prototype._getEyeOffset=function(q){var re;if(q==ur.LEFT)re=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(q==ur.RIGHT)re=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",q),null;return re},$n.prototype.getEyeParameters=function(q){var re=this._getEyeOffset(q),ye=this._getFieldOfView(q),Se={offset:re,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(Se,"fieldOfView",{enumerable:!0,get:function(){return Ie("VRFieldOfView","VRFrameData's projection matrices"),ye}}),Se},$n.prototype.onDeviceParamsUpdated_=function(q){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(q),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},$n.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},$n.prototype.beginPresent_=function(){var q=this.layer_.source.getContext("webgl");q||(q=this.layer_.source.getContext("experimental-webgl")),q||(q=this.layer_.source.getContext("webgl2")),q&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(q.canvas.width=Fe()*this.bufferScale_,q.canvas.height=Ze()*this.bufferScale_,this.cardboardUI_=new Qe(q)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Qe(q)),this.distorter_=new ae(q,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(re){this.viewerSelector_.show(this.layer_.source.parentElement),re.stopPropagation(),re.preventDefault()}).bind(this),(function(re){this.exitPresent(),re.stopPropagation(),re.preventDefault()}).bind(this)),this.rotateInstructions_&&(xe()&&Ne()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},$n.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},$n.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},$n.prototype.submitFrame=function(q){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var re=this.layer_.source.getContext("webgl");re||(re=this.layer_.source.getContext("experimental-webgl")),re||(re=this.layer_.source.getContext("webgl2"));var ye=re.canvas;(ye.width!=this.lastWidth||ye.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=ye.width,this.lastHeight=ye.height,this.cardboardUI_.render()}},$n.prototype.onOrientationChange_=function(q){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},$n.prototype.onResize_=function(q){if(this.layer_){var re=this.layer_.source.getContext("webgl");re||(re=this.layer_.source.getContext("experimental-webgl")),re||(re=this.layer_.source.getContext("webgl2"));var ye=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];re.canvas.setAttribute("style",ye.join("; ")+";"),St(re.canvas)}},$n.prototype.onViewerChanged_=function(q){this.deviceInfo_.setViewer(q),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},$n.prototype.fireVRDisplayDeviceParamsChange_=function(){var q=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(q)},$n.VRFrameData=lr,$n.VRDisplay=yn,$n})}),y=u(A),E="0.10.12",x={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function v(D){this.config=m(m({},x),D),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&p())&&(this.enable(),this.getVRDisplays().then(function(L){L&&L[0]&&L[0].fireVRDisplayConnect_&&L[0].fireVRDisplayConnect_()}))}v.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(p()){var D=new y({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(D)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},v.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var D=this.native.VRFrameData,L=new this.native.VRFrameData,I=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(F){if(F instanceof D){I.call(this,F);return}I.call(this,L),F.pose=L.pose,f(L.leftProjectionMatrix,F.leftProjectionMatrix),f(L.rightProjectionMatrix,F.rightProjectionMatrix),f(L.leftViewMatrix,F.leftViewMatrix),f(L.rightViewMatrix,F.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=y.VRDisplay,window.VRFrameData=y.VRFrameData},v.prototype.getVRDisplays=function(){var D=this,L=this.config;return this.hasNative?this.native.getVRDisplays.call(navigator).then(function(I){return I.length>0?I:D.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},v.version=E,v.VRFrameData=y.VRFrameData,v.VRDisplay=y.VRDisplay;var w=Object.freeze({default:v}),M=w&&v||w;typeof l<"u"&&l.window&&(l.document||(l.document=l.window.document),l.navigator||(l.navigator=l.window.navigator));var T=M;return T})},"./node_modules/word-wrapper/index.js":s=>{var o=/\n/,c=`
`,l=/\s/;s.exports=function(A,y){var E=s.exports.lines(A,y);return E.map(function(x){return A.substring(x.start,x.end)}).join(`
`)},s.exports.lines=function(y,E){if(E=E||{},E.width===0&&E.mode!=="nowrap")return[];y=y||"";var x=typeof E.width=="number"?E.width:Number.MAX_VALUE,v=Math.max(0,E.start||0),w=typeof E.end=="number"?E.end:y.length,M=E.mode,T=E.measure||m;return M==="pre"?p(T,y,v,w,x):f(T,y,v,w,x,M)};function u(A,y,E,x){var v=A.indexOf(y,E);return v===-1||v>x?x:v}function h(A){return l.test(A)}function p(A,y,E,x,v){for(var w=[],M=E,T=E;T<x&&T<y.length;T++){var D=y.charAt(T),L=o.test(D);if(L||T===x-1){var I=L?T:T+1,F=A(y,M,I,v);w.push(F),M=T+1}}return w}function f(A,y,E,x,v,w){var M=[],T=v;for(w==="nowrap"&&(T=Number.MAX_VALUE);E<x&&E<y.length;){for(var D=u(y,c,E,x);E<D&&h(y.charAt(E));)E++;var L=A(y,E,D,T),I=E+(L.end-L.start),F=I+c.length;if(I<D){for(;I>E&&!h(y.charAt(I));)I--;if(I===E)F>E+c.length&&F--,I=F;else for(F=I;I>E&&h(y.charAt(I-c.length));)I--}if(I>=E){var R=A(y,E,I,T);M.push(R)}E=F}return M}function m(A,y,E,x){var v=Math.min(x,E-y);return{start:y,end:y+v}}},"./node_modules/xhr/index.js":(s,o,c)=>{"use strict";var l=c("./node_modules/global/window.js"),u=c("./node_modules/is-function/index.js"),h=c("./node_modules/parse-headers/parse-headers.js"),p=c("./node_modules/xtend/immutable.js");s.exports=y,s.exports.default=y,y.XMLHttpRequest=l.XMLHttpRequest||v,y.XDomainRequest="withCredentials"in new y.XMLHttpRequest?y.XMLHttpRequest:l.XDomainRequest,f(["get","put","post","patch","head","delete"],function(w){y[w==="delete"?"del":w]=function(M,T,D){return T=A(M,T,D),T.method=w.toUpperCase(),E(T)}});function f(w,M){for(var T=0;T<w.length;T++)M(w[T])}function m(w){for(var M in w)if(w.hasOwnProperty(M))return!1;return!0}function A(w,M,T){var D=w;return u(M)?(T=M,typeof w=="string"&&(D={uri:w})):D=p(M,{uri:w}),D.callback=T,D}function y(w,M,T){return M=A(w,M,T),E(M)}function E(w){if(typeof w.callback>"u")throw new Error("callback argument missing");var M=!1,T=function(Me,xe,be){M||(M=!0,w.callback(Me,xe,be))};function D(){R.readyState===4&&setTimeout(F,0)}function L(){var ce=void 0;if(R.response?ce=R.response:ce=R.responseText||x(R),z)try{ce=JSON.parse(ce)}catch{}return ce}function I(ce){return clearTimeout(Q),ce instanceof Error||(ce=new Error(""+(ce||"Unknown XMLHttpRequest Error"))),ce.statusCode=0,T(ce,Z)}function F(){if(!X){var ce;clearTimeout(Q),w.useXDR&&R.status===void 0?ce=200:ce=R.status===1223?204:R.status;var Me=Z,xe=null;return ce!==0?(Me={body:L(),statusCode:ce,method:te,headers:{},url:$,rawRequest:R},R.getAllResponseHeaders&&(Me.headers=h(R.getAllResponseHeaders()))):xe=new Error("Internal XMLHttpRequest Error"),T(xe,Me,Me.body)}}var R=w.xhr||null;R||(w.cors||w.useXDR?R=new y.XDomainRequest:R=new y.XMLHttpRequest);var N,X,$=R.url=w.uri||w.url,te=R.method=w.method||"GET",U=w.body||w.data,P=R.headers=w.headers||{},k=!!w.sync,z=!1,Q,Z={body:void 0,headers:{},statusCode:0,method:te,url:$,rawRequest:R};if("json"in w&&w.json!==!1&&(z=!0,P.accept||P.Accept||(P.Accept="application/json"),te!=="GET"&&te!=="HEAD"&&(P["content-type"]||P["Content-Type"]||(P["Content-Type"]="application/json"),U=JSON.stringify(w.json===!0?U:w.json))),R.onreadystatechange=D,R.onload=F,R.onerror=I,R.onprogress=function(){},R.onabort=function(){X=!0},R.ontimeout=I,R.open(te,$,!k,w.username,w.password),k||(R.withCredentials=!!w.withCredentials),!k&&w.timeout>0&&(Q=setTimeout(function(){if(!X){X=!0,R.abort("timeout");var ce=new Error("XMLHttpRequest timeout");ce.code="ETIMEDOUT",I(ce)}},w.timeout)),R.setRequestHeader)for(N in P)P.hasOwnProperty(N)&&R.setRequestHeader(N,P[N]);else if(w.headers&&!m(w.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in w&&(R.responseType=w.responseType),"beforeSend"in w&&typeof w.beforeSend=="function"&&w.beforeSend(R),R.send(U||null),R}function x(w){try{if(w.responseType==="document")return w.responseXML;var M=w.responseXML&&w.responseXML.documentElement.nodeName==="parsererror";if(w.responseType===""&&!M)return w.responseXML}catch{}return null}function v(){}},"./node_modules/xml-parse-from-string/index.js":s=>{s.exports=function(){return typeof self.DOMParser<"u"?function(c){var l=new self.DOMParser;return l.parseFromString(c,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(c){var l=new self.ActiveXObject("Microsoft.XMLDOM");return l.async="false",l.loadXML(c),l}:function(c){var l=document.createElement("div");return l.innerHTML=c,l}}()},"./node_modules/xtend/immutable.js":s=>{s.exports=c;var o=Object.prototype.hasOwnProperty;function c(){for(var l={},u=0;u<arguments.length;u++){var h=arguments[u];for(var p in h)o.call(h,p)&&(l[p]=h[p])}return l}},"./src/components/anchored.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js"),h=u.debug("components:anchored:warn");s.exports.Component=l("anchored",{schema:{persistent:{default:!1}},init:function(){var f=this.el.sceneEl,m=f.getAttribute("webxr"),A=m.optionalFeatures;A.indexOf("anchors")===-1&&(A.push("anchors"),this.el.sceneEl.setAttribute("webxr",m)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var f=this.el.sceneEl,m=f.renderer.xr,A,y,E,x=this.el.object3D;!f.is("ar-mode")&&!f.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(A=f.frame,y=m.getReferenceSpace(),E=A.getPose(this.anchor.anchorSpace,y),x.matrix.elements=E.transform.matrix,x.matrix.decompose(x.position,x.rotation,x.scale)))},createAnchor:function(m,A){return So(this,null,function*(){var y=this.el.sceneEl,E=y.renderer.xr,x,v,w,M,T=this.el.object3D;if(m=m||T.position,A=A||this.auxQuaternion.setFromEuler(T.rotation),!p(y)){h("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),x=y.frame,v=E.getReferenceSpace(),w=new XRRigidTransform({x:m.x,y:m.y,z:m.z},{x:A.x,y:A.y,z:A.z,w:A.w}),this.requestAnchorPending=!1,M=yield x.createAnchor(w,v),this.data.persistent&&(this.el.id?(this.persistentHandle=yield M.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):h("The anchor won't be persisted because the entity has no assigned id.")),y.object3D.attach(this.el.object3D),this.anchor=M})},restorePersistentAnchor:function(){return So(this,null,function*(){var m=this.el.sceneEl.renderer.xr,A=m.getSession(),y=A.persistentAnchors,E;if(this.requestPersistentAnchorPending=!1,!this.el.id){h("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(y){E=localStorage.getItem(this.el.id);for(var x=0;x<y.length;++x)if(E===y[x]){this.anchor=yield A.restorePersistentAnchor(y[x]),this.anchor&&(this.persistentHandle=y[x]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0})},deleteAnchor:function(){var f,m,A=this.anchor;A&&(f=this.el.sceneEl.renderer.xr,m=f.getSession(),A.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&m.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function p(f){var m=f.renderer.xr,A=m.getSession();return A&&A.restorePersistentAnchor}},"./src/components/animation.js":(s,o,c)=>{var l=c("./node_modules/super-animejs/lib/anime.es.js").default,u=c("./src/core/component.js").components,h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/index.js"),m=new p.Color,A=new p.Color,y=f.entity.getComponentProperty,E=f.entity.setComponentProperty,x={},v="color",w="position",M="rotation",T="scale",D="components",L="object3D";s.exports.Component=h("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(P){return P===!0||P==="true"?!0:P===!1||P==="false"?!1:parseInt(P,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var P=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){P.animationIsPlaying=!1,P.el.emit("animationcomplete",P.eventDetail,!1),P.id&&P.el.emit("animationcomplete__"+P.id,P.eventDetail,!1)}}},update:function(P){var k=this.config,z=this.data;this.animationIsPlaying=!1,this.data.enabled&&z.property&&(k.autoplay=!1,k.direction=z.dir,k.duration=z.dur,k.easing=z.easing,k.elasticity=z.elasticity,k.loop=z.loop,k.round=z.round,this.createAndStartAnimation())},tick:function(P,k){this.animationIsPlaying&&(this.time+=k,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var P=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=l(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!P.autoplay||P.startEvents&&P.startEvents.length)){if(P.delay){setTimeout(this.beginAnimation,P.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=l(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var P=this.config,k=this.data,z=this.el,Q,Z,ce;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){Q=k.from===""?X(z,k.property):k.from,ce=k.to,this.setColorConfig(Q,ce),Q=this.fromColor,ce=this.toColor,this.targetsArray.length=0,this.targetsArray.push(Q),P.targets=this.targetsArray;for(Z in ce)P[Z]=ce[Z];P.update=function(){var Me={};return function(xe){var be;be=xe.animatables[0].target,!(be.r===Me.r&&be.g===Me.g&&be.b===Me.b)&&$(z,k.property,be,k.type)}}()}},updateConfigForDefault:function(){var P=this.config,k=this.data,z=this.el,Q,Z,ce,Me;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(k.from===""?Q=U(k)?X(z,k.property):y(z,k.property):Q=k.from,Me=k.to,ce=!isNaN(Q||Me),ce?(Q=parseFloat(Q),Me=parseFloat(Me)):(Q=Q&&Q.toString(),Me=Me&&Me.toString()),Z=k.to==="true"||k.to==="false"||k.to===!0||k.to===!1,Z&&(Q=k.from==="true"||k.from===!0?1:0,Me=k.to==="true"||k.to===!0?1:0),this.targets.aframeProperty=Q,P.targets=this.targets,P.aframeProperty=Me,P.update=function(){var xe;return function(be){var Fe;Fe=be.animatables[0].target.aframeProperty,Fe!==xe&&(xe=Fe,Z&&(Fe=Fe>=1),U(k)?$(z,k.property,Fe,k.type):E(z,k.property,Fe))}}())},updateConfigForVector:function(){var P=this.config,k=this.data,z=this.el,Q,Z,ce;Z=k.from!==""?f.coordinates.parse(k.from):y(z,k.property),ce=f.coordinates.parse(k.to),k.property===M&&(F(Z),F(ce)),this.targetsArray.length=0,this.targetsArray.push(Z),P.targets=this.targetsArray;for(Q in ce)P[Q]=ce[Q];if(k.property===w||k.property===M||k.property===T){P.update=function(){var Me={};return function(xe){var be=xe.animatables[0].target;k.property===T&&(be.x=Math.max(1e-4,be.x),be.y=Math.max(1e-4,be.y),be.z=Math.max(1e-4,be.z)),!(be.x===Me.x&&be.y===Me.y&&be.z===Me.z)&&(Me.x=be.x,Me.y=be.y,Me.z=be.z,z.object3D[k.property].set(be.x,be.y,be.z))}}();return}P.update=function(){var Me={};return function(xe){var be=xe.animatables[0].target;be.x===Me.x&&be.y===Me.y&&be.z===Me.z||(Me.x=be.x,Me.y=be.y,Me.z=be.z,E(z,k.property,be))}}()},updateConfig:function(){var P;P=I(this.el,this.data.property),U(this.data)&&this.data.type===v?this.updateConfigForRawColor():P==="vec2"||P==="vec3"||P==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(P){var k,z=this.data,Q=this.el,Z=this;return z.from!==""||!z.property.startsWith(D)||(k=te(z.property)[1],Q.components[k])?!1:(Q.addEventListener("componentinitialized",function ce(Me){Me.detail.name===k&&(P(),Z.animation=l(Z.config),Q.removeEventListener("componentinitialized",ce))}),!0)},stopRelatedAnimations:function(){var P,k;for(k in this.el.components)P=this.el.components[k],k!==this.attrName&&P.name==="animation"&&P.animationIsPlaying&&P.data.property===this.data.property&&(P.animationIsPlaying=!1)},addEventListeners:function(){var P=this.data,k=this.el;R(k,P.startEvents,this.onStartEvent),R(k,P.pauseEvents,this.pauseAnimation),R(k,P.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var P=this.data,k=this.el;N(k,P.startEvents,this.onStartEvent),N(k,P.pauseEvents,this.pauseAnimation),N(k,P.resumeEvents,this.resumeAnimation)},setColorConfig:function(P,k){m.set(P),A.set(k),P=this.fromColor,k=this.toColor,P.r=m.r,P.g=m.g,P.b=m.b,k.r=A.r,k.g=A.g,k.b=A.b}});function I(P,k){var z,Q,Z,ce;return Z=k.split("."),Q=Z[0],ce=Z[1],z=P.components[Q]||u[Q],!z||ce&&!z.schema[ce]?null:ce?z.schema[ce].type:z.schema.type}function F(P){P.x=p.MathUtils.degToRad(P.x),P.y=p.MathUtils.degToRad(P.y),P.z=p.MathUtils.degToRad(P.z)}function R(P,k,z){var Q;for(Q=0;Q<k.length;Q++)P.addEventListener(k[Q],z)}function N(P,k,z){var Q;for(Q=0;Q<k.length;Q++)P.removeEventListener(k[Q],z)}function X(P,k){var z,Q,Z;for(Q=te(k),Z=P,z=0;z<Q.length;z++)Z=Z[Q[z]];if(Z===void 0)throw console.log(P),new Error("[animation] property ("+k+") could not be found");return Z}function $(P,k,z,Q){var Z,ce,Me,xe;for(k.startsWith("object3D.rotation")&&(z=p.MathUtils.degToRad(z)),ce=te(k),xe=P,Z=0;Z<ce.length-1;Z++)xe=xe[ce[Z]];if(Me=ce[ce.length-1],Q===v){"r"in xe[Me]?(xe[Me].r=z.r,xe[Me].g=z.g,xe[Me].b=z.b):(xe[Me].x=z.r,xe[Me].y=z.g,xe[Me].z=z.b);return}xe[Me]=z}function te(P){return P in x||(x[P]=P.split(".")),x[P]}function U(P){return P.isRawProperty||P.property.startsWith(D)||P.property.startsWith(L)}},"./src/components/camera.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js");s.exports.Component=l("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var h,p=this.el;h=this.camera=new u.PerspectiveCamera,p.setObject3D("camera",h)},update:function(h){var p=this.data,f=this.camera;f.aspect=p.aspect||window.innerWidth/window.innerHeight,f.far=p.far,f.fov=p.fov,f.near=p.near,f.zoom=p.zoom,f.updateProjectionMatrix(),this.updateActiveCamera(h),this.updateSpectatorCamera(h)},updateActiveCamera:function(h){var p=this.data,f=this.el,m=this.system;h&&h.active===p.active||p.spectator||(p.active&&m.activeCameraEl!==f?m.setActiveCamera(f):!p.active&&m.activeCameraEl===f&&m.disableActiveCamera())},updateSpectatorCamera:function(h){var p=this.data,f=this.el,m=this.system;h&&h.spectator===p.spectator||(p.spectator&&m.spectatorCameraEl!==f?m.setSpectatorCamera(f):!p.spectator&&m.spectatorCameraEl===f&&m.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js"),h=u.bind,p={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},f={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},m={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},A={DOWN:["selectstart"],UP:["selectend"]},y="a-mouse-cursor-hover";s.exports.Component=l("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:u.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},multiple:!0,init:function(){var E=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=u.debounce(function(){E.canvasBounds=E.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=h(this.onCursorDown,this),this.onCursorUp=h(this.onCursorUp,this),this.onIntersection=h(this.onIntersection,this),this.onIntersectionCleared=h(this.onIntersectionCleared,this),this.onMouseMove=h(this.onMouseMove,this),this.onEnterVR=h(this.onEnterVR,this)},update:function(E){this.data.rayOrigin!==E.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var E=this.el.sceneEl.frame,x=this.activeXRInput;this.data.rayOrigin==="xrselect"&&E&&x&&this.onMouseMove({frame:E,inputSource:x,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var E=this.el;E.removeState(f.HOVERING),E.removeState(f.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(f.HOVERED),this.removeEventListeners()},addEventListeners:function(){var E,x=this.data,v=this.el,w=this;function M(){E=v.sceneEl.canvas,!(x.downEvents.length||x.upEvents.length)&&(m.DOWN.forEach(function(T){E.addEventListener(T,w.onCursorDown)}),m.UP.forEach(function(T){E.addEventListener(T,w.onCursorUp)}))}E=v.sceneEl.canvas,E?M():v.sceneEl.addEventListener("render-target-loaded",M),x.downEvents.forEach(function(T){v.addEventListener(T,w.onCursorDown)}),x.upEvents.forEach(function(T){v.addEventListener(T,w.onCursorUp)}),v.addEventListener("raycaster-intersection",this.onIntersection),v.addEventListener("raycaster-closest-entity-changed",this.onIntersection),v.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),v.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),v.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var E,x=this.data,v=this.el,w=this;E=v.sceneEl.canvas,E&&!x.downEvents.length&&!x.upEvents.length&&(m.DOWN.forEach(function(M){E.removeEventListener(M,w.onCursorDown)}),m.UP.forEach(function(M){E.removeEventListener(M,w.onCursorUp)})),x.downEvents.forEach(function(M){v.removeEventListener(M,w.onCursorDown)}),x.upEvents.forEach(function(M){v.removeEventListener(M,w.onCursorUp)}),v.removeEventListener("raycaster-intersection",this.onIntersection),v.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchstart",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),v.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),v.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var E,x=this.el;E=x.sceneEl.canvas,E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),x.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(E.addEventListener("mousemove",this.onMouseMove,!1),E.addEventListener("touchmove",this.onMouseMove,!1),x.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var E=new THREE.Vector3,x=new THREE.Vector2,v=new THREE.Vector3,w={origin:v,direction:E};return function(M){var T=this.canvasBounds,D=this.el.sceneEl.camera,L,I,F,R,N,X,$,te;D.parent.updateMatrixWorld(),M.type==="touchmove"||M.type==="touchstart"?I=M.touches.item(0):I=M,L=I.clientX-T.left,F=I.clientY-T.top,x.x=L/T.width*2-1,x.y=-(F/T.height)*2+1,this.data.rayOrigin==="xrselect"&&(M.type==="selectstart"||M.type==="fakeselectevent")?(R=M.frame,N=M.inputSource,X=this.el.renderer.xr.getReferenceSpace(),$=R.getPose(N.targetRaySpace,X),te=$.transform,E.set(0,0,-1),E.applyQuaternion(te.orientation),v.copy(te.position)):M.type==="fakeselectout"?(E.set(0,1,0),v.set(0,9999,0)):D&&D.isPerspectiveCamera?(v.setFromMatrixPosition(D.matrixWorld),E.set(x.x,x.y,.5).unproject(D).sub(v).normalize()):D&&D.isOrthographicCamera?(v.set(x.x,x.y,(D.near+D.far)/(D.near-D.far)).unproject(D),E.set(0,0,-1).transformDirection(D.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+D.type),this.el.setAttribute("raycaster",w),M.type==="touchmove"&&M.preventDefault()}}(),onCursorDown:function(E){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&E.type==="touchstart"&&(this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),E.preventDefault()),this.data.rayOrigin==="xrselect"&&E.type==="selectstart"&&(this.activeXRInput=E.inputSource,this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(p.MOUSEDOWN,E),this.cursorDownEl=this.intersectedEl},onCursorUp:function(E){if(this.isCursorDown){this.isCursorDown=!1;var x=this.data;this.twoWayEmit(p.MOUSEUP,E),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(p.MOUSEUP,this.intersectedEventDetail)),(!x.fuse||x.rayOrigin==="mouse"||x.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(p.CLICK,E),x.rayOrigin==="xrselect"&&this.activeXRInput===E.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,E.type==="touchend"&&E.preventDefault()}},onIntersection:function(E){var x,v=this.el,w,M,T;w=E.detail.els[0]===v?1:0,T=E.detail.intersections[w],M=E.detail.els[w],M&&this.intersectedEl!==M&&(this.intersectedEl&&(x=this.el.components.raycaster.getIntersection(this.intersectedEl),x&&x.distance<=T.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(M,T)))},onIntersectionCleared:function(E){var x=E.detail.clearedEls;x.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var E=this.el.sceneEl.xrSession,x=this;E&&this.data.rayOrigin!=="mouse"&&(A.DOWN.forEach(function(v){E.addEventListener(v,x.onCursorDown)}),A.UP.forEach(function(v){E.addEventListener(v,x.onCursorUp)}))},setIntersection:function(E,x){var v=this.el,w=this.data,M=this;this.intersectedEl!==E&&(this.intersectedEl=E,v.addState(f.HOVERING),E.addState(f.HOVERED),this.twoWayEmit(p.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(y),!(w.fuseTimeout===0||!w.fuse||w.rayOrigin==="xrselect"||w.rayOrigin==="mouse")&&(v.addState(f.FUSING),this.twoWayEmit(p.FUSING),this.fuseTimeout=setTimeout(function(){v.removeState(f.FUSING),M.twoWayEmit(p.CLICK)},w.fuseTimeout)))},clearCurrentIntersection:function(E){var x,v,w,M=this.el;this.intersectedEl&&(this.intersectedEl.removeState(f.HOVERED),M.removeState(f.HOVERING),M.removeState(f.FUSING),this.twoWayEmit(p.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(y),this.intersectedEl=null,clearTimeout(this.fuseTimeout),E!==!0&&(w=this.el.components.raycaster.intersections,w.length!==0&&(x=w[0].object.el===M?1:0,v=w[x],v&&this.setIntersection(v.object.el,v))))},twoWayEmit:function(E,x){var v=this.el,w=this.intersectedEl,M;function T(D,L){x instanceof MouseEvent?D.mouseEvent=x:typeof TouchEvent<"u"&&x instanceof TouchEvent&&(D.touchEvent=x)}M=this.el.components.raycaster.getIntersection(w),this.eventDetail.intersectedEl=w,this.eventDetail.intersection=M,T(this.eventDetail,x),v.emit(E,this.eventDetail),w&&(this.intersectedEventDetail.intersection=M,T(this.intersectedEventDetail,x),w.emit(E,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A="generic",y={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};s.exports.Component=l("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:y,bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var E=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(x){m(x.detail.id,"down",E)},this.onButtonUp=function(x){m(x.detail.id,"up",E)},this.onButtonTouchStart=function(x){m(x.detail.id,"touchstart",E)},this.onButtonTouchEnd=function(x){m(x.detail.id,"touchend",E)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(x){x.detail.name!==E.name&&(E.wasControllerConnected=!0,E.removeEventListeners(),E.removeControllersUpdateListener())})},addEventListeners:function(){var E=this.el;E.addEventListener("buttonchanged",this.onButtonChanged),E.addEventListener("buttondown",this.onButtonDown),E.addEventListener("buttonup",this.onButtonUp),E.addEventListener("touchstart",this.onButtonTouchStart),E.addEventListener("touchend",this.onButtonTouchEnd),E.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var E=this.el;E.removeEventListener("buttonchanged",this.onButtonChanged),E.removeEventListener("buttondown",this.onButtonDown),E.removeEventListener("buttonup",this.onButtonUp),E.removeEventListener("touchstart",this.onButtonTouchStart),E.removeEventListener("touchend",this.onButtonTouchEnd),E.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var E=this.data,x=E.hand?E.hand:void 0;p(this,A,{hand:x,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var E=this.el,x=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}E.setAttribute("tracked-controls",{hand:x.hand,idPrefix:A,orientationOffset:x.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(E){var x=this.mapping.buttons[E.detail.id];x&&this.el.emit(x+"changed",E.detail.state)},onAxisMoved:function(E){f(this,this.mapping.axes,E)},initDefaultModel:function(){var E=this.modelEl=document.createElement("a-entity");E.setAttribute("geometry",{primitive:"sphere",radius:.03}),E.setAttribute("material",{color:this.data.color}),this.el.appendChild(E),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(s,o,c)=>{var l=c("./src/core/geometry.js").geometries,u=c("./src/core/geometry.js").geometryNames,h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=new p.BufferGeometry;s.exports.Component=h("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:u,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(m){var A=this.data,y=this.el,E,x=this.system;this.geometry&&(x.unuseGeometry(m),this.geometry=null),this.geometry=x.getOrCreateGeometry(A),E=y.getObject3D("mesh"),E?E.geometry=this.geometry:(E=new p.Mesh,E.geometry=this.geometry,this.el.getAttribute("material")||(E.material=new p.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),y.setObject3D("mesh",E))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=f,this.geometry=null},updateSchema:function(m){var A=this.oldData&&this.oldData.primitive,y=m.primitive,E=l[y]&&l[y].schema;if(!E)throw new Error("Unknown geometry schema `"+y+"`");A&&A===y||this.extendSchema(E)}})},"./src/components/gltf-model.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=h.debug("components:gltf-model:warn");s.exports.Component=l("gltf-model",{schema:{type:"model"},init:function(){var f=this,m=this.system.getDRACOLoader(),A=this.system.getMeshoptDecoder(),y=this.system.getKTX2Loader();this.model=null,this.loader=new u.GLTFLoader,m&&this.loader.setDRACOLoader(m),A?this.ready=A.then(function(E){f.loader.setMeshoptDecoder(E)}):this.ready=Promise.resolve(),y&&this.loader.setKTX2Loader(y)},update:function(){var f=this,m=this.el,A=this.data;A&&(this.remove(),this.ready.then(function(){f.loader.load(A,function(E){f.model=E.scene||E.scenes[0],f.model.animations=E.animations,m.setObject3D("mesh",f.model),m.emit("model-loaded",{format:"gltf",model:f.model})},void 0,function(E){var x=E&&E.message?E.message:"Failed to load glTF model";p(x),m.emit("model-error",{format:"gltf",src:A})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;l("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/constants/index.js").AFRAME_CDN_ROOT,h={toonLeft:u+"controllers/hands/leftHand.glb",toonRight:u+"controllers/hands/rightHand.glb",lowPolyLeft:u+"controllers/hands/leftHandLow.glb",lowPolyRight:u+"controllers/hands/rightHandLow.glb",highPolyLeft:u+"controllers/hands/leftHandHigh.glb",highPolyRight:u+"controllers/hands/rightHandHigh.glb"},p={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},f={};f[p.fist]="grip",f[p.thumbUp]="pistol",f[p.point]="pointing",s.exports.Component=l("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var y=this,E=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){y.handleButton("grip","down")},this.onGripUp=function(){y.handleButton("grip","up")},this.onTrackpadDown=function(){y.handleButton("trackpad","down")},this.onTrackpadUp=function(){y.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){y.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){y.handleButton("trackpad","touchend")},this.onTriggerDown=function(){y.handleButton("trigger","down")},this.onTriggerUp=function(){y.handleButton("trigger","up")},this.onTriggerTouchStart=function(){y.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){y.handleButton("trigger","touchend")},this.onGripTouchStart=function(){y.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){y.handleButton("grip","touchend")},this.onThumbstickDown=function(){y.handleButton("thumbstick","down")},this.onThumbstickUp=function(){y.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){y.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){y.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){y.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){y.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){y.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){y.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),E.addEventListener("controllerconnected",this.onControllerConnected),E.addEventListener("controllerdisconnected",this.onControllerDisconnected),E.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(y,E){var x=this.el.getObject3D("mesh");!x||!x.mixer||x.mixer.update(E/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var y=this.el;y.addEventListener("gripdown",this.onGripDown),y.addEventListener("gripup",this.onGripUp),y.addEventListener("trackpaddown",this.onTrackpadDown),y.addEventListener("trackpadup",this.onTrackpadUp),y.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),y.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),y.addEventListener("triggerdown",this.onTriggerDown),y.addEventListener("triggerup",this.onTriggerUp),y.addEventListener("triggertouchstart",this.onTriggerTouchStart),y.addEventListener("triggertouchend",this.onTriggerTouchEnd),y.addEventListener("griptouchstart",this.onGripTouchStart),y.addEventListener("griptouchend",this.onGripTouchEnd),y.addEventListener("thumbstickdown",this.onThumbstickDown),y.addEventListener("thumbstickup",this.onThumbstickUp),y.addEventListener("abuttontouchstart",this.onAorXTouchStart),y.addEventListener("abuttontouchend",this.onAorXTouchEnd),y.addEventListener("bbuttontouchstart",this.onBorYTouchStart),y.addEventListener("bbuttontouchend",this.onBorYTouchEnd),y.addEventListener("xbuttontouchstart",this.onAorXTouchStart),y.addEventListener("xbuttontouchend",this.onAorXTouchEnd),y.addEventListener("ybuttontouchstart",this.onBorYTouchStart),y.addEventListener("ybuttontouchend",this.onBorYTouchEnd),y.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),y.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var y=this.el;y.removeEventListener("gripdown",this.onGripDown),y.removeEventListener("gripup",this.onGripUp),y.removeEventListener("trackpaddown",this.onTrackpadDown),y.removeEventListener("trackpadup",this.onTrackpadUp),y.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),y.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),y.removeEventListener("triggerdown",this.onTriggerDown),y.removeEventListener("triggerup",this.onTriggerUp),y.removeEventListener("triggertouchstart",this.onTriggerTouchStart),y.removeEventListener("triggertouchend",this.onTriggerTouchEnd),y.removeEventListener("griptouchstart",this.onGripTouchStart),y.removeEventListener("griptouchend",this.onGripTouchEnd),y.removeEventListener("thumbstickdown",this.onThumbstickDown),y.removeEventListener("thumbstickup",this.onThumbstickUp),y.removeEventListener("abuttontouchstart",this.onAorXTouchStart),y.removeEventListener("abuttontouchend",this.onAorXTouchEnd),y.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),y.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),y.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),y.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),y.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),y.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),y.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),y.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(y){var E,x=this.el,v=this.data.hand,w=this.data.handModelStyle,M=this.data.color,T=this;if(E={hand:v,model:!1},v!==y){var D=h[w+v.charAt(0).toUpperCase()+v.slice(1)];this.loader.load(D,function(L){var I=L.scene.children[0],F=v==="left"?Math.PI/2:-Math.PI/2,R=x.sceneEl.hasWebXR?-Math.PI/2:0;I.mixer=new THREE.AnimationMixer(I),T.clips=L.animations,x.setObject3D("mesh",I),I.traverse(function(N){N.isMesh&&(N.material.color=new THREE.Color(M))}),I.position.set(0,0,0),I.rotation.set(R,0,F),x.setAttribute("magicleap-controls",E),x.setAttribute("vive-controls",E),x.setAttribute("oculus-touch-controls",E),x.setAttribute("pico-controls",E),x.setAttribute("windows-motion-controls",E),x.setAttribute("hp-mixed-reality-controls",E)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(y,E){var x,v=E==="down",w=E==="touchstart";if(E.indexOf("touch")===0){if(w===this.touchedButtons[y])return;this.touchedButtons[y]=w}else{if(v===this.pressedButtons[y])return;this.pressedButtons[y]=v}x=this.gesture,this.gesture=this.determineGesture(),this.gesture!==x&&(this.animateGesture(this.gesture,x),this.emitGestureEvents(this.gesture,x))},determineGesture:function(){var y,E=this.pressedButtons.grip,x=this.pressedButtons.surface||this.touchedButtons.surface,v=this.pressedButtons.trackpad||this.touchedButtons.trackpad,w=this.pressedButtons.trigger||this.touchedButtons.trigger,M=this.touchedButtons.AorX||this.touchedButtons.BorY,T=A(this.el.components["tracked-controls"]);return T?E||w?y=p.fist:v&&(y=p.point):E?x||M||v?y=w?p.fist:p.point:y=w?p.thumbUp:p.pointThumb:w&&(y=p.hold),y},getClip:function(y){var E,x;for(x=0;x<this.clips.length;x++)if(E=this.clips[x],E.name===y)return E},animateGesture:function(y,E){if(y){this.playAnimation(y||p.open,E,!1);return}this.playAnimation(E,E,!0)},emitGestureEvents:function(y,E){var x=this.el,v;E!==y&&(v=m(E,!1),v&&x.emit(v),v=m(y,!0),v&&x.emit(v))},playAnimation:function(y,E,x){var v,w,M=this.el.getObject3D("mesh"),T;if(M){if(v=this.getClip(y),T=M.mixer.clipAction(v),x){T.paused=!1,T.timeScale=-1;return}if(T.clampWhenFinished=!0,T.loop=THREE.LoopOnce,T.repetitions=0,T.timeScale=1,T.time=0,T.weight=1,!E){M.mixer.stopAllAction(),T.play();return}v=this.getClip(E),T.reset(),T.play(),w=M.mixer.clipAction(v),w.crossFadeTo(T,.15,!0)}}});function m(y,E){var x;if(y){if(x=f[y],x==="grip")return x+(E?"close":"open");if(x==="point")return x+(E?"up":"down");if(x==="pointing"||x==="pistol")return x+(E?"start":"end")}}function A(y){var E=y&&y.controller,x=E&&(E.id&&E.id.indexOf("OpenVR ")===0||E.profiles&&E.profiles[0]&&E.profiles[0]==="htc-vive");return x}},"./src/components/hand-tracking-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=c("./src/constants/index.js").AFRAME_CDN_ROOT,m=f+"controllers/oculus-hands/v4/left.glb",A=f+"controllers/oculus-hands/v4/right.glb",y=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],E=0,x=4,v=9,w=.015,M=.1;s.exports.Component=l("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var T=0;T<this.jointEls.length;++T)this.jointEls[T].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var T=0;T<this.jointEls.length;++T)this.jointEls[T].object3D.visible=!1},init:function(){var T=this.el.sceneEl,D=T.getAttribute("webxr"),L=D.optionalFeatures;L.indexOf("hand-tracking")===-1&&(L.push("hand-tracking"),T.setAttribute("webxr",D)),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*y.length),this.jointRadii=new Float32Array(y.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},update:function(){this.updateModelColor()},updateModelColor:function(){var T=this.jointEls,D=this.skinnedMesh;D&&this.skinnedMesh.material.color.set(this.data.modelColor);for(var L=0;L<T.length;L++)T[L].setAttribute("material","color",this.data.modelColor)},updateReferenceSpace:function(){var T=this,D=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!D){var L=T.el.sceneEl.systems.webxr.sessionReferenceSpaceType;D.requestReferenceSpace(L).then(function(I){T.referenceSpace=I}).catch(function(I){throw T.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(L,"tracked-controls-webxr uses reference space "+L),I})}},checkIfControllerPresent:function(){var T=this.data,D=T.hand?T.hand:void 0;p(this,"",{hand:D,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var T=this.el.sceneEl,D=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,L=T.frame,I=this.el.components["tracked-controls-webxr"],F=this.referenceSpace;!D||!L||!F||!I||(this.hasPoses=!1,D.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=L.fillPoses(D.hand.values(),F,this.jointPoses)&&L.fillJointRadii(D.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture()))},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(T){for(var D=this.bones,L=0;L<D.length;L++)if(D[L].name===T)return D[L];return null},updateHandMeshModel:function(){var T=new THREE.Matrix4;return function(){var D=0,L=this.jointPoses,I=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!I||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var F of I.hand.values()){var R=this.getBone(F.jointName);R!=null&&(this.mesh.visible=!0,T.fromArray(L,D*16),R.position.setFromMatrixPosition(T),R.quaternion.setFromRotationMatrix(T)),D++}}}(),updateHandDotsModel:function(){for(var T=this.jointPoses,D=this.jointRadii,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,I,F,R=0;R<L.hand.size;R++)I=this.jointEls[R],F=I.object3D,I.object3D.visible=this.hasPoses,this.hasPoses&&(F.matrix.fromArray(T,R*16),F.matrix.decompose(F.position,F.rotation,F.scale),I.setAttribute("scale",{x:D[R],y:D[R],z:D[R]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var T=new THREE.Vector3,D=new THREE.Matrix4;return function(){var L=this.indexTipPosition,I=this.pinchEventDetail;if(this.hasPoses){T.setFromMatrixPosition(D.fromArray(this.jointPoses,x*16)),L.setFromMatrixPosition(D.fromArray(this.jointPoses,v*16)),I.wristRotation.setFromRotationMatrix(D.fromArray(this.jointPoses,E*16));var F=L.distanceTo(T);F<w&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=F,I.position.copy(L).add(T).multiplyScalar(.5),this.el.emit("pinchstarted",I)),F>this.pinchDistance+this.pinchDistance*M&&this.isPinched===!0&&(this.isPinched=!1,I.position.copy(L).add(T).multiplyScalar(.5),this.el.emit("pinchended",I)),this.isPinched&&(I.position.copy(L).add(T).multiplyScalar(.5),this.el.emit("pinchmoved",I))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var T=this.el,D=this.data;if(T.setAttribute("tracked-controls",{id:"",hand:D.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==T.getObject3D("mesh")&&T.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var T=this.el,D;this.checkIfControllerPresent(),D=T.components["tracked-controls"]&&T.components["tracked-controls"].controller,this.mesh&&D&&D.hand&&D.hand instanceof XRHand&&T.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var T=this.data;T.modelStyle==="dots"&&this.initDotsModel(),T.modelStyle==="mesh"&&this.initMeshHandModel()},initDotsModel:function(){if(this.jointEls.length===0)for(var T=0;T<y.length;++T){var D=this.jointEl=document.createElement("a-entity");D.setAttribute("geometry",{primitive:"sphere",radius:1}),D.setAttribute("material",{color:this.data.modelColor}),D.object3D.visible=!1,this.el.appendChild(D),this.jointEls.push(D)}},initMeshHandModel:function(){var T=this.data.hand==="left"?m:A;this.el.setAttribute("gltf-model",T)},onModelLoaded:function(){var T=this.mesh=this.el.getObject3D("mesh").children[0],D=this.skinnedMesh=T.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=D.skeleton.bones,this.el.removeObject3D("mesh"),T.position.set(0,0,0),T.rotation.set(0,0,0),D.frustumCulled=!1,D.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",T))}})},"./src/components/hand-tracking-grab-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js");l("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var h=this.el,p=this.data,f;p.hand==="right"?f="components.hand-tracking-controls.bones.3":f="components.hand-tracking-controls.bones.21",h.setAttribute("hand-tracking-controls",{hand:p.hand}),h.setAttribute("obb-collider",{trackedObject3D:f,size:.04}),this.auxMatrix=new u.Matrix4,this.auxQuaternion=new u.Quaternion,this.auxQuaternion2=new u.Quaternion,this.auxVector=new u.Vector3,this.auxVector2=new u.Vector3,this.grabbingObjectPosition=new u.Vector3,this.grabbedObjectPosition=new u.Vector3,this.grabbedObjectPositionDelta=new u.Vector3,this.grabDeltaPosition=new u.Vector3,this.grabInitialRotation=new u.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var h,p=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),f=0;f<p.length;++f)h=p[f].components["hand-tracking-grab-controls"],h!==this&&this.grabbedEl&&this.grabbedEl===h.grabbedEl&&h.releaseGrabbedEntity();return!1},onCollisionStarted:function(h){var p=h.detail.withEl;this.collidedEl||p.getAttribute("grabbable")&&(this.collidedEl=p,this.grabbingObject3D=h.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(h){this.collidedEl&&(this.pinchPosition=h.detail.position,this.wristRotation=h.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(h){this.wristRotation=h.detail.wristRotation},releaseGrabbedEntity:function(){var h=this.grabbedEl;h&&(h.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,h.object3D.matrixAutoUpdate=!0,h.object3D.matrixWorldAutoUpdate=!0,h.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),h.object3D.position.copy(this.auxVector),h.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:h}),this.grabbedEl=void 0)},grab:function(){var h=this.grabbedEl,p;p=h.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(p).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=h.object3D.updateMatrixWorld,h.object3D.updateMatrixWorld=function(){},h.object3D.updateMatrixWorldChildren=function(f){for(var m=this.children,A=0,y=m.length;A<y;A++){var E=m[A];(E.matrixWorldAutoUpdate===!0||f===!0)&&E.updateMatrixWorld(!0)}},h.object3D.matrixAutoUpdate=!1,h.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:h})},tock:function(){var h=this.auxMatrix,p=this.auxQuaternion,f=this.auxQuaternion2,m,A=this.grabbedEl;A&&(m=A.object3D,m.getWorldQuaternion(f),m.matrixWorld.identity(),h.identity(),h.makeTranslation(this.pinchPosition),m.matrixWorld.multiply(h),h.identity(),h.makeRotationFromQuaternion(p.copy(this.wristRotation).multiply(this.grabInitialRotation)),m.matrixWorld.multiply(h),h.identity(),h.makeTranslation(this.grabDeltaPosition),m.matrixWorld.multiply(h),h.identity(),h.makeRotationFromQuaternion(f),m.matrixWorld.multiply(h),h.makeScale(A.object3D.scale.x,A.object3D.scale.y,A.object3D.scale.z),m.matrixWorld.multiply(h),m.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("hide-on-enter-ar",{init:function(){var u=this;this.el.sceneEl.addEventListener("enter-vr",function(){u.el.sceneEl.is("ar-mode")&&(u.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){u.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,A=p.onButtonEvent,y="hp-mixed-reality",E=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=E+"controllers/hp/mixed-reality/",v={x:0,y:0,z:.06},w={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},M={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};s.exports.Component=u("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:M,init:function(){var T=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(D){A(D.detail.id,"down",T,T.data.hand)},this.onButtonUp=function(D){A(D.detail.id,"up",T,T.data.hand)},this.onButtonTouchEnd=function(D){A(D.detail.id,"touchend",T,T.data.hand)},this.onButtonTouchStart=function(D){A(D.detail.id,"touchstart",T,T.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var T=this.data;this.controllerIndex=T.hand==="right"?0:T.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=l(this.removeControllersUpdateListener,this),this.onAxisMoved=l(this.onAxisMoved,this)},addEventListeners:function(){var T=this.el;T.addEventListener("buttonchanged",this.onButtonChanged),T.addEventListener("buttondown",this.onButtonDown),T.addEventListener("buttonup",this.onButtonUp),T.addEventListener("touchstart",this.onButtonTouchStart),T.addEventListener("touchend",this.onButtonTouchEnd),T.addEventListener("axismove",this.onAxisMoved),T.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var T=this.el;T.removeEventListener("buttonchanged",this.onButtonChanged),T.removeEventListener("buttondown",this.onButtonDown),T.removeEventListener("buttonup",this.onButtonUp),T.removeEventListener("touchstart",this.onButtonTouchStart),T.removeEventListener("touchend",this.onButtonTouchEnd),T.removeEventListener("axismove",this.onAxisMoved),T.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var T=this.data;f(this,y,{index:this.controllerIndex,hand:T.hand})},injectTrackedControls:function(){var T=this.el,D=this.data;T.setAttribute("tracked-controls",{idPrefix:y,hand:D.hand,controller:this.controllerIndex,orientationOffset:D.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(T){var D=this.mapping[this.data.hand].buttons[T.detail.id],L;D&&(D==="trigger"&&(L=T.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(D+"changed",T.detail.state))},onModelLoaded:function(T){var D=T.detail.model;this.data.model&&(D.position.copy(v),D.rotation.copy(w),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new h.Vector3(0,0,0)}))},onAxisMoved:function(T){m(this,this.mapping.axes,T)}})},"./src/components/index.js":(s,o,c)=>{c("./src/components/animation.js"),c("./src/components/anchored.js"),c("./src/components/camera.js"),c("./src/components/cursor.js"),c("./src/components/geometry.js"),c("./src/components/generic-tracked-controller-controls.js"),c("./src/components/gltf-model.js"),c("./src/components/grabbable.js"),c("./src/components/hand-tracking-controls.js"),c("./src/components/hand-tracking-grab-controls.js"),c("./src/components/hand-controls.js"),c("./src/components/hide-on-enter-ar.js"),c("./src/components/hp-mixed-reality-controls.js"),c("./src/components/layer.js"),c("./src/components/laser-controls.js"),c("./src/components/light.js"),c("./src/components/line.js"),c("./src/components/link.js"),c("./src/components/look-controls.js"),c("./src/components/magicleap-controls.js"),c("./src/components/material.js"),c("./src/components/obb-collider.js"),c("./src/components/obj-model.js"),c("./src/components/oculus-go-controls.js"),c("./src/components/oculus-touch-controls.js"),c("./src/components/pico-controls.js"),c("./src/components/position.js"),c("./src/components/raycaster.js"),c("./src/components/rotation.js"),c("./src/components/scale.js"),c("./src/components/shadow.js"),c("./src/components/sound.js"),c("./src/components/text.js"),c("./src/components/tracked-controls.js"),c("./src/components/tracked-controls-webvr.js"),c("./src/components/tracked-controls-webxr.js"),c("./src/components/visible.js"),c("./src/components/valve-index-controls.js"),c("./src/components/vive-controls.js"),c("./src/components/vive-focus-controls.js"),c("./src/components/wasd-controls.js"),c("./src/components/windows-motion-controls.js"),c("./src/components/scene/ar-hit-test.js"),c("./src/components/scene/background.js"),c("./src/components/scene/debug.js"),c("./src/components/scene/device-orientation-permission-ui.js"),c("./src/components/scene/embedded.js"),c("./src/components/scene/inspector.js"),c("./src/components/scene/fog.js"),c("./src/components/scene/keyboard-shortcuts.js"),c("./src/components/scene/pool.js"),c("./src/components/scene/real-world-meshing.js"),c("./src/components/scene/reflection.js"),c("./src/components/scene/screenshot.js"),c("./src/components/scene/stats.js"),c("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js");l("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var h=this.config,p=this.data,f=this.el,m=this,A={hand:p.hand,model:p.model};f.setAttribute("hp-mixed-reality-controls",A),f.setAttribute("magicleap-controls",A),f.setAttribute("oculus-go-controls",A),f.setAttribute("oculus-touch-controls",A),f.setAttribute("pico-controls",A),f.setAttribute("valve-index-controls",A),f.setAttribute("vive-controls",A),f.setAttribute("vive-focus-controls",A),f.setAttribute("windows-motion-controls",A),f.setAttribute("generic-tracked-controller-controls",{hand:A.hand}),f.addEventListener("controllerconnected",y),f.addEventListener("controllerdisconnected",E),f.addEventListener("controllermodelready",function(x){y(x),m.modelReady=!0});function y(x){var v=h[x.detail.name];if(v){var w=u.extend({showLine:!0},v.raycaster||{});x.detail.rayOrigin&&(w.origin=x.detail.rayOrigin.origin,w.direction=x.detail.rayOrigin.direction,w.showLine=!0),x.detail.rayOrigin||!m.modelReady?f.setAttribute("raycaster",w):f.setAttribute("raycaster","showLine",!0),f.setAttribute("cursor",u.extend({fuse:!1},v.cursor))}}function E(x){var v=h[x.detail.name];v&&f.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js"),h=u.debug("components:layer:warn");s.exports.Component=l("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var f=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=f.createFramebuffer();var m=this.el.sceneEl.getAttribute("webxr"),A=m.optionalFeatures;A.indexOf("layers")===-1&&(A.push("laters"),this.el.sceneEl.setAttribute("webxr",m)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(f){this.data.src!==f.src&&this.updateSrc()},updateSrc:function(){var f=this.data.type;if(this.texture=void 0,f==="quad"){this.loadQuadImage();return}if(f==="monocubemap"||f==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var f,m=this.xrGLFactory,A=this.el.sceneEl.frame,y=this.data.src,E=this.data.type;this.visibilityChanged=!1,this.layer&&(E!=="monocubemap"&&E!=="stereocubemap"||(y.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,E==="monocubemap"?(f=m.getSubImage(this.layer,A),this.loadCubeMapImage(f.colorTexture,y,0)):(f=m.getSubImage(this.layer,A,"left"),this.loadCubeMapImage(f.colorTexture,y,0),f=m.getSubImage(this.layer,A,"right"),this.loadCubeMapImage(f.colorTexture,y,6))))},loadQuadImage:function(){var f=this.data.src,m=this;this.el.sceneEl.systems.material.loadTexture(f,{src:f},function(y){m.el.sceneEl.renderer.initTexture(y),m.texture=y,f.tagName==="VIDEO"&&setTimeout(function(){m.textureIsVideo=!0},1e3),m.layer&&(m.layer.height=m.data.height/2||m.texture.image.height/1e3,m.layer.width=m.data.width/2||m.texture.image.width/1e3,m.needsRedraw=!0),m.updateQuadPanel()})},preGenerateCubeMapTextures:function(f,m){this.data.type==="monocubemap"?this.generateCubeMapTextures(f,0,m):(this.generateCubeMapTextures(f,0,m),this.generateCubeMapTextures(f,6,m))},generateCubeMapTextures:function(f,m,A){for(var y=this.data,E=this.cubeFaceSize,x=Math.min(f.width,f.height),v=[],w,M,T=0;T<6;T++){var D=document.createElement("CANVAS");D.width=D.height=E;var L=D.getContext("2d");y.rotateCubemap&&(T===2||T===3)&&(L.save(),L.translate(E,E),L.rotate(Math.PI)),L.drawImage(f,(T+m)*x,0,x,x,0,0,E,E),L.restore(),A&&A(),v.push(D)}return y.rotateCubemap&&(w=v[0],M=v[1],v[0]=M,v[1]=w,w=v[4],M=v[5],v[4]=M,v[5]=w),A&&A(),v},loadCubeMapImage:function(f,m,A){var y=this.el.sceneEl.renderer.getContext(),E;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!1),y.bindTexture(y.TEXTURE_CUBE_MAP,f),!m.complete||this.loadingScreen?E=this.loadingScreenImages:E=this.generateCubeMapTextures(m,A);var x=0;E.forEach(function(v,w){y.texSubImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+w,0,0,0,y.RGBA,y.UNSIGNED_BYTE,v),x=y.getError()}),x!==0&&console.log("renderingError, WebGL Error Code: "+x),y.bindTexture(y.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var f=this,m=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(A){f.visibilityChanged=A.session.visibilityState!=="hidden"},m==="quad"){this.initQuadLayer();return}if(m==="monocubemap"||m==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var f=this.el.sceneEl,m=f.renderer.getContext(),A=this.xrGLFactory=new XRWebGLBinding(f.xrSession,m);this.texture&&(this.layer=A.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),f.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var f=this.data.src,m=this.el.sceneEl,A=m.renderer.getContext(),y=A.getParameter(A.MAX_CUBE_MAP_TEXTURE_SIZE),E=this.cubeFaceSize=Math.min(y,Math.min(f.width,f.height)),x=this.xrGLFactory=new XRWebGLBinding(m.xrSession,A);this.layer=x.createCubeLayer({space:this.referenceSpace,viewPixelWidth:E,viewPixelHeight:E,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),m.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var f=this.cubeFaceSize,m=this.loadingScreenImages=[],A=0;A<6;A++){var y=document.createElement("CANVAS");y.width=y.height=f;var E=y.getContext("2d");y.width=y.height=f,E.fillStyle="black",E.fillRect(0,0,f,f),A!==2&&A!==3&&(E.translate(f,0),E.scale(-1,1),E.fillStyle="white",E.font="30px Arial",E.fillText("Loading",f/2,f/2)),m.push(y)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(f){this.layerEnabled=f,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var f=this.quadPanelEl;this.quadPanelEl||(f=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(f)),f.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),f.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var f=this.el.sceneEl,m=this.el.sceneEl.renderer.getContext(),A=this.xrGLFactory.getSubImage(this.layer,f.frame),y=f.renderer.properties.get(this.texture).__webglTexture,E=m.getParameter(m.FRAMEBUFFER_BINDING);m.viewport(A.viewport.x,A.viewport.y,A.viewport.width,A.viewport.height),m.bindFramebuffer(m.FRAMEBUFFER,this.frameBuffer),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,A.colorTexture,0),p(m,y,A,this.data.src),m.bindFramebuffer(m.FRAMEBUFFER,E)},updateTransform:function(){var f=this.el,m=this.position,A=this.quaternion;f.object3D.updateMatrixWorld(),m.setFromMatrixPosition(f.object3D.matrixWorld),A.setFromRotationMatrix(f.object3D.matrixWorld),this.layerEnabled||m.set(0,0,1e8),this.layer.transform=new XRRigidTransform(m,A)},onEnterVR:function(){var f=this.el.sceneEl,m=f.xrSession;if(!f.hasWebXR||!XRWebGLBinding||!m){h("The layer component requires WebXR and the layers API enabled");return}m.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(f){this.referenceSpace=f}});function p(f,m,A,y){var E=f.createFramebuffer(),x=A.viewport.x,v=A.viewport.y,w=A.viewport.x+A.viewport.width,M=A.viewport.y+A.viewport.height;y.tagName==="VIDEO"&&(f.bindTexture(f.TEXTURE_2D,m),f.texSubImage2D(f.TEXTURE_2D,0,0,0,y.width,y.height,f.RGB,f.UNSIGNED_BYTE,y)),f.bindFramebuffer(f.READ_FRAMEBUFFER,E),f.framebufferTexture2D(f.READ_FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,m,0),f.readBuffer(f.COLOR_ATTACHMENT0),f.blitFramebuffer(0,0,y.width,y.height,x,v,w,M,f.COLOR_BUFFER_BIT,f.NEAREST),f.bindFramebuffer(f.READ_FRAMEBUFFER,null),f.deleteFramebuffer(E)}},"./src/components/light.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/utils/index.js"),h=u.diff,p=c("./src/utils/debug.js"),f=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),A=c("./src/utils/math.js"),y=m.MathUtils.degToRad,E=p("components:light:warn"),x=new m.CubeTextureLoader,v={};s.exports.Component=f("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var w=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(w)},update:function(w){var M=this.data,T=h(M,w),D=this.light,L=this;if(D&&!("type"in T)){var I=!1;Object.keys(T).forEach(function(F){var R=M[F];switch(F){case"color":{D.color.set(R);break}case"groundColor":{D.groundColor.set(R);break}case"angle":{D.angle=y(R);break}case"target":{R===null?(M.type==="spot"||M.type==="directional")&&(D.target=L.defaultTarget):R.hasLoaded?L.onSetTarget(R,D):R.addEventListener("loaded",l(L.onSetTarget,L,R,D));break}case"envMap":L.updateProbeMap(M,D);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":I||(L.updateShadow(),I=!0);break;case"shadowCameraAutomatic":M.shadowCameraAutomatic?L.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(M.shadowCameraAutomatic)):L.shadowCameraAutomaticEls=[];break;default:D[F]=R}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var w=new m.Box3,M=new m.Vector3,T=new m.Vector3,D=new m.Matrix4,L=new m.Sphere,I=new m.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof m.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var F=this.light.shadow.camera;F.getWorldDirection(M),F.getWorldPosition(T),D.copy(F.matrixWorld),D.invert(),F.near=1,F.left=1e5,F.right=-1e5,F.top=-1e5,F.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(R){w.setFromObject(R.object3D),w.getBoundingSphere(L);var N=A.distanceOfPointFromPlane(T,M,L.center),X=A.nearestPointInPlane(T,M,L.center,I),$=X.applyMatrix4(D);F.near=Math.min(-N-L.radius-1,F.near),F.left=Math.min(-L.radius+$.x,F.left),F.right=Math.max(L.radius+$.x,F.right),F.top=Math.max(L.radius+$.y,F.top),F.bottom=Math.min(-L.radius+$.y,F.bottom)}),F.updateProjectionMatrix()}}}(),setLight:function(w){var M=this.el,T=this.getLight(w);T&&(this.light&&M.removeObject3D("light"),this.light=T,this.light.el=M,M.setObject3D("light",this.light),(w.type==="spot"||w.type==="directional"||w.type==="hemisphere")&&M.getObject3D("light").translateY(-1),w.type==="spot"&&(M.setObject3D("light-target",this.defaultTarget),M.getObject3D("light-target").position.set(0,0,-1)),w.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(w.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var w=this.el,M=this.data,T=this.light;T.castShadow=M.castShadow;var D=w.getObject3D("cameraHelper");if(M.shadowCameraVisible&&!D?w.setObject3D("cameraHelper",new m.CameraHelper(T.shadow.camera)):!M.shadowCameraVisible&&D&&w.removeObject3D("cameraHelper"),!M.castShadow)return T;T.shadow.bias=M.shadowBias,T.shadow.radius=M.shadowRadius,T.shadow.mapSize.height=M.shadowMapHeight,T.shadow.mapSize.width=M.shadowMapWidth,T.shadow.camera.near=M.shadowCameraNear,T.shadow.camera.far=M.shadowCameraFar,T.shadow.camera instanceof m.OrthographicCamera?(T.shadow.camera.top=M.shadowCameraTop,T.shadow.camera.right=M.shadowCameraRight,T.shadow.camera.bottom=M.shadowCameraBottom,T.shadow.camera.left=M.shadowCameraLeft):T.shadow.camera.fov=M.shadowCameraFov,T.shadow.camera.updateProjectionMatrix(),D&&D.update()},getLight:function(w){var M=w.angle,T=new m.Color(w.color);T=T.getHex();var D=w.decay,L=w.distance,I=new m.Color(w.groundColor);I=I.getHex();var F=w.intensity,R=w.type,N=w.target,X=null;switch(R.toLowerCase()){case"ambient":return new m.AmbientLight(T,F);case"directional":return X=new m.DirectionalLight(T,F),this.defaultTarget=X.target,N&&(N.hasLoaded?this.onSetTarget(N,X):N.addEventListener("loaded",l(this.onSetTarget,this,N,X))),X;case"hemisphere":return new m.HemisphereLight(T,I,F);case"point":return new m.PointLight(T,F,L,D);case"spot":return X=new m.SpotLight(T,F,L,y(M),w.penumbra,D),this.defaultTarget=X.target,N&&(N.hasLoaded?this.onSetTarget(N,X):N.addEventListener("loaded",l(this.onSetTarget,this,N,X))),X;case"probe":return X=new m.LightProbe,this.updateProbeMap(w,X),X;default:E("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",R)}},updateProbeMap:function(w,M){w.envMap||M.copy(new m.LightProbe),v[w.envMap]instanceof window.Promise&&v[w.envMap].then(function(T){M.copy(T)}),v[w.envMap]instanceof m.LightProbe&&M.copy(v[w.envMap]),v[w.envMap]=new window.Promise(function(T){u.srcLoader.validateCubemapSrc(w.envMap,function(L){x.load(L,function(I){var F=m.LightProbeGenerator.fromCubeTexture(I);v[w.envMap]=F,M.copy(F)})})})},onSetTarget:function(w,M){M.target=w.object3D},remove:function(){var w=this.el;w.removeObject3D("light"),w.getObject3D("cameraHelper")&&w.removeObject3D("cameraHelper")}})},"./src/components/line.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var h=this.data,p,f;f=this.material=new THREE.LineBasicMaterial({color:h.color,opacity:h.opacity,transparent:h.opacity<1,visible:h.visible}),p=this.geometry=new THREE.BufferGeometry,p.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(p,f),this.el.setObject3D(this.attrName,this.line)},update:function(h){var p=this.data,f=this.geometry,m=!1,A=this.material,y=f.attributes.position.array;u(p.start,h.start)||(y[0]=p.start.x,y[1]=p.start.y,y[2]=p.start.z,m=!0),u(p.end,h.end)||(y[3]=p.end.x,y[4]=p.end.y,y[5]=p.end.z,m=!0),m&&(f.attributes.position.needsUpdate=!0,f.computeBoundingSphere()),A.color.setStyle(p.color),A.opacity=p.opacity,A.transparent=p.opacity<1,A.visible=p.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function u(h,p){return!h||!p?!1:h.x===p.x&&h.y===p.y&&h.z===p.z}},"./src/components/link.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/core/shader.js").registerShader,h=c("./src/lib/three.js");s.exports.Component=l("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new h.Quaternion,this.hiddenEls=[]},update:function(p){var f=this.data,m=this.el,A,y;f.visualAspectEnabled&&(this.initVisualAspect(),A=f.highlighted?f.highlightedColor:f.backgroundColor,y=f.highlighted?f.highlightedColor:f.borderColor,m.setAttribute("material","backgroundColor",A),m.setAttribute("material","strokeColor",y),f.on!==p.on&&this.updateEventListener(),p.peekMode!==void 0&&f.peekMode!==p.peekMode&&this.updatePeekMode(),!(!f.image||p.image===f.image)&&m.setAttribute("material","pano",typeof f.image=="string"?f.image:f.image.src))},updatePeekMode:function(){var p=this.el,f=this.sphereEl;this.data.peekMode?(this.hideAll(),p.getObject3D("mesh").visible=!1,f.setAttribute("visible",!0)):(this.showAll(),p.getObject3D("mesh").visible=!0,f.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var p=this.el;p.isPlaying&&(this.removeEventListener(),p.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var p=this.data.on;p&&this.el.removeEventListener(p,this.navigate)},initVisualAspect:function(){var p=this.el,f,m,A;!this.data.visualAspectEnabled||this.visualAspectInitialized||(A=this.textEl=this.textEl||document.createElement("a-entity"),m=this.sphereEl=this.sphereEl||document.createElement("a-entity"),f=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),p.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),p.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),A.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),A.setAttribute("position","0 1.5 0"),p.appendChild(A),f.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),f.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),f.setAttribute("rotation","0 180 0"),f.setAttribute("position","0 0 0"),f.setAttribute("visible",!1),p.appendChild(f),m.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),m.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),m.setAttribute("visible",!1),p.appendChild(m),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var p=new h.Vector3,f=new h.Vector3,m=new h.Quaternion,A=new h.Vector3;return function(){var y=this.el,E=y.object3D,x=y.sceneEl.camera,v,w,M=this.textEl;if(this.data.visualAspectEnabled)if(E.updateMatrixWorld(),x.parent.updateMatrixWorld(),x.updateMatrixWorld(),E.matrix.decompose(f,m,A),f.setFromMatrixPosition(E.matrixWorld),p.setFromMatrixPosition(x.matrixWorld),w=f.distanceTo(p),w>20)this.previousQuaternion||(this.quaternionClone.copy(m),this.previousQuaternion=this.quaternionClone),E.lookAt(p);else{if(v=this.calculateCameraPortalOrientation(),w<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;M.setAttribute("text","width",1.5),v<=0?(M.setAttribute("position","0 0 0.75"),M.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(M.setAttribute("position","0 0 -0.75"),M.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),y.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=v}else v<=0?M.setAttribute("rotation","0 180 0"):M.setAttribute("rotation","0 0 0"),M.setAttribute("text","width",5),M.setAttribute("position","0 1.5 0"),y.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(E.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var p=this.el,f=this.hiddenEls,m=this;f.length>0||p.sceneEl.object3D.traverse(function(A){A&&A.el&&A.el.hasAttribute("link-controls")||!A.el||A===p.sceneEl.object3D||A.el===p||A.el===m.sphereEl||A.el===p.sceneEl.cameraEl||A.el.getAttribute("visible")===!1||A.el===m.textEl||A.el===m.semiSphereEl||(A.el.setAttribute("visible",!1),f.push(A.el))})},showAll:function(){this.hiddenEls.forEach(function(p){p.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var p=new h.Matrix4,f=new h.Vector3,m=new h.Vector3(0,0,1),A=new h.Vector3(0,0,0);return function(){var y=this.el,E=y.sceneEl.camera;return f.set(0,0,0),m.set(0,0,1),A.set(0,0,0),y.object3D.matrixWorld.extractRotation(p),m.applyMatrix4(p),y.object3D.updateMatrixWorld(),y.object3D.localToWorld(A),E.parent.parent.updateMatrixWorld(),E.parent.updateMatrixWorld(),E.updateMatrixWorld(),E.localToWorld(f),f.sub(A).normalize(),m.normalize(),Math.sign(m.dot(f))}}(),remove:function(){this.removeEventListener()}}),u("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=h.bind,f=Math.PI/2;s.exports.Component=l("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new u.Vector3,this.hmdQuaternion=new u.Quaternion,this.magicWindowAbsoluteEuler=new u.Euler,this.magicWindowDeltaEuler=new u.Euler,this.position=new u.Vector3,this.magicWindowObject=new u.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new u.Vector3,rotation:new u.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var m,A=this.data;(h.device.isMobile()||h.device.isMobileDeviceRequestingDesktopSite())&&(m=this.magicWindowControls=new u.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(m.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?m.enabled=A.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){m.enabled=A.magicWindowTrackingEnabled})))},update:function(m){var A=this.data;A.enabled!==m.enabled&&this.updateGrabCursor(A.enabled),m&&!A.magicWindowTrackingEnabled&&m.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=A.magicWindowTrackingEnabled),m&&!A.pointerLockEnabled!==m.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(m){var A=this.data;A.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=p(this.onMouseDown,this),this.onMouseMove=p(this.onMouseMove,this),this.onMouseUp=p(this.onMouseUp,this),this.onTouchStart=p(this.onTouchStart,this),this.onTouchMove=p(this.onTouchMove,this),this.onTouchEnd=p(this.onTouchEnd,this),this.onEnterVR=p(this.onEnterVR,this),this.onExitVR=p(this.onExitVR,this),this.onPointerLockChange=p(this.onPointerLockChange,this),this.onPointerLockError=p(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new u.Object3D,this.yawObject=new u.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var m=this.el.sceneEl,A=m.canvas;if(!A){m.addEventListener("render-target-loaded",p(this.addEventListeners,this));return}A.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),A.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),m.addEventListener("enter-vr",this.onEnterVR),m.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var m=this.el.sceneEl,A=m&&m.canvas;A&&(A.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),A.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),m.removeEventListener("enter-vr",this.onEnterVR),m.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var m=this.el.object3D,A=this.pitchObject,y=this.yawObject,E=this.el.sceneEl;(E.is("vr-mode")||E.is("ar-mode"))&&E.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),m.rotation.x=this.magicWindowDeltaEuler.x+A.rotation.x,m.rotation.y=this.magicWindowDeltaEuler.y+y.rotation.y,m.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var m=this.magicWindowAbsoluteEuler,A=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),m.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&m.y!==0&&(this.previousMagicWindowYaw=m.y),this.previousMagicWindowYaw&&(A.x=m.x,A.y+=m.y-this.previousMagicWindowYaw,A.z=m.z,this.previousMagicWindowYaw=m.y))},onMouseMove:function(m){var A,y,E,x=this.pitchObject,v=this.previousMouseEvent,w=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(y=m.movementX||m.mozMovementX||0,E=m.movementY||m.mozMovementY||0):(y=m.screenX-v.screenX,E=m.screenY-v.screenY),this.previousMouseEvent.screenX=m.screenX,this.previousMouseEvent.screenY=m.screenY,A=this.data.reverseMouseDrag?1:-1,w.rotation.y+=y*.002*A,x.rotation.x+=E*.002*A,x.rotation.x=Math.max(-f,Math.min(f,x.rotation.x)))},onMouseDown:function(m){var A=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(A.is("vr-mode")||A.is("ar-mode"))&&A.checkHeadsetConnected())&&m.button===0){var y=A&&A.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=m.screenX,this.previousMouseEvent.screenY=m.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(y.requestPointerLock?y.requestPointerLock():y.mozRequestPointerLock&&y.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(m){m.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:m.touches[0].pageX,y:m.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(m){var A,y=this.el.sceneEl.canvas,E,x=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(E=2*Math.PI*(m.touches[0].pageX-this.touchStart.x)/y.clientWidth,A=this.data.reverseTouchDrag?1:-1,x.rotation.y-=E*.5*A,this.touchStart={x:m.touches[0].pageX,y:m.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var m=this.el.sceneEl;m.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),m.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(m){var A=this.el.sceneEl;function y(){A.canvas.classList.add("a-grab-cursor")}function E(){A.canvas.classList.remove("a-grab-cursor")}if(!A.canvas){m?A.addEventListener("render-target-loaded",y):A.addEventListener("render-target-loaded",E);return}if(m){y();return}E()},saveCameraPose:function(){var m=this.el;this.savedPose.position.copy(m.object3D.position),this.savedPose.rotation.copy(m.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var m=this.el,A=this.savedPose;this.hasSavedPose&&(m.object3D.position.copy(A.position),m.object3D.rotation.copy(A.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/core/component.js").registerComponent,h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A="magicleap",y="-one",E=A+y,x=c("./src/constants/index.js").AFRAME_CDN_ROOT,v=x+"controllers/magicleap/magicleap-one-controller.glb",w={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};s.exports.Component=u("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:w,init:function(){var M=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(T){m(T.detail.id,"down",M)},this.onButtonUp=function(T){m(T.detail.id,"up",M)},this.onButtonTouchEnd=function(T){m(T.detail.id,"touchend",M)},this.onButtonTouchStart=function(T){m(T.detail.id,"touchstart",M)},this.previousButtonValues={},this.bindMethods()},update:function(){var M=this.data;this.controllerIndex=M.hand==="right"?0:M.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=l(this.removeControllersUpdateListener,this),this.onAxisMoved=l(this.onAxisMoved,this)},addEventListeners:function(){var M=this.el;M.addEventListener("buttonchanged",this.onButtonChanged),M.addEventListener("buttondown",this.onButtonDown),M.addEventListener("buttonup",this.onButtonUp),M.addEventListener("touchstart",this.onButtonTouchStart),M.addEventListener("touchend",this.onButtonTouchEnd),M.addEventListener("axismove",this.onAxisMoved),M.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var M=this.el;M.removeEventListener("buttonchanged",this.onButtonChanged),M.removeEventListener("buttondown",this.onButtonDown),M.removeEventListener("buttonup",this.onButtonUp),M.removeEventListener("touchstart",this.onButtonTouchStart),M.removeEventListener("touchend",this.onButtonTouchEnd),M.removeEventListener("axismove",this.onAxisMoved),M.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var M=this.data;p(this,E,{index:this.controllerIndex,hand:M.hand})},injectTrackedControls:function(){var M=this.el,T=this.data;M.setAttribute("tracked-controls",{idPrefix:E,hand:T.hand,controller:this.controllerIndex,orientationOffset:T.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",v)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(M){var T=this.mapping.buttons[M.detail.id],D;T&&(T==="trigger"&&(D=M.detail.state.value,console.log("analog value of trigger press: "+D)),this.el.emit(T+"changed",M.detail.state))},onModelLoaded:function(M){var T=M.detail.model;T.scale.set(.01,.01,.01)},onAxisMoved:function(M){f(this,this.mapping.axes,M)},updateModel:function(M,T){},setButtonColor:function(M,T){}})},"./src/components/material.js":(s,o,c)=>{var l=c("./src/utils/index.js"),u=c("./src/core/component.js"),h=c("./src/lib/three.js"),p=c("./src/core/shader.js"),f=l.debug("components:material:error"),m=u.registerComponent,A=p.shaders,y=p.shaderNames;s.exports.Component=m("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:y,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(w){var M=this.data;(!this.shader||M.shader!==w.shader)&&this.updateShader(M.shader),this.shader.update(this.data),this.updateMaterial(w)},updateSchema:function(w){var M,T,D,L;T=w&&w.shader,M=this.oldData&&this.oldData.shader,L=T||M,D=A[L]&&A[L].schema,D||f("Unknown shader schema "+L),!(M&&T===M)&&(this.extendSchema(D),this.updateBehavior())},updateBehavior:function(){var w,M=this.el.sceneEl,T=this.schema,D=this,L;function I(F,R){var N;for(N in L)L[N]=F;D.shader.update(L)}this.tick=void 0,L={};for(w in T)T[w].type==="time"&&(this.tick=I,L[w]=!0);M&&(this.tick?M.addBehavior(this):M.removeBehavior(this))},updateShader:function(w){var M=this.data,T=A[w]&&A[w].Shader,D;if(!T)throw new Error("Unknown shader "+w);D=this.shader=new T,D.el=this.el,D.init(M),this.setMaterial(D.material),this.updateSchema(M)},updateMaterial:function(w){var M=this.data,T=this.material,D;T.alphaTest=M.alphaTest,T.depthTest=M.depthTest!==!1,T.depthWrite=M.depthWrite!==!1,T.opacity=M.opacity,T.flatShading=M.flatShading,T.side=E(M.side),T.transparent=M.transparent!==!1||M.opacity<1,T.vertexColors=M.vertexColorsEnabled,T.visible=M.visible,T.blending=x(M.blending),T.dithering=M.dithering;for(D in w)break;D&&(w.alphaTest!==M.alphaTest||w.side!==M.side||w.vertexColorsEnabled!==M.vertexColorsEnabled)&&(T.needsUpdate=!0)},remove:function(){var w=new h.MeshBasicMaterial,M=this.material,T=this.el.getObject3D("mesh");T&&(T.material=w),v(M,this.system)},setMaterial:function(w){var M=this.el,T,D=this.system;this.material&&v(this.material,D),this.material=w,D.registerMaterial(w),T=M.getObject3D("mesh"),T?T.material=w:M.addEventListener("object3dset",function L(I){I.detail.type!=="mesh"||I.target!==M||(M.getObject3D("mesh").material=w,M.removeEventListener("object3dset",L))})}});function E(w){switch(w){case"back":return h.BackSide;case"double":return h.DoubleSide;default:return h.FrontSide}}function x(w){switch(w){case"none":return h.NoBlending;case"additive":return h.AdditiveBlending;case"subtractive":return h.SubtractiveBlending;case"multiply":return h.MultiplyBlending;default:return h.NormalBlending}}function v(w,M){w.dispose(),M.unregisterMaterial(w)}},"./src/components/obb-collider.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js");l("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new u.Vector3,this.auxEuler=new u.Euler,this.boundingBox=new u.Box3,this.boundingBoxSize=new u.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var h=this.el,p=h.components["gltf-model"]&&h.components["gltf-model"].model,f,m;p&&(this.el.removeObject3D("mesh"),f=new u.Box3().setFromObject(p),m=f.getCenter(new u.Vector3),p.position.x+=p.position.x-m.x,p.position.y+=p.position.y-m.y,p.position.z+=p.position.z-m.z,this.el.setObject3D("mesh",p))},updateCollider:function(){var h=this.el,p=this.boundingBoxSize,f=this.aabb=this.aabb||new u.OBB;if(this.obb=this.obb||new u.OBB,!h.hasLoaded){h.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),f.halfSize.copy(p).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var h=this.renderColliderMesh,p=this.boundingBoxSize;if(!h){this.initColliderMesh();return}h.geometry.dispose(),h.geometry=new u.BoxGeometry(p.x,p.y,p.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var h,p,f;h=this.boundingBoxSize,p=this.renderColliderGeometry=new u.BoxGeometry(h.x,h.y,h.z),f=this.renderColliderMesh=new u.Mesh(p,new u.MeshLambertMaterial({color:65280,side:u.DoubleSide})),f.matrixAutoUpdate=!1,f.matrixWorldAutoUpdate=!1,f.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(f)},updateBoundingBox:function(){var h=this.auxEuler,p=this.boundingBox,f=this.data.size,m=this.trackedObject3D||this.el.object3D,A=this.boundingBoxSize,y=this.data.minimumColliderDimension;if(f){this.boundingBoxSize.x=f,this.boundingBoxSize.y=f,this.boundingBoxSize.z=f;return}this.previousScale.copy(m.scale),h.copy(m.rotation),m.rotation.set(0,0,0),m.updateMatrixWorld(!0),p.setFromObject(m,!0),p.getSize(A),A.x=A.x<y?y:A.x,A.y=A.y<y?y:A.y,A.z=A.z<y?y:A.z,this.el.object3D.rotation.copy(h)},checkTrackedObject:function(){var h=this.trackedObject3DPath,p;if(h&&h.length&&!this.trackedObject3D){p=this.el;for(var f=0;f<h.length&&(p=p[h[f]],!!p);f++);p&&(this.trackedObject3D=p,this.updateCollider())}return this.trackedObject3D},tick:function(){var h=new u.Vector3,p=new u.Vector3,f=new u.Quaternion,m=new u.Matrix4;return function(){var A=this.obb,y=this.renderColliderMesh,E=this.checkTrackedObject()||this.el.object3D;E&&((E.scale.x!==this.previousScale.x||E.scale.y!==this.previousScale.y||E.scale.z!==this.previousScale.z)&&this.updateCollider(),E.updateMatrix(),E.updateMatrixWorld(),E.matrixWorld.decompose(h,f,p),p.set(1,1,1),m.compose(h,f,p),y&&y.matrixWorld.copy(m),A.copy(this.aabb),A.applyMatrix4(m))}}()})},"./src/components/obj-model.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=l("components:obj-model:warn");s.exports.Component=u("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var f=this;this.model=null,this.objLoader=new h.OBJLoader,this.mtlLoader=new h.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(m){f.model&&m.detail.name==="material"&&f.applyMaterial()})},update:function(){var f=this.data;f.obj&&(this.resetMesh(),this.loadObj(f.obj,f.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(f,m){var A=this,y=this.el,E=this.mtlLoader,x=this.objLoader,v=this.el.sceneEl.systems.renderer,w=m.substr(0,m.lastIndexOf("/")+1);if(m){y.hasAttribute("material")&&p("Material component properties are ignored when a .MTL is provided"),E.setResourcePath(w),E.load(m,function(M){M.preload(),x.setMaterials(M),x.load(f,function(T){A.model=T,A.model.traverse(function(D){if(D.isMesh){var L=D.material;L.map&&v.applyColorCorrection(L.map),L.emissiveMap&&v.applyColorCorrection(L.emissiveMap)}}),y.setObject3D("mesh",T),y.emit("model-loaded",{format:"obj",model:T})})});return}x.load(f,function(T){A.model=T,A.applyMaterial(),y.setObject3D("mesh",T),y.emit("model-loaded",{format:"obj",model:T})})},applyMaterial:function(){var f=this.el.components.material;f&&this.model.traverse(function(m){m instanceof h.Mesh&&(m.material=f.material)})}})},"./src/components/oculus-go-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A=c("./src/utils/index.js").device.isWebXRAvailable,y="oculus-go",E="Oculus Go",x=c("./src/constants/index.js").AFRAME_CDN_ROOT,v=x+"controllers/oculus/go/oculus-go-controller.gltf",w=A?y:E,M={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},T={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},D=A?T:M;s.exports.Component=l("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:D,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var L=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(I){m(I.detail.id,"down",L)},this.onButtonUp=function(I){m(I.detail.id,"up",L)},this.onButtonTouchStart=function(I){m(I.detail.id,"touchstart",L)},this.onButtonTouchEnd=function(I){m(I.detail.id,"touchend",L)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){p(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var L=this.el,I=this.data;L.setAttribute("tracked-controls",{armModel:I.armModel,hand:I.hand,idPrefix:w,orientationOffset:I.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",v)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(L){var I=L.detail.model,F;this.data.model&&(F=this.buttonMeshes={},F.trigger=I.getObjectByName("oculus_go_button_trigger"),F.trackpad=I.getObjectByName("oculus_go_touchpad"),F.touchpad=I.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(L){var I=this.mapping.buttons[L.detail.id];I&&this.el.emit(I+"changed",L.detail.state)},onAxisMoved:function(L){f(this,this.mapping.axes,L)},updateModel:function(L,I){this.data.model&&this.updateButtonModel(L,I)},updateButtonModel:function(L,I){var F=this.buttonMeshes;if(!(!F||!F[L])){var R,N;switch(I){case"down":R=this.data.buttonHighlightColor;break;case"touchstart":R=this.data.buttonTouchedColor;break;default:R=this.data.buttonColor}N=F[L],N.material.color.set(R)}}})},"./src/components/oculus-touch-controls.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,A=p.onButtonEvent,y=c("./src/utils/index.js").device.isWebXRAvailable,E="oculus-touch",x="Oculus Touch",v=y?E:x,w=c("./src/constants/index.js").AFRAME_CDN_ROOT,M=w+"controllers/oculus/oculus-touch-controller-",T=w+"controllers/meta/",D={left:{modelUrl:M+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(-.005,.003,-.055),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:M+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(.005,.003,-.055),modelPivotRotation:new h.Euler(0,0,0)}},L={left:{modelUrl:M+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(-.005,.036,-.037),modelPivotRotation:new h.Euler(Math.PI/4.5,0,0)},right:{modelUrl:M+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(.005,.036,-.037),modelPivotRotation:new h.Euler(Math.PI/4.5,0,0)}},I=y?L:D,F="oculus-touch",R={"oculus-touch":I,"oculus-touch-v2":{left:{modelUrl:M+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new h.Vector3(0,-.007,-.021),modelPivotRotation:new h.Euler(-Math.PI/4,0,0)},right:{modelUrl:M+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new h.Vector3(0,-.007,-.021),modelPivotRotation:new h.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:M+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:M+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:T+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:T+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:T+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:T+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)}}},N={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},X={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},$=y?X:N;s.exports.Component=u("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:$,bindMethods:function(){this.onButtonChanged=l(this.onButtonChanged,this),this.onThumbstickMoved=l(this.onThumbstickMoved,this),this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.onAxisMoved=l(this.onAxisMoved,this)},init:function(){var U=this;this.onButtonDown=function(P){A(P.detail.id,"down",U,U.data.hand)},this.onButtonUp=function(P){A(P.detail.id,"up",U,U.data.hand)},this.onButtonTouchStart=function(P){A(P.detail.id,"touchstart",U,U.data.hand)},this.onButtonTouchEnd=function(P){A(P.detail.id,"touchend",U,U.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new h.Euler},addEventListeners:function(){var U=this.el;U.addEventListener("buttonchanged",this.onButtonChanged),U.addEventListener("buttondown",this.onButtonDown),U.addEventListener("buttonup",this.onButtonUp),U.addEventListener("touchstart",this.onButtonTouchStart),U.addEventListener("touchend",this.onButtonTouchEnd),U.addEventListener("axismove",this.onAxisMoved),U.addEventListener("model-loaded",this.onModelLoaded),U.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var U=this.el;U.removeEventListener("buttonchanged",this.onButtonChanged),U.removeEventListener("buttondown",this.onButtonDown),U.removeEventListener("buttonup",this.onButtonUp),U.removeEventListener("touchstart",this.onButtonTouchStart),U.removeEventListener("touchend",this.onButtonTouchEnd),U.removeEventListener("axismove",this.onAxisMoved),U.removeEventListener("model-loaded",this.onModelLoaded),U.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,v,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(U){var P=this.data,k;if(P.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=R[P.controllerType]||R[F],P.controllerType==="auto"){var z=this.el.sceneEl.systems["tracked-controls-webvr"];if(z&&z.vrDisplay){var Q=z.vrDisplay.displayName;/^Oculus Quest$/.test(Q)&&(this.displayModel=R["oculus-touch-v2"])}else{k=F;for(var Z=Object.keys(R),ce=0;ce<U.profiles.length;ce++)if(Z.indexOf(U.profiles[ce])!==-1){k=U.profiles[ce];break}this.displayModel=R[k]}}var Me=this.displayModel[P.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===R["oculus-touch-v3"]||this.displayModel===R["meta-quest-touch-pro"]||this.displayModel===R["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",Me)}},injectTrackedControls:function(U){var P=this.data,k=E,z=P.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",Q=y?k:z;this.el.setAttribute("tracked-controls",{id:Q,hand:P.hand,orientationOffset:P.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(U)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(U){var P=this.mapping[this.data.hand].buttons[U.detail.id];if(P){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(U);else{var k=this.buttonMeshes,z;(P==="trigger"||P==="grip")&&(z=U.detail.state.value),k&&(P==="trigger"&&k.trigger&&(k.trigger.rotation.x=this.originalXRotationTrigger-z*(Math.PI/26)),P==="grip"&&k.grip&&(z*=this.data.hand==="left"?-1:1,k.grip.position.x=this.originalXPositionGrip+z*.004))}this.el.emit(P+"changed",U.detail.state)}},onButtonChangedV3orPROorPlus:function(U){var P=this.mapping[this.data.hand].buttons[U.detail.id],k=this.buttonObjects,z;k&&(z=U.detail.state.value,k[P].quaternion.slerpQuaternions(this.buttonRanges[P].min.quaternion,this.buttonRanges[P].max.quaternion,z),k[P].position.lerpVectors(this.buttonRanges[P].min.position,this.buttonRanges[P].max.position,z))},onModelLoaded:function(U){if(this.data.model){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(U);else{var P=this.controllerObject3D=U.detail.model,k;k=this.buttonMeshes={},k.grip=P.getObjectByName("buttonHand"),this.originalXPositionGrip=k.grip&&k.grip.position.x,k.trigger=P.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=k.trigger&&k.trigger.rotation.x,k.thumbstick=P.getObjectByName("stick"),k.xbutton=P.getObjectByName("buttonX"),k.abutton=P.getObjectByName("buttonA"),k.ybutton=P.getObjectByName("buttonY"),k.bbutton=P.getObjectByName("buttonB")}for(var z in this.buttonMeshes)this.buttonMeshes[z]&&te(this.buttonMeshes[z]);this.applyOffset(U.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(U){U.position.copy(this.displayModel[this.data.hand].modelPivotOffset),U.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(U){var P=this.controllerObject3D=U.detail.model,k=this.buttonObjects={},z=this.buttonMeshes={},Q=this.buttonRanges={};z.grip=P.getObjectByName("squeeze"),k.grip=P.getObjectByName("xr_standard_squeeze_pressed_value"),Q.grip={min:P.getObjectByName("xr_standard_squeeze_pressed_min"),max:P.getObjectByName("xr_standard_squeeze_pressed_max")},k.grip.minX=k.grip.position.x,z.thumbstick=P.getObjectByName("thumbstick"),k.thumbstick=P.getObjectByName("xr_standard_thumbstick_pressed_value"),Q.thumbstick={min:P.getObjectByName("xr_standard_thumbstick_pressed_min"),max:P.getObjectByName("xr_standard_thumbstick_pressed_max")},k.thumbstickXAxis=P.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),Q.thumbstickXAxis={min:P.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:P.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},k.thumbstickYAxis=P.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),Q.thumbstickYAxis={min:P.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:P.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},z.trigger=P.getObjectByName("trigger"),k.trigger=P.getObjectByName("xr_standard_trigger_pressed_value"),Q.trigger={min:P.getObjectByName("xr_standard_trigger_pressed_min"),max:P.getObjectByName("xr_standard_trigger_pressed_max")},Q.trigger.diff={x:Math.abs(Q.trigger.max.rotation.x)-Math.abs(Q.trigger.min.rotation.x),y:Math.abs(Q.trigger.max.rotation.y)-Math.abs(Q.trigger.min.rotation.y),z:Math.abs(Q.trigger.max.rotation.z)-Math.abs(Q.trigger.min.rotation.z)};var Z=this.data.hand==="left"?"x":"a",ce=this.data.hand==="left"?"y":"b",Me=Z+"button",xe=ce+"button";z[Me]=P.getObjectByName(Z+"_button"),k[Me]=P.getObjectByName(Z+"_button_pressed_value"),Q[Me]={min:P.getObjectByName(Z+"_button_pressed_min"),max:P.getObjectByName(Z+"_button_pressed_max")},z[xe]=P.getObjectByName(ce+"_button"),k[xe]=P.getObjectByName(ce+"_button_pressed_value"),Q[xe]={min:P.getObjectByName(ce+"_button_pressed_min"),max:P.getObjectByName(ce+"_button_pressed_max")}},onAxisMoved:function(U){m(this,this.mapping[this.data.hand].axes,U)},onThumbstickMoved:function(U){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(U);return}for(var P in U.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[P]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[P]]-Math.PI/8*U.detail[P]*(P==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(U){var P=(U.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,P);var k=(U.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,k)},updateModel:function(U,P){this.data.model&&this.updateButtonModel(U,P)},updateButtonModel:function(U,P){var k=this.buttonMeshes,z,Q;k&&k[U]&&(Q=P==="up"||P==="touchend"?k[U].originalColor||this.data.buttonColor:P==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,z=k[U],z.material.color.set(Q))}});function te(U){U.traverse(function(P){var k;P.type==="Mesh"&&(k=P.material.clone(),U.originalColor=P.material.color,P.material.dispose(),P.material=k)})}},"./src/components/pico-controls.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,A=p.onButtonEvent,y="pico-4",E=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=E+"controllers/pico/pico4/",v={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};s.exports.Component=u("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:v,init:function(){var w=this;this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(M){A(M.detail.id,"down",w,w.data.hand)},this.onButtonUp=function(M){A(M.detail.id,"up",w,w.data.hand)},this.onButtonTouchEnd=function(M){A(M.detail.id,"touchend",w,w.data.hand)},this.onButtonTouchStart=function(M){A(M.detail.id,"touchstart",w,w.data.hand)},this.bindMethods()},update:function(){var w=this.data;this.controllerIndex=w.hand==="right"?0:w.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=l(this.removeControllersUpdateListener,this),this.onAxisMoved=l(this.onAxisMoved,this)},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),w.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),w.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data;f(this,y,{index:this.controllerIndex,hand:w.hand})},injectTrackedControls:function(){var w=this.el,M=this.data;w.setAttribute("tracked-controls",{idPrefix:y,hand:M.hand,controller:this.controllerIndex,orientationOffset:M.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var M=this.mapping[this.data.hand].buttons[w.detail.id],T;M&&(M==="trigger"&&(T=w.detail.state.value,console.log("analog value of trigger press: "+T)),this.el.emit(M+"changed",w.detail.state))},onModelLoaded:function(w){this.data.model&&this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new h.Vector3(0,0,0)})},onAxisMoved:function(w){m(this,this.mapping.axes,w)}})},"./src/components/position.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("position",{schema:{type:"vec3"},update:function(){var u=this.el.object3D,h=this.data;u.position.set(h.x,h.y,h.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=h.debug("components:raycaster:warn"),f=/^[\w\s-.,[\]#]*$/,m={childList:!0,attributes:!0,subtree:!0},A={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};s.exports.Component=l("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new u.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new u.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new u.Vector3,this.otherLineEndVec3=new u.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(E){var x=this.data,v=this.el,w=this.raycaster;w.far=x.far,w.near=x.near,x.showLine&&(x.far!==E.far||x.origin!==E.origin||x.direction!==E.direction||!E.showLine)&&(this.unitLineEndVec3.copy(x.direction).normalize(),this.drawLine()),!x.showLine&&E.showLine&&v.removeAttribute("line"),x.objects!==E.objects&&!f.test(x.objects)&&p('[raycaster] Selector "'+x.objects+'" may not update automatically with DOM changes.'),x.objects||p('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),x.autoRefresh!==E.autoRefresh&&v.isPlaying&&(x.autoRefresh?this.addEventListeners():this.removeEventListeners()),E.enabled&&!x.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,m),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var E=this.data,x;x=E.objects?this.el.sceneEl.querySelectorAll(E.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(x),this.dirty=!1},tock:function(E){var x=this.data,v=this.prevCheckTime;x.enabled&&(v&&E-v<x.interval||(this.prevCheckTime=E,this.checkIntersections()))},checkIntersections:function(){var E=this.clearedIntersectedEls,x=this.el,v=this.data,w,M=this.intersectedEls,T,D=this.intersections,L=this.newIntersectedEls,I=this.newIntersections,F=this.prevIntersectedEls,R=this.rawIntersections;for(this.dirty&&this.refreshObjects(),y(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),R.length=0,this.raycaster.intersectObjects(this.objects,!0,R),D.length=0,M.length=0,w=0;w<R.length;w++)T=R[w],!(v.showLine&&T.object===x.getObject3D("line"))&&T.object.el&&(D.push(T),M.push(T.object.el));for(I.length=0,L.length=0,w=0;w<D.length;w++)F.indexOf(D[w].object.el)===-1&&(I.push(D[w]),L.push(D[w].object.el));for(E.length=0,w=0;w<F.length;w++)M.indexOf(F[w])===-1&&(F[w].emit(A.INTERSECT_CLEAR,this.intersectedClearedDetail),E.push(F[w]));for(E.length&&x.emit(A.INTERSECTION_CLEAR,this.intersectionClearedDetail),w=0;w<L.length;w++)L[w].emit(A.INTERSECT,this.intersectedDetail);I.length&&(this.intersectionDetail.els=L,this.intersectionDetail.intersections=I,x.emit(A.INTERSECTION,this.intersectionDetail)),(F.length===0&&D.length>0||F.length>0&&D.length===0||F.length&&D.length&&F[0]!==D[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=D,x.emit(A.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),v.showLine&&setTimeout(this.updateLine)},updateLine:function(){var E=this.el,x=this.intersections,v;x.length&&(x[0].object.el===E&&x[1]?v=x[1].distance:v=x[0].distance),this.drawLine(v)},getIntersection:function(E){var x,v;for(x=0;x<this.intersections.length;x++)if(v=this.intersections[x],v.object.el===E)return v;return null},updateOriginDirection:function(){var E=new u.Vector3,x=new u.Vector3;return function(){var w=this.el,M=this.data;if(M.useWorldCoordinates){this.raycaster.set(M.origin,M.direction);return}w.object3D.updateMatrixWorld(),x.setFromMatrixPosition(w.object3D.matrixWorld),(M.origin.x!==0||M.origin.y!==0||M.origin.z!==0)&&(x=w.object3D.localToWorld(x.copy(M.origin))),E.copy(M.direction).transformDirection(w.object3D.matrixWorld).normalize(),this.raycaster.set(x,E)}}(),drawLine:function(E){var x=this.data,v=this.el,w;w=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,E===void 0&&(E=x.far===1/0?1e3:x.far),this.lineData.start=x.origin,this.lineData.end=w.copy(this.unitLineEndVec3).multiplyScalar(E).add(x.origin),this.lineData.color=x.lineColor,this.lineData.opacity=x.lineOpacity,v.setAttribute("line",this.lineData)},flattenObject3DMaps:function(E){var x,v,w=this.objects,M=this.el.sceneEl.object3D;function T(L){return L.parent?T(L.parent):L===M}for(w.length=0,v=0;v<E.length;v++){var D=E[v];if(D.isEntity&&D.object3D&&T(D.object3D))for(x in D.object3DMap)w.push(D.getObject3D(x))}return w},clearAllIntersections:function(){var E;for(E=0;E<this.intersectedEls.length;E++)this.intersectedEls[E].emit(A.INTERSECT_CLEAR,this.intersectedClearedDetail);y(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(A.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function y(E,x){var v;for(E.length=x.length,v=0;v<x.length;v++)E[v]=x[v]}},"./src/components/rotation.js":(s,o,c)=>{var l=c("./src/lib/three.js").MathUtils.degToRad,u=c("./src/core/component.js").registerComponent;s.exports.Component=u("rotation",{schema:{type:"vec3"},update:function(){var h=this.data,p=this.el.object3D;p.rotation.set(l(h.x),l(h.y),l(h.z)),p.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=1e-5;s.exports.Component=l("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var h=this.data,p=this.el.object3D,f=h.x===0?u:h.x,m=h.y===0?u:h.y,A=h.z===0?u:h.z;p.scale.set(f,m,A)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(s,o,c)=>{var l="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=21,f=function(){var E=new h.Quaternion,x=new h.Vector3;function v(w,M,T){M.position.copy(w.transform.position),M.quaternion.copy(w.transform.orientation),x.copy(T),E.copy(w.transform.orientation),x.applyQuaternion(E),M.position.sub(x)}return v}();f.tempFakePose={transform:{orientation:new h.Quaternion,position:new h.Vector3}};function m(E,x){this.renderer=E,this.xrHitTestSource=null,E.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),E.xr.addEventListener("sessionstart",(function(){this.sessionStart(x)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(x)}m.prototype.previousFrameAnchors=new Set,m.prototype.anchorToObject3D=new Map;function A(E){console.warn(E.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}m.prototype.sessionStart=function(x){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){A({message:"No requestHitTestSource on the session."});return}x.space?this.session.requestHitTestSource(x).then((function(v){this.xrHitTestSource=v}).bind(this)).catch(A):x.profile&&this.session.requestHitTestSourceForTransientInput(x).then((function(v){this.xrHitTestSource=v,this.transient=!0}).bind(this)).catch(A)},m.prototype.anchorFromLastHitTestResult=function(E,x){var v=this.lastHitTest;if(v){var w={object3D:E,offset:x};Array.from(this.anchorToObject3D.entries()).forEach((function(M){var T=M[1].object3D,D=M[0];T===E&&(this.anchorToObject3D.delete(D),D.delete())}).bind(this)),v.createAnchor&&v.createAnchor().then((function(M){this.anchorToObject3D.set(M,w)}).bind(this)).catch(function(M){console.warn(M.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},m.prototype.doHit=function(x){if(this.renderer.xr.isPresenting){var v=this.renderer.xr.getReferenceSpace(),w=x.getViewerPose(v),M,T;if(this.xrHitTestSource&&w)return this.transient?(M=x.getHitTestResultsForTransientInput(this.xrHitTestSource),M.length>0?(T=M[0].results,T.length>0?(this.lastHitTest=T[0],T[0].getPose(v)):!1):!1):(M=x.getHitTestResults(this.xrHitTestSource),M.length>0?(this.lastHitTest=M[0],M[0].getPose(v)):!1)}},m.updateAnchorPoses=function(E,x){var v=E.trackedAnchors||m.prototype.previousFrameAnchors;m.prototype.previousFrameAnchors.forEach(function(w){v.has(w)||m.prototype.anchorToObject3D.delete(w)}),v.forEach(function(w){var M,T,D,L;try{M=E.getPose(w.anchorSpace,x)}catch{}M&&(T=m.prototype.anchorToObject3D.get(w),D=T.offset,L=T.object3D,f(M,L,D))})};var y;s.exports.Component=u("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:l,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new h.OrthographicCamera,this.orthoCam.layers.set(p),this.textureTarget=new h.WebGLRenderTarget(512,512,{}),this.basicMaterial=new h.MeshBasicMaterial({color:0,side:h.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new h.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var E=this.el.getAttribute("webxr"),x=E.optionalFeatures;(!x.includes("hit-test")||!x.includes("anchors"))&&(x.push("hit-test"),x.push("anchors"),this.el.setAttribute("webxr",E)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var v=this.el.sceneEl.renderer,w=this.session=v.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,y||(y=new Map),w.requestReferenceSpace("viewer").then((function(D){this.hitTest=new m(v,{space:D}),y.set(D,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var M="generic-touchscreen",T=new m(v,{profile:M});w.addEventListener("selectstart",(function(D){if(this.data.enabled===!0){var L=D.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),L.profiles[0]===M?this.hitTest=T:(this.hitTest=y.get(L)||new m(v,{space:L.targetRaySpace}),y.set(L,this.hitTest)))}}).bind(this)),w.addEventListener("selectend",(function(D){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var L=D.inputSource,I;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(I=this.data.target.object3D,I&&(f.tempFakePose.transform.position.copy(this.bboxMesh.position),f.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),f(f.tempFakePose,I,this.bboxOffset),I.visible=!0,this.hitTest.anchorFromLastHitTestResult(I,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new h.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(p),this.data.target.object3D.traverse(function(E){E.layers.enable(p)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var E=new h.PlaneGeometry(1,1),x=new h.MeshBasicMaterial({transparent:!0,color:16777215});E.rotateX(-Math.PI/2),E.rotateY(-Math.PI/2),this.bbox=new h.Box3,this.bboxMesh=new h.Mesh(E,x),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var E,x=this.el.sceneEl.renderer,v,w,M=x.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),v=x.getRenderTarget(),x.setRenderTarget(this.textureTarget),x.xr.enabled=!1,w=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,x.render(this.el.object3D,this.orthoCam),this.el.object3D.background=w,this.el.object3D.overrideMaterial=null,x.xr.enabled=M,x.setRenderTarget(v),x.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),E=this.context.getImageData(0,0,512,512);for(var T=0;T<262144;T++)E.data[T*4+3]!==0&&E.data[T*4+3]!==255&&(E.data[T*4+3]=128);this.context.putImageData(E,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var E,x=this.el.sceneEl.frame,v=this.el.sceneEl.renderer;if(x&&m.updateAnchorPoses(x,v.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var w;this.textureCache.has(this.data.src)?w=this.textureCache.get(this.data.src):(w=new h.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,w)),this.bboxMesh.material.map=w,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(E=this.hitTest.doHit(x),E&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(E.transform.position),this.bboxMesh.quaternion.copy(E.transform.orientation)))}})},"./src/components/scene/background.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/core/component.js").components;s.exports.Component=l("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var h=this.data,p=this.el.object3D;h.transparent?p.background=null:p.background=new THREE.Color(h.color)},remove:function(){var h=this.data,p=this.el.object3D;if(h.transparent){p.background=null;return}p.background=u[this.name].schema.color.default}})},"./src/components/scene/debug.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("debug",{schema:{default:!0}})},"./src/components/scene/device-orientation-permission-ui.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js"),h=u.bind,p=c("./src/constants/index.js"),f="a-modal",m="a-dialog",A="a-dialog-text",y="a-dialog-text-container",E="a-dialog-buttons-container",x="a-dialog-button",v="a-dialog-allow-button",w="a-dialog-deny-button",M="a-dialog-ok-button";s.exports.Component=l("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var I=this;if(this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=h(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=h(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().then(function(){I.el.emit("deviceorientationpermissiongranted"),I.permissionGranted=!0}).catch(function(){I.devicePermissionDialogEl=T(I.data.denyButtonText,I.data.allowButtonText,I.data.deviceMotionMessage,I.onDeviceMotionDialogAllowClicked,I.onDeviceMotionDialogDenyClicked),I.el.appendChild(I.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var I=this,F=D(I.data.cancelButtonText,I.data.httpsMessage,function(){I.el.removeChild(F)});this.el.appendChild(F)},onDeviceMotionDialogAllowClicked:function(){var I=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(F){F==="granted"?(I.el.emit("deviceorientationpermissiongranted"),I.permissionGranted=!0):I.el.emit("deviceorientationpermissionrejected"),I.remove()}).catch(console.error)}});function T(I,F,R,N,X){var $,te,U;return $=document.createElement("div"),$.classList.add(E),te=document.createElement("button"),te.classList.add(x,w),te.setAttribute(p.AFRAME_INJECTED,""),te.innerHTML=I,$.appendChild(te),U=document.createElement("button"),U.classList.add(x,v),U.setAttribute(p.AFRAME_INJECTED,""),U.innerHTML=F,$.appendChild(U),U.addEventListener("click",function(P){P.stopPropagation(),N()}),te.addEventListener("click",function(P){P.stopPropagation(),X()}),L(R,$)}function D(I,F,R){var N,X;return N=document.createElement("div"),N.classList.add(E),X=document.createElement("button"),X.classList.add(x,M),X.setAttribute(p.AFRAME_INJECTED,""),X.innerHTML=I,N.appendChild(X),X.addEventListener("click",function($){$.stopPropagation(),R()}),L(F,N)}function L(I,F){var R,N,X,$;return R=document.createElement("div"),R.classList.add(f),R.setAttribute(p.AFRAME_INJECTED,""),N=document.createElement("div"),N.className=m,N.setAttribute(p.AFRAME_INJECTED,""),R.appendChild(N),X=document.createElement("div"),X.classList.add(y),N.appendChild(X),$=document.createElement("div"),$.classList.add(A),$.innerHTML=I,X.appendChild($),N.appendChild(F),R}},"./src/components/scene/embedded.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},update:function(){var u=this.el,h=u.querySelector(".a-enter-vr");this.data===!0?(h&&h.classList.add("embedded"),u.removeFullScreenStyles()):(h&&h.classList.remove("embedded"),u.addFullScreenStyles())}})},"./src/components/scene/fog.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=c("./src/utils/debug.js"),p=h("components:fog:warn");s.exports.Component=l("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var m=this.data,A=this.el,y=this.el.object3D.fog;if(!A.isScene){p("Fog component can only be applied to <a-scene>");return}if(!y||m.type!==y.name){A.object3D.fog=f(m),A.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(E){var x=m[E];E==="color"&&(x=new u.Color(x)),y[E]=x})},remove:function(){var m=this.el.object3D.fog;m&&(m.far=0,m.near=.1)}});function f(m){var A;return m.type==="exponential"?A=new u.FogExp2(m.color,m.density):A=new u.Fog(m.color,m.near,m.far),A.name=m.type,A}},"./src/components/scene/inspector.js":(s,o,c)=>{var l=c("./src/constants/index.js").AFRAME_INJECTED,u=c("./package.json"),h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js");function f(v){var w=v.split(".");return w[2]="x",w.join(".")}var m="https://aframe.io/aframe-inspector/dist/aframe-inspector.js",A="https://unpkg.com/aframe-inspector@"+f(u.version)+"/dist/aframe-inspector.min.js",y=A,E="Loading Inspector",x="Error loading Inspector";s.exports.Component=h("inspector",{schema:{url:{default:y}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var v;this.firstPlay&&(v=p.getUrlParameter("inspector"),v!=="false"&&v&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var v='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=E+v},remove:function(){this.removeEventListeners()},onKeydown:function(v){var w=v.keyCode===73&&(v.ctrlKey&&v.altKey||v.getModifierState("AltGraph"));w&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(v){v.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(v){var w=this,M;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(v);return}this.showLoader(),M=document.createElement("script"),M.src=this.data.url,M.setAttribute("data-name","aframe-inspector"),M.setAttribute(l,""),M.onload=function(){AFRAME.INSPECTOR.open(v),w.hideLoader(),w.removeEventListeners()},M.onerror=function(){w.loadingMessageEl.innerHTML=x},document.head.appendChild(M),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/index.js").shouldCaptureKeyEvent;s.exports.Component=l("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(h){var p=this.data;this.enterVREnabled=p.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(h){var p=this.el;u(h)&&(this.enterVREnabled&&h.keyCode===70&&p.enterVR(),this.enterVREnabled&&h.keyCode===27&&p.exitVR())}})},"./src/components/scene/pool.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=c("./src/core/component.js").registerComponent,h=l("components:pool:warn");s.exports.Component=u("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var p;for(this.availableEls=[],this.usedEls=[],this.data.mixin||h("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||h("Container "+this.data.container+" not found.")),this.container=this.container||this.el,p=0;p<this.data.size;++p)this.createEntity()},update:function(p){var f=this.data;(p.mixin!==f.mixin||p.size!==f.size)&&this.initPool()},createEntity:function(){var p;p=document.createElement("a-entity"),p.play=this.wrapPlay(p.play),p.setAttribute("mixin",this.data.mixin),p.object3D.visible=!1,p.pause(),this.container.appendChild(p),this.availableEls.push(p);var f=this.usedEls;p.addEventListener("loaded",function(){f.indexOf(p)===-1&&(p.object3DParent=p.object3D.parent,p.object3D.parent.remove(p.object3D))})},wrapPlay:function(p){var f=this.usedEls;return function(){f.indexOf(this)!==-1&&p.call(this)}},requestEntity:function(){var p;if(this.availableEls.length===0){if(this.data.dynamic===!1){h("Requested entity from empty pool: "+this.attrName);return}else h("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return p=this.availableEls.shift(),this.usedEls.push(p),p.object3DParent&&(p.object3DParent.add(p.object3D),this.updateRaycasters()),p.object3D.visible=!0,p},returnEntity:function(p){var f=this.usedEls.indexOf(p);if(f===-1){h("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(f,1),this.availableEls.push(p),p.object3DParent=p.object3D.parent,p.object3D.parent.remove(p.object3D),this.updateRaycasters(),p.object3D.visible=!1,p.pause(),p},updateRaycasters:function(){var p=document.querySelectorAll("[raycaster]");p.forEach(function(f){f.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js");s.exports.Component=l("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},init:function(){var h=this.el.getAttribute("webxr"),p=h.requiredFeatures;p.indexOf("mesh-detection")===-1&&(p.push("mesh-detection"),this.el.setAttribute("webxr",h)),p.indexOf("plane-detection")===-1&&(p.push("plane-detection"),this.el.setAttribute("webxr",h)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var h=this.data,p,f,m=this.el,A=m.renderer.xr,y,E=this.meshEntities,x=!1,v=[],w=this.data.filterLabels;y=m.frame,p=y.detectedMeshes,f=y.detectedPlanes;for(var M=0;M<E.length;M++)E[M].present=!1;if(h.meshesEnabled){for(var T of p.values())if(!(w.length&&w.indexOf(T.semanticLabel)===-1)){for(M=0;M<E.length;M++)if(T===E[M].mesh){x=!0,E[M].present=!0,E[M].lastChangedTime<T.lastChangedTime&&this.updateMeshGeometry(E[M].el,T),E[M].lastChangedTime=T.lastChangedTime;break}x||v.push(T),x=!1}}if(h.planesEnabled){for(T of f.values())if(!(w.length&&w.indexOf(T.semanticLabel)===-1)){for(M=0;M<E.length;M++)if(T===E[M].mesh){x=!0,E[M].present=!0,E[M].lastChangedTime<T.lastChangedTime&&this.updateMeshGeometry(E[M].el,T),E[M].lastChangedTime=T.lastChangedTime;break}x||v.push(T),x=!1}}this.deleteMeshes(),this.createNewMeshes(v)},updateMeshes:function(){var h=new u.Matrix4;return function(){for(var p,f=this.el,m,A=f.frame,y=this.meshEntities,E=f.renderer.xr.getReferenceSpace(),x,v=0;v<y.length;v++)x=y[v].mesh.meshSpace||y[v].mesh.planeSpace,p=A.getPose(x,E),m=y[v].el,m.hasLoaded&&(h.fromArray(p.transform.matrix),h.decompose(m.object3D.position,m.object3D.quaternion,m.object3D.scale))}}(),deleteMeshes:function(){for(var h=this.meshEntities,p=[],f=0;f<h.length;f++)h[f].present?p.push(h[f]):this.el.removeChild(h[f]);this.meshEntities=p},createNewMeshes:function(h){for(var p,f=0;f<h.length;f++)p=document.createElement("a-entity"),this.meshEntities.push({mesh:h[f],el:p}),p.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(p)},initMeshGeometry:function(h){var p,f,m;if(h instanceof XRPlane){f=new u.Shape,m=h.polygon;for(var A=0;A<m.length;++A)A===0?f.moveTo(m[A].x,m[A].z):f.lineTo(m[A].x,m[A].z);return p=new u.ShapeGeometry(f),p.rotateX(Math.PI/2),p}return p=new u.BufferGeometry,p.setAttribute("position",new u.BufferAttribute(h.vertices,3)),p.setIndex(new u.BufferAttribute(h.indices,1)),p},initWorldMeshEntity:function(h){for(var p=h.target,f,m,A,y=this.meshEntities,E=0;E<y.length;E++)if(y[E].el===p){A=y[E];break}f=this.initMeshGeometry(A.mesh),m=new u.Mesh(f,new u.MeshBasicMaterial({color:Math.random()*16777215,side:u.DoubleSide})),p.setObject3D("mesh",m),A.mesh instanceof XRPlane&&this.data.planeMixin?p.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&p.setAttribute("mixin",this.data.meshMixin),p.setAttribute("data-world-mesh",A.mesh.semanticLabel)},updateMeshGeometry:function(h,p){var f=h.getObject3D("mesh");f.geometry.dispose(),f.geometry=this.initMeshGeometry(p)}})},"./src/components/scene/reflection.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;function u(h,p,f,m){var A=Math.max(h.primaryLightIntensity.x,Math.max(h.primaryLightIntensity.y,h.primaryLightIntensity.z));p.sh.fromArray(h.sphericalHarmonicsCoefficients),p.intensity=1,f&&(f.color.setRGB(h.primaryLightIntensity.x/A,h.primaryLightIntensity.y/A,h.primaryLightIntensity.z/A),f.intensity=A,m.copy(h.primaryLightDirection))}s.exports.Component=l("reflection",{schema:{directionalLight:{type:"selector"}},init:function(){var h=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var p=this.el.getAttribute("webxr"),f=p.optionalFeatures;f.includes("light-estimation")||(f.push("light-estimation"),this.el.setAttribute("webxr",p)),this.el.addEventListener("enter-vr",function(){var m=h.el.renderer,A=m.xr.getSession();A.requestLightProbe&&h.el.is("ar-mode")&&h.startLightProbe()}),this.el.addEventListener("exit-vr",function(){h.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var h=this.el.renderer,p=h.xr.getSession(),f=this,m=h.getContext();if(!this.probeLight){var A=document.createElement("a-light");A.setAttribute("type","probe"),A.setAttribute("intensity",0),this.el.appendChild(A),this.probeLight=A}switch(p.preferredReflectionFormat){case"srgba8":m.getExtension("EXT_sRGB");break;case"rgba16f":m.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(p,m),m.getExtension("EXT_sRGB"),m.getExtension("OES_texture_half_float"),p.requestLightProbe().then(function(y){f.xrLightProbe=y,y.addEventListener("reflectionchange",f.updateXRCubeMap.bind(f))}).catch(function(y){console.warn("Lighting estimation not supported: "+y.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var h=this.el.renderer,p=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(p){var f=h.properties.get(this.lightingEstimationTexture);f.__webglTexture=p,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var h=this.el.object3D,p=this.el.renderer,f=this.el.frame;if(f&&this.xrLightProbe){var m=f.getLightEstimate(this.xrLightProbe);m&&u(m,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(h.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(p,h),h.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&f&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),p=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);s.exports.Component=l("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var f=this.el,m=this;f.renderer?A():f.addEventListener("render-target-loaded",A);function A(){var y=f.renderer.getContext();y&&(m.cubeMapSize=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE),m.material=new u.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:h,fragmentShader:p,side:u.DoubleSide}),m.quad=new u.Mesh(new u.PlaneGeometry(1,1),m.material),m.quad.visible=!1,m.camera=new u.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),m.canvas=document.createElement("canvas"),m.ctx=m.canvas.getContext("2d"),f.object3D.add(m.quad),m.onKeyDown=m.onKeyDown.bind(m))}},getRenderTarget:function(f,m){return new u.WebGLRenderTarget(f,m,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:u.LinearFilter,magFilter:u.LinearFilter,wrapS:u.ClampToEdgeWrapping,wrapT:u.ClampToEdgeWrapping,format:u.RGBAFormat,type:u.UnsignedByteType})},resize:function(f,m){this.quad.scale.set(f,m,1),this.camera.left=-1*f/2,this.camera.right=f/2,this.camera.top=m/2,this.camera.bottom=-1*m/2,this.camera.updateProjectionMatrix(),this.canvas.width=f,this.canvas.height=m},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(f){var m=f.keyCode===83&&f.ctrlKey&&f.altKey;if(!(!this.data||!m)){var A=f.shiftKey?"equirectangular":"perspective";this.capture(A)}},setCapture:function(f){var m=this.el,A,y,E,x;return f==="perspective"?(this.quad.visible=!1,y=this.data.camera&&this.data.camera.components.camera.camera||m.camera,A={width:this.data.width,height:this.data.height}):(y=this.camera,x=new u.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:u.RGBFormat,generateMipmaps:!0,minFilter:u.LinearMipmapLinearFilter,colorSpace:u.SRGBColorSpace}),E=new u.CubeCamera(m.camera.near,m.camera.far,x),m.camera.getWorldPosition(E.position),m.camera.getWorldQuaternion(E.quaternion),E.update(m.renderer,m.object3D),this.quad.material.uniforms.map.value=E.renderTarget.texture,A={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:y,size:A,projection:f}},capture:function(f){var m=this.el.renderer.xr.enabled,A=this.el.renderer,y;A.xr.enabled=!1,y=this.setCapture(f),this.renderCapture(y.camera,y.size,y.projection),this.saveCapture(),A.xr.enabled=m},getCanvas:function(f){var m=this.el.renderer.xr.enabled,A=this.el.renderer,y=this.setCapture(f);return A.xr.enabled=!1,this.renderCapture(y.camera,y.size,y.projection),A.xr.enabled=m,this.canvas},renderCapture:function(f,m,A){var y=this.el.renderer.autoClear,E=this.el,x,v,w,M=E.renderer;v=this.getRenderTarget(m.width,m.height),w=new Uint8Array(4*m.width*m.height),this.resize(m.width,m.height),M.autoClear=!0,M.clear(),M.setRenderTarget(v),M.render(E.object3D,f),M.autoClear=y,M.readRenderTargetPixels(v,0,0,m.width,m.height,w),M.setRenderTarget(null),A==="perspective"&&(w=this.flipPixelsVertically(w,m.width,m.height)),x=new ImageData(new Uint8ClampedArray(w),m.width,m.height),this.quad.visible=!1,this.ctx.putImageData(x,0,0)},flipPixelsVertically:function(f,m,A){for(var y=f.slice(0),E=0;E<m;++E)for(var x=0;x<A;++x)y[E*4+x*m*4]=f[E*4+(A-x)*m*4],y[E*4+1+x*m*4]=f[E*4+1+(A-x)*m*4],y[E*4+2+x*m*4]=f[E*4+2+(A-x)*m*4],y[E*4+3+x*m*4]=f[E*4+3+(A-x)*m*4];return y},saveCapture:function(){this.canvas.toBlob(function(f){var m="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",A=document.createElement("a"),y=URL.createObjectURL(f);A.href=y,A.setAttribute("download",m),A.innerHTML="downloading...",A.style.display="none",document.body.appendChild(A),setTimeout(function(){A.click(),document.body.removeChild(A)},1)},"image/png")}})},"./src/components/scene/stats.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./vendor/rStats.js"),h=c("./src/utils/index.js");c("./vendor/rStats.extras.js"),c("./src/lib/rStatsAframe.js");var p=window.aframeStats,f=h.bind,m="a-hidden",A=window.threeStats;s.exports.Component=l("stats",{schema:{default:!0},init:function(){var E=this.el;h.getUrlParameter("stats")!=="false"&&(this.stats=y(E),this.statsEl=document.querySelector(".rs-base"),this.hideBound=f(this.hide,this),this.showBound=f(this.show,this),E.addEventListener("enter-vr",this.hideBound),E.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var E=this.stats;E&&(E("rAF").tick(),E("FPS").frame(),E().update())},hide:function(){this.statsEl.classList.add(m)},show:function(){this.statsEl.classList.remove(m)}});function y(E){var x=new A(E.renderer),v=new p(E),w=E.isMobile?[]:[x,v];return new u({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:w})}},"./src/components/scene/xr-mode-ui.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/constants/index.js"),h=c("./src/utils/index.js"),p=h.bind,f="a-enter-vr",m="a-enter-ar",A="a-enter-vr-button",y="a-enter-ar-button",E="a-hidden",x="a-orientation-modal";s.exports.Component=l("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},init:function(){var D=this,L=this.el;h.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),L.addEventListener("enter-vr",this.updateEnterInterfaces),L.addEventListener("exit-vr",this.updateEnterInterfaces),L.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(I){I.data.type==="loaderReady"&&(D.insideLoader=!0,D.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=p(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=p(this.onEnterARButtonClick,this),this.onModalClick=p(this.onModalClick,this),this.toggleOrientationModalIfNeeded=p(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=p(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var D=this.data,L=this.el;if(!D.enabled||this.insideLoader||h.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&D.enterVREnabled&&(D.XRMode==="xr"||D.XRMode==="vr")&&(D.enterVRButton?(this.enterVREl=document.querySelector(D.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=v(this.onEnterVRButtonClick),L.appendChild(this.enterVREl))),!this.enterAREl&&D.enterAREnabled&&(D.XRMode==="xr"||D.XRMode==="ar")&&(D.enterARButton?(this.enterAREl=document.querySelector(D.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=w(this.onEnterARButtonClick,D.XRMode==="xr"),L.appendChild(this.enterAREl))),this.orientationModalEl=M(this.onModalClick),L.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(D){D&&D.parentNode&&D.parentNode.removeChild(D)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var D=this.el;this.enterVREl&&(D.is("vr-mode")||(D.isMobile||h.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!h.device.checkVRSupport()?this.enterVREl.classList.add(E):(h.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(E)))},toggleEnterARButtonIfNeeded:function(){var D=this.el;this.enterAREl&&(D.is("vr-mode")||!h.device.checkARSupport()?this.enterAREl.classList.add(E):this.enterAREl.classList.remove(E))},toggleOrientationModalIfNeeded:function(){var D=this.el,L=this.orientationModalEl;!L||!D.isMobile||(!h.device.isLandscape()&&D.is("vr-mode")?L.classList.remove(E):L.classList.add(E))}});function v(D){var L,I;return I=document.createElement("div"),I.classList.add(f),I.setAttribute(u.AFRAME_INJECTED,""),L=document.createElement("button"),L.className=A,L.setAttribute("title","Enter VR mode with a headset or fullscreen without"),L.setAttribute(u.AFRAME_INJECTED,""),h.device.isMobile()&&T(L),I.appendChild(L),L.addEventListener("click",function(F){D(),F.stopPropagation()}),I}function w(D,L){var I,F;return F=document.createElement("div"),F.classList.add(m),L&&F.classList.add("xr"),F.setAttribute(u.AFRAME_INJECTED,""),I=document.createElement("button"),I.className=y,I.setAttribute("title","Enter AR mode with a headset or handheld device."),I.setAttribute(u.AFRAME_INJECTED,""),h.device.isMobile()&&T(I),F.appendChild(I),I.addEventListener("click",function(R){D(),R.stopPropagation()}),F}function M(D){var L=document.createElement("div");L.className=x,L.classList.add(E),L.setAttribute(u.AFRAME_INJECTED,"");var I=document.createElement("button");return I.setAttribute(u.AFRAME_INJECTED,""),I.innerHTML="Exit VR",I.addEventListener("click",D),L.appendChild(I),L}function T(D){D.addEventListener("touchstart",function(){D.classList.remove("resethover")}),D.addEventListener("touchend",function(){D.classList.add("resethover")})}},"./src/components/shadow.js":(s,o,c)=>{var l=c("./src/core/component.js"),u=c("./src/lib/three.js"),h=c("./src/utils/bind.js"),p=l.registerComponent;s.exports.Component=p("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=h(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var f=this.data;this.updateDescendants(f.cast,f.receive)},remove:function(){var f=this.el;f.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(f,m){var A=this.el.sceneEl;this.el.object3D.traverse(function(y){if(y instanceof u.Mesh&&(y.castShadow=f,y.receiveShadow=m,A.hasLoaded&&y.material))for(var E=Array.isArray(y.material)?y.material:[y.material],x=0;x<E.length;x++)E[x].needsUpdate=!0})}})},"./src/components/sound.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/debug.js"),h=c("./src/lib/three.js"),p=u("components:sound:warn");s.exports.Component=l("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var f=this;this.listener=null,this.audioLoader=new h.AudioLoader,this.pool=new h.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){f.playSound()}},update:function(f){var m=this.data,A,y,E=m.src!==f.src;if(E){if(!m.src)return;this.setupSound()}for(A=0;A<this.pool.children.length;A++)y=this.pool.children[A],m.positional&&(y.setDistanceModel(m.distanceModel),y.setMaxDistance(m.maxDistance),y.setRefDistance(m.refDistance),y.setRolloffFactor(m.rolloffFactor)),y.setLoop(m.loop),y.setLoopStart(m.loopStart),m.loopStart!==0&&m.loopEnd===0?y.setLoopEnd(y.buffer.duration):y.setLoopEnd(m.loopEnd),y.setVolume(m.volume),y.isPaused=!1;if(m.on!==f.on&&this.updateEventListener(f.on),E){var x=this;this.loaded=!1,this.audioLoader.load(m.src,function(v){for(A=0;A<x.pool.children.length;A++)y=x.pool.children[A],y.setBuffer(v);x.loaded=!0,h.Cache.remove(m.src),(x.data.autoplay||x.mustPlay)&&x.playSound(this.processSound),x.el.emit("sound-loaded",x.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var f,m;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(f=0;f<this.pool.children.length;f++)m=this.pool.children[f],m.disconnect()}catch{p("Audio source not properly disconnected")}},updateEventListener:function(f){var m=this.el;f&&m.removeEventListener(f,this.playSoundBound),m.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var f=this.el,m,A=f.sceneEl,y=this,E;this.pool.children.length>0&&(this.stopSound(),f.removeObject3D("sound"));var x=this.listener=A.audioListener||new h.AudioListener;for(A.audioListener=x,A.camera&&A.camera.add(x),A.addEventListener("camera-set-active",function(v){v.detail.cameraEl.getObject3D("camera").add(x)}),this.pool=new h.Group,m=0;m<this.data.poolSize;m++)E=this.data.positional?new h.PositionalAudio(x):new h.Audio(x),this.pool.add(E);for(f.setObject3D(this.attrName,this.pool),m=0;m<this.pool.children.length;m++)E=this.pool.children[m],E.onEnded=function(){this.isPlaying=!1,y.el.emit("sound-ended",y.evtDetail,!1)}},pauseSound:function(){var f,m;for(this.isPlaying=!1,f=0;f<this.pool.children.length;f++)m=this.pool.children[f],!(!m.source||!m.source.buffer||!m.isPlaying||m.isPaused)&&(m.isPaused=!0,m.pause())},playSound:function(f){var m,A,y;if(!this.loaded){p("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=f;return}for(m=!1,this.isPlaying=!0,A=0;A<this.pool.children.length;A++)if(y=this.pool.children[A],!y.isPlaying&&y.buffer&&!m){f&&f(y),y.play(),y.isPaused=!1,m=!0;continue}if(!m){p("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var f,m;for(this.isPlaying=!1,f=0;f<this.pool.children.length;f++){if(m=this.pool.children[f],!m.source||!m.source.buffer)return;m.stop()}}})},"./src/components/text.js":(s,o,c)=>{var l=c("./node_modules/three-bmfont-text/index.js"),u=c("./node_modules/load-bmfont/browser.js"),h=c("./src/core/component.js").registerComponent,p=c("./src/core/shader.js"),f=c("./src/lib/three.js"),m=c("./src/utils/index.js"),A=m.debug("components:text:error"),y=p.shaders,E=m.debug("components:text:warn"),x=1,v=16,w=c("./src/constants/index.js").AFRAME_CDN_ROOT,M=w+"fonts/",T={aileronsemibold:M+"Aileron-Semibold.fnt",dejavu:M+"DejaVu-sdf.fnt",exo2bold:M+"Exo2Bold.fnt",exo2semibold:M+"Exo2SemiBold.fnt",kelsonsans:M+"KelsonSans.fnt",monoid:M+"Monoid.fnt",mozillavr:M+"mozillavr.fnt",roboto:M+"Roboto-msdf.json",sourcecodepro:M+"SourceCodePro.fnt"},D=["roboto"],L="roboto";s.exports.FONTS=T;var I=new z,F={},R={},N=/^\w+:/;s.exports.Component=h("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:L},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:y},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=l(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(Q){var Z=this.data,ce=this.currentFont;if(R[Z.font]?this.texture=R[Z.font]:(this.texture=R[Z.font]=new f.Texture,this.texture.anisotropy=v),this.createOrUpdateMaterial(),Q.font!==Z.font){this.updateFont();return}ce&&(this.updateGeometry(this.geometry,ce),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var Q=this.data,Z,ce=this.material,Me,xe=this.shaderData,be;if(be=Q.shader,D.indexOf(Q.font)!==-1||Q.font.indexOf("-msdf.")>=0?be="msdf":Q.font in T&&D.indexOf(Q.font)===-1&&(be="sdf"),Z=(this.shaderObject&&this.shaderObject.name)!==be,xe.alphaTest=Q.alphaTest,xe.color=Q.color,xe.map=this.texture,xe.opacity=Q.opacity,xe.side=X(Q.side),xe.transparent=Q.transparent,xe.negate=Q.negate,!Z){this.shaderObject.update(xe),ce.transparent=xe.transparent,ce.side=xe.side;return}Me=U(this.el,be,xe),this.material=Me.material,this.shaderObject=Me.shader,this.material.side=xe.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var Q=this.data,Z=this.el,ce,Me=this.geometry,xe=this;Q.font||E("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),ce=this.lookupFont(Q.font||L)||Q.font,I.get(ce,function(){return $(ce,Q.yOffset)}).then(function(Fe){var Ze;if(Fe.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");F[ce]||(Fe.widthFactor=F[Fe]=k(Fe)),xe.currentFont=Fe,Ze=xe.getFontImageSrc(),I.get(Ze,function(){return te(Ze)}).then(function(ut){var it=xe.texture;it&&(it.image=ut,it.needsUpdate=!0,R[Q.font]=it,xe.texture=it,xe.initMesh(),xe.currentFont=Fe,xe.updateGeometry(Me,Fe),xe.updateLayout(),xe.mesh.visible=!0,Z.emit("textfontset",{font:Q.font,fontObj:Fe}))}).catch(function(ut){A(ut.message),A(ut.stack)})}).catch(function(be){A(be.message),A(be.stack)})},initMesh:function(){this.mesh||(this.mesh=new f.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var Q=this.lookupFont(this.data.font||L)||this.data.font,Z=this.currentFont.pages[0];return Z.match(N)&&Z.indexOf("http")!==0?Q.replace(/(\.fnt)|(\.json)/,".png"):f.LoaderUtils.extractUrlBase(Q)+Z},updateLayout:function(){var Q,Z,ce=this.el,Me=this.data,xe=this.geometry,be,Fe,Ze,ut=this.mesh,it,gt,Rt,It,Ft;if(!(!ut||!xe.layout)){if(be=ce.getAttribute("geometry"),Rt=Me.width||be&&be.width||x,it=P(Me.wrapPixels,Me.wrapCount,this.currentFont.widthFactor),gt=Rt/it,Ze=xe.layout,Fe=gt*(Ze.height+Ze.descender),be&&be.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!be.width,this.hasExplicitGeoHeight=!!be.height),this.hasExplicitGeoWidth||ce.setAttribute("geometry","width",Rt),this.hasExplicitGeoHeight||ce.setAttribute("geometry","height",Fe)),Q=Me.anchor==="align"?Me.align:Me.anchor,Q==="left")It=0;else if(Q==="right")It=-1*Ze.width;else if(Q==="center")It=-1*Ze.width/2;else throw new TypeError("Invalid text.anchor property value",Q);if(Z=Me.baseline,Z==="bottom")Ft=0;else if(Z==="top")Ft=-1*Ze.height+Ze.ascender;else if(Z==="center")Ft=-1*Ze.height/2;else throw new TypeError("Invalid text.baseline property value",Z);ut.position.x=It*gt+Me.xOffset,ut.position.y=Ft*gt,ut.position.z=Me.zOffset,ut.scale.set(gt,-1*gt,gt)}},lookupFont:function(Q){return T[Q]},updateGeometry:function(){var Q={},Z={},ce=/\\n/g,Me=/\\t/g;return function(xe,be){var Fe=this.data;Z.font=be,Z.lineHeight=Fe.lineHeight&&isFinite(Fe.lineHeight)?Fe.lineHeight:be.common.lineHeight,Z.text=Fe.value.toString().replace(ce,`
`).replace(Me,"	"),Z.width=P(Fe.wrapPixels,Fe.wrapCount,be.widthFactor),xe.update(m.extend(Q,Fe,Z))}}()});function X(Q){switch(Q){case"back":return f.FrontSide;case"double":return f.DoubleSide;default:return f.BackSide}}function $(Q,Z){return new Promise(function(ce,Me){u(Q,function(xe,be){if(xe){A("Error loading font",Q),Me(xe);return}Q.indexOf("/Roboto-msdf.json")>=0&&(Z=30),Z&&be.chars.map(function(Ze){Ze.yoffset+=Z}),ce(be)})})}function te(Q){return new Promise(function(Z,ce){new f.ImageLoader().load(Q,function(Me){Z(Me)},void 0,function(){A("Error loading font image",Q),ce(null)})})}function U(Q,Z,ce){var Me,xe;return xe=new y[Z].Shader,xe.el=Q,xe.init(ce),xe.update(ce),Me=xe.material,Me.transparent=ce.transparent,{material:Me,shader:xe}}function P(Q,Z,ce){return Q||(.5+Z)*ce}function k(Q){var Z=0,ce=0,Me=0;return Q.chars.map(function(xe){Z+=xe.xadvance,xe.id>=48&&xe.id<=57&&(Me++,ce+=xe.xadvance)}),Me?ce/Me:Z/Q.chars.length}function z(){var Q=this.cache={};this.get=function(Z,ce){return Z in Q||(Q[Z]=ce()),Q[Z]}}},"./src/components/tracked-controls-webvr.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/tracked-controls.js"),h=c("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,p=c("./src/lib/three.js"),f=c("./src/constants/index.js").DEFAULT_HANDEDNESS,m={x:.175,y:-.3,z:-.03},A={x:0,y:0,z:-.175},y={touches:[]},E={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};s.exports.Component=l("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new p.Vector3,this.controllerQuaternion=new p.Quaternion,this.controllerEuler=new p.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(x,v){var w=this.el.getObject3D("mesh");w&&w.update&&w.update(v/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return h},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var x=this.data,v=u.findMatchingControllerWebVR(this.system.controllers,x.id,x.idPrefix,x.hand,x.controller);this.controller=v,this.el.components["tracked-controls"].controller=v,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(x){var v=this.controller,w=this.controllerEuler,M=this.controllerQuaternion,T=this.deltaControllerPosition,D,L,I,F,R;L=this.getHeadElement(),I=L.object3D,R=this.defaultUserHeight(),F=v.pose,D=(v?v.hand:void 0)||f,x.copy(I.position),T.set(m.x*(D==="left"?-1:D==="right"?1:0),m.y,m.z),T.multiplyScalar(R),T.applyAxisAngle(I.up,I.rotation.y),x.add(T),T.set(A.x,A.y,A.z),T.multiplyScalar(R),F.orientation?M.fromArray(F.orientation):M.copy(I.quaternion),w.setFromQuaternion(M),w.set(w.x,w.y,0),T.applyEuler(w),x.add(T)},updatePose:function(){var x=this.controller,v=this.data,w=this.el.object3D,M,T=this.system.vrDisplay,D;x&&(M=x.pose,M.position?w.position.fromArray(M.position):v.armModel&&this.applyArmModel(w.position),M.orientation&&w.quaternion.fromArray(M.orientation),T&&M.position&&(D=this.el.sceneEl.renderer.xr.getStandingMatrix(),w.matrix.compose(w.position,w.quaternion,w.scale),w.matrix.multiplyMatrices(D,w.matrix),w.matrix.decompose(w.position,w.quaternion,w.scale)),w.rotateX(this.data.orientationOffset.x*p.MathUtils.DEG2RAD),w.rotateY(this.data.orientationOffset.y*p.MathUtils.DEG2RAD),w.rotateZ(this.data.orientationOffset.z*p.MathUtils.DEG2RAD))},updateButtons:function(){var x,v=this.controller,w;if(v){for(w=0;w<v.buttons.length;++w)this.buttonStates[w]||(this.buttonStates[w]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[w]||(this.buttonEventDetails[w]={id:w,state:this.buttonStates[w]}),x=v.buttons[w],this.handleButton(w,x);this.handleAxes()}},handleButton:function(x,v){var w;return w=this.handlePress(x,v)|this.handleTouch(x,v)|this.handleValue(x,v),w?(this.el.emit(E.BUTTONCHANGED,this.buttonEventDetails[x],!1),!0):!1},handleAxes:function(){var x=!1,v=this.controller.axes,w,M=this.axis,T=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),w=0;w<v.length;++w)T.push(M[w]!==v[w]),T[w]&&(x=!0);if(!x)return!1;for(this.axis.splice(0,this.axis.length),w=0;w<v.length;w++)this.axis.push(v[w]);return this.el.emit(E.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(x,v){var w,M=this.buttonStates[x];return v.pressed===M.pressed?!1:(w=v.pressed?E.BUTTONDOWN:E.BUTTONUP,this.el.emit(w,this.buttonEventDetails[x],!1),M.pressed=v.pressed,!0)},handleTouch:function(x,v){var w,M=this.buttonStates[x];return v.touched===M.touched?!1:(w=v.touched?E.TOUCHSTART:E.TOUCHEND,this.el.emit(w,this.buttonEventDetails[x],!1,y),M.touched=v.touched,!0)},handleValue:function(x,v){var w=this.buttonStates[x];return v.value===w.value?!1:(w.value=v.value,!0)}})},"./src/components/tracked-controls-webxr.js":(s,o,c)=>{var l=c("./src/utils/tracked-controls.js"),u=c("./src/core/component.js").registerComponent,h={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};s.exports.Component=u("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var p=this.el.sceneEl;this.updateController(),p.addEventListener("controllersupdated",this.updateController)},pause:function(){var p=this.el.sceneEl;p.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(p){return!(!this.controller||this.controller.gamepad||p.inputSource.handedness!=="none"&&p.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=l.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var p=this.el.sceneEl,f=this.controller,m=p.frame;!f||!p.frame||!this.system.referenceSpace||f.hand||(this.pose=m.getPose(f[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var p=this.el.object3D,f=this.pose;f&&(p.matrix.elements=f.transform.matrix,p.matrix.decompose(p.position,p.rotation,p.scale))},updateButtons:function(){var p,f,m=this.controller,A;if(!(!m||!m.gamepad)){for(A=m.gamepad,f=0;f<A.buttons.length;++f)this.buttonStates[f]||(this.buttonStates[f]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[f]||(this.buttonEventDetails[f]={id:f,state:this.buttonStates[f]}),p=A.buttons[f],this.handleButton(f,p);this.handleAxes()}},handleButton:function(p,f){var m;return m=this.handlePress(p,f)|this.handleTouch(p,f)|this.handleValue(p,f),m?(this.el.emit(h.BUTTONCHANGED,this.buttonEventDetails[p],!1),!0):!1},handleAxes:function(){var p=!1,f=this.controller.gamepad.axes,m,A=this.axis,y=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),m=0;m<f.length;++m)y.push(A[m]!==f[m]),y[m]&&(p=!0);if(!p)return!1;for(this.axis.splice(0,this.axis.length),m=0;m<f.length;m++)this.axis.push(f[m]);return this.el.emit(h.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(p,f){var m,A=this.buttonStates[p];return f.pressed===A.pressed?!1:(m=f.pressed?h.BUTTONDOWN:h.BUTTONUP,this.el.emit(m,this.buttonEventDetails[p],!1),A.pressed=f.pressed,!0)},handleTouch:function(p,f){var m,A=this.buttonStates[p];return f.touched===A.touched?!1:(m=f.touched?h.TOUCHSTART:h.TOUCHEND,this.el.emit(m,this.buttonEventDetails[p],!1),A.touched=f.touched,!0)},handleValue:function(p,f){var m=this.buttonStates[p];return f.value===m.value?!1:(m.value=f.value,!0)}})},"./src/components/tracked-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},update:function(){var u=this.data,h=this.el;h.sceneEl.hasWebXR?h.setAttribute("tracked-controls-webxr",{id:u.id,hand:u.hand,index:u.controller,iterateControllerProfiles:u.iterateControllerProfiles,handTrackingEnabled:u.handTrackingEnabled,space:u.space}):h.setAttribute("tracked-controls-webvr",u)}})},"./src/components/valve-index-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/lib/three.js"),p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,A=p.onButtonEvent,y=c("./src/constants/index.js").AFRAME_CDN_ROOT,E=y+"controllers/valve/index/valve-index-",x={left:E+"left.glb",right:E+"right.glb"},v="valve",w=c("./src/utils/index.js").device.isWebXRAvailable,M={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},T={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},D={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},L={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},I=w?L:D,F=w?T:M;s.exports.Component=l("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var R=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(N){A(N.detail.id,"down",R)},this.onButtonUp=function(N){A(N.detail.id,"up",R)},this.onButtonTouchEnd=function(N){A(N.detail.id,"touchend",R)},this.onButtonTouchStart=function(N){A(N.detail.id,"touchstart",R)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var R=this.data,N=R.hand==="right"?0:R.hand==="left"?1:2;f(this,v,{index:N,iterateControllerProfiles:!0,hand:R.hand})},injectTrackedControls:function(){var R=this.el,N=this.data;R.setAttribute("tracked-controls",{idPrefix:v,controller:N.hand==="right"?1:N.hand==="left"?0:2,hand:N.hand,orientationOffset:N.orientationOffset}),this.loadModel()},loadModel:function(){var R=this.data;R.model&&this.el.setAttribute("gltf-model",""+x[R.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(R){var N=this.mapping.buttons[R.detail.id],X=this.buttonMeshes,$;N&&(N==="trigger"&&($=R.detail.state.value,X&&X.trigger&&(X.trigger.rotation.x=this.triggerOriginalRotationX-$*(Math.PI/40))),this.el.emit(N+"changed",R.detail.state))},onModelLoaded:function(R){var N,X=R.detail.model,$=this;this.data.model&&(N=this.buttonMeshes={},N.grip={left:X.getObjectByName("leftgrip"),right:X.getObjectByName("rightgrip")},N.menu=X.getObjectByName("menubutton"),N.system=X.getObjectByName("systembutton"),N.trackpad=X.getObjectByName("touchpad"),N.trigger=X.getObjectByName("trigger"),this.triggerOriginalRotationX=N.trigger.rotation.x,Object.keys(N).forEach(function(te){$.setButtonColor(te,$.data.buttonColor)}),X.position.copy(F[this.data.hand]),X.rotation.copy(I[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new h.Vector3(0,0,0)}))},onAxisMoved:function(R){m(this,this.mapping.axes,R)},updateModel:function(R,N){var X,$;this.data.model&&($=N.indexOf("touch")!==-1,!$&&(X=N==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(R,X)))},setButtonColor:function(R,N){}})},"./src/components/visible.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent;s.exports.Component=l("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A=c("./src/constants/index.js").AFRAME_CDN_ROOT,y=A+"controllers/vive/vr_controller_vive.obj",E=A+"controllers/vive/vr_controller_vive.mtl",x=c("./src/utils/index.js").device.isWebXRAvailable,v="htc-vive",w="OpenVR ",M=x?v:w,T={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},D={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},L=x?D:T;s.exports.Component=l("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:L,init:function(){var I=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(F){m(F.detail.id,"down",I)},this.onButtonUp=function(F){m(F.detail.id,"up",I)},this.onButtonTouchEnd=function(F){m(F.detail.id,"touchend",I)},this.onButtonTouchStart=function(F){m(F.detail.id,"touchstart",I)},this.previousButtonValues={},this.bindMethods()},update:function(){var I=this.data;this.controllerIndex=I.hand==="right"?0:I.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var I=this.el;I.addEventListener("buttonchanged",this.onButtonChanged),I.addEventListener("buttondown",this.onButtonDown),I.addEventListener("buttonup",this.onButtonUp),I.addEventListener("touchend",this.onButtonTouchEnd),I.addEventListener("touchstart",this.onButtonTouchStart),I.addEventListener("model-loaded",this.onModelLoaded),I.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var I=this.el;I.removeEventListener("buttonchanged",this.onButtonChanged),I.removeEventListener("buttondown",this.onButtonDown),I.removeEventListener("buttonup",this.onButtonUp),I.removeEventListener("touchend",this.onButtonTouchEnd),I.removeEventListener("touchstart",this.onButtonTouchStart),I.removeEventListener("model-loaded",this.onModelLoaded),I.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var I=this.data;p(this,M,{index:this.controllerIndex,hand:I.hand})},injectTrackedControls:function(){var I=this.el,F=this.data;I.setAttribute("tracked-controls",{idPrefix:M,hand:F.hand,controller:this.controllerIndex,orientationOffset:F.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:y,mtl:E})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(I){var F=this.mapping.buttons[I.detail.id],R=this.buttonMeshes,N;F&&(F==="trigger"&&(N=I.detail.state.value,R&&R.trigger&&(R.trigger.rotation.x=-N*(Math.PI/12))),this.el.emit(F+"changed",I.detail.state))},onModelLoaded:function(I){var F,R=I.detail.model,N=this;this.data.model&&(F=this.buttonMeshes={},F.grip={left:R.getObjectByName("leftgrip"),right:R.getObjectByName("rightgrip")},F.menu=R.getObjectByName("menubutton"),F.system=R.getObjectByName("systembutton"),F.trackpad=R.getObjectByName("touchpad"),F.trigger=R.getObjectByName("trigger"),Object.keys(F).forEach(function(X){N.setButtonColor(X,N.data.buttonColor)}),R.position.set(0,-.015,.04))},onAxisMoved:function(I){f(this,this.mapping.axes,I)},updateModel:function(I,F){var R,N;this.data.model&&(N=F.indexOf("touch")!==-1,!N&&(R=F==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(I,R)))},setButtonColor:function(I,F){var R=this.buttonMeshes;if(R){if(I==="grip"){R.grip.left.material.color.set(F),R.grip.right.material.color.set(F);return}R[I].material.color.set(F)}}})},"./src/components/vive-focus-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A="HTC Vive Focus",y=c("./src/constants/index.js").AFRAME_CDN_ROOT,E=y+"controllers/vive/focus-controller/focus-controller.gltf";s.exports.Component=l("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var x=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(v){m(v.detail.id,"down",x)},this.onButtonUp=function(v){m(v.detail.id,"up",x)},this.onButtonTouchStart=function(v){m(v.detail.id,"touchstart",x)},this.onButtonTouchEnd=function(v){m(v.detail.id,"touchend",x)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var x=this.el;x.addEventListener("buttonchanged",this.onButtonChanged),x.addEventListener("buttondown",this.onButtonDown),x.addEventListener("buttonup",this.onButtonUp),x.addEventListener("touchstart",this.onButtonTouchStart),x.addEventListener("touchend",this.onButtonTouchEnd),x.addEventListener("model-loaded",this.onModelLoaded),x.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var x=this.el;x.removeEventListener("buttonchanged",this.onButtonChanged),x.removeEventListener("buttondown",this.onButtonDown),x.removeEventListener("buttonup",this.onButtonUp),x.removeEventListener("touchstart",this.onButtonTouchStart),x.removeEventListener("touchend",this.onButtonTouchEnd),x.removeEventListener("model-loaded",this.onModelLoaded),x.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){p(this,A,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var x=this.el,v=this.data;x.setAttribute("tracked-controls",{armModel:v.armModel,idPrefix:A,orientationOffset:v.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",E)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(x){var v=x.detail.model,w;this.data.model&&(w=this.buttonMeshes={},w.trigger=v.getObjectByName("BumperKey"),w.triggerPressed=v.getObjectByName("BumperKey_Press"),w.triggerPressed&&(w.triggerPressed.visible=!1),w.trackpad=v.getObjectByName("TouchPad"),w.trackpadPressed=v.getObjectByName("TouchPad_Press"),w.trackpadPressed&&(w.trackpadPressed.visible=!1))},onButtonChanged:function(x){var v=this.mapping.buttons[x.detail.id];v&&this.el.emit(v+"changed",x.detail.state)},onAxisMoved:function(x){f(this,this.mapping.axes,x)},updateModel:function(x,v){this.data.model&&this.updateButtonModel(x,v)},updateButtonModel:function(x,v){var w=this.buttonMeshes,M=x+"Pressed";if(!(!w||!w[x]||!w[M])){var T;switch(v){case"down":T=this.data.buttonHighlightColor;break;case"touchstart":T=this.data.buttonTouchedColor;break}T&&w[M].material.color.set(T),w[M].visible=!!T,w[x].visible=!T}}})},"./src/components/wasd-controls.js":(s,o,c)=>{var l=c("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,u=c("./src/core/component.js").registerComponent,h=c("./src/lib/three.js"),p=c("./src/utils/index.js"),f=p.bind,m=p.shouldCaptureKeyEvent,A=1e-5,y=.2,E=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];s.exports.Component=u("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new h.Vector3,this.onBlur=f(this.onBlur,this),this.onContextMenu=f(this.onContextMenu,this),this.onFocus=f(this.onFocus,this),this.onKeyDown=f(this.onKeyDown,this),this.onKeyUp=f(this.onKeyUp,this),this.onVisibilityChange=f(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(v,w){var M=this.data,T=this.el,D=this.velocity;!D[M.adAxis]&&!D[M.wsAxis]&&x(this.keys)||(w=w/1e3,this.updateVelocity(w),!(!D[M.adAxis]&&!D[M.wsAxis])&&T.object3D.position.add(this.getMovementVector(w)))},update:function(v){v.adAxis!==this.data.adAxis&&(this.velocity[v.adAxis]=0),v.wsAxis!==this.data.wsAxis&&(this.velocity[v.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(v){var w,M,T,D=this.data,L=this.keys,I=this.velocity,F,R;if(M=D.adAxis,F=D.wsAxis,v>y){I[M]=0,I[F]=0;return}var N=Math.pow(1/this.easing,v*60);I[M]!==0&&(I[M]=I[M]*N),I[F]!==0&&(I[F]=I[F]*N),Math.abs(I[M])<A&&(I[M]=0),Math.abs(I[F])<A&&(I[F]=0),D.enabled&&(w=D.acceleration,D.adEnabled&&(T=D.adInverted?-1:1,(L.KeyA||L.ArrowLeft)&&(I[M]-=T*w*v),(L.KeyD||L.ArrowRight)&&(I[M]+=T*w*v)),D.wsEnabled&&(R=D.wsInverted?-1:1,(L.KeyW||L.ArrowUp)&&(I[F]-=R*w*v),(L.KeyS||L.ArrowDown)&&(I[F]+=R*w*v)))},getMovementVector:function(){var v=new h.Vector3(0,0,0),w=new h.Euler(0,0,0,"YXZ");return function(M){var T=this.el.getAttribute("rotation"),D=this.velocity,L;return v.copy(D),v.multiplyScalar(M),T&&(L=this.data.fly?T.x:0,w.set(h.MathUtils.degToRad(L),h.MathUtils.degToRad(T.y),0),v.applyEuler(w)),v}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var v=Object.keys(this.keys),w=0;w<v.length;w++)delete this.keys[v[w]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(v){var w;m(v)&&(w=v.code||l[v.keyCode],E.indexOf(w)!==-1&&(this.keys[w]=!0))},onKeyUp:function(v){var w;w=v.code||l[v.keyCode],delete this.keys[w]}});function x(v){var w;for(w in v)return!1;return!0}},"./src/components/windows-motion-controls.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/utils/bind.js"),h=c("./src/utils/tracked-controls.js"),p=h.checkControllerPresentAndSetup,f=h.emitIfAxesChanged,m=h.onButtonEvent,A=c("./src/utils/index.js"),y=A.debug("components:windows-motion-controls:debug"),E=A.debug("components:windows-motion-controls:warn"),x=c("./src/constants/index.js").DEFAULT_HANDEDNESS,v=c("./src/constants/index.js").AFRAME_CDN_ROOT,w=v+"controllers/microsoft/",M={left:"left.glb",right:"right.glb",default:"universal.glb"},T=c("./src/utils/index.js").device.isWebXRAvailable,D="windows-mixed-reality",L="Spatial Controller (Spatial Interaction Source) ",I=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,F=T?D:L,R={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},N={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},X=T?N:R;s.exports.Component=l("windows-motion-controls",{schema:{hand:{default:x},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:X,bindMethods:function(){this.onModelError=u(this.onModelError,this),this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var $=this,te=this.el;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(U){m(U.detail.id,"down",$)},this.onButtonUp=function(U){m(U.detail.id,"up",$)},this.onButtonTouchStart=function(U){m(U.detail.id,"touchstart",$)},this.onButtonTouchEnd=function(U){m(U.detail.id,"touchend",$)},this.onControllerConnected=function(){$.setModelVisibility(!0)},this.onControllerDisconnected=function(){$.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},te.addEventListener("controllerconnected",this.onControllerConnected),te.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var $=this.el;$.addEventListener("buttonchanged",this.onButtonChanged),$.addEventListener("buttondown",this.onButtonDown),$.addEventListener("buttonup",this.onButtonUp),$.addEventListener("touchstart",this.onButtonTouchStart),$.addEventListener("touchend",this.onButtonTouchEnd),$.addEventListener("axismove",this.onAxisMoved),$.addEventListener("model-error",this.onModelError),$.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var $=this.el;$.removeEventListener("buttonchanged",this.onButtonChanged),$.removeEventListener("buttondown",this.onButtonDown),$.removeEventListener("buttonup",this.onButtonUp),$.removeEventListener("touchstart",this.onButtonTouchStart),$.removeEventListener("touchend",this.onButtonTouchEnd),$.removeEventListener("axismove",this.onAxisMoved),$.removeEventListener("model-error",this.onModelError),$.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){p(this,F,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var $=this.createControllerModelUrl();this.loadModel($)},createControllerModelUrl:function($){var te=this.el.components["tracked-controls"],U=te?te.controller:null,P="default",k=this.data.hand,z;if(U&&!window.hasNativeWebXRImplementation&&(k=U.hand,!$)){var Q=U.id.match(I);P=Q&&Q[0]||P}return z=M[k]||M.default,w+P+"/"+z},injectTrackedControls:function(){var $=this.data;this.el.setAttribute("tracked-controls",{idPrefix:F,controller:$.pair,hand:$.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function($){var te=this.createControllerModelUrl(!0);$.detail.src!==te?(E("Failed to load controller model for device, attempting to load default."),this.loadModel(te)):E("Failed to load default controller model.")},loadModel:function($){this.el.setAttribute("gltf-model","url("+$+")")},onModelLoaded:function($){var te=this.controllerModel=$.detail.model,U=this.loadedMeshInfo,P,k,z,Q;if(y("Processing model"),U.buttonMeshes={},U.axisMeshes={},te){for(P=0;P<this.mapping.buttons.length;P++){if(k=this.mapping.buttonMeshNames[this.mapping.buttons[P]],!k){y("Skipping unknown button at index: "+P+" with mapped name: "+this.mapping.buttons[P]);continue}if(z=te.getObjectByName(k),!z){E("Missing button mesh with name: "+k);continue}Q={index:P,value:Z(z,"VALUE"),pressed:Z(z,"PRESSED"),unpressed:Z(z,"UNPRESSED")},Q.value&&Q.pressed&&Q.unpressed?U.buttonMeshes[this.mapping.buttons[P]]=Q:E("Missing button submesh under mesh with name: "+k+"(VALUE: "+!!Q.value+", PRESSED: "+!!Q.pressed+", UNPRESSED:"+!!Q.unpressed+")")}for(P=0;P<this.mapping.axisMeshNames.length;P++){if(k=this.mapping.axisMeshNames[P],!k){y("Skipping unknown axis at index: "+P);continue}if(z=te.getObjectByName(k),!z){E("Missing axis mesh with name: "+k);continue}Q={index:P,value:Z(z,"VALUE"),min:Z(z,"MIN"),max:Z(z,"MAX")},Q.value&&Q.min&&Q.max?U.axisMeshes[P]=Q:E("Missing axis submesh under mesh with name: "+k+"(VALUE: "+!!Q.value+", MIN: "+!!Q.min+", MAX:"+!!Q.max+")")}this.calculateRayOriginFromMesh(te),this.setModelVisibility()}y("Model load complete.");function Z(ce,Me){for(var xe=0,be=ce.children.length;xe<be;xe++){var Fe=ce.children[xe];if(Fe&&Fe.name===Me)return Fe}}},calculateRayOriginFromMesh:function(){var $=new THREE.Quaternion;return function(te){var U;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,U=te.getObjectByName(this.mapping.pointingPoseMeshName),U){var P=te.parent;P&&(te.parent=null,te.updateMatrixWorld(!0),te.parent=P),U.getWorldPosition(this.rayOrigin.origin),U.getWorldQuaternion($),this.rayOrigin.direction.applyQuaternion($),P&&te.updateMatrixWorld(!0)}else y("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var $=new THREE.Quaternion;return function(te,U){var P=this.loadedMeshInfo.axisMeshes[te];if(P){var k=P.min,z=P.max,Q=P.value,Z=U*.5+.5;Q.setRotationFromQuaternion($.copy(k.quaternion).slerp(z.quaternion,Z)),Q.position.lerpVectors(k.position,z.position,Z)}}}(),lerpButtonTransform:function(){var $=new THREE.Quaternion;return function(te,U){var P=this.loadedMeshInfo.buttonMeshes[te];if(P){var k=P.unpressed,z=P.pressed,Q=P.value;Q.setRotationFromQuaternion($.copy(k.quaternion).slerp(z.quaternion,U)),Q.position.lerpVectors(k.position,z.position,U)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function($){var te=this.mapping.buttons[$.detail.id];te&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(te,$.detail.state.value),this.el.emit(te+"changed",$.detail.state))},onAxisMoved:function($){var te=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var U=0;U<te;U++)this.lerpAxisTransform(U,$.detail.axis[U]||0);f(this,this.mapping.axes,$)},setModelVisibility:function($){var te=this.el.getObject3D("mesh");this.controllerPresent&&($=$!==void 0?$:this.modelVisible,this.modelVisible=$,te&&(te.visible=$))}})},"./src/constants/index.js":(s,o,c)=>{s.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:c("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":s=>{s.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(s,o,c)=>{var l=c("./src/core/a-node.js").ANode,u=c("./src/utils/bind.js"),h=c("./src/utils/debug.js"),p=c("./src/lib/three.js"),f=new p.FileLoader,m=h("core:a-assets:warn");class A extends l{constructor(){super(),this.isAssets=!0,this.fileLoader=f,this.timeout=null}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var L=this,I,F=[],R,N,X,$,te;if(super.connectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for($=this.querySelectorAll("img"),I=0;I<$.length;I++)X=x($[I]),F.push(new Promise(function(U,P){if(p.Cache.add($[I].getAttribute("src"),X),X.complete){U();return}X.onload=U,X.onerror=P}));for(N=this.querySelectorAll("audio, video"),I=0;I<N.length;I++)R=x(N[I]),!R.src&&!R.srcObject&&m("Audio/video asset has neither `src` nor `srcObject` attributes."),F.push(E(R));Promise.allSettled(F).then(u(this.load,this)),te=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){L.hasLoaded||(m("Asset loading timed out in ",te,"ms"),L.emit("timeout"),L.load())},te)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(I){return I.isAssetItem&&I.hasAttribute("src")})}}customElements.define("a-assets",A);class y extends l{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var L=this,I=this.getAttribute("src");f.setResponseType(this.getAttribute("response-type")||M(I)),f.load(I,function(R){L.data=R,l.prototype.load.call(L)},function(R){L.emit("progress",{loadedBytes:R.loaded,totalBytes:R.total,xhr:R})},function(R){L.emit("error",{xhr:R})})}}customElements.define("a-asset-item",y);function E(D){if(!(!D.hasAttribute("autoplay")&&D.getAttribute("preload")!=="auto"))return new Promise(function(L,I){if(D.readyState===4)return L();if(D.error)return I();D.addEventListener("loadeddata",F,!1),D.addEventListener("progress",F,!1),D.addEventListener("error",I,!1);function F(){for(var R=0,N=0;N<D.buffered.length;N++)R+=D.buffered.end(N)-D.buffered.start(N);R>=D.duration&&(D.tagName==="VIDEO"&&p.Cache.add(D.getAttribute("src"),D),L())}})}function x(D){var L=v(D);return L.tagName&&L.tagName.toLowerCase()==="video"&&(L.setAttribute("playsinline",""),L.setAttribute("webkit-playsinline","")),L!==D&&(D.parentNode.appendChild(L),D.parentNode.removeChild(D)),L}function v(D){var L,I;return D.hasAttribute("crossorigin")||(I=D.getAttribute("src"),I!==null&&(I.indexOf("://")===-1||w(I)===window.location.host))?D:(m('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',I),D.crossOrigin="anonymous",L=D.cloneNode(!0),L)}function w(D){var L=D.indexOf("://")>-1?D.split("/")[2]:D.split("/")[0];return L.substring(0,L.indexOf(":"))}function M(D){var L=T(D),I=L.lastIndexOf(".");if(I>=0){var F=L.slice(I,D.search(/\?|#|$/));if(F===".glb")return"arraybuffer"}return"text"}s.exports.inferResponseType=M;function T(D){var L=document.createElement("a");L.href=D;var I=L.search.replace(/^\?/,""),F=D.replace(I,"").replace("?","");return F.substring(F.lastIndexOf("/")+1)}s.exports.getFileNameFromURL=T},"./src/core/a-cubemap.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=l("core:cubemap:warn");class h extends HTMLElement{constructor(f){return f=super(f),f}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}h.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var f=this.querySelectorAll("[src]"),m,A=[];if(f.length===6){for(m=0;m<f.length;m++)A.push(f[m].getAttribute("src"));return A}u("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",h)},"./src/core/a-entity.js":(s,o,c)=>{var l=c("./src/core/a-node.js").ANode,u=c("./src/core/component.js").components,h=c("./src/lib/three.js"),p=c("./src/utils/index.js"),f=p.debug("core:a-entity:debug"),m=p.debug("core:a-entity:warn"),A="__",y=["position","rotation","scale","visible"],E={once:!0};class x extends l{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new h.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(I,F,R){var N=this.components[I];if(super.attributeChangedCallback(),N&&N.justInitialized&&R===""){delete N.justInitialized;return}!N&&R===null||this.setEntityAttribute(I,F,R)}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}x.prototype.doConnectedCallback.call(this)}doConnectedCallback(){var I=this,F,R;if(super.connectedCallback(),R=this.sceneEl,this.addToParent(),!this.isScene){if(!R){this.load();return}if(F=R.querySelector("a-assets"),F&&!F.hasLoaded){F.addEventListener("loaded",function(){I.load()});return}this.load()}}disconnectedCallback(){var I;if(this.parentEl){for(I in this.components)this.removeComponent(I,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(I){return this.object3DMap[I]}setObject3D(I,F){var R,N=this;if(!(F instanceof h.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");R=this.getObject3D(I),R&&this.object3D.remove(R),F.el=this,F.children.length&&F.traverse(function($){$.el=N}),this.object3D.add(F),this.object3DMap[I]=F,this.emit("object3dset",{object:F,type:I})}removeObject3D(I){var F=this.getObject3D(I);if(!F){m("Tried to remove `Object3D` of type:",I,"which was not defined.");return}this.object3D.remove(F),delete this.object3DMap[I],this.emit("object3dremove",{type:I})}getOrCreateObject3D(I,F){var R=this.getObject3D(I);return!R&&F&&(R=new F,this.setObject3D(I,R)),m("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),R}add(I){if(!I.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(I.object3D),this.emit("child-attached",{el:I})}addToParent(){var I=this.parentEl=this.parentNode;!I||!I.add||this.attachedToParent||(I.add(this),this.attachedToParent=!0)}removeFromParent(){var I=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,I.emit("child-detached",{el:this})}load(){var I=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){I.parentEl&&(I.updateComponents(),(I.isScene||I.parentEl.isPlaying)&&I.play())})}remove(I){I?this.object3D.remove(I.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var I=this.children,F=[],R=0;R<I.length;R++){var N=I[R];N instanceof x&&F.push(N)}return F}initComponent(I,F,R){var N,X,$,te,U;if($=p.split(I,A),te=$[0],X=$.length>2?$.slice(1).join("__"):$[1],!!u[te]&&(U=v(this,I)||F!==void 0,!(!U&&!R)&&!(I in this.components))){if(this.initComponentDependencies(te),X&&!u[te].multiple)throw new Error("Trying to initialize multiple components of type `"+te+"`. There can only be one component of this type per entity.");N=new u[te].Component(this,F,X),this.isPlaying&&N.play(),this.hasAttribute(I)||(N.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,I,"")),f("Component initialized: %s",I)}}initComponentDependencies(I){var F=this,R=u[I],N,X;if(R&&(N=u[I].dependencies,!!N))for(X=0;X<N.length;X++)F.initComponent(N[X],window.HTMLElement.prototype.getAttribute.call(F,N[X])||void 0,!0)}removeComponent(I,F){var R;if(R=this.components[I],!!R){if(!R.initialized){this.addEventListener("componentinitialized",function N(X){X.detail.name===I&&(this.removeComponent(I,F),this.removeEventListener("componentinitialized",N))});return}R.pause(),R.remove(),F&&(R.destroy(),delete this.components[I]),this.emit("componentremoved",R.evtDetail,!1)}}updateComponents(){var I,F,R,N,X=this.componentsToUpdate;if(this.hasLoaded){for(R=0;R<this.mixinEls.length;R++)for(N in this.mixinEls[R].componentCache)T(N)&&(X[N]=!0);if(this.getExtraComponents){F=this.getExtraComponents();for(N in F)T(N)&&(X[N]=!0)}for(R=0;R<this.attributes.length;++R)N=this.attributes[R].name,y.indexOf(N)===-1&&T(N)&&(X[N]=!0);for(R=0;R<y.length;R++)N=y[R],this.hasAttribute(N)&&this.updateComponent(N,this.getDOMAttribute(N));for(N in X)I=M(this.getDOMAttribute(N),F&&F[N]),this.updateComponent(N,I),delete X[N]}}updateComponent(I,F,R){var N=this.components[I];if(N){if(F===null&&!v(this,I)){this.removeComponent(I,!0);return}N.updateProperties(F,R);return}this.initComponent(I,F,!1)}removeAttribute(I,F){var R=this.components[I];if(R&&F===void 0&&this.removeComponent(I,!0),R&&F!==void 0){R.resetProperty(F);return}I==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,I)}play(){var I,F,R;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(R in this.components)this.components[R].play();for(I=this.getChildEntities(),F=0;F<I.length;F++)I[F].play();this.emit("play")}}pause(){var I,F,R;if(this.isPlaying){this.isPlaying=!1;for(R in this.components)this.components[R].pause();for(I=this.getChildEntities(),F=0;F<I.length;F++)I[F].pause();this.emit("pause")}}setEntityAttribute(I,F,R){if(u[I]||this.components[I]){this.updateComponent(I,R);return}if(I==="mixin"){if(R===this.computedMixinStr)return;this.mixinUpdate(R,F)}}mixinUpdate(I,F){var R=x.componentsUpdated,N,X,$,te,U=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){U.mixinUpdate(I,F)},E);return}for(F=F||this.getAttribute("mixin"),$=this.updateMixins(I,F),R.length=0,te=0;te<this.mixinEls.length;te++)for(N in this.mixinEls[te].componentCache)R.indexOf(N)===-1&&(this.components[N]?this.components[N].handleMixinUpdate():this.initComponent(N,null),R.push(N));for(te=0;te<$.oldMixinIds.length;te++)if(X=document.getElementById($.oldMixinIds[te]),!!X)for(N in X.componentCache)R.indexOf(N)===-1&&this.components[N]&&(this.getDOMAttribute(N)?this.components[N].handleMixinUpdate():this.removeComponent(N,!0))}setAttribute(I,F,R){var N=x.singlePropUpdate,X,$,te,U,P,k;if(U=I.indexOf(A),te=U>0?I.substring(0,U):I,!u[te]){I==="mixin"&&this.mixinUpdate(F),super.setAttribute.call(this,I,F);return}if(!this.components[I]&&this.hasAttribute(I)&&this.updateComponent(I,window.HTMLElement.prototype.getAttribute.call(this,I)),typeof R<"u"&&typeof F=="string"&&F.length>0&&typeof p.styleParser.parse(F)=="string"){for(k in N)delete N[k];X=N,X[F]=R,$=!1}else X=F,$=R===!0;this.updateComponent(I,X,$),P=this.sceneEl&&this.sceneEl.getAttribute("debug"),P&&this.components[I].flushToDOM()}flushToDOM(I){var F=this.components,R,N=this.children,X,$;for($ in F)F[$].flushToDOM();if(I)for(X=0;X<N.length;++X)R=N[X],R.flushToDOM&&R.flushToDOM(I)}getAttribute(I){var F;return I==="position"?this.object3D.position:I==="rotation"?D(this):I==="scale"?this.object3D.scale:I==="visible"?this.object3D.visible:(F=this.components[I],F?F.data:window.HTMLElement.prototype.getAttribute.call(this,I))}getDOMAttribute(I){var F=this.components[I];return F?F.attrValue:window.HTMLElement.prototype.getAttribute.call(this,I)}addState(I){this.is(I)||(this.states.push(I),this.emit("stateadded",I))}removeState(I){var F=this.states.indexOf(I);F!==-1&&(this.states.splice(F,1),this.emit("stateremoved",I))}is(I){return this.states.indexOf(I)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var I;if(this.parentNode){m("Entity can only be destroyed if detached from scenegraph.");return}for(I in this.components)this.components[I].destroy()}}function v(L,I){return L.components[I]&&L.components[I].attrValue?!0:w(I,L.mixinEls)}function w(L,I){var F,R=!1;for(F=0;F<I.length&&(R=I[F].hasAttribute(L),!R);++F);return R}function M(L,I){return I?I.constructor===Object?p.extend(I,p.styleParser.parse(L||{})):L||I:L}function T(L){return L.indexOf(A)!==-1&&(L=p.split(L,A)[0]),!!u[L]}function D(L){var I=h.MathUtils.radToDeg,F=L.object3D.rotation,R=L.rotationObj;return R.x=I(F.x),R.y=I(F.y),R.z=I(F.z),R}x.componentsUpdated=[],x.singlePropUpdate={},customElements.define("a-entity",x),s.exports.AEntity=x},"./src/core/a-mixin.js":(s,o,c)=>{var l=c("./src/core/a-node.js").ANode,u=c("./src/core/component.js").components,h=c("./src/utils/index.js"),p="__";class f extends l{constructor(){super(),this.componentCache={},this.isMixin=!0}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){super.connectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(A,y,E){super.attributeChangedCallback(),this.cacheAttribute(A,E),this.updateEntities()}setAttribute(A,y){window.HTMLElement.prototype.setAttribute.call(this,A,y),this.cacheAttribute(A,y)}cacheAttribute(A,y){var E,x;x=h.split(A,p)[0],E=u[x],E&&(y===void 0&&(y=window.HTMLElement.prototype.getAttribute.call(this,A)),this.componentCache[A]=E.parseAttrValueForCache(y))}getAttribute(A){return this.componentCache[A]||window.HTMLElement.prototype.getAttribute.call(this,A)}cacheAttributes(){var A=this.attributes,y,E;for(E=0;E<A.length;E++)y=A[E].name,this.cacheAttribute(y)}updateEntities(){var A,y,E;if(this.sceneEl)for(y=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),E=0;E<y.length;E++)A=y[E],!(!A.hasLoaded||A.isMixin)&&A.mixinUpdate(this.id)}}customElements.define("a-mixin",f)},"./src/core/a-node.js":(s,o,c)=>{var l=c("./src/utils/index.js"),u=l.debug("core:a-node:warn"),h={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function p(m){return m.tagName.toLowerCase()in h||m.isNode}let f=(()=>{class m extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}m.prototype.doConnectedCallback.call(this)}doConnectedCallback(){var y;this.sceneEl=this.closestScene(),this.sceneEl||u("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(y=this.getAttribute("mixin"),y&&this.updateMixins(y))}attributeChangedCallback(y,E,x){x!==this.computedMixinStr&&y==="mixin"&&!this.isMixin&&this.updateMixins(x,E)}closestScene(){for(var y=this;y&&!y.isScene;)y=y.parentElement;return y}closest(y){for(var E=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,x=this;x&&!E.call(x,y);)x=x.parentElement;return x}disconnectedCallback(){this.hasLoaded=!1}load(y,E){var x,v,w=this;this.hasLoaded||(E=E||p,x=this.getChildren(),v=x.filter(E).map(function(M){return new Promise(function(D,L){if(M.hasLoaded)return D();M.addEventListener("loaded",D),M.addEventListener("error",L)})}),Promise.allSettled(v).then(function(T){T.forEach(function(L){L.status==="rejected"&&u("Rendering scene with errors on node: ",L.reason.target)}),w.hasLoaded=!0,w.setupMutationObserver(),y&&y(),w.emit("loaded",void 0,!1)}))}setupMutationObserver(){var y=this,E={attributes:!0,attributeOldValue:!0},x=new MutationObserver(function(w){var M;for(M=0;M<w.length;M++)if(w[M].type==="attributes"){var T=w[M].attributeName,D=window.HTMLElement.prototype.getAttribute.call(y,T),L=w[M].oldValue;y.attributeChangedCallback(T,L,D)}});x.observe(this,E)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(y,E){var x=m.newMixinIdArray,v=m.oldMixinIdArray,w=m.mixinIds,M,T,D;for(x.length=0,v.length=0,T=y?l.split(y.trim(),/\s+/):x,D=E?l.split(E.trim(),/\s+/):v,w.newMixinIds=T,w.oldMixinIds=D,M=0;M<D.length;M++)T.indexOf(D[M])===-1&&this.unregisterMixin(D[M]);for(this.computedMixinStr="",this.mixinEls.length=0,M=0;M<T.length;M++)this.registerMixin(document.getElementById(T[M]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),w}registerMixin(y){var E,x,v;if(y){if(v=y.getAttribute("mixin"),v)for(E=l.split(v.trim(),/\s+/),x=0;x<E.length;x++)this.registerMixin(document.getElementById(E[x]));this.computedMixinStr=this.computedMixinStr+" "+y.id,this.mixinEls.push(y)}}setAttribute(y,E){y==="mixin"&&this.updateMixins(E),window.HTMLElement.prototype.setAttribute.call(this,y,E)}unregisterMixin(y){var E,x=this.mixinEls,v;for(E=0;E<x.length;++E)if(v=x[E],y===v.id){x.splice(E,1);break}}emit(y,E,x,v){var w=m.evtData;x===void 0&&(x=!0),w.bubbles=!!x,w.detail=E,v&&(w=l.extend({},v,w)),this.dispatchEvent(new CustomEvent(y,w))}}return m.evtData={},m.newMixinIdArray=[],m.oldMixinIdArray=[],m.mixinIds={},m})();customElements.define("a-node",f),s.exports.ANode=f,s.exports.knownTags=h},"./src/core/component.js":(s,o,c)=>{var l=c("./src/core/schema.js"),u=c("./src/core/scene/scenes.js"),h=c("./src/core/system.js"),p=c("./src/utils/index.js"),f=s.exports.components={},m=l.parseProperties,A=l.parseProperty,y=l.process,E=l.isSingleProperty,x=l.stringifyProperties,v=l.stringifyProperty,w=p.styleParser,M=p.debug("core:component:warn"),T=document.currentScript,D=new RegExp("[A-Z]+"),L={},I=s.exports.Component=function(z,Q,Z){var ce=this;this.el=z,this.id=Z,this.attrName=this.name+(Z?"__"+Z:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=L[this.name];var Me=this.events;this.events={},F(this,Me),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),p.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),p.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),p.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),p.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=p.throttleLeadingAndTrailing(function(){z.emit("componentchanged",ce.evtDetail,!1)},200),this.updateProperties(Q)};I.prototype={schema:{},init:function(){},events:{},update:function(z){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(z,Q){var Z=this.schema;return this.isSingleProperty?A(z,Z):m(w.parse(z),Z,!0,this.name,Q)},stringify:function(z){var Q=this.schema;return typeof z=="string"?z:this.isSingleProperty?v(z,Q):(z=x(z,Q),w.stringify(z))},updateCachedAttrValue:function(z,Q){var Z,ce,Me;if(z!==void 0){if(z===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(z instanceof Object&&!(z instanceof window.HTMLElement)?(ce=this.objectPool.use(),Z=p.extend(ce,z)):Z=this.parseAttrValueForCache(z),this.isObjectBased&&!Q&&this.attrValue)for(Me in this.attrValue)Z[Me]===void 0&&(Z[Me]=this.attrValue[Me]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),p.objectPool.clearObject(this.attrValue),this.attrValue=X(this.attrValue,Z,this.isObjectBased),p.objectPool.clearObject(ce)}},parseAttrValueForCache:function(z){var Q;return typeof z!="string"?z:(this.isSingleProperty?(Q=this.schema.parse(z),typeof Q=="string"&&(Q=z)):(p.objectPool.clearObject(this.parsingAttrValue),Q=w.parse(z,this.parsingAttrValue)),Q)},flushToDOM:function(z){var Q=z?this.data:this.attrValue;Q!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(Q))},updateProperties:function(z,Q){var Z=this.el;if(!Z.hasLoaded){this.updateCachedAttrValue(z);return}z!==null&&(z=this.parseAttrValueForCache(z)),this.updateCachedAttrValue(z,Q),this.initialized?(this.updateComponent(z,Q),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var z=this.el,Q;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!z.initializingComponents[this.name]&&(z.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete z.initializingComponents[this.name],this.oldData=X(this.oldData,this.data,this.isObjectBased),Q=this.isObjectBased?this.objectPool.use():void 0,this.update(Q),this.isObjectBased&&this.objectPool.recycle(Q),z.isPlaying&&this.play(),z.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(z,Q){var Z,ce;if(Q){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&A(z,this.schema),this.data=z;return}if(m(z,this.schema,!0,this.name),this.schemaChangeKeys.length){for(Z in z)if(this.schema[Z].schemaChange){ce=!0;break}}if(ce){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(Z in z)z[Z]!==void 0&&(this.data[Z]=z[Z])},callUpdateHandler:function(){var z;this.previousOldData instanceof Object&&p.objectPool.clearObject(this.previousOldData),this.isObjectBased?N(this.previousOldData,this.oldData):this.previousOldData=this.oldData,z=!p.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!z)&&(this.oldData instanceof Object&&p.objectPool.clearObject(this.oldData),this.oldData=X(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(z){if(this.isObjectBased){if(!(z in this.attrValue))return;delete this.attrValue[z],this.data[z]=this.schema[z].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(z){var Q;Q=p.extend({},f[this.name].schema),p.extend(Q,z),this.schema=y(Q),this.el.emit("schemachanged",this.evtDetail)},buildData:function(z,Q,Z){var ce,Me,xe,be,Fe,Ze=this.nextData,ut=this.schema,it,gt=this.el.mixinEls,Rt;if(ce=z&&z.constructor===Array?z.length:z!=null,this.isObjectBased&&p.objectPool.clearObject(Ze),this.isSingleProperty)this.isObjectBased?Me=N(Ze,ut.default):Me=k(ut.default)?p.clone(ut.default):ut.default;else{Rt=!Q&&this.attrValue,Me=Rt instanceof Object?N(Ze,Rt):Ze;for(be in ut)xe=ut[be].default,Me[be]===void 0&&(Me[be]=k(xe)?p.clone(xe):xe)}for(it=0;it<gt.length;it++)Fe=gt[it].getAttribute(this.attrName),Fe&&(Me=X(Me,Fe,this.isObjectBased));if(ce){if(this.isSingleProperty)return P(z)?(N(this.parsingAttrValue,z),A(this.parsingAttrValue,ut)):A(z,ut);Me=X(Me,z,this.isObjectBased)}else if(this.isSingleProperty)return A(Me,ut);return m(Me,ut,void 0,this.name,Z)},eventsAttach:function(){var z;this.eventsDetach();for(z in this.events)this.el.addEventListener(z,this.events[z])},eventsDetach:function(){var z;for(z in this.events)this.el.removeEventListener(z,this.events[z])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function F(z,Q){var Z;for(Z in Q)z.events[Z]=Q[Z].bind(z)}if(window.debug)var R=s.exports.registrationOrderWarnings={};s.exports.registerComponent=function(z,Q){var Z,ce,Me={},xe,be,Fe;if(document.currentScript&&document.currentScript!==T&&u.forEach(function(ut){ut.hasLoaded||document.currentScript.compareDocumentPosition(ut)!==Node.DOCUMENT_POSITION_FOLLOWING&&(M("The component `"+z+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(R[z]=!0))}),D.test(z)===!0&&M("The component name `"+z+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+z.toLowerCase()+"`"),z.indexOf("__")!==-1)throw new Error("The component name `"+z+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(Q).forEach(function(Ze){Me[Ze]={value:Q[Ze],writable:!0}}),f[z])throw new Error("The component `"+z+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(Z=function(Ze,ut,it){I.call(this,Ze,ut,it)},Z.prototype=Object.create(I.prototype,Me),Z.prototype.name=z,Z.prototype.isPositionRotationScale=z==="position"||z==="rotation"||z==="scale",Z.prototype.constructor=Z,Z.prototype.system=h&&h.systems[z],Z.prototype.play=U(Z.prototype.play),Z.prototype.pause=te(Z.prototype.pause),xe=p.extend(y(Z.prototype.schema,Z.prototype.name)),Z.prototype.isSingleProperty=be=E(Z.prototype.schema),Z.prototype.isSinglePropertyObject=Fe=be&&P(A(void 0,xe))&&!(xe.default instanceof window.HTMLElement),Z.prototype.isObjectBased=!be||Fe,!be){Z.prototype.schemaChangeKeys=[];for(ce in xe)xe[ce].schemaChange&&Z.prototype.schemaChangeKeys.push(ce)}return L[z]=p.objectPool.createPool(),f[z]={Component:Z,dependencies:Z.prototype.dependencies,isSingleProperty:Z.prototype.isSingleProperty,isSinglePropertyObject:Z.prototype.isSinglePropertyObject,isObjectBased:Z.prototype.isObjectBased,multiple:Z.prototype.multiple,name:z,parse:Z.prototype.parse,parseAttrValueForCache:Z.prototype.parseAttrValueForCache,schema:xe,stringify:Z.prototype.stringify,type:Z.prototype.type},Z};function N(z,Q){var Z,ce;for(ce in Q)Q[ce]!==void 0&&(Z=Q[ce],z[ce]=k(Z)?p.clone(Z):Z);return z}function X(z,Q,Z){var ce;if(Z&&Q.constructor===Object){for(ce in Q)Q[ce]!==void 0&&(Q[ce]&&Q[ce].constructor===Object?z[ce]=p.clone(Q[ce]):z[ce]=Q[ce]);return z}return Q}function $(z){return z.tick||z.tock}function te(z){return function(){var Z=this.el.sceneEl;this.isPlaying&&(z.call(this),this.isPlaying=!1,this.eventsDetach(),$(this)&&Z.removeBehavior(this))}}function U(z){return function(){var Z=this.el.sceneEl,ce=this.el.isPlaying&&!this.isPlaying;!this.initialized||!ce||(z.call(this),this.isPlaying=!0,this.eventsAttach(),$(this)&&Z.addBehavior(this))}}function P(z){return z&&z.constructor===Object&&!(z instanceof window.HTMLElement)}function k(z){return z&&(z.constructor===Object||z.constructor===Array)&&!(z instanceof window.HTMLElement)}},"./src/core/geometry.js":(s,o,c)=>{var l=c("./src/core/schema.js"),u=l.process,h=s.exports.geometries={},p=s.exports.geometryNames=[],f=c("./src/lib/three.js"),m=s.exports.Geometry=function(){};m.prototype={schema:{},init:function(A){return this.geometry=new f.BufferGeometry,this.geometry},update:function(A){}},s.exports.registerGeometry=function(A,y){var E,x={};if(Object.keys(y).forEach(function(w){x[w]={value:y[w],writable:!0}}),h[A])throw new Error("The geometry `"+A+"` has been already registered");return E=function(){m.call(this)},E.prototype=Object.create(m.prototype,x),E.prototype.name=A,E.prototype.constructor=E,h[A]={Geometry:E,schema:u(E.prototype.schema)},p.push(A),E}},"./src/core/propertyTypes.js":(s,o,c)=>{var l=c("./src/utils/coordinates.js"),u=c("./node_modules/debug/browser.js"),h=u("core:propertyTypes:warn"),p=u("core:propertyTypes:warn"),f=s.exports.propertyTypes={},m=/[,> .[\]:]/,A=/\url\((.+)\)/;y("audio","",v),y("array",[],E,x),y("asset","",v),y("boolean",!1,T),y("color","#FFF",w,M),y("int",0,D),y("number",0,L),y("map","",v),y("model","",v),y("selector",null,I,R),y("selectorAll",null,F,N),y("src","",X),y("string","",w,M),y("time",0,D),y("vec2",{x:0,y:0},$,l.stringify),y("vec3",{x:0,y:0,z:0},$,l.stringify),y("vec4",{x:0,y:0,z:0,w:1},$,l.stringify);function y(P,k,z,Q){if("type"in f){h("Property type "+P+" is already registered.");return}f[P]={default:k,parse:z||w,stringify:Q||M}}s.exports.registerPropertyType=y;function E(P){if(Array.isArray(P))return P;if(!P||typeof P!="string")return[];return P.split(",").map(k);function k(z){return z.trim()}}function x(P){return P.join(", ")}function v(P){var k,z;if(typeof P!="string")return P;if(z=P.match(A),z)return z[1];if(P.charAt(0)==="#"){if(k=document.getElementById(P.substring(1)),k)return k.tagName==="CANVAS"||k.tagName==="VIDEO"||k.tagName==="IMG"?k:k.getAttribute("src");p('"'+P+'" asset not found.');return}return P}function w(P){return P}function M(P){return P===null?"null":P.toString()}function T(P){return P!=="false"&&P!==!1}function D(P){return parseInt(P,10)}function L(P){return parseFloat(P,10)}function I(P){return P?typeof P!="string"?P:P[0]==="#"&&!m.test(P)?document.getElementById(P.substring(1)):document.querySelector(P):null}function F(P){return P?typeof P!="string"?P:Array.prototype.slice.call(document.querySelectorAll(P),0):null}function R(P){return P.getAttribute?"#"+P.getAttribute("id"):M(P)}function N(P){return P instanceof Array?P.map(function(k){return"#"+k.getAttribute("id")}).join(", "):M(P)}function X(P){return p("`src` property type is deprecated. Use `asset` instead."),v(P)}function $(P){return l.parse(P,this.default)}function te(P,k){return P==="audio"&&typeof k!="string"||P==="array"&&!Array.isArray(k)||P==="asset"&&typeof k!="string"||P==="boolean"&&typeof k!="boolean"||P==="color"&&typeof k!="string"||P==="int"&&typeof k!="number"||P==="number"&&typeof k!="number"||P==="map"&&typeof k!="string"||P==="model"&&typeof k!="string"||P==="selector"&&typeof k!="string"&&k!==null||P==="selectorAll"&&typeof k!="string"&&k!==null||P==="src"&&typeof k!="string"||P==="string"&&typeof k!="string"||P==="time"&&typeof k!="number"?!1:P==="vec2"?U(k,2):P==="vec3"?U(k,3):P==="vec4"?U(k,4):!0}s.exports.isValidDefaultValue=te;function U(P,k){if(P===null)return!0;if(typeof P!="object"||Object.keys(P).length!==k)return!1;var z=P.x,Q=P.y,Z=P.z,ce=P.w;return!(typeof z!="number"||typeof Q!="number"||k>2&&typeof Z!="number"||k>3&&typeof ce!="number")}s.exports.isValidDefaultCoordinate=U},"./src/core/scene/a-scene.js":(s,o,c)=>{var l=c("./src/core/scene/metaTags.js").inject,u=c("./src/core/scene/wakelock.js"),h=c("./src/core/scene/loadingScreen.js"),p=c("./src/core/scene/scenes.js"),f=c("./src/core/system.js").systems,m=c("./src/lib/three.js"),A=c("./src/utils/index.js"),y=c("./src/core/a-entity.js").AEntity,E=c("./src/core/a-node.js").ANode,x=c("./src/core/scene/postMessage.js"),v=A.bind,w=A.device.isIOS(),M=A.device.isMobile(),T=A.device.isWebXRAvailable,D=A.debug("core:a-scene:warn");w&&c("./src/utils/ios-orientationchange-blank-bug.js");class L extends y{constructor(){var U;super(),U=this,U.clock=new m.Clock,U.isIOS=w,U.isMobile=M,U.hasWebXR=T,U.isAR=!1,U.isScene=!0,U.object3D=new m.Scene,U.object3D.onAfterRender=function(P,k,z){U.isPlaying&&U.tock(U.time,U.delta,z)},U.resize=v(U.resize,U),U.render=v(U.render,U),U.systems={},U.systemNames=[],U.time=U.delta=0,U.behaviors={tick:[],tock:[]},U.hasLoaded=!1,U.isPlaying=!1,U.originalHTML=U.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var U=this,P=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.connectedCallback(),$(this),this.setupRenderer(),h.setup(this,F),this.resize(),P||this.addFullScreenStyles(),x(this),l(this),u(this),this.onVRPresentChangeBound=v(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){U.enterVR()},this.exitVRBound=function(){U.exitVR()},this.exitVRTrueBound=function(){U.exitVR(!0)},this.pointerRestrictedBound=function(){U.pointerRestricted()},this.pointerUnrestrictedBound=function(){U.pointerUnrestricted()},U.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){U.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){U.enterVR()})}attachedCallbackPostCamera(){var U,P=this;window.addEventListener("load",U),window.addEventListener("resize",function(){P.isIOS?setTimeout(P.resize,100):P.resize()}),this.play(),p.push(this)}initSystems(){var U;this.initSystem("camera");for(U in f)U!=="camera"&&this.initSystem(U)}initSystem(U){this.systems[U]||(this.systems[U]=new f[U](this),this.systemNames.push(U))}disconnectedCallback(){var U=p.indexOf(this);super.disconnectedCallback(),p.splice(U,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(U){var P,k=this.behaviors,z;for(z in k)U[z]&&(P=this.behaviors[z],P.indexOf(U)===-1&&P.push(U))}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return A.device.checkHeadsetConnected()}enterAR(){var U;if(!this.hasWebXR)throw U="Failed to enter AR mode, WebXR not supported.",new Error(U);if(!A.device.checkARSupport())throw U="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(U);return this.enterVR(!0)}enterVR(U){var P=this,k,z=P.renderer.xr,Q;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var Z=P.getAttribute("renderer");if(z.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var ce=this.sceneEl.systems.webxr.sessionReferenceSpaceType;z.setReferenceSpaceType(ce);var Me=U?"immersive-ar":"immersive-vr";return Q=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Ze,ut){navigator.xr.requestSession(Me,Q).then(function(gt){P.xrSession=gt,z.layersEnabled=Q.requiredFeatures.indexOf("layers")!==-1,z.setSession(gt).then(function(){z.setFoveation(Z.foveationLevel)}),P.systems.renderer.setWebXRFrameRate(gt),gt.addEventListener("end",P.exitVRBound),be(Ze)},function(gt){var Rt=Me==="immersive-ar",It=Rt?"AR":"VR";ut(new Error("Failed to enter "+It+" mode (`requestSession`)",{cause:gt}))})})}else{if(k=A.device.getVRDisplay(),z.setDevice(k),k.isPresenting&&!window.hasNativeWebVRImplementation)return be(),Promise.resolve();var xe={highRefreshRate:Z.highRefreshRate};return k.requestPresent([{source:this.canvas,attributes:xe}]).then(be,Fe)}}return be(),Promise.resolve();function be(Ze){var ut;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(ut=new CustomEvent("vrdisplaypresentchange",{detail:{display:A.device.getVRDisplay()}}),window.dispatchEvent(ut)),U?P.addState("ar-mode"):P.addState("vr-mode"),P.emit("enter-vr",{target:P}),!P.hasWebXR&&P.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),P.addFullScreenStyles(),!P.isMobile&&!P.checkHeadsetConnected()&&N(P.canvas),P.resize(),Ze&&Ze()}function Fe(Ze){throw P.removeState("vr-mode"),Ze&&Ze.message?new Error("Failed to enter VR mode (`requestPresent`): "+Ze.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var U=this,P,k=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(k.enabled=!1,P=A.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(P.isPresenting)return P.exitPresent().then(z,Q)}else X();return z(),Promise.resolve();function z(){U.removeState("vr-mode"),U.removeState("ar-mode"),U.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),U.hasAttribute("embedded")&&U.removeFullScreenStyles(),U.resize(),U.isIOS&&A.forceCanvasResizeSafariMobile(U.canvas),U.renderer.setPixelRatio(window.devicePixelRatio),U.emit("exit-vr",{target:U})}function Q(Z){throw Z&&Z.message?new Error("Failed to exit VR mode (`exitPresent`): "+Z.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var U=this.getPointerLockElement();U&&U!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var U=this.getPointerLockElement();U&&U===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(U){var P=U.display||U.detail.display;if(P&&P.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(U){var P=this.systems[U];return P?P.data:y.prototype.getAttribute.call(this,U)}getComputedAttribut(U){D("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(U)}getDOMAttribute(U){var P=this.systems[U];return P?P.data:y.prototype.getDOMAttribute.call(this,U)}setAttribute(U,P,k){var z=this.systems[U];if(z){E.prototype.setAttribute.call(this,U,P),z.updateProperties(P);return}y.prototype.setAttribute.call(this,U,P,k)}removeBehavior(U){var P,k,z=this.behaviors,Q;for(k in z)U[k]&&(P=this.behaviors[k],Q=P.indexOf(U),Q!==-1&&P.splice(Q,1))}resize(){var U=this.camera,P=this.canvas,k,z,Q,Z=this.renderer.xr.isPresenting;z=this.renderer.xr.enabled&&Z,!(!U||!P||this.is("vr-mode")&&(this.isMobile||z))&&(k=this.getAttribute("embedded")&&!this.is("vr-mode"),Q=F(P,k,this.maxCanvasSize,this.is("vr-mode")),U.aspect=Q.width/Q.height,U.updateProjectionMatrix(),this.renderer.setSize(Q.width,Q.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var U=this,P,k,z,Q;Q={alpha:!0,antialias:!M,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(z=this.getAttribute("renderer"),k=A.styleParser.parse(z),k.precision&&(Q.precision=k.precision+"p"),k.antialias&&k.antialias!=="auto"&&(Q.antialias=k.antialias==="true"),k.logarithmicDepthBuffer&&k.logarithmicDepthBuffer!=="auto"&&(Q.logarithmicDepthBuffer=k.logarithmicDepthBuffer==="true"),k.alpha&&(Q.alpha=k.alpha==="true"),k.multiviewStereo&&(Q.multiviewStereo=k.multiviewStereo==="true"),this.maxCanvasSize={width:k.maxCanvasWidth?parseInt(k.maxCanvasWidth):this.maxCanvasSize.width,height:k.maxCanvasHeight?parseInt(k.maxCanvasHeight):this.maxCanvasSize.height}),P=this.renderer=new m.WebGLRenderer(Q),P.setPixelRatio(window.devicePixelRatio),this.camera&&P.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){P.xr.setPoseTarget(U.camera.el.object3D)})}play(){var U=this,P=this;if(this.renderStarted){y.prototype.play.call(this);return}this.addEventListener("loaded",function(){var k=this.renderer,z,Q=this.renderer.xr;y.prototype.play.call(this),!P.renderStarted&&(P.resize(),P.renderer&&(window.performance&&window.performance.mark("render-started"),h.remove(),z=A.device.getVRDisplay(),z&&z.isPresenting&&(Q.setDevice(z),Q.enabled=!0,P.enterVR()),k.setAnimationLoop(this.render),P.renderStarted=!0,P.emit("renderstart")))}),setTimeout(function(){y.prototype.load.call(U)})}updateComponent(U){U in f||y.prototype.updateComponent.apply(this,arguments)}tick(U,P){var k,z=this.systems;for(k=0;k<this.behaviors.tick.length;k++)this.behaviors.tick[k].el.isPlaying&&this.behaviors.tick[k].tick(U,P);for(k=0;k<this.systemNames.length;k++)z[this.systemNames[k]].tick&&z[this.systemNames[k]].tick(U,P)}tock(U,P,k){var z,Q=this.systems;for(z=0;z<this.behaviors.tock.length;z++)this.behaviors.tock[z].el.isPlaying&&this.behaviors.tock[z].tock(U,P,k);for(z=0;z<this.systemNames.length;z++)Q[this.systemNames[z]].tock&&Q[this.systemNames[z]].tock(U,P,k)}render(U,P){var k=this.renderer;this.frame=P,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var z=null;this.is("ar-mode")&&(z=this.object3D.background,this.object3D.background=null),k.render(this.object3D,this.camera),z&&(this.object3D.background=z)}}function I(te,U){var P,k=window.devicePixelRatio;return!U||U.width===-1&&U.height===-1||te.width*k<U.width&&te.height*k<U.height||(P=te.width/te.height,te.width*k>U.width&&U.width!==-1&&(te.width=Math.round(U.width/k),te.height=Math.round(U.width/P/k)),te.height*k>U.height&&U.height!==-1&&(te.height=Math.round(U.height/k),te.width=Math.round(U.height*P/k))),te}window.customElements.define("a-scene",L);function F(te,U,P,k){if(!te.parentElement)return{height:0,width:0};if(U){var z;return z={height:te.parentElement.offsetHeight,width:te.parentElement.offsetWidth},I(z,P)}return R(P,k)}function R(te,U){var P;return P={height:document.body.offsetHeight,width:document.body.offsetWidth},U?P:I(P,te)}function N(te){var U=te.requestFullscreen||te.webkitRequestFullscreen||te.mozRequestFullScreen||te.msRequestFullscreen;U.apply(te,[{navigationUI:"hide"}])}function X(){var te=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;te&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function $(te){var U;U=document.createElement("canvas"),U.classList.add("a-canvas"),U.dataset.aframeCanvas=!0,te.appendChild(U),document.addEventListener("fullscreenchange",P),document.addEventListener("mozfullscreenchange",P),document.addEventListener("webkitfullscreenchange",P),document.addEventListener("MSFullscreenChange",P),U.addEventListener("touchmove",function(k){k.preventDefault()}),te.canvas=U,te.emit("render-target-loaded",{target:U}),setTimeout(v(te.resize,te),0);function P(){var k=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;k||te.exitVR(),document.activeElement.blur(),document.body.focus()}}s.exports.setupCanvas=$,s.exports.AScene=L},"./src/core/scene/loadingScreen.js":(s,o,c)=>{var l=c("./src/utils/index.js"),u=l.styleParser,h,p,f,m="loading-screen",A="a-loader-title";s.exports.setup=function(v,w){h=v,f=w;var M=h.hasAttribute(m)?u.parse(h.getAttribute(m)):void 0,T=M&&M.dotsColor||"white",D=M&&M.backgroundColor||"#24CAFF",L=M===void 0||M.enabled==="true"||M.enabled===void 0,I,F,R,N,X,$,te,U,P,k;L&&(I=new THREE.Scene,F=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),R=new THREE.MeshBasicMaterial({color:T}),N=new THREE.Mesh(F,R),X=N.clone(),$=N.clone(),te=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),U=new THREE.Clock,P=0,k=function(){h.renderer.render(I,te),P=U.getElapsedTime()%4,N.visible=P>=1,X.visible=P>=2,$.visible=P>=3},I.background=new THREE.Color(D),I.add(te),N.position.set(-1,0,-15),X.position.set(0,0,-15),$.position.set(1,0,-15),te.add(N),te.add(X),te.add($),E(),setTimeout(function(){h.hasLoaded||(y(te),p.style.display="block",window.addEventListener("resize",function(){y(te)}),h.renderer.setAnimationLoop(k))},200))},s.exports.remove=function(){window.removeEventListener("resize",y),p&&(p.style.display="none")};function y(x){var v=h.hasAttribute("embedded"),w=f(h.canvas,v,h.maxCanvasSize,h.is("vr-mode"));x.aspect=w.width/w.height,x.updateProjectionMatrix(),h.renderer.setSize(w.width,w.height,!1)}function E(){p=document.createElement("div"),p.className=A,p.innerHTML=document.title,p.style.display="none",h.appendChild(p)}},"./src/core/scene/metaTags.js":(s,o,c)=>{var l=c("./src/constants/index.js"),u=c("./src/utils/index.js").extend,h=s.exports.MOBILE_HEAD_TAGS=[f({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),f({name:"mobile-web-app-capable",content:"yes"}),f({name:"theme-color",content:"black"})],p=[f({name:"apple-mobile-web-app-capable",content:"yes"}),f({name:"apple-mobile-web-app-status-bar-style",content:"black"}),m({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function f(y){return{tagName:"meta",attributes:y,exists:function(){return document.querySelector('meta[name="'+y.name+'"]')}}}function m(y){return{tagName:"link",attributes:y,exists:function(){return document.querySelector('link[rel="'+y.rel+'"]')}}}s.exports.inject=function(E){var x=document.head,v=x.querySelector("script"),w,M=[];return h.forEach(T),E.isIOS&&p.forEach(T),M;function T(D){!D||D.exists()||(w=A(D),w&&(v?v.parentNode.insertBefore(w,v):x.appendChild(w),M.push(w)))}};function A(y){if(!(!y||!y.tagName)){var E=document.createElement(y.tagName);return E.setAttribute(l.AFRAME_INJECTED,""),u(E,y.attributes)}}},"./src/core/scene/postMessage.js":(s,o,c)=>{var l=c("./src/utils/bind.js"),u=c("./src/utils/index.js").isIframed;s.exports=function(f){u()&&window.addEventListener("message",l(h,f))};function h(p){var f=this;if(p.data)switch(p.data.type){case"vr":switch(p.data.data){case"enter":f.enterVR();break;case"exit":f.exitVR();break}}}},"./src/core/scene/scenes.js":s=>{s.exports=[]},"./src/core/scene/wakelock.js":(s,o,c)=>{var l=c("./vendor/wakelock/wakelock.js");s.exports=function(h){if(h.isMobile){var p=h.wakelock=new l;h.addEventListener("enter-vr",function(){p.request()}),h.addEventListener("exit-vr",function(){p.release()})}}},"./src/core/schema.js":(s,o,c)=>{var l=c("./src/utils/index.js"),u=c("./src/core/propertyTypes.js"),h=l.debug,p=u.isValidDefaultValue,f=u.propertyTypes,m=h("core:schema:warn");function A(v){return"type"in v?typeof v.type=="string":"default"in v}s.exports.isSingleProperty=A,s.exports.process=function(v,w){var M;if(A(v))return y(v,w);for(M in v)v[M]=y(v[M],w);return v};function y(v,w){var M=v.default,T,D,L=v.type;return v.type?v.type==="bool"?L="boolean":v.type==="float"&&(L="number"):M!==void 0&&(typeof M=="boolean"||typeof M=="number")?L=typeof M:Array.isArray(M)?L="array":L="string",D=f[L],D||m("Unknown property type for component `"+w+"`: "+L),T=!!v.parse,v.parse=v.parse||D.parse,v.stringify=v.stringify||D.stringify,v.type=L,"default"in v?!T&&!p(L,M)&&m("Default value `"+M+"` does not match type `"+L+"` in component `"+w+"`"):v.default=D.default,v}s.exports.processPropertyDefinition=y,s.exports.parseProperties=function(){var v=[];return function(w,M,T,D,L){var I,F,R,N;v.length=0;for(F in T?w:M)T&&w[F]===void 0||v.push(F);if(w===null||typeof w!="object")return w;for(F in w)w[F]!==void 0&&!M[F]&&!L&&m("Unknown property `"+F+"` for component/system `"+D+"`.");for(I=0;I<v.length;I++){if(F=v[I],R=M[F],N=w[F],!M[F])return;w[F]=E(N,R)}return w}}();function E(v,w){return(v==null||v==="")&&(v=w.default,Array.isArray(v)&&(v=v.slice())),w.parse(v,w.default)}s.exports.parseProperty=E,s.exports.stringifyProperties=function(v,w){var M,T,D,L={},I;for(M in v)T=w[M],D=v[M],I=D,typeof I=="object"&&(I=x(D,T),T||m("Unknown component property: "+M)),L[M]=I;return L};function x(v,w){return typeof v!="object"?v:!w||v===null?JSON.stringify(v):w.stringify(v)}s.exports.stringifyProperty=x},"./src/core/shader.js":(s,o,c)=>{var l=c("./src/core/schema.js"),u=l.process,h=s.exports.shaders={},p=s.exports.shaderNames=[],f=c("./src/lib/three.js"),m=c("./src/utils/index.js"),A={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},y=s.exports.Shader=function(){};y.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(E){return this.attributes=this.initVariables(E,"attribute"),this.uniforms=this.initVariables(E,"uniform"),this.material=new(this.raw?f.RawShaderMaterial:f.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw?f.GLSL3:void 0,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(E,x){var v,w=this.schema,M={},T;for(v in w)w[v].is===x&&(T=A[w[v].type],M[v]={type:T,value:void 0});return M},update:function(E){this.updateVariables(E,"attribute"),this.updateVariables(E,"uniform")},updateVariables:function(E,x){var v,w,M=this.schema,T;T=x==="uniform"?this.uniforms:this.attributes;for(v in E)if(!(!M[v]||M[v].is!==x)){if(M[v].type==="map"){if(!T[v]||T[v].value===E[v])continue;w="_texture_"+v,this.setMapOnTextureLoad(T,v,w),m.material.updateMapMaterialFromData(w,v,this,E);continue}T[v].value=this.parseValue(M[v].type,E[v]),T[v].needsUpdate=!0}},parseValue:function(E,x){var v;switch(E){case"vec2":return new f.Vector2(x.x,x.y);case"vec3":return new f.Vector3(x.x,x.y,x.z);case"vec4":return new f.Vector4(x.x,x.y,x.z,x.w);case"color":return v=new f.Color(x),new f.Vector3(v.r,v.g,v.b);case"map":return f.ImageUtils.loadTexture(x);default:return x}},setMapOnTextureLoad:function(E,x,v){var w=this;this.el.addEventListener("materialtextureloaded",function(){E[x].value=w.material[v],E[x].needsUpdate=!0})}},s.exports.registerShader=function(E,x){var v,w={};if(Object.keys(x).forEach(function(M){w[M]={value:x[M],writable:!0}}),h[E])throw new Error("The shader "+E+" has been already registered");return v=function(){y.call(this)},v.prototype=Object.create(y.prototype,w),v.prototype.name=E,v.prototype.constructor=v,h[E]={Shader:v,schema:u(v.prototype.schema)},p.push(E),v}},"./src/core/system.js":(s,o,c)=>{var l=c("./src/core/component.js"),u=c("./src/core/schema.js"),h=c("./src/utils/index.js"),p=u.parseProperties,f=u.parseProperty,m=u.process,A=u.isSingleProperty,y=h.styleParser,E=s.exports.systems={},x=s.exports.System=function(v){var w=l&&l.components[this.name];this.el=v,this.sceneEl=v,w&&(w.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};x.prototype={schema:{},init:function(){},update:function(v){},updateProperties:function(v){var w=this.data;Object.keys(u).length&&(this.buildData(v),this.update(w))},buildData:function(v){var w=this.schema;Object.keys(w).length&&(v=v||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),A(w)?this.data=f(v,w):this.data=p(y.parse(v)||{},w))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},s.exports.registerSystem=function(v,w){var M,T,D={},L=h.findAllScenes(document);if(Object.keys(w).forEach(function(I){D[I]={value:w[I],writable:!0}}),E[v])throw new Error("The system `"+v+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(T=function(I){x.call(this,I)},T.prototype=Object.create(x.prototype,D),T.prototype.name=v,T.prototype.constructor=T,T.prototype.schema=h.extend(m(T.prototype.schema)),E[v]=T,M=0;M<L.length;M++)L[M].initSystem(v)}},"./src/extras/components/index.js":(s,o,c)=>{c("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(s,o,c)=>{var l=c("./src/core/component.js").registerComponent,u=c("./src/lib/three.js"),h=new u.Vector3,p=new u.Vector3;l("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var f=this.data,m=this.el,A=m.object3D.parent,y=m.object3D,E=new u.Group;h.copy(y.position),p.copy(y.rotation),A.remove(y),E.add(y),A.add(E),m.object3D=E,y.position.set(-1*f.x,-1*f.y,-1*f.z),E.position.set(f.x+h.x,f.y+h.y,f.z+h.z),E.rotation.copy(y.rotation),y.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(s,o,c)=>{var l=c("./src/core/component.js").components,u=c("./src/core/shader.js").shaders,h=c("./src/utils/index.js"),p={};Object.keys(l.material.schema).forEach(f),Object.keys(u.standard.schema).forEach(f);function f(m){var A=m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();m==="fog"&&(A="material-fog"),m==="visible"&&(A="material-visible"),p[A]="material."+m}s.exports=function(){return{defaultComponents:{material:{}},mappings:h.extend({},p)}}},"./src/extras/primitives/index.js":(s,o,c)=>{c("./src/extras/primitives/primitives/a-camera.js"),c("./src/extras/primitives/primitives/a-cursor.js"),c("./src/extras/primitives/primitives/a-curvedimage.js"),c("./src/extras/primitives/primitives/a-gltf-model.js"),c("./src/extras/primitives/primitives/a-image.js"),c("./src/extras/primitives/primitives/a-light.js"),c("./src/extras/primitives/primitives/a-link.js"),c("./src/extras/primitives/primitives/a-obj-model.js"),c("./src/extras/primitives/primitives/a-sky.js"),c("./src/extras/primitives/primitives/a-sound.js"),c("./src/extras/primitives/primitives/a-text.js"),c("./src/extras/primitives/primitives/a-video.js"),c("./src/extras/primitives/primitives/a-videosphere.js"),c("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(s,o,c)=>{var l=c("./src/core/a-node.js").knownTags,u=c("./src/core/a-entity.js").AEntity,h=c("./src/core/component.js").components,p=c("./src/utils/index.js"),f=p.debug,m=p.entity.setComponentProperty,A=f("extras:primitives:debug"),y=f("extras:primitives:warn"),E=f("extras:primitives:error"),x=s.exports.primitives={};s.exports.registerPrimitive=function(T,D){if(T=T.toLowerCase(),l[T]){E("Trying to register primitive "+T+" that has been already previously registered");return}l[T]=!0,A("Registering <%s>",T),D.defaultAttributes&&y("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var L=D.mappings||{},I=class extends u{constructor(){super(),this.defaultComponentsFromPrimitive=D.defaultComponents||D.defaultAttributes||{},this.deprecated=D.deprecated||null,this.deprecatedMappings=D.deprecatedMappings||{},this.mappings=L,D.deprecated&&console.warn(D.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var F=this.mappings,R=this;Object.keys(F).forEach(function(X){var $;X!==X.toLowerCase()&&y("Mapping keys should be specified in lower case. The mapping key "+X+" may not be recognized"),h[X]&&($=F[X].replace(".","-"),F[$]=F[X],delete F[X],console.warn("The primitive "+R.tagName.toLowerCase()+" has a mapping collision. The attribute "+X+" has the same name as a registered component and has been renamed to "+$))})}getExtraComponents(){var F,R,N,X,$,te,U=this;for(R=p.clone(this.defaultComponentsFromPrimitive),$=this.getAttribute("mixin"),$&&($=$.trim().split(" "),$.forEach(function(ce){var Me=U.sceneEl.querySelector("#"+ce).componentCache;Object.keys(Me).forEach(function(be){R[be]=P(R[be],Me[be])})})),N=0;N<this.attributes.length;N++)if(F=this.attributes[N],X=this.mappings[F.name],X){te=p.entity.getComponentPropertyPath(X),te.constructor===Array?(R[te[0]]=R[te[0]]||{},R[te[0]][te[1]]=F.value.trim()):R[te]=F.value.trim();continue}return R;function P(Z,ce){return k(Z)?z(ce):k(ce)?z(Z):Q(Z)&&Q(ce)?p.extendDeep(Z,ce):z(ce)}function k(Z){return typeof Z>"u"}function z(Z){return Q(Z)?p.extendDeep({},Z):Z}function Q(Z){return Z!==null&&Z.constructor===Object}}attributeChangedCallback(F,R,N){var X=this.mappings[F];if(F in this.deprecatedMappings&&console.warn(this.deprecatedMappings[F]),!F||!X){super.attributeChangedCallback(F,R,N);return}m(this,X,N)}};return customElements.define(T,I),I.mappings=L,x[T]=I,I};function v(M,T){var D=h[M].schema;Object.keys(D).map(function(L){var I=L.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();T[I]!==void 0&&(I=M+"-"+L),T[I]=M+"."+L})}function w(M,T,D){D=D||{},Object.keys(T).map(function(I){v(I,D)}),s.exports.registerPrimitive(M,p.extendDeep({},null,{defaultComponents:T,mappings:D}))}s.exports.definePrimitive=w},"./src/extras/primitives/primitives/a-camera.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").registerPrimitive;l("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-cursor",h.extendDeep({},l(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-curvedimage",h.extendDeep({},l(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").registerPrimitive;l("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-image",h.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").registerPrimitive;l("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").registerPrimitive;l("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js")(),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-obj-model",h.extendDeep({},l,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js"),p=c("./src/extras/primitives/primitives/meshPrimitives.js");u("a-sky",h.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:h.extendDeep({},p["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").registerPrimitive;l("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(s,o,c)=>{var l=c("./src/extras/primitives/primitives.js").definePrimitive;l("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-video",h.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/extras/primitives/primitives.js").registerPrimitive,h=c("./src/utils/index.js");u("a-videosphere",h.extendDeep({},l(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(s,o,c)=>{var l=c("./src/extras/primitives/getMeshMixin.js"),u=c("./src/core/geometry.js").geometries,h=c("./src/core/geometry.js").geometryNames,p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js"),m=s.exports={};h.forEach(function(E){var x=u[E],v=A(E),w={};Object.keys(x.schema).forEach(function(L){w[A(L)]="geometry."+L});var M="a-"+v,T=p(M,f.extendDeep({},l(),{defaultComponents:{geometry:{primitive:E}},mappings:w}));m[M]=T});function A(y){return y.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new u.BoxGeometry(h.width,h.height,h.depth,h.segmentsWidth,h.segmentsHeight,h.segmentsDepth)}})},"./src/geometries/circle.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(p){this.geometry=new u.CircleGeometry(p.radius,p.segments,h(p.thetaStart),h(p.thetaLength))}})},"./src/geometries/cone.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(p){this.geometry=new u.CylinderGeometry(p.radiusTop,p.radiusBottom,p.height,p.segmentsRadial,p.segmentsHeight,p.openEnded,h(p.thetaStart),h(p.thetaLength))}})},"./src/geometries/cylinder.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(p){this.geometry=new u.CylinderGeometry(p.radius,p.radius,p.height,p.segmentsRadial,p.segmentsHeight,p.openEnded,h(p.thetaStart),h(p.thetaLength))}})},"./src/geometries/dodecahedron.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.DodecahedronGeometry(h.radius,h.detail)}})},"./src/geometries/icosahedron.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.IcosahedronGeometry(h.radius,h.detail)}})},"./src/geometries/index.js":(s,o,c)=>{c("./src/geometries/box.js"),c("./src/geometries/circle.js"),c("./src/geometries/cone.js"),c("./src/geometries/cylinder.js"),c("./src/geometries/dodecahedron.js"),c("./src/geometries/icosahedron.js"),c("./src/geometries/octahedron.js"),c("./src/geometries/plane.js"),c("./src/geometries/ring.js"),c("./src/geometries/sphere.js"),c("./src/geometries/tetrahedron.js"),c("./src/geometries/torus.js"),c("./src/geometries/torusKnot.js"),c("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.OctahedronGeometry(h.radius,h.detail)}})},"./src/geometries/plane.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new u.PlaneGeometry(h.width,h.height,h.segmentsWidth,h.segmentsHeight)}})},"./src/geometries/ring.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(p){this.geometry=new u.RingGeometry(p.radiusInner,p.radiusOuter,p.segmentsTheta,p.segmentsPhi,h(p.thetaStart),h(p.thetaLength))}})},"./src/geometries/sphere.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(p){this.geometry=new u.SphereGeometry(p.radius,p.segmentsWidth,p.segmentsHeight,h(p.phiStart),h(p.phiLength),h(p.thetaStart),h(p.thetaLength))}})},"./src/geometries/tetrahedron.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.TetrahedronGeometry(h.radius,h.detail)}})},"./src/geometries/torus.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=u.MathUtils.degToRad;l("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(p){this.geometry=new u.TorusGeometry(p.radius,p.radiusTubular*2,p.segmentsRadial,p.segmentsTubular,h(p.arc))}})},"./src/geometries/torusKnot.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js");l("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(h){this.geometry=new u.TorusKnotGeometry(h.radius,h.radiusTubular*2,h.segmentsTubular,h.segmentsRadial,h.p,h.q)}})},"./src/geometries/triangle.js":(s,o,c)=>{var l=c("./src/core/geometry.js").registerGeometry,u=c("./src/lib/three.js"),h=new u.Quaternion,p=new u.Vector3(0,0,1),f=new u.Vector2,m=new u.Vector2,A=new u.Vector2;l("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(y){var E,x,v,w,M,T,D,L,I;v=new u.Triangle,v.a.set(y.vertexA.x,y.vertexA.y,y.vertexA.z),v.b.set(y.vertexB.x,y.vertexB.y,y.vertexB.z),v.c.set(y.vertexC.x,y.vertexC.y,y.vertexC.z),x=v.getNormal(new u.Vector3),h.setFromUnitVectors(x,p),w=v.a.clone().applyQuaternion(h),M=v.b.clone().applyQuaternion(h),T=v.c.clone().applyQuaternion(h),f.set(Math.min(w.x,M.x,T.x),Math.min(w.y,M.y,T.y)),m.set(Math.max(w.x,M.x,T.x),Math.max(w.y,M.y,T.y)),A.set(0,0).subVectors(m,f),w=new u.Vector2().subVectors(w,f).divide(A),M=new u.Vector2().subVectors(M,f).divide(A),T=new u.Vector2().subVectors(T,f).divide(A),E=this.geometry=new u.BufferGeometry,D=[v.a.x,v.a.y,v.a.z,v.b.x,v.b.y,v.b.z,v.c.x,v.c.y,v.c.z],L=[x.x,x.y,x.z,x.x,x.y,x.z,x.x,x.y,x.z],I=[w.x,w.y,M.x,M.y,T.x,T.y],E.setAttribute("position",new u.Float32BufferAttribute(D,3)),E.setAttribute("normal",new u.Float32BufferAttribute(L,3)),E.setAttribute("uv",new u.Float32BufferAttribute(I,2))}})},"./src/index.js":(s,o,c)=>{if(window.Promise=window.Promise||c("./node_modules/promise-polyfill/Promise.js"),c("./node_modules/@ungap/custom-elements/index.js"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var l=c("./src/utils/isIOSOlderThan10.js"),u=l(window.navigator.userAgent)?1/window.devicePixelRatio:1,h=c("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),p={BUFFER_SCALE:u,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new h(p)}var f=c("./src/utils/index.js"),m=f.debug;f.isIE11&&(c("./node_modules/custom-event-polyfill/polyfill.js"),c("./vendor/starts-with-polyfill.js"));var A=m("A-Frame:error"),y=m("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&y("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&A("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),c("./node_modules/present/lib/present-browser.js"),f.device.isBrowserEnvironment&&(c("./src/style/aframe.css"),c("./src/style/rStats.css"));var E=c("./src/core/scene/a-scene.js").AScene,x=c("./src/core/component.js").components,v=c("./src/core/component.js").registerComponent,w=c("./src/core/geometry.js").registerGeometry,M=c("./src/extras/primitives/primitives.js").registerPrimitive,T=c("./src/core/shader.js").registerShader,D=c("./src/core/system.js").registerSystem,L=c("./src/core/shader.js").shaders,I=c("./src/core/system.js").systems,F=window.THREE=c("./src/lib/three.js"),R=c("./package.json");c("./src/components/index.js"),c("./src/geometries/index.js"),c("./src/shaders/index.js"),c("./src/systems/index.js");var N=c("./src/core/a-node.js").ANode,X=c("./src/core/a-entity.js").AEntity;c("./src/core/a-assets.js"),c("./src/core/a-cubemap.js"),c("./src/core/a-mixin.js"),c("./src/extras/components/index.js"),c("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.5.0 (Date 2023-11-14, Commit #7856a058)"),console.log("THREE Version (https://github.com/supermedium/three.js):",R.dependencies["super-three"]),console.log("WebVR Polyfill Version:",R.dependencies["webvr-polyfill"]),s.exports=window.AFRAME={AComponent:c("./src/core/component.js").Component,AEntity:X,ANode:N,ANIME:c("./node_modules/super-animejs/lib/anime.es.js").default,AScene:E,components:x,coreComponents:Object.keys(x),geometries:c("./src/core/geometry.js").geometries,registerComponent:v,registerGeometry:w,registerPrimitive:M,registerShader:T,registerSystem:D,primitives:{getMeshMixin:c("./src/extras/primitives/getMeshMixin.js"),primitives:c("./src/extras/primitives/primitives.js").primitives},scenes:c("./src/core/scene/scenes.js"),schema:c("./src/core/schema.js"),shaders:L,systems:I,THREE:F,utils:f,version:R.version}},"./src/lib/rStatsAframe.js":s=>{window.aframeStats=function(o){var c=null,l=o,u={te:{caption:"Entities"},lt:{caption:"Load Time"}},h=[{caption:"A-Frame",values:["te","lt"]}];function p(){c("te").set(f()),window.performance.getEntriesByName&&c("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function f(){var E=l.querySelectorAll("*");return Array.prototype.slice.call(E).filter(function(x){return x.isEntity}),E.length}function m(){}function A(){}function y(E){c=E}return{update:p,start:m,end:A,attach:y,values:u,groups:h,fractions:[]}},s.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(s,o,c)=>{var l=c("./src/lib/three.module.js").default;l.TextureLoader&&(l.TextureLoader.prototype.crossOrigin="anonymous"),l.ImageLoader&&(l.ImageLoader.prototype.crossOrigin="anonymous"),l.Cache&&(l.Cache.enabled=!0),l.DRACOLoader.prototype.crossOrigin="anonymous",l.GLTFLoader.prototype.crossOrigin="anonymous",l.KTX2Loader.prototype.crossOrigin="anonymous",l.MTLLoader.prototype.crossOrigin="anonymous",l.OBJLoader.prototype.crossOrigin="anonymous",s.exports=l},"./src/lib/three.module.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>w});var l=c("./node_modules/super-three/build/three.module.js"),u=c("./node_modules/super-three/examples/jsm/loaders/DRACOLoader.js"),h=c("./node_modules/super-three/examples/jsm/loaders/GLTFLoader.js"),p=c("./node_modules/super-three/examples/jsm/loaders/KTX2Loader.js"),f=c("./node_modules/super-three/examples/jsm/math/OBB.js"),m=c("./node_modules/super-three/examples/jsm/loaders/OBJLoader.js"),A=c("./node_modules/super-three/examples/jsm/loaders/MTLLoader.js"),y=c("./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js"),E=c("./node_modules/super-three/examples/jsm/lights/LightProbeGenerator.js"),x=c("./node_modules/object-assign/index.js"),v=window.THREE=x({},l);c("./vendor/DeviceOrientationControls.js"),v.DRACOLoader=u.DRACOLoader,v.GLTFLoader=h.GLTFLoader,v.KTX2Loader=p.KTX2Loader,v.OBJLoader=m.OBJLoader,v.MTLLoader=A.MTLLoader,v.OBB=f.OBB,v.BufferGeometryUtils=y,v.LightProbeGenerator=E.LightProbeGenerator;let w=v},"./src/shaders/flat.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=c("./src/lib/three.js"),h=c("./src/utils/index.js");s.exports.Shader=l("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(f){this.materialData={color:new u.Color},this.textureSrc=null,p(f,this.materialData),this.material=new u.MeshBasicMaterial(this.materialData)},update:function(f){this.updateMaterial(f),h.material.updateMap(this,f)},updateMaterial:function(f){var m;p(f,this.materialData);for(m in this.materialData)this.material[m]=this.materialData[m]}});function p(f,m){return m.color.set(f.color),m.fog=f.fog,m.wireframe=f.wireframe,m.toneMapped=f.toneMapped,m.wireframeLinewidth=f.wireframeLinewidth,m}},"./src/shaders/index.js":(s,o,c)=>{c("./src/shaders/flat.js"),c("./src/shaders/standard.js"),c("./src/shaders/phong.js"),c("./src/shaders/sdf.js"),c("./src/shaders/msdf.js"),c("./src/shaders/ios10hls.js"),c("./src/shaders/shadow.js")},"./src/shaders/ios10hls.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader;s.exports.Shader=l("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},"./src/shaders/msdf.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=["in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),h=["precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`);s.exports.Shader=l("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:u,fragmentShader:h})},"./src/shaders/phong.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=new u.CubeTextureLoader,f={};s.exports.Shader=l("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(A){this.materialData={color:new u.Color,specular:new u.Color,emissive:new u.Color},this.textureSrc=null,m(A,this.materialData),this.material=new u.MeshPhongMaterial(this.materialData),h.material.updateMap(this,A)},update:function(A){this.updateMaterial(A),h.material.updateMap(this,A),A.normalMap&&h.material.updateDistortionMap("normal",this,A),A.displacementMap&&h.material.updateDistortionMap("displacement",this,A),A.ambientOcclusionMap&&h.material.updateDistortionMap("ambientOcclusion",this,A),A.bump&&h.material.updateDistortionMap("bump",this,A),this.updateEnvMap(A)},updateMaterial:function(A){var y;m(A,this.materialData);for(y in this.materialData)this.material[y]=this.materialData[y]},updateEnvMap:function(A){var y=this,E=this.material,x=A.envMap,v=A.sphericalEnvMap,w=A.refract,M=this.el.sceneEl;if(!x&&!v||this.isLoadingEnvMap){Object.defineProperty(E,"envMap",{get:function(){return M.object3D.environment},set:function(T){delete this.envMap,this.envMap=T}}),E.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,delete E.envMap,v){this.el.sceneEl.systems.material.loadTexture(v,{src:v},function(D){y.isLoadingEnvMap=!1,D.mapping=w?u.EquirectangularRefractionMapping:u.EquirectangularReflectionMapping,E.envMap=D,h.material.handleTextureEvents(y.el,D),E.needsUpdate=!0});return}if(f[x]){f[x].then(function(T){y.isLoadingEnvMap=!1,E.envMap=T,h.material.handleTextureEvents(y.el,T),E.needsUpdate=!0});return}f[x]=new Promise(function(T){h.srcLoader.validateCubemapSrc(x,function(L){p.load(L,function(I){y.isLoadingEnvMap=!1,E.envMap=I,I.mapping=w?u.CubeRefractionMapping:u.CubeReflectionMapping,h.material.handleTextureEvents(y.el,I),T(I)})})})}});function m(A,y){switch(y.color.set(A.color),y.specular.set(A.specular),y.emissive.set(A.emissive),y.emissiveIntensity=A.emissiveIntensity,y.fog=A.fog,y.transparent=A.transparent,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,y.shininess=A.shininess,y.flatShading=A.flatShading,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,y.reflectivity=A.reflectivity,y.refractionRatio=A.refractionRatio,A.combine){case"mix":y.combine=u.MixOperation;break;case"multiply":y.combine=u.MultiplyOperation;break;case"add":y.combine=u.AddOperation;break}return A.normalMap&&(y.normalScale=A.normalScale),A.ambientOcclusionMap&&(y.aoMapIntensity=A.ambientOcclusionMapIntensity),A.bumpMap&&(y.aoMapIntensity=A.bumpMapScale),A.displacementMap&&(y.displacementScale=A.displacementScale,y.displacementBias=A.displacementBias),y}},"./src/shaders/sdf.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=["in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),h=["precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`);s.exports.Shader=l("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:u,fragmentShader:h})},"./src/shaders/shadow.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=c("./src/lib/three.js");s.exports.Shader=l("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(h){this.material=new u.ShadowMaterial},update:function(h){this.material.opacity=h.opacity,this.material.alphaToCoverage=h.alphaToCoverage,this.material.transparent=h.transparent}})},"./src/shaders/standard.js":(s,o,c)=>{var l=c("./src/core/shader.js").registerShader,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=new u.CubeTextureLoader,f={};s.exports.Shader=l("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(A){this.materialData={color:new u.Color,emissive:new u.Color},m(A,this.materialData),this.material=new u.MeshStandardMaterial(this.materialData)},update:function(A){this.updateMaterial(A),h.material.updateMap(this,A),A.normalMap&&h.material.updateDistortionMap("normal",this,A),A.displacementMap&&h.material.updateDistortionMap("displacement",this,A),A.ambientOcclusionMap&&h.material.updateDistortionMap("ambientOcclusion",this,A),A.metalnessMap&&h.material.updateDistortionMap("metalness",this,A),A.roughnessMap&&h.material.updateDistortionMap("roughness",this,A),this.updateEnvMap(A)},updateMaterial:function(A){var y,E=this.material;m(A,this.materialData);for(y in this.materialData)E[y]=this.materialData[y]},updateEnvMap:function(A){var y=this,E=this.material,x=A.envMap,v=A.sphericalEnvMap;if(!x&&!v||this.isLoadingEnvMap){E.envMap=null,E.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,v){this.el.sceneEl.systems.material.loadTexture(v,{src:v},function(M){y.isLoadingEnvMap=!1,M.mapping=u.EquirectangularReflectionMapping,E.envMap=M,h.material.handleTextureEvents(y.el,M),E.needsUpdate=!0});return}if(f[x]){f[x].then(function(w){y.isLoadingEnvMap=!1,E.envMap=w,h.material.handleTextureEvents(y.el,w),E.needsUpdate=!0});return}f[x]=new Promise(function(w){h.srcLoader.validateCubemapSrc(x,function(T){p.load(T,function(D){y.isLoadingEnvMap=!1,E.envMap=D,h.material.handleTextureEvents(y.el,D),w(D)})})})}});function m(A,y){return y.color.set(A.color),y.emissive.set(A.emissive),y.emissiveIntensity=A.emissiveIntensity,y.fog=A.fog,y.metalness=A.metalness,y.roughness=A.roughness,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,A.normalMap&&(y.normalScale=A.normalScale),A.ambientOcclusionMap&&(y.aoMapIntensity=A.ambientOcclusionMapIntensity),A.displacementMap&&(y.displacementScale=A.displacementScale,y.displacementBias=A.displacementBias),y}},"./src/systems/camera.js":(s,o,c)=>{var l=c("./src/constants/index.js"),u=c("./src/core/system.js").registerSystem,h="data-aframe-default-camera";s.exports.System=u("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var f,m,A=this.sceneEl,y=this;if(A.camera&&!A.camera.el.getAttribute("camera").spectator){A.emit("cameraready",{cameraEl:A.camera.el});return}if(f=A.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!f.length){this.createDefaultCamera();return}for(this.numUserCameras=f.length,m=0;m<f.length;m++)f[m].addEventListener("object3dset",function(E){E.detail.type==="camera"&&y.checkUserCamera(this)}),f[m].isNode?f[m].load():f[m].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(f){var m,A=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(m=f.getAttribute("camera"),!m.active||m.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,A.camera=f.getObject3D("camera"),A.emit("cameraready",{cameraEl:f})}},createDefaultCamera:function(){var f,m=this.sceneEl;f=document.createElement("a-entity"),f.setAttribute("camera",{active:!0}),f.setAttribute("position",{x:0,y:l.DEFAULT_CAMERA_HEIGHT,z:0}),f.setAttribute("wasd-controls",""),f.setAttribute("look-controls",""),f.setAttribute(l.AFRAME_INJECTED,""),f.addEventListener("object3dset",function(A){A.detail.type==="camera"&&(m.camera=A.detail.object,m.emit("cameraready",{cameraEl:f}))}),m.appendChild(f)},disableActiveCamera:function(){var f,m;f=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),m=f[f.length-1],m.setAttribute("camera","active",!0)},setActiveCamera:function(f){var m,A,y,E,x=this.activeCameraEl,v=this.sceneEl;if(E=f.getObject3D("camera"),!(!E||f===this.activeCameraEl)){var w=v.querySelector("["+h+"]"),M=w&&w.querySelector(":not(a-mixin)[camera]");for(f!==M&&p(v),this.activeCameraEl=f,this.activeCameraEl.play(),v.camera=E,x&&x.setAttribute("camera","active",!1),A=v.querySelectorAll(":not(a-mixin)[camera]"),y=0;y<A.length;y++)m=A[y],!(!m.isEntity||f===m)&&(m.setAttribute("camera","active",!1),m.pause());v.emit("camera-set-active",{cameraEl:f})}},setSpectatorCamera:function(f){var m,A=this.spectatorCameraEl,y=this.sceneEl,E;m=f.getObject3D("camera"),!(!m||f===this.spectatorCameraEl)&&(A&&A.setAttribute("camera","spectator",!1),E=this.spectatorCameraEl=f,y.addEventListener("enter-vr",this.wrapRender),y.addEventListener("exit-vr",this.unwrapRender),E.setAttribute("camera","active",!1),E.play(),y.emit("camera-set-spectator",{cameraEl:f}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(f,m){var A,y=this.sceneEl,E;A=y.renderer.xr.enabled,this.originalRender.call(y.renderer,f,m),!(!this.spectatorCameraEl||y.isMobile||!A)&&(E=this.spectatorCameraEl.components.camera.camera,y.renderer.xr.enabled=!1,this.originalRender.call(y.renderer,f,E),y.renderer.xr.enabled=A)}});function p(f){var m,A=f.camera;A&&(m=f.querySelector("["+h+"]"),m&&f.removeChild(m))}},"./src/systems/geometry.js":(s,o,c)=>{var l=c("./src/core/geometry.js").geometries,u=c("./src/core/system.js").registerSystem;s.exports.System=u("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(m){var A=this.cache,y,E;return m.skipCache?h(m):(E=this.hash(m),y=A[E],f(this.cacheCount,E),y||(y=h(m),A[E]=y,y))},unuseGeometry:function(m){var A=this.cache,y=this.cacheCount,E,x;m.skipCache||(x=this.hash(m),A[x]&&(p(y,x),!(y[x]>0)&&(E=A[x],E.dispose(),delete A[x],delete y[x])))},hash:function(m){return JSON.stringify(m)}});function h(m){var A=m.primitive,y=l[A]&&l[A].Geometry,E=new y;if(!y)throw new Error("Unknown geometry `"+A+"`");return E.init(m),E.geometry}function p(m,A){m[A]--}function f(m,A){m[A]=m[A]===void 0?1:m[A]+1}},"./src/systems/gltf-model.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/lib/three.js");function h(p){return new Promise(function(f,m){var A=document.createElement("script");document.body.appendChild(A),A.onload=f,A.onerror=m,A.async=!0,A.src=p})}s.exports.System=l("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var p=this.data.dracoDecoderPath,f=this.data.basisTranscoderPath,m=this.data.meshoptDecoderPath;!this.dracoLoader&&p&&(this.dracoLoader=new u.DRACOLoader,this.dracoLoader.setDecoderPath(p)),!this.ktx2Loader&&f&&(this.ktx2Loader=new u.KTX2Loader,this.ktx2Loader.setTranscoderPath(f).detectSupport(this.el.renderer)),!this.meshoptDecoder&&m&&(this.meshoptDecoder=h(m).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(s,o,c)=>{c("./src/systems/camera.js"),c("./src/systems/geometry.js"),c("./src/systems/gltf-model.js"),c("./src/systems/light.js"),c("./src/systems/material.js"),c("./src/systems/obb-collider.js"),c("./src/systems/renderer.js"),c("./src/systems/shadow.js"),c("./src/systems/tracked-controls-webvr.js"),c("./src/systems/tracked-controls-webxr.js"),c("./src/systems/webxr.js")},"./src/systems/light.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/utils/bind.js"),h=c("./src/constants/index.js"),p="data-aframe-default-light";s.exports.System=l("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",u(this.setupDefaultLights,this))},registerLight:function(f){f.hasAttribute(p)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var f,m=this.sceneEl;if(this.defaultLights){f=document.querySelectorAll("["+p+"]");for(var A=0;A<f.length;A++)m.removeChild(f[A]);this.defaultLights=!1}},setupDefaultLights:function(){var f=this.sceneEl,m,A;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(m=document.createElement("a-entity"),m.setAttribute("light",{color:"#BBB",type:"ambient"}),m.setAttribute(p,""),m.setAttribute(h.AFRAME_INJECTED,""),f.appendChild(m),A=document.createElement("a-entity"),A.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),A.setAttribute("position",{x:-.5,y:1,z:1}),A.setAttribute(p,""),A.setAttribute(h.AFRAME_INJECTED,""),f.appendChild(A),this.defaultLights=!0)}})},"./src/systems/material.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/lib/three.js"),h=c("./src/utils/index.js"),p=c("./src/utils/material.js").isHLS,f=c("./src/utils/material.js").setTextureProperties,m=h.bind,A=h.debug,y=A("components:texture:error"),E=new u.TextureLoader,x=A("components:texture:warn");E.setCrossOrigin("anonymous"),s.exports.System=l("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",m(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(D,L,I){var F=this;if(D.tagName==="CANVAS"){this.loadCanvas(D,L,I);return}if(D.tagName==="VIDEO"){!D.src&&!D.srcObject&&!D.childElementCount&&x("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(D,L,I);return}h.srcLoader.validateSrc(D,R,N);function R(X){F.loadImage(X,L,I)}function N(X){F.loadVideo(X,L,I)}},loadImage:function(D,L,I){var F=this.hash(L),R=this.textureCache;if(R[F]){R[F].then(I);return}R[F]=w(D,L),R[F].then(I)},loadCanvas:function(D,L,I){var F;F=new u.CanvasTexture(D),f(F,L),I(F)},loadVideo:function(D,L,I){var F,R,N=this.textureCache,X,$;function te(U){U.texture.needsUpdate=!0,I(U.texture,U.videoEl)}if(typeof D!="string"){if(X=D,F=this.hashVideo(L,X),N[F]){N[F].then(te);return}T(X)}if(X=X||M(D,L.width,L.height),F=this.hashVideo(L,X),N[F]){N[F].then(te);return}R=new u.VideoTexture(X),R.minFilter=u.LinearFilter,f(R,L),this.sceneEl.isIOS&&p(X.src||X.getAttribute("src"),X.type||X.getAttribute("type"))&&(R.format=u.RGBAFormat,R.needsCorrectionBGRA=!0,R.flipY=!1,R.needsCorrectionFlipY=!0),$={texture:R,videoEl:X},N[F]=Promise.resolve($),te($)},hash:function(D){return D.src.tagName&&(D=h.extendDeep({},D),D.src=D.src.src),JSON.stringify(D)},hashVideo:function(D,L){return v(D,L)},registerMaterial:function(D){this.materials[D.uuid]=D},unregisterMaterial:function(D){delete this.materials[D.uuid];var L=this.textureCounts;Object.keys(D).filter(function(I){return D[I]&&D[I].isTexture}).forEach(function(I){L[D[I].uuid]--,L[D[I].uuid]<=0&&D[I].dispose()})},updateMaterials:function(D){var L=this.materials;Object.keys(L).forEach(function(I){L[I].needsUpdate=!0})},onMaterialTextureLoaded:function(D){this.textureCounts[D.detail.texture.uuid]||(this.textureCounts[D.detail.texture.uuid]=0),this.textureCounts[D.detail.texture.uuid]++}});function v(D,L){var I,F=L.getAttribute("id"),R,N;if(F)return F;for(R="",N=D||{},I=0;I<L.attributes.length;I++)N[L.attributes[I].name]=L.attributes[I].value;return Object.keys(N).sort().forEach(function(X){R+=X+":"+N[X]+";"}),R}function w(D,L){return new Promise(I);function I(F,R){var N=typeof D!="string";function X($){f($,L),$.needsUpdate=!0,F($)}if(N){X(new u.Texture(D));return}E.load(D,X,function(){},function($){y("`$s` could not be fetched (Error code: %s; Response: %s)",$.status,$.statusText)})}}function M(D,L,I){var F=document.createElement("video");return F.width=L,F.height=I,F.setAttribute("playsinline",""),F.setAttribute("webkit-playsinline",""),F.autoplay=!0,F.loop=!0,F.crossOrigin="anonymous",F.addEventListener("error",function(){x("`$s` is not a valid video",D)},!0),F.src=D,F}function T(D){return D.autoplay=D.hasAttribute("autoplay")&&D.getAttribute("autoplay")!=="false",D.controls=D.hasAttribute("controls")&&D.getAttribute("controls")!=="false",D.getAttribute("loop")==="false"&&D.removeAttribute("loop"),D.getAttribute("preload")==="false"&&(D.preload="none"),D.crossOrigin=D.crossOrigin||"anonymous",D.setAttribute("playsinline",""),D.setAttribute("webkit-playsinline",""),D}},"./src/systems/obb-collider.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem;l("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(u){this.colliderEls.push(u),this.data.showColliders?u.components["obb-collider"].showCollider():u.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(u){var h=this.colliderEls,p=h.indexOf(u);u.hideCollider(),p>-1&&h.splice(p,1),h.length===0&&(this.tick=void 0)},registerCollision:function(u,h){var p=this.collisions,f=!1,m=u.obb,A=h.obb,y=u.renderColliderMesh,E=h.renderColliderMesh;y&&y.material.color.set(16711680),E&&E.material.color.set(16711680);for(var x=0;x<p.length;x++)if(p[x].componentA.obb===m&&p[x].componentB.obb===A||p[x].componentA.obb===A&&p[x].componentB.obb===m){f=!0,p[x].detected=!0;break}f||(p.push({componentA:u,componentB:h,detected:!0}),u.el.emit("obbcollisionstarted",{trackedObject3D:u.trackedObject3D,withEl:h.el}),h.el.emit("obbcollisionstarted",{trackedObject3D:h.trackedObject3D,withEl:u.el}))},resetCollisions:function(){for(var u=this.collisions,h=0;h<u.length;h++)u[h].detected=!1},clearCollisions:function(){for(var u=this.collisions,h=[],p,f,m,A,y=0;y<u.length;y++)u[y].detected?h.push(u[y]):(p=u[y].componentA,f=u[y].componentB,m=p.renderColliderMesh,A=f.renderColliderMesh,m&&m.material.color.set(65280),p.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:f.el}),A&&A.material.color.set(65280),f.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:p.el}));this.collisions=h},detectCollisions:function(){var u,h,p,f,m=this.colliderEls;if(!(m.length<2)){this.resetCollisions();for(var A=0;A<m.length;A++)if(p=m[A].components["obb-collider"],u=m[A].components["obb-collider"].obb,!(u.halfSize.x===0||u.halfSize.y===0||u.halfSize.z===0))for(var y=A+1;y<m.length;y++)f=m[y].components["obb-collider"],h=f.obb,!(h.halfSize.x===0||h.halfSize.y===0||h.halfSize.z===0)&&u.intersectsOBB(h)&&this.registerCollision(p,f);this.clearCollisions()}}})},"./src/systems/renderer.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/utils/index.js"),h=c("./src/lib/three.js"),p=u.debug,f=p("components:renderer:warn");s.exports.System=l("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:u.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},foveationLevel:{default:1}},init:function(){var E=this.data,x=this.el,v=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),w=x.renderer;w.useLegacyLights=!E.physicallyCorrectLights,w.toneMapping=h[v+"ToneMapping"],h.Texture.DEFAULT_ANISOTROPY=E.anisotropy,h.ColorManagement.enabled=E.colorManagement,w.outputColorSpace=E.colorManagement?h.SRGBColorSpace:h.LinearSRGBColorSpace,x.hasAttribute("antialias")&&f('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),x.hasAttribute("logarithmicDepthBuffer")&&f('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),w.sortObjects=!0,w.setOpaqueSort(m)},update:function(){var E=this.data,x=this.el,v=x.renderer,w=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);v.toneMapping=h[w+"ToneMapping"],v.toneMappingExposure=E.exposure,v.xr.setFoveation(E.foveationLevel),E.sortObjects&&f('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),E.sortTransparentObjects?v.setTransparentSort(y):v.setTransparentSort(A)},applyColorCorrection:function(E){!this.data.colorManagement||!E||E.isTexture&&(E.colorSpace=h.SRGBColorSpace)},setWebXRFrameRate:function(E){var x=this.data,v=E.supportedFrameRates;if(v&&E.updateTargetFrameRate){var w;v.includes(90)?w=x.highRefreshRate?90:72:w=x.highRefreshRate?72:60,E.updateTargetFrameRate(w).catch(function(M){console.warn("failed to set target frame rate of "+w+". Error info: "+M)})}}});function m(E,x){return E.groupOrder!==x.groupOrder?E.groupOrder-x.groupOrder:E.renderOrder!==x.renderOrder?E.renderOrder-x.renderOrder:E.z-x.z}function A(E,x){return E.groupOrder!==x.groupOrder?E.groupOrder-x.groupOrder:E.renderOrder-x.renderOrder}function y(E,x){return E.groupOrder!==x.groupOrder?E.groupOrder-x.groupOrder:E.renderOrder!==x.renderOrder?E.renderOrder-x.renderOrder:x.z-E.z}s.exports.sortFrontToBack=m,s.exports.sortRenderOrderOnly=A,s.exports.sortBackToFront=y},"./src/systems/shadow.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/lib/three.js"),h={basic:u.BasicShadowMap,pcf:u.PCFShadowMap,pcfsoft:u.PCFSoftShadowMap};s.exports.System=l("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var p=this.sceneEl,f=this.data;this.shadowMapEnabled=!1,p.renderer&&(p.renderer.shadowMap.type=h[f.type],p.renderer.shadowMap.autoUpdate=f.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(p){p.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(p){var f=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&p,f&&(f.shadowMap.enabled=this.shadowMapEnabled)}})},"./src/systems/tracked-controls-webvr.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/utils/index.js"),h=u.device.isWebXRAvailable;s.exports.System=l("tracked-controls-webvr",{init:function(){var p=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),!h&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(f){f.length&&(p.vrDisplay=f[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var p=this.controllers,f,m,A,y;if(m=navigator.getGamepads&&navigator.getGamepads(),!!m){for(y=p.length,p.length=0,A=0;A<m.length;++A)f=m[A],f&&f.pose&&p.push(f);p.length!==y&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/utils/index.js");s.exports.System=l("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var h=this,p=this.el.xrSession;if(!p){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var f=h.el.sceneEl.systems.webxr.sessionReferenceSpaceType;p.requestReferenceSpace(f).then(function(m){h.referenceSpace=m}).catch(function(m){throw h.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(f,'tracked-controls-webxr uses reference space "'+f+'".'),m})},updateControllerList:function(){var h=this.el.xrSession,p=this.oldControllers,f;if(!h){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(h.inputSources){if(this.controllers=h.inputSources,this.oldControllersLength===this.controllers.length){var m=!0;for(f=0;f<this.controllers.length;++f)if(!(this.controllers[f]===p[f]&&this.controllers[f].gamepad===p[f].gamepad)){m=!1;break}if(m)return}for(p.length=0,f=0;f<this.controllers.length;f++)p.push(this.controllers[f]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(s,o,c)=>{var l=c("./src/core/system.js").registerSystem,u=c("./src/utils/index.js"),h=u.debug("systems:webxr:warn");s.exports.System=l("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var p=this.data;this.sessionConfiguration={requiredFeatures:p.requiredFeatures,optionalFeatures:p.optionalFeatures},this.sessionReferenceSpaceType=p.referenceSpaceType,p.overlayElement&&(p.overlayElement.classList.remove("a-dom-overlay"),p.optionalFeatures.includes("dom-overlay")||(p.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",p)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:p.overlayElement},p.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(p){return!!(p==="viewer"||p==="local"||this.sessionConfiguration.requiredFeatures.includes(p)||this.sessionConfiguration.optionalFeatures.includes(p))},warnIfFeatureNotRequested:function(p,f){if(!this.wasFeatureRequested(p)){var m='Please add the feature "'+p+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;h((f?f+" ":"")+m)}}})},"./src/utils/bind.js":s=>{s.exports=function(c,l){return function(u){return function(){var p=u.concat(Array.prototype.slice.call(arguments,0));return c.apply(l,p)}}(Array.prototype.slice.call(arguments,2))}},"./src/utils/coordinates.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=c("./node_modules/object-assign/index.js"),h=l("utils:coordinates:warn"),p=["x","y","z","w"],f=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;s.exports.regex=f;var m=/\s+/g;function A(v,w){var M,T,D,L,I,F,R,N,X;if(v&&v instanceof Object)return F=v.x===void 0?w&&w.x:v.x,R=v.y===void 0?w&&w.y:v.y,N=v.z===void 0?w&&w.z:v.z,X=v.w===void 0?w&&w.w:v.w,F!=null&&(v.x=x(F)),R!=null&&(v.y=x(R)),N!=null&&(v.z=x(N)),X!=null&&(v.w=x(X)),v;if(v==null)return typeof w=="object"?u({},w):w;for(M=v.trim().split(m),I={},L=0;L<p.length;L++)if(D=p[L],M[L])I[D]=parseFloat(M[L],10);else{if(T=w&&w[D],T===void 0)continue;I[D]=x(T)}return I}s.exports.parse=A;function y(v){var w;return typeof v!="object"?v:(w=v.x+" "+v.y,v.z!=null&&(w+=" "+v.z),v.w!=null&&(w+=" "+v.w),w)}s.exports.stringify=y;function E(v){return f.test(v)}s.exports.isCoordinates=E,s.exports.isCoordinate=function(v){return h("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),E(v)};function x(v){return v!=null&&v.constructor===String?parseFloat(v,10):v}s.exports.toVector3=function(v){return new THREE.Vector3(v.x,v.y,v.z)}},"./src/utils/debug.js":(s,o,c)=>{var l=c("./node_modules/process/browser.js"),u=c("./node_modules/debug/browser.js"),h=c("./node_modules/object-assign/index.js"),p={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},f=function(x){var v=u(x);return v.color=A(x),v};h(f,u);function m(x){var v=x.split(":");return v[v.length-1]}function A(x){var v=m(x),w=p.colors&&p.colors[v];return w||null}function y(){try{return window.localStorage}catch{}}var E=y();E&&(parseInt(E.logs,10)||E.logs==="true")?f.enable("*"):f.enable("*:error,*:info,*:warn"),l.browser&&(window.logs=f),s.exports=f},"./src/utils/device.js":(s,o,c)=>{var l=c("./node_modules/process/browser.js"),u=c("./node_modules/debug/browser.js")("device:error"),h,p=!1,f=!1,m=s.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(X){var $;m||($=document.createElement("canvas"),h=X.display,$.getContext("webgl",{}),h.requestPresent([{source:$}]).then(function(){},function(){}))}),m){var A=function(){var X=document.querySelector("a-scene");if(!X){window.addEventListener("DOMContentLoaded",A);return}X.hasLoaded?X.components["xr-mode-ui"].updateEnterInterfaces():X.addEventListener("loaded",A)},y=function(X){u("WebXR session support error: "+X.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(X){p=X,A()}).catch(y),navigator.xr.isSessionSupported("immersive-ar").then(function(X){f=X,A()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){p=!0,A()}).catch(y),navigator.xr.supportsSession("immersive-ar").then(function(){f=!0,A()}).catch(function(){})):u("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(X){var $=document.querySelector("a-scene");h=X.length&&X[0],$&&$.emit("displayconnected",{vrDisplay:h})});function E(){return h}s.exports.getVRDisplay=E;function x(){return p||f||!!E()}s.exports.checkHeadsetConnected=x;function v(){return f}s.exports.checkARSupport=v;function w(){return p}s.exports.checkVRSupport=w;var M=function(){var X=!1;return function($){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test($)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test($.substr(0,4)))&&(X=!0),(D()||T()||N())&&(X=!0),R()&&(X=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return X}}();s.exports.isMobile=M;function T(X){var $=X||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test($)}s.exports.isTablet=T;function D(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}s.exports.isIOS=D;function L(){return!M()&&!R()&&window.orientation!==void 0}s.exports.isMobileDeviceRequestingDesktopSite=L;function I(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}s.exports.isOculusBrowser=I;function F(){return/(Mobile VR)/i.test(window.navigator.userAgent)}s.exports.isFirefoxReality=F;function R(){return I()||F()}s.exports.isMobileVR=R;function N(){return/R7 Build/.test(window.navigator.userAgent)}s.exports.isR7=N,s.exports.isLandscape=function(){var X=window.orientation;return N()&&(X+=90),X===90||X===-90},s.exports.isBrowserEnvironment=!!(!l||l.browser),s.exports.isNodeEnvironment=!s.exports.isBrowserEnvironment},"./src/utils/entity.js":s=>{var o={};function c(l,u){return u=u||".",o[u]||(o[u]={}),l.indexOf(u)!==-1?o[u][l]=l.split(u):o[u][l]=l,o[u][l]}s.exports.getComponentPropertyPath=c,s.exports.propertyPathCache=o,s.exports.getComponentProperty=function(l,u,h){var p;return h=h||".",u.indexOf(h)!==-1?(p=c(u,h),p.constructor===String?l.getAttribute(p):l.getAttribute(p[0])[p[1]]):l.getAttribute(u)},s.exports.setComponentProperty=function(l,u,h,p){var f;if(p=p||".",u.indexOf(p)!==-1){f=c(u,p),f.constructor===String?l.setAttribute(f,h):l.setAttribute(f[0],f[1],h);return}l.setAttribute(u,h)}},"./src/utils/forceCanvasResizeSafariMobile.js":s=>{s.exports=function(c){var l=c.style.width,u=c.style.height;c.style.width=parseInt(l,10)+1+"px",c.style.height=parseInt(u,10)+1+"px",setTimeout(function(){c.style.width=l,c.style.height=u},200)}},"./src/utils/index.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=c("./node_modules/deep-assign/index.js"),h=c("./src/utils/device.js"),p=c("./node_modules/object-assign/index.js"),f=c("./src/utils/object-pool.js"),m=l("utils:warn");s.exports.bind=c("./src/utils/bind.js"),s.exports.coordinates=c("./src/utils/coordinates.js"),s.exports.debug=l,s.exports.device=h,s.exports.entity=c("./src/utils/entity.js"),s.exports.forceCanvasResizeSafariMobile=c("./src/utils/forceCanvasResizeSafariMobile.js"),s.exports.isIE11=c("./src/utils/is-ie11.js"),s.exports.material=c("./src/utils/material.js"),s.exports.objectPool=f,s.exports.split=c("./src/utils/split.js").split,s.exports.styleParser=c("./src/utils/styleParser.js"),s.exports.trackedControls=c("./src/utils/tracked-controls.js"),s.exports.checkHeadsetConnected=function(){return m("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),h.checkHeadsetConnected(arguments)},s.exports.isGearVR=s.exports.device.isGearVR=function(){m("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},s.exports.isIOS=function(){return m("`utils.isIOS` has moved to `utils.device.isIOS`"),h.isIOS(arguments)},s.exports.isOculusGo=s.exports.device.isOculusGo=function(){m("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},s.exports.isMobile=function(){return m("`utils.isMobile has moved to `utils.device.isMobile`"),h.isMobile(arguments)},s.exports.throttle=function(y,E,x){var v;return x&&(y=s.exports.bind(y,x)),function(){var w=Date.now(),M=typeof v>"u"?E:w-v;(typeof v>"u"||M>=E)&&(v=w,y.apply(null,arguments))}},s.exports.throttleLeadingAndTrailing=function(y,E,x){var v,w;return x&&(y=s.exports.bind(y,x)),function(){var M=Date.now(),T=typeof v>"u"?E:M-v,D=arguments;typeof v>"u"||T>=E?(clearTimeout(w),v=M,y.apply(null,D)):(clearTimeout(w),w=setTimeout(function(){v=Date.now(),y.apply(this,D)},E-T))}},s.exports.throttleTick=function(y,E,x){var v;return x&&(y=s.exports.bind(y,x)),function(w,M){var T=typeof v>"u"?M:w-v;(typeof v>"u"||T>=E)&&(v=w,y(w,T))}},s.exports.debounce=function(y,E,x){var v;return function(){var w=this,M=arguments,T=function(){v=null,x||y.apply(w,M)},D=x&&!v;clearTimeout(v),v=setTimeout(T,E),D&&y.apply(w,M)}},s.exports.extend=p,s.exports.extendDeep=u,s.exports.clone=function(y){return JSON.parse(JSON.stringify(y))};var A=function(){var y=f.createPool(function(){return[]});return function(E,x){var v,w,M,T,D,L;if(E===void 0||x===void 0||E===null||x===null||!(E&&x&&E.constructor===Object&&x.constructor===Object||E.constructor===Array&&x.constructor===Array))return E===x;w=y.use(),M=y.use(),w.length=0,M.length=0;for(v in E)w.push(v);for(v in x)M.push(v);if(w.length!==M.length)return y.recycle(w),y.recycle(M),!1;for(T=0;T<w.length;++T)if(D=E[w[T]],L=x[w[T]],typeof D=="object"||typeof L=="object"||Array.isArray(D)&&Array.isArray(L)){if(D===L)continue;if(!A(D,L))return y.recycle(w),y.recycle(M),!1}else if(D!==L)return y.recycle(w),y.recycle(M),!1;return y.recycle(w),y.recycle(M),!0}}();s.exports.deepEqual=A,s.exports.diff=function(){var y=[];return function(E,x,v){var w,M,T,D,L,I,F;D=v||{},y.length=0;for(L in E)y.push(L);if(!x)return D;for(T in x)y.indexOf(T)===-1&&y.push(T);for(I=0;I<y.length;I++)L=y[I],w=E[L],M=x[L],F=w&&M&&w.constructor===Object&&M.constructor===Object,(F&&!A(w,M)||!F&&w!==M)&&(D[L]=M);return D}}(),s.exports.shouldCaptureKeyEvent=function(y){return y.metaKey?!1:document.activeElement===document.body},s.exports.splitString=function(y,E){typeof E>"u"&&(E=" ");var x=new RegExp(E,"g");return y=(y||"").replace(x,E),y.split(E)},s.exports.getElData=function(y,E){E=E||{};var x={};Object.keys(E).forEach(v);function v(w){y.hasAttribute(w)&&(x[w]=y.getAttribute(w))}return x},s.exports.getUrlParameter=function(y){y=y.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var E=new RegExp("[\\?&]"+y+"=([^&#]*)"),x=E.exec(location.search);return x===null?"":decodeURIComponent(x[1].replace(/\+/g," "))},s.exports.isIframed=function(){return window.top!==window.self},s.exports.findAllScenes=function(y){for(var E=[],x=y.getElementsByTagName("*"),v=0,w=x.length;v<w;v++)x[v].isScene&&E.push(x[v]);return E},s.exports.srcLoader=c("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/is-ie11.js":s=>{function o(){var c=-1,l=navigator.userAgent,u;return navigator.appName==="Microsoft Internet Explorer"?(u=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),u.exec(l)!=null&&(c=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(u=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),u.exec(l)!=null&&(c=parseFloat(RegExp.$1))),c}s.exports=o()===11},"./src/utils/isIOSOlderThan10.js":s=>{s.exports=function(c){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(c)}},"./src/utils/material.js":(s,o,c)=>{var l=c("./src/lib/three.js"),u=["application/x-mpegurl","application/vnd.apple.mpegurl"],h=new Set(["emissiveMap","envMap","map","specularMap"]);function p(m,A){var y=A.offset||{x:0,y:0},E=A.repeat||{x:1,y:1},x=A.npot||!1,v=A.anisotropy||0;x&&(m.wrapS=l.ClampToEdgeWrapping,m.wrapT=l.ClampToEdgeWrapping,m.magFilter=l.LinearFilter,m.minFilter=l.LinearFilter),(E.x!==1||E.y!==1)&&(m.wrapS=l.RepeatWrapping,m.wrapT=l.RepeatWrapping,m.repeat.set(E.x,E.y)),(y.x!==0||y.y!==0)&&m.offset.set(y.x,y.y),v!==0&&(m.anisotropy=v)}s.exports.setTextureProperties=p,s.exports.updateMapMaterialFromData=function(m,A,y,E){var x=y.el,v=y.material,w=x.sceneEl.systems.renderer,M=E[A];if(y.materialSrcs||(y.materialSrcs={}),!M){delete y.materialSrcs[m],D(null);return}if(M===y.materialSrcs[m]&&v[m]){p(v[m],E);return}y.materialSrcs[m]=M,M instanceof l.Texture?D(M):x.sceneEl.systems.material.loadTexture(M,{src:M,repeat:E.repeat,offset:E.offset,npot:E.npot,anisotropy:E.anisotropy},T);function T(L){y.materialSrcs[m]===M&&D(L)}function D(L){v[m]=L,L&&h.has(m)&&w.applyColorCorrection(L),v.needsUpdate=!0,f(x,L)}},s.exports.updateMap=function(m,A){return s.exports.updateMapMaterialFromData("map","src",m,A)},s.exports.updateDistortionMap=function(m,A,y){var E=m;m==="ambientOcclusion"&&(E="ao");var x=A.el,v=A.material,w=x.sceneEl.systems.renderer,M=y[m+"Map"],T={};if(T.src=M,T.offset=y[m+"TextureOffset"],T.repeat=y[m+"TextureRepeat"],T.wrap=y[m+"TextureWrap"],M){if(M===A[m+"TextureSrc"])return;A[m+"TextureSrc"]=M,x.sceneEl.systems.material.loadTexture(M,T,D);return}if(!v.map)return;D(null);function D(L){var I=E+"Map";v[I]=L,L&&h.has(I)&&w.applyColorCorrection(L),L&&p(L,y),v.needsUpdate=!0,f(x,L)}};function f(m,A){A&&(m.emit("materialtextureloaded",{src:A.image,texture:A}),!(!A.image||A.image.tagName!=="VIDEO")&&(A.image.addEventListener("loadeddata",function(){!m.components||!m.components.material||(A.needsCorrectionBGRA&&A.needsCorrectionFlipY&&["standard","flat"].indexOf(m.components.material.data.shader)!==-1&&m.setAttribute("material","shader","ios10hls"),m.emit("materialvideoloadeddata",{src:A.image,texture:A}))}),A.image.addEventListener("ended",function(){m.emit("materialvideoended",{src:A.image,texture:A})})))}s.exports.handleTextureEvents=f,s.exports.isHLS=function(m,A){return!!(A&&u.includes(A.toLowerCase())||m&&m.toLowerCase().indexOf(".m3u8")>0)}},"./src/utils/math.js":s=>{function o(l,u,h){var p=u.dot(l);return(p-u.dot(h))/u.length()}function c(l,u,h,p){var f=o(l,u,h);return p.copy(u),p.multiplyScalar(f),p.add(h),p}s.exports.distanceOfPointFromPlane=o,s.exports.nearestPointInPlane=c},"./src/utils/object-pool.js":s=>{var o=Object.freeze(Object.create(null));function c(){return{}}s.exports.createPool=function(p){var f=[],m=null;p=p||c;function A(){var v;return(m===null||m===f.length)&&E(f.length||5),v=f[m],f[m++]=o,l(v),v}function y(v){if(v instanceof Object){if(m===null||m===-1){f[f.length]=v;return}f[--m]=v}}function E(v){var w,M;if(v=v===void 0?f.length:v,v>0&&m==null&&(m=0),v>0)for(w=f.length,f.length+=Number(v),M=w;M<f.length;M++)f[M]=p();return f.length}function x(){return f.length}return{grow:E,pool:f,recycle:y,size:x,use:A}};function l(h){var p;if(!(!h||h.constructor!==Object))for(p in h)h[p]=void 0}s.exports.clearObject=l;function u(h,p){var f;if(!(!h||h.constructor!==Object))for(f in h)f in p||delete h[f]}s.exports.removeUnusedKeys=u},"./src/utils/split.js":s=>{s.exports.split=function(){var o={};return function(c,l){return l in o||(o[l]={}),c in o[l]||(o[l][c]=c.split(l)),o[l][c]}}()},"./src/utils/src-loader.js":(s,o,c)=>{var l=c("./src/utils/debug.js"),u=l("utils:src-loader:warn");function h(E,x,v){m(E,function(M){if(M){x(E);return}v(E)})}function p(E,x){var v,w="",M,T,D=[];for(M=0;M<5;M++)w+="(url\\((?:[^\\)]+)\\),\\s*)";w+="(url\\((?:[^\\)]+)\\)\\s*)",T=E.match(new RegExp(w));function L(I){D.push(I),D.length===6&&x(D)}if(T){for(M=1;M<7;M++)h(f(T[M]),L);return}if(v=y(E),!!v){if(v.tagName==="A-CUBEMAP"&&v.srcs)return x(v.srcs);u('Selector "%s" does not point to <a-cubemap>',E)}}function f(E){var x=E.match(/\url\((.+)\)/);if(x)return x[1]}function m(E,x){var v;if(E.tagName){x(E.tagName==="IMG");return}v=new XMLHttpRequest,v.open("HEAD",E),v.addEventListener("load",function(w){var M;v.status>=200&&v.status<300?(M=v.getResponseHeader("Content-Type"),M==null?A(E,x):M.startsWith("image")?x(!0):x(!1)):A(E,x),v.abort()}),v.send()}function A(E,x){var v=new Image;v.addEventListener("load",w);function w(){x(!0)}v.addEventListener("error",M);function M(){x(!1)}v.src=E}function y(E){try{var x=document.querySelector(E);return x||u('No element was found matching the selector: "%s"',E),x}catch{u('"%s" is not a valid selector',E);return}}s.exports={parseUrl:f,validateSrc:h,validateCubemapSrc:p}},"./src/utils/styleParser.js":s=>{var o=/-([a-z])/g;s.exports.parse=function(m,A){var y;return typeof m!="string"||(y=h(m,A),y[""])?m:l(y)},s.exports.stringify=function(m){return typeof m=="string"?m:p(m)};function c(m){return m.replace(o,f)}s.exports.toCamelCase=c;function l(m){var A,y;for(y in m)A=c(y),y!==A&&(m[A]=m[y],delete m[y]);return m}s.exports.transformKeysToCamelCase=l;var u=function(){var m=[],A=/url\([^)]+$/;return function(E){var x="",v,w=0,M=";";for(m.length=0;w<E.length;){if(v=E.indexOf(M,w),v===-1&&(v=E.length),x+=E.substring(w,v),A.test(x)){x+=";",w=v+1;continue}m.push(x.trim()),x="",w=v+1}return m}}();function h(m,A){var y,E,x,v,w,M;for(A=A||{},y=u(m),E=0;E<y.length;E++)x=y[E],x&&(v=x.indexOf(":"),w=x.substr(0,v).trim(),M=x.substr(v+1).trim(),A[w]=M);return A}function p(m){var A,y=0,E=0,x="";for(A in m)y++;for(A in m)x+=A+": "+m[A],E<y-1&&(x+="; "),E++;return x}function f(m){return m[1].toUpperCase()}},"./src/utils/tracked-controls.js":(s,o,c)=>{var l=c("./src/constants/index.js").DEFAULT_HANDEDNESS,u=["x","y","z","w"],h=2;s.exports.checkControllerPresentAndSetup=function(y,E,x){var v=y.el,w,M=v.sceneEl.hasWebXR,T=M?f:p,D;if(w=T(y,E,x),D=!!w,y.controllerPresent&&!y.controllerEventsActive&&!M&&y.addEventListeners(),D===y.controllerPresent)return D;y.controllerPresent=D,D?(y.addEventListeners(),y.injectTrackedControls(w),v.emit("controllerconnected",{name:y.name,component:y})):(y.removeEventListeners(),v.emit("controllerdisconnected",{name:y.name,component:y}))};function p(y,E,x){var v,w=y.el.sceneEl,M,T=x.index||0;return!E||(M=w&&w.systems["tracked-controls-webvr"],!M)||(v=M.controllers,!v.length)?!1:!!m(v,null,E,x.hand,T)}function f(y,E,x){var v,w=y.el.sceneEl,M=w&&w.systems["tracked-controls-webxr"];return!M||(v=M.controllers,!v||!v.length)?!1:A(v,E,x.hand,x.index,x.iterateControllerProfiles,x.handTracking)}s.exports.isControllerPresentWebVR=p,s.exports.isControllerPresentWebXR=f;function m(y,E,x,v,w){var M,T,D=0,L=w>=0?w:0;for(T=0;T<y.length;T++)if(M=y[T],!(x&&!M.id.startsWith(x))&&!(!x&&M.id!==E)&&!(v&&M.hand&&v!==M.hand)){if(v&&!M.hand)L=h*w+(v===l?0:1);else return M;if(D===L)return M;++D}}function A(y,E,x,v,w,M){var T,D,L,I=!1,F,R;for(T=0;T<y.length;T++){if(L=y[T],R=L.profiles,M)I=L.hand;else if(w)for(D=0;D<R.length&&(I=R[D].startsWith(E),!I);D++);else I=R.length>0&&R[0].startsWith(E);if(I){if(F=L.handedness==="right"||L.handedness==="left",F){if(L.handedness===x)return y[T]}else if(T===v)return y[T]}}}s.exports.findMatchingControllerWebVR=m,s.exports.findMatchingControllerWebXR=A,s.exports.emitIfAxesChanged=function(y,E,x){var v,w,M,T,D;for(w in E){for(v=E[w],M=!1,D=0;D<v.length;D++)x.detail.changed[v[D]]&&(M=!0);if(M){for(T={},D=0;D<v.length;D++)T[u[D]]=x.detail.axis[v[D]];y.el.emit(w+"moved",T)}}},s.exports.onButtonEvent=function(y,E,x,v){var w=v?x.mapping[v]:x.mapping,M=w.buttons[y];x.el.emit(M+E),x.updateModel&&x.updateModel(M,E)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(s){var o=this;this.object=s,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var c=function(h){o.deviceOrientation=h},l=function(){o.screenOrientation=window.orientation||0},u=function(){var h=new THREE.Vector3(0,0,1),p=new THREE.Euler,f=new THREE.Quaternion,m=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(A,y,E,x,v){p.set(E,y,-x,"YXZ"),A.setFromEuler(p),A.multiply(m),A.multiply(f.setFromAxisAngle(h,-v))}}();this.connect=function(){l(),window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",c,!1),o.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",l,!1),window.removeEventListener("deviceorientation",c,!1),o.enabled=!1},this.update=function(){if(o.enabled!==!1){var h=o.deviceOrientation;if(h){var p=h.alpha?THREE.MathUtils.degToRad(h.alpha)+o.alphaOffset:0,f=h.beta?THREE.MathUtils.degToRad(h.beta):0,m=h.gamma?THREE.MathUtils.degToRad(h.gamma):0,A=o.screenOrientation?THREE.MathUtils.degToRad(o.screenOrientation):0;u(o.object.quaternion,p,f,m,A)}}},this.dispose=function(){o.disconnect()},this.connect()}},"./vendor/rStats.extras.js":s=>{window.glStats=function(){var o=null,c=0,l=0,u=0,h=0,p=0,f=0,m=0;function A(D,L){return function(){L.apply(this,arguments),D.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=A(WebGLRenderingContext.prototype.drawArrays,function(){c++,arguments[0]==this.POINTS?f+=arguments[2]:p+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=A(WebGLRenderingContext.prototype.drawElements,function(){l++,h+=arguments[1]/3,p+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=A(WebGLRenderingContext.prototype.useProgram,function(){u++}),WebGLRenderingContext.prototype.bindTexture=A(WebGLRenderingContext.prototype.bindTexture,function(){m++});var y={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},E=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],x=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function v(){o("allcalls").set(c+l),o("drawElements").set(l),o("drawArrays").set(c),o("bindTexture").set(m),o("useProgram").set(u),o("glfaces").set(h),o("glvertices").set(p),o("glpoints").set(f)}function w(){c=0,l=0,u=0,h=0,p=0,f=0,m=0}function M(){}function T(D){o=D}return{update:v,start:w,end:M,attach:T,values:y,groups:E,fractions:x}},window.threeStats=function(o){var c=null,l={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},u=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],h=[];function p(){c("renderer.info.memory.geometries").set(o.info.memory.geometries),c("renderer.info.programs").set(o.info.programs.length),c("renderer.info.memory.textures").set(o.info.memory.textures),c("renderer.info.render.calls").set(o.info.render.calls),c("renderer.info.render.triangles").set(o.info.render.triangles),c("renderer.info.render.points").set(o.info.render.points)}function f(){}function m(){}function A(y){c=y}return{update:p,start:f,end:m,attach:A,values:l,groups:u,fractions:h}},window.BrowserStats=function(){var o=null,c=0,l=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var u={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},h=[{caption:"Browser",values:["memory","total"]}],p=[{base:"total",steps:["memory"]}],f=Math.log(1024);function m(v){var w=100,M=Math.floor(Math.log(v)/f);return Math.round(v*w/Math.pow(1024,M))/w}function A(){c=m(performance.memory.usedJSHeapSize),l=m(performance.memory.totalJSHeapSize),o("memory").set(c),o("total").set(l)}function y(){c=0}function E(){}function x(v){o=v}return{update:A,start:y,end:E,attach:x,values:u,groups:h,fractions:p}},s.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":s=>{"use strict";(function(){"performance"in window||(window.performance={});var o=window.performance;if(!("now"in o)){var c=Date.now();o.timing&&o.timing.navigationStart&&(c=o.timing.navigationStart),o.now=function(){return Date.now()-c}}o.mark||(o.mark=function(){}),o.measure||(o.measure=function(){})})(),window.rStats=function(c){function l(N,X){for(var $=Object.keys(N),te=0,U=$.length;te<U;te++)X($[te])}function u(N){var X=document.createElement("link");X.href=N,X.rel="stylesheet",X.type="text/css",document.getElementsByTagName("head")[0].appendChild(X)}var h=c||{},p=h.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],f="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",m=(h.CSSPath?h.CSSPath:"")+"rStats.css",A=h.css||[f,m];A.forEach(function(N){u(N)}),h.values||(h.values={});var y,E,x=10,v=200,w={};function M(N,X,$){var te=$||{},U=document.createElement("canvas"),P=U.getContext("2d"),k=0,z=0,Q=te.color?te.color:"#666666",Z=document.createElement("canvas"),ce=Z.getContext("2d");Z.width=1,Z.height=2*x,ce.fillStyle="#444444",ce.fillRect(0,0,1,2*x),ce.fillStyle=Q,ce.fillRect(0,x,1,x),ce.fillStyle="#ffffff",ce.globalAlpha=.5,ce.fillRect(0,x,1,1),ce.globalAlpha=1;var Me=document.createElement("canvas"),xe=Me.getContext("2d");Me.width=1,Me.height=2*x,xe.fillStyle="#444444",xe.fillRect(0,0,1,2*x),xe.fillStyle="#b70000",xe.fillRect(0,x,1,x),xe.globalAlpha=.5,xe.fillStyle="#ffffff",xe.fillRect(0,x,1,1),xe.globalAlpha=1;function be(){U.width=v,U.height=x,U.style.width=U.width+"px",U.style.height=U.height+"px",U.className="rs-canvas",N.appendChild(U),P.fillStyle="#444444",P.fillRect(0,0,U.width,U.height)}function Fe(Ze,ut){z+=(Ze-z)*.1,k*=.99,z>k&&(k=z),P.drawImage(U,1,0,U.width-1,U.height,0,0,U.width-1,U.height),ut?P.drawImage(Me,U.width-1,U.height-z*U.height/k-x):P.drawImage(Z,U.width-1,U.height-z*U.height/k-x)}return be(),{draw:Fe}}function T(N,X){var $=document.createElement("canvas"),te=$.getContext("2d");function U(){$.width=v,$.height=x*X,$.style.width=$.width+"px",$.style.height=$.height+"px",$.className="rs-canvas",N.appendChild($),te.fillStyle="#444444",te.fillRect(0,0,$.width,$.height)}function P(k){te.drawImage($,1,0,$.width-1,$.height,0,0,$.width-1,$.height);var z=0;l(k,function(Q){var Z=k[Q]*$.height;te.fillStyle=p[Q],te.fillRect($.width-1,z,1,Z),z+=Z})}return U(),{draw:P}}function D(N,X){var $=N,te,U=0,P=0,k=0,z=0,Q=performance.now(),Z=0,ce=document.createElement("div"),Me=document.createElement("span"),xe=document.createElement("div"),be=document.createTextNode(""),Fe=h?h.values[$.toLowerCase()]:null,Ze=new M(ce,$,Fe),ut=!1;Me.className="rs-counter-id",Me.textContent=Fe&&Fe.caption?Fe.caption:$,xe.className="rs-counter-value",xe.appendChild(be),ce.appendChild(Me),ce.appendChild(xe),X?X.div.appendChild(ce):E.appendChild(ce),te=performance.now();function it(St){if(Fe&&Fe.average){z+=St,Z++;var Vt=performance.now();Vt-Q>=(Fe.avgMs||1e3)&&(k=z/Z,z=0,Q=Vt,Z=0)}}function gt(){te=performance.now(),h.userTimingAPI&&performance.mark($+"-start"),ut=!0}function Rt(){U=performance.now()-te,h.userTimingAPI&&(performance.mark($+"-end"),ut&&performance.measure($,$+"-start",$+"-end")),it(U)}function It(){Rt(),gt()}function Ft(){var St=Fe&&Fe.average?k:U;be.nodeValue=Math.round(St*100)/100;var Vt=Fe&&(Fe.below&&U<Fe.below||Fe.over&&U>Fe.over);Ze.draw(U,Vt),ce.className=Vt?"rs-counter-base alarm":"rs-counter-base"}function Ne(){var St=performance.now(),Vt=St-te;P++,Vt>1e3&&(Fe&&Fe.interpolate===!1?U=P:U=P*1e3/Vt,P=0,te=St,it(U))}function pn(St){U=St,it(U)}return{set:pn,start:gt,tick:It,end:Rt,frame:Ne,value:function(){return U},draw:Ft}}function L(){var N=0;function X($){N=$}return{set:X,value:function(){return N}}}function I(N){var X=N.toLowerCase();if(X===void 0&&(X="default"),w[X])return w[X];var $=null;h&&h.groups&&l(h.groups,function(U){var P=h.groups[parseInt(U,10)];!$&&P.values.indexOf(X.toLowerCase())!==-1&&($=P)});var te=new D(X,$);return w[X]=te,te}function F(){if(h.plugins){h.values||(h.values={}),h.groups||(h.groups=[]),h.fractions||(h.fractions=[]);for(var N=0;N<h.plugins.length;N++)h.plugins[N].attach(I),l(h.plugins[N].values,function(X){h.values[X]=h.plugins[N].values[X]}),h.groups=h.groups.concat(h.plugins[N].groups),h.fractions=h.fractions.concat(h.plugins[N].fractions)}else h.plugins={};y=document.createElement("div"),y.className="rs-base",E=document.createElement("div"),E.className="rs-container",E.style.height="auto",y.appendChild(E),document.body.appendChild(y),h&&(h.groups&&l(h.groups,function(X){var $=h.groups[parseInt(X,10)],te=document.createElement("div");te.className="rs-group",$.div=te;var U=document.createElement("h1");U.textContent=$.caption,U.addEventListener("click",(function(P){this.classList.toggle("hidden"),P.preventDefault()}).bind(te)),E.appendChild(U),E.appendChild(te)}),h.fractions&&l(h.fractions,function(X){var $=h.fractions[parseInt(X,10)],te=document.createElement("div");te.className="rs-fraction";var U=document.createElement("div");U.className="rs-legend";var P=0;l(h.fractions[X].steps,function(z){var Q=document.createElement("p");Q.textContent=h.fractions[X].steps[z],Q.style.color=p[P],U.appendChild(Q),P++}),te.appendChild(U),te.style.height=P*x+"px",$.div=te;var k=new T(te,P);$.graph=k,E.appendChild(te)}))}function R(){l(h.plugins,function(N){h.plugins[N].update()}),l(w,function(N){w[N].draw()}),h&&h.fractions&&l(h.fractions,function(N){var X=h.fractions[parseInt(N,10)],$=[],te=w[X.base.toLowerCase()];te&&(te=te.value(),l(h.fractions[N].steps,function(U){var P=h.fractions[N].steps[parseInt(U,10)].toLowerCase(),k=w[P];k&&$.push(k.value()/te)})),X.graph.draw($)})}return F(),function(N){return N?I(N):{element:y,update:R}}},s.exports=window.rStats},"./vendor/starts-with-polyfill.js":()=>{String.prototype.startsWith||(String.prototype.startsWith=function(s,o){return o=o||0,this.substr(o,s.length)===s})},"./vendor/wakelock/util.js":s=>{var o={};o.base64=function(c,l){return"data:"+c+";base64,"+l},o.isMobile=function(){var c=!1;return function(l){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(l.substr(0,4)))&&(c=!0)}(navigator.userAgent||navigator.vendor||window.opera),c},o.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},o.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},o.appendQueryParameter=function(c,l,u){var h=c.indexOf("?")<0?"?":"&";return c+=h+l+"="+u,c},o.getQueryParameter=function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var l=new RegExp("[\\?&]"+c+"=([^&#]*)"),u=l.exec(location.search);return u===null?"":decodeURIComponent(u[1].replace(/\+/g," "))},o.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},s.exports=o},"./vendor/wakelock/wakelock.js":(s,o,c)=>{var l=c("./vendor/wakelock/util.js");function u(){var f=document.createElement("video");f.addEventListener("ended",function(){f.play()}),this.request=function(){f.paused&&(f.src=l.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),f.play())},this.release=function(){f.pause(),f.src=""}}function h(){var f=null;this.request=function(){f||(f=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){f&&(clearInterval(f),f=null)}}function p(){var f=navigator.userAgent||navigator.vendor||window.opera;return f.match(/iPhone/i)||f.match(/iPod/i)?h:u}s.exports=p()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>F});var l=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),u=c.n(l),h=c("./node_modules/css-loader/dist/runtime/api.js"),p=c.n(h),f=c("./node_modules/css-loader/dist/runtime/getUrl.js"),m=c.n(f),A=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),y=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),E=new URL(c("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),c.b),x=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),c.b),v=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),c.b),w=p()(u()),M=m()(A),T=m()(y),D=m()(E),L=m()(x),I=m()(v);w.push([s.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+M+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+T+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+D+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+L+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+I+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);let F=w},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>m});var l=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),u=c.n(l),h=c("./node_modules/css-loader/dist/runtime/api.js"),p=c.n(h),f=p()(u());f.push([s.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);let m=f},"./src/style/aframe.css":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>L});var l=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),u=c.n(l),h=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),p=c.n(h),f=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),m=c.n(f),A=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),y=c.n(A),E=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),x=c.n(E),v=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),w=c.n(v),M=c("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),T={};T.styleTagTransform=w(),T.setAttributes=y(),T.insert=m().bind(null,"head"),T.domAPI=p(),T.insertStyleElement=x();var D=u()(M.default,T);let L=M.default&&M.default.locals?M.default.locals:void 0},"./src/style/rStats.css":(s,o,c)=>{"use strict";c.r(o),c.d(o,{default:()=>L});var l=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),u=c.n(l),h=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),p=c.n(h),f=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),m=c.n(f),A=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),y=c.n(A),E=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),x=c.n(E),v=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),w=c.n(v),M=c("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),T={};T.styleTagTransform=w(),T.setAttributes=y(),T.insert=m().bind(null,"head"),T.domAPI=p(),T.insertStyleElement=x();var D=u()(M.default,T);let L=M.default&&M.default.locals?M.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":s=>{"use strict";var o=[];function c(h){for(var p=-1,f=0;f<o.length;f++)if(o[f].identifier===h){p=f;break}return p}function l(h,p){for(var f={},m=[],A=0;A<h.length;A++){var y=h[A],E=p.base?y[0]+p.base:y[0],x=f[E]||0,v="".concat(E," ").concat(x);f[E]=x+1;var w=c(v),M={css:y[1],media:y[2],sourceMap:y[3],supports:y[4],layer:y[5]};if(w!==-1)o[w].references++,o[w].updater(M);else{var T=u(M,p);p.byIndex=A,o.splice(A,0,{identifier:v,updater:T,references:1})}m.push(v)}return m}function u(h,p){var f=p.domAPI(p);f.update(h);var m=function(y){if(y){if(y.css===h.css&&y.media===h.media&&y.sourceMap===h.sourceMap&&y.supports===h.supports&&y.layer===h.layer)return;f.update(h=y)}else f.remove()};return m}s.exports=function(h,p){p=p||{},h=h||[];var f=l(h,p);return function(A){A=A||[];for(var y=0;y<f.length;y++){var E=f[y],x=c(E);o[x].references--}for(var v=l(A,p),w=0;w<f.length;w++){var M=f[w],T=c(M);o[T].references===0&&(o[T].updater(),o.splice(T,1))}f=v}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":s=>{"use strict";var o={};function c(u){if(typeof o[u]>"u"){var h=document.querySelector(u);if(window.HTMLIFrameElement&&h instanceof window.HTMLIFrameElement)try{h=h.contentDocument.head}catch{h=null}o[u]=h}return o[u]}function l(u,h){var p=c(u);if(!p)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");p.appendChild(h)}s.exports=l},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":s=>{"use strict";function o(c){var l=document.createElement("style");return c.setAttributes(l,c.attributes),c.insert(l,c.options),l}s.exports=o},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(s,o,c)=>{"use strict";function l(u){var h=c.nc;h&&u.setAttribute("nonce",h)}s.exports=l},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":s=>{"use strict";function o(u,h,p){var f="";p.supports&&(f+="@supports (".concat(p.supports,") {")),p.media&&(f+="@media ".concat(p.media," {"));var m=typeof p.layer<"u";m&&(f+="@layer".concat(p.layer.length>0?" ".concat(p.layer):""," {")),f+=p.css,m&&(f+="}"),p.media&&(f+="}"),p.supports&&(f+="}");var A=p.sourceMap;A&&typeof btoa<"u"&&(f+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(A))))," */")),h.styleTagTransform(f,u,h.options)}function c(u){if(u.parentNode===null)return!1;u.parentNode.removeChild(u)}function l(u){if(typeof document>"u")return{update:function(){},remove:function(){}};var h=u.insertStyleElement(u);return{update:function(f){o(h,u,f)},remove:function(){c(h)}}}s.exports=l},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":s=>{"use strict";function o(c,l){if(l.styleSheet)l.styleSheet.cssText=c;else{for(;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(document.createTextNode(c))}}s.exports=o},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":s=>{"use strict";s.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":s=>{"use strict";s.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":s=>{"use strict";s.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":s=>{"use strict";s.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":s=>{"use strict";s.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/super-three/build/three.module.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{ACESFilmicToneMapping:()=>we,AddEquation:()=>$,AddOperation:()=>kt,AdditiveAnimationBlendMode:()=>Pi,AdditiveBlending:()=>F,AlphaFormat:()=>Ai,AlwaysCompare:()=>r0,AlwaysDepth:()=>pn,AlwaysStencilFunc:()=>Pp,AmbientLight:()=>SI,AnimationAction:()=>GI,AnimationClip:()=>hm,AnimationLoader:()=>pV,AnimationMixer:()=>GV,AnimationObjectGroup:()=>HV,AnimationUtils:()=>uV,ArcCurve:()=>GT,ArrayCamera:()=>__,ArrowHelper:()=>h7,AttachedBindMode:()=>Le,Audio:()=>VI,AudioAnalyser:()=>DV,AudioContext:()=>e1,AudioListener:()=>TV,AudioLoader:()=>wV,AxesHelper:()=>d7,BackSide:()=>M,BasicDepthPacking:()=>Oo,BasicShadowMap:()=>y,Bone:()=>T_,BooleanKeyframeTrack:()=>Ku,Box2:()=>$V,Box3:()=>rr,Box3Helper:()=>l7,BoxGeometry:()=>Hu,BoxHelper:()=>c7,BufferAttribute:()=>Wr,BufferGeometry:()=>Zi,BufferGeometryLoader:()=>LI,ByteType:()=>jt,Cache:()=>Ju,Camera:()=>T0,CameraHelper:()=>a7,CanvasTexture:()=>B6,CapsuleGeometry:()=>Z0,CatmullRomCurve3:()=>WT,CineonToneMapping:()=>de,CircleGeometry:()=>eA,ClampToEdgeWrapping:()=>Qe,Clock:()=>FI,Color:()=>jn,ColorKeyframeTrack:()=>q_,ColorManagement:()=>Ir,CompressedArrayTexture:()=>L6,CompressedCubeTexture:()=>P6,CompressedTexture:()=>Y0,CompressedTextureLoader:()=>mV,ConeGeometry:()=>tA,ConstantAlphaFactor:()=>It,ConstantColorFactor:()=>gt,CubeCamera:()=>N2,CubeReflectionMapping:()=>Ge,CubeRefractionMapping:()=>ee,CubeTexture:()=>jp,CubeTextureLoader:()=>gV,CubeUVReflectionMapping:()=>pe,CubicBezierCurve:()=>N_,CubicBezierCurve3:()=>QT,CubicInterpolant:()=>gI,CullFaceBack:()=>f,CullFaceFront:()=>m,CullFaceFrontBack:()=>A,CullFaceNone:()=>p,Curve:()=>Ga,CurvePath:()=>qT,CustomBlending:()=>X,CustomToneMapping:()=>Ae,CylinderGeometry:()=>Id,Cylindrical:()=>KV,Data3DTexture:()=>Ri,DataArrayTexture:()=>sd,DataTexture:()=>Cd,DataTextureLoader:()=>AV,DataUtils:()=>A4,DecrementStencilOp:()=>yE,DecrementWrapStencilOp:()=>EE,DefaultLoadingManager:()=>yI,DepthFormat:()=>le,DepthStencilFormat:()=>me,DepthTexture:()=>pT,DetachedBindMode:()=>Ee,DirectionalLight:()=>CI,DirectionalLightHelper:()=>o7,DiscreteInterpolant:()=>AI,DisplayP3ColorSpace:()=>Zh,DodecahedronGeometry:()=>nA,DoubleSide:()=>T,DstAlphaFactor:()=>be,DstColorFactor:()=>Ze,DynamicCopyUsage:()=>NE,DynamicDrawUsage:()=>RE,DynamicReadUsage:()=>PE,EdgesGeometry:()=>YT,EllipseCurve:()=>K0,EqualCompare:()=>Zg,EqualDepth:()=>Ot,EqualStencilFunc:()=>wE,EquirectangularReflectionMapping:()=>V,EquirectangularRefractionMapping:()=>G,Euler:()=>_2,EventDispatcher:()=>Eo,ExtrudeGeometry:()=>lA,FileLoader:()=>Vc,Float16BufferAttribute:()=>b4,Float32BufferAttribute:()=>ni,Float64BufferAttribute:()=>M4,FloatType:()=>fi,Fog:()=>F0,FogExp2:()=>N0,FramebufferTexture:()=>D6,FrontSide:()=>w,Frustum:()=>R0,GLBufferAttribute:()=>XV,GLSL1:()=>UE,GLSL3:()=>Bp,GreaterCompare:()=>t0,GreaterDepth:()=>Jt,GreaterEqualCompare:()=>i0,GreaterEqualDepth:()=>xn,GreaterEqualStencilFunc:()=>IE,GreaterStencilFunc:()=>SE,GridHelper:()=>r7,Group:()=>ju,HalfFloatType:()=>xi,HemisphereLight:()=>xI,HemisphereLightHelper:()=>i7,IcosahedronGeometry:()=>uA,ImageBitmapLoader:()=>MV,ImageLoader:()=>dm,ImageUtils:()=>Pc,IncrementStencilOp:()=>vE,IncrementWrapStencilOp:()=>xE,InstancedBufferAttribute:()=>Sd,InstancedBufferGeometry:()=>DI,InstancedInterleavedBuffer:()=>QV,InstancedMesh:()=>PT,Int16BufferAttribute:()=>E4,Int32BufferAttribute:()=>_4,Int8BufferAttribute:()=>v4,IntType:()=>Kn,InterleavedBuffer:()=>U0,InterleavedBufferAttribute:()=>Qu,Interpolant:()=>cm,InterpolateDiscrete:()=>Sn,InterpolateLinear:()=>Jn,InterpolateSmooth:()=>Zn,InvertStencilOp:()=>_E,KeepStencilOp:()=>Rc,KeyframeTrack:()=>Wa,LOD:()=>bT,LatheGeometry:()=>nm,Layers:()=>m0,LessCompare:()=>Jg,LessDepth:()=>St,LessEqualCompare:()=>e0,LessEqualDepth:()=>Vt,LessEqualStencilFunc:()=>CE,LessStencilFunc:()=>ME,Light:()=>Ul,LightProbe:()=>RI,Line:()=>Nl,Line3:()=>JV,LineBasicMaterial:()=>Co,LineCurve:()=>F_,LineCurve3:()=>XT,LineDashedMaterial:()=>fI,LineLoop:()=>kT,LineSegments:()=>fc,LinearDisplayP3ColorSpace:()=>Du,LinearEncoding:()=>Qr,LinearFilter:()=>_t,LinearInterpolant:()=>X_,LinearMipMapLinearFilter:()=>en,LinearMipMapNearestFilter:()=>En,LinearMipmapLinearFilter:()=>Cn,LinearMipmapNearestFilter:()=>tn,LinearSRGBColorSpace:()=>Sr,LinearToneMapping:()=>he,LinearTransfer:()=>Lu,Loader:()=>$o,LoaderUtils:()=>Z_,LoadingManager:()=>Y_,LoopOnce:()=>Wt,LoopPingPong:()=>sn,LoopRepeat:()=>Rn,LuminanceAlphaFormat:()=>Y,LuminanceFormat:()=>ne,MOUSE:()=>u,Material:()=>ho,MaterialLoader:()=>AA,MathUtils:()=>JE,Matrix3:()=>Oi,Matrix4:()=>_i,MaxEquation:()=>k,Mesh:()=>qs,MeshBasicMaterial:()=>Bl,MeshDepthMaterial:()=>x_,MeshDistanceMaterial:()=>E_,MeshLambertMaterial:()=>hI,MeshMatcapMaterial:()=>dI,MeshNormalMaterial:()=>uI,MeshPhongMaterial:()=>cI,MeshPhysicalMaterial:()=>aI,MeshStandardMaterial:()=>W_,MeshToonMaterial:()=>lI,MinEquation:()=>P,MirroredRepeatWrapping:()=>$e,MixOperation:()=>yt,MultiplyBlending:()=>N,MultiplyOperation:()=>Ie,NearestFilter:()=>nt,NearestMipMapLinearFilter:()=>tt,NearestMipMapNearestFilter:()=>ot,NearestMipmapLinearFilter:()=>et,NearestMipmapNearestFilter:()=>ge,NeverCompare:()=>$g,NeverDepth:()=>Ne,NeverStencilFunc:()=>bE,NoBlending:()=>L,NoColorSpace:()=>ls,NoToneMapping:()=>De,NormalAnimationBlendMode:()=>ci,NormalBlending:()=>I,NotEqualCompare:()=>n0,NotEqualDepth:()=>Oe,NotEqualStencilFunc:()=>TE,NumberKeyframeTrack:()=>lm,Object3D:()=>Kr,ObjectLoader:()=>_V,ObjectSpaceNormalMap:()=>cc,OctahedronGeometry:()=>om,OneFactor:()=>Q,OneMinusConstantAlphaFactor:()=>Ft,OneMinusConstantColorFactor:()=>Rt,OneMinusDstAlphaFactor:()=>Fe,OneMinusDstColorFactor:()=>ut,OneMinusSrcAlphaFactor:()=>xe,OneMinusSrcColorFactor:()=>ce,OrthographicCamera:()=>L0,P3Primaries:()=>Bu,PCFShadowMap:()=>E,PCFSoftShadowMap:()=>x,PMREMGenerator:()=>g_,Path:()=>tm,PerspectiveCamera:()=>Ms,Plane:()=>Ol,PlaneGeometry:()=>Qp,PlaneHelper:()=>u7,PointLight:()=>wI,PointLightHelper:()=>t7,Points:()=>HT,PointsMaterial:()=>R_,PolarGridHelper:()=>s7,PolyhedronGeometry:()=>Fl,PositionalAudio:()=>RV,PropertyBinding:()=>Xr,PropertyMixer:()=>zI,QuadraticBezierCurve:()=>U_,QuadraticBezierCurve3:()=>k_,Quaternion:()=>Ci,QuaternionKeyframeTrack:()=>Dd,QuaternionLinearInterpolant:()=>vI,RED_GREEN_RGTC2_Format:()=>Pt,RED_RGTC1_Format:()=>Re,REVISION:()=>l,RGBADepthPacking:()=>xo,RGBAFormat:()=>Mi,RGBAIntegerFormat:()=>Ct,RGBA_ASTC_10x10_Format:()=>bt,RGBA_ASTC_10x5_Format:()=>He,RGBA_ASTC_10x6_Format:()=>at,RGBA_ASTC_10x8_Format:()=>vt,RGBA_ASTC_12x10_Format:()=>qt,RGBA_ASTC_12x12_Format:()=>oe,RGBA_ASTC_4x4_Format:()=>yn,RGBA_ASTC_5x4_Format:()=>Ei,RGBA_ASTC_5x5_Format:()=>ur,RGBA_ASTC_6x5_Format:()=>$n,RGBA_ASTC_6x6_Format:()=>q,RGBA_ASTC_8x5_Format:()=>re,RGBA_ASTC_8x6_Format:()=>ye,RGBA_ASTC_8x8_Format:()=>Se,RGBA_BPTC_Format:()=>ue,RGBA_ETC2_EAC_Format:()=>zn,RGBA_PVRTC_2BPPV1_Format:()=>mn,RGBA_PVRTC_4BPPV1_Format:()=>Wn,RGBA_S3TC_DXT1_Format:()=>mt,RGBA_S3TC_DXT3_Format:()=>Bt,RGBA_S3TC_DXT5_Format:()=>cn,RGB_BPTC_SIGNED_Format:()=>Ce,RGB_BPTC_UNSIGNED_Format:()=>Be,RGB_ETC1_Format:()=>Yt,RGB_ETC2_Format:()=>lr,RGB_PVRTC_2BPPV1_Format:()=>Hn,RGB_PVRTC_4BPPV1_Format:()=>Ln,RGB_S3TC_DXT1_Format:()=>Tt,RGFormat:()=>rt,RGIntegerFormat:()=>At,RawShaderMaterial:()=>oI,Ray:()=>lo,Raycaster:()=>qV,Rec709Primaries:()=>Pu,RectAreaLight:()=>TI,RedFormat:()=>_e,RedIntegerFormat:()=>Xe,ReinhardToneMapping:()=>ae,RenderTarget:()=>rd,RepeatWrapping:()=>Ue,ReplaceStencilOp:()=>AE,ReverseSubtractEquation:()=>U,RingGeometry:()=>hA,SIGNED_RED_GREEN_RGTC2_Format:()=>Gt,SIGNED_RED_RGTC1_Format:()=>pt,SRGBColorSpace:()=>Gr,SRGBTransfer:()=>Ur,Scene:()=>AT,ShaderChunk:()=>Wi,ShaderLib:()=>za,ShaderMaterial:()=>dc,ShadowMaterial:()=>sI,Shape:()=>Xu,ShapeGeometry:()=>dA,ShapePath:()=>f7,ShapeUtils:()=>pc,ShortType:()=>Pn,Skeleton:()=>W0,SkeletonHelper:()=>e7,SkinnedMesh:()=>IT,Source:()=>Yr,Sphere:()=>Uo,SphereGeometry:()=>am,Spherical:()=>YV,SphericalHarmonics3:()=>II,SplineCurve:()=>V_,SpotLight:()=>bI,SpotLightHelper:()=>ZV,Sprite:()=>ET,SpriteMaterial:()=>M_,SrcAlphaFactor:()=>Me,SrcAlphaSaturateFactor:()=>it,SrcColorFactor:()=>Z,StaticCopyUsage:()=>OE,StaticDrawUsage:()=>Ou,StaticReadUsage:()=>LE,StereoCamera:()=>CV,StreamCopyUsage:()=>FE,StreamDrawUsage:()=>DE,StreamReadUsage:()=>BE,StringKeyframeTrack:()=>$u,SubtractEquation:()=>te,SubtractiveBlending:()=>R,TOUCH:()=>h,TangentSpaceNormalMap:()=>Os,TetrahedronGeometry:()=>fA,Texture:()=>Es,TextureLoader:()=>vV,TorusGeometry:()=>pA,TorusKnotGeometry:()=>mA,Triangle:()=>ko,TriangleFanDrawMode:()=>Ii,TriangleStripDrawMode:()=>Fr,TrianglesDrawMode:()=>vr,TubeGeometry:()=>gA,TwoPassDoubleSide:()=>D,UVMapping:()=>ze,Uint16BufferAttribute:()=>o_,Uint32BufferAttribute:()=>a_,Uint8BufferAttribute:()=>y4,Uint8ClampedBufferAttribute:()=>x4,Uniform:()=>i1,UniformsGroup:()=>jV,UniformsLib:()=>Nn,UniformsUtils:()=>O2,UnsignedByteType:()=>xt,UnsignedInt248Type:()=>dr,UnsignedIntType:()=>Gn,UnsignedShort4444Type:()=>Ti,UnsignedShort5551Type:()=>ir,UnsignedShortType:()=>In,VSMShadowMap:()=>v,Vector2:()=>nn,Vector3:()=>Ye,Vector4:()=>Mr,VectorKeyframeTrack:()=>um,VideoTexture:()=>R6,WebGL1Renderer:()=>gT,WebGL3DRenderTarget:()=>Ar,WebGLArrayRenderTarget:()=>qn,WebGLCoordinateSystem:()=>pa,WebGLCubeRenderTarget:()=>F2,WebGLMultipleRenderTargets:()=>Fs,WebGLRenderTarget:()=>No,WebGLRenderer:()=>mT,WebGLUtils:()=>lT,WebGPUCoordinateSystem:()=>Nu,WireframeGeometry:()=>nI,WrapAroundEnding:()=>oi,ZeroCurvatureEnding:()=>ri,ZeroFactor:()=>z,ZeroSlopeEnding:()=>On,ZeroStencilOp:()=>gE,_SRGBAFormat:()=>ed,createCanvasElement:()=>c0,sRGBEncoding:()=>ai});let l="158",u={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},p=0,f=1,m=2,A=3,y=0,E=1,x=2,v=3,w=0,M=1,T=2,D=2,L=0,I=1,F=2,R=3,N=4,X=5,$=100,te=101,U=102,P=103,k=104,z=200,Q=201,Z=202,ce=203,Me=204,xe=205,be=206,Fe=207,Ze=208,ut=209,it=210,gt=211,Rt=212,It=213,Ft=214,Ne=0,pn=1,St=2,Vt=3,Ot=4,xn=5,Jt=6,Oe=7,Ie=0,yt=1,kt=2,De=0,he=1,ae=2,de=3,we=4,Ae=5,Le="attached",Ee="detached",ze=300,Ge=301,ee=302,V=303,G=304,pe=306,Ue=1e3,Qe=1001,$e=1002,nt=1003,ge=1004,ot=1004,et=1005,tt=1005,_t=1006,tn=1007,En=1007,Cn=1008,en=1008,xt=1009,jt=1010,Pn=1011,In=1012,Kn=1013,Gn=1014,fi=1015,xi=1016,Ti=1017,ir=1018,dr=1020,Ai=1021,Mi=1023,ne=1024,Y=1025,le=1026,me=1027,_e=1028,Xe=1029,rt=1030,At=1031,Ct=1033,Tt=33776,mt=33777,Bt=33778,cn=33779,Ln=35840,Hn=35841,Wn=35842,mn=35843,Yt=36196,lr=37492,zn=37496,yn=37808,Ei=37809,ur=37810,$n=37811,q=37812,re=37813,ye=37814,Se=37815,He=37816,at=37817,vt=37818,bt=37819,qt=37820,oe=37821,ue=36492,Ce=36494,Be=36495,Re=36283,pt=36284,Pt=36285,Gt=36286,Wt=2200,Rn=2201,sn=2202,Sn=2300,Jn=2301,Zn=2302,ri=2400,On=2401,oi=2402,ci=2500,Pi=2501,vr=0,Fr=1,Ii=2,Qr=3e3,ai=3001,Oo=3200,xo=3201,Os=0,cc=1,ls="",Gr="srgb",Sr="srgb-linear",Zh="display-p3",Du="display-p3-linear",Lu="linear",Ur="srgb",Pu="rec709",Bu="p3",gE=0,Rc=7680,AE=7681,vE=7682,yE=7683,xE=34055,EE=34056,_E=5386,bE=512,ME=513,wE=514,CE=515,SE=516,TE=517,IE=518,Pp=519,$g=512,Jg=513,Zg=514,e0=515,t0=516,n0=517,i0=518,r0=519,Ou=35044,RE=35048,DE=35040,LE=35045,PE=35049,BE=35041,OE=35046,NE=35050,FE=35042,UE="100",Bp="300 es",ed=1035,pa=2e3,Nu=2001;class Eo{addEventListener(r,a){this._listeners===void 0&&(this._listeners={});let d=this._listeners;d[r]===void 0&&(d[r]=[]),d[r].indexOf(a)===-1&&d[r].push(a)}hasEventListener(r,a){if(this._listeners===void 0)return!1;let d=this._listeners;return d[r]!==void 0&&d[r].indexOf(a)!==-1}removeEventListener(r,a){if(this._listeners===void 0)return;let g=this._listeners[r];if(g!==void 0){let _=g.indexOf(a);_!==-1&&g.splice(_,1)}}dispatchEvent(r){if(this._listeners===void 0)return;let d=this._listeners[r.type];if(d!==void 0){r.target=this;let g=d.slice(0);for(let _=0,C=g.length;_<C;_++)g[_].call(this,r);r.target=null}}}let Ns=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],s0=1234567,Dc=Math.PI/180,Tl=180/Math.PI;function _o(){let b=Math.random()*4294967295|0,r=Math.random()*4294967295|0,a=Math.random()*4294967295|0,d=Math.random()*4294967295|0;return(Ns[b&255]+Ns[b>>8&255]+Ns[b>>16&255]+Ns[b>>24&255]+"-"+Ns[r&255]+Ns[r>>8&255]+"-"+Ns[r>>16&15|64]+Ns[r>>24&255]+"-"+Ns[a&63|128]+Ns[a>>8&255]+"-"+Ns[a>>16&255]+Ns[a>>24&255]+Ns[d&255]+Ns[d>>8&255]+Ns[d>>16&255]+Ns[d>>24&255]).toLowerCase()}function es(b,r,a){return Math.max(r,Math.min(a,b))}function Op(b,r){return(b%r+r)%r}function kE(b,r,a,d,g){return d+(b-r)*(g-d)/(a-r)}function VE(b,r,a){return b!==r?(a-b)/(r-b):0}function Fu(b,r,a){return(1-a)*b+a*r}function HE(b,r,a,d){return Fu(b,r,1-Math.exp(-a*d))}function zE(b,r=1){return r-Math.abs(Op(b,r*2)-r)}function GE(b,r,a){return b<=r?0:b>=a?1:(b=(b-r)/(a-r),b*b*(3-2*b))}function WE(b,r,a){return b<=r?0:b>=a?1:(b=(b-r)/(a-r),b*b*b*(b*(b*6-15)+10))}function jE(b,r){return b+Math.floor(Math.random()*(r-b+1))}function QE(b,r){return b+Math.random()*(r-b)}function XE(b){return b*(.5-Math.random())}function qE(b){b!==void 0&&(s0=b);let r=s0+=1831565813;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}function YE(b){return b*Dc}function KE(b){return b*Tl}function Np(b){return(b&b-1)===0&&b!==0}function o0(b){return Math.pow(2,Math.ceil(Math.log(b)/Math.LN2))}function td(b){return Math.pow(2,Math.floor(Math.log(b)/Math.LN2))}function $E(b,r,a,d,g){let _=Math.cos,C=Math.sin,S=_(a/2),B=C(a/2),O=_((r+d)/2),H=C((r+d)/2),W=_((r-d)/2),j=C((r-d)/2),J=_((d-r)/2),ie=C((d-r)/2);switch(g){case"XYX":b.set(S*H,B*W,B*j,S*O);break;case"YZY":b.set(B*j,S*H,B*W,S*O);break;case"ZXZ":b.set(B*W,B*j,S*H,S*O);break;case"XZX":b.set(S*H,B*ie,B*J,S*O);break;case"YXY":b.set(B*J,S*H,B*ie,S*O);break;case"ZYZ":b.set(B*ie,B*J,S*H,S*O);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+g)}}function ao(b,r){switch(r.constructor){case Float32Array:return b;case Uint32Array:return b/4294967295;case Uint16Array:return b/65535;case Uint8Array:return b/255;case Int32Array:return Math.max(b/2147483647,-1);case Int16Array:return Math.max(b/32767,-1);case Int8Array:return Math.max(b/127,-1);default:throw new Error("Invalid component type.")}}function Bi(b,r){switch(r.constructor){case Float32Array:return b;case Uint32Array:return Math.round(b*4294967295);case Uint16Array:return Math.round(b*65535);case Uint8Array:return Math.round(b*255);case Int32Array:return Math.round(b*2147483647);case Int16Array:return Math.round(b*32767);case Int8Array:return Math.round(b*127);default:throw new Error("Invalid component type.")}}let JE={DEG2RAD:Dc,RAD2DEG:Tl,generateUUID:_o,clamp:es,euclideanModulo:Op,mapLinear:kE,inverseLerp:VE,lerp:Fu,damp:HE,pingpong:zE,smoothstep:GE,smootherstep:WE,randInt:jE,randFloat:QE,randFloatSpread:XE,seededRandom:qE,degToRad:YE,radToDeg:KE,isPowerOfTwo:Np,ceilPowerOfTwo:o0,floorPowerOfTwo:td,setQuaternionFromProperEuler:$E,normalize:Bi,denormalize:ao};class nn{constructor(r=0,a=0){nn.prototype.isVector2=!0,this.x=r,this.y=a}get width(){return this.x}set width(r){this.x=r}get height(){return this.y}set height(r){this.y=r}set(r,a){return this.x=r,this.y=a,this}setScalar(r){return this.x=r,this.y=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y)}copy(r){return this.x=r.x,this.y=r.y,this}add(r){return this.x+=r.x,this.y+=r.y,this}addScalar(r){return this.x+=r,this.y+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this}subScalar(r){return this.x-=r,this.y-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this}multiply(r){return this.x*=r.x,this.y*=r.y,this}multiplyScalar(r){return this.x*=r,this.y*=r,this}divide(r){return this.x/=r.x,this.y/=r.y,this}divideScalar(r){return this.multiplyScalar(1/r)}applyMatrix3(r){let a=this.x,d=this.y,g=r.elements;return this.x=g[0]*a+g[3]*d+g[6],this.y=g[1]*a+g[4]*d+g[7],this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this}clampLength(r,a){let d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(r){return this.x*r.x+this.y*r.y}cross(r){return this.x*r.y-this.y*r.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(r){let a=Math.sqrt(this.lengthSq()*r.lengthSq());if(a===0)return Math.PI/2;let d=this.dot(r)/a;return Math.acos(es(d,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){let a=this.x-r.x,d=this.y-r.y;return a*a+d*d}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this}lerpVectors(r,a,d){return this.x=r.x+(a.x-r.x)*d,this.y=r.y+(a.y-r.y)*d,this}equals(r){return r.x===this.x&&r.y===this.y}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this}rotateAround(r,a){let d=Math.cos(a),g=Math.sin(a),_=this.x-r.x,C=this.y-r.y;return this.x=_*d-C*g+r.x,this.y=_*g+C*d+r.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Oi{constructor(r,a,d,g,_,C,S,B,O){Oi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],r!==void 0&&this.set(r,a,d,g,_,C,S,B,O)}set(r,a,d,g,_,C,S,B,O){let H=this.elements;return H[0]=r,H[1]=g,H[2]=S,H[3]=a,H[4]=_,H[5]=B,H[6]=d,H[7]=C,H[8]=O,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(r){let a=this.elements,d=r.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],this}extractBasis(r,a,d){return r.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(r){let a=r.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,a){let d=r.elements,g=a.elements,_=this.elements,C=d[0],S=d[3],B=d[6],O=d[1],H=d[4],W=d[7],j=d[2],J=d[5],ie=d[8],fe=g[0],se=g[3],K=g[6],Pe=g[1],ve=g[4],Te=g[7],We=g[2],qe=g[5],st=g[8];return _[0]=C*fe+S*Pe+B*We,_[3]=C*se+S*ve+B*qe,_[6]=C*K+S*Te+B*st,_[1]=O*fe+H*Pe+W*We,_[4]=O*se+H*ve+W*qe,_[7]=O*K+H*Te+W*st,_[2]=j*fe+J*Pe+ie*We,_[5]=j*se+J*ve+ie*qe,_[8]=j*K+J*Te+ie*st,this}multiplyScalar(r){let a=this.elements;return a[0]*=r,a[3]*=r,a[6]*=r,a[1]*=r,a[4]*=r,a[7]*=r,a[2]*=r,a[5]*=r,a[8]*=r,this}determinant(){let r=this.elements,a=r[0],d=r[1],g=r[2],_=r[3],C=r[4],S=r[5],B=r[6],O=r[7],H=r[8];return a*C*H-a*S*O-d*_*H+d*S*B+g*_*O-g*C*B}invert(){let r=this.elements,a=r[0],d=r[1],g=r[2],_=r[3],C=r[4],S=r[5],B=r[6],O=r[7],H=r[8],W=H*C-S*O,j=S*B-H*_,J=O*_-C*B,ie=a*W+d*j+g*J;if(ie===0)return this.set(0,0,0,0,0,0,0,0,0);let fe=1/ie;return r[0]=W*fe,r[1]=(g*O-H*d)*fe,r[2]=(S*d-g*C)*fe,r[3]=j*fe,r[4]=(H*a-g*B)*fe,r[5]=(g*_-S*a)*fe,r[6]=J*fe,r[7]=(d*B-O*a)*fe,r[8]=(C*a-d*_)*fe,this}transpose(){let r,a=this.elements;return r=a[1],a[1]=a[3],a[3]=r,r=a[2],a[2]=a[6],a[6]=r,r=a[5],a[5]=a[7],a[7]=r,this}getNormalMatrix(r){return this.setFromMatrix4(r).invert().transpose()}transposeIntoArray(r){let a=this.elements;return r[0]=a[0],r[1]=a[3],r[2]=a[6],r[3]=a[1],r[4]=a[4],r[5]=a[7],r[6]=a[2],r[7]=a[5],r[8]=a[8],this}setUvTransform(r,a,d,g,_,C,S){let B=Math.cos(_),O=Math.sin(_);return this.set(d*B,d*O,-d*(B*C+O*S)+C+r,-g*O,g*B,-g*(-O*C+B*S)+S+a,0,0,1),this}scale(r,a){return this.premultiply(Fp.makeScale(r,a)),this}rotate(r){return this.premultiply(Fp.makeRotation(-r)),this}translate(r,a){return this.premultiply(Fp.makeTranslation(r,a)),this}makeTranslation(r,a){return r.isVector2?this.set(1,0,r.x,0,1,r.y,0,0,1):this.set(1,0,r,0,1,a,0,0,1),this}makeRotation(r){let a=Math.cos(r),d=Math.sin(r);return this.set(a,-d,0,d,a,0,0,0,1),this}makeScale(r,a){return this.set(r,0,0,0,a,0,0,0,1),this}equals(r){let a=this.elements,d=r.elements;for(let g=0;g<9;g++)if(a[g]!==d[g])return!1;return!0}fromArray(r,a=0){for(let d=0;d<9;d++)this.elements[d]=r[d+a];return this}toArray(r=[],a=0){let d=this.elements;return r[a]=d[0],r[a+1]=d[1],r[a+2]=d[2],r[a+3]=d[3],r[a+4]=d[4],r[a+5]=d[5],r[a+6]=d[6],r[a+7]=d[7],r[a+8]=d[8],r}clone(){return new this.constructor().fromArray(this.elements)}}let Fp=new Oi;function a0(b){for(let r=b.length-1;r>=0;--r)if(b[r]>=65535)return!0;return!1}let ZE={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Il(b,r){return new ZE[b](r)}function Uu(b){return document.createElementNS("http://www.w3.org/1999/xhtml",b)}function c0(){let b=Uu("canvas");return b.style.display="block",b}let l0={};function ku(b){b in l0||(l0[b]=!0,console.warn(b))}let u0=new Oi().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),h0=new Oi().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),nd={[Sr]:{transfer:Lu,primaries:Pu,toReference:b=>b,fromReference:b=>b},[Gr]:{transfer:Ur,primaries:Pu,toReference:b=>b.convertSRGBToLinear(),fromReference:b=>b.convertLinearToSRGB()},[Du]:{transfer:Lu,primaries:Bu,toReference:b=>b.applyMatrix3(h0),fromReference:b=>b.applyMatrix3(u0)},[Zh]:{transfer:Ur,primaries:Bu,toReference:b=>b.convertSRGBToLinear().applyMatrix3(h0),fromReference:b=>b.applyMatrix3(u0).convertLinearToSRGB()}},e_=new Set([Sr,Du]),Ir={enabled:!0,_workingColorSpace:Sr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(b){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!b},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(b){if(!e_.has(b))throw new Error(`Unsupported working color space, "${b}".`);this._workingColorSpace=b},convert:function(b,r,a){if(this.enabled===!1||r===a||!r||!a)return b;let d=nd[r].toReference,g=nd[a].fromReference;return g(d(b))},fromWorkingColorSpace:function(b,r){return this.convert(b,this._workingColorSpace,r)},toWorkingColorSpace:function(b,r){return this.convert(b,r,this._workingColorSpace)},getPrimaries:function(b){return nd[b].primaries},getTransfer:function(b){return b===ls?Lu:nd[b].transfer}};function Rl(b){return b<.04045?b*.0773993808:Math.pow(b*.9478672986+.0521327014,2.4)}function Up(b){return b<.0031308?b*12.92:1.055*Math.pow(b,.41666)-.055}let Lc;class Pc{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let a;if(r instanceof HTMLCanvasElement)a=r;else{Lc===void 0&&(Lc=Uu("canvas")),Lc.width=r.width,Lc.height=r.height;let d=Lc.getContext("2d");r instanceof ImageData?d.putImageData(r,0,0):d.drawImage(r,0,0,r.width,r.height),a=Lc}return a.width>2048||a.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),a.toDataURL("image/jpeg",.6)):a.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap){let a=Uu("canvas");a.width=r.width,a.height=r.height;let d=a.getContext("2d");d.drawImage(r,0,0,r.width,r.height);let g=d.getImageData(0,0,r.width,r.height),_=g.data;for(let C=0;C<_.length;C++)_[C]=Rl(_[C]/255)*255;return d.putImageData(g,0,0),a}else if(r.data){let a=r.data.slice(0);for(let d=0;d<a.length;d++)a instanceof Uint8Array||a instanceof Uint8ClampedArray?a[d]=Math.floor(Rl(a[d]/255)*255):a[d]=Rl(a[d]);return{data:a,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}}let d0=0;class Yr{constructor(r=null){this.isSource=!0,Object.defineProperty(this,"id",{value:d0++}),this.uuid=_o(),this.data=r,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){let a=r===void 0||typeof r=="string";if(!a&&r.images[this.uuid]!==void 0)return r.images[this.uuid];let d={uuid:this.uuid,url:""},g=this.data;if(g!==null){let _;if(Array.isArray(g)){_=[];for(let C=0,S=g.length;C<S;C++)g[C].isDataTexture?_.push(id(g[C].image)):_.push(id(g[C]))}else _=id(g);d.url=_}return a||(r.images[this.uuid]=d),d}}function id(b){return typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&b instanceof ImageBitmap?Pc.getDataURL(b):b.data?{data:Array.from(b.data),width:b.width,height:b.height,type:b.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let f0=0,Es=(()=>{class b extends Eo{constructor(a=b.DEFAULT_IMAGE,d=b.DEFAULT_MAPPING,g=Qe,_=Qe,C=_t,S=Cn,B=Mi,O=xt,H=b.DEFAULT_ANISOTROPY,W=ls){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:f0++}),this.uuid=_o(),this.name="",this.source=new Yr(a),this.mipmaps=[],this.mapping=d,this.channel=0,this.wrapS=g,this.wrapT=_,this.magFilter=C,this.minFilter=S,this.anisotropy=H,this.format=B,this.internalFormat=null,this.type=O,this.offset=new nn(0,0),this.repeat=new nn(1,1),this.center=new nn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Oi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof W=="string"?this.colorSpace=W:(ku("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=W===ai?Gr:ls),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(a){return this.name=a.name,this.source=a.source,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.channel=a.channel,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.colorSpace=a.colorSpace,this.userData=JSON.parse(JSON.stringify(a.userData)),this.needsUpdate=!0,this}toJSON(a){let d=a===void 0||typeof a=="string";if(!d&&a.textures[this.uuid]!==void 0)return a.textures[this.uuid];let g={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(g.userData=this.userData),d||(a.textures[this.uuid]=g),g}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(this.mapping!==ze)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case Ue:a.x=a.x-Math.floor(a.x);break;case Qe:a.x=a.x<0?0:1;break;case $e:Math.abs(Math.floor(a.x)%2)===1?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x);break}if(a.y<0||a.y>1)switch(this.wrapT){case Ue:a.y=a.y-Math.floor(a.y);break;case Qe:a.y=a.y<0?0:1;break;case $e:Math.abs(Math.floor(a.y)%2)===1?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y);break}return this.flipY&&(a.y=1-a.y),a}set needsUpdate(a){a===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return ku("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Gr?ai:Qr}set encoding(a){ku("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=a===ai?Gr:ls}}return b.DEFAULT_IMAGE=null,b.DEFAULT_MAPPING=ze,b.DEFAULT_ANISOTROPY=1,b})();class Mr{constructor(r=0,a=0,d=0,g=1){Mr.prototype.isVector4=!0,this.x=r,this.y=a,this.z=d,this.w=g}get width(){return this.z}set width(r){this.z=r}get height(){return this.w}set height(r){this.w=r}set(r,a,d,g){return this.x=r,this.y=a,this.z=d,this.w=g,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this.w=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setW(r){return this.w=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this.z=r.z+a.z,this.w=r.w+a.w,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this.z+=r.z*a,this.w+=r.w*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this.z=r.z-a.z,this.w=r.w-a.w,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this}applyMatrix4(r){let a=this.x,d=this.y,g=this.z,_=this.w,C=r.elements;return this.x=C[0]*a+C[4]*d+C[8]*g+C[12]*_,this.y=C[1]*a+C[5]*d+C[9]*g+C[13]*_,this.z=C[2]*a+C[6]*d+C[10]*g+C[14]*_,this.w=C[3]*a+C[7]*d+C[11]*g+C[15]*_,this}divideScalar(r){return this.multiplyScalar(1/r)}setAxisAngleFromQuaternion(r){this.w=2*Math.acos(r.w);let a=Math.sqrt(1-r.w*r.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/a,this.y=r.y/a,this.z=r.z/a),this}setAxisAngleFromRotationMatrix(r){let a,d,g,_,B=r.elements,O=B[0],H=B[4],W=B[8],j=B[1],J=B[5],ie=B[9],fe=B[2],se=B[6],K=B[10];if(Math.abs(H-j)<.01&&Math.abs(W-fe)<.01&&Math.abs(ie-se)<.01){if(Math.abs(H+j)<.1&&Math.abs(W+fe)<.1&&Math.abs(ie+se)<.1&&Math.abs(O+J+K-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;let ve=(O+1)/2,Te=(J+1)/2,We=(K+1)/2,qe=(H+j)/4,st=(W+fe)/4,lt=(ie+se)/4;return ve>Te&&ve>We?ve<.01?(d=0,g=.707106781,_=.707106781):(d=Math.sqrt(ve),g=qe/d,_=st/d):Te>We?Te<.01?(d=.707106781,g=0,_=.707106781):(g=Math.sqrt(Te),d=qe/g,_=lt/g):We<.01?(d=.707106781,g=.707106781,_=0):(_=Math.sqrt(We),d=st/_,g=lt/_),this.set(d,g,_,a),this}let Pe=Math.sqrt((se-ie)*(se-ie)+(W-fe)*(W-fe)+(j-H)*(j-H));return Math.abs(Pe)<.001&&(Pe=1),this.x=(se-ie)/Pe,this.y=(W-fe)/Pe,this.z=(j-H)/Pe,this.w=Math.acos((O+J+K-1)/2),this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this.z=Math.max(r.z,Math.min(a.z,this.z)),this.w=Math.max(r.w,Math.min(a.w,this.w)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this.z=Math.max(r,Math.min(a,this.z)),this.w=Math.max(r,Math.min(a,this.w)),this}clampLength(r,a){let d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this.z+=(r.z-this.z)*a,this.w+=(r.w-this.w)*a,this}lerpVectors(r,a,d){return this.x=r.x+(a.x-r.x)*d,this.y=r.y+(a.y-r.y)*d,this.z=r.z+(a.z-r.z)*d,this.w=r.w+(a.w-r.w)*d,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this.z=r[a+2],this.w=r[a+3],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r[a+2]=this.z,r[a+3]=this.w,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this.z=r.getZ(a),this.w=r.getW(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rd extends Eo{constructor(r=1,a=1,d={}){super(),this.isRenderTarget=!0,this.width=r,this.height=a,this.depth=1,this.scissor=new Mr(0,0,r,a),this.scissorTest=!1,this.viewport=new Mr(0,0,r,a);let g={width:r,height:a,depth:1};d.encoding!==void 0&&(ku("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),d.colorSpace=d.encoding===ai?Gr:ls),d=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_t,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},d),this.texture=new Es(g,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=d.generateMipmaps,this.texture.internalFormat=d.internalFormat,this.depthBuffer=d.depthBuffer,this.stencilBuffer=d.stencilBuffer,this.depthTexture=d.depthTexture,this.samples=d.samples}setSize(r,a,d=1){(this.width!==r||this.height!==a||this.depth!==d)&&(this.width=r,this.height=a,this.depth=d,this.texture.image.width=r,this.texture.image.height=a,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,r,a),this.scissor.set(0,0,r,a)}clone(){return new this.constructor().copy(this)}copy(r){this.width=r.width,this.height=r.height,this.depth=r.depth,this.scissor.copy(r.scissor),this.scissorTest=r.scissorTest,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.texture.isRenderTargetTexture=!0;let a=Object.assign({},r.texture.image);return this.texture.source=new Yr(a),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.samples=r.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class No extends rd{constructor(r=1,a=1,d={}){super(r,a,d),this.isWebGLRenderTarget=!0}}class sd extends Es{constructor(r=null,a=1,d=1,g=1){super(null),this.isDataArrayTexture=!0,this.image={data:r,width:a,height:d,depth:g},this.magFilter=nt,this.minFilter=nt,this.wrapR=Qe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qn extends No{constructor(r=1,a=1,d=1){super(r,a),this.isWebGLArrayRenderTarget=!0,this.depth=d,this.texture=new sd(null,r,a,d),this.texture.isRenderTargetTexture=!0}}class Ri extends Es{constructor(r=null,a=1,d=1,g=1){super(null),this.isData3DTexture=!0,this.image={data:r,width:a,height:d,depth:g},this.magFilter=nt,this.minFilter=nt,this.wrapR=Qe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ar extends No{constructor(r=1,a=1,d=1){super(r,a),this.isWebGL3DRenderTarget=!0,this.depth=d,this.texture=new Ri(null,r,a,d),this.texture.isRenderTargetTexture=!0}}class Fs extends No{constructor(r=1,a=1,d=1,g={}){super(r,a,g),this.isWebGLMultipleRenderTargets=!0;let _=this.texture;this.texture=[];for(let C=0;C<d;C++)this.texture[C]=_.clone(),this.texture[C].isRenderTargetTexture=!0}setSize(r,a,d=1){if(this.width!==r||this.height!==a||this.depth!==d){this.width=r,this.height=a,this.depth=d;for(let g=0,_=this.texture.length;g<_;g++)this.texture[g].image.width=r,this.texture[g].image.height=a,this.texture[g].image.depth=d;this.dispose()}this.viewport.set(0,0,r,a),this.scissor.set(0,0,r,a)}copy(r){this.dispose(),this.width=r.width,this.height=r.height,this.depth=r.depth,this.scissor.copy(r.scissor),this.scissorTest=r.scissorTest,this.viewport.copy(r.viewport),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.texture.length=0;for(let a=0,d=r.texture.length;a<d;a++)this.texture[a]=r.texture[a].clone(),this.texture[a].isRenderTargetTexture=!0;return this}}class Ci{constructor(r=0,a=0,d=0,g=1){this.isQuaternion=!0,this._x=r,this._y=a,this._z=d,this._w=g}static slerpFlat(r,a,d,g,_,C,S){let B=d[g+0],O=d[g+1],H=d[g+2],W=d[g+3],j=_[C+0],J=_[C+1],ie=_[C+2],fe=_[C+3];if(S===0){r[a+0]=B,r[a+1]=O,r[a+2]=H,r[a+3]=W;return}if(S===1){r[a+0]=j,r[a+1]=J,r[a+2]=ie,r[a+3]=fe;return}if(W!==fe||B!==j||O!==J||H!==ie){let se=1-S,K=B*j+O*J+H*ie+W*fe,Pe=K>=0?1:-1,ve=1-K*K;if(ve>Number.EPSILON){let We=Math.sqrt(ve),qe=Math.atan2(We,K*Pe);se=Math.sin(se*qe)/We,S=Math.sin(S*qe)/We}let Te=S*Pe;if(B=B*se+j*Te,O=O*se+J*Te,H=H*se+ie*Te,W=W*se+fe*Te,se===1-S){let We=1/Math.sqrt(B*B+O*O+H*H+W*W);B*=We,O*=We,H*=We,W*=We}}r[a]=B,r[a+1]=O,r[a+2]=H,r[a+3]=W}static multiplyQuaternionsFlat(r,a,d,g,_,C){let S=d[g],B=d[g+1],O=d[g+2],H=d[g+3],W=_[C],j=_[C+1],J=_[C+2],ie=_[C+3];return r[a]=S*ie+H*W+B*J-O*j,r[a+1]=B*ie+H*j+O*W-S*J,r[a+2]=O*ie+H*J+S*j-B*W,r[a+3]=H*ie-S*W-B*j-O*J,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,a,d,g){return this._x=r,this._y=a,this._z=d,this._w=g,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,a){let d=r._x,g=r._y,_=r._z,C=r._order,S=Math.cos,B=Math.sin,O=S(d/2),H=S(g/2),W=S(_/2),j=B(d/2),J=B(g/2),ie=B(_/2);switch(C){case"XYZ":this._x=j*H*W+O*J*ie,this._y=O*J*W-j*H*ie,this._z=O*H*ie+j*J*W,this._w=O*H*W-j*J*ie;break;case"YXZ":this._x=j*H*W+O*J*ie,this._y=O*J*W-j*H*ie,this._z=O*H*ie-j*J*W,this._w=O*H*W+j*J*ie;break;case"ZXY":this._x=j*H*W-O*J*ie,this._y=O*J*W+j*H*ie,this._z=O*H*ie+j*J*W,this._w=O*H*W-j*J*ie;break;case"ZYX":this._x=j*H*W-O*J*ie,this._y=O*J*W+j*H*ie,this._z=O*H*ie-j*J*W,this._w=O*H*W+j*J*ie;break;case"YZX":this._x=j*H*W+O*J*ie,this._y=O*J*W+j*H*ie,this._z=O*H*ie-j*J*W,this._w=O*H*W-j*J*ie;break;case"XZY":this._x=j*H*W-O*J*ie,this._y=O*J*W-j*H*ie,this._z=O*H*ie+j*J*W,this._w=O*H*W+j*J*ie;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+C)}return a!==!1&&this._onChangeCallback(),this}setFromAxisAngle(r,a){let d=a/2,g=Math.sin(d);return this._x=r.x*g,this._y=r.y*g,this._z=r.z*g,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(r){let a=r.elements,d=a[0],g=a[4],_=a[8],C=a[1],S=a[5],B=a[9],O=a[2],H=a[6],W=a[10],j=d+S+W;if(j>0){let J=.5/Math.sqrt(j+1);this._w=.25/J,this._x=(H-B)*J,this._y=(_-O)*J,this._z=(C-g)*J}else if(d>S&&d>W){let J=2*Math.sqrt(1+d-S-W);this._w=(H-B)/J,this._x=.25*J,this._y=(g+C)/J,this._z=(_+O)/J}else if(S>W){let J=2*Math.sqrt(1+S-d-W);this._w=(_-O)/J,this._x=(g+C)/J,this._y=.25*J,this._z=(B+H)/J}else{let J=2*Math.sqrt(1+W-d-S);this._w=(C-g)/J,this._x=(_+O)/J,this._y=(B+H)/J,this._z=.25*J}return this._onChangeCallback(),this}setFromUnitVectors(r,a){let d=r.dot(a)+1;return d<Number.EPSILON?(d=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=d):(this._x=0,this._y=-r.z,this._z=r.y,this._w=d)):(this._x=r.y*a.z-r.z*a.y,this._y=r.z*a.x-r.x*a.z,this._z=r.x*a.y-r.y*a.x,this._w=d),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(es(this.dot(r),-1,1)))}rotateTowards(r,a){let d=this.angleTo(r);if(d===0)return this;let g=Math.min(1,a/d);return this.slerp(r,g),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r){return this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,a){let d=r._x,g=r._y,_=r._z,C=r._w,S=a._x,B=a._y,O=a._z,H=a._w;return this._x=d*H+C*S+g*O-_*B,this._y=g*H+C*B+_*S-d*O,this._z=_*H+C*O+d*B-g*S,this._w=C*H-d*S-g*B-_*O,this._onChangeCallback(),this}slerp(r,a){if(a===0)return this;if(a===1)return this.copy(r);let d=this._x,g=this._y,_=this._z,C=this._w,S=C*r._w+d*r._x+g*r._y+_*r._z;if(S<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,S=-S):this.copy(r),S>=1)return this._w=C,this._x=d,this._y=g,this._z=_,this;let B=1-S*S;if(B<=Number.EPSILON){let J=1-a;return this._w=J*C+a*this._w,this._x=J*d+a*this._x,this._y=J*g+a*this._y,this._z=J*_+a*this._z,this.normalize(),this._onChangeCallback(),this}let O=Math.sqrt(B),H=Math.atan2(O,S),W=Math.sin((1-a)*H)/O,j=Math.sin(a*H)/O;return this._w=C*W+this._w*j,this._x=d*W+this._x*j,this._y=g*W+this._y*j,this._z=_*W+this._z*j,this._onChangeCallback(),this}slerpQuaternions(r,a,d){return this.copy(r).slerp(a,d)}random(){let r=Math.random(),a=Math.sqrt(1-r),d=Math.sqrt(r),g=2*Math.PI*Math.random(),_=2*Math.PI*Math.random();return this.set(a*Math.cos(g),d*Math.sin(_),d*Math.cos(_),a*Math.sin(g))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,a=0){return this._x=r[a],this._y=r[a+1],this._z=r[a+2],this._w=r[a+3],this._onChangeCallback(),this}toArray(r=[],a=0){return r[a]=this._x,r[a+1]=this._y,r[a+2]=this._z,r[a+3]=this._w,r}fromBufferAttribute(r,a){return this._x=r.getX(a),this._y=r.getY(a),this._z=r.getZ(a),this._w=r.getW(a),this}toJSON(){return this.toArray()}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ye{constructor(r=0,a=0,d=0){Ye.prototype.isVector3=!0,this.x=r,this.y=a,this.z=d}set(r,a,d){return d===void 0&&(d=this.z),this.x=r,this.y=a,this.z=d,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this.z=r.z+a.z,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this.z+=r.z*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this.z=r.z-a.z,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this}multiplyVectors(r,a){return this.x=r.x*a.x,this.y=r.y*a.y,this.z=r.z*a.z,this}applyEuler(r){return this.applyQuaternion(lc.setFromEuler(r))}applyAxisAngle(r,a){return this.applyQuaternion(lc.setFromAxisAngle(r,a))}applyMatrix3(r){let a=this.x,d=this.y,g=this.z,_=r.elements;return this.x=_[0]*a+_[3]*d+_[6]*g,this.y=_[1]*a+_[4]*d+_[7]*g,this.z=_[2]*a+_[5]*d+_[8]*g,this}applyNormalMatrix(r){return this.applyMatrix3(r).normalize()}applyMatrix4(r){let a=this.x,d=this.y,g=this.z,_=r.elements,C=1/(_[3]*a+_[7]*d+_[11]*g+_[15]);return this.x=(_[0]*a+_[4]*d+_[8]*g+_[12])*C,this.y=(_[1]*a+_[5]*d+_[9]*g+_[13])*C,this.z=(_[2]*a+_[6]*d+_[10]*g+_[14])*C,this}applyQuaternion(r){let a=this.x,d=this.y,g=this.z,_=r.x,C=r.y,S=r.z,B=r.w,O=2*(C*g-S*d),H=2*(S*a-_*g),W=2*(_*d-C*a);return this.x=a+B*O+C*W-S*H,this.y=d+B*H+S*O-_*W,this.z=g+B*W+_*H-C*O,this}project(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)}unproject(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)}transformDirection(r){let a=this.x,d=this.y,g=this.z,_=r.elements;return this.x=_[0]*a+_[4]*d+_[8]*g,this.y=_[1]*a+_[5]*d+_[9]*g,this.z=_[2]*a+_[6]*d+_[10]*g,this.normalize()}divide(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this}divideScalar(r){return this.multiplyScalar(1/r)}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this.z=Math.max(r.z,Math.min(a.z,this.z)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this.z=Math.max(r,Math.min(a,this.z)),this}clampLength(r,a){let d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this.z+=(r.z-this.z)*a,this}lerpVectors(r,a,d){return this.x=r.x+(a.x-r.x)*d,this.y=r.y+(a.y-r.y)*d,this.z=r.z+(a.z-r.z)*d,this}cross(r){return this.crossVectors(this,r)}crossVectors(r,a){let d=r.x,g=r.y,_=r.z,C=a.x,S=a.y,B=a.z;return this.x=g*B-_*S,this.y=_*C-d*B,this.z=d*S-g*C,this}projectOnVector(r){let a=r.lengthSq();if(a===0)return this.set(0,0,0);let d=r.dot(this)/a;return this.copy(r).multiplyScalar(d)}projectOnPlane(r){return ns.copy(this).projectOnVector(r),this.sub(ns)}reflect(r){return this.sub(ns.copy(r).multiplyScalar(2*this.dot(r)))}angleTo(r){let a=Math.sqrt(this.lengthSq()*r.lengthSq());if(a===0)return Math.PI/2;let d=this.dot(r)/a;return Math.acos(es(d,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){let a=this.x-r.x,d=this.y-r.y,g=this.z-r.z;return a*a+d*d+g*g}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)}setFromSpherical(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)}setFromSphericalCoords(r,a,d){let g=Math.sin(a)*r;return this.x=g*Math.sin(d),this.y=Math.cos(a)*r,this.z=g*Math.cos(d),this}setFromCylindrical(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)}setFromCylindricalCoords(r,a,d){return this.x=r*Math.sin(a),this.y=d,this.z=r*Math.cos(a),this}setFromMatrixPosition(r){let a=r.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this}setFromMatrixScale(r){let a=this.setFromMatrixColumn(r,0).length(),d=this.setFromMatrixColumn(r,1).length(),g=this.setFromMatrixColumn(r,2).length();return this.x=a,this.y=d,this.z=g,this}setFromMatrixColumn(r,a){return this.fromArray(r.elements,a*4)}setFromMatrix3Column(r,a){return this.fromArray(r.elements,a*3)}setFromEuler(r){return this.x=r._x,this.y=r._y,this.z=r._z,this}setFromColor(r){return this.x=r.r,this.y=r.g,this.z=r.b,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this.z=r[a+2],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r[a+2]=this.z,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this.z=r.getZ(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let r=(Math.random()-.5)*2,a=Math.random()*Math.PI*2,d=Math.sqrt(1-r**2);return this.x=d*Math.cos(a),this.y=d*Math.sin(a),this.z=r,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let ns=new Ye,lc=new Ci;class rr{constructor(r=new Ye(1/0,1/0,1/0),a=new Ye(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=r,this.max=a}set(r,a){return this.min.copy(r),this.max.copy(a),this}setFromArray(r){this.makeEmpty();for(let a=0,d=r.length;a<d;a+=3)this.expandByPoint(Xs.fromArray(r,a));return this}setFromBufferAttribute(r){this.makeEmpty();for(let a=0,d=r.count;a<d;a++)this.expandByPoint(Xs.fromBufferAttribute(r,a));return this}setFromPoints(r){this.makeEmpty();for(let a=0,d=r.length;a<d;a++)this.expandByPoint(r[a]);return this}setFromCenterAndSize(r,a){let d=Xs.copy(a).multiplyScalar(.5);return this.min.copy(r).sub(d),this.max.copy(r).add(d),this}setFromObject(r,a=!1){return this.makeEmpty(),this.expandByObject(r,a)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,a=!1){r.updateWorldMatrix(!1,!1);let d=r.geometry;if(d!==void 0){let _=d.getAttribute("position");if(a===!0&&_!==void 0&&r.isInstancedMesh!==!0)for(let C=0,S=_.count;C<S;C++)r.isMesh===!0?r.getVertexPosition(C,Xs):Xs.fromBufferAttribute(_,C),Xs.applyMatrix4(r.matrixWorld),this.expandByPoint(Xs);else r.boundingBox!==void 0?(r.boundingBox===null&&r.computeBoundingBox(),ma.copy(r.boundingBox)):(d.boundingBox===null&&d.computeBoundingBox(),ma.copy(d.boundingBox)),ma.applyMatrix4(r.matrixWorld),this.union(ma)}let g=r.children;for(let _=0,C=g.length;_<C;_++)this.expandByObject(g[_],a);return this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,a){return a.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)}intersectsSphere(r){return this.clampPoint(r.center,Xs),Xs.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let a,d;return r.normal.x>0?(a=r.normal.x*this.min.x,d=r.normal.x*this.max.x):(a=r.normal.x*this.max.x,d=r.normal.x*this.min.x),r.normal.y>0?(a+=r.normal.y*this.min.y,d+=r.normal.y*this.max.y):(a+=r.normal.y*this.max.y,d+=r.normal.y*this.min.y),r.normal.z>0?(a+=r.normal.z*this.min.z,d+=r.normal.z*this.max.z):(a+=r.normal.z*this.max.z,d+=r.normal.z*this.min.z),a<=-r.constant&&d>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(Pr),Gi.subVectors(this.max,Pr),Us.subVectors(r.a,Pr),zi.subVectors(r.b,Pr),bo.subVectors(r.c,Pr),qo.subVectors(zi,Us),_s.subVectors(bo,zi),fr.subVectors(Us,bo);let a=[0,-qo.z,qo.y,0,-_s.z,_s.y,0,-fr.z,fr.y,qo.z,0,-qo.x,_s.z,0,-_s.x,fr.z,0,-fr.x,-qo.y,qo.x,0,-_s.y,_s.x,0,-fr.y,fr.x,0];return!uc(a,Us,zi,bo,Gi)||(a=[1,0,0,0,1,0,0,0,1],!uc(a,Us,zi,bo,Gi))?!1:(Rr.crossVectors(qo,_s),a=[Rr.x,Rr.y,Rr.z],uc(a,Us,zi,bo,Gi))}clampPoint(r,a){return a.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,Xs).distanceTo(r)}getBoundingSphere(r){return this.isEmpty()?r.makeEmpty():(this.getCenter(r.center),r.radius=this.getSize(Xs).length()*.5),r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(Fo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),Fo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),Fo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),Fo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),Fo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),Fo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),Fo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),Fo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(Fo),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}let Fo=[new Ye,new Ye,new Ye,new Ye,new Ye,new Ye,new Ye,new Ye],Xs=new Ye,ma=new rr,Us=new Ye,zi=new Ye,bo=new Ye,qo=new Ye,_s=new Ye,fr=new Ye,Pr=new Ye,Gi=new Ye,Rr=new Ye,bs=new Ye;function uc(b,r,a,d,g){for(let _=0,C=b.length-3;_<=C;_+=3){bs.fromArray(b,_);let S=g.x*Math.abs(bs.x)+g.y*Math.abs(bs.y)+g.z*Math.abs(bs.z),B=r.dot(bs),O=a.dot(bs),H=d.dot(bs);if(Math.max(-Math.max(B,O,H),Math.min(B,O,H))>S)return!1}return!0}let kp=new rr,Dl=new Ye,od=new Ye;class Uo{constructor(r=new Ye,a=-1){this.center=r,this.radius=a}set(r,a){return this.center.copy(r),this.radius=a,this}setFromPoints(r,a){let d=this.center;a!==void 0?d.copy(a):kp.setFromPoints(r).getCenter(d);let g=0;for(let _=0,C=r.length;_<C;_++)g=Math.max(g,d.distanceToSquared(r[_]));return this.radius=Math.sqrt(g),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){let a=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=a*a}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,a){let d=this.center.distanceToSquared(r);return a.copy(r),d>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){if(this.isEmpty())return this.center.copy(r),this.radius=0,this;Dl.subVectors(r,this.center);let a=Dl.lengthSq();if(a>this.radius*this.radius){let d=Math.sqrt(a),g=(d-this.radius)*.5;this.center.addScaledVector(Dl,g/d),this.radius+=g}return this}union(r){return r.isEmpty()?this:this.isEmpty()?(this.copy(r),this):(this.center.equals(r.center)===!0?this.radius=Math.max(this.radius,r.radius):(od.subVectors(r.center,this.center).setLength(r.radius),this.expandByPoint(Dl.copy(r.center).add(od)),this.expandByPoint(Dl.copy(r.center).sub(od))),this)}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}}let ga=new Ye,Vp=new Ye,ad=new Ye,hc=new Ye,Hp=new Ye,cd=new Ye,co=new Ye;class lo{constructor(r=new Ye,a=new Ye(0,0,-1)){this.origin=r,this.direction=a}set(r,a){return this.origin.copy(r),this.direction.copy(a),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,a){return a.copy(this.origin).addScaledVector(this.direction,r)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,ga)),this}closestPointToPoint(r,a){a.subVectors(r,this.origin);let d=a.dot(this.direction);return d<0?a.copy(this.origin):a.copy(this.origin).addScaledVector(this.direction,d)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){let a=ga.subVectors(r,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(r):(ga.copy(this.origin).addScaledVector(this.direction,a),ga.distanceToSquared(r))}distanceSqToSegment(r,a,d,g){Vp.copy(r).add(a).multiplyScalar(.5),ad.copy(a).sub(r).normalize(),hc.copy(this.origin).sub(Vp);let _=r.distanceTo(a)*.5,C=-this.direction.dot(ad),S=hc.dot(this.direction),B=-hc.dot(ad),O=hc.lengthSq(),H=Math.abs(1-C*C),W,j,J,ie;if(H>0)if(W=C*B-S,j=C*S-B,ie=_*H,W>=0)if(j>=-ie)if(j<=ie){let fe=1/H;W*=fe,j*=fe,J=W*(W+C*j+2*S)+j*(C*W+j+2*B)+O}else j=_,W=Math.max(0,-(C*j+S)),J=-W*W+j*(j+2*B)+O;else j=-_,W=Math.max(0,-(C*j+S)),J=-W*W+j*(j+2*B)+O;else j<=-ie?(W=Math.max(0,-(-C*_+S)),j=W>0?-_:Math.min(Math.max(-_,-B),_),J=-W*W+j*(j+2*B)+O):j<=ie?(W=0,j=Math.min(Math.max(-_,-B),_),J=j*(j+2*B)+O):(W=Math.max(0,-(C*_+S)),j=W>0?_:Math.min(Math.max(-_,-B),_),J=-W*W+j*(j+2*B)+O);else j=C>0?-_:_,W=Math.max(0,-(C*j+S)),J=-W*W+j*(j+2*B)+O;return d&&d.copy(this.origin).addScaledVector(this.direction,W),g&&g.copy(Vp).addScaledVector(ad,j),J}intersectSphere(r,a){ga.subVectors(r.center,this.origin);let d=ga.dot(this.direction),g=ga.dot(ga)-d*d,_=r.radius*r.radius;if(g>_)return null;let C=Math.sqrt(_-g),S=d-C,B=d+C;return B<0?null:S<0?this.at(B,a):this.at(S,a)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){let a=r.normal.dot(this.direction);if(a===0)return r.distanceToPoint(this.origin)===0?0:null;let d=-(this.origin.dot(r.normal)+r.constant)/a;return d>=0?d:null}intersectPlane(r,a){let d=this.distanceToPlane(r);return d===null?null:this.at(d,a)}intersectsPlane(r){let a=r.distanceToPoint(this.origin);return a===0||r.normal.dot(this.direction)*a<0}intersectBox(r,a){let d,g,_,C,S,B,O=1/this.direction.x,H=1/this.direction.y,W=1/this.direction.z,j=this.origin;return O>=0?(d=(r.min.x-j.x)*O,g=(r.max.x-j.x)*O):(d=(r.max.x-j.x)*O,g=(r.min.x-j.x)*O),H>=0?(_=(r.min.y-j.y)*H,C=(r.max.y-j.y)*H):(_=(r.max.y-j.y)*H,C=(r.min.y-j.y)*H),d>C||_>g||((_>d||isNaN(d))&&(d=_),(C<g||isNaN(g))&&(g=C),W>=0?(S=(r.min.z-j.z)*W,B=(r.max.z-j.z)*W):(S=(r.max.z-j.z)*W,B=(r.min.z-j.z)*W),d>B||S>g)||((S>d||d!==d)&&(d=S),(B<g||g!==g)&&(g=B),g<0)?null:this.at(d>=0?d:g,a)}intersectsBox(r){return this.intersectBox(r,ga)!==null}intersectTriangle(r,a,d,g,_){Hp.subVectors(a,r),cd.subVectors(d,r),co.crossVectors(Hp,cd);let C=this.direction.dot(co),S;if(C>0){if(g)return null;S=1}else if(C<0)S=-1,C=-C;else return null;hc.subVectors(this.origin,r);let B=S*this.direction.dot(cd.crossVectors(hc,cd));if(B<0)return null;let O=S*this.direction.dot(Hp.cross(hc));if(O<0||B+O>C)return null;let H=-S*hc.dot(co);return H<0?null:this.at(H/C,_)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class _i{constructor(r,a,d,g,_,C,S,B,O,H,W,j,J,ie,fe,se){_i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r!==void 0&&this.set(r,a,d,g,_,C,S,B,O,H,W,j,J,ie,fe,se)}set(r,a,d,g,_,C,S,B,O,H,W,j,J,ie,fe,se){let K=this.elements;return K[0]=r,K[4]=a,K[8]=d,K[12]=g,K[1]=_,K[5]=C,K[9]=S,K[13]=B,K[2]=O,K[6]=H,K[10]=W,K[14]=j,K[3]=J,K[7]=ie,K[11]=fe,K[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new _i().fromArray(this.elements)}copy(r){let a=this.elements,d=r.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],this}copyPosition(r){let a=this.elements,d=r.elements;return a[12]=d[12],a[13]=d[13],a[14]=d[14],this}setFromMatrix3(r){let a=r.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this}extractBasis(r,a,d){return r.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(r,a,d){return this.set(r.x,a.x,d.x,0,r.y,a.y,d.y,0,r.z,a.z,d.z,0,0,0,0,1),this}extractRotation(r){let a=this.elements,d=r.elements,g=1/Bc.setFromMatrixColumn(r,0).length(),_=1/Bc.setFromMatrixColumn(r,1).length(),C=1/Bc.setFromMatrixColumn(r,2).length();return a[0]=d[0]*g,a[1]=d[1]*g,a[2]=d[2]*g,a[3]=0,a[4]=d[4]*_,a[5]=d[5]*_,a[6]=d[6]*_,a[7]=0,a[8]=d[8]*C,a[9]=d[9]*C,a[10]=d[10]*C,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromEuler(r){let a=this.elements,d=r.x,g=r.y,_=r.z,C=Math.cos(d),S=Math.sin(d),B=Math.cos(g),O=Math.sin(g),H=Math.cos(_),W=Math.sin(_);if(r.order==="XYZ"){let j=C*H,J=C*W,ie=S*H,fe=S*W;a[0]=B*H,a[4]=-B*W,a[8]=O,a[1]=J+ie*O,a[5]=j-fe*O,a[9]=-S*B,a[2]=fe-j*O,a[6]=ie+J*O,a[10]=C*B}else if(r.order==="YXZ"){let j=B*H,J=B*W,ie=O*H,fe=O*W;a[0]=j+fe*S,a[4]=ie*S-J,a[8]=C*O,a[1]=C*W,a[5]=C*H,a[9]=-S,a[2]=J*S-ie,a[6]=fe+j*S,a[10]=C*B}else if(r.order==="ZXY"){let j=B*H,J=B*W,ie=O*H,fe=O*W;a[0]=j-fe*S,a[4]=-C*W,a[8]=ie+J*S,a[1]=J+ie*S,a[5]=C*H,a[9]=fe-j*S,a[2]=-C*O,a[6]=S,a[10]=C*B}else if(r.order==="ZYX"){let j=C*H,J=C*W,ie=S*H,fe=S*W;a[0]=B*H,a[4]=ie*O-J,a[8]=j*O+fe,a[1]=B*W,a[5]=fe*O+j,a[9]=J*O-ie,a[2]=-O,a[6]=S*B,a[10]=C*B}else if(r.order==="YZX"){let j=C*B,J=C*O,ie=S*B,fe=S*O;a[0]=B*H,a[4]=fe-j*W,a[8]=ie*W+J,a[1]=W,a[5]=C*H,a[9]=-S*H,a[2]=-O*H,a[6]=J*W+ie,a[10]=j-fe*W}else if(r.order==="XZY"){let j=C*B,J=C*O,ie=S*B,fe=S*O;a[0]=B*H,a[4]=-W,a[8]=O*H,a[1]=j*W+fe,a[5]=C*H,a[9]=J*W-ie,a[2]=ie*W-J,a[6]=S*H,a[10]=fe*W+j}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(r){return this.compose(c4,r,l4)}lookAt(r,a,d){let g=this.elements;return Yo.subVectors(r,a),Yo.lengthSq()===0&&(Yo.z=1),Yo.normalize(),Ll.crossVectors(d,Yo),Ll.lengthSq()===0&&(Math.abs(d.z)===1?Yo.x+=1e-4:Yo.z+=1e-4,Yo.normalize(),Ll.crossVectors(d,Yo)),Ll.normalize(),p0.crossVectors(Yo,Ll),g[0]=Ll.x,g[4]=p0.x,g[8]=Yo.x,g[1]=Ll.y,g[5]=p0.y,g[9]=Yo.y,g[2]=Ll.z,g[6]=p0.z,g[10]=Yo.z,this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,a){let d=r.elements,g=a.elements,_=this.elements,C=d[0],S=d[4],B=d[8],O=d[12],H=d[1],W=d[5],j=d[9],J=d[13],ie=d[2],fe=d[6],se=d[10],K=d[14],Pe=d[3],ve=d[7],Te=d[11],We=d[15],qe=g[0],st=g[4],lt=g[8],Ve=g[12],Ke=g[1],ct=g[5],Dt=g[9],Qt=g[13],dt=g[2],wt=g[6],Kt=g[10],$t=g[14],un=g[3],Zt=g[7],An=g[11],gn=g[15];return _[0]=C*qe+S*Ke+B*dt+O*un,_[4]=C*st+S*ct+B*wt+O*Zt,_[8]=C*lt+S*Dt+B*Kt+O*An,_[12]=C*Ve+S*Qt+B*$t+O*gn,_[1]=H*qe+W*Ke+j*dt+J*un,_[5]=H*st+W*ct+j*wt+J*Zt,_[9]=H*lt+W*Dt+j*Kt+J*An,_[13]=H*Ve+W*Qt+j*$t+J*gn,_[2]=ie*qe+fe*Ke+se*dt+K*un,_[6]=ie*st+fe*ct+se*wt+K*Zt,_[10]=ie*lt+fe*Dt+se*Kt+K*An,_[14]=ie*Ve+fe*Qt+se*$t+K*gn,_[3]=Pe*qe+ve*Ke+Te*dt+We*un,_[7]=Pe*st+ve*ct+Te*wt+We*Zt,_[11]=Pe*lt+ve*Dt+Te*Kt+We*An,_[15]=Pe*Ve+ve*Qt+Te*$t+We*gn,this}multiplyScalar(r){let a=this.elements;return a[0]*=r,a[4]*=r,a[8]*=r,a[12]*=r,a[1]*=r,a[5]*=r,a[9]*=r,a[13]*=r,a[2]*=r,a[6]*=r,a[10]*=r,a[14]*=r,a[3]*=r,a[7]*=r,a[11]*=r,a[15]*=r,this}determinant(){let r=this.elements,a=r[0],d=r[4],g=r[8],_=r[12],C=r[1],S=r[5],B=r[9],O=r[13],H=r[2],W=r[6],j=r[10],J=r[14],ie=r[3],fe=r[7],se=r[11],K=r[15];return ie*(+_*B*W-g*O*W-_*S*j+d*O*j+g*S*J-d*B*J)+fe*(+a*B*J-a*O*j+_*C*j-g*C*J+g*O*H-_*B*H)+se*(+a*O*W-a*S*J-_*C*W+d*C*J+_*S*H-d*O*H)+K*(-g*S*H-a*B*W+a*S*j+g*C*W-d*C*j+d*B*H)}transpose(){let r=this.elements,a;return a=r[1],r[1]=r[4],r[4]=a,a=r[2],r[2]=r[8],r[8]=a,a=r[6],r[6]=r[9],r[9]=a,a=r[3],r[3]=r[12],r[12]=a,a=r[7],r[7]=r[13],r[13]=a,a=r[11],r[11]=r[14],r[14]=a,this}setPosition(r,a,d){let g=this.elements;return r.isVector3?(g[12]=r.x,g[13]=r.y,g[14]=r.z):(g[12]=r,g[13]=a,g[14]=d),this}invert(){let r=this.elements,a=r[0],d=r[1],g=r[2],_=r[3],C=r[4],S=r[5],B=r[6],O=r[7],H=r[8],W=r[9],j=r[10],J=r[11],ie=r[12],fe=r[13],se=r[14],K=r[15],Pe=W*se*O-fe*j*O+fe*B*J-S*se*J-W*B*K+S*j*K,ve=ie*j*O-H*se*O-ie*B*J+C*se*J+H*B*K-C*j*K,Te=H*fe*O-ie*W*O+ie*S*J-C*fe*J-H*S*K+C*W*K,We=ie*W*B-H*fe*B-ie*S*j+C*fe*j+H*S*se-C*W*se,qe=a*Pe+d*ve+g*Te+_*We;if(qe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let st=1/qe;return r[0]=Pe*st,r[1]=(fe*j*_-W*se*_-fe*g*J+d*se*J+W*g*K-d*j*K)*st,r[2]=(S*se*_-fe*B*_+fe*g*O-d*se*O-S*g*K+d*B*K)*st,r[3]=(W*B*_-S*j*_-W*g*O+d*j*O+S*g*J-d*B*J)*st,r[4]=ve*st,r[5]=(H*se*_-ie*j*_+ie*g*J-a*se*J-H*g*K+a*j*K)*st,r[6]=(ie*B*_-C*se*_-ie*g*O+a*se*O+C*g*K-a*B*K)*st,r[7]=(C*j*_-H*B*_+H*g*O-a*j*O-C*g*J+a*B*J)*st,r[8]=Te*st,r[9]=(ie*W*_-H*fe*_-ie*d*J+a*fe*J+H*d*K-a*W*K)*st,r[10]=(C*fe*_-ie*S*_+ie*d*O-a*fe*O-C*d*K+a*S*K)*st,r[11]=(H*S*_-C*W*_-H*d*O+a*W*O+C*d*J-a*S*J)*st,r[12]=We*st,r[13]=(H*fe*g-ie*W*g+ie*d*j-a*fe*j-H*d*se+a*W*se)*st,r[14]=(ie*S*g-C*fe*g-ie*d*B+a*fe*B+C*d*se-a*S*se)*st,r[15]=(C*W*g-H*S*g+H*d*B-a*W*B-C*d*j+a*S*j)*st,this}scale(r){let a=this.elements,d=r.x,g=r.y,_=r.z;return a[0]*=d,a[4]*=g,a[8]*=_,a[1]*=d,a[5]*=g,a[9]*=_,a[2]*=d,a[6]*=g,a[10]*=_,a[3]*=d,a[7]*=g,a[11]*=_,this}getMaxScaleOnAxis(){let r=this.elements,a=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],d=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],g=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(a,d,g))}makeTranslation(r,a,d){return r.isVector3?this.set(1,0,0,r.x,0,1,0,r.y,0,0,1,r.z,0,0,0,1):this.set(1,0,0,r,0,1,0,a,0,0,1,d,0,0,0,1),this}makeRotationX(r){let a=Math.cos(r),d=Math.sin(r);return this.set(1,0,0,0,0,a,-d,0,0,d,a,0,0,0,0,1),this}makeRotationY(r){let a=Math.cos(r),d=Math.sin(r);return this.set(a,0,d,0,0,1,0,0,-d,0,a,0,0,0,0,1),this}makeRotationZ(r){let a=Math.cos(r),d=Math.sin(r);return this.set(a,-d,0,0,d,a,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(r,a){let d=Math.cos(a),g=Math.sin(a),_=1-d,C=r.x,S=r.y,B=r.z,O=_*C,H=_*S;return this.set(O*C+d,O*S-g*B,O*B+g*S,0,O*S+g*B,H*S+d,H*B-g*C,0,O*B-g*S,H*B+g*C,_*B*B+d,0,0,0,0,1),this}makeScale(r,a,d){return this.set(r,0,0,0,0,a,0,0,0,0,d,0,0,0,0,1),this}makeShear(r,a,d,g,_,C){return this.set(1,d,_,0,r,1,C,0,a,g,1,0,0,0,0,1),this}compose(r,a,d){let g=this.elements,_=a._x,C=a._y,S=a._z,B=a._w,O=_+_,H=C+C,W=S+S,j=_*O,J=_*H,ie=_*W,fe=C*H,se=C*W,K=S*W,Pe=B*O,ve=B*H,Te=B*W,We=d.x,qe=d.y,st=d.z;return g[0]=(1-(fe+K))*We,g[1]=(J+Te)*We,g[2]=(ie-ve)*We,g[3]=0,g[4]=(J-Te)*qe,g[5]=(1-(j+K))*qe,g[6]=(se+Pe)*qe,g[7]=0,g[8]=(ie+ve)*st,g[9]=(se-Pe)*st,g[10]=(1-(j+fe))*st,g[11]=0,g[12]=r.x,g[13]=r.y,g[14]=r.z,g[15]=1,this}decompose(r,a,d){let g=this.elements,_=Bc.set(g[0],g[1],g[2]).length(),C=Bc.set(g[4],g[5],g[6]).length(),S=Bc.set(g[8],g[9],g[10]).length();this.determinant()<0&&(_=-_),r.x=g[12],r.y=g[13],r.z=g[14],Va.copy(this);let O=1/_,H=1/C,W=1/S;return Va.elements[0]*=O,Va.elements[1]*=O,Va.elements[2]*=O,Va.elements[4]*=H,Va.elements[5]*=H,Va.elements[6]*=H,Va.elements[8]*=W,Va.elements[9]*=W,Va.elements[10]*=W,a.setFromRotationMatrix(Va),d.x=_,d.y=C,d.z=S,this}makePerspective(r,a,d,g,_,C,S=pa){let B=this.elements,O=2*_/(a-r),H=2*_/(d-g),W=(a+r)/(a-r),j=(d+g)/(d-g),J,ie;if(S===pa)J=-(C+_)/(C-_),ie=-2*C*_/(C-_);else if(S===Nu)J=-C/(C-_),ie=-C*_/(C-_);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+S);return B[0]=O,B[4]=0,B[8]=W,B[12]=0,B[1]=0,B[5]=H,B[9]=j,B[13]=0,B[2]=0,B[6]=0,B[10]=J,B[14]=ie,B[3]=0,B[7]=0,B[11]=-1,B[15]=0,this}makeOrthographic(r,a,d,g,_,C,S=pa){let B=this.elements,O=1/(a-r),H=1/(d-g),W=1/(C-_),j=(a+r)*O,J=(d+g)*H,ie,fe;if(S===pa)ie=(C+_)*W,fe=-2*W;else if(S===Nu)ie=_*W,fe=-1*W;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+S);return B[0]=2*O,B[4]=0,B[8]=0,B[12]=-j,B[1]=0,B[5]=2*H,B[9]=0,B[13]=-J,B[2]=0,B[6]=0,B[10]=fe,B[14]=-ie,B[3]=0,B[7]=0,B[11]=0,B[15]=1,this}equals(r){let a=this.elements,d=r.elements;for(let g=0;g<16;g++)if(a[g]!==d[g])return!1;return!0}fromArray(r,a=0){for(let d=0;d<16;d++)this.elements[d]=r[d+a];return this}toArray(r=[],a=0){let d=this.elements;return r[a]=d[0],r[a+1]=d[1],r[a+2]=d[2],r[a+3]=d[3],r[a+4]=d[4],r[a+5]=d[5],r[a+6]=d[6],r[a+7]=d[7],r[a+8]=d[8],r[a+9]=d[9],r[a+10]=d[10],r[a+11]=d[11],r[a+12]=d[12],r[a+13]=d[13],r[a+14]=d[14],r[a+15]=d[15],r}}let Bc=new Ye,Va=new _i,c4=new Ye(0,0,0),l4=new Ye(1,1,1),Ll=new Ye,p0=new Ye,Yo=new Ye,x2=new _i,E2=new Ci,_2=(()=>{class b{constructor(a=0,d=0,g=0,_=b.DEFAULT_ORDER){this.isEuler=!0,this._x=a,this._y=d,this._z=g,this._order=_}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a,this._onChangeCallback()}set(a,d,g,_=this._order){return this._x=a,this._y=d,this._z=g,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this}setFromRotationMatrix(a,d=this._order,g=!0){let _=a.elements,C=_[0],S=_[4],B=_[8],O=_[1],H=_[5],W=_[9],j=_[2],J=_[6],ie=_[10];switch(d){case"XYZ":this._y=Math.asin(es(B,-1,1)),Math.abs(B)<.9999999?(this._x=Math.atan2(-W,ie),this._z=Math.atan2(-S,C)):(this._x=Math.atan2(J,H),this._z=0);break;case"YXZ":this._x=Math.asin(-es(W,-1,1)),Math.abs(W)<.9999999?(this._y=Math.atan2(B,ie),this._z=Math.atan2(O,H)):(this._y=Math.atan2(-j,C),this._z=0);break;case"ZXY":this._x=Math.asin(es(J,-1,1)),Math.abs(J)<.9999999?(this._y=Math.atan2(-j,ie),this._z=Math.atan2(-S,H)):(this._y=0,this._z=Math.atan2(O,C));break;case"ZYX":this._y=Math.asin(-es(j,-1,1)),Math.abs(j)<.9999999?(this._x=Math.atan2(J,ie),this._z=Math.atan2(O,C)):(this._x=0,this._z=Math.atan2(-S,H));break;case"YZX":this._z=Math.asin(es(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-W,H),this._y=Math.atan2(-j,C)):(this._x=0,this._y=Math.atan2(B,ie));break;case"XZY":this._z=Math.asin(-es(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(J,H),this._y=Math.atan2(B,C)):(this._x=Math.atan2(-W,ie),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+d)}return this._order=d,g===!0&&this._onChangeCallback(),this}setFromQuaternion(a,d,g){return x2.makeRotationFromQuaternion(a),this.setFromRotationMatrix(x2,d,g)}setFromVector3(a,d=this._order){return this.set(a.x,a.y,a.z,d)}reorder(a){return E2.setFromEuler(this),this.setFromQuaternion(E2,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){return this._x=a[0],this._y=a[1],this._z=a[2],a[3]!==void 0&&(this._order=a[3]),this._onChangeCallback(),this}toArray(a=[],d=0){return a[d]=this._x,a[d+1]=this._y,a[d+2]=this._z,a[d+3]=this._order,a}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return b.DEFAULT_ORDER="XYZ",b})();class m0{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}}let u4=0,b2=new Ye,ld=new Ci,Oc=new _i,g0=new Ye,zp=new Ye,h4=new Ye,d4=new Ci,M2=new Ye(1,0,0),w2=new Ye(0,1,0),C2=new Ye(0,0,1),f4={type:"added"},p4={type:"removed"},Kr=(()=>{class b extends Eo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:u4++}),this.uuid=_o(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=b.DEFAULT_UP.clone();let a=new Ye,d=new _2,g=new Ci,_=new Ye(1,1,1);function C(){g.setFromEuler(d,!1)}function S(){d.setFromQuaternion(g,void 0,!1)}d._onChange(C),g._onChange(S),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:d},quaternion:{configurable:!0,enumerable:!0,value:g},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new _i},normalMatrix:{value:new Oi}}),this.matrix=new _i,this.matrixWorld=new _i,this.matrixAutoUpdate=b.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=b.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new m0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){return this.quaternion.premultiply(a),this}setRotationFromAxisAngle(a,d){this.quaternion.setFromAxisAngle(a,d)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,d){return ld.setFromAxisAngle(a,d),this.quaternion.multiply(ld),this}rotateOnWorldAxis(a,d){return ld.setFromAxisAngle(a,d),this.quaternion.premultiply(ld),this}rotateX(a){return this.rotateOnAxis(M2,a)}rotateY(a){return this.rotateOnAxis(w2,a)}rotateZ(a){return this.rotateOnAxis(C2,a)}translateOnAxis(a,d){return b2.copy(a).applyQuaternion(this.quaternion),this.position.add(b2.multiplyScalar(d)),this}translateX(a){return this.translateOnAxis(M2,a)}translateY(a){return this.translateOnAxis(w2,a)}translateZ(a){return this.translateOnAxis(C2,a)}localToWorld(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(this.matrixWorld)}worldToLocal(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(Oc.copy(this.matrixWorld).invert())}lookAt(a,d,g){a.isVector3?g0.copy(a):g0.set(a,d,g);let _=this.parent;this.updateWorldMatrix(!0,!1),zp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Oc.lookAt(zp,g0,this.up):Oc.lookAt(g0,zp,this.up),this.quaternion.setFromRotationMatrix(Oc),_&&(Oc.extractRotation(_.matrixWorld),ld.setFromRotationMatrix(Oc),this.quaternion.premultiply(ld.invert()))}add(a){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.add(arguments[d]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a&&a.isObject3D?(a.parent!==null&&a.parent.remove(a),a.parent=this,this.children.push(a),a.dispatchEvent(f4)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)}remove(a){if(arguments.length>1){for(let g=0;g<arguments.length;g++)this.remove(arguments[g]);return this}let d=this.children.indexOf(a);return d!==-1&&(a.parent=null,this.children.splice(d,1),a.dispatchEvent(p4)),this}removeFromParent(){let a=this.parent;return a!==null&&a.remove(this),this}clear(){return this.remove(...this.children)}attach(a){return this.updateWorldMatrix(!0,!1),Oc.copy(this.matrixWorld).invert(),a.parent!==null&&(a.parent.updateWorldMatrix(!0,!1),Oc.multiply(a.parent.matrixWorld)),a.applyMatrix4(Oc),this.add(a),a.updateWorldMatrix(!1,!0),this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,d){if(this[a]===d)return this;for(let g=0,_=this.children.length;g<_;g++){let S=this.children[g].getObjectByProperty(a,d);if(S!==void 0)return S}}getObjectsByProperty(a,d){let g=[];this[a]===d&&g.push(this);for(let _=0,C=this.children.length;_<C;_++){let S=this.children[_].getObjectsByProperty(a,d);S.length>0&&(g=g.concat(S))}return g}getWorldPosition(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zp,a,h4),a}getWorldScale(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zp,d4,a),a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);let d=this.matrixWorld.elements;return a.set(d[8],d[9],d[10]).normalize()}raycast(){}traverse(a){a(this);let d=this.children;for(let g=0,_=d.length;g<_;g++)d[g].traverse(a)}traverseVisible(a){if(this.visible===!1)return;a(this);let d=this.children;for(let g=0,_=d.length;g<_;g++)d[g].traverseVisible(a)}traverseAncestors(a){let d=this.parent;d!==null&&(a(d),d.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);let d=this.children;for(let g=0,_=d.length;g<_;g++){let C=d[g];(C.matrixWorldAutoUpdate===!0||a===!0)&&C.updateMatrixWorld(a)}}updateWorldMatrix(a,d){let g=this.parent;if(a===!0&&g!==null&&g.matrixWorldAutoUpdate===!0&&g.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),d===!0){let _=this.children;for(let C=0,S=_.length;C<S;C++){let B=_[C];B.matrixWorldAutoUpdate===!0&&B.updateWorldMatrix(!1,!0)}}}toJSON(a){let d=a===void 0||typeof a=="string",g={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},g.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let _={};_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),this.castShadow===!0&&(_.castShadow=!0),this.receiveShadow===!0&&(_.receiveShadow=!0),this.visible===!1&&(_.visible=!1),this.frustumCulled===!1&&(_.frustumCulled=!1),this.renderOrder!==0&&(_.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),_.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(_.instanceColor=this.instanceColor.toJSON()));function C(B,O){return B[O.uuid]===void 0&&(B[O.uuid]=O.toJSON(a)),O.uuid}if(this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(_.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=C(a.geometries,this.geometry);let B=this.geometry.parameters;if(B!==void 0&&B.shapes!==void 0){let O=B.shapes;if(Array.isArray(O))for(let H=0,W=O.length;H<W;H++){let j=O[H];C(a.shapes,j)}else C(a.shapes,O)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(C(a.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let B=[];for(let O=0,H=this.material.length;O<H;O++)B.push(C(a.materials,this.material[O]));_.material=B}else _.material=C(a.materials,this.material);if(this.children.length>0){_.children=[];for(let B=0;B<this.children.length;B++)_.children.push(this.children[B].toJSON(a).object)}if(this.animations.length>0){_.animations=[];for(let B=0;B<this.animations.length;B++){let O=this.animations[B];_.animations.push(C(a.animations,O))}}if(d){let B=S(a.geometries),O=S(a.materials),H=S(a.textures),W=S(a.images),j=S(a.shapes),J=S(a.skeletons),ie=S(a.animations),fe=S(a.nodes);B.length>0&&(g.geometries=B),O.length>0&&(g.materials=O),H.length>0&&(g.textures=H),W.length>0&&(g.images=W),j.length>0&&(g.shapes=j),J.length>0&&(g.skeletons=J),ie.length>0&&(g.animations=ie),fe.length>0&&(g.nodes=fe)}return g.object=_,g;function S(B){let O=[];for(let H in B){let W=B[H];delete W.metadata,O.push(W)}return O}}clone(a){return new this.constructor().copy(this,a)}copy(a,d=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.animations=a.animations.slice(),this.userData=JSON.parse(JSON.stringify(a.userData)),d===!0)for(let g=0;g<a.children.length;g++){let _=a.children[g];this.add(_.clone())}return this}}return b.DEFAULT_UP=new Ye(0,1,0),b.DEFAULT_MATRIX_AUTO_UPDATE=!0,b.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,b})(),Ha=new Ye,Nc=new Ye,t_=new Ye,Fc=new Ye,ud=new Ye,hd=new Ye,S2=new Ye,n_=new Ye,i_=new Ye,r_=new Ye,A0=!1;class ko{constructor(r=new Ye,a=new Ye,d=new Ye){this.a=r,this.b=a,this.c=d}static getNormal(r,a,d,g){g.subVectors(d,a),Ha.subVectors(r,a),g.cross(Ha);let _=g.lengthSq();return _>0?g.multiplyScalar(1/Math.sqrt(_)):g.set(0,0,0)}static getBarycoord(r,a,d,g,_){Ha.subVectors(g,a),Nc.subVectors(d,a),t_.subVectors(r,a);let C=Ha.dot(Ha),S=Ha.dot(Nc),B=Ha.dot(t_),O=Nc.dot(Nc),H=Nc.dot(t_),W=C*O-S*S;if(W===0)return _.set(-2,-1,-1);let j=1/W,J=(O*B-S*H)*j,ie=(C*H-S*B)*j;return _.set(1-J-ie,ie,J)}static containsPoint(r,a,d,g){return this.getBarycoord(r,a,d,g,Fc),Fc.x>=0&&Fc.y>=0&&Fc.x+Fc.y<=1}static getUV(r,a,d,g,_,C,S,B){return A0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),A0=!0),this.getInterpolation(r,a,d,g,_,C,S,B)}static getInterpolation(r,a,d,g,_,C,S,B){return this.getBarycoord(r,a,d,g,Fc),B.setScalar(0),B.addScaledVector(_,Fc.x),B.addScaledVector(C,Fc.y),B.addScaledVector(S,Fc.z),B}static isFrontFacing(r,a,d,g){return Ha.subVectors(d,a),Nc.subVectors(r,a),Ha.cross(Nc).dot(g)<0}set(r,a,d){return this.a.copy(r),this.b.copy(a),this.c.copy(d),this}setFromPointsAndIndices(r,a,d,g){return this.a.copy(r[a]),this.b.copy(r[d]),this.c.copy(r[g]),this}setFromAttributeAndIndices(r,a,d,g){return this.a.fromBufferAttribute(r,a),this.b.fromBufferAttribute(r,d),this.c.fromBufferAttribute(r,g),this}clone(){return new this.constructor().copy(this)}copy(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this}getArea(){return Ha.subVectors(this.c,this.b),Nc.subVectors(this.a,this.b),Ha.cross(Nc).length()*.5}getMidpoint(r){return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(r){return ko.getNormal(this.a,this.b,this.c,r)}getPlane(r){return r.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(r,a){return ko.getBarycoord(r,this.a,this.b,this.c,a)}getUV(r,a,d,g,_){return A0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),A0=!0),ko.getInterpolation(r,this.a,this.b,this.c,a,d,g,_)}getInterpolation(r,a,d,g,_){return ko.getInterpolation(r,this.a,this.b,this.c,a,d,g,_)}containsPoint(r){return ko.containsPoint(r,this.a,this.b,this.c)}isFrontFacing(r){return ko.isFrontFacing(this.a,this.b,this.c,r)}intersectsBox(r){return r.intersectsTriangle(this)}closestPointToPoint(r,a){let d=this.a,g=this.b,_=this.c,C,S;ud.subVectors(g,d),hd.subVectors(_,d),n_.subVectors(r,d);let B=ud.dot(n_),O=hd.dot(n_);if(B<=0&&O<=0)return a.copy(d);i_.subVectors(r,g);let H=ud.dot(i_),W=hd.dot(i_);if(H>=0&&W<=H)return a.copy(g);let j=B*W-H*O;if(j<=0&&B>=0&&H<=0)return C=B/(B-H),a.copy(d).addScaledVector(ud,C);r_.subVectors(r,_);let J=ud.dot(r_),ie=hd.dot(r_);if(ie>=0&&J<=ie)return a.copy(_);let fe=J*O-B*ie;if(fe<=0&&O>=0&&ie<=0)return S=O/(O-ie),a.copy(d).addScaledVector(hd,S);let se=H*ie-J*W;if(se<=0&&W-H>=0&&J-ie>=0)return S2.subVectors(_,g),S=(W-H)/(W-H+(J-ie)),a.copy(g).addScaledVector(S2,S);let K=1/(se+fe+j);return C=fe*K,S=j*K,a.copy(d).addScaledVector(ud,C).addScaledVector(hd,S)}equals(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)}}let T2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pl={h:0,s:0,l:0},v0={h:0,s:0,l:0};function s_(b,r,a){return a<0&&(a+=1),a>1&&(a-=1),a<.16666666666666666?b+(r-b)*6*a:a<.5?r:a<.6666666666666666?b+(r-b)*6*(.6666666666666666-a):b}class jn{constructor(r,a,d){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(r,a,d)}set(r,a,d){if(a===void 0&&d===void 0){let g=r;g&&g.isColor?this.copy(g):typeof g=="number"?this.setHex(g):typeof g=="string"&&this.setStyle(g)}else this.setRGB(r,a,d);return this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r,a=Gr){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,Ir.toWorkingColorSpace(this,a),this}setRGB(r,a,d,g=Ir.workingColorSpace){return this.r=r,this.g=a,this.b=d,Ir.toWorkingColorSpace(this,g),this}setHSL(r,a,d,g=Ir.workingColorSpace){if(r=Op(r,1),a=es(a,0,1),d=es(d,0,1),a===0)this.r=this.g=this.b=d;else{let _=d<=.5?d*(1+a):d+a-d*a,C=2*d-_;this.r=s_(C,_,r+.3333333333333333),this.g=s_(C,_,r),this.b=s_(C,_,r-.3333333333333333)}return Ir.toWorkingColorSpace(this,g),this}setStyle(r,a=Gr){function d(_){_!==void 0&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let g;if(g=/^(\w+)\(([^\)]*)\)/.exec(r)){let _,C=g[1],S=g[2];switch(C){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(S))return d(_[4]),this.setRGB(Math.min(255,parseInt(_[1],10))/255,Math.min(255,parseInt(_[2],10))/255,Math.min(255,parseInt(_[3],10))/255,a);if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(S))return d(_[4]),this.setRGB(Math.min(100,parseInt(_[1],10))/100,Math.min(100,parseInt(_[2],10))/100,Math.min(100,parseInt(_[3],10))/100,a);break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(S))return d(_[4]),this.setHSL(parseFloat(_[1])/360,parseFloat(_[2])/100,parseFloat(_[3])/100,a);break;default:console.warn("THREE.Color: Unknown color model "+r)}}else if(g=/^\#([A-Fa-f\d]+)$/.exec(r)){let _=g[1],C=_.length;if(C===3)return this.setRGB(parseInt(_.charAt(0),16)/15,parseInt(_.charAt(1),16)/15,parseInt(_.charAt(2),16)/15,a);if(C===6)return this.setHex(parseInt(_,16),a);console.warn("THREE.Color: Invalid hex color "+r)}else if(r&&r.length>0)return this.setColorName(r,a);return this}setColorName(r,a=Gr){let d=T2[r.toLowerCase()];return d!==void 0?this.setHex(d,a):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=Rl(r.r),this.g=Rl(r.g),this.b=Rl(r.b),this}copyLinearToSRGB(r){return this.r=Up(r.r),this.g=Up(r.g),this.b=Up(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(r=Gr){return Ir.fromWorkingColorSpace(uo.copy(this),r),Math.round(es(uo.r*255,0,255))*65536+Math.round(es(uo.g*255,0,255))*256+Math.round(es(uo.b*255,0,255))}getHexString(r=Gr){return("000000"+this.getHex(r).toString(16)).slice(-6)}getHSL(r,a=Ir.workingColorSpace){Ir.fromWorkingColorSpace(uo.copy(this),a);let d=uo.r,g=uo.g,_=uo.b,C=Math.max(d,g,_),S=Math.min(d,g,_),B,O,H=(S+C)/2;if(S===C)B=0,O=0;else{let W=C-S;switch(O=H<=.5?W/(C+S):W/(2-C-S),C){case d:B=(g-_)/W+(g<_?6:0);break;case g:B=(_-d)/W+2;break;case _:B=(d-g)/W+4;break}B/=6}return r.h=B,r.s=O,r.l=H,r}getRGB(r,a=Ir.workingColorSpace){return Ir.fromWorkingColorSpace(uo.copy(this),a),r.r=uo.r,r.g=uo.g,r.b=uo.b,r}getStyle(r=Gr){Ir.fromWorkingColorSpace(uo.copy(this),r);let a=uo.r,d=uo.g,g=uo.b;return r!==Gr?`color(${r} ${a.toFixed(3)} ${d.toFixed(3)} ${g.toFixed(3)})`:`rgb(${Math.round(a*255)},${Math.round(d*255)},${Math.round(g*255)})`}offsetHSL(r,a,d){return this.getHSL(Pl),this.setHSL(Pl.h+r,Pl.s+a,Pl.l+d)}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,a){return this.r=r.r+a.r,this.g=r.g+a.g,this.b=r.b+a.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,a){return this.r+=(r.r-this.r)*a,this.g+=(r.g-this.g)*a,this.b+=(r.b-this.b)*a,this}lerpColors(r,a,d){return this.r=r.r+(a.r-r.r)*d,this.g=r.g+(a.g-r.g)*d,this.b=r.b+(a.b-r.b)*d,this}lerpHSL(r,a){this.getHSL(Pl),r.getHSL(v0);let d=Fu(Pl.h,v0.h,a),g=Fu(Pl.s,v0.s,a),_=Fu(Pl.l,v0.l,a);return this.setHSL(d,g,_),this}setFromVector3(r){return this.r=r.x,this.g=r.y,this.b=r.z,this}applyMatrix3(r){let a=this.r,d=this.g,g=this.b,_=r.elements;return this.r=_[0]*a+_[3]*d+_[6]*g,this.g=_[1]*a+_[4]*d+_[7]*g,this.b=_[2]*a+_[5]*d+_[8]*g,this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,a=0){return this.r=r[a],this.g=r[a+1],this.b=r[a+2],this}toArray(r=[],a=0){return r[a]=this.r,r[a+1]=this.g,r[a+2]=this.b,r}fromBufferAttribute(r,a){return this.r=r.getX(a),this.g=r.getY(a),this.b=r.getZ(a),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let uo=new jn;jn.NAMES=T2;let m4=0;class ho extends Eo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:m4++}),this.uuid=_o(),this.name="",this.type="Material",this.blending=I,this.side=w,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Me,this.blendDst=xe,this.blendEquation=$,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new jn(0,0,0),this.blendAlpha=0,this.depthFunc=Vt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Pp,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Rc,this.stencilZFail=Rc,this.stencilZPass=Rc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(let a in r){let d=r[a];if(d===void 0){console.warn(`THREE.Material: parameter '${a}' has value of undefined.`);continue}let g=this[a];if(g===void 0){console.warn(`THREE.Material: '${a}' is not a property of THREE.${this.type}.`);continue}g&&g.isColor?g.set(d):g&&g.isVector3&&d&&d.isVector3?g.copy(d):this[a]=d}}toJSON(r){let a=r===void 0||typeof r=="string";a&&(r={textures:{},images:{}});let d={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid,d.type=this.type,this.name!==""&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),this.roughness!==void 0&&(d.roughness=this.roughness),this.metalness!==void 0&&(d.metalness=this.metalness),this.sheen!==void 0&&(d.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(d.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(d.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(d.shininess=this.shininess),this.clearcoat!==void 0&&(d.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(d.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(d.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(d.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(d.iridescenceMap=this.iridescenceMap.toJSON(r).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(d.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(r).uuid),this.anisotropy!==void 0&&(d.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(d.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(d.anisotropyMap=this.anisotropyMap.toJSON(r).uuid),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(r).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(r).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(r).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(r).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(r).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(d.combine=this.combine)),this.envMapIntensity!==void 0&&(d.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(d.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(d.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(d.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(d.size=this.size),this.shadowSide!==null&&(d.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(d.sizeAttenuation=this.sizeAttenuation),this.blending!==I&&(d.blending=this.blending),this.side!==w&&(d.side=this.side),this.vertexColors===!0&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),this.transparent===!0&&(d.transparent=!0),this.blendSrc!==Me&&(d.blendSrc=this.blendSrc),this.blendDst!==xe&&(d.blendDst=this.blendDst),this.blendEquation!==$&&(d.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(d.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(d.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(d.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(d.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(d.blendAlpha=this.blendAlpha),this.depthFunc!==Vt&&(d.depthFunc=this.depthFunc),this.depthTest===!1&&(d.depthTest=this.depthTest),this.depthWrite===!1&&(d.depthWrite=this.depthWrite),this.colorWrite===!1&&(d.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(d.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Pp&&(d.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(d.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(d.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Rc&&(d.stencilFail=this.stencilFail),this.stencilZFail!==Rc&&(d.stencilZFail=this.stencilZFail),this.stencilZPass!==Rc&&(d.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(d.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(d.rotation=this.rotation),this.polygonOffset===!0&&(d.polygonOffset=!0),this.polygonOffsetFactor!==0&&(d.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(d.linewidth=this.linewidth),this.dashSize!==void 0&&(d.dashSize=this.dashSize),this.gapSize!==void 0&&(d.gapSize=this.gapSize),this.scale!==void 0&&(d.scale=this.scale),this.dithering===!0&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),this.alphaHash===!0&&(d.alphaHash=!0),this.alphaToCoverage===!0&&(d.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(d.premultipliedAlpha=!0),this.forceSinglePass===!0&&(d.forceSinglePass=!0),this.wireframe===!0&&(d.wireframe=!0),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(d.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(d.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(d.flatShading=!0),this.visible===!1&&(d.visible=!1),this.toneMapped===!1&&(d.toneMapped=!1),this.fog===!1&&(d.fog=!1),Object.keys(this.userData).length>0&&(d.userData=this.userData);function g(_){let C=[];for(let S in _){let B=_[S];delete B.metadata,C.push(B)}return C}if(a){let _=g(r.textures),C=g(r.images);_.length>0&&(d.textures=_),C.length>0&&(d.images=C)}return d}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.blendColor.copy(r.blendColor),this.blendAlpha=r.blendAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;let a=r.clippingPlanes,d=null;if(a!==null){let g=a.length;d=new Array(g);for(let _=0;_!==g;++_)d[_]=a[_].clone()}return this.clippingPlanes=d,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaHash=r.alphaHash,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.forceSinglePass=r.forceSinglePass,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}}class Bl extends ho{constructor(r){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new jn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}}let Uc=g4();function g4(){let b=new ArrayBuffer(4),r=new Float32Array(b),a=new Uint32Array(b),d=new Uint32Array(512),g=new Uint32Array(512);for(let B=0;B<256;++B){let O=B-127;O<-27?(d[B]=0,d[B|256]=32768,g[B]=24,g[B|256]=24):O<-14?(d[B]=1024>>-O-14,d[B|256]=1024>>-O-14|32768,g[B]=-O-1,g[B|256]=-O-1):O<=15?(d[B]=O+15<<10,d[B|256]=O+15<<10|32768,g[B]=13,g[B|256]=13):O<128?(d[B]=31744,d[B|256]=64512,g[B]=24,g[B|256]=24):(d[B]=31744,d[B|256]=64512,g[B]=13,g[B|256]=13)}let _=new Uint32Array(2048),C=new Uint32Array(64),S=new Uint32Array(64);for(let B=1;B<1024;++B){let O=B<<13,H=0;for(;!(O&8388608);)O<<=1,H-=8388608;O&=-8388609,H+=947912704,_[B]=O|H}for(let B=1024;B<2048;++B)_[B]=939524096+(B-1024<<13);for(let B=1;B<31;++B)C[B]=B<<23;C[31]=1199570944,C[32]=2147483648;for(let B=33;B<63;++B)C[B]=2147483648+(B-32<<23);C[63]=3347054592;for(let B=1;B<64;++B)B!==32&&(S[B]=1024);return{floatView:r,uint32View:a,baseTable:d,shiftTable:g,mantissaTable:_,exponentTable:C,offsetTable:S}}function Vo(b){Math.abs(b)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),b=es(b,-65504,65504),Uc.floatView[0]=b;let r=Uc.uint32View[0],a=r>>23&511;return Uc.baseTable[a]+((r&8388607)>>Uc.shiftTable[a])}function Gp(b){let r=b>>10;return Uc.uint32View[0]=Uc.mantissaTable[Uc.offsetTable[r]+(b&1023)]+Uc.exponentTable[r],Uc.floatView[0]}let A4={toHalfFloat:Vo,fromHalfFloat:Gp},gs=new Ye,y0=new nn;class Wr{constructor(r,a,d=!1){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=r,this.itemSize=a,this.count=r!==void 0?r.length/a:0,this.normalized=d,this.usage=Ou,this.updateRange={offset:0,count:-1},this.gpuType=fi,this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this.gpuType=r.gpuType,this}copyAt(r,a,d){r*=this.itemSize,d*=a.itemSize;for(let g=0,_=this.itemSize;g<_;g++)this.array[r+g]=a.array[d+g];return this}copyArray(r){return this.array.set(r),this}applyMatrix3(r){if(this.itemSize===2)for(let a=0,d=this.count;a<d;a++)y0.fromBufferAttribute(this,a),y0.applyMatrix3(r),this.setXY(a,y0.x,y0.y);else if(this.itemSize===3)for(let a=0,d=this.count;a<d;a++)gs.fromBufferAttribute(this,a),gs.applyMatrix3(r),this.setXYZ(a,gs.x,gs.y,gs.z);return this}applyMatrix4(r){for(let a=0,d=this.count;a<d;a++)gs.fromBufferAttribute(this,a),gs.applyMatrix4(r),this.setXYZ(a,gs.x,gs.y,gs.z);return this}applyNormalMatrix(r){for(let a=0,d=this.count;a<d;a++)gs.fromBufferAttribute(this,a),gs.applyNormalMatrix(r),this.setXYZ(a,gs.x,gs.y,gs.z);return this}transformDirection(r){for(let a=0,d=this.count;a<d;a++)gs.fromBufferAttribute(this,a),gs.transformDirection(r),this.setXYZ(a,gs.x,gs.y,gs.z);return this}set(r,a=0){return this.array.set(r,a),this}getComponent(r,a){let d=this.array[r*this.itemSize+a];return this.normalized&&(d=ao(d,this.array)),d}setComponent(r,a,d){return this.normalized&&(d=Bi(d,this.array)),this.array[r*this.itemSize+a]=d,this}getX(r){let a=this.array[r*this.itemSize];return this.normalized&&(a=ao(a,this.array)),a}setX(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize]=a,this}getY(r){let a=this.array[r*this.itemSize+1];return this.normalized&&(a=ao(a,this.array)),a}setY(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+1]=a,this}getZ(r){let a=this.array[r*this.itemSize+2];return this.normalized&&(a=ao(a,this.array)),a}setZ(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+2]=a,this}getW(r){let a=this.array[r*this.itemSize+3];return this.normalized&&(a=ao(a,this.array)),a}setW(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+3]=a,this}setXY(r,a,d){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array)),this.array[r+0]=a,this.array[r+1]=d,this}setXYZ(r,a,d,g){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array)),this.array[r+0]=a,this.array[r+1]=d,this.array[r+2]=g,this}setXYZW(r,a,d,g,_){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array),_=Bi(_,this.array)),this.array[r+0]=a,this.array[r+1]=d,this.array[r+2]=g,this.array[r+3]=_,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==Ou&&(r.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(r.updateRange=this.updateRange),r}}class v4 extends Wr{constructor(r,a,d){super(new Int8Array(r),a,d)}}class y4 extends Wr{constructor(r,a,d){super(new Uint8Array(r),a,d)}}class x4 extends Wr{constructor(r,a,d){super(new Uint8ClampedArray(r),a,d)}}class E4 extends Wr{constructor(r,a,d){super(new Int16Array(r),a,d)}}class o_ extends Wr{constructor(r,a,d){super(new Uint16Array(r),a,d)}}class _4 extends Wr{constructor(r,a,d){super(new Int32Array(r),a,d)}}class a_ extends Wr{constructor(r,a,d){super(new Uint32Array(r),a,d)}}class b4 extends Wr{constructor(r,a,d){super(new Uint16Array(r),a,d),this.isFloat16BufferAttribute=!0}getX(r){let a=Gp(this.array[r*this.itemSize]);return this.normalized&&(a=ao(a,this.array)),a}setX(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize]=Vo(a),this}getY(r){let a=Gp(this.array[r*this.itemSize+1]);return this.normalized&&(a=ao(a,this.array)),a}setY(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+1]=Vo(a),this}getZ(r){let a=Gp(this.array[r*this.itemSize+2]);return this.normalized&&(a=ao(a,this.array)),a}setZ(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+2]=Vo(a),this}getW(r){let a=Gp(this.array[r*this.itemSize+3]);return this.normalized&&(a=ao(a,this.array)),a}setW(r,a){return this.normalized&&(a=Bi(a,this.array)),this.array[r*this.itemSize+3]=Vo(a),this}setXY(r,a,d){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array)),this.array[r+0]=Vo(a),this.array[r+1]=Vo(d),this}setXYZ(r,a,d,g){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array)),this.array[r+0]=Vo(a),this.array[r+1]=Vo(d),this.array[r+2]=Vo(g),this}setXYZW(r,a,d,g,_){return r*=this.itemSize,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array),_=Bi(_,this.array)),this.array[r+0]=Vo(a),this.array[r+1]=Vo(d),this.array[r+2]=Vo(g),this.array[r+3]=Vo(_),this}}class ni extends Wr{constructor(r,a,d){super(new Float32Array(r),a,d)}}class M4 extends Wr{constructor(r,a,d){super(new Float64Array(r),a,d)}}let w4=0,Aa=new _i,c_=new Kr,dd=new Ye,Ko=new rr,Wp=new rr,ks=new Ye;class Zi extends Eo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:w4++}),this.uuid=_o(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(r){return Array.isArray(r)?this.index=new(a0(r)?a_:o_)(r,1):this.index=r,this}getAttribute(r){return this.attributes[r]}setAttribute(r,a){return this.attributes[r]=a,this}deleteAttribute(r){return delete this.attributes[r],this}hasAttribute(r){return this.attributes[r]!==void 0}addGroup(r,a,d=0){this.groups.push({start:r,count:a,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(r,a){this.drawRange.start=r,this.drawRange.count=a}applyMatrix4(r){let a=this.attributes.position;a!==void 0&&(a.applyMatrix4(r),a.needsUpdate=!0);let d=this.attributes.normal;if(d!==void 0){let _=new Oi().getNormalMatrix(r);d.applyNormalMatrix(_),d.needsUpdate=!0}let g=this.attributes.tangent;return g!==void 0&&(g.transformDirection(r),g.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(r){return Aa.makeRotationFromQuaternion(r),this.applyMatrix4(Aa),this}rotateX(r){return Aa.makeRotationX(r),this.applyMatrix4(Aa),this}rotateY(r){return Aa.makeRotationY(r),this.applyMatrix4(Aa),this}rotateZ(r){return Aa.makeRotationZ(r),this.applyMatrix4(Aa),this}translate(r,a,d){return Aa.makeTranslation(r,a,d),this.applyMatrix4(Aa),this}scale(r,a,d){return Aa.makeScale(r,a,d),this.applyMatrix4(Aa),this}lookAt(r){return c_.lookAt(r),c_.updateMatrix(),this.applyMatrix4(c_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(dd).negate(),this.translate(dd.x,dd.y,dd.z),this}setFromPoints(r){let a=[];for(let d=0,g=r.length;d<g;d++){let _=r[d];a.push(_.x,_.y,_.z||0)}return this.setAttribute("position",new ni(a,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new rr);let r=this.attributes.position,a=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ye(-1/0,-1/0,-1/0),new Ye(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),a)for(let d=0,g=a.length;d<g;d++){let _=a[d];Ko.setFromBufferAttribute(_),this.morphTargetsRelative?(ks.addVectors(this.boundingBox.min,Ko.min),this.boundingBox.expandByPoint(ks),ks.addVectors(this.boundingBox.max,Ko.max),this.boundingBox.expandByPoint(ks)):(this.boundingBox.expandByPoint(Ko.min),this.boundingBox.expandByPoint(Ko.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Uo);let r=this.attributes.position,a=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ye,1/0);return}if(r){let d=this.boundingSphere.center;if(Ko.setFromBufferAttribute(r),a)for(let _=0,C=a.length;_<C;_++){let S=a[_];Wp.setFromBufferAttribute(S),this.morphTargetsRelative?(ks.addVectors(Ko.min,Wp.min),Ko.expandByPoint(ks),ks.addVectors(Ko.max,Wp.max),Ko.expandByPoint(ks)):(Ko.expandByPoint(Wp.min),Ko.expandByPoint(Wp.max))}Ko.getCenter(d);let g=0;for(let _=0,C=r.count;_<C;_++)ks.fromBufferAttribute(r,_),g=Math.max(g,d.distanceToSquared(ks));if(a)for(let _=0,C=a.length;_<C;_++){let S=a[_],B=this.morphTargetsRelative;for(let O=0,H=S.count;O<H;O++)ks.fromBufferAttribute(S,O),B&&(dd.fromBufferAttribute(r,O),ks.add(dd)),g=Math.max(g,d.distanceToSquared(ks))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let r=this.index,a=this.attributes;if(r===null||a.position===void 0||a.normal===void 0||a.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let d=r.array,g=a.position.array,_=a.normal.array,C=a.uv.array,S=g.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Wr(new Float32Array(4*S),4));let B=this.getAttribute("tangent").array,O=[],H=[];for(let Ke=0;Ke<S;Ke++)O[Ke]=new Ye,H[Ke]=new Ye;let W=new Ye,j=new Ye,J=new Ye,ie=new nn,fe=new nn,se=new nn,K=new Ye,Pe=new Ye;function ve(Ke,ct,Dt){W.fromArray(g,Ke*3),j.fromArray(g,ct*3),J.fromArray(g,Dt*3),ie.fromArray(C,Ke*2),fe.fromArray(C,ct*2),se.fromArray(C,Dt*2),j.sub(W),J.sub(W),fe.sub(ie),se.sub(ie);let Qt=1/(fe.x*se.y-se.x*fe.y);isFinite(Qt)&&(K.copy(j).multiplyScalar(se.y).addScaledVector(J,-fe.y).multiplyScalar(Qt),Pe.copy(J).multiplyScalar(fe.x).addScaledVector(j,-se.x).multiplyScalar(Qt),O[Ke].add(K),O[ct].add(K),O[Dt].add(K),H[Ke].add(Pe),H[ct].add(Pe),H[Dt].add(Pe))}let Te=this.groups;Te.length===0&&(Te=[{start:0,count:d.length}]);for(let Ke=0,ct=Te.length;Ke<ct;++Ke){let Dt=Te[Ke],Qt=Dt.start,dt=Dt.count;for(let wt=Qt,Kt=Qt+dt;wt<Kt;wt+=3)ve(d[wt+0],d[wt+1],d[wt+2])}let We=new Ye,qe=new Ye,st=new Ye,lt=new Ye;function Ve(Ke){st.fromArray(_,Ke*3),lt.copy(st);let ct=O[Ke];We.copy(ct),We.sub(st.multiplyScalar(st.dot(ct))).normalize(),qe.crossVectors(lt,ct);let Qt=qe.dot(H[Ke])<0?-1:1;B[Ke*4]=We.x,B[Ke*4+1]=We.y,B[Ke*4+2]=We.z,B[Ke*4+3]=Qt}for(let Ke=0,ct=Te.length;Ke<ct;++Ke){let Dt=Te[Ke],Qt=Dt.start,dt=Dt.count;for(let wt=Qt,Kt=Qt+dt;wt<Kt;wt+=3)Ve(d[wt+0]),Ve(d[wt+1]),Ve(d[wt+2])}}computeVertexNormals(){let r=this.index,a=this.getAttribute("position");if(a!==void 0){let d=this.getAttribute("normal");if(d===void 0)d=new Wr(new Float32Array(a.count*3),3),this.setAttribute("normal",d);else for(let j=0,J=d.count;j<J;j++)d.setXYZ(j,0,0,0);let g=new Ye,_=new Ye,C=new Ye,S=new Ye,B=new Ye,O=new Ye,H=new Ye,W=new Ye;if(r)for(let j=0,J=r.count;j<J;j+=3){let ie=r.getX(j+0),fe=r.getX(j+1),se=r.getX(j+2);g.fromBufferAttribute(a,ie),_.fromBufferAttribute(a,fe),C.fromBufferAttribute(a,se),H.subVectors(C,_),W.subVectors(g,_),H.cross(W),S.fromBufferAttribute(d,ie),B.fromBufferAttribute(d,fe),O.fromBufferAttribute(d,se),S.add(H),B.add(H),O.add(H),d.setXYZ(ie,S.x,S.y,S.z),d.setXYZ(fe,B.x,B.y,B.z),d.setXYZ(se,O.x,O.y,O.z)}else for(let j=0,J=a.count;j<J;j+=3)g.fromBufferAttribute(a,j+0),_.fromBufferAttribute(a,j+1),C.fromBufferAttribute(a,j+2),H.subVectors(C,_),W.subVectors(g,_),H.cross(W),d.setXYZ(j+0,H.x,H.y,H.z),d.setXYZ(j+1,H.x,H.y,H.z),d.setXYZ(j+2,H.x,H.y,H.z);this.normalizeNormals(),d.needsUpdate=!0}}normalizeNormals(){let r=this.attributes.normal;for(let a=0,d=r.count;a<d;a++)ks.fromBufferAttribute(r,a),ks.normalize(),r.setXYZ(a,ks.x,ks.y,ks.z)}toNonIndexed(){function r(S,B){let O=S.array,H=S.itemSize,W=S.normalized,j=new O.constructor(B.length*H),J=0,ie=0;for(let fe=0,se=B.length;fe<se;fe++){S.isInterleavedBufferAttribute?J=B[fe]*S.data.stride+S.offset:J=B[fe]*H;for(let K=0;K<H;K++)j[ie++]=O[J++]}return new Wr(j,H,W)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let a=new Zi,d=this.index.array,g=this.attributes;for(let S in g){let B=g[S],O=r(B,d);a.setAttribute(S,O)}let _=this.morphAttributes;for(let S in _){let B=[],O=_[S];for(let H=0,W=O.length;H<W;H++){let j=O[H],J=r(j,d);B.push(J)}a.morphAttributes[S]=B}a.morphTargetsRelative=this.morphTargetsRelative;let C=this.groups;for(let S=0,B=C.length;S<B;S++){let O=C[S];a.addGroup(O.start,O.count,O.materialIndex)}return a}toJSON(){let r={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){let B=this.parameters;for(let O in B)B[O]!==void 0&&(r[O]=B[O]);return r}r.data={attributes:{}};let a=this.index;a!==null&&(r.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});let d=this.attributes;for(let B in d){let O=d[B];r.data.attributes[B]=O.toJSON(r.data)}let g={},_=!1;for(let B in this.morphAttributes){let O=this.morphAttributes[B],H=[];for(let W=0,j=O.length;W<j;W++){let J=O[W];H.push(J.toJSON(r.data))}H.length>0&&(g[B]=H,_=!0)}_&&(r.data.morphAttributes=g,r.data.morphTargetsRelative=this.morphTargetsRelative);let C=this.groups;C.length>0&&(r.data.groups=JSON.parse(JSON.stringify(C)));let S=this.boundingSphere;return S!==null&&(r.data.boundingSphere={center:S.center.toArray(),radius:S.radius}),r}clone(){return new this.constructor().copy(this)}copy(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let a={};this.name=r.name;let d=r.index;d!==null&&this.setIndex(d.clone(a));let g=r.attributes;for(let O in g){let H=g[O];this.setAttribute(O,H.clone(a))}let _=r.morphAttributes;for(let O in _){let H=[],W=_[O];for(let j=0,J=W.length;j<J;j++)H.push(W[j].clone(a));this.morphAttributes[O]=H}this.morphTargetsRelative=r.morphTargetsRelative;let C=r.groups;for(let O=0,H=C.length;O<H;O++){let W=C[O];this.addGroup(W.start,W.count,W.materialIndex)}let S=r.boundingBox;S!==null&&(this.boundingBox=S.clone());let B=r.boundingSphere;return B!==null&&(this.boundingSphere=B.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let I2=new _i,Vu=new lo,x0=new Uo,R2=new Ye,fd=new Ye,pd=new Ye,md=new Ye,l_=new Ye,E0=new Ye,_0=new nn,b0=new nn,M0=new nn,D2=new Ye,L2=new Ye,P2=new Ye,w0=new Ye,C0=new Ye;class qs extends Kr{constructor(r=new Zi,a=new Bl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=r,this.material=a,this.updateMorphTargets()}copy(r,a){return super.copy(r,a),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}updateMorphTargets(){let a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){let g=a[d[0]];if(g!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,C=g.length;_<C;_++){let S=g[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[S]=_}}}}getVertexPosition(r,a){let d=this.geometry,g=d.attributes.position,_=d.morphAttributes.position,C=d.morphTargetsRelative;a.fromBufferAttribute(g,r);let S=this.morphTargetInfluences;if(_&&S){E0.set(0,0,0);for(let B=0,O=_.length;B<O;B++){let H=S[B],W=_[B];H!==0&&(l_.fromBufferAttribute(W,r),C?E0.addScaledVector(l_,H):E0.addScaledVector(l_.sub(a),H))}a.add(E0)}return a}raycast(r,a){let d=this.geometry,g=this.material,_=this.matrixWorld;g!==void 0&&(d.boundingSphere===null&&d.computeBoundingSphere(),x0.copy(d.boundingSphere),x0.applyMatrix4(_),Vu.copy(r.ray).recast(r.near),!(x0.containsPoint(Vu.origin)===!1&&(Vu.intersectSphere(x0,R2)===null||Vu.origin.distanceToSquared(R2)>(r.far-r.near)**2))&&(I2.copy(_).invert(),Vu.copy(r.ray).applyMatrix4(I2),!(d.boundingBox!==null&&Vu.intersectsBox(d.boundingBox)===!1)&&this._computeIntersections(r,a,Vu)))}_computeIntersections(r,a,d){let g,_=this.geometry,C=this.material,S=_.index,B=_.attributes.position,O=_.attributes.uv,H=_.attributes.uv1,W=_.attributes.normal,j=_.groups,J=_.drawRange;if(S!==null)if(Array.isArray(C))for(let ie=0,fe=j.length;ie<fe;ie++){let se=j[ie],K=C[se.materialIndex],Pe=Math.max(se.start,J.start),ve=Math.min(S.count,Math.min(se.start+se.count,J.start+J.count));for(let Te=Pe,We=ve;Te<We;Te+=3){let qe=S.getX(Te),st=S.getX(Te+1),lt=S.getX(Te+2);g=S0(this,K,r,d,O,H,W,qe,st,lt),g&&(g.faceIndex=Math.floor(Te/3),g.face.materialIndex=se.materialIndex,a.push(g))}}else{let ie=Math.max(0,J.start),fe=Math.min(S.count,J.start+J.count);for(let se=ie,K=fe;se<K;se+=3){let Pe=S.getX(se),ve=S.getX(se+1),Te=S.getX(se+2);g=S0(this,C,r,d,O,H,W,Pe,ve,Te),g&&(g.faceIndex=Math.floor(se/3),a.push(g))}}else if(B!==void 0)if(Array.isArray(C))for(let ie=0,fe=j.length;ie<fe;ie++){let se=j[ie],K=C[se.materialIndex],Pe=Math.max(se.start,J.start),ve=Math.min(B.count,Math.min(se.start+se.count,J.start+J.count));for(let Te=Pe,We=ve;Te<We;Te+=3){let qe=Te,st=Te+1,lt=Te+2;g=S0(this,K,r,d,O,H,W,qe,st,lt),g&&(g.faceIndex=Math.floor(Te/3),g.face.materialIndex=se.materialIndex,a.push(g))}}else{let ie=Math.max(0,J.start),fe=Math.min(B.count,J.start+J.count);for(let se=ie,K=fe;se<K;se+=3){let Pe=se,ve=se+1,Te=se+2;g=S0(this,C,r,d,O,H,W,Pe,ve,Te),g&&(g.faceIndex=Math.floor(se/3),a.push(g))}}}}function C4(b,r,a,d,g,_,C,S){let B;if(r.side===M?B=d.intersectTriangle(C,_,g,!0,S):B=d.intersectTriangle(g,_,C,r.side===w,S),B===null)return null;C0.copy(S),C0.applyMatrix4(b.matrixWorld);let O=a.ray.origin.distanceTo(C0);return O<a.near||O>a.far?null:{distance:O,point:C0.clone(),object:b}}function S0(b,r,a,d,g,_,C,S,B,O){b.getVertexPosition(S,fd),b.getVertexPosition(B,pd),b.getVertexPosition(O,md);let H=C4(b,r,a,d,fd,pd,md,w0);if(H){g&&(_0.fromBufferAttribute(g,S),b0.fromBufferAttribute(g,B),M0.fromBufferAttribute(g,O),H.uv=ko.getInterpolation(w0,fd,pd,md,_0,b0,M0,new nn)),_&&(_0.fromBufferAttribute(_,S),b0.fromBufferAttribute(_,B),M0.fromBufferAttribute(_,O),H.uv1=ko.getInterpolation(w0,fd,pd,md,_0,b0,M0,new nn),H.uv2=H.uv1),C&&(D2.fromBufferAttribute(C,S),L2.fromBufferAttribute(C,B),P2.fromBufferAttribute(C,O),H.normal=ko.getInterpolation(w0,fd,pd,md,D2,L2,P2,new Ye),H.normal.dot(d.direction)>0&&H.normal.multiplyScalar(-1));let W={a:S,b:B,c:O,normal:new Ye,materialIndex:0};ko.getNormal(fd,pd,md,W.normal),H.face=W}return H}class Hu extends Zi{constructor(r=1,a=1,d=1,g=1,_=1,C=1){super(),this.type="BoxGeometry",this.parameters={width:r,height:a,depth:d,widthSegments:g,heightSegments:_,depthSegments:C};let S=this;g=Math.floor(g),_=Math.floor(_),C=Math.floor(C);let B=[],O=[],H=[],W=[],j=0,J=0;ie("z","y","x",-1,-1,d,a,r,C,_,0),ie("z","y","x",1,-1,d,a,-r,C,_,1),ie("x","z","y",1,1,r,d,a,g,C,2),ie("x","z","y",1,-1,r,d,-a,g,C,3),ie("x","y","z",1,-1,r,a,d,g,_,4),ie("x","y","z",-1,-1,r,a,-d,g,_,5),this.setIndex(B),this.setAttribute("position",new ni(O,3)),this.setAttribute("normal",new ni(H,3)),this.setAttribute("uv",new ni(W,2));function ie(fe,se,K,Pe,ve,Te,We,qe,st,lt,Ve){let Ke=Te/st,ct=We/lt,Dt=Te/2,Qt=We/2,dt=qe/2,wt=st+1,Kt=lt+1,$t=0,un=0,Zt=new Ye;for(let An=0;An<Kt;An++){let gn=An*ct-Qt;for(let Qn=0;Qn<wt;Qn++){let ji=Qn*Ke-Dt;Zt[fe]=ji*Pe,Zt[se]=gn*ve,Zt[K]=dt,O.push(Zt.x,Zt.y,Zt.z),Zt[fe]=0,Zt[se]=0,Zt[K]=qe>0?1:-1,H.push(Zt.x,Zt.y,Zt.z),W.push(Qn/st),W.push(1-An/lt),$t+=1}}for(let An=0;An<lt;An++)for(let gn=0;gn<st;gn++){let Qn=j+gn+wt*An,ji=j+gn+wt*(An+1),Ni=j+(gn+1)+wt*(An+1),Xt=j+(gn+1)+wt*An;B.push(Qn,ji,Xt),B.push(ji,Ni,Xt),un+=6}S.addGroup(J,un,Ve),J+=un,j+=$t}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Hu(r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments)}}function gd(b){let r={};for(let a in b){r[a]={};for(let d in b[a]){let g=b[a][d];g&&(g.isColor||g.isMatrix3||g.isMatrix4||g.isVector2||g.isVector3||g.isVector4||g.isTexture||g.isQuaternion)?g.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),r[a][d]=null):r[a][d]=g.clone():Array.isArray(g)?r[a][d]=g.slice():r[a][d]=g}}return r}function Mo(b){let r={};for(let a=0;a<b.length;a++){let d=gd(b[a]);for(let g in d)r[g]=d[g]}return r}function S4(b){let r=[];for(let a=0;a<b.length;a++)r.push(b[a].clone());return r}function B2(b){return b.getRenderTarget()===null?b.outputColorSpace:Ir.workingColorSpace}let O2={clone:gd,merge:Mo};var T4=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,I4=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class dc extends ho{constructor(r){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=T4,this.fragmentShader=I4,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&this.setValues(r)}copy(r){return super.copy(r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=gd(r.uniforms),this.uniformsGroups=S4(r.uniformsGroups),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.fog=r.fog,this.lights=r.lights,this.clipping=r.clipping,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this}toJSON(r){let a=super.toJSON(r);a.glslVersion=this.glslVersion,a.uniforms={};for(let g in this.uniforms){let C=this.uniforms[g].value;C&&C.isTexture?a.uniforms[g]={type:"t",value:C.toJSON(r).uuid}:C&&C.isColor?a.uniforms[g]={type:"c",value:C.getHex()}:C&&C.isVector2?a.uniforms[g]={type:"v2",value:C.toArray()}:C&&C.isVector3?a.uniforms[g]={type:"v3",value:C.toArray()}:C&&C.isVector4?a.uniforms[g]={type:"v4",value:C.toArray()}:C&&C.isMatrix3?a.uniforms[g]={type:"m3",value:C.toArray()}:C&&C.isMatrix4?a.uniforms[g]={type:"m4",value:C.toArray()}:a.uniforms[g]={value:C}}Object.keys(this.defines).length>0&&(a.defines=this.defines),a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader,a.lights=this.lights,a.clipping=this.clipping;let d={};for(let g in this.extensions)this.extensions[g]===!0&&(d[g]=!0);return Object.keys(d).length>0&&(a.extensions=d),a}}class T0 extends Kr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _i,this.projectionMatrix=new _i,this.projectionMatrixInverse=new _i,this.coordinateSystem=pa}copy(r,a){return super.copy(r,a),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this.coordinateSystem=r.coordinateSystem,this}getWorldDirection(r){return super.getWorldDirection(r).negate()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,a){super.updateWorldMatrix(r,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Ms extends T0{constructor(r=50,a=1,d=.1,g=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=d,this.far=g,this.focus=10,this.aspect=a,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,a){return super.copy(r,a),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){let a=.5*this.getFilmHeight()/r;this.fov=Tl*2*Math.atan(a),this.updateProjectionMatrix()}getFocalLength(){let r=Math.tan(Dc*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return Tl*2*Math.atan(Math.tan(Dc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(r,a,d,g,_,C){this.aspect=r/a,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=a,this.view.offsetX=d,this.view.offsetY=g,this.view.width=_,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let r=this.near,a=r*Math.tan(Dc*.5*this.fov)/this.zoom,d=2*a,g=this.aspect*d,_=-.5*g,C=this.view;if(this.view!==null&&this.view.enabled){let B=C.fullWidth,O=C.fullHeight;_+=C.offsetX*g/B,a-=C.offsetY*d/O,g*=C.width/B,d*=C.height/O}let S=this.filmOffset;S!==0&&(_+=r*S/this.getFilmWidth()),this.projectionMatrix.makePerspective(_,_+g,a,a-d,r,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){let a=super.toJSON(r);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,this.view!==null&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}}let Ad=-90,vd=1;class N2 extends Kr{constructor(r,a,d){super(),this.type="CubeCamera",this.renderTarget=d,this.coordinateSystem=null,this.activeMipmapLevel=0;let g=new Ms(Ad,vd,r,a);g.layers=this.layers,this.add(g);let _=new Ms(Ad,vd,r,a);_.layers=this.layers,this.add(_);let C=new Ms(Ad,vd,r,a);C.layers=this.layers,this.add(C);let S=new Ms(Ad,vd,r,a);S.layers=this.layers,this.add(S);let B=new Ms(Ad,vd,r,a);B.layers=this.layers,this.add(B);let O=new Ms(Ad,vd,r,a);O.layers=this.layers,this.add(O)}updateCoordinateSystem(){let r=this.coordinateSystem,a=this.children.concat(),[d,g,_,C,S,B]=a;for(let O of a)this.remove(O);if(r===pa)d.up.set(0,1,0),d.lookAt(1,0,0),g.up.set(0,1,0),g.lookAt(-1,0,0),_.up.set(0,0,-1),_.lookAt(0,1,0),C.up.set(0,0,1),C.lookAt(0,-1,0),S.up.set(0,1,0),S.lookAt(0,0,1),B.up.set(0,1,0),B.lookAt(0,0,-1);else if(r===Nu)d.up.set(0,-1,0),d.lookAt(-1,0,0),g.up.set(0,-1,0),g.lookAt(1,0,0),_.up.set(0,0,1),_.lookAt(0,1,0),C.up.set(0,0,-1),C.lookAt(0,-1,0),S.up.set(0,-1,0),S.lookAt(0,0,1),B.up.set(0,-1,0),B.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+r);for(let O of a)this.add(O),O.updateMatrixWorld()}update(r,a){this.parent===null&&this.updateMatrixWorld();let{renderTarget:d,activeMipmapLevel:g}=this;this.coordinateSystem!==r.coordinateSystem&&(this.coordinateSystem=r.coordinateSystem,this.updateCoordinateSystem());let[_,C,S,B,O,H]=this.children,W=r.getRenderTarget(),j=r.getActiveCubeFace(),J=r.getActiveMipmapLevel(),ie=r.xr.enabled;r.xr.enabled=!1;let fe=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,r.setRenderTarget(d,0,g),r.render(a,_),r.setRenderTarget(d,1,g),r.render(a,C),r.setRenderTarget(d,2,g),r.render(a,S),r.setRenderTarget(d,3,g),r.render(a,B),r.setRenderTarget(d,4,g),r.render(a,O),d.texture.generateMipmaps=fe,r.setRenderTarget(d,5,g),r.render(a,H),r.setRenderTarget(W,j,J),r.xr.enabled=ie,d.texture.needsPMREMUpdate=!0}}class jp extends Es{constructor(r,a,d,g,_,C,S,B,O,H){r=r!==void 0?r:[],a=a!==void 0?a:Ge,super(r,a,d,g,_,C,S,B,O,H),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(r){this.image=r}}class F2 extends No{constructor(r=1,a={}){super(r,r,a),this.isWebGLCubeRenderTarget=!0;let d={width:r,height:r,depth:1},g=[d,d,d,d,d,d];a.encoding!==void 0&&(ku("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=a.encoding===ai?Gr:ls),this.texture=new jp(g,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=a.generateMipmaps!==void 0?a.generateMipmaps:!1,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:_t}fromEquirectangularTexture(r,a){this.texture.type=a.type,this.texture.colorSpace=a.colorSpace,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter;let d={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},g=new Hu(5,5,5),_=new dc({name:"CubemapFromEquirect",uniforms:gd(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,side:M,blending:L});_.uniforms.tEquirect.value=a;let C=new qs(g,_),S=a.minFilter;return a.minFilter===Cn&&(a.minFilter=_t),new N2(1,10,this).update(r,C),a.minFilter=S,C.geometry.dispose(),C.material.dispose(),this}clear(r,a,d,g){let _=r.getRenderTarget();for(let C=0;C<6;C++)r.setRenderTarget(this,C),r.clear(a,d,g);r.setRenderTarget(_)}}let u_=new Ye,R4=new Ye,D4=new Oi;class Ol{constructor(r=new Ye(1,0,0),a=0){this.isPlane=!0,this.normal=r,this.constant=a}set(r,a){return this.normal.copy(r),this.constant=a,this}setComponents(r,a,d,g){return this.normal.set(r,a,d),this.constant=g,this}setFromNormalAndCoplanarPoint(r,a){return this.normal.copy(r),this.constant=-a.dot(this.normal),this}setFromCoplanarPoints(r,a,d){let g=u_.subVectors(d,a).cross(R4.subVectors(r,a)).normalize();return this.setFromNormalAndCoplanarPoint(g,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){let r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,a){return a.copy(r).addScaledVector(this.normal,-this.distanceToPoint(r))}intersectLine(r,a){let d=r.delta(u_),g=this.normal.dot(d);if(g===0)return this.distanceToPoint(r.start)===0?a.copy(r.start):null;let _=-(r.start.dot(this.normal)+this.constant)/g;return _<0||_>1?null:a.copy(r.start).addScaledVector(d,_)}intersectsLine(r){let a=this.distanceToPoint(r.start),d=this.distanceToPoint(r.end);return a<0&&d>0||d<0&&a>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,a){let d=a||D4.getNormalMatrix(r),g=this.coplanarPoint(u_).applyMatrix4(r),_=this.normal.applyMatrix3(d).normalize();return this.constant=-g.dot(_),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}}let zu=new Uo,I0=new Ye;class R0{constructor(r=new Ol,a=new Ol,d=new Ol,g=new Ol,_=new Ol,C=new Ol){this.planes=[r,a,d,g,_,C]}set(r,a,d,g,_,C){let S=this.planes;return S[0].copy(r),S[1].copy(a),S[2].copy(d),S[3].copy(g),S[4].copy(_),S[5].copy(C),this}copy(r){let a=this.planes;for(let d=0;d<6;d++)a[d].copy(r.planes[d]);return this}setFromProjectionMatrix(r,a=pa){let d=this.planes,g=r.elements,_=g[0],C=g[1],S=g[2],B=g[3],O=g[4],H=g[5],W=g[6],j=g[7],J=g[8],ie=g[9],fe=g[10],se=g[11],K=g[12],Pe=g[13],ve=g[14],Te=g[15];if(d[0].setComponents(B-_,j-O,se-J,Te-K).normalize(),d[1].setComponents(B+_,j+O,se+J,Te+K).normalize(),d[2].setComponents(B+C,j+H,se+ie,Te+Pe).normalize(),d[3].setComponents(B-C,j-H,se-ie,Te-Pe).normalize(),d[4].setComponents(B-S,j-W,se-fe,Te-ve).normalize(),a===pa)d[5].setComponents(B+S,j+W,se+fe,Te+ve).normalize();else if(a===Nu)d[5].setComponents(S,W,fe,ve).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+a);return this}intersectsObject(r){if(r.boundingSphere!==void 0)r.boundingSphere===null&&r.computeBoundingSphere(),zu.copy(r.boundingSphere).applyMatrix4(r.matrixWorld);else{let a=r.geometry;a.boundingSphere===null&&a.computeBoundingSphere(),zu.copy(a.boundingSphere).applyMatrix4(r.matrixWorld)}return this.intersectsSphere(zu)}intersectsSprite(r){return zu.center.set(0,0,0),zu.radius=.7071067811865476,zu.applyMatrix4(r.matrixWorld),this.intersectsSphere(zu)}intersectsSphere(r){let a=this.planes,d=r.center,g=-r.radius;for(let _=0;_<6;_++)if(a[_].distanceToPoint(d)<g)return!1;return!0}intersectsBox(r){let a=this.planes;for(let d=0;d<6;d++){let g=a[d];if(I0.x=g.normal.x>0?r.max.x:r.min.x,I0.y=g.normal.y>0?r.max.y:r.min.y,I0.z=g.normal.z>0?r.max.z:r.min.z,g.distanceToPoint(I0)<0)return!1}return!0}containsPoint(r){let a=this.planes;for(let d=0;d<6;d++)if(a[d].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function h_(){let b=null,r=!1,a=null,d=null;function g(_,C){a(_,C),d=b.requestAnimationFrame(g)}return{start:function(){r!==!0&&a!==null&&(d=b.requestAnimationFrame(g),r=!0)},stop:function(){b.cancelAnimationFrame(d),r=!1},setAnimationLoop:function(_){a=_},setContext:function(_){b=_}}}function L4(b,r){let a=r.isWebGL2,d=new WeakMap;function g(O,H){let W=O.array,j=O.usage,J=b.createBuffer();b.bindBuffer(H,J),b.bufferData(H,W,j),O.onUploadCallback();let ie;if(W instanceof Float32Array)ie=b.FLOAT;else if(W instanceof Uint16Array)if(O.isFloat16BufferAttribute)if(a)ie=b.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else ie=b.UNSIGNED_SHORT;else if(W instanceof Int16Array)ie=b.SHORT;else if(W instanceof Uint32Array)ie=b.UNSIGNED_INT;else if(W instanceof Int32Array)ie=b.INT;else if(W instanceof Int8Array)ie=b.BYTE;else if(W instanceof Uint8Array)ie=b.UNSIGNED_BYTE;else if(W instanceof Uint8ClampedArray)ie=b.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+W);return{buffer:J,type:ie,bytesPerElement:W.BYTES_PER_ELEMENT,version:O.version}}function _(O,H,W){let j=H.array,J=H.updateRange;b.bindBuffer(W,O),J.count===-1?b.bufferSubData(W,0,j):(a?b.bufferSubData(W,J.offset*j.BYTES_PER_ELEMENT,j,J.offset,J.count):b.bufferSubData(W,J.offset*j.BYTES_PER_ELEMENT,j.subarray(J.offset,J.offset+J.count)),J.count=-1),H.onUploadCallback()}function C(O){return O.isInterleavedBufferAttribute&&(O=O.data),d.get(O)}function S(O){O.isInterleavedBufferAttribute&&(O=O.data);let H=d.get(O);H&&(b.deleteBuffer(H.buffer),d.delete(O))}function B(O,H){if(O.isGLBufferAttribute){let j=d.get(O);(!j||j.version<O.version)&&d.set(O,{buffer:O.buffer,type:O.type,bytesPerElement:O.elementSize,version:O.version});return}O.isInterleavedBufferAttribute&&(O=O.data);let W=d.get(O);W===void 0?d.set(O,g(O,H)):W.version<O.version&&(_(W.buffer,O,H),W.version=O.version)}return{get:C,remove:S,update:B}}class Qp extends Zi{constructor(r=1,a=1,d=1,g=1){super(),this.type="PlaneGeometry",this.parameters={width:r,height:a,widthSegments:d,heightSegments:g};let _=r/2,C=a/2,S=Math.floor(d),B=Math.floor(g),O=S+1,H=B+1,W=r/S,j=a/B,J=[],ie=[],fe=[],se=[];for(let K=0;K<H;K++){let Pe=K*j-C;for(let ve=0;ve<O;ve++){let Te=ve*W-_;ie.push(Te,-Pe,0),fe.push(0,0,1),se.push(ve/S),se.push(1-K/B)}}for(let K=0;K<B;K++)for(let Pe=0;Pe<S;Pe++){let ve=Pe+O*K,Te=Pe+O*(K+1),We=Pe+1+O*(K+1),qe=Pe+1+O*K;J.push(ve,Te,qe),J.push(Te,We,qe)}this.setIndex(J),this.setAttribute("position",new ni(ie,3)),this.setAttribute("normal",new ni(fe,3)),this.setAttribute("uv",new ni(se,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Qp(r.width,r.height,r.widthSegments,r.heightSegments)}}var P4=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,B4=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,O4=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,N4=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,F4=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,U4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,k4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,V4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,H4=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,z4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,G4=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,W4=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,j4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Q4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,X4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,q4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Y4=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,K4=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,$4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,J4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Z4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,ek=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,tk=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,nk=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,ik=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rk=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,sk=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ok=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,ak="gl_FragColor = linearToOutputTexel( gl_FragColor );",ck=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,lk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,uk=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,hk=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,dk=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,fk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,pk=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,mk=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,gk=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Ak=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,vk=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,yk=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,xk=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Ek=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,_k=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,bk=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Mk=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,wk=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Ck=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Sk=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Tk=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Ik=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,Rk=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Dk=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Lk=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Pk=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Bk=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Ok=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Nk=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Fk=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Uk=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,kk=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Vk=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Hk=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zk=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Gk=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Wk=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,jk=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Qk=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Xk=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,qk=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Yk=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Kk=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$k=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Jk=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Zk=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,e5=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,t5=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,n5=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,i5=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,r5=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,s5=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,o5=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,a5=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,c5=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,l5=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,u5=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,h5=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,d5=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,f5=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,p5=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,m5=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,g5=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,A5=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,v5=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,y5=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,x5=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,E5=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,_5=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,b5=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,M5=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,w5=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,C5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,S5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,T5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,I5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;let Wi={alphahash_fragment:P4,alphahash_pars_fragment:B4,alphamap_fragment:O4,alphamap_pars_fragment:N4,alphatest_fragment:F4,alphatest_pars_fragment:U4,aomap_fragment:k4,aomap_pars_fragment:V4,begin_vertex:H4,beginnormal_vertex:z4,bsdfs:G4,iridescence_fragment:W4,bumpmap_pars_fragment:j4,clipping_planes_fragment:Q4,clipping_planes_pars_fragment:X4,clipping_planes_pars_vertex:q4,clipping_planes_vertex:Y4,color_fragment:K4,color_pars_fragment:$4,color_pars_vertex:J4,color_vertex:Z4,common:ek,cube_uv_reflection_fragment:tk,defaultnormal_vertex:nk,displacementmap_pars_vertex:ik,displacementmap_vertex:rk,emissivemap_fragment:sk,emissivemap_pars_fragment:ok,colorspace_fragment:ak,colorspace_pars_fragment:ck,envmap_fragment:lk,envmap_common_pars_fragment:uk,envmap_pars_fragment:hk,envmap_pars_vertex:dk,envmap_physical_pars_fragment:Mk,envmap_vertex:fk,fog_vertex:pk,fog_pars_vertex:mk,fog_fragment:gk,fog_pars_fragment:Ak,gradientmap_pars_fragment:vk,lightmap_fragment:yk,lightmap_pars_fragment:xk,lights_lambert_fragment:Ek,lights_lambert_pars_fragment:_k,lights_pars_begin:bk,lights_toon_fragment:wk,lights_toon_pars_fragment:Ck,lights_phong_fragment:Sk,lights_phong_pars_fragment:Tk,lights_physical_fragment:Ik,lights_physical_pars_fragment:Rk,lights_fragment_begin:Dk,lights_fragment_maps:Lk,lights_fragment_end:Pk,logdepthbuf_fragment:Bk,logdepthbuf_pars_fragment:Ok,logdepthbuf_pars_vertex:Nk,logdepthbuf_vertex:Fk,map_fragment:Uk,map_pars_fragment:kk,map_particle_fragment:Vk,map_particle_pars_fragment:Hk,metalnessmap_fragment:zk,metalnessmap_pars_fragment:Gk,morphcolor_vertex:Wk,morphnormal_vertex:jk,morphtarget_pars_vertex:Qk,morphtarget_vertex:Xk,normal_fragment_begin:qk,normal_fragment_maps:Yk,normal_pars_fragment:Kk,normal_pars_vertex:$k,normal_vertex:Jk,normalmap_pars_fragment:Zk,clearcoat_normal_fragment_begin:e5,clearcoat_normal_fragment_maps:t5,clearcoat_pars_fragment:n5,iridescence_pars_fragment:i5,opaque_fragment:r5,packing:s5,premultiplied_alpha_fragment:o5,project_vertex:a5,dithering_fragment:c5,dithering_pars_fragment:l5,roughnessmap_fragment:u5,roughnessmap_pars_fragment:h5,shadowmap_pars_fragment:d5,shadowmap_pars_vertex:f5,shadowmap_vertex:p5,shadowmask_pars_fragment:m5,skinbase_vertex:g5,skinning_pars_vertex:A5,skinning_vertex:v5,skinnormal_vertex:y5,specularmap_fragment:x5,specularmap_pars_fragment:E5,tonemapping_fragment:_5,tonemapping_pars_fragment:b5,transmission_fragment:M5,transmission_pars_fragment:w5,uv_pars_fragment:C5,uv_pars_vertex:S5,uv_vertex:T5,worldpos_vertex:I5,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Nn={common:{diffuse:{value:new jn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Oi},alphaMap:{value:null},alphaMapTransform:{value:new Oi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Oi}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Oi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Oi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Oi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Oi},normalScale:{value:new nn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Oi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Oi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Oi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Oi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new jn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new jn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Oi},alphaTest:{value:0},uvTransform:{value:new Oi}},sprite:{diffuse:{value:new jn(16777215)},opacity:{value:1},center:{value:new nn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Oi},alphaMap:{value:null},alphaMapTransform:{value:new Oi},alphaTest:{value:0}}},za={basic:{uniforms:Mo([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.fog]),vertexShader:Wi.meshbasic_vert,fragmentShader:Wi.meshbasic_frag},lambert:{uniforms:Mo([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new jn(0)}}]),vertexShader:Wi.meshlambert_vert,fragmentShader:Wi.meshlambert_frag},phong:{uniforms:Mo([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new jn(0)},specular:{value:new jn(1118481)},shininess:{value:30}}]),vertexShader:Wi.meshphong_vert,fragmentShader:Wi.meshphong_frag},standard:{uniforms:Mo([Nn.common,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.roughnessmap,Nn.metalnessmap,Nn.fog,Nn.lights,{emissive:{value:new jn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag},toon:{uniforms:Mo([Nn.common,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.gradientmap,Nn.fog,Nn.lights,{emissive:{value:new jn(0)}}]),vertexShader:Wi.meshtoon_vert,fragmentShader:Wi.meshtoon_frag},matcap:{uniforms:Mo([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,{matcap:{value:null}}]),vertexShader:Wi.meshmatcap_vert,fragmentShader:Wi.meshmatcap_frag},points:{uniforms:Mo([Nn.points,Nn.fog]),vertexShader:Wi.points_vert,fragmentShader:Wi.points_frag},dashed:{uniforms:Mo([Nn.common,Nn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wi.linedashed_vert,fragmentShader:Wi.linedashed_frag},depth:{uniforms:Mo([Nn.common,Nn.displacementmap]),vertexShader:Wi.depth_vert,fragmentShader:Wi.depth_frag},normal:{uniforms:Mo([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,{opacity:{value:1}}]),vertexShader:Wi.meshnormal_vert,fragmentShader:Wi.meshnormal_frag},sprite:{uniforms:Mo([Nn.sprite,Nn.fog]),vertexShader:Wi.sprite_vert,fragmentShader:Wi.sprite_frag},background:{uniforms:{uvTransform:{value:new Oi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Wi.background_vert,fragmentShader:Wi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Wi.backgroundCube_vert,fragmentShader:Wi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Wi.cube_vert,fragmentShader:Wi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wi.equirect_vert,fragmentShader:Wi.equirect_frag},distanceRGBA:{uniforms:Mo([Nn.common,Nn.displacementmap,{referencePosition:{value:new Ye},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wi.distanceRGBA_vert,fragmentShader:Wi.distanceRGBA_frag},shadow:{uniforms:Mo([Nn.lights,Nn.fog,{color:{value:new jn(0)},opacity:{value:1}}]),vertexShader:Wi.shadow_vert,fragmentShader:Wi.shadow_frag}};za.physical={uniforms:Mo([za.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Oi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Oi},clearcoatNormalScale:{value:new nn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Oi},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Oi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Oi},sheen:{value:0},sheenColor:{value:new jn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Oi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Oi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Oi},transmissionSamplerSize:{value:new nn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Oi},attenuationDistance:{value:0},attenuationColor:{value:new jn(0)},specularColor:{value:new jn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Oi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Oi},anisotropyVector:{value:new nn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Oi}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag};let D0={r:0,b:0,g:0};function R5(b,r,a,d,g,_,C){let S=new jn(0),B=_===!0?0:1,O,H,W=null,j=0,J=null;function ie(se,K){let Pe=!1,ve=K.isScene===!0?K.background:null;ve&&ve.isTexture&&(ve=(K.backgroundBlurriness>0?a:r).get(ve)),ve===null?fe(S,B):ve&&ve.isColor&&(fe(ve,1),Pe=!0);let Te=b.xr.getEnvironmentBlendMode();Te==="additive"?d.buffers.color.setClear(0,0,0,1,C):Te==="alpha-blend"&&d.buffers.color.setClear(0,0,0,0,C),(b.autoClear||Pe)&&b.clear(b.autoClearColor,b.autoClearDepth,b.autoClearStencil),ve&&(ve.isCubeTexture||ve.mapping===pe)?(H===void 0&&(H=new qs(new Hu(1e4,1e4,1e4),new dc({name:"BackgroundCubeMaterial",uniforms:gd(za.backgroundCube.uniforms),vertexShader:za.backgroundCube.vertexShader,fragmentShader:za.backgroundCube.fragmentShader,side:M,depthTest:!1,depthWrite:!1,fog:!1})),H.geometry.deleteAttribute("normal"),H.geometry.deleteAttribute("uv"),H.onBeforeRender=function(We,qe,st){this.matrixWorld.copyPosition(st.matrixWorld)},Object.defineProperty(H.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),g.update(H)),H.material.uniforms.envMap.value=ve,H.material.uniforms.flipEnvMap.value=ve.isCubeTexture&&ve.isRenderTargetTexture===!1?-1:1,H.material.uniforms.backgroundBlurriness.value=K.backgroundBlurriness,H.material.uniforms.backgroundIntensity.value=K.backgroundIntensity,H.material.toneMapped=Ir.getTransfer(ve.colorSpace)!==Ur,(W!==ve||j!==ve.version||J!==b.toneMapping)&&(H.material.needsUpdate=!0,W=ve,j=ve.version,J=b.toneMapping),H.layers.enableAll(),se.unshift(H,H.geometry,H.material,0,0,null)):ve&&ve.isTexture&&(O===void 0&&(O=new qs(new Qp(2,2),new dc({name:"BackgroundMaterial",uniforms:gd(za.background.uniforms),vertexShader:za.background.vertexShader,fragmentShader:za.background.fragmentShader,side:w,depthTest:!1,depthWrite:!1,fog:!1})),O.geometry.deleteAttribute("normal"),Object.defineProperty(O.material,"map",{get:function(){return this.uniforms.t2D.value}}),g.update(O)),O.material.uniforms.t2D.value=ve,O.material.uniforms.backgroundIntensity.value=K.backgroundIntensity,O.material.toneMapped=Ir.getTransfer(ve.colorSpace)!==Ur,ve.matrixAutoUpdate===!0&&ve.updateMatrix(),O.material.uniforms.uvTransform.value.copy(ve.matrix),(W!==ve||j!==ve.version||J!==b.toneMapping)&&(O.material.needsUpdate=!0,W=ve,j=ve.version,J=b.toneMapping),O.layers.enableAll(),se.unshift(O,O.geometry,O.material,0,0,null))}function fe(se,K){se.getRGB(D0,B2(b)),d.buffers.color.setClear(D0.r,D0.g,D0.b,K,C)}return{getClearColor:function(){return S},setClearColor:function(se,K=1){S.set(se),B=K,fe(S,B)},getClearAlpha:function(){return B},setClearAlpha:function(se){B=se,fe(S,B)},render:ie}}function D5(b,r,a,d){let g=b.getParameter(b.MAX_VERTEX_ATTRIBS),_=d.isWebGL2?null:r.get("OES_vertex_array_object"),C=d.isWebGL2||_!==null,S={},B=se(null),O=B,H=!1;function W(dt,wt,Kt,$t,un){let Zt=!1;if(C){let An=fe($t,Kt,wt);O!==An&&(O=An,J(O.object)),Zt=K(dt,$t,Kt,un),Zt&&Pe(dt,$t,Kt,un)}else{let An=wt.wireframe===!0;(O.geometry!==$t.id||O.program!==Kt.id||O.wireframe!==An)&&(O.geometry=$t.id,O.program=Kt.id,O.wireframe=An,Zt=!0)}un!==null&&a.update(un,b.ELEMENT_ARRAY_BUFFER),(Zt||H)&&(H=!1,lt(dt,wt,Kt,$t),un!==null&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a.get(un).buffer))}function j(){return d.isWebGL2?b.createVertexArray():_.createVertexArrayOES()}function J(dt){return d.isWebGL2?b.bindVertexArray(dt):_.bindVertexArrayOES(dt)}function ie(dt){return d.isWebGL2?b.deleteVertexArray(dt):_.deleteVertexArrayOES(dt)}function fe(dt,wt,Kt){let $t=Kt.wireframe===!0,un=S[dt.id];un===void 0&&(un={},S[dt.id]=un);let Zt=un[wt.id];Zt===void 0&&(Zt={},un[wt.id]=Zt);let An=Zt[$t];return An===void 0&&(An=se(j()),Zt[$t]=An),An}function se(dt){let wt=[],Kt=[],$t=[];for(let un=0;un<g;un++)wt[un]=0,Kt[un]=0,$t[un]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:wt,enabledAttributes:Kt,attributeDivisors:$t,object:dt,attributes:{},index:null}}function K(dt,wt,Kt,$t){let un=O.attributes,Zt=wt.attributes,An=0,gn=Kt.getAttributes();for(let Qn in gn)if(gn[Qn].location>=0){let Ni=un[Qn],Xt=Zt[Qn];if(Xt===void 0&&(Qn==="instanceMatrix"&&dt.instanceMatrix&&(Xt=dt.instanceMatrix),Qn==="instanceColor"&&dt.instanceColor&&(Xt=dt.instanceColor)),Ni===void 0||Ni.attribute!==Xt||Xt&&Ni.data!==Xt.data)return!0;An++}return O.attributesNum!==An||O.index!==$t}function Pe(dt,wt,Kt,$t){let un={},Zt=wt.attributes,An=0,gn=Kt.getAttributes();for(let Qn in gn)if(gn[Qn].location>=0){let Ni=Zt[Qn];Ni===void 0&&(Qn==="instanceMatrix"&&dt.instanceMatrix&&(Ni=dt.instanceMatrix),Qn==="instanceColor"&&dt.instanceColor&&(Ni=dt.instanceColor));let Xt={};Xt.attribute=Ni,Ni&&Ni.data&&(Xt.data=Ni.data),un[Qn]=Xt,An++}O.attributes=un,O.attributesNum=An,O.index=$t}function ve(){let dt=O.newAttributes;for(let wt=0,Kt=dt.length;wt<Kt;wt++)dt[wt]=0}function Te(dt){We(dt,0)}function We(dt,wt){let Kt=O.newAttributes,$t=O.enabledAttributes,un=O.attributeDivisors;Kt[dt]=1,$t[dt]===0&&(b.enableVertexAttribArray(dt),$t[dt]=1),un[dt]!==wt&&((d.isWebGL2?b:r.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](dt,wt),un[dt]=wt)}function qe(){let dt=O.newAttributes,wt=O.enabledAttributes;for(let Kt=0,$t=wt.length;Kt<$t;Kt++)wt[Kt]!==dt[Kt]&&(b.disableVertexAttribArray(Kt),wt[Kt]=0)}function st(dt,wt,Kt,$t,un,Zt,An){An===!0?b.vertexAttribIPointer(dt,wt,Kt,un,Zt):b.vertexAttribPointer(dt,wt,Kt,$t,un,Zt)}function lt(dt,wt,Kt,$t){if(d.isWebGL2===!1&&(dt.isInstancedMesh||$t.isInstancedBufferGeometry)&&r.get("ANGLE_instanced_arrays")===null)return;ve();let un=$t.attributes,Zt=Kt.getAttributes(),An=wt.defaultAttributeValues;for(let gn in Zt){let Qn=Zt[gn];if(Qn.location>=0){let ji=un[gn];if(ji===void 0&&(gn==="instanceMatrix"&&dt.instanceMatrix&&(ji=dt.instanceMatrix),gn==="instanceColor"&&dt.instanceColor&&(ji=dt.instanceColor)),ji!==void 0){let Ni=ji.normalized,Xt=ji.itemSize,Tn=a.get(ji);if(Tn===void 0)continue;let Mn=Tn.buffer,bi=Tn.type,ei=Tn.bytesPerElement,ii=d.isWebGL2===!0&&(bi===b.INT||bi===b.UNSIGNED_INT||ji.gpuType===Kn);if(ji.isInterleavedBufferAttribute){let vi=ji.data,on=vi.stride,ft=ji.offset;if(vi.isInstancedInterleavedBuffer){for(let dn=0;dn<Qn.locationSize;dn++)We(Qn.location+dn,vi.meshPerAttribute);dt.isInstancedMesh!==!0&&$t._maxInstanceCount===void 0&&($t._maxInstanceCount=vi.meshPerAttribute*vi.count)}else for(let dn=0;dn<Qn.locationSize;dn++)Te(Qn.location+dn);b.bindBuffer(b.ARRAY_BUFFER,Mn);for(let dn=0;dn<Qn.locationSize;dn++)st(Qn.location+dn,Xt/Qn.locationSize,bi,Ni,on*ei,(ft+Xt/Qn.locationSize*dn)*ei,ii)}else{if(ji.isInstancedBufferAttribute){for(let vi=0;vi<Qn.locationSize;vi++)We(Qn.location+vi,ji.meshPerAttribute);dt.isInstancedMesh!==!0&&$t._maxInstanceCount===void 0&&($t._maxInstanceCount=ji.meshPerAttribute*ji.count)}else for(let vi=0;vi<Qn.locationSize;vi++)Te(Qn.location+vi);b.bindBuffer(b.ARRAY_BUFFER,Mn);for(let vi=0;vi<Qn.locationSize;vi++)st(Qn.location+vi,Xt/Qn.locationSize,bi,Ni,Xt*ei,Xt/Qn.locationSize*vi*ei,ii)}}else if(An!==void 0){let Ni=An[gn];if(Ni!==void 0)switch(Ni.length){case 2:b.vertexAttrib2fv(Qn.location,Ni);break;case 3:b.vertexAttrib3fv(Qn.location,Ni);break;case 4:b.vertexAttrib4fv(Qn.location,Ni);break;default:b.vertexAttrib1fv(Qn.location,Ni)}}}}qe()}function Ve(){Dt();for(let dt in S){let wt=S[dt];for(let Kt in wt){let $t=wt[Kt];for(let un in $t)ie($t[un].object),delete $t[un];delete wt[Kt]}delete S[dt]}}function Ke(dt){if(S[dt.id]===void 0)return;let wt=S[dt.id];for(let Kt in wt){let $t=wt[Kt];for(let un in $t)ie($t[un].object),delete $t[un];delete wt[Kt]}delete S[dt.id]}function ct(dt){for(let wt in S){let Kt=S[wt];if(Kt[dt.id]===void 0)continue;let $t=Kt[dt.id];for(let un in $t)ie($t[un].object),delete $t[un];delete Kt[dt.id]}}function Dt(){Qt(),H=!0,O!==B&&(O=B,J(O.object))}function Qt(){B.geometry=null,B.program=null,B.wireframe=!1}return{setup:W,reset:Dt,resetDefaultState:Qt,dispose:Ve,releaseStatesOfGeometry:Ke,releaseStatesOfProgram:ct,initAttributes:ve,enableAttribute:Te,disableUnusedAttributes:qe}}function L5(b,r,a,d){let g=d.isWebGL2,_;function C(O){_=O}function S(O,H){b.drawArrays(_,O,H),a.update(H,_,1)}function B(O,H,W){if(W===0)return;let j,J;if(g)j=b,J="drawArraysInstanced";else if(j=r.get("ANGLE_instanced_arrays"),J="drawArraysInstancedANGLE",j===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}j[J](_,O,H,W),a.update(H,_,W)}this.setMode=C,this.render=S,this.renderInstances=B}function P5(b,r,a){let d;function g(){if(d!==void 0)return d;if(r.has("EXT_texture_filter_anisotropic")===!0){let st=r.get("EXT_texture_filter_anisotropic");d=b.getParameter(st.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d}function _(st){if(st==="highp"){if(b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_FLOAT).precision>0&&b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT).precision>0)return"highp";st="mediump"}return st==="mediump"&&b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_FLOAT).precision>0&&b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let C=typeof WebGL2RenderingContext<"u"&&b.constructor.name==="WebGL2RenderingContext",S=a.precision!==void 0?a.precision:"highp",B=_(S);B!==S&&(console.warn("THREE.WebGLRenderer:",S,"not supported, using",B,"instead."),S=B);let O=C||r.has("WEBGL_draw_buffers"),H=a.logarithmicDepthBuffer===!0,W=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS),j=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS),J=b.getParameter(b.MAX_TEXTURE_SIZE),ie=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),fe=b.getParameter(b.MAX_VERTEX_ATTRIBS),se=b.getParameter(b.MAX_VERTEX_UNIFORM_VECTORS),K=b.getParameter(b.MAX_VARYING_VECTORS),Pe=b.getParameter(b.MAX_FRAGMENT_UNIFORM_VECTORS),ve=j>0,Te=C||r.has("OES_texture_float"),We=ve&&Te,qe=C?b.getParameter(b.MAX_SAMPLES):0;return{isWebGL2:C,drawBuffers:O,getMaxAnisotropy:g,getMaxPrecision:_,precision:S,logarithmicDepthBuffer:H,maxTextures:W,maxVertexTextures:j,maxTextureSize:J,maxCubemapSize:ie,maxAttributes:fe,maxVertexUniforms:se,maxVaryings:K,maxFragmentUniforms:Pe,vertexTextures:ve,floatFragmentTextures:Te,floatVertexTextures:We,maxSamples:qe}}function B5(b){let r=this,a=null,d=0,g=!1,_=!1,C=new Ol,S=new Oi,B={value:null,needsUpdate:!1};this.uniform=B,this.numPlanes=0,this.numIntersection=0,this.init=function(W,j){let J=W.length!==0||j||d!==0||g;return g=j,d=W.length,J},this.beginShadows=function(){_=!0,H(null)},this.endShadows=function(){_=!1},this.setGlobalState=function(W,j){a=H(W,j,0)},this.setState=function(W,j,J){let ie=W.clippingPlanes,fe=W.clipIntersection,se=W.clipShadows,K=b.get(W);if(!g||ie===null||ie.length===0||_&&!se)_?H(null):O();else{let Pe=_?0:d,ve=Pe*4,Te=K.clippingState||null;B.value=Te,Te=H(ie,j,ve,J);for(let We=0;We!==ve;++We)Te[We]=a[We];K.clippingState=Te,this.numIntersection=fe?this.numPlanes:0,this.numPlanes+=Pe}};function O(){B.value!==a&&(B.value=a,B.needsUpdate=d>0),r.numPlanes=d,r.numIntersection=0}function H(W,j,J,ie){let fe=W!==null?W.length:0,se=null;if(fe!==0){if(se=B.value,ie!==!0||se===null){let K=J+fe*4,Pe=j.matrixWorldInverse;S.getNormalMatrix(Pe),(se===null||se.length<K)&&(se=new Float32Array(K));for(let ve=0,Te=J;ve!==fe;++ve,Te+=4)C.copy(W[ve]).applyMatrix4(Pe,S),C.normal.toArray(se,Te),se[Te+3]=C.constant}B.value=se,B.needsUpdate=!0}return r.numPlanes=fe,r.numIntersection=0,se}}function O5(b){let r=new WeakMap;function a(C,S){return S===V?C.mapping=Ge:S===G&&(C.mapping=ee),C}function d(C){if(C&&C.isTexture&&C.isRenderTargetTexture===!1){let S=C.mapping;if(S===V||S===G)if(r.has(C)){let B=r.get(C).texture;return a(B,C.mapping)}else{let B=C.image;if(B&&B.height>0){let O=new F2(B.height/2);return O.fromEquirectangularTexture(b,C),r.set(C,O),C.addEventListener("dispose",g),a(O.texture,C.mapping)}else return null}}return C}function g(C){let S=C.target;S.removeEventListener("dispose",g);let B=r.get(S);B!==void 0&&(r.delete(S),B.dispose())}function _(){r=new WeakMap}return{get:d,dispose:_}}class L0 extends T0{constructor(r=-1,a=1,d=1,g=-1,_=.1,C=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=a,this.top=d,this.bottom=g,this.near=_,this.far=C,this.updateProjectionMatrix()}copy(r,a){return super.copy(r,a),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,a,d,g,_,C){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=a,this.view.offsetX=d,this.view.offsetY=g,this.view.width=_,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let r=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,g=(this.top+this.bottom)/2,_=d-r,C=d+r,S=g+a,B=g-a;if(this.view!==null&&this.view.enabled){let O=(this.right-this.left)/this.view.fullWidth/this.zoom,H=(this.top-this.bottom)/this.view.fullHeight/this.zoom;_+=O*this.view.offsetX,C=_+O*this.view.width,S-=H*this.view.offsetY,B=S-H*this.view.height}this.projectionMatrix.makeOrthographic(_,C,S,B,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){let a=super.toJSON(r);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,this.view!==null&&(a.object.view=Object.assign({},this.view)),a}}let yd=4,U2=[.125,.215,.35,.446,.526,.582],Gu=20,d_=new L0,k2=new jn,f_=null,p_=0,m_=0,Wu=(1+Math.sqrt(5))/2,xd=1/Wu,V2=[new Ye(1,1,1),new Ye(-1,1,1),new Ye(1,1,-1),new Ye(-1,1,-1),new Ye(0,Wu,xd),new Ye(0,Wu,-xd),new Ye(xd,0,Wu),new Ye(-xd,0,Wu),new Ye(Wu,xd,0),new Ye(-Wu,xd,0)];class g_{constructor(r){this._renderer=r,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(r,a=0,d=.1,g=100){f_=this._renderer.getRenderTarget(),p_=this._renderer.getActiveCubeFace(),m_=this._renderer.getActiveMipmapLevel(),this._setSize(256);let _=this._allocateTargets();return _.depthBuffer=!0,this._sceneToCubeUV(r,d,g,_),a>0&&this._blur(_,0,0,a),this._applyPMREM(_),this._cleanup(_),_}fromEquirectangular(r,a=null){return this._fromTexture(r,a)}fromCubemap(r,a=null){return this._fromTexture(r,a)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=G2(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=z2(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(r){this._lodMax=Math.floor(Math.log2(r)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let r=0;r<this._lodPlanes.length;r++)this._lodPlanes[r].dispose()}_cleanup(r){this._renderer.setRenderTarget(f_,p_,m_),r.scissorTest=!1,P0(r,0,0,r.width,r.height)}_fromTexture(r,a){r.mapping===Ge||r.mapping===ee?this._setSize(r.image.length===0?16:r.image[0].width||r.image[0].image.width):this._setSize(r.image.width/4),f_=this._renderer.getRenderTarget(),p_=this._renderer.getActiveCubeFace(),m_=this._renderer.getActiveMipmapLevel();let d=a||this._allocateTargets();return this._textureToCubeUV(r,d),this._applyPMREM(d),this._cleanup(d),d}_allocateTargets(){let r=3*Math.max(this._cubeSize,112),a=4*this._cubeSize,d={magFilter:_t,minFilter:_t,generateMipmaps:!1,type:xi,format:Mi,colorSpace:Sr,depthBuffer:!1},g=H2(r,a,d);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==r||this._pingPongRenderTarget.height!==a){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=H2(r,a,d);let{_lodMax:_}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=N5(_)),this._blurMaterial=F5(_,r,a)}return g}_compileMaterial(r){let a=new qs(this._lodPlanes[0],r);this._renderer.compile(a,d_)}_sceneToCubeUV(r,a,d,g){let S=new Ms(90,1,a,d),B=[1,-1,1,1,1,1],O=[1,1,1,-1,-1,-1],H=this._renderer,W=H.autoClear,j=H.toneMapping;H.getClearColor(k2),H.toneMapping=De,H.autoClear=!1;let J=new Bl({name:"PMREM.Background",side:M,depthWrite:!1,depthTest:!1}),ie=new qs(new Hu,J),fe=!1,se=r.background;se?se.isColor&&(J.color.copy(se),r.background=null,fe=!0):(J.color.copy(k2),fe=!0);for(let K=0;K<6;K++){let Pe=K%3;Pe===0?(S.up.set(0,B[K],0),S.lookAt(O[K],0,0)):Pe===1?(S.up.set(0,0,B[K]),S.lookAt(0,O[K],0)):(S.up.set(0,B[K],0),S.lookAt(0,0,O[K]));let ve=this._cubeSize;P0(g,Pe*ve,K>2?ve:0,ve,ve),H.setRenderTarget(g),fe&&H.render(ie,S),H.render(r,S)}ie.geometry.dispose(),ie.material.dispose(),H.toneMapping=j,H.autoClear=W,r.background=se}_textureToCubeUV(r,a){let d=this._renderer,g=r.mapping===Ge||r.mapping===ee;g?(this._cubemapMaterial===null&&(this._cubemapMaterial=G2()),this._cubemapMaterial.uniforms.flipEnvMap.value=r.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=z2());let _=g?this._cubemapMaterial:this._equirectMaterial,C=new qs(this._lodPlanes[0],_),S=_.uniforms;S.envMap.value=r;let B=this._cubeSize;P0(a,0,0,3*B,2*B),d.setRenderTarget(a),d.render(C,d_)}_applyPMREM(r){let a=this._renderer,d=a.autoClear;a.autoClear=!1;for(let g=1;g<this._lodPlanes.length;g++){let _=Math.sqrt(this._sigmas[g]*this._sigmas[g]-this._sigmas[g-1]*this._sigmas[g-1]),C=V2[(g-1)%V2.length];this._blur(r,g-1,g,_,C)}a.autoClear=d}_blur(r,a,d,g,_){let C=this._pingPongRenderTarget;this._halfBlur(r,C,a,d,g,"latitudinal",_),this._halfBlur(C,r,d,d,g,"longitudinal",_)}_halfBlur(r,a,d,g,_,C,S){let B=this._renderer,O=this._blurMaterial;C!=="latitudinal"&&C!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let H=3,W=new qs(this._lodPlanes[g],O),j=O.uniforms,J=this._sizeLods[d]-1,ie=isFinite(_)?Math.PI/(2*J):2*Math.PI/(2*Gu-1),fe=_/ie,se=isFinite(_)?1+Math.floor(H*fe):Gu;se>Gu&&console.warn(`sigmaRadians, ${_}, is too large and will clip, as it requested ${se} samples when the maximum is set to ${Gu}`);let K=[],Pe=0;for(let st=0;st<Gu;++st){let lt=st/fe,Ve=Math.exp(-lt*lt/2);K.push(Ve),st===0?Pe+=Ve:st<se&&(Pe+=2*Ve)}for(let st=0;st<K.length;st++)K[st]=K[st]/Pe;j.envMap.value=r.texture,j.samples.value=se,j.weights.value=K,j.latitudinal.value=C==="latitudinal",S&&(j.poleAxis.value=S);let{_lodMax:ve}=this;j.dTheta.value=ie,j.mipInt.value=ve-d;let Te=this._sizeLods[g],We=3*Te*(g>ve-yd?g-ve+yd:0),qe=4*(this._cubeSize-Te);P0(a,We,qe,3*Te,2*Te),B.setRenderTarget(a),B.render(W,d_)}}function N5(b){let r=[],a=[],d=[],g=b,_=b-yd+1+U2.length;for(let C=0;C<_;C++){let S=Math.pow(2,g);a.push(S);let B=1/S;C>b-yd?B=U2[C-b+yd-1]:C===0&&(B=0),d.push(B);let O=1/(S-2),H=-O,W=1+O,j=[H,H,W,H,W,W,H,H,W,W,H,W],J=6,ie=6,fe=3,se=2,K=1,Pe=new Float32Array(fe*ie*J),ve=new Float32Array(se*ie*J),Te=new Float32Array(K*ie*J);for(let qe=0;qe<J;qe++){let st=qe%3*2/3-1,lt=qe>2?0:-1,Ve=[st,lt,0,st+2/3,lt,0,st+2/3,lt+1,0,st,lt,0,st+2/3,lt+1,0,st,lt+1,0];Pe.set(Ve,fe*ie*qe),ve.set(j,se*ie*qe);let Ke=[qe,qe,qe,qe,qe,qe];Te.set(Ke,K*ie*qe)}let We=new Zi;We.setAttribute("position",new Wr(Pe,fe)),We.setAttribute("uv",new Wr(ve,se)),We.setAttribute("faceIndex",new Wr(Te,K)),r.push(We),g>yd&&g--}return{lodPlanes:r,sizeLods:a,sigmas:d}}function H2(b,r,a){let d=new No(b,r,a);return d.texture.mapping=pe,d.texture.name="PMREM.cubeUv",d.scissorTest=!0,d}function P0(b,r,a,d,g){b.viewport.set(r,a,d,g),b.scissor.set(r,a,d,g)}function F5(b,r,a){let d=new Float32Array(Gu),g=new Ye(0,1,0);return new dc({name:"SphericalGaussianBlur",defines:{n:Gu,CUBEUV_TEXEL_WIDTH:1/r,CUBEUV_TEXEL_HEIGHT:1/a,CUBEUV_MAX_MIP:`${b}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:g}},vertexShader:A_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:L,depthTest:!1,depthWrite:!1})}function z2(){return new dc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:A_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:L,depthTest:!1,depthWrite:!1})}function G2(){return new dc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:A_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:L,depthTest:!1,depthWrite:!1})}function A_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function U5(b){let r=new WeakMap,a=null;function d(S){if(S&&S.isTexture){let B=S.mapping,O=B===V||B===G,H=B===Ge||B===ee;if(O||H)if(S.isRenderTargetTexture&&S.needsPMREMUpdate===!0){S.needsPMREMUpdate=!1;let W=r.get(S);return a===null&&(a=new g_(b)),W=O?a.fromEquirectangular(S,W):a.fromCubemap(S,W),r.set(S,W),W.texture}else{if(r.has(S))return r.get(S).texture;{let W=S.image;if(O&&W&&W.height>0||H&&W&&g(W)){a===null&&(a=new g_(b));let j=O?a.fromEquirectangular(S):a.fromCubemap(S);return r.set(S,j),S.addEventListener("dispose",_),j.texture}else return null}}}return S}function g(S){let B=0,O=6;for(let H=0;H<O;H++)S[H]!==void 0&&B++;return B===O}function _(S){let B=S.target;B.removeEventListener("dispose",_);let O=r.get(B);O!==void 0&&(r.delete(B),O.dispose())}function C(){r=new WeakMap,a!==null&&(a.dispose(),a=null)}return{get:d,dispose:C}}function k5(b){let r={};function a(d){if(r[d]!==void 0)return r[d];let g;switch(d){case"WEBGL_depth_texture":g=b.getExtension("WEBGL_depth_texture")||b.getExtension("MOZ_WEBGL_depth_texture")||b.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=b.getExtension("WEBGL_compressed_texture_s3tc")||b.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=b.getExtension("WEBGL_compressed_texture_pvrtc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=b.getExtension(d)}return r[d]=g,g}return{has:function(d){return a(d)!==null},init:function(d){d.isWebGL2?a("EXT_color_buffer_float"):(a("WEBGL_depth_texture"),a("OES_texture_float"),a("OES_texture_half_float"),a("OES_texture_half_float_linear"),a("OES_standard_derivatives"),a("OES_element_index_uint"),a("OES_vertex_array_object"),a("ANGLE_instanced_arrays")),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float"),a("WEBGL_multisampled_render_to_texture")},get:function(d){let g=a(d);return g===null&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),g}}}function V5(b,r,a,d){let g={},_=new WeakMap;function C(W){let j=W.target;j.index!==null&&r.remove(j.index);for(let ie in j.attributes)r.remove(j.attributes[ie]);for(let ie in j.morphAttributes){let fe=j.morphAttributes[ie];for(let se=0,K=fe.length;se<K;se++)r.remove(fe[se])}j.removeEventListener("dispose",C),delete g[j.id];let J=_.get(j);J&&(r.remove(J),_.delete(j)),d.releaseStatesOfGeometry(j),j.isInstancedBufferGeometry===!0&&delete j._maxInstanceCount,a.memory.geometries--}function S(W,j){return g[j.id]===!0||(j.addEventListener("dispose",C),g[j.id]=!0,a.memory.geometries++),j}function B(W){let j=W.attributes;for(let ie in j)r.update(j[ie],b.ARRAY_BUFFER);let J=W.morphAttributes;for(let ie in J){let fe=J[ie];for(let se=0,K=fe.length;se<K;se++)r.update(fe[se],b.ARRAY_BUFFER)}}function O(W){let j=[],J=W.index,ie=W.attributes.position,fe=0;if(J!==null){let Pe=J.array;fe=J.version;for(let ve=0,Te=Pe.length;ve<Te;ve+=3){let We=Pe[ve+0],qe=Pe[ve+1],st=Pe[ve+2];j.push(We,qe,qe,st,st,We)}}else if(ie!==void 0){let Pe=ie.array;fe=ie.version;for(let ve=0,Te=Pe.length/3-1;ve<Te;ve+=3){let We=ve+0,qe=ve+1,st=ve+2;j.push(We,qe,qe,st,st,We)}}else return;let se=new(a0(j)?a_:o_)(j,1);se.version=fe;let K=_.get(W);K&&r.remove(K),_.set(W,se)}function H(W){let j=_.get(W);if(j){let J=W.index;J!==null&&j.version<J.version&&O(W)}else O(W);return _.get(W)}return{get:S,update:B,getWireframeAttribute:H}}function H5(b,r,a,d){let g=d.isWebGL2,_;function C(j){_=j}let S,B;function O(j){S=j.type,B=j.bytesPerElement}function H(j,J){b.drawElements(_,J,S,j*B),a.update(J,_,1)}function W(j,J,ie){if(ie===0)return;let fe,se;if(g)fe=b,se="drawElementsInstanced";else if(fe=r.get("ANGLE_instanced_arrays"),se="drawElementsInstancedANGLE",fe===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}fe[se](_,J,S,j*B,ie),a.update(J,_,ie)}this.setMode=C,this.setIndex=O,this.render=H,this.renderInstances=W}function z5(b){let r={geometries:0,textures:0},a={frame:0,calls:0,triangles:0,points:0,lines:0};function d(_,C,S){switch(a.calls++,C){case b.TRIANGLES:a.triangles+=S*(_/3);break;case b.LINES:a.lines+=S*(_/2);break;case b.LINE_STRIP:a.lines+=S*(_-1);break;case b.LINE_LOOP:a.lines+=S*_;break;case b.POINTS:a.points+=S*_;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",C);break}}function g(){a.calls=0,a.triangles=0,a.points=0,a.lines=0}return{memory:r,render:a,programs:null,autoReset:!0,reset:g,update:d}}function G5(b,r){return b[0]-r[0]}function W5(b,r){return Math.abs(r[1])-Math.abs(b[1])}function j5(b,r,a){let d={},g=new Float32Array(8),_=new WeakMap,C=new Mr,S=[];for(let O=0;O<8;O++)S[O]=[O,0];function B(O,H,W){let j=O.morphTargetInfluences;if(r.isWebGL2===!0){let J=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,ie=J!==void 0?J.length:0,fe=_.get(H);if(fe===void 0||fe.count!==ie){let dt=function(){Dt.dispose(),_.delete(H),H.removeEventListener("dispose",dt)};fe!==void 0&&fe.texture.dispose();let Pe=H.morphAttributes.position!==void 0,ve=H.morphAttributes.normal!==void 0,Te=H.morphAttributes.color!==void 0,We=H.morphAttributes.position||[],qe=H.morphAttributes.normal||[],st=H.morphAttributes.color||[],lt=0;Pe===!0&&(lt=1),ve===!0&&(lt=2),Te===!0&&(lt=3);let Ve=H.attributes.position.count*lt,Ke=1;Ve>r.maxTextureSize&&(Ke=Math.ceil(Ve/r.maxTextureSize),Ve=r.maxTextureSize);let ct=new Float32Array(Ve*Ke*4*ie),Dt=new sd(ct,Ve,Ke,ie);Dt.type=fi,Dt.needsUpdate=!0;let Qt=lt*4;for(let wt=0;wt<ie;wt++){let Kt=We[wt],$t=qe[wt],un=st[wt],Zt=Ve*Ke*4*wt;for(let An=0;An<Kt.count;An++){let gn=An*Qt;Pe===!0&&(C.fromBufferAttribute(Kt,An),ct[Zt+gn+0]=C.x,ct[Zt+gn+1]=C.y,ct[Zt+gn+2]=C.z,ct[Zt+gn+3]=0),ve===!0&&(C.fromBufferAttribute($t,An),ct[Zt+gn+4]=C.x,ct[Zt+gn+5]=C.y,ct[Zt+gn+6]=C.z,ct[Zt+gn+7]=0),Te===!0&&(C.fromBufferAttribute(un,An),ct[Zt+gn+8]=C.x,ct[Zt+gn+9]=C.y,ct[Zt+gn+10]=C.z,ct[Zt+gn+11]=un.itemSize===4?C.w:1)}}fe={count:ie,texture:Dt,size:new nn(Ve,Ke)},_.set(H,fe),H.addEventListener("dispose",dt)}let se=0;for(let Pe=0;Pe<j.length;Pe++)se+=j[Pe];let K=H.morphTargetsRelative?1:1-se;W.getUniforms().setValue(b,"morphTargetBaseInfluence",K),W.getUniforms().setValue(b,"morphTargetInfluences",j),W.getUniforms().setValue(b,"morphTargetsTexture",fe.texture,a),W.getUniforms().setValue(b,"morphTargetsTextureSize",fe.size)}else{let J=j===void 0?0:j.length,ie=d[H.id];if(ie===void 0||ie.length!==J){ie=[];for(let ve=0;ve<J;ve++)ie[ve]=[ve,0];d[H.id]=ie}for(let ve=0;ve<J;ve++){let Te=ie[ve];Te[0]=ve,Te[1]=j[ve]}ie.sort(W5);for(let ve=0;ve<8;ve++)ve<J&&ie[ve][1]?(S[ve][0]=ie[ve][0],S[ve][1]=ie[ve][1]):(S[ve][0]=Number.MAX_SAFE_INTEGER,S[ve][1]=0);S.sort(G5);let fe=H.morphAttributes.position,se=H.morphAttributes.normal,K=0;for(let ve=0;ve<8;ve++){let Te=S[ve],We=Te[0],qe=Te[1];We!==Number.MAX_SAFE_INTEGER&&qe?(fe&&H.getAttribute("morphTarget"+ve)!==fe[We]&&H.setAttribute("morphTarget"+ve,fe[We]),se&&H.getAttribute("morphNormal"+ve)!==se[We]&&H.setAttribute("morphNormal"+ve,se[We]),g[ve]=qe,K+=qe):(fe&&H.hasAttribute("morphTarget"+ve)===!0&&H.deleteAttribute("morphTarget"+ve),se&&H.hasAttribute("morphNormal"+ve)===!0&&H.deleteAttribute("morphNormal"+ve),g[ve]=0)}let Pe=H.morphTargetsRelative?1:1-K;W.getUniforms().setValue(b,"morphTargetBaseInfluence",Pe),W.getUniforms().setValue(b,"morphTargetInfluences",g)}}return{update:B}}class Q5{constructor(r,a,d){if(this.renderer=r,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=d,this.extensions=a,this.available=this.extensions.has("OCULUS_multiview"),this.available){let _=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(_.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var g=0;g<this.maxNumViews;g++)this.mat4[g]=new _i,this.mat3[g]=new Oi}}getCameraArray(r){return r.isArrayCamera?r.cameras:(this.cameraArray[0]=r,this.cameraArray)}updateCameraProjectionMatricesUniform(r,a){for(var d=this.getCameraArray(r),g=0;g<d.length;g++)this.mat4[g].copy(d[g].projectionMatrix);a.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(r,a){for(var d=this.getCameraArray(r),g=0;g<d.length;g++)this.mat4[g].copy(d[g].matrixWorldInverse);a.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(r,a,d){for(var g=this.getCameraArray(a),_=0;_<g.length;_++)this.mat4[_].multiplyMatrices(g[_].matrixWorldInverse,r.matrixWorld),this.mat3[_].getNormalMatrix(this.mat4[_]);d.setValue(this.gl,"modelViewMatrices",this.mat4),d.setValue(this.gl,"normalMatrices",this.mat3)}}function X5(b,r,a,d){let g=new WeakMap;function _(B){let O=d.render.frame,H=B.geometry,W=r.get(B,H);if(g.get(W)!==O&&(r.update(W),g.set(W,O)),B.isInstancedMesh&&(B.hasEventListener("dispose",S)===!1&&B.addEventListener("dispose",S),g.get(B)!==O&&(a.update(B.instanceMatrix,b.ARRAY_BUFFER),B.instanceColor!==null&&a.update(B.instanceColor,b.ARRAY_BUFFER),g.set(B,O))),B.isSkinnedMesh){let j=B.skeleton;g.get(j)!==O&&(j.update(),g.set(j,O))}return W}function C(){g=new WeakMap}function S(B){let O=B.target;O.removeEventListener("dispose",S),a.remove(O.instanceMatrix),O.instanceColor!==null&&a.remove(O.instanceColor)}return{update:_,dispose:C}}let W2=new Es,j2=new sd,Q2=new Ri,X2=new jp,q2=[],Y2=[],K2=new Float32Array(16),$2=new Float32Array(9),J2=new Float32Array(4);function Ed(b,r,a){let d=b[0];if(d<=0||d>0)return b;let g=r*a,_=q2[g];if(_===void 0&&(_=new Float32Array(g),q2[g]=_),r!==0){d.toArray(_,0);for(let C=1,S=0;C!==r;++C)S+=a,b[C].toArray(_,S)}return _}function ws(b,r){if(b.length!==r.length)return!1;for(let a=0,d=b.length;a<d;a++)if(b[a]!==r[a])return!1;return!0}function Cs(b,r){for(let a=0,d=r.length;a<d;a++)b[a]=r[a]}function B0(b,r){let a=Y2[r];a===void 0&&(a=new Int32Array(r),Y2[r]=a);for(let d=0;d!==r;++d)a[d]=b.allocateTextureUnit();return a}function q5(b,r){let a=this.cache;a[0]!==r&&(b.uniform1f(this.addr,r),a[0]=r)}function Y5(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y)&&(b.uniform2f(this.addr,r.x,r.y),a[0]=r.x,a[1]=r.y);else{if(ws(a,r))return;b.uniform2fv(this.addr,r),Cs(a,r)}}function K5(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z)&&(b.uniform3f(this.addr,r.x,r.y,r.z),a[0]=r.x,a[1]=r.y,a[2]=r.z);else if(r.r!==void 0)(a[0]!==r.r||a[1]!==r.g||a[2]!==r.b)&&(b.uniform3f(this.addr,r.r,r.g,r.b),a[0]=r.r,a[1]=r.g,a[2]=r.b);else{if(ws(a,r))return;b.uniform3fv(this.addr,r),Cs(a,r)}}function $5(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z||a[3]!==r.w)&&(b.uniform4f(this.addr,r.x,r.y,r.z,r.w),a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=r.w);else{if(ws(a,r))return;b.uniform4fv(this.addr,r),Cs(a,r)}}function J5(b,r){let a=this.cache,d=r.elements;if(d===void 0){if(ws(a,r))return;b.uniformMatrix2fv(this.addr,!1,r),Cs(a,r)}else{if(ws(a,d))return;J2.set(d),b.uniformMatrix2fv(this.addr,!1,J2),Cs(a,d)}}function Z5(b,r){let a=this.cache,d=r.elements;if(d===void 0){if(ws(a,r))return;b.uniformMatrix3fv(this.addr,!1,r),Cs(a,r)}else{if(ws(a,d))return;$2.set(d),b.uniformMatrix3fv(this.addr,!1,$2),Cs(a,d)}}function e8(b,r){let a=this.cache,d=r.elements;if(d===void 0){if(ws(a,r))return;b.uniformMatrix4fv(this.addr,!1,r),Cs(a,r)}else{if(ws(a,d))return;K2.set(d),b.uniformMatrix4fv(this.addr,!1,K2),Cs(a,d)}}function t8(b,r){let a=this.cache;a[0]!==r&&(b.uniform1i(this.addr,r),a[0]=r)}function n8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y)&&(b.uniform2i(this.addr,r.x,r.y),a[0]=r.x,a[1]=r.y);else{if(ws(a,r))return;b.uniform2iv(this.addr,r),Cs(a,r)}}function i8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z)&&(b.uniform3i(this.addr,r.x,r.y,r.z),a[0]=r.x,a[1]=r.y,a[2]=r.z);else{if(ws(a,r))return;b.uniform3iv(this.addr,r),Cs(a,r)}}function r8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z||a[3]!==r.w)&&(b.uniform4i(this.addr,r.x,r.y,r.z,r.w),a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=r.w);else{if(ws(a,r))return;b.uniform4iv(this.addr,r),Cs(a,r)}}function s8(b,r){let a=this.cache;a[0]!==r&&(b.uniform1ui(this.addr,r),a[0]=r)}function o8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y)&&(b.uniform2ui(this.addr,r.x,r.y),a[0]=r.x,a[1]=r.y);else{if(ws(a,r))return;b.uniform2uiv(this.addr,r),Cs(a,r)}}function a8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z)&&(b.uniform3ui(this.addr,r.x,r.y,r.z),a[0]=r.x,a[1]=r.y,a[2]=r.z);else{if(ws(a,r))return;b.uniform3uiv(this.addr,r),Cs(a,r)}}function c8(b,r){let a=this.cache;if(r.x!==void 0)(a[0]!==r.x||a[1]!==r.y||a[2]!==r.z||a[3]!==r.w)&&(b.uniform4ui(this.addr,r.x,r.y,r.z,r.w),a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=r.w);else{if(ws(a,r))return;b.uniform4uiv(this.addr,r),Cs(a,r)}}function l8(b,r,a){let d=this.cache,g=a.allocateTextureUnit();d[0]!==g&&(b.uniform1i(this.addr,g),d[0]=g),a.setTexture2D(r||W2,g)}function u8(b,r,a){let d=this.cache,g=a.allocateTextureUnit();d[0]!==g&&(b.uniform1i(this.addr,g),d[0]=g),a.setTexture3D(r||Q2,g)}function h8(b,r,a){let d=this.cache,g=a.allocateTextureUnit();d[0]!==g&&(b.uniform1i(this.addr,g),d[0]=g),a.setTextureCube(r||X2,g)}function d8(b,r,a){let d=this.cache,g=a.allocateTextureUnit();d[0]!==g&&(b.uniform1i(this.addr,g),d[0]=g),a.setTexture2DArray(r||j2,g)}function f8(b){switch(b){case 5126:return q5;case 35664:return Y5;case 35665:return K5;case 35666:return $5;case 35674:return J5;case 35675:return Z5;case 35676:return e8;case 5124:case 35670:return t8;case 35667:case 35671:return n8;case 35668:case 35672:return i8;case 35669:case 35673:return r8;case 5125:return s8;case 36294:return o8;case 36295:return a8;case 36296:return c8;case 35678:case 36198:case 36298:case 36306:case 35682:return l8;case 35679:case 36299:case 36307:return u8;case 35680:case 36300:case 36308:case 36293:return h8;case 36289:case 36303:case 36311:case 36292:return d8}}function p8(b,r){b.uniform1fv(this.addr,r)}function m8(b,r){let a=Ed(r,this.size,2);b.uniform2fv(this.addr,a)}function g8(b,r){let a=Ed(r,this.size,3);b.uniform3fv(this.addr,a)}function A8(b,r){let a=Ed(r,this.size,4);b.uniform4fv(this.addr,a)}function v8(b,r){let a=Ed(r,this.size,4);b.uniformMatrix2fv(this.addr,!1,a)}function y8(b,r){let a=Ed(r,this.size,9);b.uniformMatrix3fv(this.addr,!1,a)}function x8(b,r){let a=Ed(r,this.size,16);b.uniformMatrix4fv(this.addr,!1,a)}function E8(b,r){b.uniform1iv(this.addr,r)}function _8(b,r){b.uniform2iv(this.addr,r)}function b8(b,r){b.uniform3iv(this.addr,r)}function M8(b,r){b.uniform4iv(this.addr,r)}function w8(b,r){b.uniform1uiv(this.addr,r)}function C8(b,r){b.uniform2uiv(this.addr,r)}function S8(b,r){b.uniform3uiv(this.addr,r)}function T8(b,r){b.uniform4uiv(this.addr,r)}function I8(b,r,a){let d=this.cache,g=r.length,_=B0(a,g);ws(d,_)||(b.uniform1iv(this.addr,_),Cs(d,_));for(let C=0;C!==g;++C)a.setTexture2D(r[C]||W2,_[C])}function R8(b,r,a){let d=this.cache,g=r.length,_=B0(a,g);ws(d,_)||(b.uniform1iv(this.addr,_),Cs(d,_));for(let C=0;C!==g;++C)a.setTexture3D(r[C]||Q2,_[C])}function D8(b,r,a){let d=this.cache,g=r.length,_=B0(a,g);ws(d,_)||(b.uniform1iv(this.addr,_),Cs(d,_));for(let C=0;C!==g;++C)a.setTextureCube(r[C]||X2,_[C])}function L8(b,r,a){let d=this.cache,g=r.length,_=B0(a,g);ws(d,_)||(b.uniform1iv(this.addr,_),Cs(d,_));for(let C=0;C!==g;++C)a.setTexture2DArray(r[C]||j2,_[C])}function P8(b){switch(b){case 5126:return p8;case 35664:return m8;case 35665:return g8;case 35666:return A8;case 35674:return v8;case 35675:return y8;case 35676:return x8;case 5124:case 35670:return E8;case 35667:case 35671:return _8;case 35668:case 35672:return b8;case 35669:case 35673:return M8;case 5125:return w8;case 36294:return C8;case 36295:return S8;case 36296:return T8;case 35678:case 36198:case 36298:case 36306:case 35682:return I8;case 35679:case 36299:case 36307:return R8;case 35680:case 36300:case 36308:case 36293:return D8;case 36289:case 36303:case 36311:case 36292:return L8}}class B8{constructor(r,a,d){this.id=r,this.addr=d,this.cache=[],this.setValue=f8(a.type)}}class O8{constructor(r,a,d){this.id=r,this.addr=d,this.cache=[],this.size=a.size,this.setValue=P8(a.type)}}class N8{constructor(r){this.id=r,this.seq=[],this.map={}}setValue(r,a,d){let g=this.seq;for(let _=0,C=g.length;_!==C;++_){let S=g[_];S.setValue(r,a[S.id],d)}}}let v_=/(\w+)(\])?(\[|\.)?/g;function Z2(b,r){b.seq.push(r),b.map[r.id]=r}function F8(b,r,a){let d=b.name,g=d.length;for(v_.lastIndex=0;;){let _=v_.exec(d),C=v_.lastIndex,S=_[1],B=_[2]==="]",O=_[3];if(B&&(S=S|0),O===void 0||O==="["&&C+2===g){Z2(a,O===void 0?new B8(S,b,r):new O8(S,b,r));break}else{let W=a.map[S];W===void 0&&(W=new N8(S),Z2(a,W)),a=W}}}class O0{constructor(r,a){this.seq=[],this.map={};let d=r.getProgramParameter(a,r.ACTIVE_UNIFORMS);for(let g=0;g<d;++g){let _=r.getActiveUniform(a,g),C=r.getUniformLocation(a,_.name);F8(_,C,this)}}setValue(r,a,d,g){let _=this.map[a];_!==void 0&&_.setValue(r,d,g)}setOptional(r,a,d){let g=a[d];g!==void 0&&this.setValue(r,d,g)}static upload(r,a,d,g){for(let _=0,C=a.length;_!==C;++_){let S=a[_],B=d[S.id];B.needsUpdate!==!1&&S.setValue(r,B.value,g)}}static seqWithValue(r,a){let d=[];for(let g=0,_=r.length;g!==_;++g){let C=r[g];C.id in a&&d.push(C)}return d}}function eT(b,r,a){let d=b.createShader(r);return b.shaderSource(d,a),b.compileShader(d),d}let U8=37297,k8=0;function V8(b,r){let a=b.split(`
`),d=[],g=Math.max(r-6,0),_=Math.min(r+6,a.length);for(let C=g;C<_;C++){let S=C+1;d.push(`${S===r?">":" "} ${S}: ${a[C]}`)}return d.join(`
`)}function H8(b){let r=Ir.getPrimaries(Ir.workingColorSpace),a=Ir.getPrimaries(b),d;switch(r===a?d="":r===Bu&&a===Pu?d="LinearDisplayP3ToLinearSRGB":r===Pu&&a===Bu&&(d="LinearSRGBToLinearDisplayP3"),b){case Sr:case Du:return[d,"LinearTransferOETF"];case Gr:case Zh:return[d,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",b),[d,"LinearTransferOETF"]}}function tT(b,r,a){let d=b.getShaderParameter(r,b.COMPILE_STATUS),g=b.getShaderInfoLog(r).trim();if(d&&g==="")return"";let _=/ERROR: 0:(\d+)/.exec(g);if(_){let C=parseInt(_[1]);return a.toUpperCase()+`

`+g+`

`+V8(b.getShaderSource(r),C)}else return g}function z8(b,r){let a=H8(r);return`vec4 ${b}( vec4 value ) { return ${a[0]}( ${a[1]}( value ) ); }`}function G8(b,r){let a;switch(r){case he:a="Linear";break;case ae:a="Reinhard";break;case de:a="OptimizedCineon";break;case we:a="ACESFilmic";break;case Ae:a="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",r),a="Linear"}return"vec3 "+b+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function W8(b){return[b.extensionDerivatives||b.envMapCubeUVHeight||b.bumpMap||b.normalMapTangentSpace||b.clearcoatNormalMap||b.flatShading||b.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(b.extensionFragDepth||b.logarithmicDepthBuffer)&&b.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",b.extensionDrawBuffers&&b.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(b.extensionShaderTextureLOD||b.envMap||b.transmission)&&b.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Xp).join(`
`)}function j8(b){let r=[];for(let a in b){let d=b[a];d!==!1&&r.push("#define "+a+" "+d)}return r.join(`
`)}function Q8(b,r){let a={},d=b.getProgramParameter(r,b.ACTIVE_ATTRIBUTES);for(let g=0;g<d;g++){let _=b.getActiveAttrib(r,g),C=_.name,S=1;_.type===b.FLOAT_MAT2&&(S=2),_.type===b.FLOAT_MAT3&&(S=3),_.type===b.FLOAT_MAT4&&(S=4),a[C]={type:_.type,location:b.getAttribLocation(r,C),locationSize:S}}return a}function Xp(b){return b!==""}function nT(b,r){let a=r.numSpotLightShadows+r.numSpotLightMaps-r.numSpotLightShadowsWithMaps;return b.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,r.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,a).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,r.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function iT(b,r){return b.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}let X8=/^[ \t]*#include +<([\w\d./]+)>/gm;function y_(b){return b.replace(X8,Y8)}let q8=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Y8(b,r){let a=Wi[r];if(a===void 0){let d=q8.get(r);if(d!==void 0)a=Wi[d],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',r,d);else throw new Error("Can not resolve #include <"+r+">")}return y_(a)}let K8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function rT(b){return b.replace(K8,$8)}function $8(b,r,a,d){let g="";for(let _=parseInt(r);_<parseInt(a);_++)g+=d.replace(/\[\s*i\s*\]/g,"[ "+_+" ]").replace(/UNROLLED_LOOP_INDEX/g,_);return g}function sT(b){let r="precision "+b.precision+` float;
precision `+b.precision+" int;";return b.precision==="highp"?r+=`
#define HIGH_PRECISION`:b.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:b.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function J8(b){let r="SHADOWMAP_TYPE_BASIC";return b.shadowMapType===E?r="SHADOWMAP_TYPE_PCF":b.shadowMapType===x?r="SHADOWMAP_TYPE_PCF_SOFT":b.shadowMapType===v&&(r="SHADOWMAP_TYPE_VSM"),r}function Z8(b){let r="ENVMAP_TYPE_CUBE";if(b.envMap)switch(b.envMapMode){case Ge:case ee:r="ENVMAP_TYPE_CUBE";break;case pe:r="ENVMAP_TYPE_CUBE_UV";break}return r}function e6(b){let r="ENVMAP_MODE_REFLECTION";if(b.envMap)switch(b.envMapMode){case ee:r="ENVMAP_MODE_REFRACTION";break}return r}function t6(b){let r="ENVMAP_BLENDING_NONE";if(b.envMap)switch(b.combine){case Ie:r="ENVMAP_BLENDING_MULTIPLY";break;case yt:r="ENVMAP_BLENDING_MIX";break;case kt:r="ENVMAP_BLENDING_ADD";break}return r}function n6(b){let r=b.envMapCubeUVHeight;if(r===null)return null;let a=Math.log2(r)-2,d=1/r;return{texelWidth:1/(3*Math.max(Math.pow(2,a),7*16)),texelHeight:d,maxMip:a}}function i6(b,r,a,d){let g=b.getContext(),_=a.defines,C=a.vertexShader,S=a.fragmentShader,B=J8(a),O=Z8(a),H=e6(a),W=t6(a),j=n6(a),J=a.isWebGL2?"":W8(a),ie=j8(_),fe=g.createProgram(),se,K,Pe=a.glslVersion?"#version "+a.glslVersion+`
`:"",ve=a.numMultiviewViews;a.isRawShaderMaterial?(se=["#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,ie].filter(Xp).join(`
`),se.length>0&&(se+=`
`),K=[J,"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,ie].filter(Xp).join(`
`),K.length>0&&(K+=`
`)):(se=[sT(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,ie,a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+H:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.displacementMap?"#define USE_DISPLACEMENTMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.mapUv?"#define MAP_UV "+a.mapUv:"",a.alphaMapUv?"#define ALPHAMAP_UV "+a.alphaMapUv:"",a.lightMapUv?"#define LIGHTMAP_UV "+a.lightMapUv:"",a.aoMapUv?"#define AOMAP_UV "+a.aoMapUv:"",a.emissiveMapUv?"#define EMISSIVEMAP_UV "+a.emissiveMapUv:"",a.bumpMapUv?"#define BUMPMAP_UV "+a.bumpMapUv:"",a.normalMapUv?"#define NORMALMAP_UV "+a.normalMapUv:"",a.displacementMapUv?"#define DISPLACEMENTMAP_UV "+a.displacementMapUv:"",a.metalnessMapUv?"#define METALNESSMAP_UV "+a.metalnessMapUv:"",a.roughnessMapUv?"#define ROUGHNESSMAP_UV "+a.roughnessMapUv:"",a.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+a.anisotropyMapUv:"",a.clearcoatMapUv?"#define CLEARCOATMAP_UV "+a.clearcoatMapUv:"",a.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+a.clearcoatNormalMapUv:"",a.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+a.clearcoatRoughnessMapUv:"",a.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+a.iridescenceMapUv:"",a.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+a.iridescenceThicknessMapUv:"",a.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+a.sheenColorMapUv:"",a.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+a.sheenRoughnessMapUv:"",a.specularMapUv?"#define SPECULARMAP_UV "+a.specularMapUv:"",a.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+a.specularColorMapUv:"",a.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+a.specularIntensityMapUv:"",a.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+a.transmissionMapUv:"",a.thicknessMapUv?"#define THICKNESSMAP_UV "+a.thicknessMapUv:"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&a.flatShading===!1?"#define USE_MORPHNORMALS":"",a.morphColors&&a.isWebGL2?"#define USE_MORPHCOLORS":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+a.morphTextureStride:"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_COUNT "+a.morphTargetsCount:"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+B:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Xp).join(`
`),K=[J,sT(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,ie,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+O:"",a.envMap?"#define "+H:"",a.envMap?"#define "+W:"",j?"#define CUBEUV_TEXEL_WIDTH "+j.texelWidth:"",j?"#define CUBEUV_TEXEL_HEIGHT "+j.texelHeight:"",j?"#define CUBEUV_MAX_MIP "+j.maxMip+".0":"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoat?"#define USE_CLEARCOAT":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescence?"#define USE_IRIDESCENCE":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaTest?"#define USE_ALPHATEST":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.sheen?"#define USE_SHEEN":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+B:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==De?"#define TONE_MAPPING":"",a.toneMapping!==De?Wi.tonemapping_pars_fragment:"",a.toneMapping!==De?G8("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.opaque?"#define OPAQUE":"",Wi.colorspace_pars_fragment,z8("linearToOutputTexel",a.outputColorSpace),a.useDepthPacking?"#define DEPTH_PACKING "+a.depthPacking:"",`
`].filter(Xp).join(`
`)),C=y_(C),C=nT(C,a),C=iT(C,a),S=y_(S),S=nT(S,a),S=iT(S,a),C=rT(C),S=rT(S),a.isWebGL2&&a.isRawShaderMaterial!==!0&&(Pe=`#version 300 es
`,se=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+se,K=["precision mediump sampler2DArray;","#define varying in",a.glslVersion===Bp?"":"layout(location = 0) out highp vec4 pc_fragColor;",a.glslVersion===Bp?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+K,ve>0&&(se=["#extension GL_OVR_multiview : require","layout(num_views = "+ve+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+se,se=se.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+ve+"];","uniform mat4 projectionMatrices["+ve+"];","uniform mat4 viewMatrices["+ve+"];","uniform mat3 normalMatrices["+ve+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),K=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+K,K=K.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+ve+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));let Te=Pe+se+C,We=Pe+K+S,qe=eT(g,g.VERTEX_SHADER,Te),st=eT(g,g.FRAGMENT_SHADER,We);g.attachShader(fe,qe),g.attachShader(fe,st),a.index0AttributeName!==void 0?g.bindAttribLocation(fe,0,a.index0AttributeName):a.morphTargets===!0&&g.bindAttribLocation(fe,0,"position"),g.linkProgram(fe);function lt(Dt){if(b.debug.checkShaderErrors){let Qt=g.getProgramInfoLog(fe).trim(),dt=g.getShaderInfoLog(qe).trim(),wt=g.getShaderInfoLog(st).trim(),Kt=!0,$t=!0;if(g.getProgramParameter(fe,g.LINK_STATUS)===!1)if(Kt=!1,typeof b.debug.onShaderError=="function")b.debug.onShaderError(g,fe,qe,st);else{let un=tT(g,qe,"vertex"),Zt=tT(g,st,"fragment");console.error("THREE.WebGLProgram: Shader Error "+g.getError()+" - VALIDATE_STATUS "+g.getProgramParameter(fe,g.VALIDATE_STATUS)+`

Program Info Log: `+Qt+`
`+un+`
`+Zt)}else Qt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Qt):(dt===""||wt==="")&&($t=!1);$t&&(Dt.diagnostics={runnable:Kt,programLog:Qt,vertexShader:{log:dt,prefix:se},fragmentShader:{log:wt,prefix:K}})}g.deleteShader(qe),g.deleteShader(st),Ve=new O0(g,fe),Ke=Q8(g,fe)}let Ve;this.getUniforms=function(){return Ve===void 0&&lt(this),Ve};let Ke;this.getAttributes=function(){return Ke===void 0&&lt(this),Ke};let ct=a.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ct===!1&&(ct=g.getProgramParameter(fe,U8)),ct},this.destroy=function(){d.releaseStatesOfProgram(this),g.deleteProgram(fe),this.program=void 0},this.type=a.shaderType,this.name=a.shaderName,this.id=k8++,this.cacheKey=r,this.usedTimes=1,this.program=fe,this.vertexShader=qe,this.fragmentShader=st,this.numMultiviewViews=ve,this}let r6=0;class s6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(r){let a=r.vertexShader,d=r.fragmentShader,g=this._getShaderStage(a),_=this._getShaderStage(d),C=this._getShaderCacheForMaterial(r);return C.has(g)===!1&&(C.add(g),g.usedTimes++),C.has(_)===!1&&(C.add(_),_.usedTimes++),this}remove(r){let a=this.materialCache.get(r);for(let d of a)d.usedTimes--,d.usedTimes===0&&this.shaderCache.delete(d.code);return this.materialCache.delete(r),this}getVertexShaderID(r){return this._getShaderStage(r.vertexShader).id}getFragmentShaderID(r){return this._getShaderStage(r.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(r){let a=this.materialCache,d=a.get(r);return d===void 0&&(d=new Set,a.set(r,d)),d}_getShaderStage(r){let a=this.shaderCache,d=a.get(r);return d===void 0&&(d=new o6(r),a.set(r,d)),d}}class o6{constructor(r){this.id=r6++,this.code=r,this.usedTimes=0}}function a6(b,r,a,d,g,_,C){let S=new m0,B=new s6,O=[],H=g.isWebGL2,W=g.logarithmicDepthBuffer,j=g.vertexTextures,J=g.precision,ie={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function fe(Ve){return Ve===0?"uv":`uv${Ve}`}function se(Ve,Ke,ct,Dt,Qt){let dt=Dt.fog,wt=Qt.geometry,Kt=Ve.isMeshStandardMaterial?Dt.environment:null,$t=(Ve.isMeshStandardMaterial?a:r).get(Ve.envMap||Kt),un=$t&&$t.mapping===pe?$t.image.height:null,Zt=ie[Ve.type];Ve.precision!==null&&(J=g.getMaxPrecision(Ve.precision),J!==Ve.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ve.precision,"not supported, using",J,"instead."));let An=wt.morphAttributes.position||wt.morphAttributes.normal||wt.morphAttributes.color,gn=An!==void 0?An.length:0,Qn=0;wt.morphAttributes.position!==void 0&&(Qn=1),wt.morphAttributes.normal!==void 0&&(Qn=2),wt.morphAttributes.color!==void 0&&(Qn=3);let ji,Ni,Xt,Tn;if(Zt){let bn=za[Zt];ji=bn.vertexShader,Ni=bn.fragmentShader}else ji=Ve.vertexShader,Ni=Ve.fragmentShader,B.update(Ve),Xt=B.getVertexShaderID(Ve),Tn=B.getFragmentShaderID(Ve);let Mn=b.getRenderTarget(),bi=Mn&&Mn.isWebGLMultiviewRenderTarget?Mn.numViews:0,ei=Qt.isInstancedMesh===!0,ii=!!Ve.map,vi=!!Ve.matcap,on=!!$t,ft=!!Ve.aoMap,dn=!!Ve.lightMap,Dn=!!Ve.bumpMap,an=!!Ve.normalMap,Vn=!!Ve.displacementMap,pi=!!Ve.emissiveMap,ti=!!Ve.metalnessMap,mi=!!Ve.roughnessMap,hr=Ve.anisotropy>0,$r=Ve.clearcoat>0,Ss=Ve.iridescence>0,Br=Ve.sheen>0,Tr=Ve.transmission>0,hs=hr&&!!Ve.anisotropyMap,Ho=$r&&!!Ve.clearcoatMap,Je=$r&&!!Ve.clearcoatNormalMap,ke=$r&&!!Ve.clearcoatRoughnessMap,Nt=Ss&&!!Ve.iridescenceMap,ln=Ss&&!!Ve.iridescenceThicknessMap,fn=Br&&!!Ve.sheenColorMap,hn=Br&&!!Ve.sheenRoughnessMap,li=!!Ve.specularMap,kn=!!Ve.specularColorMap,Yn=!!Ve.specularIntensityMap,gi=Tr&&!!Ve.transmissionMap,pr=Tr&&!!Ve.thicknessMap,wn=!!Ve.gradientMap,ts=!!Ve.alphaMap,ht=Ve.alphaTest>0,_n=!!Ve.alphaHash,rn=!!Ve.extensions,vn=!!wt.attributes.uv1,Fn=!!wt.attributes.uv2,Di=!!wt.attributes.uv3,er=De;return Ve.toneMapped&&(Mn===null||Mn.isXRRenderTarget===!0)&&(er=b.toneMapping),{isWebGL2:H,shaderID:Zt,shaderType:Ve.type,shaderName:Ve.name,vertexShader:ji,fragmentShader:Ni,defines:Ve.defines,customVertexShaderID:Xt,customFragmentShaderID:Tn,isRawShaderMaterial:Ve.isRawShaderMaterial===!0,glslVersion:Ve.glslVersion,precision:J,instancing:ei,instancingColor:ei&&Qt.instanceColor!==null,supportsVertexTextures:j,numMultiviewViews:bi,outputColorSpace:Mn===null?b.outputColorSpace:Mn.isXRRenderTarget===!0?Mn.texture.colorSpace:Sr,map:ii,matcap:vi,envMap:on,envMapMode:on&&$t.mapping,envMapCubeUVHeight:un,aoMap:ft,lightMap:dn,bumpMap:Dn,normalMap:an,displacementMap:j&&Vn,emissiveMap:pi,normalMapObjectSpace:an&&Ve.normalMapType===cc,normalMapTangentSpace:an&&Ve.normalMapType===Os,metalnessMap:ti,roughnessMap:mi,anisotropy:hr,anisotropyMap:hs,clearcoat:$r,clearcoatMap:Ho,clearcoatNormalMap:Je,clearcoatRoughnessMap:ke,iridescence:Ss,iridescenceMap:Nt,iridescenceThicknessMap:ln,sheen:Br,sheenColorMap:fn,sheenRoughnessMap:hn,specularMap:li,specularColorMap:kn,specularIntensityMap:Yn,transmission:Tr,transmissionMap:gi,thicknessMap:pr,gradientMap:wn,opaque:Ve.transparent===!1&&Ve.blending===I,alphaMap:ts,alphaTest:ht,alphaHash:_n,combine:Ve.combine,mapUv:ii&&fe(Ve.map.channel),aoMapUv:ft&&fe(Ve.aoMap.channel),lightMapUv:dn&&fe(Ve.lightMap.channel),bumpMapUv:Dn&&fe(Ve.bumpMap.channel),normalMapUv:an&&fe(Ve.normalMap.channel),displacementMapUv:Vn&&fe(Ve.displacementMap.channel),emissiveMapUv:pi&&fe(Ve.emissiveMap.channel),metalnessMapUv:ti&&fe(Ve.metalnessMap.channel),roughnessMapUv:mi&&fe(Ve.roughnessMap.channel),anisotropyMapUv:hs&&fe(Ve.anisotropyMap.channel),clearcoatMapUv:Ho&&fe(Ve.clearcoatMap.channel),clearcoatNormalMapUv:Je&&fe(Ve.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ke&&fe(Ve.clearcoatRoughnessMap.channel),iridescenceMapUv:Nt&&fe(Ve.iridescenceMap.channel),iridescenceThicknessMapUv:ln&&fe(Ve.iridescenceThicknessMap.channel),sheenColorMapUv:fn&&fe(Ve.sheenColorMap.channel),sheenRoughnessMapUv:hn&&fe(Ve.sheenRoughnessMap.channel),specularMapUv:li&&fe(Ve.specularMap.channel),specularColorMapUv:kn&&fe(Ve.specularColorMap.channel),specularIntensityMapUv:Yn&&fe(Ve.specularIntensityMap.channel),transmissionMapUv:gi&&fe(Ve.transmissionMap.channel),thicknessMapUv:pr&&fe(Ve.thicknessMap.channel),alphaMapUv:ts&&fe(Ve.alphaMap.channel),vertexTangents:!!wt.attributes.tangent&&(an||hr),vertexColors:Ve.vertexColors,vertexAlphas:Ve.vertexColors===!0&&!!wt.attributes.color&&wt.attributes.color.itemSize===4,vertexUv1s:vn,vertexUv2s:Fn,vertexUv3s:Di,pointsUvs:Qt.isPoints===!0&&!!wt.attributes.uv&&(ii||ts),fog:!!dt,useFog:Ve.fog===!0,fogExp2:dt&&dt.isFogExp2,flatShading:Ve.flatShading===!0,sizeAttenuation:Ve.sizeAttenuation===!0,logarithmicDepthBuffer:W,skinning:Qt.isSkinnedMesh===!0,morphTargets:wt.morphAttributes.position!==void 0,morphNormals:wt.morphAttributes.normal!==void 0,morphColors:wt.morphAttributes.color!==void 0,morphTargetsCount:gn,morphTextureStride:Qn,numDirLights:Ke.directional.length,numPointLights:Ke.point.length,numSpotLights:Ke.spot.length,numSpotLightMaps:Ke.spotLightMap.length,numRectAreaLights:Ke.rectArea.length,numHemiLights:Ke.hemi.length,numDirLightShadows:Ke.directionalShadowMap.length,numPointLightShadows:Ke.pointShadowMap.length,numSpotLightShadows:Ke.spotShadowMap.length,numSpotLightShadowsWithMaps:Ke.numSpotLightShadowsWithMaps,numLightProbes:Ke.numLightProbes,numClippingPlanes:C.numPlanes,numClipIntersection:C.numIntersection,dithering:Ve.dithering,shadowMapEnabled:b.shadowMap.enabled&&ct.length>0,shadowMapType:b.shadowMap.type,toneMapping:er,useLegacyLights:b._useLegacyLights,decodeVideoTexture:ii&&Ve.map.isVideoTexture===!0&&Ir.getTransfer(Ve.map.colorSpace)===Ur,premultipliedAlpha:Ve.premultipliedAlpha,doubleSided:Ve.side===T,flipSided:Ve.side===M,useDepthPacking:Ve.depthPacking>=0,depthPacking:Ve.depthPacking||0,index0AttributeName:Ve.index0AttributeName,extensionDerivatives:rn&&Ve.extensions.derivatives===!0,extensionFragDepth:rn&&Ve.extensions.fragDepth===!0,extensionDrawBuffers:rn&&Ve.extensions.drawBuffers===!0,extensionShaderTextureLOD:rn&&Ve.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:H||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:H||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:H||d.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:d.has("KHR_parallel_shader_compile"),customProgramCacheKey:Ve.customProgramCacheKey()}}function K(Ve){let Ke=[];if(Ve.shaderID?Ke.push(Ve.shaderID):(Ke.push(Ve.customVertexShaderID),Ke.push(Ve.customFragmentShaderID)),Ve.defines!==void 0)for(let ct in Ve.defines)Ke.push(ct),Ke.push(Ve.defines[ct]);return Ve.isRawShaderMaterial===!1&&(Pe(Ke,Ve),ve(Ke,Ve),Ke.push(b.outputColorSpace)),Ke.push(Ve.customProgramCacheKey),Ke.join()}function Pe(Ve,Ke){Ve.push(Ke.precision),Ve.push(Ke.outputColorSpace),Ve.push(Ke.envMapMode),Ve.push(Ke.envMapCubeUVHeight),Ve.push(Ke.mapUv),Ve.push(Ke.alphaMapUv),Ve.push(Ke.lightMapUv),Ve.push(Ke.aoMapUv),Ve.push(Ke.bumpMapUv),Ve.push(Ke.normalMapUv),Ve.push(Ke.displacementMapUv),Ve.push(Ke.emissiveMapUv),Ve.push(Ke.metalnessMapUv),Ve.push(Ke.roughnessMapUv),Ve.push(Ke.anisotropyMapUv),Ve.push(Ke.clearcoatMapUv),Ve.push(Ke.clearcoatNormalMapUv),Ve.push(Ke.clearcoatRoughnessMapUv),Ve.push(Ke.iridescenceMapUv),Ve.push(Ke.iridescenceThicknessMapUv),Ve.push(Ke.sheenColorMapUv),Ve.push(Ke.sheenRoughnessMapUv),Ve.push(Ke.specularMapUv),Ve.push(Ke.specularColorMapUv),Ve.push(Ke.specularIntensityMapUv),Ve.push(Ke.transmissionMapUv),Ve.push(Ke.thicknessMapUv),Ve.push(Ke.combine),Ve.push(Ke.fogExp2),Ve.push(Ke.sizeAttenuation),Ve.push(Ke.morphTargetsCount),Ve.push(Ke.morphAttributeCount),Ve.push(Ke.numDirLights),Ve.push(Ke.numPointLights),Ve.push(Ke.numSpotLights),Ve.push(Ke.numSpotLightMaps),Ve.push(Ke.numHemiLights),Ve.push(Ke.numRectAreaLights),Ve.push(Ke.numDirLightShadows),Ve.push(Ke.numPointLightShadows),Ve.push(Ke.numSpotLightShadows),Ve.push(Ke.numSpotLightShadowsWithMaps),Ve.push(Ke.numLightProbes),Ve.push(Ke.shadowMapType),Ve.push(Ke.toneMapping),Ve.push(Ke.numClippingPlanes),Ve.push(Ke.numClipIntersection),Ve.push(Ke.depthPacking)}function ve(Ve,Ke){S.disableAll(),Ke.isWebGL2&&S.enable(0),Ke.supportsVertexTextures&&S.enable(1),Ke.instancing&&S.enable(2),Ke.instancingColor&&S.enable(3),Ke.matcap&&S.enable(4),Ke.envMap&&S.enable(5),Ke.normalMapObjectSpace&&S.enable(6),Ke.normalMapTangentSpace&&S.enable(7),Ke.clearcoat&&S.enable(8),Ke.iridescence&&S.enable(9),Ke.alphaTest&&S.enable(10),Ke.vertexColors&&S.enable(11),Ke.vertexAlphas&&S.enable(12),Ke.vertexUv1s&&S.enable(13),Ke.vertexUv2s&&S.enable(14),Ke.vertexUv3s&&S.enable(15),Ke.vertexTangents&&S.enable(16),Ke.anisotropy&&S.enable(17),Ke.alphaHash&&S.enable(18),Ve.push(S.mask),S.disableAll(),Ke.fog&&S.enable(0),Ke.useFog&&S.enable(1),Ke.flatShading&&S.enable(2),Ke.logarithmicDepthBuffer&&S.enable(3),Ke.skinning&&S.enable(4),Ke.morphTargets&&S.enable(5),Ke.morphNormals&&S.enable(6),Ke.morphColors&&S.enable(7),Ke.premultipliedAlpha&&S.enable(8),Ke.shadowMapEnabled&&S.enable(9),Ke.useLegacyLights&&S.enable(10),Ke.doubleSided&&S.enable(11),Ke.flipSided&&S.enable(12),Ke.useDepthPacking&&S.enable(13),Ke.dithering&&S.enable(14),Ke.transmission&&S.enable(15),Ke.sheen&&S.enable(16),Ke.opaque&&S.enable(17),Ke.pointsUvs&&S.enable(18),Ke.decodeVideoTexture&&S.enable(19),Ke.numMultiviewViews&&S.enable(20),Ve.push(S.mask)}function Te(Ve){let Ke=ie[Ve.type],ct;if(Ke){let Dt=za[Ke];ct=O2.clone(Dt.uniforms)}else ct=Ve.uniforms;return ct}function We(Ve,Ke){let ct;for(let Dt=0,Qt=O.length;Dt<Qt;Dt++){let dt=O[Dt];if(dt.cacheKey===Ke){ct=dt,++ct.usedTimes;break}}return ct===void 0&&(ct=new i6(b,Ke,Ve,_),O.push(ct)),ct}function qe(Ve){if(--Ve.usedTimes===0){let Ke=O.indexOf(Ve);O[Ke]=O[O.length-1],O.pop(),Ve.destroy()}}function st(Ve){B.remove(Ve)}function lt(){B.dispose()}return{getParameters:se,getProgramCacheKey:K,getUniforms:Te,acquireProgram:We,releaseProgram:qe,releaseShaderCache:st,programs:O,dispose:lt}}function c6(){let b=new WeakMap;function r(_){let C=b.get(_);return C===void 0&&(C={},b.set(_,C)),C}function a(_){b.delete(_)}function d(_,C,S){b.get(_)[C]=S}function g(){b=new WeakMap}return{get:r,remove:a,update:d,dispose:g}}function l6(b,r){return b.groupOrder!==r.groupOrder?b.groupOrder-r.groupOrder:b.renderOrder!==r.renderOrder?b.renderOrder-r.renderOrder:b.material.id!==r.material.id?b.material.id-r.material.id:b.z!==r.z?b.z-r.z:b.id-r.id}function oT(b,r){return b.groupOrder!==r.groupOrder?b.groupOrder-r.groupOrder:b.renderOrder!==r.renderOrder?b.renderOrder-r.renderOrder:b.z!==r.z?r.z-b.z:b.id-r.id}function aT(){let b=[],r=0,a=[],d=[],g=[];function _(){r=0,a.length=0,d.length=0,g.length=0}function C(W,j,J,ie,fe,se){let K=b[r];return K===void 0?(K={id:W.id,object:W,geometry:j,material:J,groupOrder:ie,renderOrder:W.renderOrder,z:fe,group:se},b[r]=K):(K.id=W.id,K.object=W,K.geometry=j,K.material=J,K.groupOrder=ie,K.renderOrder=W.renderOrder,K.z=fe,K.group=se),r++,K}function S(W,j,J,ie,fe,se){let K=C(W,j,J,ie,fe,se);J.transmission>0?d.push(K):J.transparent===!0?g.push(K):a.push(K)}function B(W,j,J,ie,fe,se){let K=C(W,j,J,ie,fe,se);J.transmission>0?d.unshift(K):J.transparent===!0?g.unshift(K):a.unshift(K)}function O(W,j){a.length>1&&a.sort(W||l6),d.length>1&&d.sort(j||oT),g.length>1&&g.sort(j||oT)}function H(){for(let W=r,j=b.length;W<j;W++){let J=b[W];if(J.id===null)break;J.id=null,J.object=null,J.geometry=null,J.material=null,J.group=null}}return{opaque:a,transmissive:d,transparent:g,init:_,push:S,unshift:B,finish:H,sort:O}}function u6(){let b=new WeakMap;function r(d,g){let _=b.get(d),C;return _===void 0?(C=new aT,b.set(d,[C])):g>=_.length?(C=new aT,_.push(C)):C=_[g],C}function a(){b=new WeakMap}return{get:r,dispose:a}}function h6(){let b={};return{get:function(r){if(b[r.id]!==void 0)return b[r.id];let a;switch(r.type){case"DirectionalLight":a={direction:new Ye,color:new jn};break;case"SpotLight":a={position:new Ye,direction:new Ye,color:new jn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":a={position:new Ye,color:new jn,distance:0,decay:0};break;case"HemisphereLight":a={direction:new Ye,skyColor:new jn,groundColor:new jn};break;case"RectAreaLight":a={color:new jn,position:new Ye,halfWidth:new Ye,halfHeight:new Ye};break}return b[r.id]=a,a}}}function d6(){let b={};return{get:function(r){if(b[r.id]!==void 0)return b[r.id];let a;switch(r.type){case"DirectionalLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"SpotLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"PointLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn,shadowCameraNear:1,shadowCameraFar:1e3};break}return b[r.id]=a,a}}}let f6=0;function p6(b,r){return(r.castShadow?2:0)-(b.castShadow?2:0)+(r.map?1:0)-(b.map?1:0)}function m6(b,r){let a=new h6,d=d6(),g={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let H=0;H<9;H++)g.probe.push(new Ye);let _=new Ye,C=new _i,S=new _i;function B(H,W){let j=0,J=0,ie=0;for(let Dt=0;Dt<9;Dt++)g.probe[Dt].set(0,0,0);let fe=0,se=0,K=0,Pe=0,ve=0,Te=0,We=0,qe=0,st=0,lt=0,Ve=0;H.sort(p6);let Ke=W===!0?Math.PI:1;for(let Dt=0,Qt=H.length;Dt<Qt;Dt++){let dt=H[Dt],wt=dt.color,Kt=dt.intensity,$t=dt.distance,un=dt.shadow&&dt.shadow.map?dt.shadow.map.texture:null;if(dt.isAmbientLight)j+=wt.r*Kt*Ke,J+=wt.g*Kt*Ke,ie+=wt.b*Kt*Ke;else if(dt.isLightProbe){for(let Zt=0;Zt<9;Zt++)g.probe[Zt].addScaledVector(dt.sh.coefficients[Zt],Kt);Ve++}else if(dt.isDirectionalLight){let Zt=a.get(dt);if(Zt.color.copy(dt.color).multiplyScalar(dt.intensity*Ke),dt.castShadow){let An=dt.shadow,gn=d.get(dt);gn.shadowBias=An.bias,gn.shadowNormalBias=An.normalBias,gn.shadowRadius=An.radius,gn.shadowMapSize=An.mapSize,g.directionalShadow[fe]=gn,g.directionalShadowMap[fe]=un,g.directionalShadowMatrix[fe]=dt.shadow.matrix,Te++}g.directional[fe]=Zt,fe++}else if(dt.isSpotLight){let Zt=a.get(dt);Zt.position.setFromMatrixPosition(dt.matrixWorld),Zt.color.copy(wt).multiplyScalar(Kt*Ke),Zt.distance=$t,Zt.coneCos=Math.cos(dt.angle),Zt.penumbraCos=Math.cos(dt.angle*(1-dt.penumbra)),Zt.decay=dt.decay,g.spot[K]=Zt;let An=dt.shadow;if(dt.map&&(g.spotLightMap[st]=dt.map,st++,An.updateMatrices(dt),dt.castShadow&&lt++),g.spotLightMatrix[K]=An.matrix,dt.castShadow){let gn=d.get(dt);gn.shadowBias=An.bias,gn.shadowNormalBias=An.normalBias,gn.shadowRadius=An.radius,gn.shadowMapSize=An.mapSize,g.spotShadow[K]=gn,g.spotShadowMap[K]=un,qe++}K++}else if(dt.isRectAreaLight){let Zt=a.get(dt);Zt.color.copy(wt).multiplyScalar(Kt),Zt.halfWidth.set(dt.width*.5,0,0),Zt.halfHeight.set(0,dt.height*.5,0),g.rectArea[Pe]=Zt,Pe++}else if(dt.isPointLight){let Zt=a.get(dt);if(Zt.color.copy(dt.color).multiplyScalar(dt.intensity*Ke),Zt.distance=dt.distance,Zt.decay=dt.decay,dt.castShadow){let An=dt.shadow,gn=d.get(dt);gn.shadowBias=An.bias,gn.shadowNormalBias=An.normalBias,gn.shadowRadius=An.radius,gn.shadowMapSize=An.mapSize,gn.shadowCameraNear=An.camera.near,gn.shadowCameraFar=An.camera.far,g.pointShadow[se]=gn,g.pointShadowMap[se]=un,g.pointShadowMatrix[se]=dt.shadow.matrix,We++}g.point[se]=Zt,se++}else if(dt.isHemisphereLight){let Zt=a.get(dt);Zt.skyColor.copy(dt.color).multiplyScalar(Kt*Ke),Zt.groundColor.copy(dt.groundColor).multiplyScalar(Kt*Ke),g.hemi[ve]=Zt,ve++}}Pe>0&&(r.isWebGL2||b.has("OES_texture_float_linear")===!0?(g.rectAreaLTC1=Nn.LTC_FLOAT_1,g.rectAreaLTC2=Nn.LTC_FLOAT_2):b.has("OES_texture_half_float_linear")===!0?(g.rectAreaLTC1=Nn.LTC_HALF_1,g.rectAreaLTC2=Nn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),g.ambient[0]=j,g.ambient[1]=J,g.ambient[2]=ie;let ct=g.hash;(ct.directionalLength!==fe||ct.pointLength!==se||ct.spotLength!==K||ct.rectAreaLength!==Pe||ct.hemiLength!==ve||ct.numDirectionalShadows!==Te||ct.numPointShadows!==We||ct.numSpotShadows!==qe||ct.numSpotMaps!==st||ct.numLightProbes!==Ve)&&(g.directional.length=fe,g.spot.length=K,g.rectArea.length=Pe,g.point.length=se,g.hemi.length=ve,g.directionalShadow.length=Te,g.directionalShadowMap.length=Te,g.pointShadow.length=We,g.pointShadowMap.length=We,g.spotShadow.length=qe,g.spotShadowMap.length=qe,g.directionalShadowMatrix.length=Te,g.pointShadowMatrix.length=We,g.spotLightMatrix.length=qe+st-lt,g.spotLightMap.length=st,g.numSpotLightShadowsWithMaps=lt,g.numLightProbes=Ve,ct.directionalLength=fe,ct.pointLength=se,ct.spotLength=K,ct.rectAreaLength=Pe,ct.hemiLength=ve,ct.numDirectionalShadows=Te,ct.numPointShadows=We,ct.numSpotShadows=qe,ct.numSpotMaps=st,ct.numLightProbes=Ve,g.version=f6++)}function O(H,W){let j=0,J=0,ie=0,fe=0,se=0,K=W.matrixWorldInverse;for(let Pe=0,ve=H.length;Pe<ve;Pe++){let Te=H[Pe];if(Te.isDirectionalLight){let We=g.directional[j];We.direction.setFromMatrixPosition(Te.matrixWorld),_.setFromMatrixPosition(Te.target.matrixWorld),We.direction.sub(_),We.direction.transformDirection(K),j++}else if(Te.isSpotLight){let We=g.spot[ie];We.position.setFromMatrixPosition(Te.matrixWorld),We.position.applyMatrix4(K),We.direction.setFromMatrixPosition(Te.matrixWorld),_.setFromMatrixPosition(Te.target.matrixWorld),We.direction.sub(_),We.direction.transformDirection(K),ie++}else if(Te.isRectAreaLight){let We=g.rectArea[fe];We.position.setFromMatrixPosition(Te.matrixWorld),We.position.applyMatrix4(K),S.identity(),C.copy(Te.matrixWorld),C.premultiply(K),S.extractRotation(C),We.halfWidth.set(Te.width*.5,0,0),We.halfHeight.set(0,Te.height*.5,0),We.halfWidth.applyMatrix4(S),We.halfHeight.applyMatrix4(S),fe++}else if(Te.isPointLight){let We=g.point[J];We.position.setFromMatrixPosition(Te.matrixWorld),We.position.applyMatrix4(K),J++}else if(Te.isHemisphereLight){let We=g.hemi[se];We.direction.setFromMatrixPosition(Te.matrixWorld),We.direction.transformDirection(K),se++}}}return{setup:B,setupView:O,state:g}}function cT(b,r){let a=new m6(b,r),d=[],g=[];function _(){d.length=0,g.length=0}function C(W){d.push(W)}function S(W){g.push(W)}function B(W){a.setup(d,W)}function O(W){a.setupView(d,W)}return{init:_,state:{lightsArray:d,shadowsArray:g,lights:a},setupLights:B,setupLightsView:O,pushLight:C,pushShadow:S}}function g6(b,r){let a=new WeakMap;function d(_,C=0){let S=a.get(_),B;return S===void 0?(B=new cT(b,r),a.set(_,[B])):C>=S.length?(B=new cT(b,r),S.push(B)):B=S[C],B}function g(){a=new WeakMap}return{get:d,dispose:g}}class x_ extends ho{constructor(r){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Oo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(r)}copy(r){return super.copy(r),this.depthPacking=r.depthPacking,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this}}class E_ extends ho{constructor(r){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(r)}copy(r){return super.copy(r),this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this}}let A6=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,v6=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function y6(b,r,a){let d=new R0,g=new nn,_=new nn,C=new Mr,S=new x_({depthPacking:xo}),B=new E_,O={},H=a.maxTextureSize,W={[w]:M,[M]:w,[T]:T},j=new dc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new nn},radius:{value:4}},vertexShader:A6,fragmentShader:v6}),J=j.clone();J.defines.HORIZONTAL_PASS=1;let ie=new Zi;ie.setAttribute("position",new Wr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let fe=new qs(ie,j),se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=E;let K=this.type;this.render=function(We,qe,st){if(se.enabled===!1||se.autoUpdate===!1&&se.needsUpdate===!1||We.length===0)return;let lt=b.getRenderTarget(),Ve=b.getActiveCubeFace(),Ke=b.getActiveMipmapLevel(),ct=b.state;ct.setBlending(L),ct.buffers.color.setClear(1,1,1,1),ct.buffers.depth.setTest(!0),ct.setScissorTest(!1);let Dt=K!==v&&this.type===v,Qt=K===v&&this.type!==v;for(let dt=0,wt=We.length;dt<wt;dt++){let Kt=We[dt],$t=Kt.shadow;if($t===void 0){console.warn("THREE.WebGLShadowMap:",Kt,"has no shadow.");continue}if($t.autoUpdate===!1&&$t.needsUpdate===!1)continue;g.copy($t.mapSize);let un=$t.getFrameExtents();if(g.multiply(un),_.copy($t.mapSize),(g.x>H||g.y>H)&&(g.x>H&&(_.x=Math.floor(H/un.x),g.x=_.x*un.x,$t.mapSize.x=_.x),g.y>H&&(_.y=Math.floor(H/un.y),g.y=_.y*un.y,$t.mapSize.y=_.y)),$t.map===null||Dt===!0||Qt===!0){let An=this.type!==v?{minFilter:nt,magFilter:nt}:{};$t.map!==null&&$t.map.dispose(),$t.map=new No(g.x,g.y,An),$t.map.texture.name=Kt.name+".shadowMap",$t.camera.updateProjectionMatrix()}b.setRenderTarget($t.map),b.clear();let Zt=$t.getViewportCount();for(let An=0;An<Zt;An++){let gn=$t.getViewport(An);C.set(_.x*gn.x,_.y*gn.y,_.x*gn.z,_.y*gn.w),ct.viewport(C),$t.updateMatrices(Kt,An),d=$t.getFrustum(),Te(qe,st,$t.camera,Kt,this.type)}$t.isPointLightShadow!==!0&&this.type===v&&Pe($t,st),$t.needsUpdate=!1}K=this.type,se.needsUpdate=!1,b.setRenderTarget(lt,Ve,Ke)};function Pe(We,qe){let st=r.update(fe);j.defines.VSM_SAMPLES!==We.blurSamples&&(j.defines.VSM_SAMPLES=We.blurSamples,J.defines.VSM_SAMPLES=We.blurSamples,j.needsUpdate=!0,J.needsUpdate=!0),We.mapPass===null&&(We.mapPass=new No(g.x,g.y)),j.uniforms.shadow_pass.value=We.map.texture,j.uniforms.resolution.value=We.mapSize,j.uniforms.radius.value=We.radius,b.setRenderTarget(We.mapPass),b.clear(),b.renderBufferDirect(qe,null,st,j,fe,null),J.uniforms.shadow_pass.value=We.mapPass.texture,J.uniforms.resolution.value=We.mapSize,J.uniforms.radius.value=We.radius,b.setRenderTarget(We.map),b.clear(),b.renderBufferDirect(qe,null,st,J,fe,null)}function ve(We,qe,st,lt){let Ve=null,Ke=st.isPointLight===!0?We.customDistanceMaterial:We.customDepthMaterial;if(Ke!==void 0)Ve=Ke;else if(Ve=st.isPointLight===!0?B:S,b.localClippingEnabled&&qe.clipShadows===!0&&Array.isArray(qe.clippingPlanes)&&qe.clippingPlanes.length!==0||qe.displacementMap&&qe.displacementScale!==0||qe.alphaMap&&qe.alphaTest>0||qe.map&&qe.alphaTest>0){let ct=Ve.uuid,Dt=qe.uuid,Qt=O[ct];Qt===void 0&&(Qt={},O[ct]=Qt);let dt=Qt[Dt];dt===void 0&&(dt=Ve.clone(),Qt[Dt]=dt),Ve=dt}if(Ve.visible=qe.visible,Ve.wireframe=qe.wireframe,lt===v?Ve.side=qe.shadowSide!==null?qe.shadowSide:qe.side:Ve.side=qe.shadowSide!==null?qe.shadowSide:W[qe.side],Ve.alphaMap=qe.alphaMap,Ve.alphaTest=qe.alphaTest,Ve.map=qe.map,Ve.clipShadows=qe.clipShadows,Ve.clippingPlanes=qe.clippingPlanes,Ve.clipIntersection=qe.clipIntersection,Ve.displacementMap=qe.displacementMap,Ve.displacementScale=qe.displacementScale,Ve.displacementBias=qe.displacementBias,Ve.wireframeLinewidth=qe.wireframeLinewidth,Ve.linewidth=qe.linewidth,st.isPointLight===!0&&Ve.isMeshDistanceMaterial===!0){let ct=b.properties.get(Ve);ct.light=st}return Ve}function Te(We,qe,st,lt,Ve){if(We.visible===!1)return;if(We.layers.test(qe.layers)&&(We.isMesh||We.isLine||We.isPoints)&&(We.castShadow||We.receiveShadow&&Ve===v)&&(!We.frustumCulled||d.intersectsObject(We))){We.modelViewMatrix.multiplyMatrices(st.matrixWorldInverse,We.matrixWorld);let Dt=r.update(We),Qt=We.material;if(Array.isArray(Qt)){let dt=Dt.groups;for(let wt=0,Kt=dt.length;wt<Kt;wt++){let $t=dt[wt],un=Qt[$t.materialIndex];if(un&&un.visible){let Zt=ve(We,un,lt,Ve);b.renderBufferDirect(st,null,Dt,Zt,We,$t)}}}else if(Qt.visible){let dt=ve(We,Qt,lt,Ve);b.renderBufferDirect(st,null,Dt,dt,We,null)}}let ct=We.children;for(let Dt=0,Qt=ct.length;Dt<Qt;Dt++)Te(ct[Dt],qe,st,lt,Ve)}}function x6(b,r,a){let d=a.isWebGL2;function g(){let ht=!1,_n=new Mr,rn=null,vn=new Mr(0,0,0,0);return{setMask:function(Fn){rn!==Fn&&!ht&&(b.colorMask(Fn,Fn,Fn,Fn),rn=Fn)},setLocked:function(Fn){ht=Fn},setClear:function(Fn,Di,er,Yi,bn){bn===!0&&(Fn*=Yi,Di*=Yi,er*=Yi),_n.set(Fn,Di,er,Yi),vn.equals(_n)===!1&&(b.clearColor(Fn,Di,er,Yi),vn.copy(_n))},reset:function(){ht=!1,rn=null,vn.set(-1,0,0,0)}}}function _(){let ht=!1,_n=null,rn=null,vn=null;return{setTest:function(Fn){Fn?ei(b.DEPTH_TEST):ii(b.DEPTH_TEST)},setMask:function(Fn){_n!==Fn&&!ht&&(b.depthMask(Fn),_n=Fn)},setFunc:function(Fn){if(rn!==Fn){switch(Fn){case Ne:b.depthFunc(b.NEVER);break;case pn:b.depthFunc(b.ALWAYS);break;case St:b.depthFunc(b.LESS);break;case Vt:b.depthFunc(b.LEQUAL);break;case Ot:b.depthFunc(b.EQUAL);break;case xn:b.depthFunc(b.GEQUAL);break;case Jt:b.depthFunc(b.GREATER);break;case Oe:b.depthFunc(b.NOTEQUAL);break;default:b.depthFunc(b.LEQUAL)}rn=Fn}},setLocked:function(Fn){ht=Fn},setClear:function(Fn){vn!==Fn&&(b.clearDepth(Fn),vn=Fn)},reset:function(){ht=!1,_n=null,rn=null,vn=null}}}function C(){let ht=!1,_n=null,rn=null,vn=null,Fn=null,Di=null,er=null,Yi=null,bn=null;return{setTest:function(ui){ht||(ui?ei(b.STENCIL_TEST):ii(b.STENCIL_TEST))},setMask:function(ui){_n!==ui&&!ht&&(b.stencilMask(ui),_n=ui)},setFunc:function(ui,Dr,Ys){(rn!==ui||vn!==Dr||Fn!==Ys)&&(b.stencilFunc(ui,Dr,Ys),rn=ui,vn=Dr,Fn=Ys)},setOp:function(ui,Dr,Ys){(Di!==ui||er!==Dr||Yi!==Ys)&&(b.stencilOp(ui,Dr,Ys),Di=ui,er=Dr,Yi=Ys)},setLocked:function(ui){ht=ui},setClear:function(ui){bn!==ui&&(b.clearStencil(ui),bn=ui)},reset:function(){ht=!1,_n=null,rn=null,vn=null,Fn=null,Di=null,er=null,Yi=null,bn=null}}}let S=new g,B=new _,O=new C,H=new WeakMap,W=new WeakMap,j={},J={},ie=new WeakMap,fe=[],se=null,K=!1,Pe=null,ve=null,Te=null,We=null,qe=null,st=null,lt=null,Ve=new jn(0,0,0),Ke=0,ct=!1,Dt=null,Qt=null,dt=null,wt=null,Kt=null,$t=b.getParameter(b.MAX_COMBINED_TEXTURE_IMAGE_UNITS),un=!1,Zt=0,An=b.getParameter(b.VERSION);An.indexOf("WebGL")!==-1?(Zt=parseFloat(/^WebGL (\d)/.exec(An)[1]),un=Zt>=1):An.indexOf("OpenGL ES")!==-1&&(Zt=parseFloat(/^OpenGL ES (\d)/.exec(An)[1]),un=Zt>=2);let gn=null,Qn={},ji=b.getParameter(b.SCISSOR_BOX),Ni=b.getParameter(b.VIEWPORT),Xt=new Mr().fromArray(ji),Tn=new Mr().fromArray(Ni);function Mn(ht,_n,rn,vn){let Fn=new Uint8Array(4),Di=b.createTexture();b.bindTexture(ht,Di),b.texParameteri(ht,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(ht,b.TEXTURE_MAG_FILTER,b.NEAREST);for(let er=0;er<rn;er++)d&&(ht===b.TEXTURE_3D||ht===b.TEXTURE_2D_ARRAY)?b.texImage3D(_n,0,b.RGBA,1,1,vn,0,b.RGBA,b.UNSIGNED_BYTE,Fn):b.texImage2D(_n+er,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,Fn);return Di}let bi={};bi[b.TEXTURE_2D]=Mn(b.TEXTURE_2D,b.TEXTURE_2D,1),bi[b.TEXTURE_CUBE_MAP]=Mn(b.TEXTURE_CUBE_MAP,b.TEXTURE_CUBE_MAP_POSITIVE_X,6),d&&(bi[b.TEXTURE_2D_ARRAY]=Mn(b.TEXTURE_2D_ARRAY,b.TEXTURE_2D_ARRAY,1,1),bi[b.TEXTURE_3D]=Mn(b.TEXTURE_3D,b.TEXTURE_3D,1,1)),S.setClear(0,0,0,1),B.setClear(1),O.setClear(0),ei(b.DEPTH_TEST),B.setFunc(Vt),pi(!1),ti(f),ei(b.CULL_FACE),an(L);function ei(ht){j[ht]!==!0&&(b.enable(ht),j[ht]=!0)}function ii(ht){j[ht]!==!1&&(b.disable(ht),j[ht]=!1)}function vi(ht,_n){return J[ht]!==_n?(b.bindFramebuffer(ht,_n),J[ht]=_n,d&&(ht===b.DRAW_FRAMEBUFFER&&(J[b.FRAMEBUFFER]=_n),ht===b.FRAMEBUFFER&&(J[b.DRAW_FRAMEBUFFER]=_n)),!0):!1}function on(ht,_n){let rn=fe,vn=!1;if(ht)if(rn=ie.get(_n),rn===void 0&&(rn=[],ie.set(_n,rn)),ht.isWebGLMultipleRenderTargets){let Fn=ht.texture;if(rn.length!==Fn.length||rn[0]!==b.COLOR_ATTACHMENT0){for(let Di=0,er=Fn.length;Di<er;Di++)rn[Di]=b.COLOR_ATTACHMENT0+Di;rn.length=Fn.length,vn=!0}}else rn[0]!==b.COLOR_ATTACHMENT0&&(rn[0]=b.COLOR_ATTACHMENT0,vn=!0);else rn[0]!==b.BACK&&(rn[0]=b.BACK,vn=!0);vn&&(a.isWebGL2?b.drawBuffers(rn):r.get("WEBGL_draw_buffers").drawBuffersWEBGL(rn))}function ft(ht){return se!==ht?(b.useProgram(ht),se=ht,!0):!1}let dn={[$]:b.FUNC_ADD,[te]:b.FUNC_SUBTRACT,[U]:b.FUNC_REVERSE_SUBTRACT};if(d)dn[P]=b.MIN,dn[k]=b.MAX;else{let ht=r.get("EXT_blend_minmax");ht!==null&&(dn[P]=ht.MIN_EXT,dn[k]=ht.MAX_EXT)}let Dn={[z]:b.ZERO,[Q]:b.ONE,[Z]:b.SRC_COLOR,[Me]:b.SRC_ALPHA,[it]:b.SRC_ALPHA_SATURATE,[Ze]:b.DST_COLOR,[be]:b.DST_ALPHA,[ce]:b.ONE_MINUS_SRC_COLOR,[xe]:b.ONE_MINUS_SRC_ALPHA,[ut]:b.ONE_MINUS_DST_COLOR,[Fe]:b.ONE_MINUS_DST_ALPHA,[gt]:b.CONSTANT_COLOR,[Rt]:b.ONE_MINUS_CONSTANT_COLOR,[It]:b.CONSTANT_ALPHA,[Ft]:b.ONE_MINUS_CONSTANT_ALPHA};function an(ht,_n,rn,vn,Fn,Di,er,Yi,bn,ui){if(ht===L){K===!0&&(ii(b.BLEND),K=!1);return}if(K===!1&&(ei(b.BLEND),K=!0),ht!==X){if(ht!==Pe||ui!==ct){if((ve!==$||qe!==$)&&(b.blendEquation(b.FUNC_ADD),ve=$,qe=$),ui)switch(ht){case I:b.blendFuncSeparate(b.ONE,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);break;case F:b.blendFunc(b.ONE,b.ONE);break;case R:b.blendFuncSeparate(b.ZERO,b.ONE_MINUS_SRC_COLOR,b.ZERO,b.ONE);break;case N:b.blendFuncSeparate(b.ZERO,b.SRC_COLOR,b.ZERO,b.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ht);break}else switch(ht){case I:b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);break;case F:b.blendFunc(b.SRC_ALPHA,b.ONE);break;case R:b.blendFuncSeparate(b.ZERO,b.ONE_MINUS_SRC_COLOR,b.ZERO,b.ONE);break;case N:b.blendFunc(b.ZERO,b.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ht);break}Te=null,We=null,st=null,lt=null,Ve.set(0,0,0),Ke=0,Pe=ht,ct=ui}return}Fn=Fn||_n,Di=Di||rn,er=er||vn,(_n!==ve||Fn!==qe)&&(b.blendEquationSeparate(dn[_n],dn[Fn]),ve=_n,qe=Fn),(rn!==Te||vn!==We||Di!==st||er!==lt)&&(b.blendFuncSeparate(Dn[rn],Dn[vn],Dn[Di],Dn[er]),Te=rn,We=vn,st=Di,lt=er),(Yi.equals(Ve)===!1||bn!==Ke)&&(b.blendColor(Yi.r,Yi.g,Yi.b,bn),Ve.copy(Yi),Ke=bn),Pe=ht,ct=!1}function Vn(ht,_n){ht.side===T?ii(b.CULL_FACE):ei(b.CULL_FACE);let rn=ht.side===M;_n&&(rn=!rn),pi(rn),ht.blending===I&&ht.transparent===!1?an(L):an(ht.blending,ht.blendEquation,ht.blendSrc,ht.blendDst,ht.blendEquationAlpha,ht.blendSrcAlpha,ht.blendDstAlpha,ht.blendColor,ht.blendAlpha,ht.premultipliedAlpha),B.setFunc(ht.depthFunc),B.setTest(ht.depthTest),B.setMask(ht.depthWrite),S.setMask(ht.colorWrite);let vn=ht.stencilWrite;O.setTest(vn),vn&&(O.setMask(ht.stencilWriteMask),O.setFunc(ht.stencilFunc,ht.stencilRef,ht.stencilFuncMask),O.setOp(ht.stencilFail,ht.stencilZFail,ht.stencilZPass)),hr(ht.polygonOffset,ht.polygonOffsetFactor,ht.polygonOffsetUnits),ht.alphaToCoverage===!0?ei(b.SAMPLE_ALPHA_TO_COVERAGE):ii(b.SAMPLE_ALPHA_TO_COVERAGE)}function pi(ht){Dt!==ht&&(ht?b.frontFace(b.CW):b.frontFace(b.CCW),Dt=ht)}function ti(ht){ht!==p?(ei(b.CULL_FACE),ht!==Qt&&(ht===f?b.cullFace(b.BACK):ht===m?b.cullFace(b.FRONT):b.cullFace(b.FRONT_AND_BACK))):ii(b.CULL_FACE),Qt=ht}function mi(ht){ht!==dt&&(un&&b.lineWidth(ht),dt=ht)}function hr(ht,_n,rn){ht?(ei(b.POLYGON_OFFSET_FILL),(wt!==_n||Kt!==rn)&&(b.polygonOffset(_n,rn),wt=_n,Kt=rn)):ii(b.POLYGON_OFFSET_FILL)}function $r(ht){ht?ei(b.SCISSOR_TEST):ii(b.SCISSOR_TEST)}function Ss(ht){ht===void 0&&(ht=b.TEXTURE0+$t-1),gn!==ht&&(b.activeTexture(ht),gn=ht)}function Br(ht,_n,rn){rn===void 0&&(gn===null?rn=b.TEXTURE0+$t-1:rn=gn);let vn=Qn[rn];vn===void 0&&(vn={type:void 0,texture:void 0},Qn[rn]=vn),(vn.type!==ht||vn.texture!==_n)&&(gn!==rn&&(b.activeTexture(rn),gn=rn),b.bindTexture(ht,_n||bi[ht]),vn.type=ht,vn.texture=_n)}function Tr(){let ht=Qn[gn];ht!==void 0&&ht.type!==void 0&&(b.bindTexture(ht.type,null),ht.type=void 0,ht.texture=void 0)}function hs(){try{b.compressedTexImage2D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function Ho(){try{b.compressedTexImage3D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function Je(){try{b.texSubImage2D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function ke(){try{b.texSubImage3D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function Nt(){try{b.compressedTexSubImage2D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function ln(){try{b.compressedTexSubImage3D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function fn(){try{b.texStorage2D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function hn(){try{b.texStorage3D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function li(){try{b.texImage2D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function kn(){try{b.texImage3D.apply(b,arguments)}catch(ht){console.error("THREE.WebGLState:",ht)}}function Yn(ht){Xt.equals(ht)===!1&&(b.scissor(ht.x,ht.y,ht.z,ht.w),Xt.copy(ht))}function gi(ht){Tn.equals(ht)===!1&&(b.viewport(ht.x,ht.y,ht.z,ht.w),Tn.copy(ht))}function pr(ht,_n){let rn=W.get(_n);rn===void 0&&(rn=new WeakMap,W.set(_n,rn));let vn=rn.get(ht);vn===void 0&&(vn=b.getUniformBlockIndex(_n,ht.name),rn.set(ht,vn))}function wn(ht,_n){let vn=W.get(_n).get(ht);H.get(_n)!==vn&&(b.uniformBlockBinding(_n,vn,ht.__bindingPointIndex),H.set(_n,vn))}function ts(){b.disable(b.BLEND),b.disable(b.CULL_FACE),b.disable(b.DEPTH_TEST),b.disable(b.POLYGON_OFFSET_FILL),b.disable(b.SCISSOR_TEST),b.disable(b.STENCIL_TEST),b.disable(b.SAMPLE_ALPHA_TO_COVERAGE),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ZERO),b.blendFuncSeparate(b.ONE,b.ZERO,b.ONE,b.ZERO),b.blendColor(0,0,0,0),b.colorMask(!0,!0,!0,!0),b.clearColor(0,0,0,0),b.depthMask(!0),b.depthFunc(b.LESS),b.clearDepth(1),b.stencilMask(4294967295),b.stencilFunc(b.ALWAYS,0,4294967295),b.stencilOp(b.KEEP,b.KEEP,b.KEEP),b.clearStencil(0),b.cullFace(b.BACK),b.frontFace(b.CCW),b.polygonOffset(0,0),b.activeTexture(b.TEXTURE0),b.bindFramebuffer(b.FRAMEBUFFER,null),d===!0&&(b.bindFramebuffer(b.DRAW_FRAMEBUFFER,null),b.bindFramebuffer(b.READ_FRAMEBUFFER,null)),b.useProgram(null),b.lineWidth(1),b.scissor(0,0,b.canvas.width,b.canvas.height),b.viewport(0,0,b.canvas.width,b.canvas.height),j={},gn=null,Qn={},J={},ie=new WeakMap,fe=[],se=null,K=!1,Pe=null,ve=null,Te=null,We=null,qe=null,st=null,lt=null,Ve=new jn(0,0,0),Ke=0,ct=!1,Dt=null,Qt=null,dt=null,wt=null,Kt=null,Xt.set(0,0,b.canvas.width,b.canvas.height),Tn.set(0,0,b.canvas.width,b.canvas.height),S.reset(),B.reset(),O.reset()}return{buffers:{color:S,depth:B,stencil:O},enable:ei,disable:ii,bindFramebuffer:vi,drawBuffers:on,useProgram:ft,setBlending:an,setMaterial:Vn,setFlipSided:pi,setCullFace:ti,setLineWidth:mi,setPolygonOffset:hr,setScissorTest:$r,activeTexture:Ss,bindTexture:Br,unbindTexture:Tr,compressedTexImage2D:hs,compressedTexImage3D:Ho,texImage2D:li,texImage3D:kn,updateUBOMapping:pr,uniformBlockBinding:wn,texStorage2D:fn,texStorage3D:hn,texSubImage2D:Je,texSubImage3D:ke,compressedTexSubImage2D:Nt,compressedTexSubImage3D:ln,scissor:Yn,viewport:gi,reset:ts}}function E6(b,r,a,d,g,_,C){let S=g.isWebGL2,B=g.maxTextures,O=g.maxCubemapSize,H=g.maxTextureSize,W=g.maxSamples,j=r.has("WEBGL_multisampled_render_to_texture")?r.get("WEBGL_multisampled_render_to_texture"):null,J=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ie=r.has("OCULUS_multiview")?r.get("OCULUS_multiview"):null,fe=new WeakMap,se,K=new WeakMap,Pe=[],ve=!1,Te=!1;try{Te=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function We(Je,ke){return Te?new OffscreenCanvas(Je,ke):Uu("canvas")}function qe(Je,ke,Nt,ln){let fn=1;if((Je.width>ln||Je.height>ln)&&(fn=ln/Math.max(Je.width,Je.height)),fn<1||ke===!0)if(typeof HTMLImageElement<"u"&&Je instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Je instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Je instanceof ImageBitmap){let hn=ke?td:Math.floor,li=hn(fn*Je.width),kn=hn(fn*Je.height);se===void 0&&(se=We(li,kn));let Yn=Nt?We(li,kn):se;return Yn.width=li,Yn.height=kn,Yn.getContext("2d").drawImage(Je,0,0,li,kn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Je.width+"x"+Je.height+") to ("+li+"x"+kn+")."),Yn}else return"data"in Je&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Je.width+"x"+Je.height+")."),Je;return Je}function st(Je){return Np(Je.width)&&Np(Je.height)}function lt(Je){return S?!1:Je.wrapS!==Qe||Je.wrapT!==Qe||Je.minFilter!==nt&&Je.minFilter!==_t}function Ve(Je,ke){return Je.generateMipmaps&&ke&&Je.minFilter!==nt&&Je.minFilter!==_t}function Ke(Je){b.generateMipmap(Je)}function ct(Je,ke,Nt,ln,fn=!1){if(S===!1)return ke;if(Je!==null){if(b[Je]!==void 0)return b[Je];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Je+"'")}let hn=ke;if(ke===b.RED&&(Nt===b.FLOAT&&(hn=b.R32F),Nt===b.HALF_FLOAT&&(hn=b.R16F),Nt===b.UNSIGNED_BYTE&&(hn=b.R8)),ke===b.RED_INTEGER&&(Nt===b.UNSIGNED_BYTE&&(hn=b.R8UI),Nt===b.UNSIGNED_SHORT&&(hn=b.R16UI),Nt===b.UNSIGNED_INT&&(hn=b.R32UI),Nt===b.BYTE&&(hn=b.R8I),Nt===b.SHORT&&(hn=b.R16I),Nt===b.INT&&(hn=b.R32I)),ke===b.RG&&(Nt===b.FLOAT&&(hn=b.RG32F),Nt===b.HALF_FLOAT&&(hn=b.RG16F),Nt===b.UNSIGNED_BYTE&&(hn=b.RG8)),ke===b.RGBA){let li=fn?Lu:Ir.getTransfer(ln);Nt===b.FLOAT&&(hn=b.RGBA32F),Nt===b.HALF_FLOAT&&(hn=b.RGBA16F),Nt===b.UNSIGNED_BYTE&&(hn=li===Ur?b.SRGB8_ALPHA8:b.RGBA8),Nt===b.UNSIGNED_SHORT_4_4_4_4&&(hn=b.RGBA4),Nt===b.UNSIGNED_SHORT_5_5_5_1&&(hn=b.RGB5_A1)}return(hn===b.R16F||hn===b.R32F||hn===b.RG16F||hn===b.RG32F||hn===b.RGBA16F||hn===b.RGBA32F)&&r.get("EXT_color_buffer_float"),hn}function Dt(Je,ke,Nt){return Ve(Je,Nt)===!0||Je.isFramebufferTexture&&Je.minFilter!==nt&&Je.minFilter!==_t?Math.log2(Math.max(ke.width,ke.height))+1:Je.mipmaps!==void 0&&Je.mipmaps.length>0?Je.mipmaps.length:Je.isCompressedTexture&&Array.isArray(Je.image)?ke.mipmaps.length:1}function Qt(Je){return Je===nt||Je===ge||Je===et?b.NEAREST:b.LINEAR}function dt(Je){let ke=Je.target;ke.removeEventListener("dispose",dt),Kt(ke),ke.isVideoTexture&&fe.delete(ke)}function wt(Je){let ke=Je.target;ke.removeEventListener("dispose",wt),un(ke)}function Kt(Je){let ke=d.get(Je);if(ke.__webglInit===void 0)return;let Nt=Je.source,ln=K.get(Nt);if(ln){let fn=ln[ke.__cacheKey];fn.usedTimes--,fn.usedTimes===0&&$t(Je),Object.keys(ln).length===0&&K.delete(Nt)}d.remove(Je)}function $t(Je){let ke=d.get(Je);b.deleteTexture(ke.__webglTexture);let Nt=Je.source,ln=K.get(Nt);delete ln[ke.__cacheKey],C.memory.textures--}function un(Je){let ke=Je.texture,Nt=d.get(Je),ln=d.get(ke);if(ln.__webglTexture!==void 0&&(b.deleteTexture(ln.__webglTexture),C.memory.textures--),Je.depthTexture&&Je.depthTexture.dispose(),Je.isWebGLCubeRenderTarget)for(let fn=0;fn<6;fn++){if(Array.isArray(Nt.__webglFramebuffer[fn]))for(let hn=0;hn<Nt.__webglFramebuffer[fn].length;hn++)b.deleteFramebuffer(Nt.__webglFramebuffer[fn][hn]);else b.deleteFramebuffer(Nt.__webglFramebuffer[fn]);Nt.__webglDepthbuffer&&b.deleteRenderbuffer(Nt.__webglDepthbuffer[fn])}else{if(Array.isArray(Nt.__webglFramebuffer))for(let fn=0;fn<Nt.__webglFramebuffer.length;fn++)b.deleteFramebuffer(Nt.__webglFramebuffer[fn]);else b.deleteFramebuffer(Nt.__webglFramebuffer);if(Nt.__webglDepthbuffer&&b.deleteRenderbuffer(Nt.__webglDepthbuffer),Nt.__webglMultisampledFramebuffer&&b.deleteFramebuffer(Nt.__webglMultisampledFramebuffer),Nt.__webglColorRenderbuffer)for(let fn=0;fn<Nt.__webglColorRenderbuffer.length;fn++)Nt.__webglColorRenderbuffer[fn]&&b.deleteRenderbuffer(Nt.__webglColorRenderbuffer[fn]);Nt.__webglDepthRenderbuffer&&b.deleteRenderbuffer(Nt.__webglDepthRenderbuffer)}if(Je.isWebGLMultipleRenderTargets)for(let fn=0,hn=ke.length;fn<hn;fn++){let li=d.get(ke[fn]);li.__webglTexture&&(b.deleteTexture(li.__webglTexture),C.memory.textures--),d.remove(ke[fn])}d.remove(ke),d.remove(Je)}let Zt=0;function An(){Zt=0}function gn(){let Je=Zt;return Je>=B&&console.warn("THREE.WebGLTextures: Trying to use "+Je+" texture units while this GPU supports only "+B),Zt+=1,Je}function Qn(Je){let ke=[];return ke.push(Je.wrapS),ke.push(Je.wrapT),ke.push(Je.wrapR||0),ke.push(Je.magFilter),ke.push(Je.minFilter),ke.push(Je.anisotropy),ke.push(Je.internalFormat),ke.push(Je.format),ke.push(Je.type),ke.push(Je.generateMipmaps),ke.push(Je.premultiplyAlpha),ke.push(Je.flipY),ke.push(Je.unpackAlignment),ke.push(Je.colorSpace),ke.join()}function ji(Je,ke){let Nt=d.get(Je);if(Je.isVideoTexture&&hs(Je),Je.isRenderTargetTexture===!1&&Je.version>0&&Nt.__version!==Je.version){let ln=Je.image;if(ln===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ln.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(dn(Nt,Je,ke))return}a.bindTexture(b.TEXTURE_2D,Nt.__webglTexture,b.TEXTURE0+ke)}function Ni(Je,ke){let Nt=d.get(Je);if(Je.version>0&&Nt.__version!==Je.version){dn(Nt,Je,ke);return}a.bindTexture(b.TEXTURE_2D_ARRAY,Nt.__webglTexture,b.TEXTURE0+ke)}function Xt(Je,ke){let Nt=d.get(Je);if(Je.version>0&&Nt.__version!==Je.version){dn(Nt,Je,ke);return}a.bindTexture(b.TEXTURE_3D,Nt.__webglTexture,b.TEXTURE0+ke)}function Tn(Je,ke){let Nt=d.get(Je);if(Je.version>0&&Nt.__version!==Je.version){Dn(Nt,Je,ke);return}a.bindTexture(b.TEXTURE_CUBE_MAP,Nt.__webglTexture,b.TEXTURE0+ke)}let Mn={[Ue]:b.REPEAT,[Qe]:b.CLAMP_TO_EDGE,[$e]:b.MIRRORED_REPEAT},bi={[nt]:b.NEAREST,[ge]:b.NEAREST_MIPMAP_NEAREST,[et]:b.NEAREST_MIPMAP_LINEAR,[_t]:b.LINEAR,[tn]:b.LINEAR_MIPMAP_NEAREST,[Cn]:b.LINEAR_MIPMAP_LINEAR},ei={[$g]:b.NEVER,[r0]:b.ALWAYS,[Jg]:b.LESS,[e0]:b.LEQUAL,[Zg]:b.EQUAL,[i0]:b.GEQUAL,[t0]:b.GREATER,[n0]:b.NOTEQUAL};function ii(Je,ke,Nt){if(Nt?(b.texParameteri(Je,b.TEXTURE_WRAP_S,Mn[ke.wrapS]),b.texParameteri(Je,b.TEXTURE_WRAP_T,Mn[ke.wrapT]),(Je===b.TEXTURE_3D||Je===b.TEXTURE_2D_ARRAY)&&b.texParameteri(Je,b.TEXTURE_WRAP_R,Mn[ke.wrapR]),b.texParameteri(Je,b.TEXTURE_MAG_FILTER,bi[ke.magFilter]),b.texParameteri(Je,b.TEXTURE_MIN_FILTER,bi[ke.minFilter])):(b.texParameteri(Je,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(Je,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),(Je===b.TEXTURE_3D||Je===b.TEXTURE_2D_ARRAY)&&b.texParameteri(Je,b.TEXTURE_WRAP_R,b.CLAMP_TO_EDGE),(ke.wrapS!==Qe||ke.wrapT!==Qe)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),b.texParameteri(Je,b.TEXTURE_MAG_FILTER,Qt(ke.magFilter)),b.texParameteri(Je,b.TEXTURE_MIN_FILTER,Qt(ke.minFilter)),ke.minFilter!==nt&&ke.minFilter!==_t&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ke.compareFunction&&(b.texParameteri(Je,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE),b.texParameteri(Je,b.TEXTURE_COMPARE_FUNC,ei[ke.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){let ln=r.get("EXT_texture_filter_anisotropic");if(ke.magFilter===nt||ke.minFilter!==et&&ke.minFilter!==Cn||ke.type===fi&&r.has("OES_texture_float_linear")===!1||S===!1&&ke.type===xi&&r.has("OES_texture_half_float_linear")===!1)return;(ke.anisotropy>1||d.get(ke).__currentAnisotropy)&&(b.texParameterf(Je,ln.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ke.anisotropy,g.getMaxAnisotropy())),d.get(ke).__currentAnisotropy=ke.anisotropy)}}function vi(Je,ke){let Nt=!1;Je.__webglInit===void 0&&(Je.__webglInit=!0,ke.addEventListener("dispose",dt));let ln=ke.source,fn=K.get(ln);fn===void 0&&(fn={},K.set(ln,fn));let hn=Qn(ke);if(hn!==Je.__cacheKey){fn[hn]===void 0&&(fn[hn]={texture:b.createTexture(),usedTimes:0},C.memory.textures++,Nt=!0),fn[hn].usedTimes++;let li=fn[Je.__cacheKey];li!==void 0&&(fn[Je.__cacheKey].usedTimes--,li.usedTimes===0&&$t(ke)),Je.__cacheKey=hn,Je.__webglTexture=fn[hn].texture}return Nt}function on(Je){ve=Je}function ft(){let Je=ve;ve=!1;for(let ke of Pe)dn(ke.textureProperties,ke.texture,ke.slot),ke.texture.isPendingDeferredUpload=!1;Pe=[],ve=Je}function dn(Je,ke,Nt){if(ve)return ke.isPendingDeferredUpload||(ke.isPendingDeferredUpload=!0,Pe.push({textureProperties:Je,texture:ke,slot:Nt})),!1;let ln=b.TEXTURE_2D;(ke.isDataArrayTexture||ke.isCompressedArrayTexture)&&(ln=b.TEXTURE_2D_ARRAY),ke.isData3DTexture&&(ln=b.TEXTURE_3D);let fn=vi(Je,ke),hn=ke.source;a.bindTexture(ln,Je.__webglTexture,b.TEXTURE0+Nt);let li=d.get(hn);if(hn.version!==li.__version||fn===!0){a.activeTexture(b.TEXTURE0+Nt);let kn=Ir.getPrimaries(Ir.workingColorSpace),Yn=ke.colorSpace===ls?null:Ir.getPrimaries(ke.colorSpace),gi=ke.colorSpace===ls||kn===Yn?b.NONE:b.BROWSER_DEFAULT_WEBGL;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,ke.flipY),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ke.premultiplyAlpha),b.pixelStorei(b.UNPACK_ALIGNMENT,ke.unpackAlignment),b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,gi);let pr=lt(ke)&&st(ke.image)===!1,wn=qe(ke.image,pr,!1,H);wn=Ho(ke,wn);let ts=st(wn)||S,ht=_.convert(ke.format,ke.colorSpace),_n=_.convert(ke.type),rn=ct(ke.internalFormat,ht,_n,ke.colorSpace,ke.isVideoTexture);ii(ln,ke,ts);let vn,Fn=ke.mipmaps,Di=S&&ke.isVideoTexture!==!0,er=li.__version===void 0||fn===!0,Yi=Dt(ke,wn,ts);if(ke.isDepthTexture)rn=b.DEPTH_COMPONENT,S?ke.type===fi?rn=b.DEPTH_COMPONENT32F:ke.type===Gn?rn=b.DEPTH_COMPONENT24:ke.type===dr?rn=b.DEPTH24_STENCIL8:rn=b.DEPTH_COMPONENT16:ke.type===fi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ke.format===le&&rn===b.DEPTH_COMPONENT&&ke.type!==In&&ke.type!==Gn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ke.type=Gn,_n=_.convert(ke.type)),ke.format===me&&rn===b.DEPTH_COMPONENT&&(rn=b.DEPTH_STENCIL,ke.type!==dr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ke.type=dr,_n=_.convert(ke.type))),er&&(Di?a.texStorage2D(b.TEXTURE_2D,1,rn,wn.width,wn.height):a.texImage2D(b.TEXTURE_2D,0,rn,wn.width,wn.height,0,ht,_n,null));else if(ke.isDataTexture)if(Fn.length>0&&ts){Di&&er&&a.texStorage2D(b.TEXTURE_2D,Yi,rn,Fn[0].width,Fn[0].height);for(let bn=0,ui=Fn.length;bn<ui;bn++)vn=Fn[bn],Di?a.texSubImage2D(b.TEXTURE_2D,bn,0,0,vn.width,vn.height,ht,_n,vn.data):a.texImage2D(b.TEXTURE_2D,bn,rn,vn.width,vn.height,0,ht,_n,vn.data);ke.generateMipmaps=!1}else Di?(er&&a.texStorage2D(b.TEXTURE_2D,Yi,rn,wn.width,wn.height),a.texSubImage2D(b.TEXTURE_2D,0,0,0,wn.width,wn.height,ht,_n,wn.data)):a.texImage2D(b.TEXTURE_2D,0,rn,wn.width,wn.height,0,ht,_n,wn.data);else if(ke.isCompressedTexture)if(ke.isCompressedArrayTexture){Di&&er&&a.texStorage3D(b.TEXTURE_2D_ARRAY,Yi,rn,Fn[0].width,Fn[0].height,wn.depth);for(let bn=0,ui=Fn.length;bn<ui;bn++)vn=Fn[bn],ke.format!==Mi?ht!==null?Di?a.compressedTexSubImage3D(b.TEXTURE_2D_ARRAY,bn,0,0,0,vn.width,vn.height,wn.depth,ht,vn.data,0,0):a.compressedTexImage3D(b.TEXTURE_2D_ARRAY,bn,rn,vn.width,vn.height,wn.depth,0,vn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Di?a.texSubImage3D(b.TEXTURE_2D_ARRAY,bn,0,0,0,vn.width,vn.height,wn.depth,ht,_n,vn.data):a.texImage3D(b.TEXTURE_2D_ARRAY,bn,rn,vn.width,vn.height,wn.depth,0,ht,_n,vn.data)}else{Di&&er&&a.texStorage2D(b.TEXTURE_2D,Yi,rn,Fn[0].width,Fn[0].height);for(let bn=0,ui=Fn.length;bn<ui;bn++)vn=Fn[bn],ke.format!==Mi?ht!==null?Di?a.compressedTexSubImage2D(b.TEXTURE_2D,bn,0,0,vn.width,vn.height,ht,vn.data):a.compressedTexImage2D(b.TEXTURE_2D,bn,rn,vn.width,vn.height,0,vn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Di?a.texSubImage2D(b.TEXTURE_2D,bn,0,0,vn.width,vn.height,ht,_n,vn.data):a.texImage2D(b.TEXTURE_2D,bn,rn,vn.width,vn.height,0,ht,_n,vn.data)}else if(ke.isDataArrayTexture)Di?(er&&a.texStorage3D(b.TEXTURE_2D_ARRAY,Yi,rn,wn.width,wn.height,wn.depth),a.texSubImage3D(b.TEXTURE_2D_ARRAY,0,0,0,0,wn.width,wn.height,wn.depth,ht,_n,wn.data)):a.texImage3D(b.TEXTURE_2D_ARRAY,0,rn,wn.width,wn.height,wn.depth,0,ht,_n,wn.data);else if(ke.isData3DTexture)Di?(er&&a.texStorage3D(b.TEXTURE_3D,Yi,rn,wn.width,wn.height,wn.depth),a.texSubImage3D(b.TEXTURE_3D,0,0,0,0,wn.width,wn.height,wn.depth,ht,_n,wn.data)):a.texImage3D(b.TEXTURE_3D,0,rn,wn.width,wn.height,wn.depth,0,ht,_n,wn.data);else if(ke.isFramebufferTexture){if(er)if(Di)a.texStorage2D(b.TEXTURE_2D,Yi,rn,wn.width,wn.height);else{let bn=wn.width,ui=wn.height;for(let Dr=0;Dr<Yi;Dr++)a.texImage2D(b.TEXTURE_2D,Dr,rn,bn,ui,0,ht,_n,null),bn>>=1,ui>>=1}}else if(Fn.length>0&&ts){Di&&er&&a.texStorage2D(b.TEXTURE_2D,Yi,rn,Fn[0].width,Fn[0].height);for(let bn=0,ui=Fn.length;bn<ui;bn++)vn=Fn[bn],Di?a.texSubImage2D(b.TEXTURE_2D,bn,0,0,ht,_n,vn):a.texImage2D(b.TEXTURE_2D,bn,rn,ht,_n,vn);ke.generateMipmaps=!1}else Di?(er&&a.texStorage2D(b.TEXTURE_2D,Yi,rn,wn.width,wn.height),a.texSubImage2D(b.TEXTURE_2D,0,0,0,ht,_n,wn)):a.texImage2D(b.TEXTURE_2D,0,rn,ht,_n,wn);Ve(ke,ts)&&Ke(ln),li.__version=hn.version,ke.onUpdate&&ke.onUpdate(ke)}return Je.__version=ke.version,!0}function Dn(Je,ke,Nt){if(ke.image.length!==6)return;let ln=vi(Je,ke),fn=ke.source;a.bindTexture(b.TEXTURE_CUBE_MAP,Je.__webglTexture,b.TEXTURE0+Nt);let hn=d.get(fn);if(fn.version!==hn.__version||ln===!0){a.activeTexture(b.TEXTURE0+Nt);let li=Ir.getPrimaries(Ir.workingColorSpace),kn=ke.colorSpace===ls?null:Ir.getPrimaries(ke.colorSpace),Yn=ke.colorSpace===ls||li===kn?b.NONE:b.BROWSER_DEFAULT_WEBGL;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,ke.flipY),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ke.premultiplyAlpha),b.pixelStorei(b.UNPACK_ALIGNMENT,ke.unpackAlignment),b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yn);let gi=ke.isCompressedTexture||ke.image[0].isCompressedTexture,pr=ke.image[0]&&ke.image[0].isDataTexture,wn=[];for(let bn=0;bn<6;bn++)!gi&&!pr?wn[bn]=qe(ke.image[bn],!1,!0,O):wn[bn]=pr?ke.image[bn].image:ke.image[bn],wn[bn]=Ho(ke,wn[bn]);let ts=wn[0],ht=st(ts)||S,_n=_.convert(ke.format,ke.colorSpace),rn=_.convert(ke.type),vn=ct(ke.internalFormat,_n,rn,ke.colorSpace),Fn=S&&ke.isVideoTexture!==!0,Di=hn.__version===void 0||ln===!0,er=Dt(ke,ts,ht);ii(b.TEXTURE_CUBE_MAP,ke,ht);let Yi;if(gi){Fn&&Di&&a.texStorage2D(b.TEXTURE_CUBE_MAP,er,vn,ts.width,ts.height);for(let bn=0;bn<6;bn++){Yi=wn[bn].mipmaps;for(let ui=0;ui<Yi.length;ui++){let Dr=Yi[ui];ke.format!==Mi?_n!==null?Fn?a.compressedTexSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui,0,0,Dr.width,Dr.height,_n,Dr.data):a.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui,vn,Dr.width,Dr.height,0,Dr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Fn?a.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui,0,0,Dr.width,Dr.height,_n,rn,Dr.data):a.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui,vn,Dr.width,Dr.height,0,_n,rn,Dr.data)}}}else{Yi=ke.mipmaps,Fn&&Di&&(Yi.length>0&&er++,a.texStorage2D(b.TEXTURE_CUBE_MAP,er,vn,wn[0].width,wn[0].height));for(let bn=0;bn<6;bn++)if(pr){Fn?a.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,0,0,0,wn[bn].width,wn[bn].height,_n,rn,wn[bn].data):a.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,0,vn,wn[bn].width,wn[bn].height,0,_n,rn,wn[bn].data);for(let ui=0;ui<Yi.length;ui++){let Ys=Yi[ui].image[bn].image;Fn?a.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui+1,0,0,Ys.width,Ys.height,_n,rn,Ys.data):a.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui+1,vn,Ys.width,Ys.height,0,_n,rn,Ys.data)}}else{Fn?a.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,0,0,0,_n,rn,wn[bn]):a.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,0,vn,_n,rn,wn[bn]);for(let ui=0;ui<Yi.length;ui++){let Dr=Yi[ui];Fn?a.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui+1,0,0,_n,rn,Dr.image[bn]):a.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+bn,ui+1,vn,_n,rn,Dr.image[bn])}}}Ve(ke,ht)&&Ke(b.TEXTURE_CUBE_MAP),hn.__version=fn.version,ke.onUpdate&&ke.onUpdate(ke)}Je.__version=ke.version}function an(Je,ke,Nt,ln,fn,hn){let li=_.convert(Nt.format,Nt.colorSpace),kn=_.convert(Nt.type),Yn=ct(Nt.internalFormat,li,kn,Nt.colorSpace);if(!d.get(ke).__hasExternalTextures){let wn=Math.max(1,ke.width>>hn),ts=Math.max(1,ke.height>>hn);ke.isWebGLMultiviewRenderTarget===!0?a.texStorage3D(b.TEXTURE_2D_ARRAY,0,Yn,ke.width,ke.height,ke.numViews):fn===b.TEXTURE_3D||fn===b.TEXTURE_2D_ARRAY?a.texImage3D(fn,hn,Yn,wn,ts,ke.depth,0,li,kn,null):a.texImage2D(fn,hn,Yn,wn,ts,0,li,kn,null)}a.bindFramebuffer(b.FRAMEBUFFER,Je);let pr=Tr(ke);ke.isWebGLMultiviewRenderTarget===!0?pr?ie.framebufferTextureMultisampleMultiviewOVR(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,d.get(Nt).__webglTexture,0,Br(ke),0,ke.numViews):ie.framebufferTextureMultiviewOVR(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,d.get(Nt).__webglTexture,0,0,ke.numViews):(fn===b.TEXTURE_2D||fn>=b.TEXTURE_CUBE_MAP_POSITIVE_X&&fn<=b.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(pr?j.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,ln,fn,d.get(Nt).__webglTexture,0,Br(ke)):b.framebufferTexture2D(b.FRAMEBUFFER,ln,fn,d.get(Nt).__webglTexture,hn)),a.bindFramebuffer(b.FRAMEBUFFER,null)}function Vn(Je,ke,Nt){if(b.bindRenderbuffer(b.RENDERBUFFER,Je),ke.isWebGLMultiviewRenderTarget===!0){let ln=Tr(ke),fn=ke.numViews,hn=ke.depthTexture,li=b.DEPTH_COMPONENT24,kn=b.DEPTH_ATTACHMENT;hn&&hn.isDepthTexture&&(hn.type===fi?li=b.DEPTH_COMPONENT32F:hn.type===dr&&(li=b.DEPTH24_STENCIL8,kn=b.DEPTH_STENCIL_ATTACHMENT));let Yn=d.get(ke.depthTexture).__webglTexture;Yn===void 0&&(Yn=b.createTexture(),b.bindTexture(b.TEXTURE_2D_ARRAY,Yn),b.texStorage3D(b.TEXTURE_2D_ARRAY,1,li,ke.width,ke.height,fn)),ln?ie.framebufferTextureMultisampleMultiviewOVR(b.FRAMEBUFFER,kn,Yn,0,Br(ke),0,fn):ie.framebufferTextureMultiviewOVR(b.FRAMEBUFFER,kn,Yn,0,0,fn)}else if(ke.depthBuffer&&!ke.stencilBuffer){let ln=S===!0?b.DEPTH_COMPONENT24:b.DEPTH_COMPONENT16;if(Nt||Tr(ke)){let fn=ke.depthTexture;fn&&fn.isDepthTexture&&(fn.type===fi?ln=b.DEPTH_COMPONENT32F:fn.type===Gn&&(ln=b.DEPTH_COMPONENT24));let hn=Br(ke);Tr(ke)?j.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,hn,ln,ke.width,ke.height):b.renderbufferStorageMultisample(b.RENDERBUFFER,hn,ln,ke.width,ke.height)}else b.renderbufferStorage(b.RENDERBUFFER,ln,ke.width,ke.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,Je)}else if(ke.depthBuffer&&ke.stencilBuffer){let ln=Br(ke);Nt&&Tr(ke)===!1?b.renderbufferStorageMultisample(b.RENDERBUFFER,ln,b.DEPTH24_STENCIL8,ke.width,ke.height):Tr(ke)?j.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,ln,b.DEPTH24_STENCIL8,ke.width,ke.height):b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,ke.width,ke.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,Je)}else{let ln=ke.isWebGLMultipleRenderTargets===!0?ke.texture:[ke.texture];for(let fn=0;fn<ln.length;fn++){let hn=ln[fn],li=_.convert(hn.format,hn.colorSpace),kn=_.convert(hn.type),Yn=ct(hn.internalFormat,li,kn,hn.colorSpace),gi=Br(ke);Nt&&Tr(ke)===!1?b.renderbufferStorageMultisample(b.RENDERBUFFER,gi,Yn,ke.width,ke.height):Tr(ke)?j.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,gi,Yn,ke.width,ke.height):b.renderbufferStorage(b.RENDERBUFFER,Yn,ke.width,ke.height)}}b.bindRenderbuffer(b.RENDERBUFFER,null)}function pi(Je,ke){if(ke&&ke.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(b.FRAMEBUFFER,Je),!(ke.depthTexture&&ke.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!d.get(ke.depthTexture).__webglTexture||ke.depthTexture.image.width!==ke.width||ke.depthTexture.image.height!==ke.height)&&(ke.depthTexture.image.width=ke.width,ke.depthTexture.image.height=ke.height,ke.depthTexture.needsUpdate=!0),ji(ke.depthTexture,0),ke.depthTexture.image.depth!=1?Ni(ke.depthTexture,0):ji(ke.depthTexture,0);let ln=d.get(ke.depthTexture).__webglTexture,fn=Br(ke);if(ke.isWebGLMultiviewRenderTarget===!0){let hn=Tr(ke),li=ke.numViews;if(ke.depthTexture.format===le)hn?ie.framebufferTextureMultisampleMultiviewOVR(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,ln,0,fn,0,li):ie.framebufferTextureMultiviewOVR(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,ln,0,0,li);else if(ke.depthTexture.format===me)hn?ie.framebufferTextureMultisampleMultiviewOVR(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,ln,0,fn,0,li):ie.framebufferTextureMultiviewOVR(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,ln,0,0,li);else throw new Error("Unknown depthTexture format")}else if(ke.depthTexture.format===le)Tr(ke)?j.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.TEXTURE_2D,ln,0,fn):b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.TEXTURE_2D,ln,0);else if(ke.depthTexture.format===me)Tr(ke)?j.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,ln,0,fn):b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,ln,0);else throw new Error("Unknown depthTexture format")}function ti(Je){let ke=d.get(Je),Nt=Je.isWebGLCubeRenderTarget===!0;if(Je.depthTexture&&!ke.__autoAllocateDepthBuffer){if(Nt)throw new Error("target.depthTexture not supported in Cube render targets");pi(ke.__webglFramebuffer,Je)}else if(Nt){ke.__webglDepthbuffer=[];for(let ln=0;ln<6;ln++)a.bindFramebuffer(b.FRAMEBUFFER,ke.__webglFramebuffer[ln]),ke.__webglDepthbuffer[ln]=b.createRenderbuffer(),Vn(ke.__webglDepthbuffer[ln],Je,!1)}else a.bindFramebuffer(b.FRAMEBUFFER,ke.__webglFramebuffer),ke.__webglDepthbuffer=b.createRenderbuffer(),Vn(ke.__webglDepthbuffer,Je,!1);a.bindFramebuffer(b.FRAMEBUFFER,null)}function mi(Je,ke,Nt){let ln=d.get(Je);ke!==void 0&&an(ln.__webglFramebuffer,Je,Je.texture,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,0),Nt!==void 0&&ti(Je)}function hr(Je){let ke=Je.texture,Nt=d.get(Je),ln=d.get(ke);Je.addEventListener("dispose",wt),Je.isWebGLMultipleRenderTargets!==!0&&(ln.__webglTexture===void 0&&(ln.__webglTexture=b.createTexture()),ln.__version=ke.version,C.memory.textures++);let fn=Je.isWebGLCubeRenderTarget===!0,hn=Je.isWebGLMultipleRenderTargets===!0,li=st(Je)||S;if(fn){Nt.__webglFramebuffer=[];for(let kn=0;kn<6;kn++)if(S&&ke.mipmaps&&ke.mipmaps.length>0){Nt.__webglFramebuffer[kn]=[];for(let Yn=0;Yn<ke.mipmaps.length;Yn++)Nt.__webglFramebuffer[kn][Yn]=b.createFramebuffer()}else Nt.__webglFramebuffer[kn]=b.createFramebuffer()}else{if(S&&ke.mipmaps&&ke.mipmaps.length>0){Nt.__webglFramebuffer=[];for(let kn=0;kn<ke.mipmaps.length;kn++)Nt.__webglFramebuffer[kn]=b.createFramebuffer()}else Nt.__webglFramebuffer=b.createFramebuffer();if(hn)if(g.drawBuffers){let kn=Je.texture;for(let Yn=0,gi=kn.length;Yn<gi;Yn++){let pr=d.get(kn[Yn]);pr.__webglTexture===void 0&&(pr.__webglTexture=b.createTexture(),C.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(S&&Je.samples>0&&Tr(Je)===!1){let kn=hn?ke:[ke];Nt.__webglMultisampledFramebuffer=b.createFramebuffer(),Nt.__webglColorRenderbuffer=[],a.bindFramebuffer(b.FRAMEBUFFER,Nt.__webglMultisampledFramebuffer);for(let Yn=0;Yn<kn.length;Yn++){let gi=kn[Yn];Nt.__webglColorRenderbuffer[Yn]=b.createRenderbuffer(),b.bindRenderbuffer(b.RENDERBUFFER,Nt.__webglColorRenderbuffer[Yn]);let pr=_.convert(gi.format,gi.colorSpace),wn=_.convert(gi.type),ts=ct(gi.internalFormat,pr,wn,gi.colorSpace,Je.isXRRenderTarget===!0),ht=Br(Je);b.renderbufferStorageMultisample(b.RENDERBUFFER,ht,ts,Je.width,Je.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0+Yn,b.RENDERBUFFER,Nt.__webglColorRenderbuffer[Yn])}b.bindRenderbuffer(b.RENDERBUFFER,null),Je.depthBuffer&&(Nt.__webglDepthRenderbuffer=b.createRenderbuffer(),Vn(Nt.__webglDepthRenderbuffer,Je,!0)),a.bindFramebuffer(b.FRAMEBUFFER,null)}}if(fn){a.bindTexture(b.TEXTURE_CUBE_MAP,ln.__webglTexture),ii(b.TEXTURE_CUBE_MAP,ke,li);for(let kn=0;kn<6;kn++)if(S&&ke.mipmaps&&ke.mipmaps.length>0)for(let Yn=0;Yn<ke.mipmaps.length;Yn++)an(Nt.__webglFramebuffer[kn][Yn],Je,ke,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+kn,Yn);else an(Nt.__webglFramebuffer[kn],Je,ke,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+kn,0);Ve(ke,li)&&Ke(b.TEXTURE_CUBE_MAP),a.unbindTexture()}else if(hn){let kn=Je.texture;for(let Yn=0,gi=kn.length;Yn<gi;Yn++){let pr=kn[Yn],wn=d.get(pr);a.bindTexture(b.TEXTURE_2D,wn.__webglTexture),ii(b.TEXTURE_2D,pr,li),an(Nt.__webglFramebuffer,Je,pr,b.COLOR_ATTACHMENT0+Yn,b.TEXTURE_2D,0),Ve(pr,li)&&Ke(b.TEXTURE_2D)}a.unbindTexture()}else{let kn=b.TEXTURE_2D;if((Je.isWebGL3DRenderTarget||Je.isWebGLArrayRenderTarget)&&(S?kn=Je.isWebGL3DRenderTarget?b.TEXTURE_3D:b.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),Je.isWebGLMultiviewRenderTarget===!0&&(kn=b.TEXTURE_2D_ARRAY),a.bindTexture(kn,ln.__webglTexture),ii(kn,ke,li),S&&ke.mipmaps&&ke.mipmaps.length>0)for(let Yn=0;Yn<ke.mipmaps.length;Yn++)an(Nt.__webglFramebuffer[Yn],Je,ke,b.COLOR_ATTACHMENT0,kn,Yn);else an(Nt.__webglFramebuffer,Je,ke,b.COLOR_ATTACHMENT0,kn,0);Ve(ke,li)&&Ke(kn),a.unbindTexture()}(Je.depthBuffer||Je.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Je)}function $r(Je){let ke=st(Je)||S,Nt=Je.isWebGLMultipleRenderTargets===!0?Je.texture:[Je.texture];for(let ln=0,fn=Nt.length;ln<fn;ln++){let hn=Nt[ln];if(Ve(hn,ke)){let li=Je.isWebGLCubeRenderTarget?b.TEXTURE_CUBE_MAP:b.TEXTURE_2D,kn=d.get(hn).__webglTexture;a.bindTexture(li,kn),Ke(li),a.unbindTexture()}}}function Ss(Je){if(S&&Je.samples>0&&Tr(Je)===!1){let ke=Je.isWebGLMultipleRenderTargets?Je.texture:[Je.texture],Nt=Je.width,ln=Je.height,fn=b.COLOR_BUFFER_BIT,hn=[],li=Je.stencilBuffer?b.DEPTH_STENCIL_ATTACHMENT:b.DEPTH_ATTACHMENT,kn=d.get(Je),Yn=Je.isWebGLMultipleRenderTargets===!0;if(Yn)for(let gi=0;gi<ke.length;gi++)a.bindFramebuffer(b.FRAMEBUFFER,kn.__webglMultisampledFramebuffer),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0+gi,b.RENDERBUFFER,null),a.bindFramebuffer(b.FRAMEBUFFER,kn.__webglFramebuffer),b.framebufferTexture2D(b.DRAW_FRAMEBUFFER,b.COLOR_ATTACHMENT0+gi,b.TEXTURE_2D,null,0);a.bindFramebuffer(b.READ_FRAMEBUFFER,kn.__webglMultisampledFramebuffer),a.bindFramebuffer(b.DRAW_FRAMEBUFFER,kn.__webglFramebuffer);for(let gi=0;gi<ke.length;gi++){hn.push(b.COLOR_ATTACHMENT0+gi),Je.depthBuffer&&hn.push(li);let pr=kn.__ignoreDepthValues!==void 0?kn.__ignoreDepthValues:!1;if(pr===!1&&(Je.depthBuffer&&(fn|=b.DEPTH_BUFFER_BIT),Je.stencilBuffer&&(fn|=b.STENCIL_BUFFER_BIT)),Yn&&b.framebufferRenderbuffer(b.READ_FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,kn.__webglColorRenderbuffer[gi]),pr===!0&&(b.invalidateFramebuffer(b.READ_FRAMEBUFFER,[li]),b.invalidateFramebuffer(b.DRAW_FRAMEBUFFER,[li])),Yn){let wn=d.get(ke[gi]).__webglTexture;b.framebufferTexture2D(b.DRAW_FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,wn,0)}b.blitFramebuffer(0,0,Nt,ln,0,0,Nt,ln,fn,b.NEAREST),J&&b.invalidateFramebuffer(b.READ_FRAMEBUFFER,hn)}if(a.bindFramebuffer(b.READ_FRAMEBUFFER,null),a.bindFramebuffer(b.DRAW_FRAMEBUFFER,null),Yn)for(let gi=0;gi<ke.length;gi++){a.bindFramebuffer(b.FRAMEBUFFER,kn.__webglMultisampledFramebuffer),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0+gi,b.RENDERBUFFER,kn.__webglColorRenderbuffer[gi]);let pr=d.get(ke[gi]).__webglTexture;a.bindFramebuffer(b.FRAMEBUFFER,kn.__webglFramebuffer),b.framebufferTexture2D(b.DRAW_FRAMEBUFFER,b.COLOR_ATTACHMENT0+gi,b.TEXTURE_2D,pr,0)}a.bindFramebuffer(b.DRAW_FRAMEBUFFER,kn.__webglMultisampledFramebuffer)}}function Br(Je){return Math.min(W,Je.samples)}function Tr(Je){let ke=d.get(Je);return S&&Je.samples>0&&r.has("WEBGL_multisampled_render_to_texture")===!0&&ke.__useRenderToTexture!==!1}function hs(Je){let ke=C.render.frame;fe.get(Je)!==ke&&(fe.set(Je,ke),Je.update())}function Ho(Je,ke){let Nt=Je.colorSpace,ln=Je.format,fn=Je.type;return Je.isCompressedTexture===!0||Je.isVideoTexture===!0||Je.format===ed||Nt!==Sr&&Nt!==ls&&(Ir.getTransfer(Nt)===Ur?S===!1?r.has("EXT_sRGB")===!0&&ln===Mi?(Je.format=ed,Je.minFilter=_t,Je.generateMipmaps=!1):ke=Pc.sRGBToLinear(ke):(ln!==Mi||fn!==xt)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Nt)),ke}this.allocateTextureUnit=gn,this.resetTextureUnits=An,this.setTexture2D=ji,this.setTexture2DArray=Ni,this.setTexture3D=Xt,this.setTextureCube=Tn,this.rebindTextures=mi,this.uploadTexture=dn,this.setupRenderTarget=hr,this.updateRenderTargetMipmap=$r,this.updateMultisampleRenderTarget=Ss,this.setupDepthTexture=pi,this.setupDepthRenderbuffer=ti,this.setupFrameBufferTexture=an,this.useMultisampledRTT=Tr,this.runDeferredUploads=ft,this.setDeferTextureUploads=on}function lT(b,r,a){let d=a.isWebGL2;function g(_,C=ls){let S,B=Ir.getTransfer(C);if(_===xt)return b.UNSIGNED_BYTE;if(_===Ti)return b.UNSIGNED_SHORT_4_4_4_4;if(_===ir)return b.UNSIGNED_SHORT_5_5_5_1;if(_===jt)return b.BYTE;if(_===Pn)return b.SHORT;if(_===In)return b.UNSIGNED_SHORT;if(_===Kn)return b.INT;if(_===Gn)return b.UNSIGNED_INT;if(_===fi)return b.FLOAT;if(_===xi)return d?b.HALF_FLOAT:(S=r.get("OES_texture_half_float"),S!==null?S.HALF_FLOAT_OES:null);if(_===Ai)return b.ALPHA;if(_===Mi)return b.RGBA;if(_===ne)return b.LUMINANCE;if(_===Y)return b.LUMINANCE_ALPHA;if(_===le)return b.DEPTH_COMPONENT;if(_===me)return b.DEPTH_STENCIL;if(_===ed)return S=r.get("EXT_sRGB"),S!==null?S.SRGB_ALPHA_EXT:null;if(_===_e)return b.RED;if(_===Xe)return b.RED_INTEGER;if(_===rt)return b.RG;if(_===At)return b.RG_INTEGER;if(_===Ct)return b.RGBA_INTEGER;if(_===Tt||_===mt||_===Bt||_===cn)if(B===Ur)if(S=r.get("WEBGL_compressed_texture_s3tc_srgb"),S!==null){if(_===Tt)return S.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(_===mt)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(_===Bt)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(_===cn)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(S=r.get("WEBGL_compressed_texture_s3tc"),S!==null){if(_===Tt)return S.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===mt)return S.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===Bt)return S.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===cn)return S.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_===Ln||_===Hn||_===Wn||_===mn)if(S=r.get("WEBGL_compressed_texture_pvrtc"),S!==null){if(_===Ln)return S.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===Hn)return S.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===Wn)return S.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===mn)return S.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_===Yt)return S=r.get("WEBGL_compressed_texture_etc1"),S!==null?S.COMPRESSED_RGB_ETC1_WEBGL:null;if(_===lr||_===zn)if(S=r.get("WEBGL_compressed_texture_etc"),S!==null){if(_===lr)return B===Ur?S.COMPRESSED_SRGB8_ETC2:S.COMPRESSED_RGB8_ETC2;if(_===zn)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:S.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(_===yn||_===Ei||_===ur||_===$n||_===q||_===re||_===ye||_===Se||_===He||_===at||_===vt||_===bt||_===qt||_===oe)if(S=r.get("WEBGL_compressed_texture_astc"),S!==null){if(_===yn)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:S.COMPRESSED_RGBA_ASTC_4x4_KHR;if(_===Ei)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:S.COMPRESSED_RGBA_ASTC_5x4_KHR;if(_===ur)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:S.COMPRESSED_RGBA_ASTC_5x5_KHR;if(_===$n)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:S.COMPRESSED_RGBA_ASTC_6x5_KHR;if(_===q)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:S.COMPRESSED_RGBA_ASTC_6x6_KHR;if(_===re)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:S.COMPRESSED_RGBA_ASTC_8x5_KHR;if(_===ye)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:S.COMPRESSED_RGBA_ASTC_8x6_KHR;if(_===Se)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:S.COMPRESSED_RGBA_ASTC_8x8_KHR;if(_===He)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:S.COMPRESSED_RGBA_ASTC_10x5_KHR;if(_===at)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:S.COMPRESSED_RGBA_ASTC_10x6_KHR;if(_===vt)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:S.COMPRESSED_RGBA_ASTC_10x8_KHR;if(_===bt)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:S.COMPRESSED_RGBA_ASTC_10x10_KHR;if(_===qt)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:S.COMPRESSED_RGBA_ASTC_12x10_KHR;if(_===oe)return B===Ur?S.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:S.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(_===ue||_===Ce||_===Be)if(S=r.get("EXT_texture_compression_bptc"),S!==null){if(_===ue)return B===Ur?S.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:S.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(_===Ce)return S.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(_===Be)return S.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(_===Re||_===pt||_===Pt||_===Gt)if(S=r.get("EXT_texture_compression_rgtc"),S!==null){if(_===ue)return S.COMPRESSED_RED_RGTC1_EXT;if(_===pt)return S.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(_===Pt)return S.COMPRESSED_RED_GREEN_RGTC2_EXT;if(_===Gt)return S.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return _===dr?d?b.UNSIGNED_INT_24_8:(S=r.get("WEBGL_depth_texture"),S!==null?S.UNSIGNED_INT_24_8_WEBGL:null):b[_]!==void 0?b[_]:null}return{convert:g}}class ju extends Kr{constructor(){super(),this.isGroup=!0,this.type="Group"}}class __ extends Ms{constructor(r=[]){super(),this.isArrayCamera=!0,this.cameras=r}}var uT=new Ye,hT=new Ye;function _6(b,r,a){uT.setFromMatrixPosition(r.matrixWorld),hT.setFromMatrixPosition(a.matrixWorld);var d=uT.distanceTo(hT),g=r.projectionMatrix.elements,_=a.projectionMatrix.elements,C=g[14]/(g[10]-1),S=g[14]/(g[10]+1),B=(g[9]+1)/g[5],O=(g[9]-1)/g[5],H=(g[8]-1)/g[0],W=(_[8]+1)/_[0],j=C*H,J=C*W,ie=d/(-H+W),fe=ie*-H;r.matrixWorld.decompose(b.position,b.quaternion,b.scale),b.translateX(fe),b.translateZ(ie),b.matrixWorld.compose(b.position,b.quaternion,b.scale),b.matrixWorldInverse.copy(b.matrixWorld).invert();var se=C+ie,K=S+ie,Pe=j-fe,ve=J+(d-fe),Te=B*S/K*se,We=O*S/K*se;b.projectionMatrix.makePerspective(Pe,ve,Te,We,se,K)}function dT(b){var r,a,d=this,g=null,_=null,C=null,S=[],B=new _i,O=new _i,H=1,W="local-floor";typeof window<"u"&&"VRFrameData"in window&&(_=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",Te,!1));var j=new _i,J=new Ci,ie=new Ye,fe=new Ms;fe.viewport=new Mr,fe.layers.enable(1);var se=new Ms;se.viewport=new Mr,se.layers.enable(2);var K=new __([fe,se]);K.layers.enable(1),K.layers.enable(2);var Pe=new nn,ve;function Te(){var ct=d.isPresenting=g!==null&&g.isPresenting===!0;if(ct){var Dt=g.getEyeParameters("left");r=2*Dt.renderWidth*H,a=Dt.renderHeight*H,ve=b.getPixelRatio(),b.getSize(Pe),b.setDrawingBufferSize(r,a,1),fe.viewport.set(0,0,r/2,a),se.viewport.set(r/2,0,r/2,a),Ke.start(),d.dispatchEvent({type:"sessionstart"})}else d.enabled&&b.setDrawingBufferSize(Pe.width,Pe.height,ve),Ke.stop(),d.dispatchEvent({type:"sessionend"})}var We=[],qe=[];function st(ct){for(var Dt=navigator.getGamepads&&navigator.getGamepads(),Qt=0,dt=Dt.length;Qt<dt;Qt++){var wt=Dt[Qt];if(wt&&(wt.id==="Daydream Controller"||wt.id==="Gear VR Controller"||wt.id==="Oculus Go Controller"||wt.id==="OpenVR Gamepad"||wt.id.startsWith("Oculus Touch")||wt.id.startsWith("HTC Vive Focus")||wt.id.startsWith("Spatial Controller"))){var Kt=wt.hand;if(ct===0&&(Kt===""||Kt==="right")||ct===1&&Kt==="left")return wt}}}function lt(){for(var ct=0;ct<S.length;ct++){var Dt=S[ct],Qt=st(ct);if(Qt!==void 0&&Qt.pose!==void 0){if(Qt.pose===null)return;var dt=Qt.pose;dt.hasPosition===!1&&Dt.position.set(.2,-.6,-.05),dt.position!==null&&Dt.position.fromArray(dt.position),dt.orientation!==null&&Dt.quaternion.fromArray(dt.orientation),Dt.matrix.compose(Dt.position,Dt.quaternion,Dt.scale),Dt.matrix.premultiply(B),Dt.matrix.decompose(Dt.position,Dt.quaternion,Dt.scale),Dt.matrixWorldNeedsUpdate=!0,Dt.visible=!0;var wt=Qt.id==="Daydream Controller"?0:1;We[ct]===void 0&&(We[ct]=!1),We[ct]!==Qt.buttons[wt].pressed&&(We[ct]=Qt.buttons[wt].pressed,We[ct]===!0?Dt.dispatchEvent({type:"selectstart"}):(Dt.dispatchEvent({type:"selectend"}),Dt.dispatchEvent({type:"select"}))),wt=2,qe[ct]===void 0&&(qe[ct]=!1),Qt.buttons[wt]!==void 0&&qe[ct]!==Qt.buttons[wt].pressed&&(qe[ct]=Qt.buttons[wt].pressed,qe[ct]===!0?Dt.dispatchEvent({type:"squeezestart"}):(Dt.dispatchEvent({type:"squeezeend"}),Dt.dispatchEvent({type:"squeeze"})))}else Dt.visible=!1}}function Ve(ct,Dt){Dt!==null&&Dt.length===4&&ct.set(Dt[0]*r,Dt[1]*a,Dt[2]*r,Dt[3]*a)}this.enabled=!1,this.getController=function(ct){var Dt=S[ct];return Dt===void 0&&(Dt=new ju,Dt.matrixAutoUpdate=!1,Dt.visible=!1,S[ct]=Dt),Dt},this.getDevice=function(){return g},this.setDevice=function(ct){ct!==void 0&&(g=ct),Ke.setContext(ct)},this.setFramebufferScaleFactor=function(ct){H=ct},this.setReferenceSpaceType=function(ct){W=ct},this.setPoseTarget=function(ct){ct!==void 0&&(C=ct)},this.cameraAutoUpdate=!0,this.updateCamera=function(ct){var Dt=W==="local-floor"?1.6:0;if(g.depthNear=ct.near,g.depthFar=ct.far,g.getFrameData(_),W==="local-floor"){var Qt=g.stageParameters;Qt?B.fromArray(Qt.sittingToStandingTransform):B.makeTranslation(0,Dt,0)}var dt=_.pose,wt=C!==null?C:ct;wt.matrix.copy(B),wt.matrix.decompose(wt.position,wt.quaternion,wt.scale),dt.orientation!==null&&(J.fromArray(dt.orientation),wt.quaternion.multiply(J)),dt.position!==null&&(J.setFromRotationMatrix(B),ie.fromArray(dt.position),ie.applyQuaternion(J),wt.position.add(ie)),wt.updateMatrixWorld();for(var Kt=wt.children,$t=0,un=Kt.length;$t<un;$t++)Kt[$t].updateMatrixWorld(!0);fe.near=ct.near,se.near=ct.near,fe.far=ct.far,se.far=ct.far,fe.matrixWorldInverse.fromArray(_.leftViewMatrix),se.matrixWorldInverse.fromArray(_.rightViewMatrix),O.copy(B).invert(),W==="local-floor"&&(fe.matrixWorldInverse.multiply(O),se.matrixWorldInverse.multiply(O));var Zt=wt.parent;Zt!==null&&(j.copy(Zt.matrixWorld).invert(),fe.matrixWorldInverse.multiply(j),se.matrixWorldInverse.multiply(j)),fe.matrixWorld.copy(fe.matrixWorldInverse).invert(),se.matrixWorld.copy(se.matrixWorldInverse).invert(),fe.projectionMatrix.fromArray(_.leftProjectionMatrix),se.projectionMatrix.fromArray(_.rightProjectionMatrix),_6(K,fe,se);var An=g.getLayers();if(An.length){var gn=An[0];Ve(fe.viewport,gn.leftBounds),Ve(se.viewport,gn.rightBounds)}return lt(),K},this.getCamera=function(){return K},this.getFoveation=function(){return 1},this.setFoveation=function(ct){ct!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(d.isPresenting)return"opaque"},this.getStandingMatrix=function(){return B},this.isPresenting=!1;var Ke=new h_;this.setAnimationLoop=function(ct){Ke.setAnimationLoop(ct),this.isPresenting&&Ke.start()},this.submitFrame=function(){this.isPresenting&&g.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",Te)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(dT.prototype,{addEventListener:Eo.prototype.addEventListener,hasEventListener:Eo.prototype.hasEventListener,removeEventListener:Eo.prototype.removeEventListener,dispatchEvent:Eo.prototype.dispatchEvent});class fT extends No{constructor(r,a,d,g={}){super(r,a,g),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=d}copy(r){return super.copy(r),this.numViews=r.numViews,this}}fT.prototype.isWebGLMultiviewRenderTarget=!0;let b6={type:"move"};class b_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ju,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ju,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ye,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ye),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ju,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ye,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ye),this._grip}dispatchEvent(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this}connect(r){if(r&&r.hand){let a=this._hand;if(a)for(let d of r.hand.values())this._getHandJoint(a,d)}return this.dispatchEvent({type:"connected",data:r}),this}disconnect(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(r,a,d){let g=null,_=null,C=null,S=this._targetRay,B=this._grip,O=this._hand;if(r&&a.session.visibilityState!=="visible-blurred"){if(O&&r.hand){C=!0;for(let fe of r.hand.values()){let se=a.getJointPose(fe,d),K=this._getHandJoint(O,fe);se!==null&&(K.matrix.fromArray(se.transform.matrix),K.matrix.decompose(K.position,K.rotation,K.scale),K.matrixWorldNeedsUpdate=!0,K.jointRadius=se.radius),K.visible=se!==null}let H=O.joints["index-finger-tip"],W=O.joints["thumb-tip"],j=H.position.distanceTo(W.position),J=.02,ie=.005;O.inputState.pinching&&j>J+ie?(O.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!O.inputState.pinching&&j<=J-ie&&(O.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}else B!==null&&r.gripSpace&&(_=a.getPose(r.gripSpace,d),_!==null&&(B.matrix.fromArray(_.transform.matrix),B.matrix.decompose(B.position,B.rotation,B.scale),B.matrixWorldNeedsUpdate=!0,_.linearVelocity?(B.hasLinearVelocity=!0,B.linearVelocity.copy(_.linearVelocity)):B.hasLinearVelocity=!1,_.angularVelocity?(B.hasAngularVelocity=!0,B.angularVelocity.copy(_.angularVelocity)):B.hasAngularVelocity=!1));S!==null&&(g=a.getPose(r.targetRaySpace,d),g===null&&_!==null&&(g=_),g!==null&&(S.matrix.fromArray(g.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,g.linearVelocity?(S.hasLinearVelocity=!0,S.linearVelocity.copy(g.linearVelocity)):S.hasLinearVelocity=!1,g.angularVelocity?(S.hasAngularVelocity=!0,S.angularVelocity.copy(g.angularVelocity)):S.hasAngularVelocity=!1,this.dispatchEvent(b6)))}return S!==null&&(S.visible=g!==null),B!==null&&(B.visible=_!==null),O!==null&&(O.visible=C!==null),this}_getHandJoint(r,a){if(r.joints[a.jointName]===void 0){let d=new ju;d.matrixAutoUpdate=!1,d.visible=!1,r.joints[a.jointName]=d,r.add(d)}return r.joints[a.jointName]}}class pT extends Es{constructor(r,a,d,g,_,C,S,B,O,H){if(H=H!==void 0?H:le,H!==le&&H!==me)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d===void 0&&H===le&&(d=Gn),d===void 0&&H===me&&(d=dr),super(null,g,_,C,S,B,H,d,O),this.isDepthTexture=!0,this.image={width:r,height:a},this.magFilter=S!==void 0?S:nt,this.minFilter=B!==void 0?B:nt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(r){return super.copy(r),this.compareFunction=r.compareFunction,this}toJSON(r){let a=super.toJSON(r);return this.compareFunction!==null&&(a.compareFunction=this.compareFunction),a}}class M6 extends Eo{constructor(r,a,d,g){super();let _=this,C=null,S=1;var B=null;let O=null,H="local-floor",W=1,j=null,J=null;var ie=[];let fe=null,se=null,K=null,Pe=null,ve=a.getContextAttributes(),Te=null,We=null,qe=[],st=[],lt=new Ms;lt.layers.enable(1),lt.viewport=new Mr;let Ve=new Ms;Ve.layers.enable(2),Ve.viewport=new Mr;let Ke=[lt,Ve],ct=new __;ct.layers.enable(1),ct.layers.enable(2);let Dt=null,Qt=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return J},this.getController=function(Xt){let Tn=qe[Xt];return Tn===void 0&&(Tn=new b_,qe[Xt]=Tn),Tn.getTargetRaySpace()},this.getControllerGrip=function(Xt){let Tn=qe[Xt];return Tn===void 0&&(Tn=new b_,qe[Xt]=Tn),Tn.getGripSpace()},this.getHand=function(Xt){let Tn=qe[Xt];return Tn===void 0&&(Tn=new b_,qe[Xt]=Tn),Tn.getHandSpace()};function dt(Xt){let Tn=st.indexOf(Xt.inputSource);if(Tn===-1)return;let Mn=qe[Tn];Mn!==void 0&&(Mn.update(Xt.inputSource,Xt.frame,j||O),Mn.dispatchEvent({type:Xt.type,data:Xt.inputSource}))}function wt(){C.removeEventListener("select",dt),C.removeEventListener("selectstart",dt),C.removeEventListener("selectend",dt),C.removeEventListener("squeeze",dt),C.removeEventListener("squeezestart",dt),C.removeEventListener("squeezeend",dt),C.removeEventListener("end",wt),C.removeEventListener("inputsourceschange",Kt);for(let Xt=0;Xt<qe.length;Xt++){let Tn=st[Xt];Tn!==null&&(st[Xt]=null,qe[Xt].disconnect(Tn))}Dt=null,Qt=null,r.setRenderTarget(Te),K=null,se=null,fe=null,C=null,We=null,Ni.stop(),_.isPresenting=!1,_.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Xt){S=Xt,_.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Xt){H=Xt,_.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return j||O},this.setReferenceSpace=function(Xt){j=Xt},this.getBaseLayer=function(){return se!==null?se:K},this.getBinding=function(){return fe},this.getFrame=function(){return Pe},this.getSession=function(){return C},this.setSession=function(Xt){return So(this,null,function*(){if(C=Xt,C!==null){if(Te=r.getRenderTarget(),C.addEventListener("select",dt),C.addEventListener("selectstart",dt),C.addEventListener("selectend",dt),C.addEventListener("squeeze",dt),C.addEventListener("squeezestart",dt),C.addEventListener("squeezeend",dt),C.addEventListener("end",wt),C.addEventListener("inputsourceschange",Kt),ve.xrCompatible!==!0&&(yield a.makeXRCompatible()),C.renderState.layers===void 0||r.capabilities.isWebGL2===!1){let Tn={antialias:C.renderState.layers===void 0?ve.antialias:!0,alpha:!0,depth:ve.depth,stencil:ve.stencil,framebufferScaleFactor:S};K=new XRWebGLLayer(C,a,Tn),C.updateRenderState({baseLayer:K}),We=new No(K.framebufferWidth,K.framebufferHeight,{format:Mi,type:xt,colorSpace:r.outputColorSpace,stencilBuffer:ve.stencil})}else{let Tn=null,Mn=null,bi=null;ve.depth&&(bi=ve.stencil?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT24,Tn=ve.stencil?me:le,Mn=ve.stencil?dr:Gn),_.isMultiview=g&&d.has("OCULUS_multiview");let ei={colorFormat:a.RGBA8,depthFormat:bi,scaleFactor:S};_.isMultiview&&(ei.textureType="texture-array"),fe=new XRWebGLBinding(C,a),se=fe.createProjectionLayer(ei),C.updateRenderState({layers:[se]});let ii={format:Mi,type:xt,depthTexture:new pT(se.textureWidth,se.textureHeight,Mn,void 0,void 0,void 0,void 0,void 0,void 0,Tn),stencilBuffer:ve.stencil,colorSpace:r.outputColorSpace,samples:ve.antialias?4:0};if(_.isMultiview){let on=d.get("OCULUS_multiview");this.maxNumViews=a.getParameter(on.MAX_VIEWS_OVR),We=new fT(se.textureWidth,se.textureHeight,2,ii)}else We=new No(se.textureWidth,se.textureHeight,ii);let vi=r.properties.get(We);vi.__ignoreDepthValues=se.ignoreDepthValues}We.isXRRenderTarget=!0,this.setFoveation(W),j=null,O=yield C.requestReferenceSpace(H),Ni.setContext(C),Ni.start(),_.isPresenting=!0,_.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(C!==null)return C.environmentBlendMode},this.addLayer=function(Xt){!window.XRWebGLBinding||!this.layersEnabled||!C||(ie.push(Xt),this.updateLayers())},this.removeLayer=function(Xt){ie.splice(ie.indexOf(Xt),1),!(!window.XRWebGLBinding||!this.layersEnabled||!C)&&this.updateLayers()},this.updateLayers=function(){var Xt=ie.map(function(Tn){return Tn});Xt.unshift(C.renderState.layers[0]),C.updateRenderState({layers:Xt})};function Kt(Xt){for(let Tn=0;Tn<Xt.removed.length;Tn++){let Mn=Xt.removed[Tn],bi=st.indexOf(Mn);bi>=0&&(st[bi]=null,qe[bi].disconnect(Mn))}for(let Tn=0;Tn<Xt.added.length;Tn++){let Mn=Xt.added[Tn],bi=st.indexOf(Mn);if(bi===-1){for(let ii=0;ii<qe.length;ii++)if(ii>=st.length){st.push(Mn),bi=ii;break}else if(st[ii]===null){st[ii]=Mn,bi=ii;break}if(bi===-1)break}let ei=qe[bi];ei&&ei.connect(Mn)}}let $t=new Ye,un=new Ye;function Zt(Xt,Tn,Mn){$t.setFromMatrixPosition(Tn.matrixWorld),un.setFromMatrixPosition(Mn.matrixWorld);let bi=$t.distanceTo(un),ei=Tn.projectionMatrix.elements,ii=Mn.projectionMatrix.elements,vi=ei[14]/(ei[10]-1),on=ei[14]/(ei[10]+1),ft=(ei[9]+1)/ei[5],dn=(ei[9]-1)/ei[5],Dn=(ei[8]-1)/ei[0],an=(ii[8]+1)/ii[0],Vn=vi*Dn,pi=vi*an,ti=bi/(-Dn+an),mi=ti*-Dn;Tn.matrixWorld.decompose(Xt.position,Xt.quaternion,Xt.scale),Xt.translateX(mi),Xt.translateZ(ti),Xt.matrixWorld.compose(Xt.position,Xt.quaternion,Xt.scale),Xt.matrixWorldInverse.copy(Xt.matrixWorld).invert();let hr=vi+ti,$r=on+ti,Ss=Vn-mi,Br=pi+(bi-mi),Tr=ft*on/$r*hr,hs=dn*on/$r*hr;Xt.projectionMatrix.makePerspective(Ss,Br,Tr,hs,hr,$r),Xt.projectionMatrixInverse.copy(Xt.projectionMatrix).invert()}function An(Xt,Tn){Tn===null?Xt.matrixWorld.copy(Xt.matrix):Xt.matrixWorld.multiplyMatrices(Tn.matrixWorld,Xt.matrix),Xt.matrixWorldInverse.copy(Xt.matrixWorld).invert()}this.setPoseTarget=function(Xt){Xt!==void 0&&(B=Xt)},this.updateCamera=function(Xt){if(C===null)return;ct.near=Ve.near=lt.near=Xt.near,ct.far=Ve.far=lt.far=Xt.far,(Dt!==ct.near||Qt!==ct.far)&&(C.updateRenderState({depthNear:ct.near,depthFar:ct.far}),Dt=ct.near,Qt=ct.far);let Tn=ct.cameras;var Mn=B||Xt;let bi=Mn.parent;An(ct,bi);for(let ei=0;ei<Tn.length;ei++)An(Tn[ei],bi);Tn.length===2?Zt(ct,lt,Ve):ct.projectionMatrix.copy(lt.projectionMatrix),gn(Xt,ct,Mn)};function gn(Xt,Tn,Mn){Tn.matrixWorld.decompose(Tn.position,Tn.quaternion,Tn.scale),Mn.parent===null?Mn.matrix.copy(Tn.matrixWorld):(Mn.matrix.copy(Mn.parent.matrixWorld),Mn.matrix.invert(),Mn.matrix.multiply(Tn.matrixWorld)),Mn.matrix.decompose(Mn.position,Mn.quaternion,Mn.scale),Mn.updateMatrixWorld(!0),Xt.projectionMatrix.copy(Tn.projectionMatrix),Xt.projectionMatrixInverse.copy(Tn.projectionMatrixInverse),Xt.isPerspectiveCamera&&(Xt.fov=Tl*2*Math.atan(1/Xt.projectionMatrix.elements[5]),Xt.zoom=1)}this.getCamera=function(){return ct},this.getFoveation=function(){if(!(se===null&&K===null))return W},this.setFoveation=function(Xt){W=Xt,se!==null&&(se.fixedFoveation=Xt),K!==null&&K.fixedFoveation!==void 0&&(K.fixedFoveation=Xt)};let Qn=null;function ji(Xt,Tn){if(J=Tn.getViewerPose(j||O),Pe=Tn,J!==null){let Mn=J.views;K!==null&&(r.setRenderTargetFramebuffer(We,K.framebuffer),r.setRenderTarget(We));let bi=!1;Mn.length!==ct.cameras.length&&(ct.cameras.length=0,bi=!0);for(let ei=0;ei<Mn.length;ei++){let ii=Mn[ei],vi=null;if(K!==null)vi=K.getViewport(ii);else{let ft=fe.getViewSubImage(se,ii);vi=ft.viewport,ei===0&&(r.setRenderTargetTextures(We,ft.colorTexture,se.ignoreDepthValues?void 0:ft.depthStencilTexture),r.setRenderTarget(We))}let on=Ke[ei];on===void 0&&(on=new Ms,on.layers.enable(ei),on.viewport=new Mr,Ke[ei]=on),on.matrix.fromArray(ii.transform.matrix),on.matrix.decompose(on.position,on.quaternion,on.scale),on.projectionMatrix.fromArray(ii.projectionMatrix),on.projectionMatrixInverse.copy(on.projectionMatrix).invert(),on.viewport.set(vi.x,vi.y,vi.width,vi.height),ei===0&&(ct.matrix.copy(on.matrix),ct.matrix.decompose(ct.position,ct.quaternion,ct.scale)),bi===!0&&ct.cameras.push(on)}}for(let Mn=0;Mn<qe.length;Mn++){let bi=st[Mn],ei=qe[Mn];bi!==null&&ei!==void 0&&ei.update(bi,Tn,j||O)}Qn&&Qn(Xt,Tn),Tn.detectedPlanes&&_.dispatchEvent({type:"planesdetected",data:Tn}),Pe=null}let Ni=new h_;Ni.setAnimationLoop(ji),this.setAnimationLoop=function(Xt){Qn=Xt},this.dispose=function(){}}}function w6(b,r){function a(se,K){se.matrixAutoUpdate===!0&&se.updateMatrix(),K.value.copy(se.matrix)}function d(se,K){K.color.getRGB(se.fogColor.value,B2(b)),K.isFog?(se.fogNear.value=K.near,se.fogFar.value=K.far):K.isFogExp2&&(se.fogDensity.value=K.density)}function g(se,K,Pe,ve,Te){K.isMeshBasicMaterial||K.isMeshLambertMaterial?_(se,K):K.isMeshToonMaterial?(_(se,K),W(se,K)):K.isMeshPhongMaterial?(_(se,K),H(se,K)):K.isMeshStandardMaterial?(_(se,K),j(se,K),K.isMeshPhysicalMaterial&&J(se,K,Te)):K.isMeshMatcapMaterial?(_(se,K),ie(se,K)):K.isMeshDepthMaterial?_(se,K):K.isMeshDistanceMaterial?(_(se,K),fe(se,K)):K.isMeshNormalMaterial?_(se,K):K.isLineBasicMaterial?(C(se,K),K.isLineDashedMaterial&&S(se,K)):K.isPointsMaterial?B(se,K,Pe,ve):K.isSpriteMaterial?O(se,K):K.isShadowMaterial?(se.color.value.copy(K.color),se.opacity.value=K.opacity):K.isShaderMaterial&&(K.uniformsNeedUpdate=!1)}function _(se,K){se.opacity.value=K.opacity,K.color&&se.diffuse.value.copy(K.color),K.emissive&&se.emissive.value.copy(K.emissive).multiplyScalar(K.emissiveIntensity),K.map&&(se.map.value=K.map,a(K.map,se.mapTransform)),K.alphaMap&&(se.alphaMap.value=K.alphaMap,a(K.alphaMap,se.alphaMapTransform)),K.bumpMap&&(se.bumpMap.value=K.bumpMap,a(K.bumpMap,se.bumpMapTransform),se.bumpScale.value=K.bumpScale,K.side===M&&(se.bumpScale.value*=-1)),K.normalMap&&(se.normalMap.value=K.normalMap,a(K.normalMap,se.normalMapTransform),se.normalScale.value.copy(K.normalScale),K.side===M&&se.normalScale.value.negate()),K.displacementMap&&(se.displacementMap.value=K.displacementMap,a(K.displacementMap,se.displacementMapTransform),se.displacementScale.value=K.displacementScale,se.displacementBias.value=K.displacementBias),K.emissiveMap&&(se.emissiveMap.value=K.emissiveMap,a(K.emissiveMap,se.emissiveMapTransform)),K.specularMap&&(se.specularMap.value=K.specularMap,a(K.specularMap,se.specularMapTransform)),K.alphaTest>0&&(se.alphaTest.value=K.alphaTest);let Pe=r.get(K).envMap;if(Pe&&(se.envMap.value=Pe,se.flipEnvMap.value=Pe.isCubeTexture&&Pe.isRenderTargetTexture===!1?-1:1,se.reflectivity.value=K.reflectivity,se.ior.value=K.ior,se.refractionRatio.value=K.refractionRatio),K.lightMap){se.lightMap.value=K.lightMap;let ve=b._useLegacyLights===!0?Math.PI:1;se.lightMapIntensity.value=K.lightMapIntensity*ve,a(K.lightMap,se.lightMapTransform)}K.aoMap&&(se.aoMap.value=K.aoMap,se.aoMapIntensity.value=K.aoMapIntensity,a(K.aoMap,se.aoMapTransform))}function C(se,K){se.diffuse.value.copy(K.color),se.opacity.value=K.opacity,K.map&&(se.map.value=K.map,a(K.map,se.mapTransform))}function S(se,K){se.dashSize.value=K.dashSize,se.totalSize.value=K.dashSize+K.gapSize,se.scale.value=K.scale}function B(se,K,Pe,ve){se.diffuse.value.copy(K.color),se.opacity.value=K.opacity,se.size.value=K.size*Pe,se.scale.value=ve*.5,K.map&&(se.map.value=K.map,a(K.map,se.uvTransform)),K.alphaMap&&(se.alphaMap.value=K.alphaMap,a(K.alphaMap,se.alphaMapTransform)),K.alphaTest>0&&(se.alphaTest.value=K.alphaTest)}function O(se,K){se.diffuse.value.copy(K.color),se.opacity.value=K.opacity,se.rotation.value=K.rotation,K.map&&(se.map.value=K.map,a(K.map,se.mapTransform)),K.alphaMap&&(se.alphaMap.value=K.alphaMap,a(K.alphaMap,se.alphaMapTransform)),K.alphaTest>0&&(se.alphaTest.value=K.alphaTest)}function H(se,K){se.specular.value.copy(K.specular),se.shininess.value=Math.max(K.shininess,1e-4)}function W(se,K){K.gradientMap&&(se.gradientMap.value=K.gradientMap)}function j(se,K){se.metalness.value=K.metalness,K.metalnessMap&&(se.metalnessMap.value=K.metalnessMap,a(K.metalnessMap,se.metalnessMapTransform)),se.roughness.value=K.roughness,K.roughnessMap&&(se.roughnessMap.value=K.roughnessMap,a(K.roughnessMap,se.roughnessMapTransform)),r.get(K).envMap&&(se.envMapIntensity.value=K.envMapIntensity)}function J(se,K,Pe){se.ior.value=K.ior,K.sheen>0&&(se.sheenColor.value.copy(K.sheenColor).multiplyScalar(K.sheen),se.sheenRoughness.value=K.sheenRoughness,K.sheenColorMap&&(se.sheenColorMap.value=K.sheenColorMap,a(K.sheenColorMap,se.sheenColorMapTransform)),K.sheenRoughnessMap&&(se.sheenRoughnessMap.value=K.sheenRoughnessMap,a(K.sheenRoughnessMap,se.sheenRoughnessMapTransform))),K.clearcoat>0&&(se.clearcoat.value=K.clearcoat,se.clearcoatRoughness.value=K.clearcoatRoughness,K.clearcoatMap&&(se.clearcoatMap.value=K.clearcoatMap,a(K.clearcoatMap,se.clearcoatMapTransform)),K.clearcoatRoughnessMap&&(se.clearcoatRoughnessMap.value=K.clearcoatRoughnessMap,a(K.clearcoatRoughnessMap,se.clearcoatRoughnessMapTransform)),K.clearcoatNormalMap&&(se.clearcoatNormalMap.value=K.clearcoatNormalMap,a(K.clearcoatNormalMap,se.clearcoatNormalMapTransform),se.clearcoatNormalScale.value.copy(K.clearcoatNormalScale),K.side===M&&se.clearcoatNormalScale.value.negate())),K.iridescence>0&&(se.iridescence.value=K.iridescence,se.iridescenceIOR.value=K.iridescenceIOR,se.iridescenceThicknessMinimum.value=K.iridescenceThicknessRange[0],se.iridescenceThicknessMaximum.value=K.iridescenceThicknessRange[1],K.iridescenceMap&&(se.iridescenceMap.value=K.iridescenceMap,a(K.iridescenceMap,se.iridescenceMapTransform)),K.iridescenceThicknessMap&&(se.iridescenceThicknessMap.value=K.iridescenceThicknessMap,a(K.iridescenceThicknessMap,se.iridescenceThicknessMapTransform))),K.transmission>0&&(se.transmission.value=K.transmission,se.transmissionSamplerMap.value=Pe.texture,se.transmissionSamplerSize.value.set(Pe.width,Pe.height),K.transmissionMap&&(se.transmissionMap.value=K.transmissionMap,a(K.transmissionMap,se.transmissionMapTransform)),se.thickness.value=K.thickness,K.thicknessMap&&(se.thicknessMap.value=K.thicknessMap,a(K.thicknessMap,se.thicknessMapTransform)),se.attenuationDistance.value=K.attenuationDistance,se.attenuationColor.value.copy(K.attenuationColor)),K.anisotropy>0&&(se.anisotropyVector.value.set(K.anisotropy*Math.cos(K.anisotropyRotation),K.anisotropy*Math.sin(K.anisotropyRotation)),K.anisotropyMap&&(se.anisotropyMap.value=K.anisotropyMap,a(K.anisotropyMap,se.anisotropyMapTransform))),se.specularIntensity.value=K.specularIntensity,se.specularColor.value.copy(K.specularColor),K.specularColorMap&&(se.specularColorMap.value=K.specularColorMap,a(K.specularColorMap,se.specularColorMapTransform)),K.specularIntensityMap&&(se.specularIntensityMap.value=K.specularIntensityMap,a(K.specularIntensityMap,se.specularIntensityMapTransform))}function ie(se,K){K.matcap&&(se.matcap.value=K.matcap)}function fe(se,K){let Pe=r.get(K).light;se.referencePosition.value.setFromMatrixPosition(Pe.matrixWorld),se.nearDistance.value=Pe.shadow.camera.near,se.farDistance.value=Pe.shadow.camera.far}return{refreshFogUniforms:d,refreshMaterialUniforms:g}}function C6(b,r,a,d){let g={},_={},C=[],S=a.isWebGL2?b.getParameter(b.MAX_UNIFORM_BUFFER_BINDINGS):0;function B(Pe,ve){let Te=ve.program;d.uniformBlockBinding(Pe,Te)}function O(Pe,ve){let Te=g[Pe.id];Te===void 0&&(ie(Pe),Te=H(Pe),g[Pe.id]=Te,Pe.addEventListener("dispose",se));let We=ve.program;d.updateUBOMapping(Pe,We);let qe=r.render.frame;_[Pe.id]!==qe&&(j(Pe),_[Pe.id]=qe)}function H(Pe){let ve=W();Pe.__bindingPointIndex=ve;let Te=b.createBuffer(),We=Pe.__size,qe=Pe.usage;return b.bindBuffer(b.UNIFORM_BUFFER,Te),b.bufferData(b.UNIFORM_BUFFER,We,qe),b.bindBuffer(b.UNIFORM_BUFFER,null),b.bindBufferBase(b.UNIFORM_BUFFER,ve,Te),Te}function W(){for(let Pe=0;Pe<S;Pe++)if(C.indexOf(Pe)===-1)return C.push(Pe),Pe;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function j(Pe){let ve=g[Pe.id],Te=Pe.uniforms,We=Pe.__cache;b.bindBuffer(b.UNIFORM_BUFFER,ve);for(let qe=0,st=Te.length;qe<st;qe++){let lt=Te[qe];if(J(lt,qe,We)===!0){let Ve=lt.__offset,Ke=Array.isArray(lt.value)?lt.value:[lt.value],ct=0;for(let Dt=0;Dt<Ke.length;Dt++){let Qt=Ke[Dt],dt=fe(Qt);typeof Qt=="number"?(lt.__data[0]=Qt,b.bufferSubData(b.UNIFORM_BUFFER,Ve+ct,lt.__data)):Qt.isMatrix3?(lt.__data[0]=Qt.elements[0],lt.__data[1]=Qt.elements[1],lt.__data[2]=Qt.elements[2],lt.__data[3]=Qt.elements[0],lt.__data[4]=Qt.elements[3],lt.__data[5]=Qt.elements[4],lt.__data[6]=Qt.elements[5],lt.__data[7]=Qt.elements[0],lt.__data[8]=Qt.elements[6],lt.__data[9]=Qt.elements[7],lt.__data[10]=Qt.elements[8],lt.__data[11]=Qt.elements[0]):(Qt.toArray(lt.__data,ct),ct+=dt.storage/Float32Array.BYTES_PER_ELEMENT)}b.bufferSubData(b.UNIFORM_BUFFER,Ve,lt.__data)}}b.bindBuffer(b.UNIFORM_BUFFER,null)}function J(Pe,ve,Te){let We=Pe.value;if(Te[ve]===void 0){if(typeof We=="number")Te[ve]=We;else{let qe=Array.isArray(We)?We:[We],st=[];for(let lt=0;lt<qe.length;lt++)st.push(qe[lt].clone());Te[ve]=st}return!0}else if(typeof We=="number"){if(Te[ve]!==We)return Te[ve]=We,!0}else{let qe=Array.isArray(Te[ve])?Te[ve]:[Te[ve]],st=Array.isArray(We)?We:[We];for(let lt=0;lt<qe.length;lt++){let Ve=qe[lt];if(Ve.equals(st[lt])===!1)return Ve.copy(st[lt]),!0}}return!1}function ie(Pe){let ve=Pe.uniforms,Te=0,We=16,qe=0;for(let st=0,lt=ve.length;st<lt;st++){let Ve=ve[st],Ke={boundary:0,storage:0},ct=Array.isArray(Ve.value)?Ve.value:[Ve.value];for(let Dt=0,Qt=ct.length;Dt<Qt;Dt++){let dt=ct[Dt],wt=fe(dt);Ke.boundary+=wt.boundary,Ke.storage+=wt.storage}if(Ve.__data=new Float32Array(Ke.storage/Float32Array.BYTES_PER_ELEMENT),Ve.__offset=Te,st>0){qe=Te%We;let Dt=We-qe;qe!==0&&Dt-Ke.boundary<0&&(Te+=We-qe,Ve.__offset=Te)}Te+=Ke.storage}return qe=Te%We,qe>0&&(Te+=We-qe),Pe.__size=Te,Pe.__cache={},this}function fe(Pe){let ve={boundary:0,storage:0};return typeof Pe=="number"?(ve.boundary=4,ve.storage=4):Pe.isVector2?(ve.boundary=8,ve.storage=8):Pe.isVector3||Pe.isColor?(ve.boundary=16,ve.storage=12):Pe.isVector4?(ve.boundary=16,ve.storage=16):Pe.isMatrix3?(ve.boundary=48,ve.storage=48):Pe.isMatrix4?(ve.boundary=64,ve.storage=64):Pe.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Pe),ve}function se(Pe){let ve=Pe.target;ve.removeEventListener("dispose",se);let Te=C.indexOf(ve.__bindingPointIndex);C.splice(Te,1),b.deleteBuffer(g[ve.id]),delete g[ve.id],delete _[ve.id]}function K(){for(let Pe in g)b.deleteBuffer(g[Pe]);C=[],g={},_={}}return{bind:B,update:O,dispose:K}}class mT{constructor(r={}){let{canvas:a=c0(),context:d=null,depth:g=!0,stencil:_=!0,alpha:C=!1,antialias:S=!1,premultipliedAlpha:B=!0,preserveDrawingBuffer:O=!1,powerPreference:H="default",failIfMajorPerformanceCaveat:W=!1,multiviewStereo:j=!1}=r;this.isWebGLRenderer=!0;let J;d!==null?J=d.getContextAttributes().alpha:J=C;let ie=new Uint32Array(4),fe=new Int32Array(4),se=null,K=null,Pe=[],ve=[];this.domElement=a,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Gr,this._useLegacyLights=!1,this.toneMapping=De,this.toneMappingExposure=1;let Te=this,We=!1,qe=0,st=0,lt=null,Ve=-1,Ke=null,ct=new Mr,Dt=new Mr,Qt=null,dt=new jn(0),wt=0,Kt=a.width,$t=a.height,un=1,Zt=null,An=null,gn=new Mr(0,0,Kt,$t),Qn=new Mr(0,0,Kt,$t),ji=!1,Ni=new R0,Xt=!1,Tn=!1,Mn=null,bi=new _i,ei=new nn,ii=new Ye,vi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function on(){return lt===null?un:1}let ft=d;function dn(je,Mt){for(let Ut=0;Ut<je.length;Ut++){let Ht=je[Ut],zt=a.getContext(Ht,Mt);if(zt!==null)return zt}return null}try{let je={alpha:!0,depth:g,stencil:_,antialias:S,premultipliedAlpha:B,preserveDrawingBuffer:O,powerPreference:H,failIfMajorPerformanceCaveat:W};if("setAttribute"in a&&a.setAttribute("data-engine",`three.js r${l}`),a.addEventListener("webglcontextlost",_n,!1),a.addEventListener("webglcontextrestored",rn,!1),a.addEventListener("webglcontextcreationerror",vn,!1),ft===null){let Mt=["webgl2","webgl","experimental-webgl"];if(Te.isWebGL1Renderer===!0&&Mt.shift(),ft=dn(Mt,je),ft===null)throw dn(Mt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ft instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ft.getShaderPrecisionFormat===void 0&&(ft.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(je){throw console.error("THREE.WebGLRenderer: "+je.message),je}let Dn,an,Vn,pi,ti,mi,hr,$r,Ss,Br,Tr,hs,Ho,Je,ke,Nt,ln,fn,hn,li,kn,Yn,gi,pr,wn;function ts(){Dn=new k5(ft),an=new P5(ft,Dn,r),Dn.init(an),gi=new lT(ft,Dn,an),Vn=new x6(ft,Dn,an),pi=new z5(ft),ti=new c6,mi=new E6(ft,Dn,Vn,ti,an,gi,pi),hr=new O5(Te),$r=new U5(Te),Ss=new L4(ft,an),pr=new D5(ft,Dn,Ss,an),Br=new V5(ft,Ss,pi,pr),Tr=new X5(ft,Br,Ss,pi),li=new j5(ft,an,mi),Nt=new B5(ti),hs=new a6(Te,hr,$r,Dn,an,pr,Nt),Ho=new w6(Te,ti),Je=new u6,ke=new g6(Dn,an),hn=new R5(Te,hr,$r,Vn,Tr,J,B),fn=new Q5(Te,Dn,ft),ln=new y6(Te,Tr,an),wn=new C6(ft,pi,an,Vn),kn=new L5(ft,Dn,pi,an),Yn=new H5(ft,Dn,pi,an),pi.programs=hs.programs,Te.capabilities=an,Te.extensions=Dn,Te.properties=ti,Te.renderLists=Je,Te.shadowMap=ln,Te.state=Vn,Te.info=pi}ts();let ht=typeof navigator<"u"&&"xr"in navigator?new M6(Te,ft,Dn,j):new dT(Te);this.xr=ht,this.getContext=function(){return ft},this.getContextAttributes=function(){return ft.getContextAttributes()},this.forceContextLoss=function(){let je=Dn.get("WEBGL_lose_context");je&&je.loseContext()},this.forceContextRestore=function(){let je=Dn.get("WEBGL_lose_context");je&&je.restoreContext()},this.getPixelRatio=function(){return un},this.setPixelRatio=function(je){je!==void 0&&(un=je,this.setSize(Kt,$t,!1))},this.getSize=function(je){return je.set(Kt,$t)},this.setSize=function(je,Mt,Ut=!0){if(ht.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Kt=je,$t=Mt,a.width=Math.floor(je*un),a.height=Math.floor(Mt*un),Ut===!0&&(a.style.width=je+"px",a.style.height=Mt+"px"),this.setViewport(0,0,je,Mt)},this.getDrawingBufferSize=function(je){return je.set(Kt*un,$t*un).floor()},this.setDrawingBufferSize=function(je,Mt,Ut){Kt=je,$t=Mt,un=Ut,a.width=Math.floor(je*Ut),a.height=Math.floor(Mt*Ut),this.setViewport(0,0,je,Mt)},this.getCurrentViewport=function(je){return je.copy(ct)},this.getViewport=function(je){return je.copy(gn)},this.setViewport=function(je,Mt,Ut,Ht){je.isVector4?gn.set(je.x,je.y,je.z,je.w):gn.set(je,Mt,Ut,Ht),Vn.viewport(ct.copy(gn).multiplyScalar(un).floor())},this.getScissor=function(je){return je.copy(Qn)},this.setScissor=function(je,Mt,Ut,Ht){je.isVector4?Qn.set(je.x,je.y,je.z,je.w):Qn.set(je,Mt,Ut,Ht),Vn.scissor(Dt.copy(Qn).multiplyScalar(un).floor())},this.getScissorTest=function(){return ji},this.setScissorTest=function(je){Vn.setScissorTest(ji=je)},this.setOpaqueSort=function(je){Zt=je},this.setTransparentSort=function(je){An=je},this.getClearColor=function(je){return je.copy(hn.getClearColor())},this.setClearColor=function(){hn.setClearColor.apply(hn,arguments)},this.getClearAlpha=function(){return hn.getClearAlpha()},this.setClearAlpha=function(){hn.setClearAlpha.apply(hn,arguments)},this.clear=function(je=!0,Mt=!0,Ut=!0){let Ht=0;if(je){let zt=!1;if(lt!==null){let Xn=lt.texture.format;zt=Xn===Ct||Xn===At||Xn===Xe}if(zt){let Xn=lt.texture.type,hi=Xn===xt||Xn===Gn||Xn===In||Xn===dr||Xn===Ti||Xn===ir,wi=hn.getClearColor(),Li=hn.getClearAlpha(),tr=wi.r,Vi=wi.g,Qi=wi.b;hi?(ie[0]=tr,ie[1]=Vi,ie[2]=Qi,ie[3]=Li,ft.clearBufferuiv(ft.COLOR,0,ie)):(fe[0]=tr,fe[1]=Vi,fe[2]=Qi,fe[3]=Li,ft.clearBufferiv(ft.COLOR,0,fe))}else Ht|=ft.COLOR_BUFFER_BIT}Mt&&(Ht|=ft.DEPTH_BUFFER_BIT),Ut&&(Ht|=ft.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ft.clear(Ht)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){a.removeEventListener("webglcontextlost",_n,!1),a.removeEventListener("webglcontextrestored",rn,!1),a.removeEventListener("webglcontextcreationerror",vn,!1),Je.dispose(),ke.dispose(),ti.dispose(),hr.dispose(),$r.dispose(),Tr.dispose(),pr.dispose(),wn.dispose(),hs.dispose(),ht.dispose(),ht.removeEventListener("sessionstart",Dr),ht.removeEventListener("sessionend",Ys),Mn&&(Mn.dispose(),Mn=null),rh.stop()};function _n(je){je.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),We=!0}function rn(){console.log("THREE.WebGLRenderer: Context Restored."),We=!1;let je=pi.autoReset,Mt=ln.enabled,Ut=ln.autoUpdate,Ht=ln.needsUpdate,zt=ln.type;ts(),pi.autoReset=je,ln.enabled=Mt,ln.autoUpdate=Ut,ln.needsUpdate=Ht,ln.type=zt}function vn(je){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",je.statusMessage)}function Fn(je){let Mt=je.target;Mt.removeEventListener("dispose",Fn),Di(Mt)}function Di(je){er(je),ti.remove(je)}function er(je){let Mt=ti.get(je).programs;Mt!==void 0&&(Mt.forEach(function(Ut){hs.releaseProgram(Ut)}),je.isShaderMaterial&&hs.releaseShaderCache(je))}this.renderBufferDirect=function(je,Mt,Ut,Ht,zt,Xn){Mt===null&&(Mt=vi);let hi=zt.isMesh&&zt.matrixWorld.determinant()<0,wi=m7(je,Mt,Ut,Ht,zt);Vn.setMaterial(Ht,hi);let Li=Ut.index,tr=1;if(Ht.wireframe===!0){if(Li=Br.getWireframeAttribute(Ut),Li===void 0)return;tr=2}let Vi=Ut.drawRange,Qi=Ut.attributes.position,ds=Vi.start*tr,Jo=(Vi.start+Vi.count)*tr;Xn!==null&&(ds=Math.max(ds,Xn.start*tr),Jo=Math.min(Jo,(Xn.start+Xn.count)*tr)),Li!==null?(ds=Math.max(ds,0),Jo=Math.min(Jo,Li.count)):Qi!=null&&(ds=Math.max(ds,0),Jo=Math.min(Jo,Qi.count));let Vs=Jo-ds;if(Vs<0||Vs===1/0)return;pr.setup(zt,Ht,wi,Ut,Li);let Vl,rs=kn;if(Li!==null&&(Vl=Ss.get(Li),rs=Yn,rs.setIndex(Vl)),zt.isMesh)Ht.wireframe===!0?(Vn.setLineWidth(Ht.wireframeLinewidth*on()),rs.setMode(ft.LINES)):rs.setMode(ft.TRIANGLES);else if(zt.isLine){let sh=Ht.linewidth;sh===void 0&&(sh=1),Vn.setLineWidth(sh*on()),zt.isLineSegments?rs.setMode(ft.LINES):zt.isLineLoop?rs.setMode(ft.LINE_LOOP):rs.setMode(ft.LINE_STRIP)}else zt.isPoints?rs.setMode(ft.POINTS):zt.isSprite&&rs.setMode(ft.TRIANGLES);if(zt.isInstancedMesh)rs.renderInstances(ds,Vs,zt.count);else if(Ut.isInstancedBufferGeometry){let sh=Ut._maxInstanceCount!==void 0?Ut._maxInstanceCount:1/0,wr=Math.min(Ut.instanceCount,sh);rs.renderInstances(ds,Vs,wr)}else rs.render(ds,Vs)};function Yi(je,Mt,Ut){je.transparent===!0&&je.side===T&&je.forceSinglePass===!1?(je.side=M,je.needsUpdate=!0,CA(je,Mt,Ut),je.side=w,je.needsUpdate=!0,CA(je,Mt,Ut),je.side=T):CA(je,Mt,Ut)}this.compile=function(je,Mt,Ut=null){Ut===null&&(Ut=je),K=ke.get(Ut),K.init(),ve.push(K),Ut.traverseVisible(function(zt){zt.isLight&&zt.layers.test(Mt.layers)&&(K.pushLight(zt),zt.castShadow&&K.pushShadow(zt))}),je!==Ut&&je.traverseVisible(function(zt){zt.isLight&&zt.layers.test(Mt.layers)&&(K.pushLight(zt),zt.castShadow&&K.pushShadow(zt))}),K.setupLights(Te._useLegacyLights);let Ht=new Set;return je.traverse(function(zt){let Xn=zt.material;if(Xn)if(Array.isArray(Xn))for(let hi=0;hi<Xn.length;hi++){let wi=Xn[hi];Yi(wi,Ut,zt),Ht.add(wi)}else Yi(Xn,Ut,zt),Ht.add(Xn)}),ve.pop(),K=null,Ht},this.compileAsync=function(je,Mt,Ut=null){let Ht=this.compile(je,Mt,Ut);return new Promise(zt=>{function Xn(){if(Ht.forEach(function(hi){ti.get(hi).currentProgram.isReady()&&Ht.delete(hi)}),Ht.size===0){zt(je);return}setTimeout(Xn,10)}Dn.get("KHR_parallel_shader_compile")!==null?Xn():setTimeout(Xn,10)})};let bn=null;function ui(je){bn&&bn(je)}function Dr(){rh.stop()}function Ys(){rh.start()}let rh=new h_;rh.setAnimationLoop(ui),typeof self<"u"&&rh.setContext(self),this.setAnimationLoop=function(je){bn=je,ht.setAnimationLoop(je),je===null?rh.stop():rh.start()},ht.addEventListener("sessionstart",Dr),ht.addEventListener("sessionend",Ys),this.render=function(je,Mt){if(Mt!==void 0&&Mt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(We===!0)return;je.matrixWorldAutoUpdate===!0&&je.updateMatrixWorld(),Mt.parent===null&&Mt.matrixWorldAutoUpdate===!0&&Mt.updateMatrixWorld(),ht.enabled===!0&&ht.isPresenting===!0&&(ht.cameraAutoUpdate===!0&&ht.updateCamera(Mt),Mt=ht.getCamera()),je.isScene===!0&&je.onBeforeRender(Te,je,Mt,lt),K=ke.get(je,ve.length),K.init(),ve.push(K),bi.multiplyMatrices(Mt.projectionMatrix,Mt.matrixWorldInverse),Ni.setFromProjectionMatrix(bi),Tn=this.localClippingEnabled,Xt=Nt.init(this.clippingPlanes,Tn),se=Je.get(je,Pe.length),se.init(),Pe.push(se),eR(je,Mt,0,Te.sortObjects),se.finish(),Te.sortObjects===!0&&se.sort(Zt,An),this.info.render.frame++,Xt===!0&&Nt.beginShadows();let Ut=K.state.shadowsArray;if(ln.render(Ut,je,Mt),Xt===!0&&Nt.endShadows(),this.info.autoReset===!0&&this.info.reset(),hn.render(se,je),K.setupLights(Te._useLegacyLights),Mt.isArrayCamera)if(ht.enabled&&ht.isMultiview)mi.setDeferTextureUploads(!0),a1(se,je,Mt,Mt.cameras[0].viewport);else{let Ht=Mt.cameras;for(let zt=0,Xn=Ht.length;zt<Xn;zt++){let hi=Ht[zt];a1(se,je,hi,hi.viewport)}}else a1(se,je,Mt);lt!==null&&(mi.updateMultisampleRenderTarget(lt),mi.updateRenderTargetMipmap(lt)),je.isScene===!0&&je.onAfterRender(Te,je,Mt),mi.runDeferredUploads(),ht.enabled&&ht.submitFrame&&ht.submitFrame(),pr.resetDefaultState(),Ve=-1,Ke=null,ve.pop(),ve.length>0?K=ve[ve.length-1]:K=null,Pe.pop(),Pe.length>0?se=Pe[Pe.length-1]:se=null};function eR(je,Mt,Ut,Ht){if(je.visible===!1)return;if(je.layers.test(Mt.layers)){if(je.isGroup)Ut=je.renderOrder;else if(je.isLOD)je.autoUpdate===!0&&je.update(Mt);else if(je.isLight)K.pushLight(je),je.castShadow&&K.pushShadow(je);else if(je.isSprite){if(!je.frustumCulled||Ni.intersectsSprite(je)){Ht&&ii.setFromMatrixPosition(je.matrixWorld).applyMatrix4(bi);let hi=Tr.update(je),wi=je.material;wi.visible&&se.push(je,hi,wi,Ut,ii.z,null)}}else if((je.isMesh||je.isLine||je.isPoints)&&(!je.frustumCulled||Ni.intersectsObject(je))){let hi=Tr.update(je),wi=je.material;if(Ht&&(je.boundingSphere!==void 0?(je.boundingSphere===null&&je.computeBoundingSphere(),ii.copy(je.boundingSphere.center)):(hi.boundingSphere===null&&hi.computeBoundingSphere(),ii.copy(hi.boundingSphere.center)),ii.applyMatrix4(je.matrixWorld).applyMatrix4(bi)),Array.isArray(wi)){let Li=hi.groups;for(let tr=0,Vi=Li.length;tr<Vi;tr++){let Qi=Li[tr],ds=wi[Qi.materialIndex];ds&&ds.visible&&se.push(je,hi,ds,Ut,ii.z,Qi)}}else wi.visible&&se.push(je,hi,wi,Ut,ii.z,null)}}let Xn=je.children;for(let hi=0,wi=Xn.length;hi<wi;hi++)eR(Xn[hi],Mt,Ut,Ht)}function a1(je,Mt,Ut,Ht){let zt=je.opaque,Xn=je.transmissive,hi=je.transparent;K.setupLightsView(Ut),Xt===!0&&Nt.setGlobalState(Te.clippingPlanes,Ut),Xn.length>0&&p7(zt,Xn,Mt,Ut),Ht&&Vn.viewport(ct.copy(Ht)),zt.length>0&&wA(zt,Mt,Ut),Xn.length>0&&wA(Xn,Mt,Ut),hi.length>0&&wA(hi,Mt,Ut),Vn.buffers.depth.setTest(!0),Vn.buffers.depth.setMask(!0),Vn.buffers.color.setMask(!0),Vn.setPolygonOffset(!1)}function p7(je,Mt,Ut,Ht){if((Ut.isScene===!0?Ut.overrideMaterial:null)!==null)return;let Xn=an.isWebGL2;Mn===null&&(Mn=new No(1,1,{generateMipmaps:!0,type:Dn.has("EXT_color_buffer_half_float")?xi:xt,minFilter:Cn,samples:Xn?4:0})),Te.getDrawingBufferSize(ei),Xn?Mn.setSize(ei.x,ei.y):Mn.setSize(td(ei.x),td(ei.y));let hi=Te.getRenderTarget();Te.setRenderTarget(Mn),Te.getClearColor(dt),wt=Te.getClearAlpha(),wt<1&&Te.setClearColor(16777215,.5),Te.clear();let wi=Te.toneMapping;Te.toneMapping=De,wA(je,Ut,Ht),mi.updateMultisampleRenderTarget(Mn),mi.updateRenderTargetMipmap(Mn);let Li=!1;for(let tr=0,Vi=Mt.length;tr<Vi;tr++){let Qi=Mt[tr],ds=Qi.object,Jo=Qi.geometry,Vs=Qi.material,Vl=Qi.group;if(Vs.side===T&&ds.layers.test(Ht.layers)){let rs=Vs.side;Vs.side=M,Vs.needsUpdate=!0,tR(ds,Ut,Ht,Jo,Vs,Vl),Vs.side=rs,Vs.needsUpdate=!0,Li=!0}}Li===!0&&(mi.updateMultisampleRenderTarget(Mn),mi.updateRenderTargetMipmap(Mn)),Te.setRenderTarget(hi),Te.setClearColor(dt,wt),Te.toneMapping=wi}function wA(je,Mt,Ut){let Ht=Mt.isScene===!0?Mt.overrideMaterial:null;for(let zt=0,Xn=je.length;zt<Xn;zt++){let hi=je[zt],wi=hi.object,Li=hi.geometry,tr=Ht===null?hi.material:Ht,Vi=hi.group;wi.layers.test(Ut.layers)&&tR(wi,Mt,Ut,Li,tr,Vi)}}function tR(je,Mt,Ut,Ht,zt,Xn){je.onBeforeRender(Te,Mt,Ut,Ht,zt,Xn),je.modelViewMatrix.multiplyMatrices(Ut.matrixWorldInverse,je.matrixWorld),je.normalMatrix.getNormalMatrix(je.modelViewMatrix),zt.onBeforeRender(Te,Mt,Ut,Ht,je,Xn),zt.transparent===!0&&zt.side===T&&zt.forceSinglePass===!1?(zt.side=M,zt.needsUpdate=!0,Te.renderBufferDirect(Ut,Mt,Ht,zt,je,Xn),zt.side=w,zt.needsUpdate=!0,Te.renderBufferDirect(Ut,Mt,Ht,zt,je,Xn),zt.side=T):Te.renderBufferDirect(Ut,Mt,Ht,zt,je,Xn),je.onAfterRender(Te,Mt,Ut,Ht,zt,Xn)}function CA(je,Mt,Ut){Mt.isScene!==!0&&(Mt=vi);let Ht=ti.get(je),zt=K.state.lights,Xn=K.state.shadowsArray,hi=zt.state.version,wi=hs.getParameters(je,zt.state,Xn,Mt,Ut),Li=hs.getProgramCacheKey(wi),tr=Ht.programs;Ht.environment=je.isMeshStandardMaterial?Mt.environment:null,Ht.fog=Mt.fog,Ht.envMap=(je.isMeshStandardMaterial?$r:hr).get(je.envMap||Ht.environment),tr===void 0&&(je.addEventListener("dispose",Fn),tr=new Map,Ht.programs=tr);let Vi=tr.get(Li);if(Vi!==void 0){if(Ht.currentProgram===Vi&&Ht.lightsStateVersion===hi)return iR(je,wi),Vi}else wi.uniforms=hs.getUniforms(je),je.onBuild(Ut,wi,Te),je.onBeforeCompile(wi,Te),Vi=hs.acquireProgram(wi,Li),tr.set(Li,Vi),Ht.uniforms=wi.uniforms;let Qi=Ht.uniforms;return(!je.isShaderMaterial&&!je.isRawShaderMaterial||je.clipping===!0)&&(Qi.clippingPlanes=Nt.uniform),iR(je,wi),Ht.needsLights=A7(je),Ht.lightsStateVersion=hi,Ht.needsLights&&(Qi.ambientLightColor.value=zt.state.ambient,Qi.lightProbe.value=zt.state.probe,Qi.directionalLights.value=zt.state.directional,Qi.directionalLightShadows.value=zt.state.directionalShadow,Qi.spotLights.value=zt.state.spot,Qi.spotLightShadows.value=zt.state.spotShadow,Qi.rectAreaLights.value=zt.state.rectArea,Qi.ltc_1.value=zt.state.rectAreaLTC1,Qi.ltc_2.value=zt.state.rectAreaLTC2,Qi.pointLights.value=zt.state.point,Qi.pointLightShadows.value=zt.state.pointShadow,Qi.hemisphereLights.value=zt.state.hemi,Qi.directionalShadowMap.value=zt.state.directionalShadowMap,Qi.directionalShadowMatrix.value=zt.state.directionalShadowMatrix,Qi.spotShadowMap.value=zt.state.spotShadowMap,Qi.spotLightMatrix.value=zt.state.spotLightMatrix,Qi.spotLightMap.value=zt.state.spotLightMap,Qi.pointShadowMap.value=zt.state.pointShadowMap,Qi.pointShadowMatrix.value=zt.state.pointShadowMatrix),Ht.currentProgram=Vi,Ht.uniformsList=null,Vi}function nR(je){if(je.uniformsList===null){let Mt=je.currentProgram.getUniforms();je.uniformsList=O0.seqWithValue(Mt.seq,je.uniforms)}return je.uniformsList}function iR(je,Mt){let Ut=ti.get(je);Ut.outputColorSpace=Mt.outputColorSpace,Ut.instancing=Mt.instancing,Ut.instancingColor=Mt.instancingColor,Ut.skinning=Mt.skinning,Ut.morphTargets=Mt.morphTargets,Ut.morphNormals=Mt.morphNormals,Ut.morphColors=Mt.morphColors,Ut.morphTargetsCount=Mt.morphTargetsCount,Ut.numClippingPlanes=Mt.numClippingPlanes,Ut.numIntersection=Mt.numClipIntersection,Ut.vertexAlphas=Mt.vertexAlphas,Ut.vertexTangents=Mt.vertexTangents,Ut.toneMapping=Mt.toneMapping,Ut.numMultiviewViews=Mt.numMultiviewViews}function m7(je,Mt,Ut,Ht,zt){Mt.isScene!==!0&&(Mt=vi),mi.resetTextureUnits();let Xn=Mt.fog,hi=Ht.isMeshStandardMaterial?Mt.environment:null,wi=lt===null?Te.outputColorSpace:lt.isXRRenderTarget===!0?lt.texture.colorSpace:Sr,Li=(Ht.isMeshStandardMaterial?$r:hr).get(Ht.envMap||hi),tr=Ht.vertexColors===!0&&!!Ut.attributes.color&&Ut.attributes.color.itemSize===4,Vi=!!Ut.attributes.tangent&&(!!Ht.normalMap||Ht.anisotropy>0),Qi=!!Ut.morphAttributes.position,ds=!!Ut.morphAttributes.normal,Jo=!!Ut.morphAttributes.color,Vs=De;Ht.toneMapped&&(lt===null||lt.isXRRenderTarget===!0)&&(Vs=Te.toneMapping);let Vl=lt&&lt.isWebGLMultiviewRenderTarget?lt.numViews:0,rs=Ut.morphAttributes.position||Ut.morphAttributes.normal||Ut.morphAttributes.color,sh=rs!==void 0?rs.length:0,wr=ti.get(Ht),v7=K.state.lights;if(Xt===!0&&(Tn===!0||je!==Ke)){let Zo=je===Ke&&Ht.id===Ve;Nt.setState(Ht,je,Zo)}let fs=!1;Ht.version===wr.__version?(wr.needsLights&&wr.lightsStateVersion!==v7.state.version||wr.outputColorSpace!==wi||zt.isInstancedMesh&&wr.instancing===!1||!zt.isInstancedMesh&&wr.instancing===!0||zt.isSkinnedMesh&&wr.skinning===!1||!zt.isSkinnedMesh&&wr.skinning===!0||zt.isInstancedMesh&&wr.instancingColor===!0&&zt.instanceColor===null||zt.isInstancedMesh&&wr.instancingColor===!1&&zt.instanceColor!==null||wr.envMap!==Li||Ht.fog===!0&&wr.fog!==Xn||wr.numClippingPlanes!==void 0&&(wr.numClippingPlanes!==Nt.numPlanes||wr.numIntersection!==Nt.numIntersection)||wr.vertexAlphas!==tr||wr.vertexTangents!==Vi||wr.morphTargets!==Qi||wr.morphNormals!==ds||wr.morphColors!==Jo||wr.toneMapping!==Vs||an.isWebGL2===!0&&wr.morphTargetsCount!==sh||wr.numMultiviewViews!==Vl)&&(fs=!0):(fs=!0,wr.__version=Ht.version);let Hc=wr.currentProgram;fs===!0&&(Hc=CA(Ht,Mt,zt));let rR=!1,pm=!1,c1=!1,Hs=Hc.getUniforms(),oh=wr.uniforms;if(Vn.useProgram(Hc.program)&&(rR=!0,pm=!0,c1=!0),Ht.id!==Ve&&(Ve=Ht.id,pm=!0),rR||Ke!==je){Hc.numMultiviewViews>0?(fn.updateCameraProjectionMatricesUniform(je,Hs),fn.updateCameraViewMatricesUniform(je,Hs)):(Hs.setValue(ft,"projectionMatrix",je.projectionMatrix),Hs.setValue(ft,"viewMatrix",je.matrixWorldInverse));let Zo=Hs.map.cameraPosition;Zo!==void 0&&Zo.setValue(ft,ii.setFromMatrixPosition(je.matrixWorld)),an.logarithmicDepthBuffer&&Hs.setValue(ft,"logDepthBufFC",2/(Math.log(je.far+1)/Math.LN2)),(Ht.isMeshPhongMaterial||Ht.isMeshToonMaterial||Ht.isMeshLambertMaterial||Ht.isMeshBasicMaterial||Ht.isMeshStandardMaterial||Ht.isShaderMaterial)&&Hs.setValue(ft,"isOrthographic",je.isOrthographicCamera===!0),Ke!==je&&(Ke=je,pm=!0,c1=!0)}if(zt.isSkinnedMesh){Hs.setOptional(ft,zt,"bindMatrix"),Hs.setOptional(ft,zt,"bindMatrixInverse");let Zo=zt.skeleton;Zo&&(an.floatVertexTextures?(Zo.boneTexture===null&&Zo.computeBoneTexture(),Hs.setValue(ft,"boneTexture",Zo.boneTexture,mi),Hs.setValue(ft,"boneTextureSize",Zo.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let l1=Ut.morphAttributes;if((l1.position!==void 0||l1.normal!==void 0||l1.color!==void 0&&an.isWebGL2===!0)&&li.update(zt,Ut,Hc),(pm||wr.receiveShadow!==zt.receiveShadow)&&(wr.receiveShadow=zt.receiveShadow,Hs.setValue(ft,"receiveShadow",zt.receiveShadow)),Ht.isMeshGouraudMaterial&&Ht.envMap!==null&&(oh.envMap.value=Li,oh.flipEnvMap.value=Li.isCubeTexture&&Li.isRenderTargetTexture===!1?-1:1),pm&&(Hs.setValue(ft,"toneMappingExposure",Te.toneMappingExposure),wr.needsLights&&g7(oh,c1),Xn&&Ht.fog===!0&&Ho.refreshFogUniforms(oh,Xn),Ho.refreshMaterialUniforms(oh,Ht,un,$t,Mn),O0.upload(ft,nR(wr),oh,mi)),Ht.isShaderMaterial&&Ht.uniformsNeedUpdate===!0&&(O0.upload(ft,nR(wr),oh,mi),Ht.uniformsNeedUpdate=!1),Ht.isSpriteMaterial&&Hs.setValue(ft,"center",zt.center),Hc.numMultiviewViews>0?fn.updateObjectMatricesUniforms(zt,je,Hs):(Hs.setValue(ft,"modelViewMatrix",zt.modelViewMatrix),Hs.setValue(ft,"normalMatrix",zt.normalMatrix)),Hs.setValue(ft,"modelMatrix",zt.matrixWorld),Ht.isShaderMaterial||Ht.isRawShaderMaterial){let Zo=Ht.uniformsGroups;for(let u1=0,y7=Zo.length;u1<y7;u1++)if(an.isWebGL2){let sR=Zo[u1];wn.update(sR,Hc),wn.bind(sR,Hc)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Hc}function g7(je,Mt){je.ambientLightColor.needsUpdate=Mt,je.lightProbe.needsUpdate=Mt,je.directionalLights.needsUpdate=Mt,je.directionalLightShadows.needsUpdate=Mt,je.pointLights.needsUpdate=Mt,je.pointLightShadows.needsUpdate=Mt,je.spotLights.needsUpdate=Mt,je.spotLightShadows.needsUpdate=Mt,je.rectAreaLights.needsUpdate=Mt,je.hemisphereLights.needsUpdate=Mt}function A7(je){return je.isMeshLambertMaterial||je.isMeshToonMaterial||je.isMeshPhongMaterial||je.isMeshStandardMaterial||je.isShadowMaterial||je.isShaderMaterial&&je.lights===!0}this.setTexture2D=function(){var je=!1;return function(Ut,Ht){Ut&&Ut.isWebGLRenderTarget&&(je||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),je=!0),Ut=Ut.texture),mi.setTexture2D(Ut,Ht)}}(),this.getActiveCubeFace=function(){return qe},this.getActiveMipmapLevel=function(){return st},this.getRenderTarget=function(){return lt},this.setRenderTargetTextures=function(je,Mt,Ut){ti.get(je.texture).__webglTexture=Mt,ti.get(je.depthTexture).__webglTexture=Ut;let Ht=ti.get(je);Ht.__hasExternalTextures=!0,Ht.__autoAllocateDepthBuffer=Ut===void 0,!Ht.__autoAllocateDepthBuffer&&!lt.isWebGLMultiviewRenderTarget&&Dn.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ht.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(je,Mt){let Ut=ti.get(je);Ut.__webglFramebuffer=Mt,Ut.__useDefaultFramebuffer=Mt===void 0},this.setRenderTarget=function(je,Mt=0,Ut=0){lt=je,qe=Mt,st=Ut;let Ht=!0,zt=null,Xn=!1,hi=!1;if(je){let Li=ti.get(je);Li.__useDefaultFramebuffer!==void 0?(Vn.bindFramebuffer(ft.FRAMEBUFFER,null),Ht=!1):Li.__webglFramebuffer===void 0?mi.setupRenderTarget(je):Li.__hasExternalTextures&&mi.rebindTextures(je,ti.get(je.texture).__webglTexture,ti.get(je.depthTexture).__webglTexture);let tr=je.texture;(tr.isData3DTexture||tr.isDataArrayTexture||tr.isCompressedArrayTexture)&&(hi=!0);let Vi=ti.get(je).__webglFramebuffer;je.isWebGLCubeRenderTarget?(Array.isArray(Vi[Mt])?zt=Vi[Mt][Ut]:zt=Vi[Mt],Xn=!0):an.isWebGL2&&je.samples>0&&mi.useMultisampledRTT(je)===!1?zt=ti.get(je).__webglMultisampledFramebuffer:Array.isArray(Vi)?zt=Vi[Ut]:zt=Vi,ct.copy(je.viewport),Dt.copy(je.scissor),Qt=je.scissorTest}else ct.copy(gn).multiplyScalar(un).floor(),Dt.copy(Qn).multiplyScalar(un).floor(),Qt=ji;if(Vn.bindFramebuffer(ft.FRAMEBUFFER,zt)&&an.drawBuffers&&Ht&&Vn.drawBuffers(je,zt),Vn.viewport(ct),Vn.scissor(Dt),Vn.setScissorTest(Qt),Xn){let Li=ti.get(je.texture);ft.framebufferTexture2D(ft.FRAMEBUFFER,ft.COLOR_ATTACHMENT0,ft.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,Li.__webglTexture,Ut)}else if(hi){let Li=ti.get(je.texture),tr=Mt||0;ft.framebufferTextureLayer(ft.FRAMEBUFFER,ft.COLOR_ATTACHMENT0,Li.__webglTexture,Ut||0,tr)}Ve=-1},this.readRenderTargetPixels=function(je,Mt,Ut,Ht,zt,Xn,hi){if(!(je&&je.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let wi=ti.get(je).__webglFramebuffer;if(je.isWebGLCubeRenderTarget&&hi!==void 0&&(wi=wi[hi]),wi){Vn.bindFramebuffer(ft.FRAMEBUFFER,wi);try{let Li=je.texture,tr=Li.format,Vi=Li.type;if(tr!==Mi&&gi.convert(tr)!==ft.getParameter(ft.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Qi=Vi===xi&&(Dn.has("EXT_color_buffer_half_float")||an.isWebGL2&&Dn.has("EXT_color_buffer_float"));if(Vi!==xt&&gi.convert(Vi)!==ft.getParameter(ft.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Vi===fi&&(an.isWebGL2||Dn.has("OES_texture_float")||Dn.has("WEBGL_color_buffer_float")))&&!Qi){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Mt>=0&&Mt<=je.width-Ht&&Ut>=0&&Ut<=je.height-zt&&ft.readPixels(Mt,Ut,Ht,zt,gi.convert(tr),gi.convert(Vi),Xn)}finally{let Li=lt!==null?ti.get(lt).__webglFramebuffer:null;Vn.bindFramebuffer(ft.FRAMEBUFFER,Li)}}},this.copyFramebufferToTexture=function(je,Mt,Ut=0){let Ht=Math.pow(2,-Ut),zt=Math.floor(Mt.image.width*Ht),Xn=Math.floor(Mt.image.height*Ht);mi.setTexture2D(Mt,0),ft.copyTexSubImage2D(ft.TEXTURE_2D,Ut,0,0,je.x,je.y,zt,Xn),Vn.unbindTexture()},this.copyTextureToTexture=function(je,Mt,Ut,Ht=0){let zt=Mt.image.width,Xn=Mt.image.height,hi=gi.convert(Ut.format),wi=gi.convert(Ut.type);mi.setTexture2D(Ut,0),ft.pixelStorei(ft.UNPACK_FLIP_Y_WEBGL,Ut.flipY),ft.pixelStorei(ft.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ut.premultiplyAlpha),ft.pixelStorei(ft.UNPACK_ALIGNMENT,Ut.unpackAlignment),Mt.isDataTexture?ft.texSubImage2D(ft.TEXTURE_2D,Ht,je.x,je.y,zt,Xn,hi,wi,Mt.image.data):Mt.isCompressedTexture?ft.compressedTexSubImage2D(ft.TEXTURE_2D,Ht,je.x,je.y,Mt.mipmaps[0].width,Mt.mipmaps[0].height,hi,Mt.mipmaps[0].data):ft.texSubImage2D(ft.TEXTURE_2D,Ht,je.x,je.y,hi,wi,Mt.image),Ht===0&&Ut.generateMipmaps&&ft.generateMipmap(ft.TEXTURE_2D),Vn.unbindTexture()},this.copyTextureToTexture3D=function(je,Mt,Ut,Ht,zt=0){if(Te.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Xn=je.max.x-je.min.x+1,hi=je.max.y-je.min.y+1,wi=je.max.z-je.min.z+1,Li=gi.convert(Ht.format),tr=gi.convert(Ht.type),Vi;if(Ht.isData3DTexture)mi.setTexture3D(Ht,0),Vi=ft.TEXTURE_3D;else if(Ht.isDataArrayTexture)mi.setTexture2DArray(Ht,0),Vi=ft.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ft.pixelStorei(ft.UNPACK_FLIP_Y_WEBGL,Ht.flipY),ft.pixelStorei(ft.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ht.premultiplyAlpha),ft.pixelStorei(ft.UNPACK_ALIGNMENT,Ht.unpackAlignment);let Qi=ft.getParameter(ft.UNPACK_ROW_LENGTH),ds=ft.getParameter(ft.UNPACK_IMAGE_HEIGHT),Jo=ft.getParameter(ft.UNPACK_SKIP_PIXELS),Vs=ft.getParameter(ft.UNPACK_SKIP_ROWS),Vl=ft.getParameter(ft.UNPACK_SKIP_IMAGES),rs=Ut.isCompressedTexture?Ut.mipmaps[0]:Ut.image;ft.pixelStorei(ft.UNPACK_ROW_LENGTH,rs.width),ft.pixelStorei(ft.UNPACK_IMAGE_HEIGHT,rs.height),ft.pixelStorei(ft.UNPACK_SKIP_PIXELS,je.min.x),ft.pixelStorei(ft.UNPACK_SKIP_ROWS,je.min.y),ft.pixelStorei(ft.UNPACK_SKIP_IMAGES,je.min.z),Ut.isDataTexture||Ut.isData3DTexture?ft.texSubImage3D(Vi,zt,Mt.x,Mt.y,Mt.z,Xn,hi,wi,Li,tr,rs.data):Ut.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ft.compressedTexSubImage3D(Vi,zt,Mt.x,Mt.y,Mt.z,Xn,hi,wi,Li,rs.data)):ft.texSubImage3D(Vi,zt,Mt.x,Mt.y,Mt.z,Xn,hi,wi,Li,tr,rs),ft.pixelStorei(ft.UNPACK_ROW_LENGTH,Qi),ft.pixelStorei(ft.UNPACK_IMAGE_HEIGHT,ds),ft.pixelStorei(ft.UNPACK_SKIP_PIXELS,Jo),ft.pixelStorei(ft.UNPACK_SKIP_ROWS,Vs),ft.pixelStorei(ft.UNPACK_SKIP_IMAGES,Vl),zt===0&&Ht.generateMipmaps&&ft.generateMipmap(Vi),Vn.unbindTexture()},this.initTexture=function(je){je.isCubeTexture?mi.setTextureCube(je,0):je.isData3DTexture?mi.setTexture3D(je,0):je.isDataArrayTexture||je.isCompressedArrayTexture?mi.setTexture2DArray(je,0):mi.setTexture2D(je,0),Vn.unbindTexture()},this.resetState=function(){qe=0,st=0,lt=null,Vn.reset(),pr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return pa}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(r){this._outputColorSpace=r;let a=this.getContext();a.drawingBufferColorSpace=r===Zh?"display-p3":"srgb",a.unpackColorSpace=Ir.workingColorSpace===Du?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(r){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!r}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Gr?ai:Qr}set outputEncoding(r){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=r===ai?Gr:Sr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(r){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=r}}class gT extends mT{}gT.prototype.isWebGL1Renderer=!0;class N0{constructor(r,a=25e-5){this.isFogExp2=!0,this.name="",this.color=new jn(r),this.density=a}clone(){return new N0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class F0{constructor(r,a=1,d=1e3){this.isFog=!0,this.name="",this.color=new jn(r),this.near=a,this.far=d}clone(){return new F0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class AT extends Kr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(r,a){return super.copy(r,a),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),this.backgroundBlurriness=r.backgroundBlurriness,this.backgroundIntensity=r.backgroundIntensity,r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.matrixAutoUpdate=r.matrixAutoUpdate,this}toJSON(r){let a=super.toJSON(r);return this.fog!==null&&(a.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(a.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(a.object.backgroundIntensity=this.backgroundIntensity),a}}class U0{constructor(r,a){this.isInterleavedBuffer=!0,this.array=r,this.stride=a,this.count=r!==void 0?r.length/a:0,this.usage=Ou,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=_o()}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this}copyAt(r,a,d){r*=this.stride,d*=a.stride;for(let g=0,_=this.stride;g<_;g++)this.array[r+g]=a.array[d+g];return this}set(r,a=0){return this.array.set(r,a),this}clone(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=_o()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let a=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),d=new this.constructor(a,this.stride);return d.setUsage(this.usage),d}onUpload(r){return this.onUploadCallback=r,this}toJSON(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=_o()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}let wo=new Ye;class Qu{constructor(r,a,d,g=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=r,this.itemSize=a,this.offset=d,this.normalized=g}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(r){this.data.needsUpdate=r}applyMatrix4(r){for(let a=0,d=this.data.count;a<d;a++)wo.fromBufferAttribute(this,a),wo.applyMatrix4(r),this.setXYZ(a,wo.x,wo.y,wo.z);return this}applyNormalMatrix(r){for(let a=0,d=this.count;a<d;a++)wo.fromBufferAttribute(this,a),wo.applyNormalMatrix(r),this.setXYZ(a,wo.x,wo.y,wo.z);return this}transformDirection(r){for(let a=0,d=this.count;a<d;a++)wo.fromBufferAttribute(this,a),wo.transformDirection(r),this.setXYZ(a,wo.x,wo.y,wo.z);return this}setX(r,a){return this.normalized&&(a=Bi(a,this.array)),this.data.array[r*this.data.stride+this.offset]=a,this}setY(r,a){return this.normalized&&(a=Bi(a,this.array)),this.data.array[r*this.data.stride+this.offset+1]=a,this}setZ(r,a){return this.normalized&&(a=Bi(a,this.array)),this.data.array[r*this.data.stride+this.offset+2]=a,this}setW(r,a){return this.normalized&&(a=Bi(a,this.array)),this.data.array[r*this.data.stride+this.offset+3]=a,this}getX(r){let a=this.data.array[r*this.data.stride+this.offset];return this.normalized&&(a=ao(a,this.array)),a}getY(r){let a=this.data.array[r*this.data.stride+this.offset+1];return this.normalized&&(a=ao(a,this.array)),a}getZ(r){let a=this.data.array[r*this.data.stride+this.offset+2];return this.normalized&&(a=ao(a,this.array)),a}getW(r){let a=this.data.array[r*this.data.stride+this.offset+3];return this.normalized&&(a=ao(a,this.array)),a}setXY(r,a,d){return r=r*this.data.stride+this.offset,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=d,this}setXYZ(r,a,d,g){return r=r*this.data.stride+this.offset,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=d,this.data.array[r+2]=g,this}setXYZW(r,a,d,g,_){return r=r*this.data.stride+this.offset,this.normalized&&(a=Bi(a,this.array),d=Bi(d,this.array),g=Bi(g,this.array),_=Bi(_,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=d,this.data.array[r+2]=g,this.data.array[r+3]=_,this}clone(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let d=0;d<this.count;d++){let g=d*this.data.stride+this.offset;for(let _=0;_<this.itemSize;_++)a.push(this.data.array[g+_])}return new Wr(new this.array.constructor(a),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new Qu(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let d=0;d<this.count;d++){let g=d*this.data.stride+this.offset;for(let _=0;_<this.itemSize;_++)a.push(this.data.array[g+_])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class M_ extends ho{constructor(r){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new jn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this.fog=r.fog,this}}let _d,qp=new Ye,bd=new Ye,Md=new Ye,wd=new nn,Yp=new nn,vT=new _i,k0=new Ye,Kp=new Ye,V0=new Ye,yT=new nn,w_=new nn,xT=new nn;class ET extends Kr{constructor(r=new M_){if(super(),this.isSprite=!0,this.type="Sprite",_d===void 0){_d=new Zi;let a=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new U0(a,5);_d.setIndex([0,1,2,0,2,3]),_d.setAttribute("position",new Qu(d,3,0,!1)),_d.setAttribute("uv",new Qu(d,2,3,!1))}this.geometry=_d,this.material=r,this.center=new nn(.5,.5)}raycast(r,a){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),bd.setFromMatrixScale(this.matrixWorld),vT.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),Md.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&bd.multiplyScalar(-Md.z);let d=this.material.rotation,g,_;d!==0&&(_=Math.cos(d),g=Math.sin(d));let C=this.center;H0(k0.set(-.5,-.5,0),Md,C,bd,g,_),H0(Kp.set(.5,-.5,0),Md,C,bd,g,_),H0(V0.set(.5,.5,0),Md,C,bd,g,_),yT.set(0,0),w_.set(1,0),xT.set(1,1);let S=r.ray.intersectTriangle(k0,Kp,V0,!1,qp);if(S===null&&(H0(Kp.set(-.5,.5,0),Md,C,bd,g,_),w_.set(0,1),S=r.ray.intersectTriangle(k0,V0,Kp,!1,qp),S===null))return;let B=r.ray.origin.distanceTo(qp);B<r.near||B>r.far||a.push({distance:B,point:qp.clone(),uv:ko.getInterpolation(qp,k0,Kp,V0,yT,w_,xT,new nn),face:null,object:this})}copy(r,a){return super.copy(r,a),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}}function H0(b,r,a,d,g,_){wd.subVectors(b,a).addScalar(.5).multiply(d),g!==void 0?(Yp.x=_*wd.x-g*wd.y,Yp.y=g*wd.x+_*wd.y):Yp.copy(wd),b.copy(r),b.x+=Yp.x,b.y+=Yp.y,b.applyMatrix4(vT)}let z0=new Ye,_T=new Ye;class bT extends Kr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(r){super.copy(r,!1);let a=r.levels;for(let d=0,g=a.length;d<g;d++){let _=a[d];this.addLevel(_.object.clone(),_.distance,_.hysteresis)}return this.autoUpdate=r.autoUpdate,this}addLevel(r,a=0,d=0){a=Math.abs(a);let g=this.levels,_;for(_=0;_<g.length&&!(a<g[_].distance);_++);return g.splice(_,0,{distance:a,hysteresis:d,object:r}),this.add(r),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(r){let a=this.levels;if(a.length>0){let d,g;for(d=1,g=a.length;d<g;d++){let _=a[d].distance;if(a[d].object.visible&&(_-=_*a[d].hysteresis),r<_)break}return a[d-1].object}return null}raycast(r,a){if(this.levels.length>0){z0.setFromMatrixPosition(this.matrixWorld);let g=r.ray.origin.distanceTo(z0);this.getObjectForDistance(g).raycast(r,a)}}update(r){let a=this.levels;if(a.length>1){z0.setFromMatrixPosition(r.matrixWorld),_T.setFromMatrixPosition(this.matrixWorld);let d=z0.distanceTo(_T)/r.zoom;a[0].object.visible=!0;let g,_;for(g=1,_=a.length;g<_;g++){let C=a[g].distance;if(a[g].object.visible&&(C-=C*a[g].hysteresis),d>=C)a[g-1].object.visible=!1,a[g].object.visible=!0;else break}for(this._currentLevel=g-1;g<_;g++)a[g].object.visible=!1}}toJSON(r){let a=super.toJSON(r);this.autoUpdate===!1&&(a.object.autoUpdate=!1),a.object.levels=[];let d=this.levels;for(let g=0,_=d.length;g<_;g++){let C=d[g];a.object.levels.push({object:C.object.uuid,distance:C.distance,hysteresis:C.hysteresis})}return a}}let MT=new Ye,wT=new Mr,CT=new Mr,S6=new Ye,ST=new _i,G0=new Ye,C_=new Uo,TT=new _i,S_=new lo;class IT extends qs{constructor(r,a){super(r,a),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Le,this.bindMatrix=new _i,this.bindMatrixInverse=new _i,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let r=this.geometry;this.boundingBox===null&&(this.boundingBox=new rr),this.boundingBox.makeEmpty();let a=r.getAttribute("position");for(let d=0;d<a.count;d++)this.getVertexPosition(d,G0),this.boundingBox.expandByPoint(G0)}computeBoundingSphere(){let r=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Uo),this.boundingSphere.makeEmpty();let a=r.getAttribute("position");for(let d=0;d<a.count;d++)this.getVertexPosition(d,G0),this.boundingSphere.expandByPoint(G0)}copy(r,a){return super.copy(r,a),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this}raycast(r,a){let d=this.material,g=this.matrixWorld;d!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),C_.copy(this.boundingSphere),C_.applyMatrix4(g),r.ray.intersectsSphere(C_)!==!1&&(TT.copy(g).invert(),S_.copy(r.ray).applyMatrix4(TT),!(this.boundingBox!==null&&S_.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(r,a,S_)))}getVertexPosition(r,a){return super.getVertexPosition(r,a),this.applyBoneTransform(r,a),a}bind(r,a){this.skeleton=r,a===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.copy(a).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let r=new Mr,a=this.geometry.attributes.skinWeight;for(let d=0,g=a.count;d<g;d++){r.fromBufferAttribute(a,d);let _=1/r.manhattanLength();_!==1/0?r.multiplyScalar(_):r.set(1,0,0,0),a.setXYZW(d,r.x,r.y,r.z,r.w)}}updateMatrixWorld(r){super.updateMatrixWorld(r),this.bindMode===Le?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ee?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(r,a){let d=this.skeleton,g=this.geometry;wT.fromBufferAttribute(g.attributes.skinIndex,r),CT.fromBufferAttribute(g.attributes.skinWeight,r),MT.copy(a).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let _=0;_<4;_++){let C=CT.getComponent(_);if(C!==0){let S=wT.getComponent(_);ST.multiplyMatrices(d.bones[S].matrixWorld,d.boneInverses[S]),a.addScaledVector(S6.copy(MT).applyMatrix4(ST),C)}}return a.applyMatrix4(this.bindMatrixInverse)}boneTransform(r,a){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(r,a)}}class T_ extends Kr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Cd extends Es{constructor(r=null,a=1,d=1,g,_,C,S,B,O=nt,H=nt,W,j){super(null,C,S,B,O,H,g,_,W,j),this.isDataTexture=!0,this.image={data:r,width:a,height:d},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let RT=new _i,T6=new _i;class W0{constructor(r=[],a=[]){this.uuid=_o(),this.bones=r.slice(0),this.boneInverses=a,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){let r=this.bones,a=this.boneInverses;if(this.boneMatrices=new Float32Array(r.length*16),a.length===0)this.calculateInverses();else if(r.length!==a.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,g=this.bones.length;d<g;d++)this.boneInverses.push(new _i)}}calculateInverses(){this.boneInverses.length=0;for(let r=0,a=this.bones.length;r<a;r++){let d=new _i;this.bones[r]&&d.copy(this.bones[r].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let r=0,a=this.bones.length;r<a;r++){let d=this.bones[r];d&&d.matrixWorld.copy(this.boneInverses[r]).invert()}for(let r=0,a=this.bones.length;r<a;r++){let d=this.bones[r];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){let r=this.bones,a=this.boneInverses,d=this.boneMatrices,g=this.boneTexture;for(let _=0,C=r.length;_<C;_++){let S=r[_]?r[_].matrixWorld:T6;RT.multiplyMatrices(S,a[_]),RT.toArray(d,_*16)}g!==null&&(g.needsUpdate=!0)}clone(){return new W0(this.bones,this.boneInverses)}computeBoneTexture(){let r=Math.sqrt(this.bones.length*4);r=o0(r),r=Math.max(r,4);let a=new Float32Array(r*r*4);a.set(this.boneMatrices);let d=new Cd(a,r,r,Mi,fi);return d.needsUpdate=!0,this.boneMatrices=a,this.boneTexture=d,this.boneTextureSize=r,this}getBoneByName(r){for(let a=0,d=this.bones.length;a<d;a++){let g=this.bones[a];if(g.name===r)return g}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(r,a){this.uuid=r.uuid;for(let d=0,g=r.bones.length;d<g;d++){let _=r.bones[d],C=a[_];C===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",_),C=new T_),this.bones.push(C),this.boneInverses.push(new _i().fromArray(r.boneInverses[d]))}return this.init(),this}toJSON(){let r={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};r.uuid=this.uuid;let a=this.bones,d=this.boneInverses;for(let g=0,_=a.length;g<_;g++){let C=a[g];r.bones.push(C.uuid);let S=d[g];r.boneInverses.push(S.toArray())}return r}}class Sd extends Wr{constructor(r,a,d,g=1){super(r,a,d),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=g}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}toJSON(){let r=super.toJSON();return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}}let Td=new _i,DT=new _i,j0=[],LT=new rr,I6=new _i,$p=new qs,Jp=new Uo;class PT extends qs{constructor(r,a,d){super(r,a),this.isInstancedMesh=!0,this.instanceMatrix=new Sd(new Float32Array(d*16),16),this.instanceColor=null,this.count=d,this.boundingBox=null,this.boundingSphere=null;for(let g=0;g<d;g++)this.setMatrixAt(g,I6)}computeBoundingBox(){let r=this.geometry,a=this.count;this.boundingBox===null&&(this.boundingBox=new rr),r.boundingBox===null&&r.computeBoundingBox(),this.boundingBox.makeEmpty();for(let d=0;d<a;d++)this.getMatrixAt(d,Td),LT.copy(r.boundingBox).applyMatrix4(Td),this.boundingBox.union(LT)}computeBoundingSphere(){let r=this.geometry,a=this.count;this.boundingSphere===null&&(this.boundingSphere=new Uo),r.boundingSphere===null&&r.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let d=0;d<a;d++)this.getMatrixAt(d,Td),Jp.copy(r.boundingSphere).applyMatrix4(Td),this.boundingSphere.union(Jp)}copy(r,a){return super.copy(r,a),this.instanceMatrix.copy(r.instanceMatrix),r.instanceColor!==null&&(this.instanceColor=r.instanceColor.clone()),this.count=r.count,r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this}getColorAt(r,a){a.fromArray(this.instanceColor.array,r*3)}getMatrixAt(r,a){a.fromArray(this.instanceMatrix.array,r*16)}raycast(r,a){let d=this.matrixWorld,g=this.count;if($p.geometry=this.geometry,$p.material=this.material,$p.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Jp.copy(this.boundingSphere),Jp.applyMatrix4(d),r.ray.intersectsSphere(Jp)!==!1))for(let _=0;_<g;_++){this.getMatrixAt(_,Td),DT.multiplyMatrices(d,Td),$p.matrixWorld=DT,$p.raycast(r,j0);for(let C=0,S=j0.length;C<S;C++){let B=j0[C];B.instanceId=_,B.object=this,a.push(B)}j0.length=0}}setColorAt(r,a){this.instanceColor===null&&(this.instanceColor=new Sd(new Float32Array(this.instanceMatrix.count*3),3)),a.toArray(this.instanceColor.array,r*3)}setMatrixAt(r,a){a.toArray(this.instanceMatrix.array,r*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Co extends ho{constructor(r){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new jn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.fog=r.fog,this}}let BT=new Ye,OT=new Ye,NT=new _i,I_=new lo,Q0=new Uo;class Nl extends Kr{constructor(r=new Zi,a=new Co){super(),this.isLine=!0,this.type="Line",this.geometry=r,this.material=a,this.updateMorphTargets()}copy(r,a){return super.copy(r,a),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}computeLineDistances(){let r=this.geometry;if(r.index===null){let a=r.attributes.position,d=[0];for(let g=1,_=a.count;g<_;g++)BT.fromBufferAttribute(a,g-1),OT.fromBufferAttribute(a,g),d[g]=d[g-1],d[g]+=BT.distanceTo(OT);r.setAttribute("lineDistance",new ni(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(r,a){let d=this.geometry,g=this.matrixWorld,_=r.params.Line.threshold,C=d.drawRange;if(d.boundingSphere===null&&d.computeBoundingSphere(),Q0.copy(d.boundingSphere),Q0.applyMatrix4(g),Q0.radius+=_,r.ray.intersectsSphere(Q0)===!1)return;NT.copy(g).invert(),I_.copy(r.ray).applyMatrix4(NT);let S=_/((this.scale.x+this.scale.y+this.scale.z)/3),B=S*S,O=new Ye,H=new Ye,W=new Ye,j=new Ye,J=this.isLineSegments?2:1,ie=d.index,se=d.attributes.position;if(ie!==null){let K=Math.max(0,C.start),Pe=Math.min(ie.count,C.start+C.count);for(let ve=K,Te=Pe-1;ve<Te;ve+=J){let We=ie.getX(ve),qe=ie.getX(ve+1);if(O.fromBufferAttribute(se,We),H.fromBufferAttribute(se,qe),I_.distanceSqToSegment(O,H,j,W)>B)continue;j.applyMatrix4(this.matrixWorld);let lt=r.ray.origin.distanceTo(j);lt<r.near||lt>r.far||a.push({distance:lt,point:W.clone().applyMatrix4(this.matrixWorld),index:ve,face:null,faceIndex:null,object:this})}}else{let K=Math.max(0,C.start),Pe=Math.min(se.count,C.start+C.count);for(let ve=K,Te=Pe-1;ve<Te;ve+=J){if(O.fromBufferAttribute(se,ve),H.fromBufferAttribute(se,ve+1),I_.distanceSqToSegment(O,H,j,W)>B)continue;j.applyMatrix4(this.matrixWorld);let qe=r.ray.origin.distanceTo(j);qe<r.near||qe>r.far||a.push({distance:qe,point:W.clone().applyMatrix4(this.matrixWorld),index:ve,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){let g=a[d[0]];if(g!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,C=g.length;_<C;_++){let S=g[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[S]=_}}}}}let FT=new Ye,UT=new Ye;class fc extends Nl{constructor(r,a){super(r,a),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let r=this.geometry;if(r.index===null){let a=r.attributes.position,d=[];for(let g=0,_=a.count;g<_;g+=2)FT.fromBufferAttribute(a,g),UT.fromBufferAttribute(a,g+1),d[g]=g===0?0:d[g-1],d[g+1]=d[g]+FT.distanceTo(UT);r.setAttribute("lineDistance",new ni(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kT extends Nl{constructor(r,a){super(r,a),this.isLineLoop=!0,this.type="LineLoop"}}class R_ extends ho{constructor(r){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new jn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.fog=r.fog,this}}let VT=new _i,D_=new lo,X0=new Uo,q0=new Ye;class HT extends Kr{constructor(r=new Zi,a=new R_){super(),this.isPoints=!0,this.type="Points",this.geometry=r,this.material=a,this.updateMorphTargets()}copy(r,a){return super.copy(r,a),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}raycast(r,a){let d=this.geometry,g=this.matrixWorld,_=r.params.Points.threshold,C=d.drawRange;if(d.boundingSphere===null&&d.computeBoundingSphere(),X0.copy(d.boundingSphere),X0.applyMatrix4(g),X0.radius+=_,r.ray.intersectsSphere(X0)===!1)return;VT.copy(g).invert(),D_.copy(r.ray).applyMatrix4(VT);let S=_/((this.scale.x+this.scale.y+this.scale.z)/3),B=S*S,O=d.index,W=d.attributes.position;if(O!==null){let j=Math.max(0,C.start),J=Math.min(O.count,C.start+C.count);for(let ie=j,fe=J;ie<fe;ie++){let se=O.getX(ie);q0.fromBufferAttribute(W,se),zT(q0,se,B,g,r,a,this)}}else{let j=Math.max(0,C.start),J=Math.min(W.count,C.start+C.count);for(let ie=j,fe=J;ie<fe;ie++)q0.fromBufferAttribute(W,ie),zT(q0,ie,B,g,r,a,this)}}updateMorphTargets(){let a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){let g=a[d[0]];if(g!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,C=g.length;_<C;_++){let S=g[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[S]=_}}}}}function zT(b,r,a,d,g,_,C){let S=D_.distanceSqToPoint(b);if(S<a){let B=new Ye;D_.closestPointToPoint(b,B),B.applyMatrix4(d);let O=g.ray.origin.distanceTo(B);if(O<g.near||O>g.far)return;_.push({distance:O,distanceToRay:Math.sqrt(S),point:B,index:r,face:null,object:C})}}class R6 extends Es{constructor(r,a,d,g,_,C,S,B,O){super(r,a,d,g,_,C,S,B,O),this.isVideoTexture=!0,this.minFilter=C!==void 0?C:_t,this.magFilter=_!==void 0?_:_t,this.generateMipmaps=!1;let H=this;function W(){H.needsUpdate=!0,r.requestVideoFrameCallback(W)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(W)}clone(){return new this.constructor(this.image).copy(this)}update(){let r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class D6 extends Es{constructor(r,a){super({width:r,height:a}),this.isFramebufferTexture=!0,this.magFilter=nt,this.minFilter=nt,this.generateMipmaps=!1,this.needsUpdate=!0}}class Y0 extends Es{constructor(r,a,d,g,_,C,S,B,O,H,W,j){super(null,C,S,B,O,H,g,_,W,j),this.isCompressedTexture=!0,this.image={width:a,height:d},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}}class L6 extends Y0{constructor(r,a,d,g,_,C){super(r,a,d,_,C),this.isCompressedArrayTexture=!0,this.image.depth=g,this.wrapR=Qe}}class P6 extends Y0{constructor(r,a,d){super(void 0,r[0].width,r[0].height,a,d,Ge),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=r}}class B6 extends Es{constructor(r,a,d,g,_,C,S,B,O){super(r,a,d,g,_,C,S,B,O),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ga{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(r,a){let d=this.getUtoTmapping(r);return this.getPoint(d,a)}getPoints(r=5){let a=[];for(let d=0;d<=r;d++)a.push(this.getPoint(d/r));return a}getSpacedPoints(r=5){let a=[];for(let d=0;d<=r;d++)a.push(this.getPointAt(d/r));return a}getLength(){let r=this.getLengths();return r[r.length-1]}getLengths(r=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let a=[],d,g=this.getPoint(0),_=0;a.push(0);for(let C=1;C<=r;C++)d=this.getPoint(C/r),_+=d.distanceTo(g),a.push(_),g=d;return this.cacheArcLengths=a,a}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(r,a){let d=this.getLengths(),g=0,_=d.length,C;a?C=a:C=r*d[_-1];let S=0,B=_-1,O;for(;S<=B;)if(g=Math.floor(S+(B-S)/2),O=d[g]-C,O<0)S=g+1;else if(O>0)B=g-1;else{B=g;break}if(g=B,d[g]===C)return g/(_-1);let H=d[g],j=d[g+1]-H,J=(C-H)/j;return(g+J)/(_-1)}getTangent(r,a){let g=r-1e-4,_=r+1e-4;g<0&&(g=0),_>1&&(_=1);let C=this.getPoint(g),S=this.getPoint(_),B=a||(C.isVector2?new nn:new Ye);return B.copy(S).sub(C).normalize(),B}getTangentAt(r,a){let d=this.getUtoTmapping(r);return this.getTangent(d,a)}computeFrenetFrames(r,a){let d=new Ye,g=[],_=[],C=[],S=new Ye,B=new _i;for(let J=0;J<=r;J++){let ie=J/r;g[J]=this.getTangentAt(ie,new Ye)}_[0]=new Ye,C[0]=new Ye;let O=Number.MAX_VALUE,H=Math.abs(g[0].x),W=Math.abs(g[0].y),j=Math.abs(g[0].z);H<=O&&(O=H,d.set(1,0,0)),W<=O&&(O=W,d.set(0,1,0)),j<=O&&d.set(0,0,1),S.crossVectors(g[0],d).normalize(),_[0].crossVectors(g[0],S),C[0].crossVectors(g[0],_[0]);for(let J=1;J<=r;J++){if(_[J]=_[J-1].clone(),C[J]=C[J-1].clone(),S.crossVectors(g[J-1],g[J]),S.length()>Number.EPSILON){S.normalize();let ie=Math.acos(es(g[J-1].dot(g[J]),-1,1));_[J].applyMatrix4(B.makeRotationAxis(S,ie))}C[J].crossVectors(g[J],_[J])}if(a===!0){let J=Math.acos(es(_[0].dot(_[r]),-1,1));J/=r,g[0].dot(S.crossVectors(_[0],_[r]))>0&&(J=-J);for(let ie=1;ie<=r;ie++)_[ie].applyMatrix4(B.makeRotationAxis(g[ie],J*ie)),C[ie].crossVectors(g[ie],_[ie])}return{tangents:g,normals:_,binormals:C}}clone(){return new this.constructor().copy(this)}copy(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}toJSON(){let r={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r}fromJSON(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}}class K0 extends Ga{constructor(r=0,a=0,d=1,g=1,_=0,C=Math.PI*2,S=!1,B=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=r,this.aY=a,this.xRadius=d,this.yRadius=g,this.aStartAngle=_,this.aEndAngle=C,this.aClockwise=S,this.aRotation=B}getPoint(r,a){let d=a||new nn,g=Math.PI*2,_=this.aEndAngle-this.aStartAngle,C=Math.abs(_)<Number.EPSILON;for(;_<0;)_+=g;for(;_>g;)_-=g;_<Number.EPSILON&&(C?_=0:_=g),this.aClockwise===!0&&!C&&(_===g?_=-g:_=_-g);let S=this.aStartAngle+r*_,B=this.aX+this.xRadius*Math.cos(S),O=this.aY+this.yRadius*Math.sin(S);if(this.aRotation!==0){let H=Math.cos(this.aRotation),W=Math.sin(this.aRotation),j=B-this.aX,J=O-this.aY;B=j*H-J*W+this.aX,O=j*W+J*H+this.aY}return d.set(B,O)}copy(r){return super.copy(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}toJSON(){let r=super.toJSON();return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r}fromJSON(r){return super.fromJSON(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}}class GT extends K0{constructor(r,a,d,g,_,C){super(r,a,d,d,g,_,C),this.isArcCurve=!0,this.type="ArcCurve"}}function L_(){let b=0,r=0,a=0,d=0;function g(_,C,S,B){b=_,r=S,a=-3*_+3*C-2*S-B,d=2*_-2*C+S+B}return{initCatmullRom:function(_,C,S,B,O){g(C,S,O*(S-_),O*(B-C))},initNonuniformCatmullRom:function(_,C,S,B,O,H,W){let j=(C-_)/O-(S-_)/(O+H)+(S-C)/H,J=(S-C)/H-(B-C)/(H+W)+(B-S)/W;j*=H,J*=H,g(C,S,j,J)},calc:function(_){let C=_*_,S=C*_;return b+r*_+a*C+d*S}}}let $0=new Ye,P_=new L_,B_=new L_,O_=new L_;class WT extends Ga{constructor(r=[],a=!1,d="centripetal",g=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=r,this.closed=a,this.curveType=d,this.tension=g}getPoint(r,a=new Ye){let d=a,g=this.points,_=g.length,C=(_-(this.closed?0:1))*r,S=Math.floor(C),B=C-S;this.closed?S+=S>0?0:(Math.floor(Math.abs(S)/_)+1)*_:B===0&&S===_-1&&(S=_-2,B=1);let O,H;this.closed||S>0?O=g[(S-1)%_]:($0.subVectors(g[0],g[1]).add(g[0]),O=$0);let W=g[S%_],j=g[(S+1)%_];if(this.closed||S+2<_?H=g[(S+2)%_]:($0.subVectors(g[_-1],g[_-2]).add(g[_-1]),H=$0),this.curveType==="centripetal"||this.curveType==="chordal"){let J=this.curveType==="chordal"?.5:.25,ie=Math.pow(O.distanceToSquared(W),J),fe=Math.pow(W.distanceToSquared(j),J),se=Math.pow(j.distanceToSquared(H),J);fe<1e-4&&(fe=1),ie<1e-4&&(ie=fe),se<1e-4&&(se=fe),P_.initNonuniformCatmullRom(O.x,W.x,j.x,H.x,ie,fe,se),B_.initNonuniformCatmullRom(O.y,W.y,j.y,H.y,ie,fe,se),O_.initNonuniformCatmullRom(O.z,W.z,j.z,H.z,ie,fe,se)}else this.curveType==="catmullrom"&&(P_.initCatmullRom(O.x,W.x,j.x,H.x,this.tension),B_.initCatmullRom(O.y,W.y,j.y,H.y,this.tension),O_.initCatmullRom(O.z,W.z,j.z,H.z,this.tension));return d.set(P_.calc(B),B_.calc(B),O_.calc(B)),d}copy(r){super.copy(r),this.points=[];for(let a=0,d=r.points.length;a<d;a++){let g=r.points[a];this.points.push(g.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}toJSON(){let r=super.toJSON();r.points=[];for(let a=0,d=this.points.length;a<d;a++){let g=this.points[a];r.points.push(g.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r}fromJSON(r){super.fromJSON(r),this.points=[];for(let a=0,d=r.points.length;a<d;a++){let g=r.points[a];this.points.push(new Ye().fromArray(g))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}}function jT(b,r,a,d,g){let _=(d-r)*.5,C=(g-a)*.5,S=b*b,B=b*S;return(2*a-2*d+_+C)*B+(-3*a+3*d-2*_-C)*S+_*b+a}function O6(b,r){let a=1-b;return a*a*r}function N6(b,r){return 2*(1-b)*b*r}function F6(b,r){return b*b*r}function Zp(b,r,a,d){return O6(b,r)+N6(b,a)+F6(b,d)}function U6(b,r){let a=1-b;return a*a*a*r}function k6(b,r){let a=1-b;return 3*a*a*b*r}function V6(b,r){return 3*(1-b)*b*b*r}function H6(b,r){return b*b*b*r}function em(b,r,a,d,g){return U6(b,r)+k6(b,a)+V6(b,d)+H6(b,g)}class N_ extends Ga{constructor(r=new nn,a=new nn,d=new nn,g=new nn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=r,this.v1=a,this.v2=d,this.v3=g}getPoint(r,a=new nn){let d=a,g=this.v0,_=this.v1,C=this.v2,S=this.v3;return d.set(em(r,g.x,_.x,C.x,S.x),em(r,g.y,_.y,C.y,S.y)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}class QT extends Ga{constructor(r=new Ye,a=new Ye,d=new Ye,g=new Ye){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=r,this.v1=a,this.v2=d,this.v3=g}getPoint(r,a=new Ye){let d=a,g=this.v0,_=this.v1,C=this.v2,S=this.v3;return d.set(em(r,g.x,_.x,C.x,S.x),em(r,g.y,_.y,C.y,S.y),em(r,g.z,_.z,C.z,S.z)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}class F_ extends Ga{constructor(r=new nn,a=new nn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=r,this.v2=a}getPoint(r,a=new nn){let d=a;return r===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(r).add(this.v1)),d}getPointAt(r,a){return this.getPoint(r,a)}getTangent(r,a=new nn){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(r,a){return this.getTangent(r,a)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class XT extends Ga{constructor(r=new Ye,a=new Ye){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=r,this.v2=a}getPoint(r,a=new Ye){let d=a;return r===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(r).add(this.v1)),d}getPointAt(r,a){return this.getPoint(r,a)}getTangent(r,a=new Ye){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(r,a){return this.getTangent(r,a)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class U_ extends Ga{constructor(r=new nn,a=new nn,d=new nn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=r,this.v1=a,this.v2=d}getPoint(r,a=new nn){let d=a,g=this.v0,_=this.v1,C=this.v2;return d.set(Zp(r,g.x,_.x,C.x),Zp(r,g.y,_.y,C.y)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class k_ extends Ga{constructor(r=new Ye,a=new Ye,d=new Ye){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=r,this.v1=a,this.v2=d}getPoint(r,a=new Ye){let d=a,g=this.v0,_=this.v1,C=this.v2;return d.set(Zp(r,g.x,_.x,C.x),Zp(r,g.y,_.y,C.y),Zp(r,g.z,_.z,C.z)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class V_ extends Ga{constructor(r=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=r}getPoint(r,a=new nn){let d=a,g=this.points,_=(g.length-1)*r,C=Math.floor(_),S=_-C,B=g[C===0?C:C-1],O=g[C],H=g[C>g.length-2?g.length-1:C+1],W=g[C>g.length-3?g.length-1:C+2];return d.set(jT(S,B.x,O.x,H.x,W.x),jT(S,B.y,O.y,H.y,W.y)),d}copy(r){super.copy(r),this.points=[];for(let a=0,d=r.points.length;a<d;a++){let g=r.points[a];this.points.push(g.clone())}return this}toJSON(){let r=super.toJSON();r.points=[];for(let a=0,d=this.points.length;a<d;a++){let g=this.points[a];r.points.push(g.toArray())}return r}fromJSON(r){super.fromJSON(r),this.points=[];for(let a=0,d=r.points.length;a<d;a++){let g=r.points[a];this.points.push(new nn().fromArray(g))}return this}}var J0=Object.freeze({__proto__:null,ArcCurve:GT,CatmullRomCurve3:WT,CubicBezierCurve:N_,CubicBezierCurve3:QT,EllipseCurve:K0,LineCurve:F_,LineCurve3:XT,QuadraticBezierCurve:U_,QuadraticBezierCurve3:k_,SplineCurve:V_});class qT extends Ga{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(r){this.curves.push(r)}closePath(){let r=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);if(!r.equals(a)){let d=r.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new J0[d](a,r))}return this}getPoint(r,a){let d=r*this.getLength(),g=this.getCurveLengths(),_=0;for(;_<g.length;){if(g[_]>=d){let C=g[_]-d,S=this.curves[_],B=S.getLength(),O=B===0?0:1-C/B;return S.getPointAt(O,a)}_++}return null}getLength(){let r=this.getCurveLengths();return r[r.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let r=[],a=0;for(let d=0,g=this.curves.length;d<g;d++)a+=this.curves[d].getLength(),r.push(a);return this.cacheLengths=r,r}getSpacedPoints(r=40){let a=[];for(let d=0;d<=r;d++)a.push(this.getPoint(d/r));return this.autoClose&&a.push(a[0]),a}getPoints(r=12){let a=[],d;for(let g=0,_=this.curves;g<_.length;g++){let C=_[g],S=C.isEllipseCurve?r*2:C.isLineCurve||C.isLineCurve3?1:C.isSplineCurve?r*C.points.length:r,B=C.getPoints(S);for(let O=0;O<B.length;O++){let H=B[O];d&&d.equals(H)||(a.push(H),d=H)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}copy(r){super.copy(r),this.curves=[];for(let a=0,d=r.curves.length;a<d;a++){let g=r.curves[a];this.curves.push(g.clone())}return this.autoClose=r.autoClose,this}toJSON(){let r=super.toJSON();r.autoClose=this.autoClose,r.curves=[];for(let a=0,d=this.curves.length;a<d;a++){let g=this.curves[a];r.curves.push(g.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.autoClose=r.autoClose,this.curves=[];for(let a=0,d=r.curves.length;a<d;a++){let g=r.curves[a];this.curves.push(new J0[g.type]().fromJSON(g))}return this}}class tm extends qT{constructor(r){super(),this.type="Path",this.currentPoint=new nn,r&&this.setFromPoints(r)}setFromPoints(r){this.moveTo(r[0].x,r[0].y);for(let a=1,d=r.length;a<d;a++)this.lineTo(r[a].x,r[a].y);return this}moveTo(r,a){return this.currentPoint.set(r,a),this}lineTo(r,a){let d=new F_(this.currentPoint.clone(),new nn(r,a));return this.curves.push(d),this.currentPoint.set(r,a),this}quadraticCurveTo(r,a,d,g){let _=new U_(this.currentPoint.clone(),new nn(r,a),new nn(d,g));return this.curves.push(_),this.currentPoint.set(d,g),this}bezierCurveTo(r,a,d,g,_,C){let S=new N_(this.currentPoint.clone(),new nn(r,a),new nn(d,g),new nn(_,C));return this.curves.push(S),this.currentPoint.set(_,C),this}splineThru(r){let a=[this.currentPoint.clone()].concat(r),d=new V_(a);return this.curves.push(d),this.currentPoint.copy(r[r.length-1]),this}arc(r,a,d,g,_,C){let S=this.currentPoint.x,B=this.currentPoint.y;return this.absarc(r+S,a+B,d,g,_,C),this}absarc(r,a,d,g,_,C){return this.absellipse(r,a,d,d,g,_,C),this}ellipse(r,a,d,g,_,C,S,B){let O=this.currentPoint.x,H=this.currentPoint.y;return this.absellipse(r+O,a+H,d,g,_,C,S,B),this}absellipse(r,a,d,g,_,C,S,B){let O=new K0(r,a,d,g,_,C,S,B);if(this.curves.length>0){let W=O.getPoint(0);W.equals(this.currentPoint)||this.lineTo(W.x,W.y)}this.curves.push(O);let H=O.getPoint(1);return this.currentPoint.copy(H),this}copy(r){return super.copy(r),this.currentPoint.copy(r.currentPoint),this}toJSON(){let r=super.toJSON();return r.currentPoint=this.currentPoint.toArray(),r}fromJSON(r){return super.fromJSON(r),this.currentPoint.fromArray(r.currentPoint),this}}class nm extends Zi{constructor(r=[new nn(0,-.5),new nn(.5,0),new nn(0,.5)],a=12,d=0,g=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:r,segments:a,phiStart:d,phiLength:g},a=Math.floor(a),g=es(g,0,Math.PI*2);let _=[],C=[],S=[],B=[],O=[],H=1/a,W=new Ye,j=new nn,J=new Ye,ie=new Ye,fe=new Ye,se=0,K=0;for(let Pe=0;Pe<=r.length-1;Pe++)switch(Pe){case 0:se=r[Pe+1].x-r[Pe].x,K=r[Pe+1].y-r[Pe].y,J.x=K*1,J.y=-se,J.z=K*0,fe.copy(J),J.normalize(),B.push(J.x,J.y,J.z);break;case r.length-1:B.push(fe.x,fe.y,fe.z);break;default:se=r[Pe+1].x-r[Pe].x,K=r[Pe+1].y-r[Pe].y,J.x=K*1,J.y=-se,J.z=K*0,ie.copy(J),J.x+=fe.x,J.y+=fe.y,J.z+=fe.z,J.normalize(),B.push(J.x,J.y,J.z),fe.copy(ie)}for(let Pe=0;Pe<=a;Pe++){let ve=d+Pe*H*g,Te=Math.sin(ve),We=Math.cos(ve);for(let qe=0;qe<=r.length-1;qe++){W.x=r[qe].x*Te,W.y=r[qe].y,W.z=r[qe].x*We,C.push(W.x,W.y,W.z),j.x=Pe/a,j.y=qe/(r.length-1),S.push(j.x,j.y);let st=B[3*qe+0]*Te,lt=B[3*qe+1],Ve=B[3*qe+0]*We;O.push(st,lt,Ve)}}for(let Pe=0;Pe<a;Pe++)for(let ve=0;ve<r.length-1;ve++){let Te=ve+Pe*r.length,We=Te,qe=Te+r.length,st=Te+r.length+1,lt=Te+1;_.push(We,qe,lt),_.push(st,lt,qe)}this.setIndex(_),this.setAttribute("position",new ni(C,3)),this.setAttribute("uv",new ni(S,2)),this.setAttribute("normal",new ni(O,3))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new nm(r.points,r.segments,r.phiStart,r.phiLength)}}class Z0 extends nm{constructor(r=1,a=1,d=4,g=8){let _=new tm;_.absarc(0,-a/2,r,Math.PI*1.5,0),_.absarc(0,a/2,r,0,Math.PI*.5),super(_.getPoints(d),g),this.type="CapsuleGeometry",this.parameters={radius:r,length:a,capSegments:d,radialSegments:g}}static fromJSON(r){return new Z0(r.radius,r.length,r.capSegments,r.radialSegments)}}class eA extends Zi{constructor(r=1,a=32,d=0,g=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:r,segments:a,thetaStart:d,thetaLength:g},a=Math.max(3,a);let _=[],C=[],S=[],B=[],O=new Ye,H=new nn;C.push(0,0,0),S.push(0,0,1),B.push(.5,.5);for(let W=0,j=3;W<=a;W++,j+=3){let J=d+W/a*g;O.x=r*Math.cos(J),O.y=r*Math.sin(J),C.push(O.x,O.y,O.z),S.push(0,0,1),H.x=(C[j]/r+1)/2,H.y=(C[j+1]/r+1)/2,B.push(H.x,H.y)}for(let W=1;W<=a;W++)_.push(W,W+1,0);this.setIndex(_),this.setAttribute("position",new ni(C,3)),this.setAttribute("normal",new ni(S,3)),this.setAttribute("uv",new ni(B,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new eA(r.radius,r.segments,r.thetaStart,r.thetaLength)}}class Id extends Zi{constructor(r=1,a=1,d=1,g=32,_=1,C=!1,S=0,B=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:r,radiusBottom:a,height:d,radialSegments:g,heightSegments:_,openEnded:C,thetaStart:S,thetaLength:B};let O=this;g=Math.floor(g),_=Math.floor(_);let H=[],W=[],j=[],J=[],ie=0,fe=[],se=d/2,K=0;Pe(),C===!1&&(r>0&&ve(!0),a>0&&ve(!1)),this.setIndex(H),this.setAttribute("position",new ni(W,3)),this.setAttribute("normal",new ni(j,3)),this.setAttribute("uv",new ni(J,2));function Pe(){let Te=new Ye,We=new Ye,qe=0,st=(a-r)/d;for(let lt=0;lt<=_;lt++){let Ve=[],Ke=lt/_,ct=Ke*(a-r)+r;for(let Dt=0;Dt<=g;Dt++){let Qt=Dt/g,dt=Qt*B+S,wt=Math.sin(dt),Kt=Math.cos(dt);We.x=ct*wt,We.y=-Ke*d+se,We.z=ct*Kt,W.push(We.x,We.y,We.z),Te.set(wt,st,Kt).normalize(),j.push(Te.x,Te.y,Te.z),J.push(Qt,1-Ke),Ve.push(ie++)}fe.push(Ve)}for(let lt=0;lt<g;lt++)for(let Ve=0;Ve<_;Ve++){let Ke=fe[Ve][lt],ct=fe[Ve+1][lt],Dt=fe[Ve+1][lt+1],Qt=fe[Ve][lt+1];H.push(Ke,ct,Qt),H.push(ct,Dt,Qt),qe+=6}O.addGroup(K,qe,0),K+=qe}function ve(Te){let We=ie,qe=new nn,st=new Ye,lt=0,Ve=Te===!0?r:a,Ke=Te===!0?1:-1;for(let Dt=1;Dt<=g;Dt++)W.push(0,se*Ke,0),j.push(0,Ke,0),J.push(.5,.5),ie++;let ct=ie;for(let Dt=0;Dt<=g;Dt++){let dt=Dt/g*B+S,wt=Math.cos(dt),Kt=Math.sin(dt);st.x=Ve*Kt,st.y=se*Ke,st.z=Ve*wt,W.push(st.x,st.y,st.z),j.push(0,Ke,0),qe.x=wt*.5+.5,qe.y=Kt*.5*Ke+.5,J.push(qe.x,qe.y),ie++}for(let Dt=0;Dt<g;Dt++){let Qt=We+Dt,dt=ct+Dt;Te===!0?H.push(dt,dt+1,Qt):H.push(dt+1,dt,Qt),lt+=3}O.addGroup(K,lt,Te===!0?1:2),K+=lt}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Id(r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class tA extends Id{constructor(r=1,a=1,d=32,g=1,_=!1,C=0,S=Math.PI*2){super(0,r,a,d,g,_,C,S),this.type="ConeGeometry",this.parameters={radius:r,height:a,radialSegments:d,heightSegments:g,openEnded:_,thetaStart:C,thetaLength:S}}static fromJSON(r){return new tA(r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class Fl extends Zi{constructor(r=[],a=[],d=1,g=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:r,indices:a,radius:d,detail:g};let _=[],C=[];S(g),O(d),H(),this.setAttribute("position",new ni(_,3)),this.setAttribute("normal",new ni(_.slice(),3)),this.setAttribute("uv",new ni(C,2)),g===0?this.computeVertexNormals():this.normalizeNormals();function S(Pe){let ve=new Ye,Te=new Ye,We=new Ye;for(let qe=0;qe<a.length;qe+=3)J(a[qe+0],ve),J(a[qe+1],Te),J(a[qe+2],We),B(ve,Te,We,Pe)}function B(Pe,ve,Te,We){let qe=We+1,st=[];for(let lt=0;lt<=qe;lt++){st[lt]=[];let Ve=Pe.clone().lerp(Te,lt/qe),Ke=ve.clone().lerp(Te,lt/qe),ct=qe-lt;for(let Dt=0;Dt<=ct;Dt++)Dt===0&&lt===qe?st[lt][Dt]=Ve:st[lt][Dt]=Ve.clone().lerp(Ke,Dt/ct)}for(let lt=0;lt<qe;lt++)for(let Ve=0;Ve<2*(qe-lt)-1;Ve++){let Ke=Math.floor(Ve/2);Ve%2===0?(j(st[lt][Ke+1]),j(st[lt+1][Ke]),j(st[lt][Ke])):(j(st[lt][Ke+1]),j(st[lt+1][Ke+1]),j(st[lt+1][Ke]))}}function O(Pe){let ve=new Ye;for(let Te=0;Te<_.length;Te+=3)ve.x=_[Te+0],ve.y=_[Te+1],ve.z=_[Te+2],ve.normalize().multiplyScalar(Pe),_[Te+0]=ve.x,_[Te+1]=ve.y,_[Te+2]=ve.z}function H(){let Pe=new Ye;for(let ve=0;ve<_.length;ve+=3){Pe.x=_[ve+0],Pe.y=_[ve+1],Pe.z=_[ve+2];let Te=se(Pe)/2/Math.PI+.5,We=K(Pe)/Math.PI+.5;C.push(Te,1-We)}ie(),W()}function W(){for(let Pe=0;Pe<C.length;Pe+=6){let ve=C[Pe+0],Te=C[Pe+2],We=C[Pe+4],qe=Math.max(ve,Te,We),st=Math.min(ve,Te,We);qe>.9&&st<.1&&(ve<.2&&(C[Pe+0]+=1),Te<.2&&(C[Pe+2]+=1),We<.2&&(C[Pe+4]+=1))}}function j(Pe){_.push(Pe.x,Pe.y,Pe.z)}function J(Pe,ve){let Te=Pe*3;ve.x=r[Te+0],ve.y=r[Te+1],ve.z=r[Te+2]}function ie(){let Pe=new Ye,ve=new Ye,Te=new Ye,We=new Ye,qe=new nn,st=new nn,lt=new nn;for(let Ve=0,Ke=0;Ve<_.length;Ve+=9,Ke+=6){Pe.set(_[Ve+0],_[Ve+1],_[Ve+2]),ve.set(_[Ve+3],_[Ve+4],_[Ve+5]),Te.set(_[Ve+6],_[Ve+7],_[Ve+8]),qe.set(C[Ke+0],C[Ke+1]),st.set(C[Ke+2],C[Ke+3]),lt.set(C[Ke+4],C[Ke+5]),We.copy(Pe).add(ve).add(Te).divideScalar(3);let ct=se(We);fe(qe,Ke+0,Pe,ct),fe(st,Ke+2,ve,ct),fe(lt,Ke+4,Te,ct)}}function fe(Pe,ve,Te,We){We<0&&Pe.x===1&&(C[ve]=Pe.x-1),Te.x===0&&Te.z===0&&(C[ve]=We/2/Math.PI+.5)}function se(Pe){return Math.atan2(Pe.z,-Pe.x)}function K(Pe){return Math.atan2(-Pe.y,Math.sqrt(Pe.x*Pe.x+Pe.z*Pe.z))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Fl(r.vertices,r.indices,r.radius,r.details)}}class nA extends Fl{constructor(r=1,a=0){let d=(1+Math.sqrt(5))/2,g=1/d,_=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-g,-d,0,-g,d,0,g,-d,0,g,d,-g,-d,0,-g,d,0,g,-d,0,g,d,0,-d,0,-g,d,0,-g,-d,0,g,d,0,g],C=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(_,C,r,a),this.type="DodecahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new nA(r.radius,r.detail)}}let iA=new Ye,rA=new Ye,H_=new Ye,sA=new ko;class YT extends Zi{constructor(r=null,a=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:r,thresholdAngle:a},r!==null){let g=Math.pow(10,4),_=Math.cos(Dc*a),C=r.getIndex(),S=r.getAttribute("position"),B=C?C.count:S.count,O=[0,0,0],H=["a","b","c"],W=new Array(3),j={},J=[];for(let ie=0;ie<B;ie+=3){C?(O[0]=C.getX(ie),O[1]=C.getX(ie+1),O[2]=C.getX(ie+2)):(O[0]=ie,O[1]=ie+1,O[2]=ie+2);let{a:fe,b:se,c:K}=sA;if(fe.fromBufferAttribute(S,O[0]),se.fromBufferAttribute(S,O[1]),K.fromBufferAttribute(S,O[2]),sA.getNormal(H_),W[0]=`${Math.round(fe.x*g)},${Math.round(fe.y*g)},${Math.round(fe.z*g)}`,W[1]=`${Math.round(se.x*g)},${Math.round(se.y*g)},${Math.round(se.z*g)}`,W[2]=`${Math.round(K.x*g)},${Math.round(K.y*g)},${Math.round(K.z*g)}`,!(W[0]===W[1]||W[1]===W[2]||W[2]===W[0]))for(let Pe=0;Pe<3;Pe++){let ve=(Pe+1)%3,Te=W[Pe],We=W[ve],qe=sA[H[Pe]],st=sA[H[ve]],lt=`${Te}_${We}`,Ve=`${We}_${Te}`;Ve in j&&j[Ve]?(H_.dot(j[Ve].normal)<=_&&(J.push(qe.x,qe.y,qe.z),J.push(st.x,st.y,st.z)),j[Ve]=null):lt in j||(j[lt]={index0:O[Pe],index1:O[ve],normal:H_.clone()})}}for(let ie in j)if(j[ie]){let{index0:fe,index1:se}=j[ie];iA.fromBufferAttribute(S,fe),rA.fromBufferAttribute(S,se),J.push(iA.x,iA.y,iA.z),J.push(rA.x,rA.y,rA.z)}this.setAttribute("position",new ni(J,3))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}}class Xu extends tm{constructor(r){super(r),this.uuid=_o(),this.type="Shape",this.holes=[]}getPointsHoles(r){let a=[];for(let d=0,g=this.holes.length;d<g;d++)a[d]=this.holes[d].getPoints(r);return a}extractPoints(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}}copy(r){super.copy(r),this.holes=[];for(let a=0,d=r.holes.length;a<d;a++){let g=r.holes[a];this.holes.push(g.clone())}return this}toJSON(){let r=super.toJSON();r.uuid=this.uuid,r.holes=[];for(let a=0,d=this.holes.length;a<d;a++){let g=this.holes[a];r.holes.push(g.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.uuid=r.uuid,this.holes=[];for(let a=0,d=r.holes.length;a<d;a++){let g=r.holes[a];this.holes.push(new tm().fromJSON(g))}return this}}let z6={triangulate:function(b,r,a=2){let d=r&&r.length,g=d?r[0]*a:b.length,_=KT(b,0,g,a,!0),C=[];if(!_||_.next===_.prev)return C;let S,B,O,H,W,j,J;if(d&&(_=X6(b,r,_,a)),b.length>80*a){S=O=b[0],B=H=b[1];for(let ie=a;ie<g;ie+=a)W=b[ie],j=b[ie+1],W<S&&(S=W),j<B&&(B=j),W>O&&(O=W),j>H&&(H=j);J=Math.max(O-S,H-B),J=J!==0?32767/J:0}return im(_,C,a,S,B,J,0),C}};function KT(b,r,a,d,g){let _,C;if(g===rV(b,r,a,d)>0)for(_=r;_<a;_+=d)C=ZT(_,b[_],b[_+1],C);else for(_=a-d;_>=r;_-=d)C=ZT(_,b[_],b[_+1],C);return C&&oA(C,C.next)&&(sm(C),C=C.next),C}function qu(b,r){if(!b)return b;r||(r=b);let a=b,d;do if(d=!1,!a.steiner&&(oA(a,a.next)||is(a.prev,a,a.next)===0)){if(sm(a),a=r=a.prev,a===a.next)break;d=!0}else a=a.next;while(d||a!==r);return r}function im(b,r,a,d,g,_,C){if(!b)return;!C&&_&&J6(b,d,g,_);let S=b,B,O;for(;b.prev!==b.next;){if(B=b.prev,O=b.next,_?W6(b,d,g,_):G6(b)){r.push(B.i/a|0),r.push(b.i/a|0),r.push(O.i/a|0),sm(b),b=O.next,S=O.next;continue}if(b=O,b===S){C?C===1?(b=j6(qu(b),r,a),im(b,r,a,d,g,_,2)):C===2&&Q6(b,r,a,d,g,_):im(qu(b),r,a,d,g,_,1);break}}}function G6(b){let r=b.prev,a=b,d=b.next;if(is(r,a,d)>=0)return!1;let g=r.x,_=a.x,C=d.x,S=r.y,B=a.y,O=d.y,H=g<_?g<C?g:C:_<C?_:C,W=S<B?S<O?S:O:B<O?B:O,j=g>_?g>C?g:C:_>C?_:C,J=S>B?S>O?S:O:B>O?B:O,ie=d.next;for(;ie!==r;){if(ie.x>=H&&ie.x<=j&&ie.y>=W&&ie.y<=J&&Rd(g,S,_,B,C,O,ie.x,ie.y)&&is(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function W6(b,r,a,d){let g=b.prev,_=b,C=b.next;if(is(g,_,C)>=0)return!1;let S=g.x,B=_.x,O=C.x,H=g.y,W=_.y,j=C.y,J=S<B?S<O?S:O:B<O?B:O,ie=H<W?H<j?H:j:W<j?W:j,fe=S>B?S>O?S:O:B>O?B:O,se=H>W?H>j?H:j:W>j?W:j,K=z_(J,ie,r,a,d),Pe=z_(fe,se,r,a,d),ve=b.prevZ,Te=b.nextZ;for(;ve&&ve.z>=K&&Te&&Te.z<=Pe;){if(ve.x>=J&&ve.x<=fe&&ve.y>=ie&&ve.y<=se&&ve!==g&&ve!==C&&Rd(S,H,B,W,O,j,ve.x,ve.y)&&is(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Te.x>=J&&Te.x<=fe&&Te.y>=ie&&Te.y<=se&&Te!==g&&Te!==C&&Rd(S,H,B,W,O,j,Te.x,Te.y)&&is(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;ve&&ve.z>=K;){if(ve.x>=J&&ve.x<=fe&&ve.y>=ie&&ve.y<=se&&ve!==g&&ve!==C&&Rd(S,H,B,W,O,j,ve.x,ve.y)&&is(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Te&&Te.z<=Pe;){if(Te.x>=J&&Te.x<=fe&&Te.y>=ie&&Te.y<=se&&Te!==g&&Te!==C&&Rd(S,H,B,W,O,j,Te.x,Te.y)&&is(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function j6(b,r,a){let d=b;do{let g=d.prev,_=d.next.next;!oA(g,_)&&$T(g,d,d.next,_)&&rm(g,_)&&rm(_,g)&&(r.push(g.i/a|0),r.push(d.i/a|0),r.push(_.i/a|0),sm(d),sm(d.next),d=b=_),d=d.next}while(d!==b);return qu(d)}function Q6(b,r,a,d,g,_){let C=b;do{let S=C.next.next;for(;S!==C.prev;){if(C.i!==S.i&&tV(C,S)){let B=JT(C,S);C=qu(C,C.next),B=qu(B,B.next),im(C,r,a,d,g,_,0),im(B,r,a,d,g,_,0);return}S=S.next}C=C.next}while(C!==b)}function X6(b,r,a,d){let g=[],_,C,S,B,O;for(_=0,C=r.length;_<C;_++)S=r[_]*d,B=_<C-1?r[_+1]*d:b.length,O=KT(b,S,B,d,!1),O===O.next&&(O.steiner=!0),g.push(eV(O));for(g.sort(q6),_=0;_<g.length;_++)a=Y6(g[_],a);return a}function q6(b,r){return b.x-r.x}function Y6(b,r){let a=K6(b,r);if(!a)return r;let d=JT(a,b);return qu(d,d.next),qu(a,a.next)}function K6(b,r){let a=r,d=-1/0,g,_=b.x,C=b.y;do{if(C<=a.y&&C>=a.next.y&&a.next.y!==a.y){let j=a.x+(C-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(j<=_&&j>d&&(d=j,g=a.x<a.next.x?a:a.next,j===_))return g}a=a.next}while(a!==r);if(!g)return null;let S=g,B=g.x,O=g.y,H=1/0,W;a=g;do _>=a.x&&a.x>=B&&_!==a.x&&Rd(C<O?_:d,C,B,O,C<O?d:_,C,a.x,a.y)&&(W=Math.abs(C-a.y)/(_-a.x),rm(a,b)&&(W<H||W===H&&(a.x>g.x||a.x===g.x&&$6(g,a)))&&(g=a,H=W)),a=a.next;while(a!==S);return g}function $6(b,r){return is(b.prev,b,r.prev)<0&&is(r.next,b,b.next)<0}function J6(b,r,a,d){let g=b;do g.z===0&&(g.z=z_(g.x,g.y,r,a,d)),g.prevZ=g.prev,g.nextZ=g.next,g=g.next;while(g!==b);g.prevZ.nextZ=null,g.prevZ=null,Z6(g)}function Z6(b){let r,a,d,g,_,C,S,B,O=1;do{for(a=b,b=null,_=null,C=0;a;){for(C++,d=a,S=0,r=0;r<O&&(S++,d=d.nextZ,!!d);r++);for(B=O;S>0||B>0&&d;)S!==0&&(B===0||!d||a.z<=d.z)?(g=a,a=a.nextZ,S--):(g=d,d=d.nextZ,B--),_?_.nextZ=g:b=g,g.prevZ=_,_=g;a=d}_.nextZ=null,O*=2}while(C>1);return b}function z_(b,r,a,d,g){return b=(b-a)*g|0,r=(r-d)*g|0,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,b|r<<1}function eV(b){let r=b,a=b;do(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next;while(r!==b);return a}function Rd(b,r,a,d,g,_,C,S){return(g-C)*(r-S)>=(b-C)*(_-S)&&(b-C)*(d-S)>=(a-C)*(r-S)&&(a-C)*(_-S)>=(g-C)*(d-S)}function tV(b,r){return b.next.i!==r.i&&b.prev.i!==r.i&&!nV(b,r)&&(rm(b,r)&&rm(r,b)&&iV(b,r)&&(is(b.prev,b,r.prev)||is(b,r.prev,r))||oA(b,r)&&is(b.prev,b,b.next)>0&&is(r.prev,r,r.next)>0)}function is(b,r,a){return(r.y-b.y)*(a.x-r.x)-(r.x-b.x)*(a.y-r.y)}function oA(b,r){return b.x===r.x&&b.y===r.y}function $T(b,r,a,d){let g=cA(is(b,r,a)),_=cA(is(b,r,d)),C=cA(is(a,d,b)),S=cA(is(a,d,r));return!!(g!==_&&C!==S||g===0&&aA(b,a,r)||_===0&&aA(b,d,r)||C===0&&aA(a,b,d)||S===0&&aA(a,r,d))}function aA(b,r,a){return r.x<=Math.max(b.x,a.x)&&r.x>=Math.min(b.x,a.x)&&r.y<=Math.max(b.y,a.y)&&r.y>=Math.min(b.y,a.y)}function cA(b){return b>0?1:b<0?-1:0}function nV(b,r){let a=b;do{if(a.i!==b.i&&a.next.i!==b.i&&a.i!==r.i&&a.next.i!==r.i&&$T(a,a.next,b,r))return!0;a=a.next}while(a!==b);return!1}function rm(b,r){return is(b.prev,b,b.next)<0?is(b,r,b.next)>=0&&is(b,b.prev,r)>=0:is(b,r,b.prev)<0||is(b,b.next,r)<0}function iV(b,r){let a=b,d=!1,g=(b.x+r.x)/2,_=(b.y+r.y)/2;do a.y>_!=a.next.y>_&&a.next.y!==a.y&&g<(a.next.x-a.x)*(_-a.y)/(a.next.y-a.y)+a.x&&(d=!d),a=a.next;while(a!==b);return d}function JT(b,r){let a=new G_(b.i,b.x,b.y),d=new G_(r.i,r.x,r.y),g=b.next,_=r.prev;return b.next=r,r.prev=b,a.next=g,g.prev=a,d.next=a,a.prev=d,_.next=d,d.prev=_,d}function ZT(b,r,a,d){let g=new G_(b,r,a);return d?(g.next=d.next,g.prev=d,d.next.prev=g,d.next=g):(g.prev=g,g.next=g),g}function sm(b){b.next.prev=b.prev,b.prev.next=b.next,b.prevZ&&(b.prevZ.nextZ=b.nextZ),b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function G_(b,r,a){this.i=b,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rV(b,r,a,d){let g=0;for(let _=r,C=a-d;_<a;_+=d)g+=(b[C]-b[_])*(b[_+1]+b[C+1]),C=_;return g}class pc{static area(r){let a=r.length,d=0;for(let g=a-1,_=0;_<a;g=_++)d+=r[g].x*r[_].y-r[_].x*r[g].y;return d*.5}static isClockWise(r){return pc.area(r)<0}static triangulateShape(r,a){let d=[],g=[],_=[];eI(r),tI(d,r);let C=r.length;a.forEach(eI);for(let B=0;B<a.length;B++)g.push(C),C+=a[B].length,tI(d,a[B]);let S=z6.triangulate(d,g);for(let B=0;B<S.length;B+=3)_.push(S.slice(B,B+3));return _}}function eI(b){let r=b.length;r>2&&b[r-1].equals(b[0])&&b.pop()}function tI(b,r){for(let a=0;a<r.length;a++)b.push(r[a].x),b.push(r[a].y)}class lA extends Zi{constructor(r=new Xu([new nn(.5,.5),new nn(-.5,.5),new nn(-.5,-.5),new nn(.5,-.5)]),a={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:r,options:a},r=Array.isArray(r)?r:[r];let d=this,g=[],_=[];for(let S=0,B=r.length;S<B;S++){let O=r[S];C(O)}this.setAttribute("position",new ni(g,3)),this.setAttribute("uv",new ni(_,2)),this.computeVertexNormals();function C(S){let B=[],O=a.curveSegments!==void 0?a.curveSegments:12,H=a.steps!==void 0?a.steps:1,W=a.depth!==void 0?a.depth:1,j=a.bevelEnabled!==void 0?a.bevelEnabled:!0,J=a.bevelThickness!==void 0?a.bevelThickness:.2,ie=a.bevelSize!==void 0?a.bevelSize:J-.1,fe=a.bevelOffset!==void 0?a.bevelOffset:0,se=a.bevelSegments!==void 0?a.bevelSegments:3,K=a.extrudePath,Pe=a.UVGenerator!==void 0?a.UVGenerator:sV,ve,Te=!1,We,qe,st,lt;K&&(ve=K.getSpacedPoints(H),Te=!0,j=!1,We=K.computeFrenetFrames(H,!1),qe=new Ye,st=new Ye,lt=new Ye),j||(se=0,J=0,ie=0,fe=0);let Ve=S.extractPoints(O),Ke=Ve.shape,ct=Ve.holes;if(!pc.isClockWise(Ke)){Ke=Ke.reverse();for(let on=0,ft=ct.length;on<ft;on++){let dn=ct[on];pc.isClockWise(dn)&&(ct[on]=dn.reverse())}}let Qt=pc.triangulateShape(Ke,ct),dt=Ke;for(let on=0,ft=ct.length;on<ft;on++){let dn=ct[on];Ke=Ke.concat(dn)}function wt(on,ft,dn){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),on.clone().addScaledVector(ft,dn)}let Kt=Ke.length,$t=Qt.length;function un(on,ft,dn){let Dn,an,Vn,pi=on.x-ft.x,ti=on.y-ft.y,mi=dn.x-on.x,hr=dn.y-on.y,$r=pi*pi+ti*ti,Ss=pi*hr-ti*mi;if(Math.abs(Ss)>Number.EPSILON){let Br=Math.sqrt($r),Tr=Math.sqrt(mi*mi+hr*hr),hs=ft.x-ti/Br,Ho=ft.y+pi/Br,Je=dn.x-hr/Tr,ke=dn.y+mi/Tr,Nt=((Je-hs)*hr-(ke-Ho)*mi)/(pi*hr-ti*mi);Dn=hs+pi*Nt-on.x,an=Ho+ti*Nt-on.y;let ln=Dn*Dn+an*an;if(ln<=2)return new nn(Dn,an);Vn=Math.sqrt(ln/2)}else{let Br=!1;pi>Number.EPSILON?mi>Number.EPSILON&&(Br=!0):pi<-Number.EPSILON?mi<-Number.EPSILON&&(Br=!0):Math.sign(ti)===Math.sign(hr)&&(Br=!0),Br?(Dn=-ti,an=pi,Vn=Math.sqrt($r)):(Dn=pi,an=ti,Vn=Math.sqrt($r/2))}return new nn(Dn/Vn,an/Vn)}let Zt=[];for(let on=0,ft=dt.length,dn=ft-1,Dn=on+1;on<ft;on++,dn++,Dn++)dn===ft&&(dn=0),Dn===ft&&(Dn=0),Zt[on]=un(dt[on],dt[dn],dt[Dn]);let An=[],gn,Qn=Zt.concat();for(let on=0,ft=ct.length;on<ft;on++){let dn=ct[on];gn=[];for(let Dn=0,an=dn.length,Vn=an-1,pi=Dn+1;Dn<an;Dn++,Vn++,pi++)Vn===an&&(Vn=0),pi===an&&(pi=0),gn[Dn]=un(dn[Dn],dn[Vn],dn[pi]);An.push(gn),Qn=Qn.concat(gn)}for(let on=0;on<se;on++){let ft=on/se,dn=J*Math.cos(ft*Math.PI/2),Dn=ie*Math.sin(ft*Math.PI/2)+fe;for(let an=0,Vn=dt.length;an<Vn;an++){let pi=wt(dt[an],Zt[an],Dn);Mn(pi.x,pi.y,-dn)}for(let an=0,Vn=ct.length;an<Vn;an++){let pi=ct[an];gn=An[an];for(let ti=0,mi=pi.length;ti<mi;ti++){let hr=wt(pi[ti],gn[ti],Dn);Mn(hr.x,hr.y,-dn)}}}let ji=ie+fe;for(let on=0;on<Kt;on++){let ft=j?wt(Ke[on],Qn[on],ji):Ke[on];Te?(st.copy(We.normals[0]).multiplyScalar(ft.x),qe.copy(We.binormals[0]).multiplyScalar(ft.y),lt.copy(ve[0]).add(st).add(qe),Mn(lt.x,lt.y,lt.z)):Mn(ft.x,ft.y,0)}for(let on=1;on<=H;on++)for(let ft=0;ft<Kt;ft++){let dn=j?wt(Ke[ft],Qn[ft],ji):Ke[ft];Te?(st.copy(We.normals[on]).multiplyScalar(dn.x),qe.copy(We.binormals[on]).multiplyScalar(dn.y),lt.copy(ve[on]).add(st).add(qe),Mn(lt.x,lt.y,lt.z)):Mn(dn.x,dn.y,W/H*on)}for(let on=se-1;on>=0;on--){let ft=on/se,dn=J*Math.cos(ft*Math.PI/2),Dn=ie*Math.sin(ft*Math.PI/2)+fe;for(let an=0,Vn=dt.length;an<Vn;an++){let pi=wt(dt[an],Zt[an],Dn);Mn(pi.x,pi.y,W+dn)}for(let an=0,Vn=ct.length;an<Vn;an++){let pi=ct[an];gn=An[an];for(let ti=0,mi=pi.length;ti<mi;ti++){let hr=wt(pi[ti],gn[ti],Dn);Te?Mn(hr.x,hr.y+ve[H-1].y,ve[H-1].x+dn):Mn(hr.x,hr.y,W+dn)}}}Ni(),Xt();function Ni(){let on=g.length/3;if(j){let ft=0,dn=Kt*ft;for(let Dn=0;Dn<$t;Dn++){let an=Qt[Dn];bi(an[2]+dn,an[1]+dn,an[0]+dn)}ft=H+se*2,dn=Kt*ft;for(let Dn=0;Dn<$t;Dn++){let an=Qt[Dn];bi(an[0]+dn,an[1]+dn,an[2]+dn)}}else{for(let ft=0;ft<$t;ft++){let dn=Qt[ft];bi(dn[2],dn[1],dn[0])}for(let ft=0;ft<$t;ft++){let dn=Qt[ft];bi(dn[0]+Kt*H,dn[1]+Kt*H,dn[2]+Kt*H)}}d.addGroup(on,g.length/3-on,0)}function Xt(){let on=g.length/3,ft=0;Tn(dt,ft),ft+=dt.length;for(let dn=0,Dn=ct.length;dn<Dn;dn++){let an=ct[dn];Tn(an,ft),ft+=an.length}d.addGroup(on,g.length/3-on,1)}function Tn(on,ft){let dn=on.length;for(;--dn>=0;){let Dn=dn,an=dn-1;an<0&&(an=on.length-1);for(let Vn=0,pi=H+se*2;Vn<pi;Vn++){let ti=Kt*Vn,mi=Kt*(Vn+1),hr=ft+Dn+ti,$r=ft+an+ti,Ss=ft+an+mi,Br=ft+Dn+mi;ei(hr,$r,Ss,Br)}}}function Mn(on,ft,dn){B.push(on),B.push(ft),B.push(dn)}function bi(on,ft,dn){ii(on),ii(ft),ii(dn);let Dn=g.length/3,an=Pe.generateTopUV(d,g,Dn-3,Dn-2,Dn-1);vi(an[0]),vi(an[1]),vi(an[2])}function ei(on,ft,dn,Dn){ii(on),ii(ft),ii(Dn),ii(ft),ii(dn),ii(Dn);let an=g.length/3,Vn=Pe.generateSideWallUV(d,g,an-6,an-3,an-2,an-1);vi(Vn[0]),vi(Vn[1]),vi(Vn[3]),vi(Vn[1]),vi(Vn[2]),vi(Vn[3])}function ii(on){g.push(B[on*3+0]),g.push(B[on*3+1]),g.push(B[on*3+2])}function vi(on){_.push(on.x),_.push(on.y)}}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){let r=super.toJSON(),a=this.parameters.shapes,d=this.parameters.options;return oV(a,d,r)}static fromJSON(r,a){let d=[];for(let _=0,C=r.shapes.length;_<C;_++){let S=a[r.shapes[_]];d.push(S)}let g=r.options.extrudePath;return g!==void 0&&(r.options.extrudePath=new J0[g.type]().fromJSON(g)),new lA(d,r.options)}}let sV={generateTopUV:function(b,r,a,d,g){let _=r[a*3],C=r[a*3+1],S=r[d*3],B=r[d*3+1],O=r[g*3],H=r[g*3+1];return[new nn(_,C),new nn(S,B),new nn(O,H)]},generateSideWallUV:function(b,r,a,d,g,_){let C=r[a*3],S=r[a*3+1],B=r[a*3+2],O=r[d*3],H=r[d*3+1],W=r[d*3+2],j=r[g*3],J=r[g*3+1],ie=r[g*3+2],fe=r[_*3],se=r[_*3+1],K=r[_*3+2];return Math.abs(S-H)<Math.abs(C-O)?[new nn(C,1-B),new nn(O,1-W),new nn(j,1-ie),new nn(fe,1-K)]:[new nn(S,1-B),new nn(H,1-W),new nn(J,1-ie),new nn(se,1-K)]}};function oV(b,r,a){if(a.shapes=[],Array.isArray(b))for(let d=0,g=b.length;d<g;d++){let _=b[d];a.shapes.push(_.uuid)}else a.shapes.push(b.uuid);return a.options=Object.assign({},r),r.extrudePath!==void 0&&(a.options.extrudePath=r.extrudePath.toJSON()),a}class uA extends Fl{constructor(r=1,a=0){let d=(1+Math.sqrt(5))/2,g=[-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],_=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(g,_,r,a),this.type="IcosahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new uA(r.radius,r.detail)}}class om extends Fl{constructor(r=1,a=0){let d=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],g=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(d,g,r,a),this.type="OctahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new om(r.radius,r.detail)}}class hA extends Zi{constructor(r=.5,a=1,d=32,g=1,_=0,C=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:r,outerRadius:a,thetaSegments:d,phiSegments:g,thetaStart:_,thetaLength:C},d=Math.max(3,d),g=Math.max(1,g);let S=[],B=[],O=[],H=[],W=r,j=(a-r)/g,J=new Ye,ie=new nn;for(let fe=0;fe<=g;fe++){for(let se=0;se<=d;se++){let K=_+se/d*C;J.x=W*Math.cos(K),J.y=W*Math.sin(K),B.push(J.x,J.y,J.z),O.push(0,0,1),ie.x=(J.x/a+1)/2,ie.y=(J.y/a+1)/2,H.push(ie.x,ie.y)}W+=j}for(let fe=0;fe<g;fe++){let se=fe*(d+1);for(let K=0;K<d;K++){let Pe=K+se,ve=Pe,Te=Pe+d+1,We=Pe+d+2,qe=Pe+1;S.push(ve,Te,qe),S.push(Te,We,qe)}}this.setIndex(S),this.setAttribute("position",new ni(B,3)),this.setAttribute("normal",new ni(O,3)),this.setAttribute("uv",new ni(H,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new hA(r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength)}}class dA extends Zi{constructor(r=new Xu([new nn(0,.5),new nn(-.5,-.5),new nn(.5,-.5)]),a=12){super(),this.type="ShapeGeometry",this.parameters={shapes:r,curveSegments:a};let d=[],g=[],_=[],C=[],S=0,B=0;if(Array.isArray(r)===!1)O(r);else for(let H=0;H<r.length;H++)O(r[H]),this.addGroup(S,B,H),S+=B,B=0;this.setIndex(d),this.setAttribute("position",new ni(g,3)),this.setAttribute("normal",new ni(_,3)),this.setAttribute("uv",new ni(C,2));function O(H){let W=g.length/3,j=H.extractPoints(a),J=j.shape,ie=j.holes;pc.isClockWise(J)===!1&&(J=J.reverse());for(let se=0,K=ie.length;se<K;se++){let Pe=ie[se];pc.isClockWise(Pe)===!0&&(ie[se]=Pe.reverse())}let fe=pc.triangulateShape(J,ie);for(let se=0,K=ie.length;se<K;se++){let Pe=ie[se];J=J.concat(Pe)}for(let se=0,K=J.length;se<K;se++){let Pe=J[se];g.push(Pe.x,Pe.y,0),_.push(0,0,1),C.push(Pe.x,Pe.y)}for(let se=0,K=fe.length;se<K;se++){let Pe=fe[se],ve=Pe[0]+W,Te=Pe[1]+W,We=Pe[2]+W;d.push(ve,Te,We),B+=3}}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){let r=super.toJSON(),a=this.parameters.shapes;return aV(a,r)}static fromJSON(r,a){let d=[];for(let g=0,_=r.shapes.length;g<_;g++){let C=a[r.shapes[g]];d.push(C)}return new dA(d,r.curveSegments)}}function aV(b,r){if(r.shapes=[],Array.isArray(b))for(let a=0,d=b.length;a<d;a++){let g=b[a];r.shapes.push(g.uuid)}else r.shapes.push(b.uuid);return r}class am extends Zi{constructor(r=1,a=32,d=16,g=0,_=Math.PI*2,C=0,S=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:r,widthSegments:a,heightSegments:d,phiStart:g,phiLength:_,thetaStart:C,thetaLength:S},a=Math.max(3,Math.floor(a)),d=Math.max(2,Math.floor(d));let B=Math.min(C+S,Math.PI),O=0,H=[],W=new Ye,j=new Ye,J=[],ie=[],fe=[],se=[];for(let K=0;K<=d;K++){let Pe=[],ve=K/d,Te=0;K===0&&C===0?Te=.5/a:K===d&&B===Math.PI&&(Te=-.5/a);for(let We=0;We<=a;We++){let qe=We/a;W.x=-r*Math.cos(g+qe*_)*Math.sin(C+ve*S),W.y=r*Math.cos(C+ve*S),W.z=r*Math.sin(g+qe*_)*Math.sin(C+ve*S),ie.push(W.x,W.y,W.z),j.copy(W).normalize(),fe.push(j.x,j.y,j.z),se.push(qe+Te,1-ve),Pe.push(O++)}H.push(Pe)}for(let K=0;K<d;K++)for(let Pe=0;Pe<a;Pe++){let ve=H[K][Pe+1],Te=H[K][Pe],We=H[K+1][Pe],qe=H[K+1][Pe+1];(K!==0||C>0)&&J.push(ve,Te,qe),(K!==d-1||B<Math.PI)&&J.push(Te,We,qe)}this.setIndex(J),this.setAttribute("position",new ni(ie,3)),this.setAttribute("normal",new ni(fe,3)),this.setAttribute("uv",new ni(se,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new am(r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength)}}class fA extends Fl{constructor(r=1,a=0){let d=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],g=[2,1,0,0,3,2,1,3,0,2,3,1];super(d,g,r,a),this.type="TetrahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new fA(r.radius,r.detail)}}class pA extends Zi{constructor(r=1,a=.4,d=12,g=48,_=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:r,tube:a,radialSegments:d,tubularSegments:g,arc:_},d=Math.floor(d),g=Math.floor(g);let C=[],S=[],B=[],O=[],H=new Ye,W=new Ye,j=new Ye;for(let J=0;J<=d;J++)for(let ie=0;ie<=g;ie++){let fe=ie/g*_,se=J/d*Math.PI*2;W.x=(r+a*Math.cos(se))*Math.cos(fe),W.y=(r+a*Math.cos(se))*Math.sin(fe),W.z=a*Math.sin(se),S.push(W.x,W.y,W.z),H.x=r*Math.cos(fe),H.y=r*Math.sin(fe),j.subVectors(W,H).normalize(),B.push(j.x,j.y,j.z),O.push(ie/g),O.push(J/d)}for(let J=1;J<=d;J++)for(let ie=1;ie<=g;ie++){let fe=(g+1)*J+ie-1,se=(g+1)*(J-1)+ie-1,K=(g+1)*(J-1)+ie,Pe=(g+1)*J+ie;C.push(fe,se,Pe),C.push(se,K,Pe)}this.setIndex(C),this.setAttribute("position",new ni(S,3)),this.setAttribute("normal",new ni(B,3)),this.setAttribute("uv",new ni(O,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new pA(r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc)}}class mA extends Zi{constructor(r=1,a=.4,d=64,g=8,_=2,C=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:r,tube:a,tubularSegments:d,radialSegments:g,p:_,q:C},d=Math.floor(d),g=Math.floor(g);let S=[],B=[],O=[],H=[],W=new Ye,j=new Ye,J=new Ye,ie=new Ye,fe=new Ye,se=new Ye,K=new Ye;for(let ve=0;ve<=d;++ve){let Te=ve/d*_*Math.PI*2;Pe(Te,_,C,r,J),Pe(Te+.01,_,C,r,ie),se.subVectors(ie,J),K.addVectors(ie,J),fe.crossVectors(se,K),K.crossVectors(fe,se),fe.normalize(),K.normalize();for(let We=0;We<=g;++We){let qe=We/g*Math.PI*2,st=-a*Math.cos(qe),lt=a*Math.sin(qe);W.x=J.x+(st*K.x+lt*fe.x),W.y=J.y+(st*K.y+lt*fe.y),W.z=J.z+(st*K.z+lt*fe.z),B.push(W.x,W.y,W.z),j.subVectors(W,J).normalize(),O.push(j.x,j.y,j.z),H.push(ve/d),H.push(We/g)}}for(let ve=1;ve<=d;ve++)for(let Te=1;Te<=g;Te++){let We=(g+1)*(ve-1)+(Te-1),qe=(g+1)*ve+(Te-1),st=(g+1)*ve+Te,lt=(g+1)*(ve-1)+Te;S.push(We,qe,lt),S.push(qe,st,lt)}this.setIndex(S),this.setAttribute("position",new ni(B,3)),this.setAttribute("normal",new ni(O,3)),this.setAttribute("uv",new ni(H,2));function Pe(ve,Te,We,qe,st){let lt=Math.cos(ve),Ve=Math.sin(ve),Ke=We/Te*ve,ct=Math.cos(Ke);st.x=qe*(2+ct)*.5*lt,st.y=qe*(2+ct)*Ve*.5,st.z=qe*Math.sin(Ke)*.5}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new mA(r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q)}}class gA extends Zi{constructor(r=new k_(new Ye(-1,-1,0),new Ye(-1,1,0),new Ye(1,1,0)),a=64,d=1,g=8,_=!1){super(),this.type="TubeGeometry",this.parameters={path:r,tubularSegments:a,radius:d,radialSegments:g,closed:_};let C=r.computeFrenetFrames(a,_);this.tangents=C.tangents,this.normals=C.normals,this.binormals=C.binormals;let S=new Ye,B=new Ye,O=new nn,H=new Ye,W=[],j=[],J=[],ie=[];fe(),this.setIndex(ie),this.setAttribute("position",new ni(W,3)),this.setAttribute("normal",new ni(j,3)),this.setAttribute("uv",new ni(J,2));function fe(){for(let ve=0;ve<a;ve++)se(ve);se(_===!1?a:0),Pe(),K()}function se(ve){H=r.getPointAt(ve/a,H);let Te=C.normals[ve],We=C.binormals[ve];for(let qe=0;qe<=g;qe++){let st=qe/g*Math.PI*2,lt=Math.sin(st),Ve=-Math.cos(st);B.x=Ve*Te.x+lt*We.x,B.y=Ve*Te.y+lt*We.y,B.z=Ve*Te.z+lt*We.z,B.normalize(),j.push(B.x,B.y,B.z),S.x=H.x+d*B.x,S.y=H.y+d*B.y,S.z=H.z+d*B.z,W.push(S.x,S.y,S.z)}}function K(){for(let ve=1;ve<=a;ve++)for(let Te=1;Te<=g;Te++){let We=(g+1)*(ve-1)+(Te-1),qe=(g+1)*ve+(Te-1),st=(g+1)*ve+Te,lt=(g+1)*(ve-1)+Te;ie.push(We,qe,lt),ie.push(qe,st,lt)}}function Pe(){for(let ve=0;ve<=a;ve++)for(let Te=0;Te<=g;Te++)O.x=ve/a,O.y=Te/g,J.push(O.x,O.y)}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){let r=super.toJSON();return r.path=this.parameters.path.toJSON(),r}static fromJSON(r){return new gA(new J0[r.path.type]().fromJSON(r.path),r.tubularSegments,r.radius,r.radialSegments,r.closed)}}class nI extends Zi{constructor(r=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:r},r!==null){let a=[],d=new Set,g=new Ye,_=new Ye;if(r.index!==null){let C=r.attributes.position,S=r.index,B=r.groups;B.length===0&&(B=[{start:0,count:S.count,materialIndex:0}]);for(let O=0,H=B.length;O<H;++O){let W=B[O],j=W.start,J=W.count;for(let ie=j,fe=j+J;ie<fe;ie+=3)for(let se=0;se<3;se++){let K=S.getX(ie+se),Pe=S.getX(ie+(se+1)%3);g.fromBufferAttribute(C,K),_.fromBufferAttribute(C,Pe),iI(g,_,d)===!0&&(a.push(g.x,g.y,g.z),a.push(_.x,_.y,_.z))}}}else{let C=r.attributes.position;for(let S=0,B=C.count/3;S<B;S++)for(let O=0;O<3;O++){let H=3*S+O,W=3*S+(O+1)%3;g.fromBufferAttribute(C,H),_.fromBufferAttribute(C,W),iI(g,_,d)===!0&&(a.push(g.x,g.y,g.z),a.push(_.x,_.y,_.z))}}this.setAttribute("position",new ni(a,3))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}}function iI(b,r,a){let d=`${b.x},${b.y},${b.z}-${r.x},${r.y},${r.z}`,g=`${r.x},${r.y},${r.z}-${b.x},${b.y},${b.z}`;return a.has(d)===!0||a.has(g)===!0?!1:(a.add(d),a.add(g),!0)}var rI=Object.freeze({__proto__:null,BoxGeometry:Hu,CapsuleGeometry:Z0,CircleGeometry:eA,ConeGeometry:tA,CylinderGeometry:Id,DodecahedronGeometry:nA,EdgesGeometry:YT,ExtrudeGeometry:lA,IcosahedronGeometry:uA,LatheGeometry:nm,OctahedronGeometry:om,PlaneGeometry:Qp,PolyhedronGeometry:Fl,RingGeometry:hA,ShapeGeometry:dA,SphereGeometry:am,TetrahedronGeometry:fA,TorusGeometry:pA,TorusKnotGeometry:mA,TubeGeometry:gA,WireframeGeometry:nI});class sI extends ho{constructor(r){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new jn(0),this.transparent=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.fog=r.fog,this}}class oI extends dc{constructor(r){super(r),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class W_ extends ho{constructor(r){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new jn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class aI extends W_{constructor(r){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new nn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return es(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(a){this.ior=(1+.4*a)/(1-.4*a)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new jn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new jn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new jn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(r)}get anisotropy(){return this._anisotropy}set anisotropy(r){this._anisotropy>0!=r>0&&this.version++,this._anisotropy=r}get clearcoat(){return this._clearcoat}set clearcoat(r){this._clearcoat>0!=r>0&&this.version++,this._clearcoat=r}get iridescence(){return this._iridescence}set iridescence(r){this._iridescence>0!=r>0&&this.version++,this._iridescence=r}get sheen(){return this._sheen}set sheen(r){this._sheen>0!=r>0&&this.version++,this._sheen=r}get transmission(){return this._transmission}set transmission(r){this._transmission>0!=r>0&&this.version++,this._transmission=r}copy(r){return super.copy(r),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=r.anisotropy,this.anisotropyRotation=r.anisotropyRotation,this.anisotropyMap=r.anisotropyMap,this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.ior=r.ior,this.iridescence=r.iridescence,this.iridescenceMap=r.iridescenceMap,this.iridescenceIOR=r.iridescenceIOR,this.iridescenceThicknessRange=[...r.iridescenceThicknessRange],this.iridescenceThicknessMap=r.iridescenceThicknessMap,this.sheen=r.sheen,this.sheenColor.copy(r.sheenColor),this.sheenColorMap=r.sheenColorMap,this.sheenRoughness=r.sheenRoughness,this.sheenRoughnessMap=r.sheenRoughnessMap,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this.thickness=r.thickness,this.thicknessMap=r.thicknessMap,this.attenuationDistance=r.attenuationDistance,this.attenuationColor.copy(r.attenuationColor),this.specularIntensity=r.specularIntensity,this.specularIntensityMap=r.specularIntensityMap,this.specularColor.copy(r.specularColor),this.specularColorMap=r.specularColorMap,this}}class cI extends ho{constructor(r){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new jn(16777215),this.specular=new jn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class lI extends ho{constructor(r){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new jn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}}class uI extends ho{constructor(r){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.flatShading=r.flatShading,this}}class hI extends ho{constructor(r){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new jn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class dI extends ho{constructor(r){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new jn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Os,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.flatShading=r.flatShading,this.fog=r.fog,this}}class fI extends Co{constructor(r){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}copy(r){return super.copy(r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this}}function Yu(b,r,a){return!b||!a&&b.constructor===r?b:typeof r.BYTES_PER_ELEMENT=="number"?new r(b):Array.prototype.slice.call(b)}function pI(b){return ArrayBuffer.isView(b)&&!(b instanceof DataView)}function mI(b){function r(g,_){return b[g]-b[_]}let a=b.length,d=new Array(a);for(let g=0;g!==a;++g)d[g]=g;return d.sort(r),d}function j_(b,r,a){let d=b.length,g=new b.constructor(d);for(let _=0,C=0;C!==d;++_){let S=a[_]*r;for(let B=0;B!==r;++B)g[C++]=b[S+B]}return g}function Q_(b,r,a,d){let g=1,_=b[0];for(;_!==void 0&&_[d]===void 0;)_=b[g++];if(_===void 0)return;let C=_[d];if(C!==void 0)if(Array.isArray(C))do C=_[d],C!==void 0&&(r.push(_.time),a.push.apply(a,C)),_=b[g++];while(_!==void 0);else if(C.toArray!==void 0)do C=_[d],C!==void 0&&(r.push(_.time),C.toArray(a,a.length)),_=b[g++];while(_!==void 0);else do C=_[d],C!==void 0&&(r.push(_.time),a.push(C)),_=b[g++];while(_!==void 0)}function cV(b,r,a,d,g=30){let _=b.clone();_.name=r;let C=[];for(let B=0;B<_.tracks.length;++B){let O=_.tracks[B],H=O.getValueSize(),W=[],j=[];for(let J=0;J<O.times.length;++J){let ie=O.times[J]*g;if(!(ie<a||ie>=d)){W.push(O.times[J]);for(let fe=0;fe<H;++fe)j.push(O.values[J*H+fe])}}W.length!==0&&(O.times=Yu(W,O.times.constructor),O.values=Yu(j,O.values.constructor),C.push(O))}_.tracks=C;let S=1/0;for(let B=0;B<_.tracks.length;++B)S>_.tracks[B].times[0]&&(S=_.tracks[B].times[0]);for(let B=0;B<_.tracks.length;++B)_.tracks[B].shift(-1*S);return _.resetDuration(),_}function lV(b,r=0,a=b,d=30){d<=0&&(d=30);let g=a.tracks.length,_=r/d;for(let C=0;C<g;++C){let S=a.tracks[C],B=S.ValueTypeName;if(B==="bool"||B==="string")continue;let O=b.tracks.find(function(K){return K.name===S.name&&K.ValueTypeName===B});if(O===void 0)continue;let H=0,W=S.getValueSize();S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(H=W/3);let j=0,J=O.getValueSize();O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(j=J/3);let ie=S.times.length-1,fe;if(_<=S.times[0]){let K=H,Pe=W-H;fe=S.values.slice(K,Pe)}else if(_>=S.times[ie]){let K=ie*W+H,Pe=K+W-H;fe=S.values.slice(K,Pe)}else{let K=S.createInterpolant(),Pe=H,ve=W-H;K.evaluate(_),fe=K.resultBuffer.slice(Pe,ve)}B==="quaternion"&&new Ci().fromArray(fe).normalize().conjugate().toArray(fe);let se=O.times.length;for(let K=0;K<se;++K){let Pe=K*J+j;if(B==="quaternion")Ci.multiplyQuaternionsFlat(O.values,Pe,fe,0,O.values,Pe);else{let ve=J-j*2;for(let Te=0;Te<ve;++Te)O.values[Pe+Te]-=fe[Te]}}}return b.blendMode=Pi,b}let uV={convertArray:Yu,isTypedArray:pI,getKeyframeOrder:mI,sortedArray:j_,flattenJSON:Q_,subclip:cV,makeClipAdditive:lV};class cm{constructor(r,a,d,g){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=g!==void 0?g:new a.constructor(d),this.sampleValues=a,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(r){let a=this.parameterPositions,d=this._cachedIndex,g=a[d],_=a[d-1];n:{e:{let C;t:{i:if(!(r<g)){for(let S=d+2;;){if(g===void 0){if(r<_)break i;return d=a.length,this._cachedIndex=d,this.copySampleValue_(d-1)}if(d===S)break;if(_=g,g=a[++d],r<g)break e}C=a.length;break t}if(!(r>=_)){let S=a[1];r<S&&(d=2,_=S);for(let B=d-2;;){if(_===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(d===B)break;if(g=_,_=a[--d-1],r>=_)break e}C=d,d=0;break t}break n}for(;d<C;){let S=d+C>>>1;r<a[S]?C=S:d=S+1}if(g=a[d],_=a[d-1],_===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(g===void 0)return d=a.length,this._cachedIndex=d,this.copySampleValue_(d-1)}this._cachedIndex=d,this.intervalChanged_(d,_,g)}return this.interpolate_(d,_,r,g)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(r){let a=this.resultBuffer,d=this.sampleValues,g=this.valueSize,_=r*g;for(let C=0;C!==g;++C)a[C]=d[_+C];return a}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class gI extends cm{constructor(r,a,d,g){super(r,a,d,g),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ri,endingEnd:ri}}intervalChanged_(r,a,d){let g=this.parameterPositions,_=r-2,C=r+1,S=g[_],B=g[C];if(S===void 0)switch(this.getSettings_().endingStart){case On:_=r,S=2*a-d;break;case oi:_=g.length-2,S=a+g[_]-g[_+1];break;default:_=r,S=d}if(B===void 0)switch(this.getSettings_().endingEnd){case On:C=r,B=2*d-a;break;case oi:C=1,B=d+g[1]-g[0];break;default:C=r-1,B=a}let O=(d-a)*.5,H=this.valueSize;this._weightPrev=O/(a-S),this._weightNext=O/(B-d),this._offsetPrev=_*H,this._offsetNext=C*H}interpolate_(r,a,d,g){let _=this.resultBuffer,C=this.sampleValues,S=this.valueSize,B=r*S,O=B-S,H=this._offsetPrev,W=this._offsetNext,j=this._weightPrev,J=this._weightNext,ie=(d-a)/(g-a),fe=ie*ie,se=fe*ie,K=-j*se+2*j*fe-j*ie,Pe=(1+j)*se+(-1.5-2*j)*fe+(-.5+j)*ie+1,ve=(-1-J)*se+(1.5+J)*fe+.5*ie,Te=J*se-J*fe;for(let We=0;We!==S;++We)_[We]=K*C[H+We]+Pe*C[O+We]+ve*C[B+We]+Te*C[W+We];return _}}class X_ extends cm{constructor(r,a,d,g){super(r,a,d,g)}interpolate_(r,a,d,g){let _=this.resultBuffer,C=this.sampleValues,S=this.valueSize,B=r*S,O=B-S,H=(d-a)/(g-a),W=1-H;for(let j=0;j!==S;++j)_[j]=C[O+j]*W+C[B+j]*H;return _}}class AI extends cm{constructor(r,a,d,g){super(r,a,d,g)}interpolate_(r){return this.copySampleValue_(r-1)}}class Wa{constructor(r,a,d,g){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(a===void 0||a.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=Yu(a,this.TimeBufferType),this.values=Yu(d,this.ValueBufferType),this.setInterpolation(g||this.DefaultInterpolation)}static toJSON(r){let a=r.constructor,d;if(a.toJSON!==this.toJSON)d=a.toJSON(r);else{d={name:r.name,times:Yu(r.times,Array),values:Yu(r.values,Array)};let g=r.getInterpolation();g!==r.DefaultInterpolation&&(d.interpolation=g)}return d.type=r.ValueTypeName,d}InterpolantFactoryMethodDiscrete(r){return new AI(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodLinear(r){return new X_(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodSmooth(r){return new gI(this.times,this.values,this.getValueSize(),r)}setInterpolation(r){let a;switch(r){case Sn:a=this.InterpolantFactoryMethodDiscrete;break;case Jn:a=this.InterpolantFactoryMethodLinear;break;case Zn:a=this.InterpolantFactoryMethodSmooth;break}if(a===void 0){let d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(d);return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=a,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Sn;case this.InterpolantFactoryMethodLinear:return Jn;case this.InterpolantFactoryMethodSmooth:return Zn}}getValueSize(){return this.values.length/this.times.length}shift(r){if(r!==0){let a=this.times;for(let d=0,g=a.length;d!==g;++d)a[d]+=r}return this}scale(r){if(r!==1){let a=this.times;for(let d=0,g=a.length;d!==g;++d)a[d]*=r}return this}trim(r,a){let d=this.times,g=d.length,_=0,C=g-1;for(;_!==g&&d[_]<r;)++_;for(;C!==-1&&d[C]>a;)--C;if(++C,_!==0||C!==g){_>=C&&(C=Math.max(C,1),_=C-1);let S=this.getValueSize();this.times=d.slice(_,C),this.values=this.values.slice(_*S,C*S)}return this}validate(){let r=!0,a=this.getValueSize();a-Math.floor(a)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);let d=this.times,g=this.values,_=d.length;_===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let C=null;for(let S=0;S!==_;S++){let B=d[S];if(typeof B=="number"&&isNaN(B)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,S,B),r=!1;break}if(C!==null&&C>B){console.error("THREE.KeyframeTrack: Out of order keys.",this,S,B,C),r=!1;break}C=B}if(g!==void 0&&pI(g))for(let S=0,B=g.length;S!==B;++S){let O=g[S];if(isNaN(O)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,S,O),r=!1;break}}return r}optimize(){let r=this.times.slice(),a=this.values.slice(),d=this.getValueSize(),g=this.getInterpolation()===Zn,_=r.length-1,C=1;for(let S=1;S<_;++S){let B=!1,O=r[S],H=r[S+1];if(O!==H&&(S!==1||O!==r[0]))if(g)B=!0;else{let W=S*d,j=W-d,J=W+d;for(let ie=0;ie!==d;++ie){let fe=a[W+ie];if(fe!==a[j+ie]||fe!==a[J+ie]){B=!0;break}}}if(B){if(S!==C){r[C]=r[S];let W=S*d,j=C*d;for(let J=0;J!==d;++J)a[j+J]=a[W+J]}++C}}if(_>0){r[C]=r[_];for(let S=_*d,B=C*d,O=0;O!==d;++O)a[B+O]=a[S+O];++C}return C!==r.length?(this.times=r.slice(0,C),this.values=a.slice(0,C*d)):(this.times=r,this.values=a),this}clone(){let r=this.times.slice(),a=this.values.slice(),d=this.constructor,g=new d(this.name,r,a);return g.createInterpolant=this.createInterpolant,g}}Wa.prototype.TimeBufferType=Float32Array,Wa.prototype.ValueBufferType=Float32Array,Wa.prototype.DefaultInterpolation=Jn;class Ku extends Wa{}Ku.prototype.ValueTypeName="bool",Ku.prototype.ValueBufferType=Array,Ku.prototype.DefaultInterpolation=Sn,Ku.prototype.InterpolantFactoryMethodLinear=void 0,Ku.prototype.InterpolantFactoryMethodSmooth=void 0;class q_ extends Wa{}q_.prototype.ValueTypeName="color";class lm extends Wa{}lm.prototype.ValueTypeName="number";class vI extends cm{constructor(r,a,d,g){super(r,a,d,g)}interpolate_(r,a,d,g){let _=this.resultBuffer,C=this.sampleValues,S=this.valueSize,B=(d-a)/(g-a),O=r*S;for(let H=O+S;O!==H;O+=4)Ci.slerpFlat(_,0,C,O-S,C,O,B);return _}}class Dd extends Wa{InterpolantFactoryMethodLinear(r){return new vI(this.times,this.values,this.getValueSize(),r)}}Dd.prototype.ValueTypeName="quaternion",Dd.prototype.DefaultInterpolation=Jn,Dd.prototype.InterpolantFactoryMethodSmooth=void 0;class $u extends Wa{}$u.prototype.ValueTypeName="string",$u.prototype.ValueBufferType=Array,$u.prototype.DefaultInterpolation=Sn,$u.prototype.InterpolantFactoryMethodLinear=void 0,$u.prototype.InterpolantFactoryMethodSmooth=void 0;class um extends Wa{}um.prototype.ValueTypeName="vector";class hm{constructor(r,a=-1,d,g=ci){this.name=r,this.tracks=d,this.duration=a,this.blendMode=g,this.uuid=_o(),this.duration<0&&this.resetDuration()}static parse(r){let a=[],d=r.tracks,g=1/(r.fps||1);for(let C=0,S=d.length;C!==S;++C)a.push(dV(d[C]).scale(g));let _=new this(r.name,r.duration,a,r.blendMode);return _.uuid=r.uuid,_}static toJSON(r){let a=[],d=r.tracks,g={name:r.name,duration:r.duration,tracks:a,uuid:r.uuid,blendMode:r.blendMode};for(let _=0,C=d.length;_!==C;++_)a.push(Wa.toJSON(d[_]));return g}static CreateFromMorphTargetSequence(r,a,d,g){let _=a.length,C=[];for(let S=0;S<_;S++){let B=[],O=[];B.push((S+_-1)%_,S,(S+1)%_),O.push(0,1,0);let H=mI(B);B=j_(B,1,H),O=j_(O,1,H),!g&&B[0]===0&&(B.push(_),O.push(O[0])),C.push(new lm(".morphTargetInfluences["+a[S].name+"]",B,O).scale(1/d))}return new this(r,-1,C)}static findByName(r,a){let d=r;if(!Array.isArray(r)){let g=r;d=g.geometry&&g.geometry.animations||g.animations}for(let g=0;g<d.length;g++)if(d[g].name===a)return d[g];return null}static CreateClipsFromMorphTargetSequences(r,a,d){let g={},_=/^([\w-]*?)([\d]+)$/;for(let S=0,B=r.length;S<B;S++){let O=r[S],H=O.name.match(_);if(H&&H.length>1){let W=H[1],j=g[W];j||(g[W]=j=[]),j.push(O)}}let C=[];for(let S in g)C.push(this.CreateFromMorphTargetSequence(S,g[S],a,d));return C}static parseAnimation(r,a){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let d=function(W,j,J,ie,fe){if(J.length!==0){let se=[],K=[];Q_(J,se,K,ie),se.length!==0&&fe.push(new W(j,se,K))}},g=[],_=r.name||"default",C=r.fps||30,S=r.blendMode,B=r.length||-1,O=r.hierarchy||[];for(let W=0;W<O.length;W++){let j=O[W].keys;if(!(!j||j.length===0))if(j[0].morphTargets){let J={},ie;for(ie=0;ie<j.length;ie++)if(j[ie].morphTargets)for(let fe=0;fe<j[ie].morphTargets.length;fe++)J[j[ie].morphTargets[fe]]=-1;for(let fe in J){let se=[],K=[];for(let Pe=0;Pe!==j[ie].morphTargets.length;++Pe){let ve=j[ie];se.push(ve.time),K.push(ve.morphTarget===fe?1:0)}g.push(new lm(".morphTargetInfluence["+fe+"]",se,K))}B=J.length*C}else{let J=".bones["+a[W].name+"]";d(um,J+".position",j,"pos",g),d(Dd,J+".quaternion",j,"rot",g),d(um,J+".scale",j,"scl",g)}}return g.length===0?null:new this(_,B,g,S)}resetDuration(){let r=this.tracks,a=0;for(let d=0,g=r.length;d!==g;++d){let _=this.tracks[d];a=Math.max(a,_.times[_.times.length-1])}return this.duration=a,this}trim(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this}validate(){let r=!0;for(let a=0;a<this.tracks.length;a++)r=r&&this.tracks[a].validate();return r}optimize(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this}clone(){let r=[];for(let a=0;a<this.tracks.length;a++)r.push(this.tracks[a].clone());return new this.constructor(this.name,this.duration,r,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function hV(b){switch(b.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return lm;case"vector":case"vector2":case"vector3":case"vector4":return um;case"color":return q_;case"quaternion":return Dd;case"bool":case"boolean":return Ku;case"string":return $u}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+b)}function dV(b){if(b.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let r=hV(b.type);if(b.times===void 0){let a=[],d=[];Q_(b.keys,a,d,"value"),b.times=a,b.values=d}return r.parse!==void 0?r.parse(b):new r(b.name,b.times,b.values,b.interpolation)}let Ju={enabled:!1,files:{},add:function(b,r){this.enabled!==!1&&(this.files[b]=r)},get:function(b){if(this.enabled!==!1)return this.files[b]},remove:function(b){delete this.files[b]},clear:function(){this.files={}}};class Y_{constructor(r,a,d){let g=this,_=!1,C=0,S=0,B,O=[];this.onStart=void 0,this.onLoad=r,this.onProgress=a,this.onError=d,this.itemStart=function(H){S++,_===!1&&g.onStart!==void 0&&g.onStart(H,C,S),_=!0},this.itemEnd=function(H){C++,g.onProgress!==void 0&&g.onProgress(H,C,S),C===S&&(_=!1,g.onLoad!==void 0&&g.onLoad())},this.itemError=function(H){g.onError!==void 0&&g.onError(H)},this.resolveURL=function(H){return B?B(H):H},this.setURLModifier=function(H){return B=H,this},this.addHandler=function(H,W){return O.push(H,W),this},this.removeHandler=function(H){let W=O.indexOf(H);return W!==-1&&O.splice(W,2),this},this.getHandler=function(H){for(let W=0,j=O.length;W<j;W+=2){let J=O[W],ie=O[W+1];if(J.global&&(J.lastIndex=0),J.test(H))return ie}return null}}}let yI=new Y_,$o=(()=>{class b{constructor(a){this.manager=a!==void 0?a:yI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(a,d){let g=this;return new Promise(function(_,C){g.load(a,_,d,C)})}parse(){}setCrossOrigin(a){return this.crossOrigin=a,this}setWithCredentials(a){return this.withCredentials=a,this}setPath(a){return this.path=a,this}setResourcePath(a){return this.resourcePath=a,this}setRequestHeader(a){return this.requestHeader=a,this}}return b.DEFAULT_MATERIAL_NAME="__DEFAULT",b})(),kc={};class fV extends Error{constructor(r,a){super(r),this.response=a}}class Vc extends $o{constructor(r){super(r)}load(r,a,d,g){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);let _=Ju.get(r);if(_!==void 0)return this.manager.itemStart(r),setTimeout(()=>{a&&a(_),this.manager.itemEnd(r)},0),_;if(kc[r]!==void 0){kc[r].push({onLoad:a,onProgress:d,onError:g});return}kc[r]=[],kc[r].push({onLoad:a,onProgress:d,onError:g});let C=new Request(r,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),S=this.mimeType,B=this.responseType;fetch(C).then(O=>{if(O.status===200||O.status===0){if(O.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||O.body===void 0||O.body.getReader===void 0)return O;let H=kc[r],W=O.body.getReader(),j=O.headers.get("Content-Length")||O.headers.get("X-File-Size"),J=j?parseInt(j):0,ie=J!==0,fe=0,se=new ReadableStream({start(K){Pe();function Pe(){W.read().then(({done:ve,value:Te})=>{if(ve)K.close();else{fe+=Te.byteLength;let We=new ProgressEvent("progress",{lengthComputable:ie,loaded:fe,total:J});for(let qe=0,st=H.length;qe<st;qe++){let lt=H[qe];lt.onProgress&&lt.onProgress(We)}K.enqueue(Te),Pe()}})}}});return new Response(se)}else throw new fV(`fetch for "${O.url}" responded with ${O.status}: ${O.statusText}`,O)}).then(O=>{switch(B){case"arraybuffer":return O.arrayBuffer();case"blob":return O.blob();case"document":return O.text().then(H=>new DOMParser().parseFromString(H,S));case"json":return O.json();default:if(S===void 0)return O.text();{let W=/charset="?([^;"\s]*)"?/i.exec(S),j=W&&W[1]?W[1].toLowerCase():void 0,J=new TextDecoder(j);return O.arrayBuffer().then(ie=>J.decode(ie))}}}).then(O=>{Ju.add(r,O);let H=kc[r];delete kc[r];for(let W=0,j=H.length;W<j;W++){let J=H[W];J.onLoad&&J.onLoad(O)}}).catch(O=>{let H=kc[r];if(H===void 0)throw this.manager.itemError(r),O;delete kc[r];for(let W=0,j=H.length;W<j;W++){let J=H[W];J.onError&&J.onError(O)}this.manager.itemError(r)}).finally(()=>{this.manager.itemEnd(r)}),this.manager.itemStart(r)}setResponseType(r){return this.responseType=r,this}setMimeType(r){return this.mimeType=r,this}}class pV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=new Vc(this.manager);C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(r,function(S){try{a(_.parse(JSON.parse(S)))}catch(B){g?g(B):console.error(B),_.manager.itemError(r)}},d,g)}parse(r){let a=[];for(let d=0;d<r.length;d++){let g=hm.parse(r[d]);a.push(g)}return a}}class mV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=[],S=new Y0,B=new Vc(this.manager);B.setPath(this.path),B.setResponseType("arraybuffer"),B.setRequestHeader(this.requestHeader),B.setWithCredentials(_.withCredentials);let O=0;function H(W){B.load(r[W],function(j){let J=_.parse(j,!0);C[W]={width:J.width,height:J.height,format:J.format,mipmaps:J.mipmaps},O+=1,O===6&&(J.mipmapCount===1&&(S.minFilter=_t),S.image=C,S.format=J.format,S.needsUpdate=!0,a&&a(S))},d,g)}if(Array.isArray(r))for(let W=0,j=r.length;W<j;++W)H(W);else B.load(r,function(W){let j=_.parse(W,!0);if(j.isCubemap){let J=j.mipmaps.length/j.mipmapCount;for(let ie=0;ie<J;ie++){C[ie]={mipmaps:[]};for(let fe=0;fe<j.mipmapCount;fe++)C[ie].mipmaps.push(j.mipmaps[ie*j.mipmapCount+fe]),C[ie].format=j.format,C[ie].width=j.width,C[ie].height=j.height}S.image=C}else S.image.width=j.width,S.image.height=j.height,S.mipmaps=j.mipmaps;j.mipmapCount===1&&(S.minFilter=_t),S.format=j.format,S.needsUpdate=!0,a&&a(S)},d,g);return S}}class dm extends $o{constructor(r){super(r)}load(r,a,d,g){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);let _=this,C=Ju.get(r);if(C!==void 0)return _.manager.itemStart(r),setTimeout(function(){a&&a(C),_.manager.itemEnd(r)},0),C;let S=Uu("img");function B(){H(),Ju.add(r,this),a&&a(this),_.manager.itemEnd(r)}function O(W){H(),g&&g(W),_.manager.itemError(r),_.manager.itemEnd(r)}function H(){S.removeEventListener("load",B,!1),S.removeEventListener("error",O,!1)}return S.addEventListener("load",B,!1),S.addEventListener("error",O,!1),r.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(S.crossOrigin=this.crossOrigin),_.manager.itemStart(r),S.src=r,S}}class gV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=new jp;_.colorSpace=Gr;let C=new dm(this.manager);C.setCrossOrigin(this.crossOrigin),C.setPath(this.path);let S=0;function B(O){C.load(r[O],function(H){_.images[O]=H,S++,S===6&&(_.needsUpdate=!0,a&&a(_))},void 0,g)}for(let O=0;O<r.length;++O)B(O);return _}}class AV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=new Cd,S=new Vc(this.manager);return S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(_.withCredentials),S.load(r,function(B){let O;try{O=_.parse(B)}catch(H){if(g!==void 0)g(H);else{console.error(H);return}}O.image!==void 0?C.image=O.image:O.data!==void 0&&(C.image.width=O.width,C.image.height=O.height,C.image.data=O.data),C.wrapS=O.wrapS!==void 0?O.wrapS:Qe,C.wrapT=O.wrapT!==void 0?O.wrapT:Qe,C.magFilter=O.magFilter!==void 0?O.magFilter:_t,C.minFilter=O.minFilter!==void 0?O.minFilter:_t,C.anisotropy=O.anisotropy!==void 0?O.anisotropy:1,O.colorSpace!==void 0?C.colorSpace=O.colorSpace:O.encoding!==void 0&&(C.encoding=O.encoding),O.flipY!==void 0&&(C.flipY=O.flipY),O.format!==void 0&&(C.format=O.format),O.type!==void 0&&(C.type=O.type),O.mipmaps!==void 0&&(C.mipmaps=O.mipmaps,C.minFilter=Cn),O.mipmapCount===1&&(C.minFilter=_t),O.generateMipmaps!==void 0&&(C.generateMipmaps=O.generateMipmaps),C.needsUpdate=!0,a&&a(C,O)},d,g),C}}class vV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=new Es,C=new dm(this.manager);return C.setCrossOrigin(this.crossOrigin),C.setPath(this.path),C.load(r,function(S){_.image=S,_.needsUpdate=!0,a!==void 0&&a(_)},d,g),_}}class Ul extends Kr{constructor(r,a=1){super(),this.isLight=!0,this.type="Light",this.color=new jn(r),this.intensity=a}dispose(){}copy(r,a){return super.copy(r,a),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){let a=super.toJSON(r);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(a.object.distance=this.distance),this.angle!==void 0&&(a.object.angle=this.angle),this.decay!==void 0&&(a.object.decay=this.decay),this.penumbra!==void 0&&(a.object.penumbra=this.penumbra),this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON()),a}}class xI extends Ul{constructor(r,a,d){super(r,d),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new jn(a)}copy(r,a){return super.copy(r,a),this.groundColor.copy(r.groundColor),this}}let K_=new _i,EI=new Ye,_I=new Ye;class $_{constructor(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new nn(512,512),this.map=null,this.mapPass=null,this.matrix=new _i,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new R0,this._frameExtents=new nn(1,1),this._viewportCount=1,this._viewports=[new Mr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){let a=this.camera,d=this.matrix;EI.setFromMatrixPosition(r.matrixWorld),a.position.copy(EI),_I.setFromMatrixPosition(r.target.matrixWorld),a.lookAt(_I),a.updateMatrixWorld(),K_.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(K_),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(K_)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}}class yV extends $_{constructor(){super(new Ms(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(r){let a=this.camera,d=Tl*2*r.angle*this.focus,g=this.mapSize.width/this.mapSize.height,_=r.distance||a.far;(d!==a.fov||g!==a.aspect||_!==a.far)&&(a.fov=d,a.aspect=g,a.far=_,a.updateProjectionMatrix()),super.updateMatrices(r)}copy(r){return super.copy(r),this.focus=r.focus,this}}class bI extends Ul{constructor(r,a,d=0,g=Math.PI/3,_=0,C=2){super(r,a),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.target=new Kr,this.distance=d,this.angle=g,this.penumbra=_,this.decay=C,this.map=null,this.shadow=new yV}get power(){return this.intensity*Math.PI}set power(r){this.intensity=r/Math.PI}dispose(){this.shadow.dispose()}copy(r,a){return super.copy(r,a),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}let MI=new _i,fm=new Ye,J_=new Ye;class xV extends $_{constructor(){super(new Ms(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new nn(4,2),this._viewportCount=6,this._viewports=[new Mr(2,1,1,1),new Mr(0,1,1,1),new Mr(3,1,1,1),new Mr(1,1,1,1),new Mr(3,0,1,1),new Mr(1,0,1,1)],this._cubeDirections=[new Ye(1,0,0),new Ye(-1,0,0),new Ye(0,0,1),new Ye(0,0,-1),new Ye(0,1,0),new Ye(0,-1,0)],this._cubeUps=[new Ye(0,1,0),new Ye(0,1,0),new Ye(0,1,0),new Ye(0,1,0),new Ye(0,0,1),new Ye(0,0,-1)]}updateMatrices(r,a=0){let d=this.camera,g=this.matrix,_=r.distance||d.far;_!==d.far&&(d.far=_,d.updateProjectionMatrix()),fm.setFromMatrixPosition(r.matrixWorld),d.position.copy(fm),J_.copy(d.position),J_.add(this._cubeDirections[a]),d.up.copy(this._cubeUps[a]),d.lookAt(J_),d.updateMatrixWorld(),g.makeTranslation(-fm.x,-fm.y,-fm.z),MI.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MI)}}class wI extends Ul{constructor(r,a,d=0,g=2){super(r,a),this.isPointLight=!0,this.type="PointLight",this.distance=d,this.decay=g,this.shadow=new xV}get power(){return this.intensity*4*Math.PI}set power(r){this.intensity=r/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(r,a){return super.copy(r,a),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}}class EV extends $_{constructor(){super(new L0(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class CI extends Ul{constructor(r,a){super(r,a),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.target=new Kr,this.shadow=new EV}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}class SI extends Ul{constructor(r,a){super(r,a),this.isAmbientLight=!0,this.type="AmbientLight"}}class TI extends Ul{constructor(r,a,d=10,g=10){super(r,a),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=d,this.height=g}get power(){return this.intensity*this.width*this.height*Math.PI}set power(r){this.intensity=r/(this.width*this.height*Math.PI)}copy(r){return super.copy(r),this.width=r.width,this.height=r.height,this}toJSON(r){let a=super.toJSON(r);return a.object.width=this.width,a.object.height=this.height,a}}class II{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let r=0;r<9;r++)this.coefficients.push(new Ye)}set(r){for(let a=0;a<9;a++)this.coefficients[a].copy(r[a]);return this}zero(){for(let r=0;r<9;r++)this.coefficients[r].set(0,0,0);return this}getAt(r,a){let d=r.x,g=r.y,_=r.z,C=this.coefficients;return a.copy(C[0]).multiplyScalar(.282095),a.addScaledVector(C[1],.488603*g),a.addScaledVector(C[2],.488603*_),a.addScaledVector(C[3],.488603*d),a.addScaledVector(C[4],1.092548*(d*g)),a.addScaledVector(C[5],1.092548*(g*_)),a.addScaledVector(C[6],.315392*(3*_*_-1)),a.addScaledVector(C[7],1.092548*(d*_)),a.addScaledVector(C[8],.546274*(d*d-g*g)),a}getIrradianceAt(r,a){let d=r.x,g=r.y,_=r.z,C=this.coefficients;return a.copy(C[0]).multiplyScalar(.886227),a.addScaledVector(C[1],1.023328*g),a.addScaledVector(C[2],1.023328*_),a.addScaledVector(C[3],1.023328*d),a.addScaledVector(C[4],.858086*d*g),a.addScaledVector(C[5],.858086*g*_),a.addScaledVector(C[6],.743125*_*_-.247708),a.addScaledVector(C[7],.858086*d*_),a.addScaledVector(C[8],.429043*(d*d-g*g)),a}add(r){for(let a=0;a<9;a++)this.coefficients[a].add(r.coefficients[a]);return this}addScaledSH(r,a){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(r.coefficients[d],a);return this}scale(r){for(let a=0;a<9;a++)this.coefficients[a].multiplyScalar(r);return this}lerp(r,a){for(let d=0;d<9;d++)this.coefficients[d].lerp(r.coefficients[d],a);return this}equals(r){for(let a=0;a<9;a++)if(!this.coefficients[a].equals(r.coefficients[a]))return!1;return!0}copy(r){return this.set(r.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(r,a=0){let d=this.coefficients;for(let g=0;g<9;g++)d[g].fromArray(r,a+g*3);return this}toArray(r=[],a=0){let d=this.coefficients;for(let g=0;g<9;g++)d[g].toArray(r,a+g*3);return r}static getBasisAt(r,a){let d=r.x,g=r.y,_=r.z;a[0]=.282095,a[1]=.488603*g,a[2]=.488603*_,a[3]=.488603*d,a[4]=1.092548*d*g,a[5]=1.092548*g*_,a[6]=.315392*(3*_*_-1),a[7]=1.092548*d*_,a[8]=.546274*(d*d-g*g)}}class RI extends Ul{constructor(r=new II,a=1){super(void 0,a),this.isLightProbe=!0,this.sh=r}copy(r){return super.copy(r),this.sh.copy(r.sh),this}fromJSON(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this}toJSON(r){let a=super.toJSON(r);return a.object.sh=this.sh.toArray(),a}}class AA extends $o{constructor(r){super(r),this.textures={}}load(r,a,d,g){let _=this,C=new Vc(_.manager);C.setPath(_.path),C.setRequestHeader(_.requestHeader),C.setWithCredentials(_.withCredentials),C.load(r,function(S){try{a(_.parse(JSON.parse(S)))}catch(B){g?g(B):console.error(B),_.manager.itemError(r)}},d,g)}parse(r){let a=this.textures;function d(_){return a[_]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",_),a[_]}let g=AA.createMaterialFromType(r.type);if(r.uuid!==void 0&&(g.uuid=r.uuid),r.name!==void 0&&(g.name=r.name),r.color!==void 0&&g.color!==void 0&&g.color.setHex(r.color),r.roughness!==void 0&&(g.roughness=r.roughness),r.metalness!==void 0&&(g.metalness=r.metalness),r.sheen!==void 0&&(g.sheen=r.sheen),r.sheenColor!==void 0&&(g.sheenColor=new jn().setHex(r.sheenColor)),r.sheenRoughness!==void 0&&(g.sheenRoughness=r.sheenRoughness),r.emissive!==void 0&&g.emissive!==void 0&&g.emissive.setHex(r.emissive),r.specular!==void 0&&g.specular!==void 0&&g.specular.setHex(r.specular),r.specularIntensity!==void 0&&(g.specularIntensity=r.specularIntensity),r.specularColor!==void 0&&g.specularColor!==void 0&&g.specularColor.setHex(r.specularColor),r.shininess!==void 0&&(g.shininess=r.shininess),r.clearcoat!==void 0&&(g.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(g.clearcoatRoughness=r.clearcoatRoughness),r.iridescence!==void 0&&(g.iridescence=r.iridescence),r.iridescenceIOR!==void 0&&(g.iridescenceIOR=r.iridescenceIOR),r.iridescenceThicknessRange!==void 0&&(g.iridescenceThicknessRange=r.iridescenceThicknessRange),r.transmission!==void 0&&(g.transmission=r.transmission),r.thickness!==void 0&&(g.thickness=r.thickness),r.attenuationDistance!==void 0&&(g.attenuationDistance=r.attenuationDistance),r.attenuationColor!==void 0&&g.attenuationColor!==void 0&&g.attenuationColor.setHex(r.attenuationColor),r.anisotropy!==void 0&&(g.anisotropy=r.anisotropy),r.anisotropyRotation!==void 0&&(g.anisotropyRotation=r.anisotropyRotation),r.fog!==void 0&&(g.fog=r.fog),r.flatShading!==void 0&&(g.flatShading=r.flatShading),r.blending!==void 0&&(g.blending=r.blending),r.combine!==void 0&&(g.combine=r.combine),r.side!==void 0&&(g.side=r.side),r.shadowSide!==void 0&&(g.shadowSide=r.shadowSide),r.opacity!==void 0&&(g.opacity=r.opacity),r.transparent!==void 0&&(g.transparent=r.transparent),r.alphaTest!==void 0&&(g.alphaTest=r.alphaTest),r.alphaHash!==void 0&&(g.alphaHash=r.alphaHash),r.depthFunc!==void 0&&(g.depthFunc=r.depthFunc),r.depthTest!==void 0&&(g.depthTest=r.depthTest),r.depthWrite!==void 0&&(g.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(g.colorWrite=r.colorWrite),r.blendSrc!==void 0&&(g.blendSrc=r.blendSrc),r.blendDst!==void 0&&(g.blendDst=r.blendDst),r.blendEquation!==void 0&&(g.blendEquation=r.blendEquation),r.blendSrcAlpha!==void 0&&(g.blendSrcAlpha=r.blendSrcAlpha),r.blendDstAlpha!==void 0&&(g.blendDstAlpha=r.blendDstAlpha),r.blendEquationAlpha!==void 0&&(g.blendEquationAlpha=r.blendEquationAlpha),r.blendColor!==void 0&&g.blendColor!==void 0&&g.blendColor.setHex(r.blendColor),r.blendAlpha!==void 0&&(g.blendAlpha=r.blendAlpha),r.stencilWriteMask!==void 0&&(g.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(g.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(g.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(g.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(g.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(g.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(g.stencilZPass=r.stencilZPass),r.stencilWrite!==void 0&&(g.stencilWrite=r.stencilWrite),r.wireframe!==void 0&&(g.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(g.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(g.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(g.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(g.rotation=r.rotation),r.linewidth!==void 0&&(g.linewidth=r.linewidth),r.dashSize!==void 0&&(g.dashSize=r.dashSize),r.gapSize!==void 0&&(g.gapSize=r.gapSize),r.scale!==void 0&&(g.scale=r.scale),r.polygonOffset!==void 0&&(g.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(g.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(g.polygonOffsetUnits=r.polygonOffsetUnits),r.dithering!==void 0&&(g.dithering=r.dithering),r.alphaToCoverage!==void 0&&(g.alphaToCoverage=r.alphaToCoverage),r.premultipliedAlpha!==void 0&&(g.premultipliedAlpha=r.premultipliedAlpha),r.forceSinglePass!==void 0&&(g.forceSinglePass=r.forceSinglePass),r.visible!==void 0&&(g.visible=r.visible),r.toneMapped!==void 0&&(g.toneMapped=r.toneMapped),r.userData!==void 0&&(g.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?g.vertexColors=r.vertexColors>0:g.vertexColors=r.vertexColors),r.uniforms!==void 0)for(let _ in r.uniforms){let C=r.uniforms[_];switch(g.uniforms[_]={},C.type){case"t":g.uniforms[_].value=d(C.value);break;case"c":g.uniforms[_].value=new jn().setHex(C.value);break;case"v2":g.uniforms[_].value=new nn().fromArray(C.value);break;case"v3":g.uniforms[_].value=new Ye().fromArray(C.value);break;case"v4":g.uniforms[_].value=new Mr().fromArray(C.value);break;case"m3":g.uniforms[_].value=new Oi().fromArray(C.value);break;case"m4":g.uniforms[_].value=new _i().fromArray(C.value);break;default:g.uniforms[_].value=C.value}}if(r.defines!==void 0&&(g.defines=r.defines),r.vertexShader!==void 0&&(g.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(g.fragmentShader=r.fragmentShader),r.glslVersion!==void 0&&(g.glslVersion=r.glslVersion),r.extensions!==void 0)for(let _ in r.extensions)g.extensions[_]=r.extensions[_];if(r.lights!==void 0&&(g.lights=r.lights),r.clipping!==void 0&&(g.clipping=r.clipping),r.size!==void 0&&(g.size=r.size),r.sizeAttenuation!==void 0&&(g.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(g.map=d(r.map)),r.matcap!==void 0&&(g.matcap=d(r.matcap)),r.alphaMap!==void 0&&(g.alphaMap=d(r.alphaMap)),r.bumpMap!==void 0&&(g.bumpMap=d(r.bumpMap)),r.bumpScale!==void 0&&(g.bumpScale=r.bumpScale),r.normalMap!==void 0&&(g.normalMap=d(r.normalMap)),r.normalMapType!==void 0&&(g.normalMapType=r.normalMapType),r.normalScale!==void 0){let _=r.normalScale;Array.isArray(_)===!1&&(_=[_,_]),g.normalScale=new nn().fromArray(_)}return r.displacementMap!==void 0&&(g.displacementMap=d(r.displacementMap)),r.displacementScale!==void 0&&(g.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(g.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(g.roughnessMap=d(r.roughnessMap)),r.metalnessMap!==void 0&&(g.metalnessMap=d(r.metalnessMap)),r.emissiveMap!==void 0&&(g.emissiveMap=d(r.emissiveMap)),r.emissiveIntensity!==void 0&&(g.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(g.specularMap=d(r.specularMap)),r.specularIntensityMap!==void 0&&(g.specularIntensityMap=d(r.specularIntensityMap)),r.specularColorMap!==void 0&&(g.specularColorMap=d(r.specularColorMap)),r.envMap!==void 0&&(g.envMap=d(r.envMap)),r.envMapIntensity!==void 0&&(g.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(g.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(g.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(g.lightMap=d(r.lightMap)),r.lightMapIntensity!==void 0&&(g.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(g.aoMap=d(r.aoMap)),r.aoMapIntensity!==void 0&&(g.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(g.gradientMap=d(r.gradientMap)),r.clearcoatMap!==void 0&&(g.clearcoatMap=d(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(g.clearcoatRoughnessMap=d(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(g.clearcoatNormalMap=d(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(g.clearcoatNormalScale=new nn().fromArray(r.clearcoatNormalScale)),r.iridescenceMap!==void 0&&(g.iridescenceMap=d(r.iridescenceMap)),r.iridescenceThicknessMap!==void 0&&(g.iridescenceThicknessMap=d(r.iridescenceThicknessMap)),r.transmissionMap!==void 0&&(g.transmissionMap=d(r.transmissionMap)),r.thicknessMap!==void 0&&(g.thicknessMap=d(r.thicknessMap)),r.anisotropyMap!==void 0&&(g.anisotropyMap=d(r.anisotropyMap)),r.sheenColorMap!==void 0&&(g.sheenColorMap=d(r.sheenColorMap)),r.sheenRoughnessMap!==void 0&&(g.sheenRoughnessMap=d(r.sheenRoughnessMap)),g}setTextures(r){return this.textures=r,this}static createMaterialFromType(r){let a={ShadowMaterial:sI,SpriteMaterial:M_,RawShaderMaterial:oI,ShaderMaterial:dc,PointsMaterial:R_,MeshPhysicalMaterial:aI,MeshStandardMaterial:W_,MeshPhongMaterial:cI,MeshToonMaterial:lI,MeshNormalMaterial:uI,MeshLambertMaterial:hI,MeshDepthMaterial:x_,MeshDistanceMaterial:E_,MeshBasicMaterial:Bl,MeshMatcapMaterial:dI,LineDashedMaterial:fI,LineBasicMaterial:Co,Material:ho};return new a[r]}}class Z_{static decodeText(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let a="";for(let d=0,g=r.length;d<g;d++)a+=String.fromCharCode(r[d]);try{return decodeURIComponent(escape(a))}catch{return a}}static extractUrlBase(r){let a=r.lastIndexOf("/");return a===-1?"./":r.slice(0,a+1)}static resolveURL(r,a){return typeof r!="string"||r===""?"":(/^https?:\/\//i.test(a)&&/^\//.test(r)&&(a=a.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(r)||/^data:.*,.*$/i.test(r)||/^blob:.*$/i.test(r)?r:a+r)}}class DI extends Zi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(r){return super.copy(r),this.instanceCount=r.instanceCount,this}toJSON(){let r=super.toJSON();return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}}class LI extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=new Vc(_.manager);C.setPath(_.path),C.setRequestHeader(_.requestHeader),C.setWithCredentials(_.withCredentials),C.load(r,function(S){try{a(_.parse(JSON.parse(S)))}catch(B){g?g(B):console.error(B),_.manager.itemError(r)}},d,g)}parse(r){let a={},d={};function g(J,ie){if(a[ie]!==void 0)return a[ie];let se=J.interleavedBuffers[ie],K=_(J,se.buffer),Pe=Il(se.type,K),ve=new U0(Pe,se.stride);return ve.uuid=se.uuid,a[ie]=ve,ve}function _(J,ie){if(d[ie]!==void 0)return d[ie];let se=J.arrayBuffers[ie],K=new Uint32Array(se).buffer;return d[ie]=K,K}let C=r.isInstancedBufferGeometry?new DI:new Zi,S=r.data.index;if(S!==void 0){let J=Il(S.type,S.array);C.setIndex(new Wr(J,1))}let B=r.data.attributes;for(let J in B){let ie=B[J],fe;if(ie.isInterleavedBufferAttribute){let se=g(r.data,ie.data);fe=new Qu(se,ie.itemSize,ie.offset,ie.normalized)}else{let se=Il(ie.type,ie.array),K=ie.isInstancedBufferAttribute?Sd:Wr;fe=new K(se,ie.itemSize,ie.normalized)}ie.name!==void 0&&(fe.name=ie.name),ie.usage!==void 0&&fe.setUsage(ie.usage),ie.updateRange!==void 0&&(fe.updateRange.offset=ie.updateRange.offset,fe.updateRange.count=ie.updateRange.count),C.setAttribute(J,fe)}let O=r.data.morphAttributes;if(O)for(let J in O){let ie=O[J],fe=[];for(let se=0,K=ie.length;se<K;se++){let Pe=ie[se],ve;if(Pe.isInterleavedBufferAttribute){let Te=g(r.data,Pe.data);ve=new Qu(Te,Pe.itemSize,Pe.offset,Pe.normalized)}else{let Te=Il(Pe.type,Pe.array);ve=new Wr(Te,Pe.itemSize,Pe.normalized)}Pe.name!==void 0&&(ve.name=Pe.name),fe.push(ve)}C.morphAttributes[J]=fe}r.data.morphTargetsRelative&&(C.morphTargetsRelative=!0);let W=r.data.groups||r.data.drawcalls||r.data.offsets;if(W!==void 0)for(let J=0,ie=W.length;J!==ie;++J){let fe=W[J];C.addGroup(fe.start,fe.count,fe.materialIndex)}let j=r.data.boundingSphere;if(j!==void 0){let J=new Ye;j.center!==void 0&&J.fromArray(j.center),C.boundingSphere=new Uo(J,j.radius)}return r.name&&(C.name=r.name),r.userData&&(C.userData=r.userData),C}}class _V extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=this.path===""?Z_.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||C;let S=new Vc(this.manager);S.setPath(this.path),S.setRequestHeader(this.requestHeader),S.setWithCredentials(this.withCredentials),S.load(r,function(B){let O=null;try{O=JSON.parse(B)}catch(W){g!==void 0&&g(W),console.error("THREE:ObjectLoader: Can't parse "+r+".",W.message);return}let H=O.metadata;if(H===void 0||H.type===void 0||H.type.toLowerCase()==="geometry"){g!==void 0&&g(new Error("THREE.ObjectLoader: Can't load "+r)),console.error("THREE.ObjectLoader: Can't load "+r);return}_.parse(O,a)},d,g)}loadAsync(r,a){return So(this,null,function*(){let d=this,g=this.path===""?Z_.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||g;let _=new Vc(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);let C=yield _.loadAsync(r,a),S=JSON.parse(C),B=S.metadata;if(B===void 0||B.type===void 0||B.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+r);return yield d.parseAsync(S)})}parse(r,a){let d=this.parseAnimations(r.animations),g=this.parseShapes(r.shapes),_=this.parseGeometries(r.geometries,g),C=this.parseImages(r.images,function(){a!==void 0&&a(O)}),S=this.parseTextures(r.textures,C),B=this.parseMaterials(r.materials,S),O=this.parseObject(r.object,_,B,S,d),H=this.parseSkeletons(r.skeletons,O);if(this.bindSkeletons(O,H),a!==void 0){let W=!1;for(let j in C)if(C[j].data instanceof HTMLImageElement){W=!0;break}W===!1&&a(O)}return O}parseAsync(r){return So(this,null,function*(){let a=this.parseAnimations(r.animations),d=this.parseShapes(r.shapes),g=this.parseGeometries(r.geometries,d),_=yield this.parseImagesAsync(r.images),C=this.parseTextures(r.textures,_),S=this.parseMaterials(r.materials,C),B=this.parseObject(r.object,g,S,C,a),O=this.parseSkeletons(r.skeletons,B);return this.bindSkeletons(B,O),B})}parseShapes(r){let a={};if(r!==void 0)for(let d=0,g=r.length;d<g;d++){let _=new Xu().fromJSON(r[d]);a[_.uuid]=_}return a}parseSkeletons(r,a){let d={},g={};if(a.traverse(function(_){_.isBone&&(g[_.uuid]=_)}),r!==void 0)for(let _=0,C=r.length;_<C;_++){let S=new W0().fromJSON(r[_],g);d[S.uuid]=S}return d}parseGeometries(r,a){let d={};if(r!==void 0){let _=new LI;for(let C=0,S=r.length;C<S;C++){let B,O=r[C];switch(O.type){case"BufferGeometry":case"InstancedBufferGeometry":B=_.parse(O);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var g=new THREE.LegacyJSONLoader;B=g.parse(O,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:O.type in rI?B=rI[O.type].fromJSON(O,a):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${O.type}"`)}B.uuid=O.uuid,O.name!==void 0&&(B.name=O.name),O.userData!==void 0&&(B.userData=O.userData),d[O.uuid]=B}}return d}parseMaterials(r,a){let d={},g={};if(r!==void 0){let _=new AA;_.setTextures(a);for(let C=0,S=r.length;C<S;C++){let B=r[C];d[B.uuid]===void 0&&(d[B.uuid]=_.parse(B)),g[B.uuid]=d[B.uuid]}}return g}parseAnimations(r){let a={};if(r!==void 0)for(let d=0;d<r.length;d++){let g=r[d],_=hm.parse(g);a[_.uuid]=_}return a}parseImages(r,a){let d=this,g={},_;function C(B){return d.manager.itemStart(B),_.load(B,function(){d.manager.itemEnd(B)},void 0,function(){d.manager.itemError(B),d.manager.itemEnd(B)})}function S(B){if(typeof B=="string"){let O=B,H=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O)?O:d.resourcePath+O;return C(H)}else return B.data?{data:Il(B.type,B.data),width:B.width,height:B.height}:null}if(r!==void 0&&r.length>0){let B=new Y_(a);_=new dm(B),_.setCrossOrigin(this.crossOrigin);for(let O=0,H=r.length;O<H;O++){let W=r[O],j=W.url;if(Array.isArray(j)){let J=[];for(let ie=0,fe=j.length;ie<fe;ie++){let se=j[ie],K=S(se);K!==null&&(K instanceof HTMLImageElement?J.push(K):J.push(new Cd(K.data,K.width,K.height)))}g[W.uuid]=new Yr(J)}else{let J=S(W.url);g[W.uuid]=new Yr(J)}}}return g}parseImagesAsync(r){return So(this,null,function*(){let a=this,d={},g;function _(C){return So(this,null,function*(){if(typeof C=="string"){let S=C,B=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(S)?S:a.resourcePath+S;return yield g.loadAsync(B)}else return C.data?{data:Il(C.type,C.data),width:C.width,height:C.height}:null})}if(r!==void 0&&r.length>0){g=new dm(this.manager),g.setCrossOrigin(this.crossOrigin);for(let C=0,S=r.length;C<S;C++){let B=r[C],O=B.url;if(Array.isArray(O)){let H=[];for(let W=0,j=O.length;W<j;W++){let J=O[W],ie=yield _(J);ie!==null&&(ie instanceof HTMLImageElement?H.push(ie):H.push(new Cd(ie.data,ie.width,ie.height)))}d[B.uuid]=new Yr(H)}else{let H=yield _(B.url);d[B.uuid]=new Yr(H)}}}return d})}parseTextures(r,a){function d(_,C){return typeof _=="number"?_:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",_),C[_])}let g={};if(r!==void 0)for(let _=0,C=r.length;_<C;_++){let S=r[_];S.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',S.uuid),a[S.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",S.image);let B=a[S.image],O=B.data,H;Array.isArray(O)?(H=new jp,O.length===6&&(H.needsUpdate=!0)):(O&&O.data?H=new Cd:H=new Es,O&&(H.needsUpdate=!0)),H.source=B,H.uuid=S.uuid,S.name!==void 0&&(H.name=S.name),S.mapping!==void 0&&(H.mapping=d(S.mapping,bV)),S.channel!==void 0&&(H.channel=S.channel),S.offset!==void 0&&H.offset.fromArray(S.offset),S.repeat!==void 0&&H.repeat.fromArray(S.repeat),S.center!==void 0&&H.center.fromArray(S.center),S.rotation!==void 0&&(H.rotation=S.rotation),S.wrap!==void 0&&(H.wrapS=d(S.wrap[0],PI),H.wrapT=d(S.wrap[1],PI)),S.format!==void 0&&(H.format=S.format),S.internalFormat!==void 0&&(H.internalFormat=S.internalFormat),S.type!==void 0&&(H.type=S.type),S.colorSpace!==void 0&&(H.colorSpace=S.colorSpace),S.encoding!==void 0&&(H.encoding=S.encoding),S.minFilter!==void 0&&(H.minFilter=d(S.minFilter,BI)),S.magFilter!==void 0&&(H.magFilter=d(S.magFilter,BI)),S.anisotropy!==void 0&&(H.anisotropy=S.anisotropy),S.flipY!==void 0&&(H.flipY=S.flipY),S.generateMipmaps!==void 0&&(H.generateMipmaps=S.generateMipmaps),S.premultiplyAlpha!==void 0&&(H.premultiplyAlpha=S.premultiplyAlpha),S.unpackAlignment!==void 0&&(H.unpackAlignment=S.unpackAlignment),S.compareFunction!==void 0&&(H.compareFunction=S.compareFunction),S.userData!==void 0&&(H.userData=S.userData),g[S.uuid]=H}return g}parseObject(r,a,d,g,_){let C;function S(j){return a[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",j),a[j]}function B(j){if(j!==void 0){if(Array.isArray(j)){let J=[];for(let ie=0,fe=j.length;ie<fe;ie++){let se=j[ie];d[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",se),J.push(d[se])}return J}return d[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",j),d[j]}}function O(j){return g[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",j),g[j]}let H,W;switch(r.type){case"Scene":C=new AT,r.background!==void 0&&(Number.isInteger(r.background)?C.background=new jn(r.background):C.background=O(r.background)),r.environment!==void 0&&(C.environment=O(r.environment)),r.fog!==void 0&&(r.fog.type==="Fog"?C.fog=new F0(r.fog.color,r.fog.near,r.fog.far):r.fog.type==="FogExp2"&&(C.fog=new N0(r.fog.color,r.fog.density)),r.fog.name!==""&&(C.fog.name=r.fog.name)),r.backgroundBlurriness!==void 0&&(C.backgroundBlurriness=r.backgroundBlurriness),r.backgroundIntensity!==void 0&&(C.backgroundIntensity=r.backgroundIntensity);break;case"PerspectiveCamera":C=new Ms(r.fov,r.aspect,r.near,r.far),r.focus!==void 0&&(C.focus=r.focus),r.zoom!==void 0&&(C.zoom=r.zoom),r.filmGauge!==void 0&&(C.filmGauge=r.filmGauge),r.filmOffset!==void 0&&(C.filmOffset=r.filmOffset),r.view!==void 0&&(C.view=Object.assign({},r.view));break;case"OrthographicCamera":C=new L0(r.left,r.right,r.top,r.bottom,r.near,r.far),r.zoom!==void 0&&(C.zoom=r.zoom),r.view!==void 0&&(C.view=Object.assign({},r.view));break;case"AmbientLight":C=new SI(r.color,r.intensity);break;case"DirectionalLight":C=new CI(r.color,r.intensity);break;case"PointLight":C=new wI(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":C=new TI(r.color,r.intensity,r.width,r.height);break;case"SpotLight":C=new bI(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":C=new xI(r.color,r.groundColor,r.intensity);break;case"LightProbe":C=new RI().fromJSON(r);break;case"SkinnedMesh":H=S(r.geometry),W=B(r.material),C=new IT(H,W),r.bindMode!==void 0&&(C.bindMode=r.bindMode),r.bindMatrix!==void 0&&C.bindMatrix.fromArray(r.bindMatrix),r.skeleton!==void 0&&(C.skeleton=r.skeleton);break;case"Mesh":H=S(r.geometry),W=B(r.material),C=new qs(H,W);break;case"InstancedMesh":H=S(r.geometry),W=B(r.material);let j=r.count,J=r.instanceMatrix,ie=r.instanceColor;C=new PT(H,W,j),C.instanceMatrix=new Sd(new Float32Array(J.array),16),ie!==void 0&&(C.instanceColor=new Sd(new Float32Array(ie.array),ie.itemSize));break;case"LOD":C=new bT;break;case"Line":C=new Nl(S(r.geometry),B(r.material));break;case"LineLoop":C=new kT(S(r.geometry),B(r.material));break;case"LineSegments":C=new fc(S(r.geometry),B(r.material));break;case"PointCloud":case"Points":C=new HT(S(r.geometry),B(r.material));break;case"Sprite":C=new ET(B(r.material));break;case"Group":C=new ju;break;case"Bone":C=new T_;break;default:C=new Kr}if(C.uuid=r.uuid,r.name!==void 0&&(C.name=r.name),r.matrix!==void 0?(C.matrix.fromArray(r.matrix),r.matrixAutoUpdate!==void 0&&(C.matrixAutoUpdate=r.matrixAutoUpdate),C.matrixAutoUpdate&&C.matrix.decompose(C.position,C.quaternion,C.scale)):(r.position!==void 0&&C.position.fromArray(r.position),r.rotation!==void 0&&C.rotation.fromArray(r.rotation),r.quaternion!==void 0&&C.quaternion.fromArray(r.quaternion),r.scale!==void 0&&C.scale.fromArray(r.scale)),r.up!==void 0&&C.up.fromArray(r.up),r.castShadow!==void 0&&(C.castShadow=r.castShadow),r.receiveShadow!==void 0&&(C.receiveShadow=r.receiveShadow),r.shadow&&(r.shadow.bias!==void 0&&(C.shadow.bias=r.shadow.bias),r.shadow.normalBias!==void 0&&(C.shadow.normalBias=r.shadow.normalBias),r.shadow.radius!==void 0&&(C.shadow.radius=r.shadow.radius),r.shadow.mapSize!==void 0&&C.shadow.mapSize.fromArray(r.shadow.mapSize),r.shadow.camera!==void 0&&(C.shadow.camera=this.parseObject(r.shadow.camera))),r.visible!==void 0&&(C.visible=r.visible),r.frustumCulled!==void 0&&(C.frustumCulled=r.frustumCulled),r.renderOrder!==void 0&&(C.renderOrder=r.renderOrder),r.userData!==void 0&&(C.userData=r.userData),r.layers!==void 0&&(C.layers.mask=r.layers),r.children!==void 0){let j=r.children;for(let J=0;J<j.length;J++)C.add(this.parseObject(j[J],a,d,g,_))}if(r.animations!==void 0){let j=r.animations;for(let J=0;J<j.length;J++){let ie=j[J];C.animations.push(_[ie])}}if(r.type==="LOD"){r.autoUpdate!==void 0&&(C.autoUpdate=r.autoUpdate);let j=r.levels;for(let J=0;J<j.length;J++){let ie=j[J],fe=C.getObjectByProperty("uuid",ie.object);fe!==void 0&&C.addLevel(fe,ie.distance,ie.hysteresis)}}return C}bindSkeletons(r,a){Object.keys(a).length!==0&&r.traverse(function(d){if(d.isSkinnedMesh===!0&&d.skeleton!==void 0){let g=a[d.skeleton];g===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(g,d.bindMatrix)}})}}let bV={UVMapping:ze,CubeReflectionMapping:Ge,CubeRefractionMapping:ee,EquirectangularReflectionMapping:V,EquirectangularRefractionMapping:G,CubeUVReflectionMapping:pe},PI={RepeatWrapping:Ue,ClampToEdgeWrapping:Qe,MirroredRepeatWrapping:$e},BI={NearestFilter:nt,NearestMipmapNearestFilter:ge,NearestMipmapLinearFilter:et,LinearFilter:_t,LinearMipmapNearestFilter:tn,LinearMipmapLinearFilter:Cn};class MV extends $o{constructor(r){super(r),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(r){return this.options=r,this}load(r,a,d,g){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);let _=this,C=Ju.get(r);if(C!==void 0)return _.manager.itemStart(r),setTimeout(function(){a&&a(C),_.manager.itemEnd(r)},0),C;let S={};S.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",S.headers=this.requestHeader,fetch(r,S).then(function(B){return B.blob()}).then(function(B){return createImageBitmap(B,Object.assign(_.options,{colorSpaceConversion:"none"}))}).then(function(B){Ju.add(r,B),a&&a(B),_.manager.itemEnd(r)}).catch(function(B){g&&g(B),_.manager.itemError(r),_.manager.itemEnd(r)}),_.manager.itemStart(r)}}let vA;class e1{static getContext(){return vA===void 0&&(vA=new(window.AudioContext||window.webkitAudioContext)),vA}static setContext(r){vA=r}}class wV extends $o{constructor(r){super(r)}load(r,a,d,g){let _=this,C=new Vc(this.manager);C.setResponseType("arraybuffer"),C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(r,function(B){try{let O=B.slice(0);e1.getContext().decodeAudioData(O,function(W){a(W)},S)}catch(O){S(O)}},d,g);function S(B){g?g(B):console.error(B),_.manager.itemError(r)}}}let OI=new _i,NI=new _i,Zu=new _i;class CV{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ms,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ms,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(r){let a=this._cache;if(a.focus!==r.focus||a.fov!==r.fov||a.aspect!==r.aspect*this.aspect||a.near!==r.near||a.far!==r.far||a.zoom!==r.zoom||a.eyeSep!==this.eyeSep){a.focus=r.focus,a.fov=r.fov,a.aspect=r.aspect*this.aspect,a.near=r.near,a.far=r.far,a.zoom=r.zoom,a.eyeSep=this.eyeSep,Zu.copy(r.projectionMatrix);let g=a.eyeSep/2,_=g*a.near/a.focus,C=a.near*Math.tan(Dc*a.fov*.5)/a.zoom,S,B;NI.elements[12]=-g,OI.elements[12]=g,S=-C*a.aspect+_,B=C*a.aspect+_,Zu.elements[0]=2*a.near/(B-S),Zu.elements[8]=(B+S)/(B-S),this.cameraL.projectionMatrix.copy(Zu),S=-C*a.aspect-_,B=C*a.aspect-_,Zu.elements[0]=2*a.near/(B-S),Zu.elements[8]=(B+S)/(B-S),this.cameraR.projectionMatrix.copy(Zu)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(NI),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(OI)}}class FI{constructor(r=!0){this.autoStart=r,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=UI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let a=UI();r=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=r}return r}}function UI(){return(typeof performance>"u"?Date:performance).now()}let eh=new Ye,kI=new Ci,SV=new Ye,th=new Ye;class TV extends Kr{constructor(){super(),this.type="AudioListener",this.context=e1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new FI}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(r){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=r,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}updateMatrixWorld(r){super.updateMatrixWorld(r);let a=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(eh,kI,SV),th.set(0,0,-1).applyQuaternion(kI),a.positionX){let g=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(eh.x,g),a.positionY.linearRampToValueAtTime(eh.y,g),a.positionZ.linearRampToValueAtTime(eh.z,g),a.forwardX.linearRampToValueAtTime(th.x,g),a.forwardY.linearRampToValueAtTime(th.y,g),a.forwardZ.linearRampToValueAtTime(th.z,g),a.upX.linearRampToValueAtTime(d.x,g),a.upY.linearRampToValueAtTime(d.y,g),a.upZ.linearRampToValueAtTime(d.z,g)}else a.setPosition(eh.x,eh.y,eh.z),a.setOrientation(th.x,th.y,th.z,d.x,d.y,d.z)}}class VI extends Kr{constructor(r){super(),this.type="Audio",this.listener=r,this.context=r.context,this.gain=this.context.createGain(),this.gain.connect(r.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(r){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=r,this.connect(),this}setMediaElementSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(r),this.connect(),this}setMediaStreamSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(r),this.connect(),this}setBuffer(r){return this.buffer=r,this.sourceType="buffer",this.autoplay&&this.play(),this}play(r=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+r;let a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let r=1,a=this.filters.length;r<a;r++)this.filters[r-1].connect(this.filters[r]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let r=1,a=this.filters.length;r<a;r++)this.filters[r-1].disconnect(this.filters[r]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(r){return r||(r=[]),this._connected===!0?(this.disconnect(),this.filters=r.slice(),this.connect()):this.filters=r.slice(),this}setDetune(r){if(this.detune=r,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(r){return this.setFilters(r?[r]:[])}setPlaybackRate(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=r,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=r,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(r){return this.loopStart=r,this}setLoopEnd(r){return this.loopEnd=r,this}getVolume(){return this.gain.gain.value}setVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}}let nh=new Ye,HI=new Ci,IV=new Ye,ih=new Ye;class RV extends VI{constructor(r){super(r),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(r){return this.panner.refDistance=r,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(r){return this.panner.rolloffFactor=r,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(r){return this.panner.distanceModel=r,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(r){return this.panner.maxDistance=r,this}setDirectionalCone(r,a,d){return this.panner.coneInnerAngle=r,this.panner.coneOuterAngle=a,this.panner.coneOuterGain=d,this}updateMatrixWorld(r){if(super.updateMatrixWorld(r),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(nh,HI,IV),ih.set(0,0,1).applyQuaternion(HI);let a=this.panner;if(a.positionX){let d=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(nh.x,d),a.positionY.linearRampToValueAtTime(nh.y,d),a.positionZ.linearRampToValueAtTime(nh.z,d),a.orientationX.linearRampToValueAtTime(ih.x,d),a.orientationY.linearRampToValueAtTime(ih.y,d),a.orientationZ.linearRampToValueAtTime(ih.z,d)}else a.setPosition(nh.x,nh.y,nh.z),a.setOrientation(ih.x,ih.y,ih.z)}}class DV{constructor(r,a=2048){this.analyser=r.context.createAnalyser(),this.analyser.fftSize=a,this.data=new Uint8Array(this.analyser.frequencyBinCount),r.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let r=0,a=this.getFrequencyData();for(let d=0;d<a.length;d++)r+=a[d];return r/a.length}}class zI{constructor(r,a,d){this.binding=r,this.valueSize=d;let g,_,C;switch(a){case"quaternion":g=this._slerp,_=this._slerpAdditive,C=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(d*6),this._workIndex=5;break;case"string":case"bool":g=this._select,_=this._select,C=this._setAdditiveIdentityOther,this.buffer=new Array(d*5);break;default:g=this._lerp,_=this._lerpAdditive,C=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(d*5)}this._mixBufferRegion=g,this._mixBufferRegionAdditive=_,this._setIdentity=C,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(r,a){let d=this.buffer,g=this.valueSize,_=r*g+g,C=this.cumulativeWeight;if(C===0){for(let S=0;S!==g;++S)d[_+S]=d[S];C=a}else{C+=a;let S=a/C;this._mixBufferRegion(d,_,0,S,g)}this.cumulativeWeight=C}accumulateAdditive(r){let a=this.buffer,d=this.valueSize,g=d*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(a,g,0,r,d),this.cumulativeWeightAdditive+=r}apply(r){let a=this.valueSize,d=this.buffer,g=r*a+a,_=this.cumulativeWeight,C=this.cumulativeWeightAdditive,S=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,_<1){let B=a*this._origIndex;this._mixBufferRegion(d,g,B,1-_,a)}C>0&&this._mixBufferRegionAdditive(d,g,this._addIndex*a,1,a);for(let B=a,O=a+a;B!==O;++B)if(d[B]!==d[B+a]){S.setValue(d,g);break}}saveOriginalState(){let r=this.binding,a=this.buffer,d=this.valueSize,g=d*this._origIndex;r.getValue(a,g);for(let _=d,C=g;_!==C;++_)a[_]=a[g+_%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let r=this.valueSize*3;this.binding.setValue(this.buffer,r)}_setAdditiveIdentityNumeric(){let r=this._addIndex*this.valueSize,a=r+this.valueSize;for(let d=r;d<a;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let r=this._origIndex*this.valueSize,a=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[a+d]=this.buffer[r+d]}_select(r,a,d,g,_){if(g>=.5)for(let C=0;C!==_;++C)r[a+C]=r[d+C]}_slerp(r,a,d,g){Ci.slerpFlat(r,a,r,a,r,d,g)}_slerpAdditive(r,a,d,g,_){let C=this._workIndex*_;Ci.multiplyQuaternionsFlat(r,C,r,a,r,d),Ci.slerpFlat(r,a,r,a,r,C,g)}_lerp(r,a,d,g,_){let C=1-g;for(let S=0;S!==_;++S){let B=a+S;r[B]=r[B]*C+r[d+S]*g}}_lerpAdditive(r,a,d,g,_){for(let C=0;C!==_;++C){let S=a+C;r[S]=r[S]+r[d+C]*g}}}let t1="\\[\\]\\.:\\/",LV=new RegExp("["+t1+"]","g"),n1="[^"+t1+"]",PV="[^"+t1.replace("\\.","")+"]",BV=/((?:WC+[\/:])*)/.source.replace("WC",n1),OV=/(WCOD+)?/.source.replace("WCOD",PV),NV=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",n1),FV=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",n1),UV=new RegExp("^"+BV+OV+NV+FV+"$"),kV=["material","materials","bones","map"];class VV{constructor(r,a,d){let g=d||Xr.parseTrackName(a);this._targetGroup=r,this._bindings=r.subscribe_(a,g)}getValue(r,a){this.bind();let d=this._targetGroup.nCachedObjects_,g=this._bindings[d];g!==void 0&&g.getValue(r,a)}setValue(r,a){let d=this._bindings;for(let g=this._targetGroup.nCachedObjects_,_=d.length;g!==_;++g)d[g].setValue(r,a)}bind(){let r=this._bindings;for(let a=this._targetGroup.nCachedObjects_,d=r.length;a!==d;++a)r[a].bind()}unbind(){let r=this._bindings;for(let a=this._targetGroup.nCachedObjects_,d=r.length;a!==d;++a)r[a].unbind()}}let Xr=(()=>{class b{constructor(a,d,g){this.path=d,this.parsedPath=g||b.parseTrackName(d),this.node=b.findNode(a,this.parsedPath.nodeName),this.rootNode=a,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(a,d,g){return a&&a.isAnimationObjectGroup?new b.Composite(a,d,g):new b(a,d,g)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(LV,"")}static parseTrackName(a){let d=UV.exec(a);if(d===null)throw new Error("PropertyBinding: Cannot parse trackName: "+a);let g={nodeName:d[2],objectName:d[3],objectIndex:d[4],propertyName:d[5],propertyIndex:d[6]},_=g.nodeName&&g.nodeName.lastIndexOf(".");if(_!==void 0&&_!==-1){let C=g.nodeName.substring(_+1);kV.indexOf(C)!==-1&&(g.nodeName=g.nodeName.substring(0,_),g.objectName=C)}if(g.propertyName===null||g.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+a);return g}static findNode(a,d){if(d===void 0||d===""||d==="."||d===-1||d===a.name||d===a.uuid)return a;if(a.skeleton){let g=a.skeleton.getBoneByName(d);if(g!==void 0)return g}if(a.children){let g=function(C){for(let S=0;S<C.length;S++){let B=C[S];if(B.name===d||B.uuid===d)return B;let O=g(B.children);if(O)return O}return null},_=g(a.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,d){a[d]=this.targetObject[this.propertyName]}_getValue_array(a,d){let g=this.resolvedProperty;for(let _=0,C=g.length;_!==C;++_)a[d++]=g[_]}_getValue_arrayElement(a,d){a[d]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,d){this.resolvedProperty.toArray(a,d)}_setValue_direct(a,d){this.targetObject[this.propertyName]=a[d]}_setValue_direct_setNeedsUpdate(a,d){this.targetObject[this.propertyName]=a[d],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,d){this.targetObject[this.propertyName]=a[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,d){let g=this.resolvedProperty;for(let _=0,C=g.length;_!==C;++_)g[_]=a[d++]}_setValue_array_setNeedsUpdate(a,d){let g=this.resolvedProperty;for(let _=0,C=g.length;_!==C;++_)g[_]=a[d++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,d){let g=this.resolvedProperty;for(let _=0,C=g.length;_!==C;++_)g[_]=a[d++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,d){this.resolvedProperty[this.propertyIndex]=a[d]}_setValue_arrayElement_setNeedsUpdate(a,d){this.resolvedProperty[this.propertyIndex]=a[d],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,d){this.resolvedProperty[this.propertyIndex]=a[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,d){this.resolvedProperty.fromArray(a,d)}_setValue_fromArray_setNeedsUpdate(a,d){this.resolvedProperty.fromArray(a,d),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,d){this.resolvedProperty.fromArray(a,d),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,d){this.bind(),this.getValue(a,d)}_setValue_unbound(a,d){this.bind(),this.setValue(a,d)}bind(){let a=this.node,d=this.parsedPath,g=d.objectName,_=d.propertyName,C=d.propertyIndex;if(a||(a=b.findNode(this.rootNode,d.nodeName),this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(g){let H=d.objectIndex;switch(g){case"materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case"bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(let W=0;W<a.length;W++)if(a[W].name===H){H=W;break}break;case"map":if("map"in a){a=a.map;break}if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}a=a.material.map;break;default:if(a[g]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[g]}if(H!==void 0){if(a[H]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[H]}}let S=a[_];if(S===void 0){let H=d.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+H+"."+_+" but it wasn't found.",a);return}let B=this.Versioning.None;this.targetObject=a,a.needsUpdate!==void 0?B=this.Versioning.NeedsUpdate:a.matrixWorldNeedsUpdate!==void 0&&(B=this.Versioning.MatrixWorldNeedsUpdate);let O=this.BindingType.Direct;if(C!==void 0){if(_==="morphTargetInfluences"){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}a.morphTargetDictionary[C]!==void 0&&(C=a.morphTargetDictionary[C])}O=this.BindingType.ArrayElement,this.resolvedProperty=S,this.propertyIndex=C}else S.fromArray!==void 0&&S.toArray!==void 0?(O=this.BindingType.HasFromToArray,this.resolvedProperty=S):Array.isArray(S)?(O=this.BindingType.EntireArray,this.resolvedProperty=S):this.propertyName=_;this.getValue=this.GetterByBindingType[O],this.setValue=this.SetterByBindingTypeAndVersioning[O][B]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return b.Composite=VV,b})();Xr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xr.prototype.GetterByBindingType=[Xr.prototype._getValue_direct,Xr.prototype._getValue_array,Xr.prototype._getValue_arrayElement,Xr.prototype._getValue_toArray],Xr.prototype.SetterByBindingTypeAndVersioning=[[Xr.prototype._setValue_direct,Xr.prototype._setValue_direct_setNeedsUpdate,Xr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_array,Xr.prototype._setValue_array_setNeedsUpdate,Xr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_arrayElement,Xr.prototype._setValue_arrayElement_setNeedsUpdate,Xr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_fromArray,Xr.prototype._setValue_fromArray_setNeedsUpdate,Xr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class HV{constructor(){this.isAnimationObjectGroup=!0,this.uuid=_o(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let r={};this._indicesByUUID=r;for(let d=0,g=arguments.length;d!==g;++d)r[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}add(){let r=this._objects,a=this._indicesByUUID,d=this._paths,g=this._parsedPaths,_=this._bindings,C=_.length,S,B=r.length,O=this.nCachedObjects_;for(let H=0,W=arguments.length;H!==W;++H){let j=arguments[H],J=j.uuid,ie=a[J];if(ie===void 0){ie=B++,a[J]=ie,r.push(j);for(let fe=0,se=C;fe!==se;++fe)_[fe].push(new Xr(j,d[fe],g[fe]))}else if(ie<O){S=r[ie];let fe=--O,se=r[fe];a[se.uuid]=ie,r[ie]=se,a[J]=fe,r[fe]=j;for(let K=0,Pe=C;K!==Pe;++K){let ve=_[K],Te=ve[fe],We=ve[ie];ve[ie]=Te,We===void 0&&(We=new Xr(j,d[K],g[K])),ve[fe]=We}}else r[ie]!==S&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=O}remove(){let r=this._objects,a=this._indicesByUUID,d=this._bindings,g=d.length,_=this.nCachedObjects_;for(let C=0,S=arguments.length;C!==S;++C){let B=arguments[C],O=B.uuid,H=a[O];if(H!==void 0&&H>=_){let W=_++,j=r[W];a[j.uuid]=H,r[H]=j,a[O]=W,r[W]=B;for(let J=0,ie=g;J!==ie;++J){let fe=d[J],se=fe[W],K=fe[H];fe[H]=se,fe[W]=K}}}this.nCachedObjects_=_}uncache(){let r=this._objects,a=this._indicesByUUID,d=this._bindings,g=d.length,_=this.nCachedObjects_,C=r.length;for(let S=0,B=arguments.length;S!==B;++S){let O=arguments[S],H=O.uuid,W=a[H];if(W!==void 0)if(delete a[H],W<_){let j=--_,J=r[j],ie=--C,fe=r[ie];a[J.uuid]=W,r[W]=J,a[fe.uuid]=j,r[j]=fe,r.pop();for(let se=0,K=g;se!==K;++se){let Pe=d[se],ve=Pe[j],Te=Pe[ie];Pe[W]=ve,Pe[j]=Te,Pe.pop()}}else{let j=--C,J=r[j];j>0&&(a[J.uuid]=W),r[W]=J,r.pop();for(let ie=0,fe=g;ie!==fe;++ie){let se=d[ie];se[W]=se[j],se.pop()}}}this.nCachedObjects_=_}subscribe_(r,a){let d=this._bindingsIndicesByPath,g=d[r],_=this._bindings;if(g!==void 0)return _[g];let C=this._paths,S=this._parsedPaths,B=this._objects,O=B.length,H=this.nCachedObjects_,W=new Array(O);g=_.length,d[r]=g,C.push(r),S.push(a),_.push(W);for(let j=H,J=B.length;j!==J;++j){let ie=B[j];W[j]=new Xr(ie,r,a)}return W}unsubscribe_(r){let a=this._bindingsIndicesByPath,d=a[r];if(d!==void 0){let g=this._paths,_=this._parsedPaths,C=this._bindings,S=C.length-1,B=C[S],O=r[S];a[O]=d,C[d]=B,C.pop(),_[d]=_[S],_.pop(),g[d]=g[S],g.pop()}}}class GI{constructor(r,a,d=null,g=a.blendMode){this._mixer=r,this._clip=a,this._localRoot=d,this.blendMode=g;let _=a.tracks,C=_.length,S=new Array(C),B={endingStart:ri,endingEnd:ri};for(let O=0;O!==C;++O){let H=_[O].createInterpolant(null);S[O]=H,H.settings=B}this._interpolantSettings=B,this._interpolants=S,this._propertyBindings=new Array(C),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Rn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(r){return this._startTime=r,this}setLoop(r,a){return this.loop=r,this.repetitions=a,this}setEffectiveWeight(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(r){return this._scheduleFading(r,0,1)}fadeOut(r){return this._scheduleFading(r,1,0)}crossFadeFrom(r,a,d){if(r.fadeOut(a),this.fadeIn(a),d){let g=this._clip.duration,_=r._clip.duration,C=_/g,S=g/_;r.warp(1,C,a),this.warp(S,1,a)}return this}crossFadeTo(r,a,d){return r.crossFadeFrom(this,a,d)}stopFading(){let r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}setEffectiveTimeScale(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(r){return this.timeScale=this._clip.duration/r,this.stopWarping()}syncWith(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()}halt(r){return this.warp(this._effectiveTimeScale,0,r)}warp(r,a,d){let g=this._mixer,_=g.time,C=this.timeScale,S=this._timeScaleInterpolant;S===null&&(S=g._lendControlInterpolant(),this._timeScaleInterpolant=S);let B=S.parameterPositions,O=S.sampleValues;return B[0]=_,B[1]=_+d,O[0]=r/C,O[1]=a/C,this}stopWarping(){let r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(r,a,d,g){if(!this.enabled){this._updateWeight(r);return}let _=this._startTime;if(_!==null){let B=(r-_)*d;B<0||d===0?a=0:(this._startTime=null,a=d*B)}a*=this._updateTimeScale(r);let C=this._updateTime(a),S=this._updateWeight(r);if(S>0){let B=this._interpolants,O=this._propertyBindings;switch(this.blendMode){case Pi:for(let H=0,W=B.length;H!==W;++H)B[H].evaluate(C),O[H].accumulateAdditive(S);break;case ci:default:for(let H=0,W=B.length;H!==W;++H)B[H].evaluate(C),O[H].accumulate(g,S)}}}_updateWeight(r){let a=0;if(this.enabled){a=this.weight;let d=this._weightInterpolant;if(d!==null){let g=d.evaluate(r)[0];a*=g,r>d.parameterPositions[1]&&(this.stopFading(),g===0&&(this.enabled=!1))}}return this._effectiveWeight=a,a}_updateTimeScale(r){let a=0;if(!this.paused){a=this.timeScale;let d=this._timeScaleInterpolant;if(d!==null){let g=d.evaluate(r)[0];a*=g,r>d.parameterPositions[1]&&(this.stopWarping(),a===0?this.paused=!0:this.timeScale=a)}}return this._effectiveTimeScale=a,a}_updateTime(r){let a=this._clip.duration,d=this.loop,g=this.time+r,_=this._loopCount,C=d===sn;if(r===0)return _===-1?g:C&&(_&1)===1?a-g:g;if(d===Wt){_===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));n:{if(g>=a)g=a;else if(g<0)g=0;else{this.time=g;break n}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{if(_===-1&&(r>=0?(_=0,this._setEndings(!0,this.repetitions===0,C)):this._setEndings(this.repetitions===0,!0,C)),g>=a||g<0){let S=Math.floor(g/a);g-=a*S,_+=Math.abs(S);let B=this.repetitions-_;if(B<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=r>0?a:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(B===1){let O=r<0;this._setEndings(O,!O,C)}else this._setEndings(!1,!1,C);this._loopCount=_,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:S})}}else this.time=g;if(C&&(_&1)===1)return a-g}return g}_setEndings(r,a,d){let g=this._interpolantSettings;d?(g.endingStart=On,g.endingEnd=On):(r?g.endingStart=this.zeroSlopeAtStart?On:ri:g.endingStart=oi,a?g.endingEnd=this.zeroSlopeAtEnd?On:ri:g.endingEnd=oi)}_scheduleFading(r,a,d){let g=this._mixer,_=g.time,C=this._weightInterpolant;C===null&&(C=g._lendControlInterpolant(),this._weightInterpolant=C);let S=C.parameterPositions,B=C.sampleValues;return S[0]=_,B[0]=a,S[1]=_+r,B[1]=d,this}}let zV=new Float32Array(1);class GV extends Eo{constructor(r){super(),this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(r,a){let d=r._localRoot||this._root,g=r._clip.tracks,_=g.length,C=r._propertyBindings,S=r._interpolants,B=d.uuid,O=this._bindingsByRootAndName,H=O[B];H===void 0&&(H={},O[B]=H);for(let W=0;W!==_;++W){let j=g[W],J=j.name,ie=H[J];if(ie!==void 0)++ie.referenceCount,C[W]=ie;else{if(ie=C[W],ie!==void 0){ie._cacheIndex===null&&(++ie.referenceCount,this._addInactiveBinding(ie,B,J));continue}let fe=a&&a._propertyBindings[W].binding.parsedPath;ie=new zI(Xr.create(d,J,fe),j.ValueTypeName,j.getValueSize()),++ie.referenceCount,this._addInactiveBinding(ie,B,J),C[W]=ie}S[W].resultBuffer=ie.buffer}}_activateAction(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){let d=(r._localRoot||this._root).uuid,g=r._clip.uuid,_=this._actionsByClip[g];this._bindAction(r,_&&_.knownActions[0]),this._addInactiveAction(r,g,d)}let a=r._propertyBindings;for(let d=0,g=a.length;d!==g;++d){let _=a[d];_.useCount++===0&&(this._lendBinding(_),_.saveOriginalState())}this._lendAction(r)}}_deactivateAction(r){if(this._isActiveAction(r)){let a=r._propertyBindings;for(let d=0,g=a.length;d!==g;++d){let _=a[d];--_.useCount===0&&(_.restoreOriginalState(),this._takeBackBinding(_))}this._takeBackAction(r)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}}_isActiveAction(r){let a=r._cacheIndex;return a!==null&&a<this._nActiveActions}_addInactiveAction(r,a,d){let g=this._actions,_=this._actionsByClip,C=_[a];if(C===void 0)C={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,_[a]=C;else{let S=C.knownActions;r._byClipCacheIndex=S.length,S.push(r)}r._cacheIndex=g.length,g.push(r),C.actionByRoot[d]=r}_removeInactiveAction(r){let a=this._actions,d=a[a.length-1],g=r._cacheIndex;d._cacheIndex=g,a[g]=d,a.pop(),r._cacheIndex=null;let _=r._clip.uuid,C=this._actionsByClip,S=C[_],B=S.knownActions,O=B[B.length-1],H=r._byClipCacheIndex;O._byClipCacheIndex=H,B[H]=O,B.pop(),r._byClipCacheIndex=null;let W=S.actionByRoot,j=(r._localRoot||this._root).uuid;delete W[j],B.length===0&&delete C[_],this._removeInactiveBindingsForAction(r)}_removeInactiveBindingsForAction(r){let a=r._propertyBindings;for(let d=0,g=a.length;d!==g;++d){let _=a[d];--_.referenceCount===0&&this._removeInactiveBinding(_)}}_lendAction(r){let a=this._actions,d=r._cacheIndex,g=this._nActiveActions++,_=a[g];r._cacheIndex=g,a[g]=r,_._cacheIndex=d,a[d]=_}_takeBackAction(r){let a=this._actions,d=r._cacheIndex,g=--this._nActiveActions,_=a[g];r._cacheIndex=g,a[g]=r,_._cacheIndex=d,a[d]=_}_addInactiveBinding(r,a,d){let g=this._bindingsByRootAndName,_=this._bindings,C=g[a];C===void 0&&(C={},g[a]=C),C[d]=r,r._cacheIndex=_.length,_.push(r)}_removeInactiveBinding(r){let a=this._bindings,d=r.binding,g=d.rootNode.uuid,_=d.path,C=this._bindingsByRootAndName,S=C[g],B=a[a.length-1],O=r._cacheIndex;B._cacheIndex=O,a[O]=B,a.pop(),delete S[_],Object.keys(S).length===0&&delete C[g]}_lendBinding(r){let a=this._bindings,d=r._cacheIndex,g=this._nActiveBindings++,_=a[g];r._cacheIndex=g,a[g]=r,_._cacheIndex=d,a[d]=_}_takeBackBinding(r){let a=this._bindings,d=r._cacheIndex,g=--this._nActiveBindings,_=a[g];r._cacheIndex=g,a[g]=r,_._cacheIndex=d,a[d]=_}_lendControlInterpolant(){let r=this._controlInterpolants,a=this._nActiveControlInterpolants++,d=r[a];return d===void 0&&(d=new X_(new Float32Array(2),new Float32Array(2),1,zV),d.__cacheIndex=a,r[a]=d),d}_takeBackControlInterpolant(r){let a=this._controlInterpolants,d=r.__cacheIndex,g=--this._nActiveControlInterpolants,_=a[g];r.__cacheIndex=g,a[g]=r,_.__cacheIndex=d,a[d]=_}clipAction(r,a,d){let g=a||this._root,_=g.uuid,C=typeof r=="string"?hm.findByName(g,r):r,S=C!==null?C.uuid:r,B=this._actionsByClip[S],O=null;if(d===void 0&&(C!==null?d=C.blendMode:d=ci),B!==void 0){let W=B.actionByRoot[_];if(W!==void 0&&W.blendMode===d)return W;O=B.knownActions[0],C===null&&(C=O._clip)}if(C===null)return null;let H=new GI(this,C,a,d);return this._bindAction(H,O),this._addInactiveAction(H,S,_),H}existingAction(r,a){let d=a||this._root,g=d.uuid,_=typeof r=="string"?hm.findByName(d,r):r,C=_?_.uuid:r,S=this._actionsByClip[C];return S!==void 0&&S.actionByRoot[g]||null}stopAllAction(){let r=this._actions,a=this._nActiveActions;for(let d=a-1;d>=0;--d)r[d].stop();return this}update(r){r*=this.timeScale;let a=this._actions,d=this._nActiveActions,g=this.time+=r,_=Math.sign(r),C=this._accuIndex^=1;for(let O=0;O!==d;++O)a[O]._update(g,r,_,C);let S=this._bindings,B=this._nActiveBindings;for(let O=0;O!==B;++O)S[O].apply(C);return this}setTime(r){this.time=0;for(let a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(r)}getRoot(){return this._root}uncacheClip(r){let a=this._actions,d=r.uuid,g=this._actionsByClip,_=g[d];if(_!==void 0){let C=_.knownActions;for(let S=0,B=C.length;S!==B;++S){let O=C[S];this._deactivateAction(O);let H=O._cacheIndex,W=a[a.length-1];O._cacheIndex=null,O._byClipCacheIndex=null,W._cacheIndex=H,a[H]=W,a.pop(),this._removeInactiveBindingsForAction(O)}delete g[d]}}uncacheRoot(r){let a=r.uuid,d=this._actionsByClip;for(let C in d){let S=d[C].actionByRoot,B=S[a];B!==void 0&&(this._deactivateAction(B),this._removeInactiveAction(B))}let g=this._bindingsByRootAndName,_=g[a];if(_!==void 0)for(let C in _){let S=_[C];S.restoreOriginalState(),this._removeInactiveBinding(S)}}uncacheAction(r,a){let d=this.existingAction(r,a);d!==null&&(this._deactivateAction(d),this._removeInactiveAction(d))}}class i1{constructor(r){this.value=r}clone(){return new i1(this.value.clone===void 0?this.value:this.value.clone())}}let WV=0;class jV extends Eo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:WV++}),this.name="",this.usage=Ou,this.uniforms=[]}add(r){return this.uniforms.push(r),this}remove(r){let a=this.uniforms.indexOf(r);return a!==-1&&this.uniforms.splice(a,1),this}setName(r){return this.name=r,this}setUsage(r){return this.usage=r,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(r){this.name=r.name,this.usage=r.usage;let a=r.uniforms;this.uniforms.length=0;for(let d=0,g=a.length;d<g;d++)this.uniforms.push(a[d].clone());return this}clone(){return new this.constructor().copy(this)}}class QV extends U0{constructor(r,a,d=1){super(r,a),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=d}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}clone(r){let a=super.clone(r);return a.meshPerAttribute=this.meshPerAttribute,a}toJSON(r){let a=super.toJSON(r);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a}}class XV{constructor(r,a,d,g,_){this.isGLBufferAttribute=!0,this.name="",this.buffer=r,this.type=a,this.itemSize=d,this.elementSize=g,this.count=_,this.version=0}set needsUpdate(r){r===!0&&this.version++}setBuffer(r){return this.buffer=r,this}setType(r,a){return this.type=r,this.elementSize=a,this}setItemSize(r){return this.itemSize=r,this}setCount(r){return this.count=r,this}}class qV{constructor(r,a,d=0,g=1/0){this.ray=new lo(r,a),this.near=d,this.far=g,this.camera=null,this.layers=new m0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(r,a){this.ray.set(r,a)}setFromCamera(r,a){a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type: "+a.type)}intersectObject(r,a=!0,d=[]){return r1(r,this,d,a),d.sort(WI),d}intersectObjects(r,a=!0,d=[]){for(let g=0,_=r.length;g<_;g++)r1(r[g],this,d,a);return d.sort(WI),d}}function WI(b,r){return b.distance-r.distance}function r1(b,r,a,d){if(b.layers.test(r.layers)&&b.raycast(r,a),d===!0){let g=b.children;for(let _=0,C=g.length;_<C;_++)r1(g[_],r,a,!0)}}class YV{constructor(r=1,a=0,d=0){return this.radius=r,this.phi=a,this.theta=d,this}set(r,a,d){return this.radius=r,this.phi=a,this.theta=d,this}copy(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,a,d){return this.radius=Math.sqrt(r*r+a*a+d*d),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r,d),this.phi=Math.acos(es(a/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class KV{constructor(r=1,a=0,d=0){return this.radius=r,this.theta=a,this.y=d,this}set(r,a,d){return this.radius=r,this.theta=a,this.y=d,this}copy(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,a,d){return this.radius=Math.sqrt(r*r+d*d),this.theta=Math.atan2(r,d),this.y=a,this}clone(){return new this.constructor().copy(this)}}let jI=new nn;class $V{constructor(r=new nn(1/0,1/0),a=new nn(-1/0,-1/0)){this.isBox2=!0,this.min=r,this.max=a}set(r,a){return this.min.copy(r),this.max.copy(a),this}setFromPoints(r){this.makeEmpty();for(let a=0,d=r.length;a<d;a++)this.expandByPoint(r[a]);return this}setFromCenterAndSize(r,a){let d=jI.copy(a).multiplyScalar(.5);return this.min.copy(r).sub(d),this.max.copy(r).add(d),this}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(r){return this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y}getParameter(r,a){return a.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)}clampPoint(r,a){return a.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,jI).distanceTo(r)}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}let QI=new Ye,yA=new Ye;class JV{constructor(r=new Ye,a=new Ye){this.start=r,this.end=a}set(r,a){return this.start.copy(r),this.end.copy(a),this}copy(r){return this.start.copy(r.start),this.end.copy(r.end),this}getCenter(r){return r.addVectors(this.start,this.end).multiplyScalar(.5)}delta(r){return r.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(r,a){return this.delta(a).multiplyScalar(r).add(this.start)}closestPointToPointParameter(r,a){QI.subVectors(r,this.start),yA.subVectors(this.end,this.start);let d=yA.dot(yA),_=yA.dot(QI)/d;return a&&(_=es(_,0,1)),_}closestPointToPoint(r,a,d){let g=this.closestPointToPointParameter(r,a);return this.delta(d).multiplyScalar(g).add(this.start)}applyMatrix4(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this}equals(r){return r.start.equals(this.start)&&r.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}let XI=new Ye;class ZV extends Kr{constructor(r,a){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="SpotLightHelper";let d=new Zi,g=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let C=0,S=1,B=32;C<B;C++,S++){let O=C/B*Math.PI*2,H=S/B*Math.PI*2;g.push(Math.cos(O),Math.sin(O),1,Math.cos(H),Math.sin(H),1)}d.setAttribute("position",new ni(g,3));let _=new Co({fog:!1,toneMapped:!1});this.cone=new fc(d,_),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let r=this.light.distance?this.light.distance:1e3,a=r*Math.tan(this.light.angle);this.cone.scale.set(a,a,r),XI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(XI),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}let kl=new Ye,xA=new _i,s1=new _i;class e7 extends fc{constructor(r){let a=qI(r),d=new Zi,g=[],_=[],C=new jn(0,0,1),S=new jn(0,1,0);for(let O=0;O<a.length;O++){let H=a[O];H.parent&&H.parent.isBone&&(g.push(0,0,0),g.push(0,0,0),_.push(C.r,C.g,C.b),_.push(S.r,S.g,S.b))}d.setAttribute("position",new ni(g,3)),d.setAttribute("color",new ni(_,3));let B=new Co({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(d,B),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=r,this.bones=a,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(r){let a=this.bones,d=this.geometry,g=d.getAttribute("position");s1.copy(this.root.matrixWorld).invert();for(let _=0,C=0;_<a.length;_++){let S=a[_];S.parent&&S.parent.isBone&&(xA.multiplyMatrices(s1,S.matrixWorld),kl.setFromMatrixPosition(xA),g.setXYZ(C,kl.x,kl.y,kl.z),xA.multiplyMatrices(s1,S.parent.matrixWorld),kl.setFromMatrixPosition(xA),g.setXYZ(C+1,kl.x,kl.y,kl.z),C+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(r)}dispose(){this.geometry.dispose(),this.material.dispose()}}function qI(b){let r=[];b.isBone===!0&&r.push(b);for(let a=0;a<b.children.length;a++)r.push.apply(r,qI(b.children[a]));return r}class t7 extends qs{constructor(r,a,d){let g=new am(a,4,2),_=new Bl({wireframe:!0,fog:!1,toneMapped:!1});super(g,_),this.light=r,this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}let n7=new Ye,YI=new jn,KI=new jn;class i7 extends Kr{constructor(r,a,d){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,this.type="HemisphereLightHelper";let g=new om(a);g.rotateY(Math.PI*.5),this.material=new Bl({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let _=g.getAttribute("position"),C=new Float32Array(_.count*3);g.setAttribute("color",new Wr(C,3)),this.add(new qs(g,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let r=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let a=r.geometry.getAttribute("color");YI.copy(this.light.color),KI.copy(this.light.groundColor);for(let d=0,g=a.count;d<g;d++){let _=d<g/2?YI:KI;a.setXYZ(d,_.r,_.g,_.b)}a.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),r.lookAt(n7.setFromMatrixPosition(this.light.matrixWorld).negate())}}class r7 extends fc{constructor(r=10,a=10,d=4473924,g=8947848){d=new jn(d),g=new jn(g);let _=a/2,C=r/a,S=r/2,B=[],O=[];for(let j=0,J=0,ie=-S;j<=a;j++,ie+=C){B.push(-S,0,ie,S,0,ie),B.push(ie,0,-S,ie,0,S);let fe=j===_?d:g;fe.toArray(O,J),J+=3,fe.toArray(O,J),J+=3,fe.toArray(O,J),J+=3,fe.toArray(O,J),J+=3}let H=new Zi;H.setAttribute("position",new ni(B,3)),H.setAttribute("color",new ni(O,3));let W=new Co({vertexColors:!0,toneMapped:!1});super(H,W),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class s7 extends fc{constructor(r=10,a=16,d=8,g=64,_=4473924,C=8947848){_=new jn(_),C=new jn(C);let S=[],B=[];if(a>1)for(let W=0;W<a;W++){let j=W/a*(Math.PI*2),J=Math.sin(j)*r,ie=Math.cos(j)*r;S.push(0,0,0),S.push(J,0,ie);let fe=W&1?_:C;B.push(fe.r,fe.g,fe.b),B.push(fe.r,fe.g,fe.b)}for(let W=0;W<d;W++){let j=W&1?_:C,J=r-r/d*W;for(let ie=0;ie<g;ie++){let fe=ie/g*(Math.PI*2),se=Math.sin(fe)*J,K=Math.cos(fe)*J;S.push(se,0,K),B.push(j.r,j.g,j.b),fe=(ie+1)/g*(Math.PI*2),se=Math.sin(fe)*J,K=Math.cos(fe)*J,S.push(se,0,K),B.push(j.r,j.g,j.b)}}let O=new Zi;O.setAttribute("position",new ni(S,3)),O.setAttribute("color",new ni(B,3));let H=new Co({vertexColors:!0,toneMapped:!1});super(O,H),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}let $I=new Ye,EA=new Ye,JI=new Ye;class o7 extends Kr{constructor(r,a,d){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,this.type="DirectionalLightHelper",a===void 0&&(a=1);let g=new Zi;g.setAttribute("position",new ni([-a,a,0,a,a,0,a,-a,0,-a,-a,0,-a,a,0],3));let _=new Co({fog:!1,toneMapped:!1});this.lightPlane=new Nl(g,_),this.add(this.lightPlane),g=new Zi,g.setAttribute("position",new ni([0,0,0,0,0,1],3)),this.targetLine=new Nl(g,_),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),$I.setFromMatrixPosition(this.light.matrixWorld),EA.setFromMatrixPosition(this.light.target.matrixWorld),JI.subVectors(EA,$I),this.lightPlane.lookAt(EA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(EA),this.targetLine.scale.z=JI.length()}}let _A=new Ye,as=new T0;class a7 extends fc{constructor(r){let a=new Zi,d=new Co({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],_=[],C={};S("n1","n2"),S("n2","n4"),S("n4","n3"),S("n3","n1"),S("f1","f2"),S("f2","f4"),S("f4","f3"),S("f3","f1"),S("n1","f1"),S("n2","f2"),S("n3","f3"),S("n4","f4"),S("p","n1"),S("p","n2"),S("p","n3"),S("p","n4"),S("u1","u2"),S("u2","u3"),S("u3","u1"),S("c","t"),S("p","c"),S("cn1","cn2"),S("cn3","cn4"),S("cf1","cf2"),S("cf3","cf4");function S(ie,fe){B(ie),B(fe)}function B(ie){g.push(0,0,0),_.push(0,0,0),C[ie]===void 0&&(C[ie]=[]),C[ie].push(g.length/3-1)}a.setAttribute("position",new ni(g,3)),a.setAttribute("color",new ni(_,3)),super(a,d),this.type="CameraHelper",this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=C,this.update();let O=new jn(16755200),H=new jn(16711680),W=new jn(43775),j=new jn(16777215),J=new jn(3355443);this.setColors(O,H,W,j,J)}setColors(r,a,d,g,_){let S=this.geometry.getAttribute("color");S.setXYZ(0,r.r,r.g,r.b),S.setXYZ(1,r.r,r.g,r.b),S.setXYZ(2,r.r,r.g,r.b),S.setXYZ(3,r.r,r.g,r.b),S.setXYZ(4,r.r,r.g,r.b),S.setXYZ(5,r.r,r.g,r.b),S.setXYZ(6,r.r,r.g,r.b),S.setXYZ(7,r.r,r.g,r.b),S.setXYZ(8,r.r,r.g,r.b),S.setXYZ(9,r.r,r.g,r.b),S.setXYZ(10,r.r,r.g,r.b),S.setXYZ(11,r.r,r.g,r.b),S.setXYZ(12,r.r,r.g,r.b),S.setXYZ(13,r.r,r.g,r.b),S.setXYZ(14,r.r,r.g,r.b),S.setXYZ(15,r.r,r.g,r.b),S.setXYZ(16,r.r,r.g,r.b),S.setXYZ(17,r.r,r.g,r.b),S.setXYZ(18,r.r,r.g,r.b),S.setXYZ(19,r.r,r.g,r.b),S.setXYZ(20,r.r,r.g,r.b),S.setXYZ(21,r.r,r.g,r.b),S.setXYZ(22,r.r,r.g,r.b),S.setXYZ(23,r.r,r.g,r.b),S.setXYZ(24,a.r,a.g,a.b),S.setXYZ(25,a.r,a.g,a.b),S.setXYZ(26,a.r,a.g,a.b),S.setXYZ(27,a.r,a.g,a.b),S.setXYZ(28,a.r,a.g,a.b),S.setXYZ(29,a.r,a.g,a.b),S.setXYZ(30,a.r,a.g,a.b),S.setXYZ(31,a.r,a.g,a.b),S.setXYZ(32,d.r,d.g,d.b),S.setXYZ(33,d.r,d.g,d.b),S.setXYZ(34,d.r,d.g,d.b),S.setXYZ(35,d.r,d.g,d.b),S.setXYZ(36,d.r,d.g,d.b),S.setXYZ(37,d.r,d.g,d.b),S.setXYZ(38,g.r,g.g,g.b),S.setXYZ(39,g.r,g.g,g.b),S.setXYZ(40,_.r,_.g,_.b),S.setXYZ(41,_.r,_.g,_.b),S.setXYZ(42,_.r,_.g,_.b),S.setXYZ(43,_.r,_.g,_.b),S.setXYZ(44,_.r,_.g,_.b),S.setXYZ(45,_.r,_.g,_.b),S.setXYZ(46,_.r,_.g,_.b),S.setXYZ(47,_.r,_.g,_.b),S.setXYZ(48,_.r,_.g,_.b),S.setXYZ(49,_.r,_.g,_.b),S.needsUpdate=!0}update(){let r=this.geometry,a=this.pointMap,d=1,g=1;as.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),us("c",a,r,as,0,0,-1),us("t",a,r,as,0,0,1),us("n1",a,r,as,-d,-g,-1),us("n2",a,r,as,d,-g,-1),us("n3",a,r,as,-d,g,-1),us("n4",a,r,as,d,g,-1),us("f1",a,r,as,-d,-g,1),us("f2",a,r,as,d,-g,1),us("f3",a,r,as,-d,g,1),us("f4",a,r,as,d,g,1),us("u1",a,r,as,d*.7,g*1.1,-1),us("u2",a,r,as,-d*.7,g*1.1,-1),us("u3",a,r,as,0,g*2,-1),us("cf1",a,r,as,-d,0,1),us("cf2",a,r,as,d,0,1),us("cf3",a,r,as,0,-g,1),us("cf4",a,r,as,0,g,1),us("cn1",a,r,as,-d,0,-1),us("cn2",a,r,as,d,0,-1),us("cn3",a,r,as,0,-g,-1),us("cn4",a,r,as,0,g,-1),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function us(b,r,a,d,g,_,C){_A.set(g,_,C).unproject(d);let S=r[b];if(S!==void 0){let B=a.getAttribute("position");for(let O=0,H=S.length;O<H;O++)B.setXYZ(S[O],_A.x,_A.y,_A.z)}}let bA=new rr;class c7 extends fc{constructor(r,a=16776960){let d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(8*3),_=new Zi;_.setIndex(new Wr(d,1)),_.setAttribute("position",new Wr(g,3)),super(_,new Co({color:a,toneMapped:!1})),this.object=r,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(r){if(r!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&bA.setFromObject(this.object),bA.isEmpty())return;let a=bA.min,d=bA.max,g=this.geometry.attributes.position,_=g.array;_[0]=d.x,_[1]=d.y,_[2]=d.z,_[3]=a.x,_[4]=d.y,_[5]=d.z,_[6]=a.x,_[7]=a.y,_[8]=d.z,_[9]=d.x,_[10]=a.y,_[11]=d.z,_[12]=d.x,_[13]=d.y,_[14]=a.z,_[15]=a.x,_[16]=d.y,_[17]=a.z,_[18]=a.x,_[19]=a.y,_[20]=a.z,_[21]=d.x,_[22]=a.y,_[23]=a.z,g.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(r){return this.object=r,this.update(),this}copy(r,a){return super.copy(r,a),this.object=r.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class l7 extends fc{constructor(r,a=16776960){let d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],_=new Zi;_.setIndex(new Wr(d,1)),_.setAttribute("position",new ni(g,3)),super(_,new Co({color:a,toneMapped:!1})),this.box=r,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(r){let a=this.box;a.isEmpty()||(a.getCenter(this.position),a.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(r))}dispose(){this.geometry.dispose(),this.material.dispose()}}class u7 extends Nl{constructor(r,a=1,d=16776960){let g=d,_=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],C=new Zi;C.setAttribute("position",new ni(_,3)),C.computeBoundingSphere(),super(C,new Co({color:g,toneMapped:!1})),this.type="PlaneHelper",this.plane=r,this.size=a;let S=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],B=new Zi;B.setAttribute("position",new ni(S,3)),B.computeBoundingSphere(),this.add(new qs(B,new Bl({color:g,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(r){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(r)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}let ZI=new Ye,MA,o1;class h7 extends Kr{constructor(r=new Ye(0,0,1),a=new Ye(0,0,0),d=1,g=16776960,_=d*.2,C=_*.2){super(),this.type="ArrowHelper",MA===void 0&&(MA=new Zi,MA.setAttribute("position",new ni([0,0,0,0,1,0],3)),o1=new Id(0,.5,1,5,1),o1.translate(0,-.5,0)),this.position.copy(a),this.line=new Nl(MA,new Co({color:g,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new qs(o1,new Bl({color:g,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(d,_,C)}setDirection(r){if(r.y>.99999)this.quaternion.set(0,0,0,1);else if(r.y<-.99999)this.quaternion.set(1,0,0,0);else{ZI.set(r.z,0,-r.x).normalize();let a=Math.acos(r.y);this.quaternion.setFromAxisAngle(ZI,a)}}setLength(r,a=r*.2,d=a*.2){this.line.scale.set(1,Math.max(1e-4,r-a),1),this.line.updateMatrix(),this.cone.scale.set(d,a,d),this.cone.position.y=r,this.cone.updateMatrix()}setColor(r){this.line.material.color.set(r),this.cone.material.color.set(r)}copy(r){return super.copy(r,!1),this.line.copy(r.line),this.cone.copy(r.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class d7 extends fc{constructor(r=1){let a=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],d=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],g=new Zi;g.setAttribute("position",new ni(a,3)),g.setAttribute("color",new ni(d,3));let _=new Co({vertexColors:!0,toneMapped:!1});super(g,_),this.type="AxesHelper"}setColors(r,a,d){let g=new jn,_=this.geometry.attributes.color.array;return g.set(r),g.toArray(_,0),g.toArray(_,3),g.set(a),g.toArray(_,6),g.toArray(_,9),g.set(d),g.toArray(_,12),g.toArray(_,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class f7{constructor(){this.type="ShapePath",this.color=new jn,this.subPaths=[],this.currentPath=null}moveTo(r,a){return this.currentPath=new tm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,a),this}lineTo(r,a){return this.currentPath.lineTo(r,a),this}quadraticCurveTo(r,a,d,g){return this.currentPath.quadraticCurveTo(r,a,d,g),this}bezierCurveTo(r,a,d,g,_,C){return this.currentPath.bezierCurveTo(r,a,d,g,_,C),this}splineThru(r){return this.currentPath.splineThru(r),this}toShapes(r){function a(K){let Pe=[];for(let ve=0,Te=K.length;ve<Te;ve++){let We=K[ve],qe=new Xu;qe.curves=We.curves,Pe.push(qe)}return Pe}function d(K,Pe){let ve=Pe.length,Te=!1;for(let We=ve-1,qe=0;qe<ve;We=qe++){let st=Pe[We],lt=Pe[qe],Ve=lt.x-st.x,Ke=lt.y-st.y;if(Math.abs(Ke)>Number.EPSILON){if(Ke<0&&(st=Pe[qe],Ve=-Ve,lt=Pe[We],Ke=-Ke),K.y<st.y||K.y>lt.y)continue;if(K.y===st.y){if(K.x===st.x)return!0}else{let ct=Ke*(K.x-st.x)-Ve*(K.y-st.y);if(ct===0)return!0;if(ct<0)continue;Te=!Te}}else{if(K.y!==st.y)continue;if(lt.x<=K.x&&K.x<=st.x||st.x<=K.x&&K.x<=lt.x)return!0}}return Te}let g=pc.isClockWise,_=this.subPaths;if(_.length===0)return[];let C,S,B,O=[];if(_.length===1)return S=_[0],B=new Xu,B.curves=S.curves,O.push(B),O;let H=!g(_[0].getPoints());H=r?!H:H;let W=[],j=[],J=[],ie=0,fe;j[ie]=void 0,J[ie]=[];for(let K=0,Pe=_.length;K<Pe;K++)S=_[K],fe=S.getPoints(),C=g(fe),C=r?!C:C,C?(!H&&j[ie]&&ie++,j[ie]={s:new Xu,p:fe},j[ie].s.curves=S.curves,H&&ie++,J[ie]=[]):J[ie].push({h:S,p:fe[0]});if(!j[0])return a(_);if(j.length>1){let K=!1,Pe=0;for(let ve=0,Te=j.length;ve<Te;ve++)W[ve]=[];for(let ve=0,Te=j.length;ve<Te;ve++){let We=J[ve];for(let qe=0;qe<We.length;qe++){let st=We[qe],lt=!0;for(let Ve=0;Ve<j.length;Ve++)d(st.p,j[Ve].p)&&(ve!==Ve&&Pe++,lt?(lt=!1,W[Ve].push(st)):K=!0);lt&&W[ve].push(st)}}Pe>0&&K===!1&&(J=W)}let se;for(let K=0,Pe=j.length;K<Pe;K++){B=j[K].s,O.push(B),se=J[K];for(let ve=0,Te=se.length;ve<Te;ve++)B.holes.push(se[ve].h)}return O}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l)},"./node_modules/super-three/examples/jsm/libs/ktx-parse.module.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>De,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>Ie,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>kt,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Oe,KHR_DF_CHANNEL_RGBSDA_RED:()=>Jt,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>yt,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>L,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>D,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>m,KHR_DF_MODEL_ASTC:()=>M,KHR_DF_MODEL_ETC1:()=>v,KHR_DF_MODEL_ETC1S:()=>T,KHR_DF_MODEL_ETC2:()=>w,KHR_DF_MODEL_RGBSDA:()=>x,KHR_DF_MODEL_UNSPECIFIED:()=>E,KHR_DF_PRIMARIES_ACES:()=>Ne,KHR_DF_PRIMARIES_ACESCC:()=>pn,KHR_DF_PRIMARIES_ADOBERGB:()=>xn,KHR_DF_PRIMARIES_BT2020:()=>It,KHR_DF_PRIMARIES_BT601_EBU:()=>gt,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Rt,KHR_DF_PRIMARIES_BT709:()=>it,KHR_DF_PRIMARIES_CIEXYZ:()=>Ft,KHR_DF_PRIMARIES_DISPLAYP3:()=>Ot,KHR_DF_PRIMARIES_NTSC1953:()=>St,KHR_DF_PRIMARIES_PAL525:()=>Vt,KHR_DF_PRIMARIES_UNSPECIFIED:()=>ut,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>de,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>he,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>we,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>ae,KHR_DF_TRANSFER_ACESCC:()=>be,KHR_DF_TRANSFER_ACESCCT:()=>Fe,KHR_DF_TRANSFER_ADOBERGB:()=>Ze,KHR_DF_TRANSFER_BT1886:()=>U,KHR_DF_TRANSFER_DCIP3:()=>Z,KHR_DF_TRANSFER_HLG_EOTF:()=>k,KHR_DF_TRANSFER_HLG_OETF:()=>P,KHR_DF_TRANSFER_ITU:()=>N,KHR_DF_TRANSFER_LINEAR:()=>F,KHR_DF_TRANSFER_NTSC:()=>X,KHR_DF_TRANSFER_PAL625_EOTF:()=>Me,KHR_DF_TRANSFER_PAL_OETF:()=>ce,KHR_DF_TRANSFER_PQ_EOTF:()=>z,KHR_DF_TRANSFER_PQ_OETF:()=>Q,KHR_DF_TRANSFER_SLOG:()=>$,KHR_DF_TRANSFER_SLOG2:()=>te,KHR_DF_TRANSFER_SRGB:()=>R,KHR_DF_TRANSFER_ST240:()=>xe,KHR_DF_TRANSFER_UNSPECIFIED:()=>I,KHR_DF_VENDORID_KHRONOS:()=>A,KHR_DF_VERSION:()=>y,KHR_SUPERCOMPRESSION_BASISLZ:()=>h,KHR_SUPERCOMPRESSION_NONE:()=>u,KHR_SUPERCOMPRESSION_ZLIB:()=>f,KHR_SUPERCOMPRESSION_ZSTD:()=>p,KTX2Container:()=>Lc,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>pe,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>Bt,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Tt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>mt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>Ct,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>At,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>Xe,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>rt,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>_e,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>Up,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>Rl,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>nd,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>es,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>_o,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>ku,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>Eo,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Nu,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>u0,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>s0,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Ns,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>h0,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>Tl,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Dc,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>e_,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>kE,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Op,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>Ir,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>Fu,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>VE,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>Oi,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>i0,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>n0,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>Fp,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>Ou,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>r0,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>a0,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>DE,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>RE,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>ZE,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>PE,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>LE,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Il,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>OE,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>BE,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>Uu,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>FE,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>NE,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>c0,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Bp,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>UE,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>l0,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>pa,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>ed,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>ai,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>jE,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>KE,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>ze,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>G,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>ee,VK_FORMAT_B8G8R8A8_SINT:()=>le,VK_FORMAT_B8G8R8A8_SNORM:()=>ne,VK_FORMAT_B8G8R8A8_SRGB:()=>me,VK_FORMAT_B8G8R8A8_UINT:()=>Y,VK_FORMAT_B8G8R8A8_UNORM:()=>Mi,VK_FORMAT_B8G8R8_SINT:()=>Gn,VK_FORMAT_B8G8R8_SNORM:()=>In,VK_FORMAT_B8G8R8_SRGB:()=>fi,VK_FORMAT_B8G8R8_UINT:()=>Kn,VK_FORMAT_B8G8R8_UNORM:()=>Pn,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>Pu,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>Ur,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>Lu,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>Du,VK_FORMAT_BC2_SRGB_BLOCK:()=>gE,VK_FORMAT_BC2_UNORM_BLOCK:()=>Bu,VK_FORMAT_BC3_SRGB_BLOCK:()=>AE,VK_FORMAT_BC3_UNORM_BLOCK:()=>Rc,VK_FORMAT_BC4_SNORM_BLOCK:()=>yE,VK_FORMAT_BC4_UNORM_BLOCK:()=>vE,VK_FORMAT_BC5_SNORM_BLOCK:()=>EE,VK_FORMAT_BC5_UNORM_BLOCK:()=>xE,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>bE,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>_E,VK_FORMAT_BC7_SRGB_BLOCK:()=>wE,VK_FORMAT_BC7_UNORM_BLOCK:()=>ME,VK_FORMAT_D16_UNORM:()=>xo,VK_FORMAT_D16_UNORM_S8_UINT:()=>Gr,VK_FORMAT_D24_UNORM_S8_UINT:()=>Sr,VK_FORMAT_D32_SFLOAT:()=>cc,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>Zh,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Oo,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>t0,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>e0,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Zg,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>Jg,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>IE,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>TE,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>$g,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>Pp,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>SE,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>CE,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>WE,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>YE,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>ao,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Np,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Bi,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>o0,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>JE,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>td,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>nn,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>$E,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>GE,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>zE,VK_FORMAT_R10X6_UNORM_PACK16:()=>HE,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>qE,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>XE,VK_FORMAT_R12X4_UNORM_PACK16:()=>QE,VK_FORMAT_R16G16B16A16_SFLOAT:()=>bt,VK_FORMAT_R16G16B16A16_SINT:()=>vt,VK_FORMAT_R16G16B16A16_SNORM:()=>He,VK_FORMAT_R16G16B16A16_UINT:()=>at,VK_FORMAT_R16G16B16A16_UNORM:()=>Se,VK_FORMAT_R16G16B16_SFLOAT:()=>ye,VK_FORMAT_R16G16B16_SINT:()=>re,VK_FORMAT_R16G16B16_SNORM:()=>$n,VK_FORMAT_R16G16B16_UINT:()=>q,VK_FORMAT_R16G16B16_UNORM:()=>ur,VK_FORMAT_R16G16_SFLOAT:()=>Ei,VK_FORMAT_R16G16_SINT:()=>yn,VK_FORMAT_R16G16_SNORM:()=>lr,VK_FORMAT_R16G16_UINT:()=>zn,VK_FORMAT_R16G16_UNORM:()=>Yt,VK_FORMAT_R16_SFLOAT:()=>mn,VK_FORMAT_R16_SINT:()=>Wn,VK_FORMAT_R16_SNORM:()=>Ln,VK_FORMAT_R16_UINT:()=>Hn,VK_FORMAT_R16_UNORM:()=>cn,VK_FORMAT_R32G32B32A32_SFLOAT:()=>sn,VK_FORMAT_R32G32B32A32_SINT:()=>Rn,VK_FORMAT_R32G32B32A32_UINT:()=>Wt,VK_FORMAT_R32G32B32_SFLOAT:()=>Gt,VK_FORMAT_R32G32B32_SINT:()=>Pt,VK_FORMAT_R32G32B32_UINT:()=>pt,VK_FORMAT_R32G32_SFLOAT:()=>Re,VK_FORMAT_R32G32_SINT:()=>Be,VK_FORMAT_R32G32_UINT:()=>Ce,VK_FORMAT_R32_SFLOAT:()=>ue,VK_FORMAT_R32_SINT:()=>oe,VK_FORMAT_R32_UINT:()=>qt,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Ee,VK_FORMAT_R4G4_UNORM_PACK8:()=>Le,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>V,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Ge,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Qr,VK_FORMAT_R64G64B64A64_SINT:()=>Ii,VK_FORMAT_R64G64B64A64_UINT:()=>Fr,VK_FORMAT_R64G64B64_SFLOAT:()=>vr,VK_FORMAT_R64G64B64_SINT:()=>Pi,VK_FORMAT_R64G64B64_UINT:()=>ci,VK_FORMAT_R64G64_SFLOAT:()=>oi,VK_FORMAT_R64G64_SINT:()=>On,VK_FORMAT_R64G64_UINT:()=>ri,VK_FORMAT_R64_SFLOAT:()=>Zn,VK_FORMAT_R64_SINT:()=>Jn,VK_FORMAT_R64_UINT:()=>Sn,VK_FORMAT_R8G8B8A8_SINT:()=>dr,VK_FORMAT_R8G8B8A8_SNORM:()=>Ti,VK_FORMAT_R8G8B8A8_SRGB:()=>Ai,VK_FORMAT_R8G8B8A8_UINT:()=>ir,VK_FORMAT_R8G8B8A8_UNORM:()=>xi,VK_FORMAT_R8G8B8_SINT:()=>xt,VK_FORMAT_R8G8B8_SNORM:()=>Cn,VK_FORMAT_R8G8B8_SRGB:()=>jt,VK_FORMAT_R8G8B8_UINT:()=>en,VK_FORMAT_R8G8B8_UNORM:()=>En,VK_FORMAT_R8G8_SINT:()=>_t,VK_FORMAT_R8G8_SNORM:()=>et,VK_FORMAT_R8G8_SRGB:()=>tn,VK_FORMAT_R8G8_UINT:()=>tt,VK_FORMAT_R8G8_UNORM:()=>ot,VK_FORMAT_R8_SINT:()=>nt,VK_FORMAT_R8_SNORM:()=>Qe,VK_FORMAT_R8_SRGB:()=>ge,VK_FORMAT_R8_UINT:()=>$e,VK_FORMAT_R8_UNORM:()=>Ue,VK_FORMAT_S8_UINT:()=>ls,VK_FORMAT_UNDEFINED:()=>Ae,VK_FORMAT_X8_D24_UNORM_PACK32:()=>Os,read:()=>Mr,write:()=>sd});var l=c("./node_modules/buffer/index.js").Buffer;let u=0,h=1,p=2,f=3,m=0,A=0,y=2,E=0,x=1,v=160,w=161,M=162,T=163,D=0,L=1,I=0,F=1,R=2,N=3,X=4,$=5,te=6,U=7,P=8,k=9,z=10,Q=11,Z=12,ce=13,Me=14,xe=15,be=16,Fe=17,Ze=18,ut=0,it=1,gt=2,Rt=3,It=4,Ft=5,Ne=6,pn=7,St=8,Vt=9,Ot=10,xn=11,Jt=0,Oe=1,Ie=2,yt=13,kt=14,De=15,he=128,ae=64,de=32,we=16,Ae=0,Le=1,Ee=2,ze=3,Ge=4,ee=5,V=6,G=7,pe=8,Ue=9,Qe=10,$e=13,nt=14,ge=15,ot=16,et=17,tt=20,_t=21,tn=22,En=23,Cn=24,en=27,xt=28,jt=29,Pn=30,In=31,Kn=34,Gn=35,fi=36,xi=37,Ti=38,ir=41,dr=42,Ai=43,Mi=44,ne=45,Y=48,le=49,me=50,_e=58,Xe=59,rt=62,At=63,Ct=64,Tt=65,mt=68,Bt=69,cn=70,Ln=71,Hn=74,Wn=75,mn=76,Yt=77,lr=78,zn=81,yn=82,Ei=83,ur=84,$n=85,q=88,re=89,ye=90,Se=91,He=92,at=95,vt=96,bt=97,qt=98,oe=99,ue=100,Ce=101,Be=102,Re=103,pt=104,Pt=105,Gt=106,Wt=107,Rn=108,sn=109,Sn=110,Jn=111,Zn=112,ri=113,On=114,oi=115,ci=116,Pi=117,vr=118,Fr=119,Ii=120,Qr=121,ai=122,Oo=123,xo=124,Os=125,cc=126,ls=127,Gr=128,Sr=129,Zh=130,Du=131,Lu=132,Ur=133,Pu=134,Bu=135,gE=136,Rc=137,AE=138,vE=139,yE=140,xE=141,EE=142,_E=143,bE=144,ME=145,wE=146,CE=147,SE=148,TE=149,IE=150,Pp=151,$g=152,Jg=153,Zg=154,e0=155,t0=156,n0=157,i0=158,r0=159,Ou=160,RE=161,DE=162,LE=163,PE=164,BE=165,OE=166,NE=167,FE=168,UE=169,Bp=170,ed=171,pa=172,Nu=173,Eo=174,Ns=175,s0=176,Dc=177,Tl=178,_o=179,es=180,Op=181,kE=182,VE=183,Fu=184,HE=1000156007,zE=1000156008,GE=1000156009,WE=1000156010,jE=1000156011,QE=1000156017,XE=1000156018,qE=1000156019,YE=1000156020,KE=1000156021,Np=1000054e3,o0=1000054001,td=1000054002,$E=1000054003,ao=1000054004,Bi=1000054005,JE=1000054006,nn=1000054007,Oi=1000066e3,Fp=1000066001,a0=1000066002,ZE=1000066003,Il=1000066004,Uu=1000066005,c0=1000066006,l0=1000066007,ku=1000066008,u0=1000066009,h0=1000066010,nd=1000066011,e_=1000066012,Ir=1000066013,Rl=100034e4,Up=1000340001;class Lc{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Pc{constructor(Ri,Ar,Fs,Ci){this._dataView=new DataView(Ri.buffer,Ri.byteOffset+Ar,Fs),this._littleEndian=Ci,this._offset=0}_nextUint8(){let Ri=this._dataView.getUint8(this._offset);return this._offset+=1,Ri}_nextUint16(){let Ri=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Ri}_nextUint32(){let Ri=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Ri}_nextUint64(){let Ri=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Ri}_nextInt32(){let Ri=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Ri}_skip(Ri){return this._offset+=Ri,this}_scan(Ri,Ar=0){let Fs=this._offset,Ci=0;for(;this._dataView.getUint8(this._offset)!==Ar&&Ci<Ri;)Ci++,this._offset++;return Ci<Ri&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+Fs,Ci)}}let d0=new Uint8Array([0]),Yr=[171,75,84,88,32,50,48,187,13,10,26,10];function id(qn){return typeof TextEncoder<"u"?new TextEncoder().encode(qn):l.from(qn)}function f0(qn){return typeof TextDecoder<"u"?new TextDecoder().decode(qn):l.from(qn).toString("utf8")}function Es(qn){let Ri=0;for(let Ci of qn)Ri+=Ci.byteLength;let Ar=new Uint8Array(Ri),Fs=0;for(let Ci of qn)Ar.set(new Uint8Array(Ci),Fs),Fs+=Ci.byteLength;return Ar}function Mr(qn){let Ri=new Uint8Array(qn.buffer,qn.byteOffset,Yr.length);if(Ri[0]!==Yr[0]||Ri[1]!==Yr[1]||Ri[2]!==Yr[2]||Ri[3]!==Yr[3]||Ri[4]!==Yr[4]||Ri[5]!==Yr[5]||Ri[6]!==Yr[6]||Ri[7]!==Yr[7]||Ri[8]!==Yr[8]||Ri[9]!==Yr[9]||Ri[10]!==Yr[10]||Ri[11]!==Yr[11])throw new Error("Missing KTX 2.0 identifier.");let Ar=new Lc,Fs=17*Uint32Array.BYTES_PER_ELEMENT,Ci=new Pc(qn,Yr.length,Fs,!0);Ar.vkFormat=Ci._nextUint32(),Ar.typeSize=Ci._nextUint32(),Ar.pixelWidth=Ci._nextUint32(),Ar.pixelHeight=Ci._nextUint32(),Ar.pixelDepth=Ci._nextUint32(),Ar.layerCount=Ci._nextUint32(),Ar.faceCount=Ci._nextUint32();let Ye=Ci._nextUint32();Ar.supercompressionScheme=Ci._nextUint32();let ns=Ci._nextUint32(),lc=Ci._nextUint32(),rr=Ci._nextUint32(),Fo=Ci._nextUint32(),Xs=Ci._nextUint64(),ma=Ci._nextUint64(),Us=new Pc(qn,Yr.length+Fs,3*Ye*8,!0);for(let co=0;co<Ye;co++)Ar.levels.push({levelData:new Uint8Array(qn.buffer,qn.byteOffset+Us._nextUint64(),Us._nextUint64()),uncompressedByteLength:Us._nextUint64()});let zi=new Pc(qn,ns,lc,!0),bo={vendorId:zi._skip(4)._nextUint16(),descriptorType:zi._nextUint16(),versionNumber:zi._nextUint16(),descriptorBlockSize:zi._nextUint16(),colorModel:zi._nextUint8(),colorPrimaries:zi._nextUint8(),transferFunction:zi._nextUint8(),flags:zi._nextUint8(),texelBlockDimension:[zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8()],bytesPlane:[zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8()],samples:[]},qo=(bo.descriptorBlockSize/4-6)/4;for(let co=0;co<qo;co++){let lo={bitOffset:zi._nextUint16(),bitLength:zi._nextUint8(),channelType:zi._nextUint8(),samplePosition:[zi._nextUint8(),zi._nextUint8(),zi._nextUint8(),zi._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&lo.channelType?(lo.sampleLower=zi._nextInt32(),lo.sampleUpper=zi._nextInt32()):(lo.sampleLower=zi._nextUint32(),lo.sampleUpper=zi._nextUint32()),bo.samples[co]=lo}Ar.dataFormatDescriptor.length=0,Ar.dataFormatDescriptor.push(bo);let _s=new Pc(qn,rr,Fo,!0);for(;_s._offset<Fo;){let co=_s._nextUint32(),lo=_s._scan(co),_i=f0(lo),Bc=_s._scan(co-lo.byteLength);Ar.keyValue[_i]=_i.match(/^ktx/i)?f0(Bc):Bc,_s._offset%4&&_s._skip(4-_s._offset%4)}if(ma<=0)return Ar;let fr=new Pc(qn,Xs,ma,!0),Pr=fr._nextUint16(),Gi=fr._nextUint16(),Rr=fr._nextUint32(),bs=fr._nextUint32(),uc=fr._nextUint32(),kp=fr._nextUint32(),Dl=[];for(let co=0;co<Ye;co++)Dl.push({imageFlags:fr._nextUint32(),rgbSliceByteOffset:fr._nextUint32(),rgbSliceByteLength:fr._nextUint32(),alphaSliceByteOffset:fr._nextUint32(),alphaSliceByteLength:fr._nextUint32()});let od=Xs+fr._offset,Uo=od+Rr,ga=Uo+bs,Vp=ga+uc,ad=new Uint8Array(qn.buffer,qn.byteOffset+od,Rr),hc=new Uint8Array(qn.buffer,qn.byteOffset+Uo,bs),Hp=new Uint8Array(qn.buffer,qn.byteOffset+ga,uc),cd=new Uint8Array(qn.buffer,qn.byteOffset+Vp,kp);return Ar.globalData={endpointCount:Pr,selectorCount:Gi,imageDescs:Dl,endpointsData:ad,selectorsData:hc,tablesData:Hp,extendedData:cd},Ar}function rd(){return(rd=Object.assign||function(qn){for(var Ri=1;Ri<arguments.length;Ri++){var Ar=arguments[Ri];for(var Fs in Ar)Object.prototype.hasOwnProperty.call(Ar,Fs)&&(qn[Fs]=Ar[Fs])}return qn}).apply(this,arguments)}let No={keepWriter:!1};function sd(qn,Ri={}){Ri=rd({},No,Ri);let Ar=new ArrayBuffer(0);if(qn.globalData){let Pr=new ArrayBuffer(20+5*qn.globalData.imageDescs.length*4),Gi=new DataView(Pr);Gi.setUint16(0,qn.globalData.endpointCount,!0),Gi.setUint16(2,qn.globalData.selectorCount,!0),Gi.setUint32(4,qn.globalData.endpointsData.byteLength,!0),Gi.setUint32(8,qn.globalData.selectorsData.byteLength,!0),Gi.setUint32(12,qn.globalData.tablesData.byteLength,!0),Gi.setUint32(16,qn.globalData.extendedData.byteLength,!0);for(let Rr=0;Rr<qn.globalData.imageDescs.length;Rr++){let bs=qn.globalData.imageDescs[Rr];Gi.setUint32(20+5*Rr*4+0,bs.imageFlags,!0),Gi.setUint32(20+5*Rr*4+4,bs.rgbSliceByteOffset,!0),Gi.setUint32(20+5*Rr*4+8,bs.rgbSliceByteLength,!0),Gi.setUint32(20+5*Rr*4+12,bs.alphaSliceByteOffset,!0),Gi.setUint32(20+5*Rr*4+16,bs.alphaSliceByteLength,!0)}Ar=Es([Pr,qn.globalData.endpointsData,qn.globalData.selectorsData,qn.globalData.tablesData,qn.globalData.extendedData])}let Fs=[],Ci=qn.keyValue;Ri.keepWriter||(Ci=rd({},qn.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(let Pr in Ci){let Gi=Ci[Pr],Rr=id(Pr),bs=typeof Gi=="string"?id(Gi):Gi,uc=Rr.byteLength+1+bs.byteLength+1,kp=uc%4?4-uc%4:0;Fs.push(Es([new Uint32Array([uc]),Rr,d0,bs,d0,new Uint8Array(kp).fill(0)]))}let Ye=Es(Fs);if(qn.dataFormatDescriptor.length!==1||qn.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");let ns=qn.dataFormatDescriptor[0],lc=new ArrayBuffer(28+16*ns.samples.length),rr=new DataView(lc),Fo=24+16*ns.samples.length;if(rr.setUint32(0,lc.byteLength,!0),rr.setUint16(4,ns.vendorId,!0),rr.setUint16(6,ns.descriptorType,!0),rr.setUint16(8,ns.versionNumber,!0),rr.setUint16(10,Fo,!0),rr.setUint8(12,ns.colorModel),rr.setUint8(13,ns.colorPrimaries),rr.setUint8(14,ns.transferFunction),rr.setUint8(15,ns.flags),!Array.isArray(ns.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");rr.setUint8(16,ns.texelBlockDimension[0]),rr.setUint8(17,ns.texelBlockDimension[1]),rr.setUint8(18,ns.texelBlockDimension[2]),rr.setUint8(19,ns.texelBlockDimension[3]);for(let Pr=0;Pr<8;Pr++)rr.setUint8(20+Pr,ns.bytesPlane[Pr]);for(let Pr=0;Pr<ns.samples.length;Pr++){let Gi=ns.samples[Pr],Rr=28+16*Pr;if(Gi.channelID)throw new Error("channelID has been renamed to channelType.");rr.setUint16(Rr+0,Gi.bitOffset,!0),rr.setUint8(Rr+2,Gi.bitLength),rr.setUint8(Rr+3,Gi.channelType),rr.setUint8(Rr+4,Gi.samplePosition[0]),rr.setUint8(Rr+5,Gi.samplePosition[1]),rr.setUint8(Rr+6,Gi.samplePosition[2]),rr.setUint8(Rr+7,Gi.samplePosition[3]),64&Gi.channelType?(rr.setInt32(Rr+8,Gi.sampleLower,!0),rr.setInt32(Rr+12,Gi.sampleUpper,!0)):(rr.setUint32(Rr+8,Gi.sampleLower,!0),rr.setUint32(Rr+12,Gi.sampleUpper,!0))}let Xs=Yr.length+68+3*qn.levels.length*8,ma=Xs+lc.byteLength,Us=Ar.byteLength>0?ma+Ye.byteLength:0;Us%8&&(Us+=8-Us%8);let zi=[],bo=new DataView(new ArrayBuffer(3*qn.levels.length*8)),qo=(Us||ma+Ye.byteLength)+Ar.byteLength;for(let Pr=0;Pr<qn.levels.length;Pr++){let Gi=qn.levels[Pr];zi.push(Gi.levelData),bo.setBigUint64(24*Pr+0,BigInt(qo),!0),bo.setBigUint64(24*Pr+8,BigInt(Gi.levelData.byteLength),!0),bo.setBigUint64(24*Pr+16,BigInt(Gi.uncompressedByteLength),!0),qo+=Gi.levelData.byteLength}let _s=new ArrayBuffer(68),fr=new DataView(_s);return fr.setUint32(0,qn.vkFormat,!0),fr.setUint32(4,qn.typeSize,!0),fr.setUint32(8,qn.pixelWidth,!0),fr.setUint32(12,qn.pixelHeight,!0),fr.setUint32(16,qn.pixelDepth,!0),fr.setUint32(20,qn.layerCount,!0),fr.setUint32(24,qn.faceCount,!0),fr.setUint32(28,qn.levels.length,!0),fr.setUint32(32,qn.supercompressionScheme,!0),fr.setUint32(36,Xs,!0),fr.setUint32(40,lc.byteLength,!0),fr.setUint32(44,ma,!0),fr.setUint32(48,Ye.byteLength,!0),fr.setBigUint64(52,BigInt(Ar.byteLength>0?Us:0),!0),fr.setBigUint64(60,BigInt(Ar.byteLength),!0),new Uint8Array(Es([new Uint8Array(Yr).buffer,_s,bo.buffer,lc,Ye,Us>0?new ArrayBuffer(Us-(ma+Ye.byteLength)):new ArrayBuffer(0),Ar,...zi]))}},"./node_modules/super-three/examples/jsm/libs/zstddec.module.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{ZSTDDecoder:()=>m});var l=c("./node_modules/buffer/index.js").Buffer;let u,h,p,f={env:{emscripten_notify_memory_growth:function(y){p=new Uint8Array(h.exports.memory.buffer)}}};class m{init(){return u||(u=typeof fetch<"u"?fetch("data:application/wasm;base64,"+A).then(E=>E.arrayBuffer()).then(E=>WebAssembly.instantiate(E,f)).then(this._init):WebAssembly.instantiate(l.from(A,"base64"),f).then(this._init),u)}_init(E){h=E.instance,f.env.emscripten_notify_memory_growth(0)}decode(E,x=0){if(!h)throw new Error("ZSTDDecoder: Await .init() before decoding.");let v=E.byteLength,w=h.exports.malloc(v);p.set(E,w),x=x||Number(h.exports.ZSTD_findDecompressedSize(w,v));let M=h.exports.malloc(x),T=h.exports.ZSTD_decompress(M,x,w,v),D=p.slice(M,M+T);return h.exports.free(w),h.exports.free(M),D}}let A="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/super-three/examples/jsm/lights/LightProbeGenerator.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{LightProbeGenerator:()=>u});var l=c("./node_modules/super-three/build/three.module.js");class u{static fromCubeTexture(f){let m=0,A=new l.Vector3,y=new l.Vector3,E=new l.Color,x=[0,0,0,0,0,0,0,0,0],v=new l.SphericalHarmonics3,w=v.coefficients;for(let T=0;T<6;T++){let D=f.image[T],L=D.width,I=D.height,F=document.createElement("canvas");F.width=L,F.height=I;let R=F.getContext("2d");R.drawImage(D,0,0,L,I);let N=R.getImageData(0,0,L,I),X=N.data,$=N.width,te=2/$;for(let U=0,P=X.length;U<P;U+=4){E.setRGB(X[U]/255,X[U+1]/255,X[U+2]/255),h(E,f.colorSpace);let k=U/4,z=-1+(k%$+.5)*te,Q=1-(Math.floor(k/$)+.5)*te;switch(T){case 0:A.set(-1,Q,-z);break;case 1:A.set(1,Q,z);break;case 2:A.set(-z,1,-Q);break;case 3:A.set(-z,-1,Q);break;case 4:A.set(-z,Q,1);break;case 5:A.set(z,Q,-1);break}let Z=A.lengthSq(),ce=4/(Math.sqrt(Z)*Z);m+=ce,y.copy(A).normalize(),l.SphericalHarmonics3.getBasisAt(y,x);for(let Me=0;Me<9;Me++)w[Me].x+=x[Me]*E.r*ce,w[Me].y+=x[Me]*E.g*ce,w[Me].z+=x[Me]*E.b*ce}}let M=4*Math.PI/m;for(let T=0;T<9;T++)w[T].x*=M,w[T].y*=M,w[T].z*=M;return new l.LightProbe(v)}static fromCubeRenderTarget(f,m){let A=0,y=new l.Vector3,E=new l.Vector3,x=new l.Color,v=[0,0,0,0,0,0,0,0,0],w=new l.SphericalHarmonics3,M=w.coefficients,T=m.texture.type;for(let L=0;L<6;L++){let I=m.width,F;T===l.HalfFloatType?F=new Uint16Array(I*I*4):F=new Uint8Array(I*I*4),f.readRenderTargetPixels(m,0,0,I,I,F,L);let R=2/I;for(let N=0,X=F.length;N<X;N+=4){let $,te,U;T===l.HalfFloatType?($=l.DataUtils.fromHalfFloat(F[N]),te=l.DataUtils.fromHalfFloat(F[N+1]),U=l.DataUtils.fromHalfFloat(F[N+2])):($=F[N]/255,te=F[N+1]/255,U=F[N+2]/255),x.setRGB($,te,U),h(x,m.texture.colorSpace);let P=N/4,k=-1+(P%I+.5)*R,z=1-(Math.floor(P/I)+.5)*R;switch(L){case 0:y.set(1,z,-k);break;case 1:y.set(-1,z,k);break;case 2:y.set(k,1,-z);break;case 3:y.set(k,-1,z);break;case 4:y.set(k,z,1);break;case 5:y.set(-k,z,-1);break}let Q=y.lengthSq(),Z=4/(Math.sqrt(Q)*Q);A+=Z,E.copy(y).normalize(),l.SphericalHarmonics3.getBasisAt(E,v);for(let ce=0;ce<9;ce++)M[ce].x+=v[ce]*x.r*Z,M[ce].y+=v[ce]*x.g*Z,M[ce].z+=v[ce]*x.b*Z}}let D=4*Math.PI/A;for(let L=0;L<9;L++)M[L].x*=D,M[L].y*=D,M[L].z*=D;return new l.LightProbe(w)}}function h(p,f){switch(f){case l.SRGBColorSpace:p.convertSRGBToLinear();break;case l.LinearSRGBColorSpace:case l.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return p}},"./node_modules/super-three/examples/jsm/loaders/DRACOLoader.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{DRACOLoader:()=>h});var l=c("./node_modules/super-three/build/three.module.js");let u=new WeakMap;class h extends l.Loader{constructor(m){super(m),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(m){return this.decoderPath=m,this}setDecoderConfig(m){return this.decoderConfig=m,this}setWorkerLimit(m){return this.workerLimit=m,this}load(m,A,y,E){let x=new l.FileLoader(this.manager);x.setPath(this.path),x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setWithCredentials(this.withCredentials),x.load(m,v=>{this.parse(v,A,E)},y,E)}parse(m,A,y){this.decodeDracoFile(m,A,null,null,l.SRGBColorSpace).catch(y)}decodeDracoFile(m,A,y,E,x=l.LinearSRGBColorSpace){let v={attributeIDs:y||this.defaultAttributeIDs,attributeTypes:E||this.defaultAttributeTypes,useUniqueIDs:!!y,vertexColorSpace:x};return this.decodeGeometry(m,v).then(A)}decodeGeometry(m,A){let y=JSON.stringify(A);if(u.has(m)){let M=u.get(m);if(M.key===y)return M.promise;if(m.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let E,x=this.workerNextTaskID++,v=m.byteLength,w=this._getWorker(x,v).then(M=>(E=M,new Promise((T,D)=>{E._callbacks[x]={resolve:T,reject:D},E.postMessage({type:"decode",id:x,taskConfig:A,buffer:m},[m])}))).then(M=>this._createGeometry(M.geometry));return w.catch(()=>!0).then(()=>{E&&x&&this._releaseTask(E,x)}),u.set(m,{key:y,promise:w}),w}_createGeometry(m){let A=new l.BufferGeometry;m.index&&A.setIndex(new l.BufferAttribute(m.index.array,1));for(let y=0;y<m.attributes.length;y++){let E=m.attributes[y],x=E.name,v=E.array,w=E.itemSize,M=new l.BufferAttribute(v,w);x==="color"&&(this._assignVertexColorSpace(M,E.vertexColorSpace),M.normalized=!(v instanceof Float32Array)),A.setAttribute(x,M)}return A}_assignVertexColorSpace(m,A){if(A!==l.SRGBColorSpace)return;let y=new l.Color;for(let E=0,x=m.count;E<x;E++)y.fromBufferAttribute(m,E).convertSRGBToLinear(),m.setXYZ(E,y.r,y.g,y.b)}_loadLibrary(m,A){let y=new l.FileLoader(this.manager);return y.setPath(this.decoderPath),y.setResponseType(A),y.setWithCredentials(this.withCredentials),new Promise((E,x)=>{y.load(m,E,void 0,x)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let m=typeof WebAssembly!="object"||this.decoderConfig.type==="js",A=[];return m?A.push(this._loadLibrary("draco_decoder.js","text")):(A.push(this._loadLibrary("draco_wasm_wrapper.js","text")),A.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(A).then(y=>{let E=y[0];m||(this.decoderConfig.wasmBinary=y[1]);let x=p.toString(),v=["/* draco decoder */",E,"","/* worker */",x.substring(x.indexOf("{")+1,x.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([v]))}),this.decoderPending}_getWorker(m,A){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let E=new Worker(this.workerSourceURL);E._callbacks={},E._taskCosts={},E._taskLoad=0,E.postMessage({type:"init",decoderConfig:this.decoderConfig}),E.onmessage=function(x){let v=x.data;switch(v.type){case"decode":E._callbacks[v.id].resolve(v);break;case"error":E._callbacks[v.id].reject(v);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+v.type+'"')}},this.workerPool.push(E)}else this.workerPool.sort(function(E,x){return E._taskLoad>x._taskLoad?-1:1});let y=this.workerPool[this.workerPool.length-1];return y._taskCosts[m]=A,y._taskLoad+=A,y})}_releaseTask(m,A){m._taskLoad-=m._taskCosts[A],delete m._callbacks[A],delete m._taskCosts[A]}debug(){console.log("Task load: ",this.workerPool.map(m=>m._taskLoad))}dispose(){for(let m=0;m<this.workerPool.length;++m)this.workerPool[m].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function p(){let f,m;onmessage=function(v){let w=v.data;switch(w.type){case"init":f=w.decoderConfig,m=new Promise(function(D){f.onModuleLoaded=function(L){D({draco:L})},DracoDecoderModule(f)});break;case"decode":let M=w.buffer,T=w.taskConfig;m.then(D=>{let L=D.draco,I=new L.Decoder;try{let F=A(L,I,new Int8Array(M),T),R=F.attributes.map(N=>N.array.buffer);F.index&&R.push(F.index.array.buffer),self.postMessage({type:"decode",id:w.id,geometry:F},R)}catch(F){console.error(F),self.postMessage({type:"error",id:w.id,error:F.message})}finally{L.destroy(I)}});break}};function A(v,w,M,T){let D=T.attributeIDs,L=T.attributeTypes,I,F,R=w.GetEncodedGeometryType(M);if(R===v.TRIANGULAR_MESH)I=new v.Mesh,F=w.DecodeArrayToMesh(M,M.byteLength,I);else if(R===v.POINT_CLOUD)I=new v.PointCloud,F=w.DecodeArrayToPointCloud(M,M.byteLength,I);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!F.ok()||I.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+F.error_msg());let N={index:null,attributes:[]};for(let X in D){let $=self[L[X]],te,U;if(T.useUniqueIDs)U=D[X],te=w.GetAttributeByUniqueId(I,U);else{if(U=w.GetAttributeId(I,v[D[X]]),U===-1)continue;te=w.GetAttribute(I,U)}let P=E(v,w,I,X,$,te);X==="color"&&(P.vertexColorSpace=T.vertexColorSpace),N.attributes.push(P)}return R===v.TRIANGULAR_MESH&&(N.index=y(v,w,I)),v.destroy(I),N}function y(v,w,M){let D=M.num_faces()*3,L=D*4,I=v._malloc(L);w.GetTrianglesUInt32Array(M,L,I);let F=new Uint32Array(v.HEAPF32.buffer,I,D).slice();return v._free(I),{array:F,itemSize:1}}function E(v,w,M,T,D,L){let I=L.num_components(),R=M.num_points()*I,N=R*D.BYTES_PER_ELEMENT,X=x(v,D),$=v._malloc(N);w.GetAttributeDataArrayForAllPoints(M,L,X,N,$);let te=new D(v.HEAPF32.buffer,$,R).slice();return v._free($),{name:T,array:te,itemSize:I}}function x(v,w){switch(w){case Float32Array:return v.DT_FLOAT32;case Int8Array:return v.DT_INT8;case Int16Array:return v.DT_INT16;case Int32Array:return v.DT_INT32;case Uint8Array:return v.DT_UINT8;case Uint16Array:return v.DT_UINT16;case Uint32Array:return v.DT_UINT32}}}},"./node_modules/super-three/examples/jsm/loaders/GLTFLoader.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{GLTFLoader:()=>h});var l=c("./node_modules/super-three/build/three.module.js"),u=c("./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js");class h extends l.Loader{constructor(ae){super(ae),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(de){return new E(de)}),this.register(function(de){return new I(de)}),this.register(function(de){return new F(de)}),this.register(function(de){return new R(de)}),this.register(function(de){return new v(de)}),this.register(function(de){return new w(de)}),this.register(function(de){return new M(de)}),this.register(function(de){return new T(de)}),this.register(function(de){return new y(de)}),this.register(function(de){return new D(de)}),this.register(function(de){return new x(de)}),this.register(function(de){return new L(de)}),this.register(function(de){return new m(de)}),this.register(function(de){return new N(de)}),this.register(function(de){return new X(de)})}load(ae,de,we,Ae){let Le=this,Ee;this.resourcePath!==""?Ee=this.resourcePath:this.path!==""?Ee=this.path:Ee=l.LoaderUtils.extractUrlBase(ae),this.manager.itemStart(ae);let ze=function(ee){Ae?Ae(ee):console.error(ee),Le.manager.itemError(ae),Le.manager.itemEnd(ae)},Ge=new l.FileLoader(this.manager);Ge.setPath(this.path),Ge.setResponseType("arraybuffer"),Ge.setRequestHeader(this.requestHeader),Ge.setWithCredentials(this.withCredentials),Ge.load(ae,function(ee){try{Le.parse(ee,Ee,function(V){de(V),Le.manager.itemEnd(ae)},ze)}catch(V){ze(V)}},we,ze)}setDRACOLoader(ae){return this.dracoLoader=ae,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(ae){return this.ktx2Loader=ae,this}setMeshoptDecoder(ae){return this.meshoptDecoder=ae,this}register(ae){return this.pluginCallbacks.indexOf(ae)===-1&&this.pluginCallbacks.push(ae),this}unregister(ae){return this.pluginCallbacks.indexOf(ae)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ae),1),this}parse(ae,de,we,Ae){let Le,Ee={},ze={},Ge=new TextDecoder;if(typeof ae=="string")Le=JSON.parse(ae);else if(ae instanceof ArrayBuffer)if(Ge.decode(new Uint8Array(ae,0,4))===$){try{Ee[f.KHR_BINARY_GLTF]=new P(ae)}catch(G){Ae&&Ae(G);return}Le=JSON.parse(Ee[f.KHR_BINARY_GLTF].content)}else Le=JSON.parse(Ge.decode(ae));else Le=ae;if(Le.asset===void 0||Le.asset.version[0]<2){Ae&&Ae(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let ee=new yt(Le,{path:de||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ee.fileLoader.setRequestHeader(this.requestHeader);for(let V=0;V<this.pluginCallbacks.length;V++){let G=this.pluginCallbacks[V](ee);G.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),ze[G.name]=G,Ee[G.name]=!0}if(Le.extensionsUsed)for(let V=0;V<Le.extensionsUsed.length;++V){let G=Le.extensionsUsed[V],pe=Le.extensionsRequired||[];switch(G){case f.KHR_MATERIALS_UNLIT:Ee[G]=new A;break;case f.KHR_DRACO_MESH_COMPRESSION:Ee[G]=new k(Le,this.dracoLoader);break;case f.KHR_TEXTURE_TRANSFORM:Ee[G]=new z;break;case f.KHR_MESH_QUANTIZATION:Ee[G]=new Q;break;default:pe.indexOf(G)>=0&&ze[G]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+G+'".')}}ee.setExtensions(Ee),ee.setPlugins(ze),ee.parse(we,Ae)}parseAsync(ae,de){let we=this;return new Promise(function(Ae,Le){we.parse(ae,de,Ae,Le)})}}function p(){let he={};return{get:function(ae){return he[ae]},add:function(ae,de){he[ae]=de},remove:function(ae){delete he[ae]},removeAll:function(){he={}}}}let f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class m{constructor(ae){this.parser=ae,this.name=f.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let ae=this.parser,de=this.parser.json.nodes||[];for(let we=0,Ae=de.length;we<Ae;we++){let Le=de[we];Le.extensions&&Le.extensions[this.name]&&Le.extensions[this.name].light!==void 0&&ae._addNodeRef(this.cache,Le.extensions[this.name].light)}}_loadLight(ae){let de=this.parser,we="light:"+ae,Ae=de.cache.get(we);if(Ae)return Ae;let Le=de.json,Ge=((Le.extensions&&Le.extensions[this.name]||{}).lights||[])[ae],ee,V=new l.Color(16777215);Ge.color!==void 0&&V.setRGB(Ge.color[0],Ge.color[1],Ge.color[2],l.LinearSRGBColorSpace);let G=Ge.range!==void 0?Ge.range:0;switch(Ge.type){case"directional":ee=new l.DirectionalLight(V),ee.target.position.set(0,0,-1),ee.add(ee.target);break;case"point":ee=new l.PointLight(V),ee.distance=G;break;case"spot":ee=new l.SpotLight(V),ee.distance=G,Ge.spot=Ge.spot||{},Ge.spot.innerConeAngle=Ge.spot.innerConeAngle!==void 0?Ge.spot.innerConeAngle:0,Ge.spot.outerConeAngle=Ge.spot.outerConeAngle!==void 0?Ge.spot.outerConeAngle:Math.PI/4,ee.angle=Ge.spot.outerConeAngle,ee.penumbra=1-Ge.spot.innerConeAngle/Ge.spot.outerConeAngle,ee.target.position.set(0,0,-1),ee.add(ee.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Ge.type)}return ee.position.set(0,0,0),ee.decay=2,pn(ee,Ge),Ge.intensity!==void 0&&(ee.intensity=Ge.intensity),ee.name=de.createUniqueName(Ge.name||"light_"+ae),Ae=Promise.resolve(ee),de.cache.add(we,Ae),Ae}getDependency(ae,de){if(ae==="light")return this._loadLight(de)}createNodeAttachment(ae){let de=this,we=this.parser,Le=we.json.nodes[ae],ze=(Le.extensions&&Le.extensions[this.name]||{}).light;return ze===void 0?null:this._loadLight(ze).then(function(Ge){return we._getNodeRef(de.cache,ze,Ge)})}}class A{constructor(){this.name=f.KHR_MATERIALS_UNLIT}getMaterialType(){return l.MeshBasicMaterial}extendParams(ae,de,we){let Ae=[];ae.color=new l.Color(1,1,1),ae.opacity=1;let Le=de.pbrMetallicRoughness;if(Le){if(Array.isArray(Le.baseColorFactor)){let Ee=Le.baseColorFactor;ae.color.setRGB(Ee[0],Ee[1],Ee[2],l.LinearSRGBColorSpace),ae.opacity=Ee[3]}Le.baseColorTexture!==void 0&&Ae.push(we.assignTexture(ae,"map",Le.baseColorTexture,l.SRGBColorSpace))}return Promise.all(Ae)}}class y{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(ae,de){let Ae=this.parser.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=Ae.extensions[this.name].emissiveStrength;return Le!==void 0&&(de.emissiveIntensity=Le),Promise.resolve()}}class E{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_CLEARCOAT}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];if(Ee.clearcoatFactor!==void 0&&(de.clearcoat=Ee.clearcoatFactor),Ee.clearcoatTexture!==void 0&&Le.push(we.assignTexture(de,"clearcoatMap",Ee.clearcoatTexture)),Ee.clearcoatRoughnessFactor!==void 0&&(de.clearcoatRoughness=Ee.clearcoatRoughnessFactor),Ee.clearcoatRoughnessTexture!==void 0&&Le.push(we.assignTexture(de,"clearcoatRoughnessMap",Ee.clearcoatRoughnessTexture)),Ee.clearcoatNormalTexture!==void 0&&(Le.push(we.assignTexture(de,"clearcoatNormalMap",Ee.clearcoatNormalTexture)),Ee.clearcoatNormalTexture.scale!==void 0)){let ze=Ee.clearcoatNormalTexture.scale;de.clearcoatNormalScale=new l.Vector2(ze,ze)}return Promise.all(Le)}}class x{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_IRIDESCENCE}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];return Ee.iridescenceFactor!==void 0&&(de.iridescence=Ee.iridescenceFactor),Ee.iridescenceTexture!==void 0&&Le.push(we.assignTexture(de,"iridescenceMap",Ee.iridescenceTexture)),Ee.iridescenceIor!==void 0&&(de.iridescenceIOR=Ee.iridescenceIor),de.iridescenceThicknessRange===void 0&&(de.iridescenceThicknessRange=[100,400]),Ee.iridescenceThicknessMinimum!==void 0&&(de.iridescenceThicknessRange[0]=Ee.iridescenceThicknessMinimum),Ee.iridescenceThicknessMaximum!==void 0&&(de.iridescenceThicknessRange[1]=Ee.iridescenceThicknessMaximum),Ee.iridescenceThicknessTexture!==void 0&&Le.push(we.assignTexture(de,"iridescenceThicknessMap",Ee.iridescenceThicknessTexture)),Promise.all(Le)}}class v{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_SHEEN}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[];de.sheenColor=new l.Color(0,0,0),de.sheenRoughness=0,de.sheen=1;let Ee=Ae.extensions[this.name];if(Ee.sheenColorFactor!==void 0){let ze=Ee.sheenColorFactor;de.sheenColor.setRGB(ze[0],ze[1],ze[2],l.LinearSRGBColorSpace)}return Ee.sheenRoughnessFactor!==void 0&&(de.sheenRoughness=Ee.sheenRoughnessFactor),Ee.sheenColorTexture!==void 0&&Le.push(we.assignTexture(de,"sheenColorMap",Ee.sheenColorTexture,l.SRGBColorSpace)),Ee.sheenRoughnessTexture!==void 0&&Le.push(we.assignTexture(de,"sheenRoughnessMap",Ee.sheenRoughnessTexture)),Promise.all(Le)}}class w{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_TRANSMISSION}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];return Ee.transmissionFactor!==void 0&&(de.transmission=Ee.transmissionFactor),Ee.transmissionTexture!==void 0&&Le.push(we.assignTexture(de,"transmissionMap",Ee.transmissionTexture)),Promise.all(Le)}}class M{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_VOLUME}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];de.thickness=Ee.thicknessFactor!==void 0?Ee.thicknessFactor:0,Ee.thicknessTexture!==void 0&&Le.push(we.assignTexture(de,"thicknessMap",Ee.thicknessTexture)),de.attenuationDistance=Ee.attenuationDistance||1/0;let ze=Ee.attenuationColor||[1,1,1];return de.attenuationColor=new l.Color().setRGB(ze[0],ze[1],ze[2],l.LinearSRGBColorSpace),Promise.all(Le)}}class T{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_IOR}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let Ae=this.parser.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=Ae.extensions[this.name];return de.ior=Le.ior!==void 0?Le.ior:1.5,Promise.resolve()}}class D{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_SPECULAR}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];de.specularIntensity=Ee.specularFactor!==void 0?Ee.specularFactor:1,Ee.specularTexture!==void 0&&Le.push(we.assignTexture(de,"specularIntensityMap",Ee.specularTexture));let ze=Ee.specularColorFactor||[1,1,1];return de.specularColor=new l.Color().setRGB(ze[0],ze[1],ze[2],l.LinearSRGBColorSpace),Ee.specularColorTexture!==void 0&&Le.push(we.assignTexture(de,"specularColorMap",Ee.specularColorTexture,l.SRGBColorSpace)),Promise.all(Le)}}class L{constructor(ae){this.parser=ae,this.name=f.KHR_MATERIALS_ANISOTROPY}getMaterialType(ae){let we=this.parser.json.materials[ae];return!we.extensions||!we.extensions[this.name]?null:l.MeshPhysicalMaterial}extendMaterialParams(ae,de){let we=this.parser,Ae=we.json.materials[ae];if(!Ae.extensions||!Ae.extensions[this.name])return Promise.resolve();let Le=[],Ee=Ae.extensions[this.name];return Ee.anisotropyStrength!==void 0&&(de.anisotropy=Ee.anisotropyStrength),Ee.anisotropyRotation!==void 0&&(de.anisotropyRotation=Ee.anisotropyRotation),Ee.anisotropyTexture!==void 0&&Le.push(we.assignTexture(de,"anisotropyMap",Ee.anisotropyTexture)),Promise.all(Le)}}class I{constructor(ae){this.parser=ae,this.name=f.KHR_TEXTURE_BASISU}loadTexture(ae){let de=this.parser,we=de.json,Ae=we.textures[ae];if(!Ae.extensions||!Ae.extensions[this.name])return null;let Le=Ae.extensions[this.name],Ee=de.options.ktx2Loader;if(!Ee){if(we.extensionsRequired&&we.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return de.loadTextureImage(ae,Le.source,Ee)}}class F{constructor(ae){this.parser=ae,this.name=f.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(ae){let de=this.name,we=this.parser,Ae=we.json,Le=Ae.textures[ae];if(!Le.extensions||!Le.extensions[de])return null;let Ee=Le.extensions[de],ze=Ae.images[Ee.source],Ge=we.textureLoader;if(ze.uri){let ee=we.options.manager.getHandler(ze.uri);ee!==null&&(Ge=ee)}return this.detectSupport().then(function(ee){if(ee)return we.loadTextureImage(ae,Ee.source,Ge);if(Ae.extensionsRequired&&Ae.extensionsRequired.indexOf(de)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return we.loadTexture(ae)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ae){let de=new Image;de.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",de.onload=de.onerror=function(){ae(de.height===1)}})),this.isSupported}}class R{constructor(ae){this.parser=ae,this.name=f.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(ae){let de=this.name,we=this.parser,Ae=we.json,Le=Ae.textures[ae];if(!Le.extensions||!Le.extensions[de])return null;let Ee=Le.extensions[de],ze=Ae.images[Ee.source],Ge=we.textureLoader;if(ze.uri){let ee=we.options.manager.getHandler(ze.uri);ee!==null&&(Ge=ee)}return this.detectSupport().then(function(ee){if(ee)return we.loadTextureImage(ae,Ee.source,Ge);if(Ae.extensionsRequired&&Ae.extensionsRequired.indexOf(de)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return we.loadTexture(ae)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ae){let de=new Image;de.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",de.onload=de.onerror=function(){ae(de.height===1)}})),this.isSupported}}class N{constructor(ae){this.name=f.EXT_MESHOPT_COMPRESSION,this.parser=ae}loadBufferView(ae){let de=this.parser.json,we=de.bufferViews[ae];if(we.extensions&&we.extensions[this.name]){let Ae=we.extensions[this.name],Le=this.parser.getDependency("buffer",Ae.buffer),Ee=this.parser.options.meshoptDecoder;if(!Ee||!Ee.supported){if(de.extensionsRequired&&de.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Le.then(function(ze){let Ge=Ae.byteOffset||0,ee=Ae.byteLength||0,V=Ae.count,G=Ae.byteStride,pe=new Uint8Array(ze,Ge,ee);return Ee.decodeGltfBufferAsync?Ee.decodeGltfBufferAsync(V,G,pe,Ae.mode,Ae.filter).then(function(Ue){return Ue.buffer}):Ee.ready.then(function(){let Ue=new ArrayBuffer(V*G);return Ee.decodeGltfBuffer(new Uint8Array(Ue),V,G,pe,Ae.mode,Ae.filter),Ue})})}else return null}}class X{constructor(ae){this.name=f.EXT_MESH_GPU_INSTANCING,this.parser=ae}createNodeMesh(ae){let de=this.parser.json,we=de.nodes[ae];if(!we.extensions||!we.extensions[this.name]||we.mesh===void 0)return null;let Ae=de.meshes[we.mesh];for(let ee of Ae.primitives)if(ee.mode!==xe.TRIANGLES&&ee.mode!==xe.TRIANGLE_STRIP&&ee.mode!==xe.TRIANGLE_FAN&&ee.mode!==void 0)return null;let Ee=we.extensions[this.name].attributes,ze=[],Ge={};for(let ee in Ee)ze.push(this.parser.getDependency("accessor",Ee[ee]).then(V=>(Ge[ee]=V,Ge[ee])));return ze.length<1?null:(ze.push(this.parser.createNodeMesh(ae)),Promise.all(ze).then(ee=>{let V=ee.pop(),G=V.isGroup?V.children:[V],pe=ee[0].count,Ue=[];for(let Qe of G){let $e=new l.Matrix4,nt=new l.Vector3,ge=new l.Quaternion,ot=new l.Vector3(1,1,1),et=new l.InstancedMesh(Qe.geometry,Qe.material,pe);for(let tt=0;tt<pe;tt++)Ge.TRANSLATION&&nt.fromBufferAttribute(Ge.TRANSLATION,tt),Ge.ROTATION&&ge.fromBufferAttribute(Ge.ROTATION,tt),Ge.SCALE&&ot.fromBufferAttribute(Ge.SCALE,tt),et.setMatrixAt(tt,$e.compose(nt,ge,ot));for(let tt in Ge)if(tt==="_COLOR_0"){let _t=Ge[tt];et.instanceColor=new l.InstancedBufferAttribute(_t.array,_t.itemSize,_t.normalized)}else tt!=="TRANSLATION"&&tt!=="ROTATION"&&tt!=="SCALE"&&Qe.geometry.setAttribute(tt,Ge[tt]);l.Object3D.prototype.copy.call(et,Qe),this.parser.assignFinalMaterial(et),Ue.push(et)}return V.isGroup?(V.clear(),V.add(...Ue),V):Ue[0]}))}}let $="glTF",te=12,U={JSON:1313821514,BIN:5130562};class P{constructor(ae){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;let de=new DataView(ae,0,te),we=new TextDecoder;if(this.header={magic:we.decode(new Uint8Array(ae.slice(0,4))),version:de.getUint32(4,!0),length:de.getUint32(8,!0)},this.header.magic!==$)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let Ae=this.header.length-te,Le=new DataView(ae,te),Ee=0;for(;Ee<Ae;){let ze=Le.getUint32(Ee,!0);Ee+=4;let Ge=Le.getUint32(Ee,!0);if(Ee+=4,Ge===U.JSON){let ee=new Uint8Array(ae,te+Ee,ze);this.content=we.decode(ee)}else if(Ge===U.BIN){let ee=te+Ee;this.body=ae.slice(ee,ee+ze)}Ee+=ze}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class k{constructor(ae,de){if(!de)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=ae,this.dracoLoader=de,this.dracoLoader.preload()}decodePrimitive(ae,de){let we=this.json,Ae=this.dracoLoader,Le=ae.extensions[this.name].bufferView,Ee=ae.extensions[this.name].attributes,ze={},Ge={},ee={};for(let V in Ee){let G=it[V]||V.toLowerCase();ze[G]=Ee[V]}for(let V in ae.attributes){let G=it[V]||V.toLowerCase();if(Ee[V]!==void 0){let pe=we.accessors[ae.attributes[V]],Ue=be[pe.componentType];ee[G]=Ue.name,Ge[G]=pe.normalized===!0}}return de.getDependency("bufferView",Le).then(function(V){return new Promise(function(G){Ae.decodeDracoFile(V,function(pe){for(let Ue in pe.attributes){let Qe=pe.attributes[Ue],$e=Ge[Ue];$e!==void 0&&(Qe.normalized=$e)}G(pe)},ze,ee)})})}}class z{constructor(){this.name=f.KHR_TEXTURE_TRANSFORM}extendTexture(ae,de){return(de.texCoord===void 0||de.texCoord===ae.channel)&&de.offset===void 0&&de.rotation===void 0&&de.scale===void 0||(ae=ae.clone(),de.texCoord!==void 0&&(ae.channel=de.texCoord),de.offset!==void 0&&ae.offset.fromArray(de.offset),de.rotation!==void 0&&(ae.rotation=de.rotation),de.scale!==void 0&&ae.repeat.fromArray(de.scale),ae.needsUpdate=!0),ae}}class Q{constructor(){this.name=f.KHR_MESH_QUANTIZATION}}class Z extends l.Interpolant{constructor(ae,de,we,Ae){super(ae,de,we,Ae)}copySampleValue_(ae){let de=this.resultBuffer,we=this.sampleValues,Ae=this.valueSize,Le=ae*Ae*3+Ae;for(let Ee=0;Ee!==Ae;Ee++)de[Ee]=we[Le+Ee];return de}interpolate_(ae,de,we,Ae){let Le=this.resultBuffer,Ee=this.sampleValues,ze=this.valueSize,Ge=ze*2,ee=ze*3,V=Ae-de,G=(we-de)/V,pe=G*G,Ue=pe*G,Qe=ae*ee,$e=Qe-ee,nt=-2*Ue+3*pe,ge=Ue-pe,ot=1-nt,et=ge-pe+G;for(let tt=0;tt!==ze;tt++){let _t=Ee[$e+tt+ze],tn=Ee[$e+tt+Ge]*V,En=Ee[Qe+tt+ze],Cn=Ee[Qe+tt]*V;Le[tt]=ot*_t+et*tn+nt*En+ge*Cn}return Le}}let ce=new l.Quaternion;class Me extends Z{interpolate_(ae,de,we,Ae){let Le=super.interpolate_(ae,de,we,Ae);return ce.fromArray(Le).normalize().toArray(Le),Le}}let xe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},be={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Fe={9728:l.NearestFilter,9729:l.LinearFilter,9984:l.NearestMipmapNearestFilter,9985:l.LinearMipmapNearestFilter,9986:l.NearestMipmapLinearFilter,9987:l.LinearMipmapLinearFilter},Ze={33071:l.ClampToEdgeWrapping,33648:l.MirroredRepeatWrapping,10497:l.RepeatWrapping},ut={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},it={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Rt={CUBICSPLINE:void 0,LINEAR:l.InterpolateLinear,STEP:l.InterpolateDiscrete},It={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ft(he){return he.DefaultMaterial===void 0&&(he.DefaultMaterial=new l.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:l.FrontSide})),he.DefaultMaterial}function Ne(he,ae,de){for(let we in de.extensions)he[we]===void 0&&(ae.userData.gltfExtensions=ae.userData.gltfExtensions||{},ae.userData.gltfExtensions[we]=de.extensions[we])}function pn(he,ae){ae.extras!==void 0&&(typeof ae.extras=="object"?Object.assign(he.userData,ae.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ae.extras))}function St(he,ae,de){let we=!1,Ae=!1,Le=!1;for(let ee=0,V=ae.length;ee<V;ee++){let G=ae[ee];if(G.POSITION!==void 0&&(we=!0),G.NORMAL!==void 0&&(Ae=!0),G.COLOR_0!==void 0&&(Le=!0),we&&Ae&&Le)break}if(!we&&!Ae&&!Le)return Promise.resolve(he);let Ee=[],ze=[],Ge=[];for(let ee=0,V=ae.length;ee<V;ee++){let G=ae[ee];if(we){let pe=G.POSITION!==void 0?de.getDependency("accessor",G.POSITION):he.attributes.position;Ee.push(pe)}if(Ae){let pe=G.NORMAL!==void 0?de.getDependency("accessor",G.NORMAL):he.attributes.normal;ze.push(pe)}if(Le){let pe=G.COLOR_0!==void 0?de.getDependency("accessor",G.COLOR_0):he.attributes.color;Ge.push(pe)}}return Promise.all([Promise.all(Ee),Promise.all(ze),Promise.all(Ge)]).then(function(ee){let V=ee[0],G=ee[1],pe=ee[2];return we&&(he.morphAttributes.position=V),Ae&&(he.morphAttributes.normal=G),Le&&(he.morphAttributes.color=pe),he.morphTargetsRelative=!0,he})}function Vt(he,ae){if(he.updateMorphTargets(),ae.weights!==void 0)for(let de=0,we=ae.weights.length;de<we;de++)he.morphTargetInfluences[de]=ae.weights[de];if(ae.extras&&Array.isArray(ae.extras.targetNames)){let de=ae.extras.targetNames;if(he.morphTargetInfluences.length===de.length){he.morphTargetDictionary={};for(let we=0,Ae=de.length;we<Ae;we++)he.morphTargetDictionary[de[we]]=we}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ot(he){let ae,de=he.extensions&&he.extensions[f.KHR_DRACO_MESH_COMPRESSION];if(de?ae="draco:"+de.bufferView+":"+de.indices+":"+xn(de.attributes):ae=he.indices+":"+xn(he.attributes)+":"+he.mode,he.targets!==void 0)for(let we=0,Ae=he.targets.length;we<Ae;we++)ae+=":"+xn(he.targets[we]);return ae}function xn(he){let ae="",de=Object.keys(he).sort();for(let we=0,Ae=de.length;we<Ae;we++)ae+=de[we]+":"+he[de[we]]+";";return ae}function Jt(he){switch(he){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Oe(he){return he.search(/\.jpe?g($|\?)/i)>0||he.search(/^data\:image\/jpeg/)===0?"image/jpeg":he.search(/\.webp($|\?)/i)>0||he.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}let Ie=new l.Matrix4;class yt{constructor(ae={},de={}){this.json=ae,this.extensions={},this.plugins={},this.options=de,this.cache=new p,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let we=!1,Ae=!1,Le=-1;typeof navigator<"u"&&(we=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,Ae=navigator.userAgent.indexOf("Firefox")>-1,Le=Ae?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||we||Ae&&Le<98?this.textureLoader=new l.TextureLoader(this.options.manager):this.textureLoader=new l.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new l.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(ae){this.extensions=ae}setPlugins(ae){this.plugins=ae}parse(ae,de){let we=this,Ae=this.json,Le=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Ee){return Ee._markDefs&&Ee._markDefs()}),Promise.all(this._invokeAll(function(Ee){return Ee.beforeRoot&&Ee.beforeRoot()})).then(function(){return Promise.all([we.getDependencies("scene"),we.getDependencies("animation"),we.getDependencies("camera")])}).then(function(Ee){let ze={scene:Ee[0][Ae.scene||0],scenes:Ee[0],animations:Ee[1],cameras:Ee[2],asset:Ae.asset,parser:we,userData:{}};return Ne(Le,ze,Ae),pn(ze,Ae),Promise.all(we._invokeAll(function(Ge){return Ge.afterRoot&&Ge.afterRoot(ze)})).then(function(){ae(ze)})}).catch(de)}_markDefs(){let ae=this.json.nodes||[],de=this.json.skins||[],we=this.json.meshes||[];for(let Ae=0,Le=de.length;Ae<Le;Ae++){let Ee=de[Ae].joints;for(let ze=0,Ge=Ee.length;ze<Ge;ze++)ae[Ee[ze]].isBone=!0}for(let Ae=0,Le=ae.length;Ae<Le;Ae++){let Ee=ae[Ae];Ee.mesh!==void 0&&(this._addNodeRef(this.meshCache,Ee.mesh),Ee.skin!==void 0&&(we[Ee.mesh].isSkinnedMesh=!0)),Ee.camera!==void 0&&this._addNodeRef(this.cameraCache,Ee.camera)}}_addNodeRef(ae,de){de!==void 0&&(ae.refs[de]===void 0&&(ae.refs[de]=ae.uses[de]=0),ae.refs[de]++)}_getNodeRef(ae,de,we){if(ae.refs[de]<=1)return we;let Ae=we.clone(),Le=(Ee,ze)=>{let Ge=this.associations.get(Ee);Ge!=null&&this.associations.set(ze,Ge);for(let[ee,V]of Ee.children.entries())Le(V,ze.children[ee])};return Le(we,Ae),Ae.name+="_instance_"+ae.uses[de]++,Ae}_invokeOne(ae){let de=Object.values(this.plugins);de.push(this);for(let we=0;we<de.length;we++){let Ae=ae(de[we]);if(Ae)return Ae}return null}_invokeAll(ae){let de=Object.values(this.plugins);de.unshift(this);let we=[];for(let Ae=0;Ae<de.length;Ae++){let Le=ae(de[Ae]);Le&&we.push(Le)}return we}getDependency(ae,de){let we=ae+":"+de,Ae=this.cache.get(we);if(!Ae){switch(ae){case"scene":Ae=this.loadScene(de);break;case"node":Ae=this._invokeOne(function(Le){return Le.loadNode&&Le.loadNode(de)});break;case"mesh":Ae=this._invokeOne(function(Le){return Le.loadMesh&&Le.loadMesh(de)});break;case"accessor":Ae=this.loadAccessor(de);break;case"bufferView":Ae=this._invokeOne(function(Le){return Le.loadBufferView&&Le.loadBufferView(de)});break;case"buffer":Ae=this.loadBuffer(de);break;case"material":Ae=this._invokeOne(function(Le){return Le.loadMaterial&&Le.loadMaterial(de)});break;case"texture":Ae=this._invokeOne(function(Le){return Le.loadTexture&&Le.loadTexture(de)});break;case"skin":Ae=this.loadSkin(de);break;case"animation":Ae=this._invokeOne(function(Le){return Le.loadAnimation&&Le.loadAnimation(de)});break;case"camera":Ae=this.loadCamera(de);break;default:if(Ae=this._invokeOne(function(Le){return Le!=this&&Le.getDependency&&Le.getDependency(ae,de)}),!Ae)throw new Error("Unknown type: "+ae);break}this.cache.add(we,Ae)}return Ae}getDependencies(ae){let de=this.cache.get(ae);if(!de){let we=this,Ae=this.json[ae+(ae==="mesh"?"es":"s")]||[];de=Promise.all(Ae.map(function(Le,Ee){return we.getDependency(ae,Ee)})),this.cache.add(ae,de)}return de}loadBuffer(ae){let de=this.json.buffers[ae],we=this.fileLoader;if(de.type&&de.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+de.type+" buffer type is not supported.");if(de.uri===void 0&&ae===0)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);let Ae=this.options;return new Promise(function(Le,Ee){we.load(l.LoaderUtils.resolveURL(de.uri,Ae.path),Le,void 0,function(){Ee(new Error('THREE.GLTFLoader: Failed to load buffer "'+de.uri+'".'))})})}loadBufferView(ae){let de=this.json.bufferViews[ae];return this.getDependency("buffer",de.buffer).then(function(we){let Ae=de.byteLength||0,Le=de.byteOffset||0;return we.slice(Le,Le+Ae)})}loadAccessor(ae){let de=this,we=this.json,Ae=this.json.accessors[ae];if(Ae.bufferView===void 0&&Ae.sparse===void 0){let Ee=ut[Ae.type],ze=be[Ae.componentType],Ge=Ae.normalized===!0,ee=new ze(Ae.count*Ee);return Promise.resolve(new l.BufferAttribute(ee,Ee,Ge))}let Le=[];return Ae.bufferView!==void 0?Le.push(this.getDependency("bufferView",Ae.bufferView)):Le.push(null),Ae.sparse!==void 0&&(Le.push(this.getDependency("bufferView",Ae.sparse.indices.bufferView)),Le.push(this.getDependency("bufferView",Ae.sparse.values.bufferView))),Promise.all(Le).then(function(Ee){let ze=Ee[0],Ge=ut[Ae.type],ee=be[Ae.componentType],V=ee.BYTES_PER_ELEMENT,G=V*Ge,pe=Ae.byteOffset||0,Ue=Ae.bufferView!==void 0?we.bufferViews[Ae.bufferView].byteStride:void 0,Qe=Ae.normalized===!0,$e,nt;if(Ue&&Ue!==G){let ge=Math.floor(pe/Ue),ot="InterleavedBuffer:"+Ae.bufferView+":"+Ae.componentType+":"+ge+":"+Ae.count,et=de.cache.get(ot);et||($e=new ee(ze,ge*Ue,Ae.count*Ue/V),et=new l.InterleavedBuffer($e,Ue/V),de.cache.add(ot,et)),nt=new l.InterleavedBufferAttribute(et,Ge,pe%Ue/V,Qe)}else ze===null?$e=new ee(Ae.count*Ge):$e=new ee(ze,pe,Ae.count*Ge),nt=new l.BufferAttribute($e,Ge,Qe);if(Ae.sparse!==void 0){let ge=ut.SCALAR,ot=be[Ae.sparse.indices.componentType],et=Ae.sparse.indices.byteOffset||0,tt=Ae.sparse.values.byteOffset||0,_t=new ot(Ee[1],et,Ae.sparse.count*ge),tn=new ee(Ee[2],tt,Ae.sparse.count*Ge);ze!==null&&(nt=new l.BufferAttribute(nt.array.slice(),nt.itemSize,nt.normalized));for(let En=0,Cn=_t.length;En<Cn;En++){let en=_t[En];if(nt.setX(en,tn[En*Ge]),Ge>=2&&nt.setY(en,tn[En*Ge+1]),Ge>=3&&nt.setZ(en,tn[En*Ge+2]),Ge>=4&&nt.setW(en,tn[En*Ge+3]),Ge>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return nt})}loadTexture(ae){let de=this.json,we=this.options,Le=de.textures[ae].source,Ee=de.images[Le],ze=this.textureLoader;if(Ee.uri){let Ge=we.manager.getHandler(Ee.uri);Ge!==null&&(ze=Ge)}return this.loadTextureImage(ae,Le,ze)}loadTextureImage(ae,de,we){let Ae=this,Le=this.json,Ee=Le.textures[ae],ze=Le.images[de],Ge=(ze.uri||ze.bufferView)+":"+Ee.sampler;if(this.textureCache[Ge])return this.textureCache[Ge];let ee=this.loadImageSource(de,we).then(function(V){V.flipY=!1,V.name=Ee.name||ze.name||"",V.name===""&&typeof ze.uri=="string"&&ze.uri.startsWith("data:image/")===!1&&(V.name=ze.uri);let pe=(Le.samplers||{})[Ee.sampler]||{};return V.magFilter=Fe[pe.magFilter]||l.LinearFilter,V.minFilter=Fe[pe.minFilter]||l.LinearMipmapLinearFilter,V.wrapS=Ze[pe.wrapS]||l.RepeatWrapping,V.wrapT=Ze[pe.wrapT]||l.RepeatWrapping,Ae.associations.set(V,{textures:ae}),V}).catch(function(){return null});return this.textureCache[Ge]=ee,ee}loadImageSource(ae,de){let we=this,Ae=this.json,Le=this.options;if(this.sourceCache[ae]!==void 0)return this.sourceCache[ae].then(G=>G.clone());let Ee=Ae.images[ae],ze=self.URL||self.webkitURL,Ge=Ee.uri||"",ee=!1;if(Ee.bufferView!==void 0)Ge=we.getDependency("bufferView",Ee.bufferView).then(function(G){ee=!0;let pe=new Blob([G],{type:Ee.mimeType});return Ge=ze.createObjectURL(pe),Ge});else if(Ee.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+ae+" is missing URI and bufferView");let V=Promise.resolve(Ge).then(function(G){return new Promise(function(pe,Ue){let Qe=pe;de.isImageBitmapLoader===!0&&(Qe=function($e){let nt=new l.Texture($e);nt.needsUpdate=!0,pe(nt)}),de.load(l.LoaderUtils.resolveURL(G,Le.path),Qe,void 0,Ue)})}).then(function(G){return ee===!0&&ze.revokeObjectURL(Ge),G.userData.mimeType=Ee.mimeType||Oe(Ee.uri),G}).catch(function(G){throw console.error("THREE.GLTFLoader: Couldn't load texture",Ge),G});return this.sourceCache[ae]=V,V}assignTexture(ae,de,we,Ae){let Le=this;return this.getDependency("texture",we.index).then(function(Ee){if(!Ee)return null;if(we.texCoord!==void 0&&we.texCoord>0&&(Ee=Ee.clone(),Ee.channel=we.texCoord),Le.extensions[f.KHR_TEXTURE_TRANSFORM]){let ze=we.extensions!==void 0?we.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0;if(ze){let Ge=Le.associations.get(Ee);Ee=Le.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(Ee,ze),Le.associations.set(Ee,Ge)}}return Ae!==void 0&&(Ee.colorSpace=Ae),ae[de]=Ee,Ee})}assignFinalMaterial(ae){let de=ae.geometry,we=ae.material,Ae=de.attributes.tangent===void 0,Le=de.attributes.color!==void 0,Ee=de.attributes.normal===void 0;if(ae.isPoints){let ze="PointsMaterial:"+we.uuid,Ge=this.cache.get(ze);Ge||(Ge=new l.PointsMaterial,l.Material.prototype.copy.call(Ge,we),Ge.color.copy(we.color),Ge.map=we.map,Ge.sizeAttenuation=!1,this.cache.add(ze,Ge)),we=Ge}else if(ae.isLine){let ze="LineBasicMaterial:"+we.uuid,Ge=this.cache.get(ze);Ge||(Ge=new l.LineBasicMaterial,l.Material.prototype.copy.call(Ge,we),Ge.color.copy(we.color),Ge.map=we.map,this.cache.add(ze,Ge)),we=Ge}if(Ae||Le||Ee){let ze="ClonedMaterial:"+we.uuid+":";Ae&&(ze+="derivative-tangents:"),Le&&(ze+="vertex-colors:"),Ee&&(ze+="flat-shading:");let Ge=this.cache.get(ze);Ge||(Ge=we.clone(),Le&&(Ge.vertexColors=!0),Ee&&(Ge.flatShading=!0),Ae&&(Ge.normalScale&&(Ge.normalScale.y*=-1),Ge.clearcoatNormalScale&&(Ge.clearcoatNormalScale.y*=-1)),this.cache.add(ze,Ge),this.associations.set(Ge,this.associations.get(we))),we=Ge}ae.material=we}getMaterialType(){return l.MeshStandardMaterial}loadMaterial(ae){let de=this,we=this.json,Ae=this.extensions,Le=we.materials[ae],Ee,ze={},Ge=Le.extensions||{},ee=[];if(Ge[f.KHR_MATERIALS_UNLIT]){let G=Ae[f.KHR_MATERIALS_UNLIT];Ee=G.getMaterialType(),ee.push(G.extendParams(ze,Le,de))}else{let G=Le.pbrMetallicRoughness||{};if(ze.color=new l.Color(1,1,1),ze.opacity=1,Array.isArray(G.baseColorFactor)){let pe=G.baseColorFactor;ze.color.setRGB(pe[0],pe[1],pe[2],l.LinearSRGBColorSpace),ze.opacity=pe[3]}G.baseColorTexture!==void 0&&ee.push(de.assignTexture(ze,"map",G.baseColorTexture,l.SRGBColorSpace)),ze.metalness=G.metallicFactor!==void 0?G.metallicFactor:1,ze.roughness=G.roughnessFactor!==void 0?G.roughnessFactor:1,G.metallicRoughnessTexture!==void 0&&(ee.push(de.assignTexture(ze,"metalnessMap",G.metallicRoughnessTexture)),ee.push(de.assignTexture(ze,"roughnessMap",G.metallicRoughnessTexture))),Ee=this._invokeOne(function(pe){return pe.getMaterialType&&pe.getMaterialType(ae)}),ee.push(Promise.all(this._invokeAll(function(pe){return pe.extendMaterialParams&&pe.extendMaterialParams(ae,ze)})))}Le.doubleSided===!0&&(ze.side=l.DoubleSide);let V=Le.alphaMode||It.OPAQUE;if(V===It.BLEND?(ze.transparent=!0,ze.depthWrite=!1):(ze.transparent=!1,V===It.MASK&&(ze.alphaTest=Le.alphaCutoff!==void 0?Le.alphaCutoff:.5)),Le.normalTexture!==void 0&&Ee!==l.MeshBasicMaterial&&(ee.push(de.assignTexture(ze,"normalMap",Le.normalTexture)),ze.normalScale=new l.Vector2(1,1),Le.normalTexture.scale!==void 0)){let G=Le.normalTexture.scale;ze.normalScale.set(G,G)}if(Le.occlusionTexture!==void 0&&Ee!==l.MeshBasicMaterial&&(ee.push(de.assignTexture(ze,"aoMap",Le.occlusionTexture)),Le.occlusionTexture.strength!==void 0&&(ze.aoMapIntensity=Le.occlusionTexture.strength)),Le.emissiveFactor!==void 0&&Ee!==l.MeshBasicMaterial){let G=Le.emissiveFactor;ze.emissive=new l.Color().setRGB(G[0],G[1],G[2],l.LinearSRGBColorSpace)}return Le.emissiveTexture!==void 0&&Ee!==l.MeshBasicMaterial&&ee.push(de.assignTexture(ze,"emissiveMap",Le.emissiveTexture,l.SRGBColorSpace)),Promise.all(ee).then(function(){let G=new Ee(ze);return Le.name&&(G.name=Le.name),pn(G,Le),de.associations.set(G,{materials:ae}),Le.extensions&&Ne(Ae,G,Le),G})}createUniqueName(ae){let de=l.PropertyBinding.sanitizeNodeName(ae||"");return de in this.nodeNamesUsed?de+"_"+ ++this.nodeNamesUsed[de]:(this.nodeNamesUsed[de]=0,de)}loadGeometries(ae){let de=this,we=this.extensions,Ae=this.primitiveCache;function Le(ze){return we[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ze,de).then(function(Ge){return De(Ge,ze,de)})}let Ee=[];for(let ze=0,Ge=ae.length;ze<Ge;ze++){let ee=ae[ze],V=Ot(ee),G=Ae[V];if(G)Ee.push(G.promise);else{let pe;ee.extensions&&ee.extensions[f.KHR_DRACO_MESH_COMPRESSION]?pe=Le(ee):pe=De(new l.BufferGeometry,ee,de),Ae[V]={primitive:ee,promise:pe},Ee.push(pe)}}return Promise.all(Ee)}loadMesh(ae){let de=this,we=this.json,Ae=this.extensions,Le=we.meshes[ae],Ee=Le.primitives,ze=[];for(let Ge=0,ee=Ee.length;Ge<ee;Ge++){let V=Ee[Ge].material===void 0?Ft(this.cache):this.getDependency("material",Ee[Ge].material);ze.push(V)}return ze.push(de.loadGeometries(Ee)),Promise.all(ze).then(function(Ge){let ee=Ge.slice(0,Ge.length-1),V=Ge[Ge.length-1],G=[];for(let Ue=0,Qe=V.length;Ue<Qe;Ue++){let $e=V[Ue],nt=Ee[Ue],ge,ot=ee[Ue];if(nt.mode===xe.TRIANGLES||nt.mode===xe.TRIANGLE_STRIP||nt.mode===xe.TRIANGLE_FAN||nt.mode===void 0)ge=Le.isSkinnedMesh===!0?new l.SkinnedMesh($e,ot):new l.Mesh($e,ot),ge.isSkinnedMesh===!0&&ge.normalizeSkinWeights(),nt.mode===xe.TRIANGLE_STRIP?ge.geometry=(0,u.toTrianglesDrawMode)(ge.geometry,l.TriangleStripDrawMode):nt.mode===xe.TRIANGLE_FAN&&(ge.geometry=(0,u.toTrianglesDrawMode)(ge.geometry,l.TriangleFanDrawMode));else if(nt.mode===xe.LINES)ge=new l.LineSegments($e,ot);else if(nt.mode===xe.LINE_STRIP)ge=new l.Line($e,ot);else if(nt.mode===xe.LINE_LOOP)ge=new l.LineLoop($e,ot);else if(nt.mode===xe.POINTS)ge=new l.Points($e,ot);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+nt.mode);Object.keys(ge.geometry.morphAttributes).length>0&&Vt(ge,Le),ge.name=de.createUniqueName(Le.name||"mesh_"+ae),pn(ge,Le),nt.extensions&&Ne(Ae,ge,nt),de.assignFinalMaterial(ge),G.push(ge)}for(let Ue=0,Qe=G.length;Ue<Qe;Ue++)de.associations.set(G[Ue],{meshes:ae,primitives:Ue});if(G.length===1)return Le.extensions&&Ne(Ae,G[0],Le),G[0];let pe=new l.Group;Le.extensions&&Ne(Ae,pe,Le),de.associations.set(pe,{meshes:ae});for(let Ue=0,Qe=G.length;Ue<Qe;Ue++)pe.add(G[Ue]);return pe})}loadCamera(ae){let de,we=this.json.cameras[ae],Ae=we[we.type];if(!Ae){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return we.type==="perspective"?de=new l.PerspectiveCamera(l.MathUtils.radToDeg(Ae.yfov),Ae.aspectRatio||1,Ae.znear||1,Ae.zfar||2e6):we.type==="orthographic"&&(de=new l.OrthographicCamera(-Ae.xmag,Ae.xmag,Ae.ymag,-Ae.ymag,Ae.znear,Ae.zfar)),we.name&&(de.name=this.createUniqueName(we.name)),pn(de,we),Promise.resolve(de)}loadSkin(ae){let de=this.json.skins[ae],we=[];for(let Ae=0,Le=de.joints.length;Ae<Le;Ae++)we.push(this._loadNodeShallow(de.joints[Ae]));return de.inverseBindMatrices!==void 0?we.push(this.getDependency("accessor",de.inverseBindMatrices)):we.push(null),Promise.all(we).then(function(Ae){let Le=Ae.pop(),Ee=Ae,ze=[],Ge=[];for(let ee=0,V=Ee.length;ee<V;ee++){let G=Ee[ee];if(G){ze.push(G);let pe=new l.Matrix4;Le!==null&&pe.fromArray(Le.array,ee*16),Ge.push(pe)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',de.joints[ee])}return new l.Skeleton(ze,Ge)})}loadAnimation(ae){let de=this.json,we=this,Ae=de.animations[ae],Le=Ae.name?Ae.name:"animation_"+ae,Ee=[],ze=[],Ge=[],ee=[],V=[];for(let G=0,pe=Ae.channels.length;G<pe;G++){let Ue=Ae.channels[G],Qe=Ae.samplers[Ue.sampler],$e=Ue.target,nt=$e.node,ge=Ae.parameters!==void 0?Ae.parameters[Qe.input]:Qe.input,ot=Ae.parameters!==void 0?Ae.parameters[Qe.output]:Qe.output;$e.node!==void 0&&(Ee.push(this.getDependency("node",nt)),ze.push(this.getDependency("accessor",ge)),Ge.push(this.getDependency("accessor",ot)),ee.push(Qe),V.push($e))}return Promise.all([Promise.all(Ee),Promise.all(ze),Promise.all(Ge),Promise.all(ee),Promise.all(V)]).then(function(G){let pe=G[0],Ue=G[1],Qe=G[2],$e=G[3],nt=G[4],ge=[];for(let ot=0,et=pe.length;ot<et;ot++){let tt=pe[ot],_t=Ue[ot],tn=Qe[ot],En=$e[ot],Cn=nt[ot];if(tt===void 0)continue;tt.updateMatrix&&tt.updateMatrix();let en=we._createAnimationTracks(tt,_t,tn,En,Cn);if(en)for(let xt=0;xt<en.length;xt++)ge.push(en[xt])}return new l.AnimationClip(Le,void 0,ge)})}createNodeMesh(ae){let de=this.json,we=this,Ae=de.nodes[ae];return Ae.mesh===void 0?null:we.getDependency("mesh",Ae.mesh).then(function(Le){let Ee=we._getNodeRef(we.meshCache,Ae.mesh,Le);return Ae.weights!==void 0&&Ee.traverse(function(ze){if(ze.isMesh)for(let Ge=0,ee=Ae.weights.length;Ge<ee;Ge++)ze.morphTargetInfluences[Ge]=Ae.weights[Ge]}),Ee})}loadNode(ae){let de=this.json,we=this,Ae=de.nodes[ae],Le=we._loadNodeShallow(ae),Ee=[],ze=Ae.children||[];for(let ee=0,V=ze.length;ee<V;ee++)Ee.push(we.getDependency("node",ze[ee]));let Ge=Ae.skin===void 0?Promise.resolve(null):we.getDependency("skin",Ae.skin);return Promise.all([Le,Promise.all(Ee),Ge]).then(function(ee){let V=ee[0],G=ee[1],pe=ee[2];pe!==null&&V.traverse(function(Ue){Ue.isSkinnedMesh&&Ue.bind(pe,Ie)});for(let Ue=0,Qe=G.length;Ue<Qe;Ue++)V.add(G[Ue]);return V})}_loadNodeShallow(ae){let de=this.json,we=this.extensions,Ae=this;if(this.nodeCache[ae]!==void 0)return this.nodeCache[ae];let Le=de.nodes[ae],Ee=Le.name?Ae.createUniqueName(Le.name):"",ze=[],Ge=Ae._invokeOne(function(ee){return ee.createNodeMesh&&ee.createNodeMesh(ae)});return Ge&&ze.push(Ge),Le.camera!==void 0&&ze.push(Ae.getDependency("camera",Le.camera).then(function(ee){return Ae._getNodeRef(Ae.cameraCache,Le.camera,ee)})),Ae._invokeAll(function(ee){return ee.createNodeAttachment&&ee.createNodeAttachment(ae)}).forEach(function(ee){ze.push(ee)}),this.nodeCache[ae]=Promise.all(ze).then(function(ee){let V;if(Le.isBone===!0?V=new l.Bone:ee.length>1?V=new l.Group:ee.length===1?V=ee[0]:V=new l.Object3D,V!==ee[0])for(let G=0,pe=ee.length;G<pe;G++)V.add(ee[G]);if(Le.name&&(V.userData.name=Le.name,V.name=Ee),pn(V,Le),Le.extensions&&Ne(we,V,Le),Le.matrix!==void 0){let G=new l.Matrix4;G.fromArray(Le.matrix),V.applyMatrix4(G)}else Le.translation!==void 0&&V.position.fromArray(Le.translation),Le.rotation!==void 0&&V.quaternion.fromArray(Le.rotation),Le.scale!==void 0&&V.scale.fromArray(Le.scale);return Ae.associations.has(V)||Ae.associations.set(V,{}),Ae.associations.get(V).nodes=ae,V}),this.nodeCache[ae]}loadScene(ae){let de=this.extensions,we=this.json.scenes[ae],Ae=this,Le=new l.Group;we.name&&(Le.name=Ae.createUniqueName(we.name)),pn(Le,we),we.extensions&&Ne(de,Le,we);let Ee=we.nodes||[],ze=[];for(let Ge=0,ee=Ee.length;Ge<ee;Ge++)ze.push(Ae.getDependency("node",Ee[Ge]));return Promise.all(ze).then(function(Ge){for(let V=0,G=Ge.length;V<G;V++)Le.add(Ge[V]);let ee=V=>{let G=new Map;for(let[pe,Ue]of Ae.associations)(pe instanceof l.Material||pe instanceof l.Texture)&&G.set(pe,Ue);return V.traverse(pe=>{let Ue=Ae.associations.get(pe);Ue!=null&&G.set(pe,Ue)}),G};return Ae.associations=ee(Le),Le})}_createAnimationTracks(ae,de,we,Ae,Le){let Ee=[],ze=ae.name?ae.name:ae.uuid,Ge=[];gt[Le.path]===gt.weights?ae.traverse(function(pe){pe.morphTargetInfluences&&Ge.push(pe.name?pe.name:pe.uuid)}):Ge.push(ze);let ee;switch(gt[Le.path]){case gt.weights:ee=l.NumberKeyframeTrack;break;case gt.rotation:ee=l.QuaternionKeyframeTrack;break;case gt.position:case gt.scale:ee=l.VectorKeyframeTrack;break;default:switch(we.itemSize){case 1:ee=l.NumberKeyframeTrack;break;case 2:case 3:default:ee=l.VectorKeyframeTrack;break}break}let V=Ae.interpolation!==void 0?Rt[Ae.interpolation]:l.InterpolateLinear,G=this._getArrayFromAccessor(we);for(let pe=0,Ue=Ge.length;pe<Ue;pe++){let Qe=new ee(Ge[pe]+"."+gt[Le.path],de.array,G,V);Ae.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Qe),Ee.push(Qe)}return Ee}_getArrayFromAccessor(ae){let de=ae.array;if(ae.normalized){let we=Jt(de.constructor),Ae=new Float32Array(de.length);for(let Le=0,Ee=de.length;Le<Ee;Le++)Ae[Le]=de[Le]*we;de=Ae}return de}_createCubicSplineTrackInterpolant(ae){ae.createInterpolant=function(we){let Ae=this instanceof l.QuaternionKeyframeTrack?Me:Z;return new Ae(this.times,this.values,this.getValueSize()/3,we)},ae.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function kt(he,ae,de){let we=ae.attributes,Ae=new l.Box3;if(we.POSITION!==void 0){let ze=de.json.accessors[we.POSITION],Ge=ze.min,ee=ze.max;if(Ge!==void 0&&ee!==void 0){if(Ae.set(new l.Vector3(Ge[0],Ge[1],Ge[2]),new l.Vector3(ee[0],ee[1],ee[2])),ze.normalized){let V=Jt(be[ze.componentType]);Ae.min.multiplyScalar(V),Ae.max.multiplyScalar(V)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let Le=ae.targets;if(Le!==void 0){let ze=new l.Vector3,Ge=new l.Vector3;for(let ee=0,V=Le.length;ee<V;ee++){let G=Le[ee];if(G.POSITION!==void 0){let pe=de.json.accessors[G.POSITION],Ue=pe.min,Qe=pe.max;if(Ue!==void 0&&Qe!==void 0){if(Ge.setX(Math.max(Math.abs(Ue[0]),Math.abs(Qe[0]))),Ge.setY(Math.max(Math.abs(Ue[1]),Math.abs(Qe[1]))),Ge.setZ(Math.max(Math.abs(Ue[2]),Math.abs(Qe[2]))),pe.normalized){let $e=Jt(be[pe.componentType]);Ge.multiplyScalar($e)}ze.max(Ge)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Ae.expandByVector(ze)}he.boundingBox=Ae;let Ee=new l.Sphere;Ae.getCenter(Ee.center),Ee.radius=Ae.min.distanceTo(Ae.max)/2,he.boundingSphere=Ee}function De(he,ae,de){let we=ae.attributes,Ae=[];function Le(Ee,ze){return de.getDependency("accessor",Ee).then(function(Ge){he.setAttribute(ze,Ge)})}for(let Ee in we){let ze=it[Ee]||Ee.toLowerCase();ze in he.attributes||Ae.push(Le(we[Ee],ze))}if(ae.indices!==void 0&&!he.index){let Ee=de.getDependency("accessor",ae.indices).then(function(ze){he.setIndex(ze)});Ae.push(Ee)}return l.ColorManagement.workingColorSpace!==l.LinearSRGBColorSpace&&"COLOR_0"in we&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${l.ColorManagement.workingColorSpace}" not supported.`),pn(he,ae),kt(he,ae,de),Promise.all(Ae).then(function(){return ae.targets!==void 0?St(he,ae.targets,de):he})}},"./node_modules/super-three/examples/jsm/loaders/KTX2Loader.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{KTX2Loader:()=>y});var l=c("./node_modules/super-three/build/three.module.js"),u=c("./node_modules/super-three/examples/jsm/utils/WorkerPool.js"),h=c("./node_modules/super-three/examples/jsm/libs/ktx-parse.module.js"),p=c("./node_modules/super-three/examples/jsm/libs/zstddec.module.js");let f=new WeakMap,m=0,A;class y extends l.Loader{constructor(D){super(D),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new u.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(D){return this.transcoderPath=D,this}setWorkerLimit(D){return this.workerPool.setWorkerLimit(D),this}detectSupport(D){return D.isWebGPURenderer===!0?this.workerConfig={astcSupported:D.hasFeature("texture-compression-astc"),etc1Supported:!1,etc2Supported:D.hasFeature("texture-compression-etc2"),dxtSupported:D.hasFeature("texture-compression-bc"),bptcSupported:!1,pvrtcSupported:!1}:(this.workerConfig={astcSupported:D.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:D.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:D.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:D.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:D.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:D.extensions.has("WEBGL_compressed_texture_pvrtc")||D.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},D.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1)),this}init(){if(!this.transcoderPending){let D=new l.FileLoader(this.manager);D.setPath(this.transcoderPath),D.setWithCredentials(this.withCredentials);let L=D.loadAsync("basis_transcoder.js"),I=new l.FileLoader(this.manager);I.setPath(this.transcoderPath),I.setResponseType("arraybuffer"),I.setWithCredentials(this.withCredentials);let F=I.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([L,F]).then(([R,N])=>{let X=y.BasisWorker.toString(),$=["/* constants */","let _EngineFormat = "+JSON.stringify(y.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(y.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(y.BasisFormat),"/* basis_transcoder.js */",R,"/* worker */",X.substring(X.indexOf("{")+1,X.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([$])),this.transcoderBinary=N,this.workerPool.setWorkerCreator(()=>{let te=new Worker(this.workerSourceURL),U=this.transcoderBinary.slice(0);return te.postMessage({type:"init",config:this.workerConfig,transcoderBinary:U},[U]),te})}),m>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),m++}return this.transcoderPending}load(D,L,I,F){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");let R=new l.FileLoader(this.manager);R.setResponseType("arraybuffer"),R.setWithCredentials(this.withCredentials),R.load(D,N=>{if(f.has(N))return f.get(N).promise.then(L).catch(F);this._createTexture(N).then(X=>L?L(X):null).catch(F)},I,F)}_createTextureFrom(D,L){let{faces:I,width:F,height:R,format:N,type:X,error:$,dfdFlags:te}=D;if(X==="error")return Promise.reject($);let U;if(L.faceCount===6)U=new l.CompressedCubeTexture(I,N,l.UnsignedByteType);else{let P=I[0].mipmaps;U=L.layerCount>1?new l.CompressedArrayTexture(P,F,R,L.layerCount,N,l.UnsignedByteType):new l.CompressedTexture(P,F,R,N,l.UnsignedByteType)}return U.minFilter=I[0].mipmaps.length===1?l.LinearFilter:l.LinearMipmapLinearFilter,U.magFilter=l.LinearFilter,U.generateMipmaps=!1,U.needsUpdate=!0,U.colorSpace=M(L),U.premultiplyAlpha=!!(te&h.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),U}_createTexture(I){return So(this,arguments,function*(D,L={}){let F=(0,h.read)(new Uint8Array(D));if(F.vkFormat!==h.VK_FORMAT_UNDEFINED)return w(F);let R=L,N=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:D,taskConfig:R},[D])).then(X=>this._createTextureFrom(X.data,F));return f.set(D,{promise:N}),N})}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),m--,this}}y.BasisFormat={ETC1S:0,UASTC_4x4:1},y.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},y.EngineFormat={RGBAFormat:l.RGBAFormat,RGBA_ASTC_4x4_Format:l.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:l.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:l.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:l.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:l.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:l.RGB_ETC1_Format,RGB_ETC2_Format:l.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:l.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:l.RGB_S3TC_DXT1_Format},y.BasisWorker=function(){let T,D,L,I=_EngineFormat,F=_TranscoderFormat,R=_BasisFormat;self.addEventListener("message",function(Q){let Z=Q.data;switch(Z.type){case"init":T=Z.config,N(Z.transcoderBinary);break;case"transcode":D.then(()=>{try{let{faces:ce,buffers:Me,width:xe,height:be,hasAlpha:Fe,format:Ze,dfdFlags:ut}=X(Z.buffer);self.postMessage({type:"transcode",id:Z.id,faces:ce,width:xe,height:be,hasAlpha:Fe,format:Ze,dfdFlags:ut},Me)}catch(ce){console.error(ce),self.postMessage({type:"error",id:Z.id,error:ce.message})}});break}});function N(Q){D=new Promise(Z=>{L={wasmBinary:Q,onRuntimeInitialized:Z},BASIS(L)}).then(()=>{L.initializeBasis(),L.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function X(Q){let Z=new L.KTX2File(new Uint8Array(Q));function ce(){Z.close(),Z.delete()}if(!Z.isValid())throw ce(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let Me=Z.isUASTC()?R.UASTC_4x4:R.ETC1S,xe=Z.getWidth(),be=Z.getHeight(),Fe=Z.getLayers()||1,Ze=Z.getLevels(),ut=Z.getFaces(),it=Z.getHasAlpha(),gt=Z.getDFDFlags(),{transcoderFormat:Rt,engineFormat:It}=P(Me,xe,be,it);if(!xe||!be||!Ze)throw ce(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Z.startTranscoding())throw ce(),new Error("THREE.KTX2Loader: .startTranscoding failed");let Ft=[],Ne=[];for(let pn=0;pn<ut;pn++){let St=[];for(let Vt=0;Vt<Ze;Vt++){let Ot=[],xn,Jt;for(let Ie=0;Ie<Fe;Ie++){let yt=Z.getImageLevelInfo(Vt,Ie,pn);pn===0&&Vt===0&&Ie===0&&(yt.origWidth%4!==0||yt.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Ze>1?(xn=yt.origWidth,Jt=yt.origHeight):(xn=yt.width,Jt=yt.height);let kt=new Uint8Array(Z.getImageTranscodedSizeInBytes(Vt,Ie,0,Rt));if(!Z.transcodeImage(kt,Vt,Ie,pn,Rt,0,-1,-1))throw ce(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Ot.push(kt)}let Oe=z(Ot);St.push({data:Oe,width:xn,height:Jt}),Ne.push(Oe.buffer)}Ft.push({mipmaps:St,width:xe,height:be,format:It})}return ce(),{faces:Ft,buffers:Ne,width:xe,height:be,hasAlpha:it,format:It,dfdFlags:gt}}let $=[{if:"astcSupported",basisFormat:[R.UASTC_4x4],transcoderFormat:[F.ASTC_4x4,F.ASTC_4x4],engineFormat:[I.RGBA_ASTC_4x4_Format,I.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[R.ETC1S,R.UASTC_4x4],transcoderFormat:[F.BC7_M5,F.BC7_M5],engineFormat:[I.RGBA_BPTC_Format,I.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[R.ETC1S,R.UASTC_4x4],transcoderFormat:[F.BC1,F.BC3],engineFormat:[I.RGB_S3TC_DXT1_Format,I.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[R.ETC1S,R.UASTC_4x4],transcoderFormat:[F.ETC1,F.ETC2],engineFormat:[I.RGB_ETC2_Format,I.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[R.ETC1S,R.UASTC_4x4],transcoderFormat:[F.ETC1],engineFormat:[I.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[R.ETC1S,R.UASTC_4x4],transcoderFormat:[F.PVRTC1_4_RGB,F.PVRTC1_4_RGBA],engineFormat:[I.RGB_PVRTC_4BPPV1_Format,I.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],te=$.sort(function(Q,Z){return Q.priorityETC1S-Z.priorityETC1S}),U=$.sort(function(Q,Z){return Q.priorityUASTC-Z.priorityUASTC});function P(Q,Z,ce,Me){let xe,be,Fe=Q===R.ETC1S?te:U;for(let Ze=0;Ze<Fe.length;Ze++){let ut=Fe[Ze];if(T[ut.if]&&ut.basisFormat.includes(Q)&&!(Me&&ut.transcoderFormat.length<2)&&!(ut.needsPowerOfTwo&&!(k(Z)&&k(ce))))return xe=ut.transcoderFormat[Me?1:0],be=ut.engineFormat[Me?1:0],{transcoderFormat:xe,engineFormat:be}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),xe=F.RGBA32,be=I.RGBAFormat,{transcoderFormat:xe,engineFormat:be}}function k(Q){return Q<=2?!0:(Q&Q-1)===0&&Q!==0}function z(Q){if(Q.length===1)return Q[0];let Z=0;for(let xe=0;xe<Q.length;xe++){let be=Q[xe];Z+=be.byteLength}let ce=new Uint8Array(Z),Me=0;for(let xe=0;xe<Q.length;xe++){let be=Q[xe];ce.set(be,Me),Me+=be.byteLength}return ce}};let E=new Set([l.RGBAFormat,l.RGFormat,l.RedFormat]),x={[h.VK_FORMAT_R32G32B32A32_SFLOAT]:l.RGBAFormat,[h.VK_FORMAT_R16G16B16A16_SFLOAT]:l.RGBAFormat,[h.VK_FORMAT_R8G8B8A8_UNORM]:l.RGBAFormat,[h.VK_FORMAT_R8G8B8A8_SRGB]:l.RGBAFormat,[h.VK_FORMAT_R32G32_SFLOAT]:l.RGFormat,[h.VK_FORMAT_R16G16_SFLOAT]:l.RGFormat,[h.VK_FORMAT_R8G8_UNORM]:l.RGFormat,[h.VK_FORMAT_R8G8_SRGB]:l.RGFormat,[h.VK_FORMAT_R32_SFLOAT]:l.RedFormat,[h.VK_FORMAT_R16_SFLOAT]:l.RedFormat,[h.VK_FORMAT_R8_SRGB]:l.RedFormat,[h.VK_FORMAT_R8_UNORM]:l.RedFormat,[h.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:l.RGBA_ASTC_6x6_Format,[h.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:l.RGBA_ASTC_6x6_Format},v={[h.VK_FORMAT_R32G32B32A32_SFLOAT]:l.FloatType,[h.VK_FORMAT_R16G16B16A16_SFLOAT]:l.HalfFloatType,[h.VK_FORMAT_R8G8B8A8_UNORM]:l.UnsignedByteType,[h.VK_FORMAT_R8G8B8A8_SRGB]:l.UnsignedByteType,[h.VK_FORMAT_R32G32_SFLOAT]:l.FloatType,[h.VK_FORMAT_R16G16_SFLOAT]:l.HalfFloatType,[h.VK_FORMAT_R8G8_UNORM]:l.UnsignedByteType,[h.VK_FORMAT_R8G8_SRGB]:l.UnsignedByteType,[h.VK_FORMAT_R32_SFLOAT]:l.FloatType,[h.VK_FORMAT_R16_SFLOAT]:l.HalfFloatType,[h.VK_FORMAT_R8_SRGB]:l.UnsignedByteType,[h.VK_FORMAT_R8_UNORM]:l.UnsignedByteType,[h.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:l.UnsignedByteType,[h.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:l.UnsignedByteType};function w(T){return So(this,null,function*(){let{vkFormat:D}=T;if(x[D]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let L;T.supercompressionScheme===h.KHR_SUPERCOMPRESSION_ZSTD&&(A||(A=new Promise(R=>So(this,null,function*(){let N=new p.ZSTDDecoder;yield N.init(),R(N)}))),L=yield A);let I=[];for(let R=0;R<T.levels.length;R++){let N=Math.max(1,T.pixelWidth>>R),X=Math.max(1,T.pixelHeight>>R),$=T.pixelDepth?Math.max(1,T.pixelDepth>>R):0,te=T.levels[R],U;if(T.supercompressionScheme===h.KHR_SUPERCOMPRESSION_NONE)U=te.levelData;else if(T.supercompressionScheme===h.KHR_SUPERCOMPRESSION_ZSTD)U=L.decode(te.levelData,te.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let P;v[D]===l.FloatType?P=new Float32Array(U.buffer,U.byteOffset,U.byteLength/Float32Array.BYTES_PER_ELEMENT):v[D]===l.HalfFloatType?P=new Uint16Array(U.buffer,U.byteOffset,U.byteLength/Uint16Array.BYTES_PER_ELEMENT):P=U,I.push({data:P,width:N,height:X,depth:$})}let F;if(E.has(x[D]))F=T.pixelDepth===0?new l.DataTexture(I[0].data,T.pixelWidth,T.pixelHeight):new l.Data3DTexture(I[0].data,T.pixelWidth,T.pixelHeight,T.pixelDepth);else{if(T.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");F=new l.CompressedTexture(I,T.pixelWidth,T.pixelHeight)}return F.mipmaps=I,F.type=v[D],F.format=x[D],F.colorSpace=M(T),F.needsUpdate=!0,Promise.resolve(F)})}function M(T){let D=T.dataFormatDescriptor[0];return D.colorPrimaries===h.KHR_DF_PRIMARIES_BT709?D.transferFunction===h.KHR_DF_TRANSFER_SRGB?l.SRGBColorSpace:l.LinearSRGBColorSpace:D.colorPrimaries===h.KHR_DF_PRIMARIES_DISPLAYP3?D.transferFunction===h.KHR_DF_TRANSFER_SRGB?l.DisplayP3ColorSpace:l.LinearDisplayP3ColorSpace:(D.colorPrimaries===h.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${D.colorPrimaries}"`),l.NoColorSpace)}},"./node_modules/super-three/examples/jsm/loaders/MTLLoader.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{MTLLoader:()=>u});var l=c("./node_modules/super-three/build/three.module.js");class u extends l.Loader{constructor(f){super(f)}load(f,m,A,y){let E=this,x=this.path===""?l.LoaderUtils.extractUrlBase(f):this.path,v=new l.FileLoader(this.manager);v.setPath(this.path),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(f,function(w){try{m(E.parse(w,x))}catch(M){y?y(M):console.error(M),E.manager.itemError(f)}},A,y)}setMaterialOptions(f){return this.materialOptions=f,this}parse(f,m){let A=f.split(`
`),y={},E=/\s+/,x={};for(let w=0;w<A.length;w++){let M=A[w];if(M=M.trim(),M.length===0||M.charAt(0)==="#")continue;let T=M.indexOf(" "),D=T>=0?M.substring(0,T):M;D=D.toLowerCase();let L=T>=0?M.substring(T+1):"";if(L=L.trim(),D==="newmtl")y={name:L},x[L]=y;else if(D==="ka"||D==="kd"||D==="ks"||D==="ke"){let I=L.split(E,3);y[D]=[parseFloat(I[0]),parseFloat(I[1]),parseFloat(I[2])]}else y[D]=L}let v=new h(this.resourcePath||m,this.materialOptions);return v.setCrossOrigin(this.crossOrigin),v.setManager(this.manager),v.setMaterials(x),v}}class h{constructor(f="",m={}){this.baseUrl=f,this.options=m,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:l.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:l.RepeatWrapping}setCrossOrigin(f){return this.crossOrigin=f,this}setManager(f){this.manager=f}setMaterials(f){this.materialsInfo=this.convert(f),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(f){if(!this.options)return f;let m={};for(let A in f){let y=f[A],E={};m[A]=E;for(let x in y){let v=!0,w=y[x],M=x.toLowerCase();switch(M){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(w=[w[0]/255,w[1]/255,w[2]/255]),this.options&&this.options.ignoreZeroRGBs&&w[0]===0&&w[1]===0&&w[2]===0&&(v=!1);break;default:break}v&&(E[M]=w)}}return m}preload(){for(let f in this.materialsInfo)this.create(f)}getIndex(f){return this.nameLookup[f]}getAsArray(){let f=0;for(let m in this.materialsInfo)this.materialsArray[f]=this.create(m),this.nameLookup[m]=f,f++;return this.materialsArray}create(f){return this.materials[f]===void 0&&this.createMaterial_(f),this.materials[f]}createMaterial_(f){let m=this,A=this.materialsInfo[f],y={name:f,side:this.side};function E(v,w){return typeof w!="string"||w===""?"":/^https?:\/\//i.test(w)?w:v+w}function x(v,w){if(y[v])return;let M=m.getTextureParams(w,y),T=m.loadTexture(E(m.baseUrl,M.url));T.repeat.copy(M.scale),T.offset.copy(M.offset),T.wrapS=m.wrap,T.wrapT=m.wrap,(v==="map"||v==="emissiveMap")&&(T.colorSpace=l.SRGBColorSpace),y[v]=T}for(let v in A){let w=A[v],M;if(w!=="")switch(v.toLowerCase()){case"kd":y.color=new l.Color().fromArray(w).convertSRGBToLinear();break;case"ks":y.specular=new l.Color().fromArray(w).convertSRGBToLinear();break;case"ke":y.emissive=new l.Color().fromArray(w).convertSRGBToLinear();break;case"map_kd":x("map",w);break;case"map_ks":x("specularMap",w);break;case"map_ke":x("emissiveMap",w);break;case"norm":x("normalMap",w);break;case"map_bump":case"bump":x("bumpMap",w);break;case"map_d":x("alphaMap",w),y.transparent=!0;break;case"ns":y.shininess=parseFloat(w);break;case"d":M=parseFloat(w),M<1&&(y.opacity=M,y.transparent=!0);break;case"tr":M=parseFloat(w),this.options&&this.options.invertTrProperty&&(M=1-M),M>0&&(y.opacity=1-M,y.transparent=!0);break;default:break}}return this.materials[f]=new l.MeshPhongMaterial(y),this.materials[f]}getTextureParams(f,m){let A={scale:new l.Vector2(1,1),offset:new l.Vector2(0,0)},y=f.split(/\s+/),E;return E=y.indexOf("-bm"),E>=0&&(m.bumpScale=parseFloat(y[E+1]),y.splice(E,2)),E=y.indexOf("-s"),E>=0&&(A.scale.set(parseFloat(y[E+1]),parseFloat(y[E+2])),y.splice(E,4)),E=y.indexOf("-o"),E>=0&&(A.offset.set(parseFloat(y[E+1]),parseFloat(y[E+2])),y.splice(E,4)),A.url=y.join(" ").trim(),A}loadTexture(f,m,A,y,E){let x=this.manager!==void 0?this.manager:l.DefaultLoadingManager,v=x.getHandler(f);v===null&&(v=new l.TextureLoader(x)),v.setCrossOrigin&&v.setCrossOrigin(this.crossOrigin);let w=v.load(f,A,y,E);return m!==void 0&&(w.mapping=m),w}}},"./node_modules/super-three/examples/jsm/loaders/OBJLoader.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{OBJLoader:()=>T});var l=c("./node_modules/super-three/build/three.module.js");let u=/^[og]\s*(.+)?/,h=/^mtllib /,p=/^usemtl /,f=/^usemap /,m=/\s+/,A=new l.Vector3,y=new l.Vector3,E=new l.Vector3,x=new l.Vector3,v=new l.Vector3,w=new l.Color;function M(){let D={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(L,I){if(this.object&&this.object.fromDeclaration===!1){this.object.name=L,this.object.fromDeclaration=I!==!1;return}let F=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:L||"",fromDeclaration:I!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(R,N){let X=this._finalize(!1);X&&(X.inherited||X.groupCount<=0)&&this.materials.splice(X.index,1);let $={index:this.materials.length,name:R||"",mtllib:Array.isArray(N)&&N.length>0?N[N.length-1]:"",smooth:X!==void 0?X.smooth:this.smooth,groupStart:X!==void 0?X.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(te){let U={index:typeof te=="number"?te:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return U.clone=this.clone.bind(U),U}};return this.materials.push($),$},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(R){let N=this.currentMaterial();if(N&&N.groupEnd===-1&&(N.groupEnd=this.geometry.vertices.length/3,N.groupCount=N.groupEnd-N.groupStart,N.inherited=!1),R&&this.materials.length>1)for(let X=this.materials.length-1;X>=0;X--)this.materials[X].groupCount<=0&&this.materials.splice(X,1);return R&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),N}},F&&F.name&&typeof F.clone=="function"){let R=F.clone(0);R.inherited=!0,this.object.materials.push(R)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(L,I){let F=parseInt(L,10);return(F>=0?F-1:F+I/3)*3},parseNormalIndex:function(L,I){let F=parseInt(L,10);return(F>=0?F-1:F+I/3)*3},parseUVIndex:function(L,I){let F=parseInt(L,10);return(F>=0?F-1:F+I/2)*2},addVertex:function(L,I,F){let R=this.vertices,N=this.object.geometry.vertices;N.push(R[L+0],R[L+1],R[L+2]),N.push(R[I+0],R[I+1],R[I+2]),N.push(R[F+0],R[F+1],R[F+2])},addVertexPoint:function(L){let I=this.vertices;this.object.geometry.vertices.push(I[L+0],I[L+1],I[L+2])},addVertexLine:function(L){let I=this.vertices;this.object.geometry.vertices.push(I[L+0],I[L+1],I[L+2])},addNormal:function(L,I,F){let R=this.normals,N=this.object.geometry.normals;N.push(R[L+0],R[L+1],R[L+2]),N.push(R[I+0],R[I+1],R[I+2]),N.push(R[F+0],R[F+1],R[F+2])},addFaceNormal:function(L,I,F){let R=this.vertices,N=this.object.geometry.normals;A.fromArray(R,L),y.fromArray(R,I),E.fromArray(R,F),v.subVectors(E,y),x.subVectors(A,y),v.cross(x),v.normalize(),N.push(v.x,v.y,v.z),N.push(v.x,v.y,v.z),N.push(v.x,v.y,v.z)},addColor:function(L,I,F){let R=this.colors,N=this.object.geometry.colors;R[L]!==void 0&&N.push(R[L+0],R[L+1],R[L+2]),R[I]!==void 0&&N.push(R[I+0],R[I+1],R[I+2]),R[F]!==void 0&&N.push(R[F+0],R[F+1],R[F+2])},addUV:function(L,I,F){let R=this.uvs,N=this.object.geometry.uvs;N.push(R[L+0],R[L+1]),N.push(R[I+0],R[I+1]),N.push(R[F+0],R[F+1])},addDefaultUV:function(){let L=this.object.geometry.uvs;L.push(0,0),L.push(0,0),L.push(0,0)},addUVLine:function(L){let I=this.uvs;this.object.geometry.uvs.push(I[L+0],I[L+1])},addFace:function(L,I,F,R,N,X,$,te,U){let P=this.vertices.length,k=this.parseVertexIndex(L,P),z=this.parseVertexIndex(I,P),Q=this.parseVertexIndex(F,P);if(this.addVertex(k,z,Q),this.addColor(k,z,Q),$!==void 0&&$!==""){let Z=this.normals.length;k=this.parseNormalIndex($,Z),z=this.parseNormalIndex(te,Z),Q=this.parseNormalIndex(U,Z),this.addNormal(k,z,Q)}else this.addFaceNormal(k,z,Q);if(R!==void 0&&R!==""){let Z=this.uvs.length;k=this.parseUVIndex(R,Z),z=this.parseUVIndex(N,Z),Q=this.parseUVIndex(X,Z),this.addUV(k,z,Q),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(L){this.object.geometry.type="Points";let I=this.vertices.length;for(let F=0,R=L.length;F<R;F++){let N=this.parseVertexIndex(L[F],I);this.addVertexPoint(N),this.addColor(N)}},addLineGeometry:function(L,I){this.object.geometry.type="Line";let F=this.vertices.length,R=this.uvs.length;for(let N=0,X=L.length;N<X;N++)this.addVertexLine(this.parseVertexIndex(L[N],F));for(let N=0,X=I.length;N<X;N++)this.addUVLine(this.parseUVIndex(I[N],R))}};return D.startObject("",!1),D}class T extends l.Loader{constructor(L){super(L),this.materials=null}load(L,I,F,R){let N=this,X=new l.FileLoader(this.manager);X.setPath(this.path),X.setRequestHeader(this.requestHeader),X.setWithCredentials(this.withCredentials),X.load(L,function($){try{I(N.parse($))}catch(te){R?R(te):console.error(te),N.manager.itemError(L)}},F,R)}setMaterials(L){return this.materials=L,this}parse(L){let I=new M;L.indexOf(`\r
`)!==-1&&(L=L.replace(/\r\n/g,`
`)),L.indexOf(`\\
`)!==-1&&(L=L.replace(/\\\n/g,""));let F=L.split(`
`),R=[];for(let $=0,te=F.length;$<te;$++){let U=F[$].trimStart();if(U.length===0)continue;let P=U.charAt(0);if(P!=="#")if(P==="v"){let k=U.split(m);switch(k[0]){case"v":I.vertices.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])),k.length>=7?(w.setRGB(parseFloat(k[4]),parseFloat(k[5]),parseFloat(k[6])).convertSRGBToLinear(),I.colors.push(w.r,w.g,w.b)):I.colors.push(void 0,void 0,void 0);break;case"vn":I.normals.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));break;case"vt":I.uvs.push(parseFloat(k[1]),parseFloat(k[2]));break}}else if(P==="f"){let z=U.slice(1).trim().split(m),Q=[];for(let ce=0,Me=z.length;ce<Me;ce++){let xe=z[ce];if(xe.length>0){let be=xe.split("/");Q.push(be)}}let Z=Q[0];for(let ce=1,Me=Q.length-1;ce<Me;ce++){let xe=Q[ce],be=Q[ce+1];I.addFace(Z[0],xe[0],be[0],Z[1],xe[1],be[1],Z[2],xe[2],be[2])}}else if(P==="l"){let k=U.substring(1).trim().split(" "),z=[],Q=[];if(U.indexOf("/")===-1)z=k;else for(let Z=0,ce=k.length;Z<ce;Z++){let Me=k[Z].split("/");Me[0]!==""&&z.push(Me[0]),Me[1]!==""&&Q.push(Me[1])}I.addLineGeometry(z,Q)}else if(P==="p"){let z=U.slice(1).trim().split(" ");I.addPointGeometry(z)}else if((R=u.exec(U))!==null){let k=(" "+R[0].slice(1).trim()).slice(1);I.startObject(k)}else if(p.test(U))I.object.startMaterial(U.substring(7).trim(),I.materialLibraries);else if(h.test(U))I.materialLibraries.push(U.substring(7).trim());else if(f.test(U))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(P==="s"){if(R=U.split(" "),R.length>1){let z=R[1].trim().toLowerCase();I.object.smooth=z!=="0"&&z!=="off"}else I.object.smooth=!0;let k=I.object.currentMaterial();k&&(k.smooth=I.object.smooth)}else{if(U==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+U+'"')}}I.finalize();let N=new l.Group;if(N.materialLibraries=[].concat(I.materialLibraries),!(I.objects.length===1&&I.objects[0].geometry.vertices.length===0)===!0)for(let $=0,te=I.objects.length;$<te;$++){let U=I.objects[$],P=U.geometry,k=U.materials,z=P.type==="Line",Q=P.type==="Points",Z=!1;if(P.vertices.length===0)continue;let ce=new l.BufferGeometry;ce.setAttribute("position",new l.Float32BufferAttribute(P.vertices,3)),P.normals.length>0&&ce.setAttribute("normal",new l.Float32BufferAttribute(P.normals,3)),P.colors.length>0&&(Z=!0,ce.setAttribute("color",new l.Float32BufferAttribute(P.colors,3))),P.hasUVIndices===!0&&ce.setAttribute("uv",new l.Float32BufferAttribute(P.uvs,2));let Me=[];for(let be=0,Fe=k.length;be<Fe;be++){let Ze=k[be],ut=Ze.name+"_"+Ze.smooth+"_"+Z,it=I.materials[ut];if(this.materials!==null){if(it=this.materials.create(Ze.name),z&&it&&!(it instanceof l.LineBasicMaterial)){let gt=new l.LineBasicMaterial;l.Material.prototype.copy.call(gt,it),gt.color.copy(it.color),it=gt}else if(Q&&it&&!(it instanceof l.PointsMaterial)){let gt=new l.PointsMaterial({size:10,sizeAttenuation:!1});l.Material.prototype.copy.call(gt,it),gt.color.copy(it.color),gt.map=it.map,it=gt}}it===void 0&&(z?it=new l.LineBasicMaterial:Q?it=new l.PointsMaterial({size:1,sizeAttenuation:!1}):it=new l.MeshPhongMaterial,it.name=Ze.name,it.flatShading=!Ze.smooth,it.vertexColors=Z,I.materials[ut]=it),Me.push(it)}let xe;if(Me.length>1){for(let be=0,Fe=k.length;be<Fe;be++){let Ze=k[be];ce.addGroup(Ze.groupStart,Ze.groupCount,be)}z?xe=new l.LineSegments(ce,Me):Q?xe=new l.Points(ce,Me):xe=new l.Mesh(ce,Me)}else z?xe=new l.LineSegments(ce,Me[0]):Q?xe=new l.Points(ce,Me[0]):xe=new l.Mesh(ce,Me[0]);xe.name=U.name,N.add(xe)}else if(I.vertices.length>0){let $=new l.PointsMaterial({size:1,sizeAttenuation:!1}),te=new l.BufferGeometry;te.setAttribute("position",new l.Float32BufferAttribute(I.vertices,3)),I.colors.length>0&&I.colors[0]!==void 0&&(te.setAttribute("color",new l.Float32BufferAttribute(I.colors,3)),$.vertexColors=!0);let U=new l.Points(te,$);N.add(U)}return N}}},"./node_modules/super-three/examples/jsm/math/OBB.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{OBB:()=>F});var l=c("./node_modules/super-three/build/three.module.js");let u={c:null,u:[new l.Vector3,new l.Vector3,new l.Vector3],e:[]},h={c:null,u:[new l.Vector3,new l.Vector3,new l.Vector3],e:[]},p=[[],[],[]],f=[[],[],[]],m=[],A=new l.Vector3,y=new l.Vector3,E=new l.Vector3,x=new l.Vector3,v=new l.Vector3,w=new l.Vector3,M=new l.Matrix3,T=new l.Box3,D=new l.Matrix4,L=new l.Matrix4,I=new l.Ray;class F{constructor(X=new l.Vector3,$=new l.Vector3,te=new l.Matrix3){this.center=X,this.halfSize=$,this.rotation=te}set(X,$,te){return this.center=X,this.halfSize=$,this.rotation=te,this}copy(X){return this.center.copy(X.center),this.halfSize.copy(X.halfSize),this.rotation.copy(X.rotation),this}clone(){return new this.constructor().copy(this)}getSize(X){return X.copy(this.halfSize).multiplyScalar(2)}clampPoint(X,$){let te=this.halfSize;x.subVectors(X,this.center),this.rotation.extractBasis(A,y,E),$.copy(this.center);let U=l.MathUtils.clamp(x.dot(A),-te.x,te.x);$.add(A.multiplyScalar(U));let P=l.MathUtils.clamp(x.dot(y),-te.y,te.y);$.add(y.multiplyScalar(P));let k=l.MathUtils.clamp(x.dot(E),-te.z,te.z);return $.add(E.multiplyScalar(k)),$}containsPoint(X){return x.subVectors(X,this.center),this.rotation.extractBasis(A,y,E),Math.abs(x.dot(A))<=this.halfSize.x&&Math.abs(x.dot(y))<=this.halfSize.y&&Math.abs(x.dot(E))<=this.halfSize.z}intersectsBox3(X){return this.intersectsOBB(R.fromBox3(X))}intersectsSphere(X){return this.clampPoint(X.center,w),w.distanceToSquared(X.center)<=X.radius*X.radius}intersectsOBB(X,$=Number.EPSILON){u.c=this.center,u.e[0]=this.halfSize.x,u.e[1]=this.halfSize.y,u.e[2]=this.halfSize.z,this.rotation.extractBasis(u.u[0],u.u[1],u.u[2]),h.c=X.center,h.e[0]=X.halfSize.x,h.e[1]=X.halfSize.y,h.e[2]=X.halfSize.z,X.rotation.extractBasis(h.u[0],h.u[1],h.u[2]);for(let P=0;P<3;P++)for(let k=0;k<3;k++)p[P][k]=u.u[P].dot(h.u[k]);x.subVectors(h.c,u.c),m[0]=x.dot(u.u[0]),m[1]=x.dot(u.u[1]),m[2]=x.dot(u.u[2]);for(let P=0;P<3;P++)for(let k=0;k<3;k++)f[P][k]=Math.abs(p[P][k])+$;let te,U;for(let P=0;P<3;P++)if(te=u.e[P],U=h.e[0]*f[P][0]+h.e[1]*f[P][1]+h.e[2]*f[P][2],Math.abs(m[P])>te+U)return!1;for(let P=0;P<3;P++)if(te=u.e[0]*f[0][P]+u.e[1]*f[1][P]+u.e[2]*f[2][P],U=h.e[P],Math.abs(m[0]*p[0][P]+m[1]*p[1][P]+m[2]*p[2][P])>te+U)return!1;return te=u.e[1]*f[2][0]+u.e[2]*f[1][0],U=h.e[1]*f[0][2]+h.e[2]*f[0][1],!(Math.abs(m[2]*p[1][0]-m[1]*p[2][0])>te+U||(te=u.e[1]*f[2][1]+u.e[2]*f[1][1],U=h.e[0]*f[0][2]+h.e[2]*f[0][0],Math.abs(m[2]*p[1][1]-m[1]*p[2][1])>te+U)||(te=u.e[1]*f[2][2]+u.e[2]*f[1][2],U=h.e[0]*f[0][1]+h.e[1]*f[0][0],Math.abs(m[2]*p[1][2]-m[1]*p[2][2])>te+U)||(te=u.e[0]*f[2][0]+u.e[2]*f[0][0],U=h.e[1]*f[1][2]+h.e[2]*f[1][1],Math.abs(m[0]*p[2][0]-m[2]*p[0][0])>te+U)||(te=u.e[0]*f[2][1]+u.e[2]*f[0][1],U=h.e[0]*f[1][2]+h.e[2]*f[1][0],Math.abs(m[0]*p[2][1]-m[2]*p[0][1])>te+U)||(te=u.e[0]*f[2][2]+u.e[2]*f[0][2],U=h.e[0]*f[1][1]+h.e[1]*f[1][0],Math.abs(m[0]*p[2][2]-m[2]*p[0][2])>te+U)||(te=u.e[0]*f[1][0]+u.e[1]*f[0][0],U=h.e[1]*f[2][2]+h.e[2]*f[2][1],Math.abs(m[1]*p[0][0]-m[0]*p[1][0])>te+U)||(te=u.e[0]*f[1][1]+u.e[1]*f[0][1],U=h.e[0]*f[2][2]+h.e[2]*f[2][0],Math.abs(m[1]*p[0][1]-m[0]*p[1][1])>te+U)||(te=u.e[0]*f[1][2]+u.e[1]*f[0][2],U=h.e[0]*f[2][1]+h.e[1]*f[2][0],Math.abs(m[1]*p[0][2]-m[0]*p[1][2])>te+U))}intersectsPlane(X){this.rotation.extractBasis(A,y,E);let $=this.halfSize.x*Math.abs(X.normal.dot(A))+this.halfSize.y*Math.abs(X.normal.dot(y))+this.halfSize.z*Math.abs(X.normal.dot(E)),te=X.normal.dot(this.center)-X.constant;return Math.abs(te)<=$}intersectRay(X,$){return this.getSize(v),T.setFromCenterAndSize(x.set(0,0,0),v),D.setFromMatrix3(this.rotation),D.setPosition(this.center),L.copy(D).invert(),I.copy(X).applyMatrix4(L),I.intersectBox(T,$)?$.applyMatrix4(D):null}intersectsRay(X){return this.intersectRay(X,x)!==null}fromBox3(X){return X.getCenter(this.center),X.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(X){return X.center.equals(this.center)&&X.halfSize.equals(this.halfSize)&&X.rotation.equals(this.rotation)}applyMatrix4(X){let $=X.elements,te=x.set($[0],$[1],$[2]).length(),U=x.set($[4],$[5],$[6]).length(),P=x.set($[8],$[9],$[10]).length();X.determinant()<0&&(te=-te),M.setFromMatrix4(X);let z=1/te,Q=1/U,Z=1/P;return M.elements[0]*=z,M.elements[1]*=z,M.elements[2]*=z,M.elements[3]*=Q,M.elements[4]*=Q,M.elements[5]*=Q,M.elements[6]*=Z,M.elements[7]*=Z,M.elements[8]*=Z,this.rotation.multiply(M),this.halfSize.x*=te,this.halfSize.y*=U,this.halfSize.z*=P,x.setFromMatrixPosition(X),this.center.add(x),this}}let R=new F},"./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{computeMikkTSpaceTangents:()=>u,computeMorphedAttributes:()=>w,deepCloneAttribute:()=>f,deinterleaveAttribute:()=>A,deinterleaveGeometry:()=>y,estimateBytesUsed:()=>E,interleaveAttributes:()=>m,mergeAttributes:()=>p,mergeBufferAttributes:()=>L,mergeBufferGeometries:()=>D,mergeGeometries:()=>h,mergeGroups:()=>M,mergeVertices:()=>x,toCreasedNormals:()=>T,toTrianglesDrawMode:()=>v});var l=c("./node_modules/super-three/build/three.module.js");function u(I,F,R=!0){if(!F||!F.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!I.hasAttribute("position")||!I.hasAttribute("normal")||!I.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function N(te){if(te.normalized||te.isInterleavedBufferAttribute){let U=new Float32Array(te.count*te.itemSize);for(let P=0,k=0;P<te.count;P++)U[k++]=te.getX(P),U[k++]=te.getY(P),te.itemSize>2&&(U[k++]=te.getZ(P));return U}return te.array instanceof Float32Array?te.array:new Float32Array(te.array)}let X=I.index?I.toNonIndexed():I,$=F.generateTangents(N(X.attributes.position),N(X.attributes.normal),N(X.attributes.uv));if(R)for(let te=3;te<$.length;te+=4)$[te]*=-1;return X.setAttribute("tangent",new l.BufferAttribute($,4)),I!==X&&I.copy(X),I}function h(I,F=!1){let R=I[0].index!==null,N=new Set(Object.keys(I[0].attributes)),X=new Set(Object.keys(I[0].morphAttributes)),$={},te={},U=I[0].morphTargetsRelative,P=new l.BufferGeometry,k=0;for(let z=0;z<I.length;++z){let Q=I[z],Z=0;if(R!==(Q.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let ce in Q.attributes){if(!N.has(ce))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+'. All geometries must have compatible attributes; make sure "'+ce+'" attribute exists among all geometries, or in none of them.'),null;$[ce]===void 0&&($[ce]=[]),$[ce].push(Q.attributes[ce]),Z++}if(Z!==N.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+". Make sure all geometries have the same number of attributes."),null;if(U!==Q.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let ce in Q.morphAttributes){if(!X.has(ce))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+".  .morphAttributes must be consistent throughout all geometries."),null;te[ce]===void 0&&(te[ce]=[]),te[ce].push(Q.morphAttributes[ce])}if(F){let ce;if(R)ce=Q.index.count;else if(Q.attributes.position!==void 0)ce=Q.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+z+". The geometry must have either an index or a position attribute"),null;P.addGroup(k,ce,z),k+=ce}}if(R){let z=0,Q=[];for(let Z=0;Z<I.length;++Z){let ce=I[Z].index;for(let Me=0;Me<ce.count;++Me)Q.push(ce.getX(Me)+z);z+=I[Z].attributes.position.count}P.setIndex(Q)}for(let z in $){let Q=p($[z]);if(!Q)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+z+" attribute."),null;P.setAttribute(z,Q)}for(let z in te){let Q=te[z][0].length;if(Q===0)break;P.morphAttributes=P.morphAttributes||{},P.morphAttributes[z]=[];for(let Z=0;Z<Q;++Z){let ce=[];for(let xe=0;xe<te[z].length;++xe)ce.push(te[z][xe][Z]);let Me=p(ce);if(!Me)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+z+" morphAttribute."),null;P.morphAttributes[z].push(Me)}}return P}function p(I){let F,R,N,X=-1,$=0;for(let k=0;k<I.length;++k){let z=I[k];if(z.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(F===void 0&&(F=z.array.constructor),F!==z.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(R===void 0&&(R=z.itemSize),R!==z.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(N===void 0&&(N=z.normalized),N!==z.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(X===-1&&(X=z.gpuType),X!==z.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;$+=z.array.length}let te=new F($),U=0;for(let k=0;k<I.length;++k)te.set(I[k].array,U),U+=I[k].array.length;let P=new l.BufferAttribute(te,R,N);return X!==void 0&&(P.gpuType=X),P}function f(I){return I.isInstancedInterleavedBufferAttribute||I.isInterleavedBufferAttribute?A(I):I.isInstancedBufferAttribute?new l.InstancedBufferAttribute().copy(I):new l.BufferAttribute().copy(I)}function m(I){let F,R=0,N=0;for(let k=0,z=I.length;k<z;++k){let Q=I[k];if(F===void 0&&(F=Q.array.constructor),F!==Q.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;R+=Q.array.length,N+=Q.itemSize}let X=new l.InterleavedBuffer(new F(R),N),$=0,te=[],U=["getX","getY","getZ","getW"],P=["setX","setY","setZ","setW"];for(let k=0,z=I.length;k<z;k++){let Q=I[k],Z=Q.itemSize,ce=Q.count,Me=new l.InterleavedBufferAttribute(X,Z,$,Q.normalized);te.push(Me),$+=Z;for(let xe=0;xe<ce;xe++)for(let be=0;be<Z;be++)Me[P[be]](xe,Q[U[be]](xe))}return te}function A(I){let F=I.data.array.constructor,R=I.count,N=I.itemSize,X=I.normalized,$=new F(R*N),te;I.isInstancedInterleavedBufferAttribute?te=new l.InstancedBufferAttribute($,N,X,I.meshPerAttribute):te=new l.BufferAttribute($,N,X);for(let U=0;U<R;U++)te.setX(U,I.getX(U)),N>=2&&te.setY(U,I.getY(U)),N>=3&&te.setZ(U,I.getZ(U)),N>=4&&te.setW(U,I.getW(U));return te}function y(I){let F=I.attributes,R=I.morphTargets,N=new Map;for(let X in F){let $=F[X];$.isInterleavedBufferAttribute&&(N.has($)||N.set($,A($)),F[X]=N.get($))}for(let X in R){let $=R[X];$.isInterleavedBufferAttribute&&(N.has($)||N.set($,A($)),R[X]=N.get($))}}function E(I){let F=0;for(let N in I.attributes){let X=I.getAttribute(N);F+=X.count*X.itemSize*X.array.BYTES_PER_ELEMENT}let R=I.getIndex();return F+=R?R.count*R.itemSize*R.array.BYTES_PER_ELEMENT:0,F}function x(I,F=1e-4){F=Math.max(F,Number.EPSILON);let R={},N=I.getIndex(),X=I.getAttribute("position"),$=N?N.count:X.count,te=0,U=Object.keys(I.attributes),P={},k={},z=[],Q=["getX","getY","getZ","getW"],Z=["setX","setY","setZ","setW"];for(let Ze=0,ut=U.length;Ze<ut;Ze++){let it=U[Ze],gt=I.attributes[it];P[it]=new l.BufferAttribute(new gt.array.constructor(gt.count*gt.itemSize),gt.itemSize,gt.normalized);let Rt=I.morphAttributes[it];Rt&&(k[it]=new l.BufferAttribute(new Rt.array.constructor(Rt.count*Rt.itemSize),Rt.itemSize,Rt.normalized))}let ce=F*.5,Me=Math.log10(1/F),xe=Math.pow(10,Me),be=ce*xe;for(let Ze=0;Ze<$;Ze++){let ut=N?N.getX(Ze):Ze,it="";for(let gt=0,Rt=U.length;gt<Rt;gt++){let It=U[gt],Ft=I.getAttribute(It),Ne=Ft.itemSize;for(let pn=0;pn<Ne;pn++)it+=`${~~(Ft[Q[pn]](ut)*xe+be)},`}if(it in R)z.push(R[it]);else{for(let gt=0,Rt=U.length;gt<Rt;gt++){let It=U[gt],Ft=I.getAttribute(It),Ne=I.morphAttributes[It],pn=Ft.itemSize,St=P[It],Vt=k[It];for(let Ot=0;Ot<pn;Ot++){let xn=Q[Ot],Jt=Z[Ot];if(St[Jt](te,Ft[xn](ut)),Ne)for(let Oe=0,Ie=Ne.length;Oe<Ie;Oe++)Vt[Oe][Jt](te,Ne[Oe][xn](ut))}}R[it]=te,z.push(te),te++}}let Fe=I.clone();for(let Ze in I.attributes){let ut=P[Ze];if(Fe.setAttribute(Ze,new l.BufferAttribute(ut.array.slice(0,te*ut.itemSize),ut.itemSize,ut.normalized)),Ze in k)for(let it=0;it<k[Ze].length;it++){let gt=k[Ze][it];Fe.morphAttributes[Ze][it]=new l.BufferAttribute(gt.array.slice(0,te*gt.itemSize),gt.itemSize,gt.normalized)}}return Fe.setIndex(z),Fe}function v(I,F){if(F===l.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),I;if(F===l.TriangleFanDrawMode||F===l.TriangleStripDrawMode){let R=I.getIndex();if(R===null){let te=[],U=I.getAttribute("position");if(U!==void 0){for(let P=0;P<U.count;P++)te.push(P);I.setIndex(te),R=I.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),I}let N=R.count-2,X=[];if(F===l.TriangleFanDrawMode)for(let te=1;te<=N;te++)X.push(R.getX(0)),X.push(R.getX(te)),X.push(R.getX(te+1));else for(let te=0;te<N;te++)te%2===0?(X.push(R.getX(te)),X.push(R.getX(te+1)),X.push(R.getX(te+2))):(X.push(R.getX(te+2)),X.push(R.getX(te+1)),X.push(R.getX(te)));X.length/3!==N&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let $=I.clone();return $.setIndex(X),$.clearGroups(),$}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",F),I}function w(I){let F=new l.Vector3,R=new l.Vector3,N=new l.Vector3,X=new l.Vector3,$=new l.Vector3,te=new l.Vector3,U=new l.Vector3,P=new l.Vector3,k=new l.Vector3;function z(kt,De,he,ae,de,we,Ae,Le){F.fromBufferAttribute(De,de),R.fromBufferAttribute(De,we),N.fromBufferAttribute(De,Ae);let Ee=kt.morphTargetInfluences;if(he&&Ee){U.set(0,0,0),P.set(0,0,0),k.set(0,0,0);for(let ze=0,Ge=he.length;ze<Ge;ze++){let ee=Ee[ze],V=he[ze];ee!==0&&(X.fromBufferAttribute(V,de),$.fromBufferAttribute(V,we),te.fromBufferAttribute(V,Ae),ae?(U.addScaledVector(X,ee),P.addScaledVector($,ee),k.addScaledVector(te,ee)):(U.addScaledVector(X.sub(F),ee),P.addScaledVector($.sub(R),ee),k.addScaledVector(te.sub(N),ee)))}F.add(U),R.add(P),N.add(k)}kt.isSkinnedMesh&&(kt.applyBoneTransform(de,F),kt.applyBoneTransform(we,R),kt.applyBoneTransform(Ae,N)),Le[de*3+0]=F.x,Le[de*3+1]=F.y,Le[de*3+2]=F.z,Le[we*3+0]=R.x,Le[we*3+1]=R.y,Le[we*3+2]=R.z,Le[Ae*3+0]=N.x,Le[Ae*3+1]=N.y,Le[Ae*3+2]=N.z}let Q=I.geometry,Z=I.material,ce,Me,xe,be=Q.index,Fe=Q.attributes.position,Ze=Q.morphAttributes.position,ut=Q.morphTargetsRelative,it=Q.attributes.normal,gt=Q.morphAttributes.position,Rt=Q.groups,It=Q.drawRange,Ft,Ne,pn,St,Vt,Ot,xn,Jt=new Float32Array(Fe.count*Fe.itemSize),Oe=new Float32Array(it.count*it.itemSize);if(be!==null)if(Array.isArray(Z))for(Ft=0,pn=Rt.length;Ft<pn;Ft++)for(Vt=Rt[Ft],Ot=Math.max(Vt.start,It.start),xn=Math.min(Vt.start+Vt.count,It.start+It.count),Ne=Ot,St=xn;Ne<St;Ne+=3)ce=be.getX(Ne),Me=be.getX(Ne+1),xe=be.getX(Ne+2),z(I,Fe,Ze,ut,ce,Me,xe,Jt),z(I,it,gt,ut,ce,Me,xe,Oe);else for(Ot=Math.max(0,It.start),xn=Math.min(be.count,It.start+It.count),Ft=Ot,pn=xn;Ft<pn;Ft+=3)ce=be.getX(Ft),Me=be.getX(Ft+1),xe=be.getX(Ft+2),z(I,Fe,Ze,ut,ce,Me,xe,Jt),z(I,it,gt,ut,ce,Me,xe,Oe);else if(Array.isArray(Z))for(Ft=0,pn=Rt.length;Ft<pn;Ft++)for(Vt=Rt[Ft],Ot=Math.max(Vt.start,It.start),xn=Math.min(Vt.start+Vt.count,It.start+It.count),Ne=Ot,St=xn;Ne<St;Ne+=3)ce=Ne,Me=Ne+1,xe=Ne+2,z(I,Fe,Ze,ut,ce,Me,xe,Jt),z(I,it,gt,ut,ce,Me,xe,Oe);else for(Ot=Math.max(0,It.start),xn=Math.min(Fe.count,It.start+It.count),Ft=Ot,pn=xn;Ft<pn;Ft+=3)ce=Ft,Me=Ft+1,xe=Ft+2,z(I,Fe,Ze,ut,ce,Me,xe,Jt),z(I,it,gt,ut,ce,Me,xe,Oe);let Ie=new l.Float32BufferAttribute(Jt,3),yt=new l.Float32BufferAttribute(Oe,3);return{positionAttribute:Fe,normalAttribute:it,morphedPositionAttribute:Ie,morphedNormalAttribute:yt}}function M(I){if(I.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),I;let F=I.groups;if(F=F.sort((te,U)=>te.materialIndex!==U.materialIndex?te.materialIndex-U.materialIndex:te.start-U.start),I.getIndex()===null){let te=I.getAttribute("position"),U=[];for(let P=0;P<te.count;P+=3)U.push(P,P+1,P+2);I.setIndex(U)}let R=I.getIndex(),N=[];for(let te=0;te<F.length;te++){let U=F[te],P=U.start,k=P+U.count;for(let z=P;z<k;z++)N.push(R.getX(z))}I.dispose(),I.setIndex(N);let X=0;for(let te=0;te<F.length;te++){let U=F[te];U.start=X,X+=U.count}let $=F[0];I.groups=[$];for(let te=1;te<F.length;te++){let U=F[te];$.materialIndex===U.materialIndex?$.count+=U.count:($=U,I.groups.push($))}return I}function T(I,F=Math.PI/3){let R=Math.cos(F),N=(1+1e-10)*100,X=[new l.Vector3,new l.Vector3,new l.Vector3],$=new l.Vector3,te=new l.Vector3,U=new l.Vector3,P=new l.Vector3;function k(xe){let be=~~(xe.x*N),Fe=~~(xe.y*N),Ze=~~(xe.z*N);return`${be},${Fe},${Ze}`}let z=I.index?I.toNonIndexed():I,Q=z.attributes.position,Z={};for(let xe=0,be=Q.count/3;xe<be;xe++){let Fe=3*xe,Ze=X[0].fromBufferAttribute(Q,Fe+0),ut=X[1].fromBufferAttribute(Q,Fe+1),it=X[2].fromBufferAttribute(Q,Fe+2);$.subVectors(it,ut),te.subVectors(Ze,ut);let gt=new l.Vector3().crossVectors($,te).normalize();for(let Rt=0;Rt<3;Rt++){let It=X[Rt],Ft=k(It);Ft in Z||(Z[Ft]=[]),Z[Ft].push(gt)}}let ce=new Float32Array(Q.count*3),Me=new l.BufferAttribute(ce,3,!1);for(let xe=0,be=Q.count/3;xe<be;xe++){let Fe=3*xe,Ze=X[0].fromBufferAttribute(Q,Fe+0),ut=X[1].fromBufferAttribute(Q,Fe+1),it=X[2].fromBufferAttribute(Q,Fe+2);$.subVectors(it,ut),te.subVectors(Ze,ut),U.crossVectors($,te).normalize();for(let gt=0;gt<3;gt++){let Rt=X[gt],It=k(Rt),Ft=Z[It];P.set(0,0,0);for(let Ne=0,pn=Ft.length;Ne<pn;Ne++){let St=Ft[Ne];U.dot(St)>R&&P.add(St)}P.normalize(),Me.setXYZ(Fe+gt,P.x,P.y,P.z)}}return z.setAttribute("normal",Me),z}function D(I,F=!1){return console.warn("THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries()."),h(I,F)}function L(I){return console.warn("THREE.BufferGeometryUtils: mergeBufferAttributes() has been renamed to mergeAttributes()."),p(I)}},"./node_modules/super-three/examples/jsm/utils/WorkerPool.js":(s,o,c)=>{"use strict";c.r(o),c.d(o,{WorkerPool:()=>l});class l{constructor(h=4){this.pool=h,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(h){if(!this.workers[h]){let p=this.workerCreator();p.addEventListener("message",this._onMessage.bind(this,h)),this.workers[h]=p}}_getIdleWorker(){for(let h=0;h<this.pool;h++)if(!(this.workerStatus&1<<h))return h;return-1}_onMessage(h,p){let f=this.workersResolve[h];if(f&&f(p),this.queue.length){let{resolve:m,msg:A,transfer:y}=this.queue.shift();this.workersResolve[h]=m,this.workers[h].postMessage(A,y)}else this.workerStatus^=1<<h}setWorkerCreator(h){this.workerCreator=h}setWorkerLimit(h){this.pool=h}postMessage(h,p){return new Promise(f=>{let m=this._getIdleWorker();m!==-1?(this._initWorker(m),this.workerStatus|=1<<m,this.workersResolve[m]=f,this.workers[m].postMessage(h,p)):this.queue.push({resolve:f,msg:h,transfer:p})})}dispose(){this.workers.forEach(h=>h.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./package.json":s=>{"use strict";s.exports=JSON.parse('{"name":"aframe","version":"1.5.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.4.2 1.5.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"@ungap/custom-elements":"^1.1.0","buffer":"^6.0.3","custom-event-polyfill":"^1.0.6","debug":"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","object-assign":"^4.0.1","present":"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"0.158.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^20.0.0","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},e={};function t(s){var o=e[s];if(o!==void 0)return o.exports;var c=e[s]={id:s,exports:{}};return n[s].call(c.exports,c,c.exports,t),c.exports}t.m=n,t.n=s=>{var o=s&&s.__esModule?()=>s.default:()=>s;return t.d(o,{a:o}),o},t.d=(s,o)=>{for(var c in o)t.o(o,c)&&!t.o(s,c)&&Object.defineProperty(s,c,{enumerable:!0,get:o[c]})},t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),t.o=(s,o)=>Object.prototype.hasOwnProperty.call(s,o),t.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},(()=>{t.b=document.baseURI||self.location.href;var s={main:0}})(),t.nc=void 0;var i=t("./src/index.js");return i})())});var BP=Cr((ype,PP)=>{"use strict";PP.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(n){let e=this.el;if(this.active&&this.checkpoint!==n){if(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=n,this.sync(),this.position.distanceTo(this.targetPosition)<.1){this.checkpoint=null;return}e.emit("navigation-start",{checkpoint:n}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:n}),e.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;let n=this.data,e=this.offset,t=this.position,i=this.targetPosition,s=this.checkpoint;return this.sync(),t.distanceTo(i)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:s}),e.set(0,0,0)):(e.setLength(n.animateSpeed),e)},sync:function(){let n=this.offset,e=this.position,t=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(t),t.add(this.checkpoint.components.checkpoint.getOffset()),n.copy(t).sub(e)}})});var NP=Cr((xpe,OP)=>{"use strict";OP.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})});var UP=Cr((Epe,FP)=>{"use strict";function UQ(n,e,t){this.type=n,this.index=e,this.pressed=t.pressed,this.value=t.value}FP.exports=UQ});var VP=Cr((_pe,kP)=>{"use strict";var Af=NP(),cw=UP(),$l=.2,Kc={LEFT:"left",RIGHT:"right"},$c={MOVEMENT:1,ROTATION:2};kP.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:Af,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){let n=this.el.sceneEl;this.system=n.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};let e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,n.addBehavior(this)},update:function(){this.tick()},tick:function(n,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;let n=this._dpadVector,e=this._moveVector;this.getDpad(n),this.getJoystick($c.MOVEMENT,e);let t=n.x||e.x,i=n.y||e.y;return Math.abs(t)>$l||Math.abs(i)>$l},getVelocityDelta:function(){let n=this._dpadVector,e=this._moveVector;this.getDpad(n),this.getJoystick($c.MOVEMENT,e);let t=n.x||e.x,i=n.y||e.y,s=new THREE.Vector3;return Math.abs(t)>$l&&(s.x+=t),Math.abs(i)>$l&&(s.z+=i),s},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;let n=this._lookVector;return this.getJoystick($c.ROTATION,n),Math.abs(n.x)>$l||Math.abs(n.y)>$l},updateRotation:function(n){if(!this.isRotationActive())return;let e=this.data,t=this.yaw,i=this.pitch;t.rotation.y=this.el.object3D.rotation.y,i.rotation.x=this.el.object3D.rotation.x;let s=this._lookVector;this.getJoystick($c.ROTATION,s),Math.abs(s.x)<=$l&&(s.x=0),Math.abs(s.y)<=$l&&(s.y=0),s.multiplyScalar(e.rotationSensitivity*n/1e3),t.rotation.y-=s.x,i.rotation.x-=s.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),this.el.object3D.rotation.set(i.rotation.x,t.rotation.y,0)},updateButtonState:function(){let n=this.getGamepad(Kc.RIGHT);if(this.data.enabled&&n)for(var e=0;e<n.buttons.length;e++)n.buttons[e].pressed&&!this.buttons[e]?this.emit(new cw("gamepadbuttondown",e,n.buttons[e])):!n.buttons[e].pressed&&this.buttons[e]&&this.emit(new cw("gamepadbuttonup",e,n.buttons[e])),this.buttons[e]=n.buttons[e].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(n){this.el.emit(n.type,n),this.el.emit(n.type+":"+n.index,new cw(n.type,n.index,n))},getGamepad:function(){let n=[],e=[];return function(t){let i=this.el.sceneEl.components["proxy-controls"],s=i&&i.isConnected()&&i.getGamepad(0);if(s)return s;n.length=0;for(let c=0;c<this.system.controllers.length;c++){let l=this.system.controllers[c],u=l?l.gamepad:null;if(n.push(u),u&&l.handedness===t)return u}let o=navigator.getGamepads?navigator.getGamepads():e;for(let c=0;c<o.length;c++){let l=o[c];if(l&&l.hand===t)return l}return n[0]||o[0]}}(),getButton:function(n){return this.getGamepad(Kc.RIGHT).buttons[n]},getAxis:function(n){return this.getGamepad(n>1?Kc.RIGHT:Kc.LEFT).axes[n]},getJoystick:function(n,e){let t=this.getGamepad(n===$c.MOVEMENT?Kc.LEFT:Kc.RIGHT);if(!t)return e.set(0,0);if(t.mapping==="xr-standard")switch(n){case $c.MOVEMENT:return e.set(t.axes[2],t.axes[3]);case $c.ROTATION:return e.set(t.axes[2],0)}else switch(n){case $c.MOVEMENT:return e.set(t.axes[0],t.axes[1]);case $c.ROTATION:return e.set(t.axes[2],t.axes[3])}throw new Error('Unexpected joystick index "%d".',n)},getDpad:function(n){let e=this.getGamepad(Kc.LEFT);return!e||!e.buttons[Af.DPAD_RIGHT]?n.set(0,0):n.set((e.buttons[Af.DPAD_RIGHT].pressed?1:0)+(e.buttons[Af.DPAD_LEFT].pressed?-1:0),(e.buttons[Af.DPAD_UP].pressed?-1:0)+(e.buttons[Af.DPAD_DOWN].pressed?1:0))},isConnected:function(){let n=this.getGamepad(Kc.LEFT);return!!(n&&n.connected)},getID:function(){return this.getGamepad(Kc.LEFT).id}})});var HP=Cr(()=>{"use strict";(function(n){var e="KeyboardEvent"in n;e||(n.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in n.KeyboardEvent||(n.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in n.KeyboardEvent||(n.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in n.KeyboardEvent||(n.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in n.KeyboardEvent||(n.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var t=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function c(L,I){return String(L).indexOf(I)!==-1}var l=function(){return c(navigator.platform,"Win")?"win":c(navigator.platform,"Mac")?"mac":c(navigator.platform,"CrOS")?"cros":c(navigator.platform,"Linux")?"linux":c(navigator.userAgent,"iPad")||c(navigator.platform,"iPod")||c(navigator.platform,"iPhone")?"ios":""}(),u=function(){return c(navigator.userAgent,"Chrome/")?"chrome":c(navigator.vendor,"Apple")?"safari":c(navigator.userAgent,"MSIE")?"ie":c(navigator.userAgent,"Gecko/")?"moz":c(navigator.userAgent,"Opera/")?"opera":""}(),h=u+"-"+l;function p(L,I,F){(h===I||u===I||l===I)&&Object.keys(F).forEach(function(R){L[R]=F[R]})}function f(L,I){var F={};return Object.keys(L).forEach(function(R){var N=L[R];I in N&&(F[N[I]]=N)}),F}function m(L){var I={};return Object.keys(L).forEach(function(F){I[L[F]]=F}),I}var A={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};p(A,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),p(A,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),p(A,"moz-win",{173:{code:"Minus",keyCap:"-"}}),p(A,"chrome-mac",{93:{code:"OSRight",location:s}}),p(A,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),p(A,"ios",{10:{code:"Enter",location:t}}),p(A,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var y={};l==="cros"&&(y["U+00A0"]={code:"ShiftLeft",location:i},y["U+00A1"]={code:"ShiftRight",location:s},y["U+00A2"]={code:"ControlLeft",location:i},y["U+00A3"]={code:"ControlRight",location:s},y["U+00A4"]={code:"AltLeft",location:i},y["U+00A5"]={code:"AltRight",location:s}),h==="chrome-mac"&&(y["U+0010"]={code:"ContextMenu"}),h==="safari-mac"&&(y["U+0010"]={code:"ContextMenu"}),l==="ios"&&(y["U+0010"]={code:"Function"},y["U+001C"]={code:"ArrowLeft"},y["U+001D"]={code:"ArrowRight"},y["U+001E"]={code:"ArrowUp"},y["U+001F"]={code:"ArrowDown"},y["U+0001"]={code:"Home"},y["U+0004"]={code:"End"},y["U+000B"]={code:"PageUp"},y["U+000C"]={code:"PageDown"});var E=[];E[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},E[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},E[o]={13:{code:"NumpadEnter",location:o}},p(E[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),p(E[i],"moz-mac",{224:{code:"OSLeft",location:i}}),p(E[s],"moz-mac",{224:{code:"OSRight",location:s}}),p(E[s],"moz-win",{91:{code:"OSRight",location:s}}),p(E[s],"mac",{93:{code:"OSRight",location:s}}),p(E[o],"chrome-mac",{12:{code:"NumLock",location:o}}),p(E[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var x={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};p(x,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},w=f(A,"code");try{var M=e&&"location"in new KeyboardEvent("")}catch{}function T(L){var I="keyCode"in L?L.keyCode:"which"in L?L.which:0,F=function(){if(M||"keyLocation"in L){var N=M?L.location:L.keyLocation;if(N&&I in E[N])return E[N][I]}return"keyIdentifier"in L&&L.keyIdentifier in y?y[L.keyIdentifier]:I in A?A[I]:null}();if(0)switch(L.keyIdentifier){case"U+0010":case"U+001C":case"U+001D":case"U+001E":case"U+001F":}if(!F)return null;var R=function(){var N=x[F.code];return N?L.shiftKey&&"shiftKey"in N?N.shiftKey:N.key:F.code}();return{code:F.code,key:R,location:F.location,keyCap:F.keyCap}}function D(L,I){if(L=String(L),!w.hasOwnProperty(L))return"Undefined";if(I&&String(I).toLowerCase()!=="en-us")throw Error("Unsupported locale");var F=w[L];return F.keyCap||F.code||"Undefined"}"KeyboardEvent"in n&&"defineProperty"in Object&&function(){function L(F,R,N){R in F||Object.defineProperty(F,R,N)}if(L(KeyboardEvent.prototype,"code",{get:function(){var F=T(this);return F?F.code:""}}),"key"in KeyboardEvent.prototype){var I=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var F=I.get.call(this);return v.hasOwnProperty(F)?v[F]:F}})}L(KeyboardEvent.prototype,"key",{get:function(){var F=T(this);return F&&"key"in F?F.key:"Unidentified"}}),L(KeyboardEvent.prototype,"location",{get:function(){var F=T(this);return F&&"location"in F?F.location:t}}),L(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in n.KeyboardEvent||(n.KeyboardEvent.queryKeyCap=D),n.identifyKey=function(L){if(!("code"in L)){var I=T(L);L.code=I?I.code:"",L.key=I&&"key"in I?I.key:"Unidentified",L.location="location"in L?L.location:"keyLocation"in L?L.keyLocation:I&&"location"in I?I.location:t,L.locale=""}}})(window)});var GP=Cr((wpe,zP)=>{"use strict";HP();var kQ="__keyboard-controls-proxy",VQ=window.KeyboardEvent;zP.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){let n=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),n.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(let n in this.localKeys)this.localKeys.hasOwnProperty(n)&&delete this.localKeys[n]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(n){AFRAME.utils.shouldCaptureKeyEvent(n)&&(this.localKeys[n.code]=!0,this.emit(n))},onKeyUp:function(n){AFRAME.utils.shouldCaptureKeyEvent(n)&&(delete this.localKeys[n.code],this.emit(n))},onBlur:function(){for(let n in this.localKeys)this.localKeys.hasOwnProperty(n)&&delete this.localKeys[n]},emit:function(n){kQ in n&&this.el.emit(n.type,n),this.el.emit(n.type+":"+n.code,new VQ(n.type,n)),this.data.debug&&console.log(n.type+":"+n.code)},isPressed:function(n){return n in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){let n=this.el.sceneEl.components["proxy-controls"];return n&&n.isConnected()}})});var jP=Cr((Cpe,WP)=>{"use strict";WP.exports=AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){let n=this.el.sceneEl,e=n.canvas;if(!e){n.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}e.addEventListener("touchstart",this.onTouchStart),e.addEventListener("touchend",this.onTouchEnd);let t=n.getAttribute("vr-mode-ui");t&&t.cardboardModeEnabled&&n.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){let n=this.el.sceneEl&&this.el.sceneEl.canvas;n&&(n.removeEventListener("touchstart",this.onTouchStart),n.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(n){this.direction=-1,this.data.reverseEnabled&&n.touches&&n.touches.length===2&&(this.direction=1),n.preventDefault()},onTouchEnd:function(n){this.direction=0,n.preventDefault()},onEnterVR:function(){let n=this.el.sceneEl.xrSession;n&&(n.addEventListener("selectstart",this.onTouchStart),n.addEventListener("selectend",this.onTouchEnd))}})});var XP=Cr((Spe,QP)=>{"use strict";var lw="-controls",HQ="moved";QP.exports=AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){let n=this.el;this.data.camera||(this.data.camera=n.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,n.sceneEl.hasLoaded?this.injectControls():n.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(n){let e=this.el,t=this.data,i=e.sceneEl.systems.nav;if(e.sceneEl.hasLoaded&&this.injectControls(),i&&t.constrainToNavMesh!==n.constrainToNavMesh&&(t.constrainToNavMesh?i.addAgent(this):i.removeAgent(this)),t.enabled!==n.enabled)for(let s=0;s<t.controls.length;s++){let o=t.controls[s]+lw;this.el.setAttribute(o,{enabled:this.data.enabled})}},injectControls:function(){let n=this.data;for(let e=0;e<n.controls.length;e++){let t=n.controls[e]+lw;this.el.setAttribute(t,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){let n=new THREE.Vector3,e=new THREE.Vector3,t=new THREE.Vector3;return function(i,s){if(!s)return;let o=this.el,c=this.data;if(!c.enabled)return;this.updateVelocityCtrl();let l=this.velocityCtrl,u=this.velocity;if(l)if(s/1e3>.2?u.set(0,0,0):this.updateVelocity(s),c.constrainToNavMesh&&l.isNavMeshConstrained!==!1){if(u.lengthSq()<1e-5)return;n.copy(o.object3D.position),e.copy(u).multiplyScalar(s/1e3).add(n);let h=o.sceneEl.systems.nav;this.navGroup=this.navGroup===null?h.getGroup(n):this.navGroup,this.navNode=this.navNode||h.getNode(n,this.navGroup),this.navNode=h.clampStep(n,e,this.navGroup,this.navNode,t),o.object3D.position.copy(t)}else o.hasAttribute("velocity")?o.setAttribute("velocity",u):(o.object3D.position.x+=u.x*s/1e3,o.object3D.position.y+=u.y*s/1e3,o.object3D.position.z+=u.z*s/1e3)}}(),updateVelocityCtrl:function(){let n=this.data;if(n.enabled){for(let e=0,t=n.controls.length;e<t;e++){let i=this.el.components[n.controls[e]+lw];if(i&&i.isVelocityActive()){this.velocityCtrl=i;return}}this.velocityCtrl=null}},updateVelocity:function(){let n=new THREE.Vector2,e=new THREE.Quaternion;return function(t){let i,s=this.el,o=this.velocityCtrl,c=this.velocity,l=this.data;if(o)if(o.getVelocityDelta)i=o.getVelocityDelta(t);else if(o.getVelocity){c.copy(o.getVelocity());return}else if(o.getPositionDelta){c.copy(o.getPositionDelta(t).multiplyScalar(1e3/t));return}else throw new Error("Incompatible movement controls: ",o);if(s.hasAttribute("velocity")&&!l.constrainToNavMesh&&c.copy(this.el.getAttribute("velocity")),i&&l.enabled){let u=l.camera;e.copy(u.object3D.quaternion),e.premultiply(s.object3D.quaternion),i.applyQuaternion(e);let h=i.length();l.fly?(c.copy(i),c.multiplyScalar(this.data.speed*16.66667)):(n.set(i.x,i.z),n.setLength(h*this.data.speed*16.66667),c.x=n.x,c.y=0,c.z=n.y),(c.x!==0||c.y!==0||c.z!==0)&&(this.eventDetail.velocity=c,this.el.emit(HQ,this.eventDetail))}}}()})});var YP=Cr((Tpe,qP)=>{"use strict";qP.exports=AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){let n=this.data,e=this.el.sceneEl;switch(e.addEventListener("axismove",this.onAxisMove),n.mode){case"swipe":case"touch":e.addEventListener("trackpadtouchstart",this.onTouchStart),e.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":e.addEventListener("trackpaddown",this.onTouchStart),e.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){let n=this.el.sceneEl;n.removeEventListener("axismove",this.onAxisMove),n.removeEventListener("trackpadtouchstart",this.onTouchStart),n.removeEventListener("trackpadtouchend",this.onTouchEnd),n.removeEventListener("trackpaddown",this.onTouchStart),n.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(n){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}n.preventDefault()},onTouchEnd:function(n){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,n.preventDefault()},onAxisMove:function(n){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(n);case"touch":case"press":return this.handleTouchAxis(n)}},handleSwipeAxis:function(n){let e=this.data,t=n.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=t[0],this.startingAxisData[1]=t[1]),this.startingAxisData.length>0){let i=0,s=0;e.enableNegX&&t[0]<this.startingAxisData[0]&&(i=-1),e.enablePosX&&t[0]>this.startingAxisData[0]&&(i=1),e.enablePosZ&&t[1]>this.startingAxisData[1]&&(s=-1),e.enableNegZ&&t[1]<this.startingAxisData[1]&&(s=1);let o=Math.abs(this.startingAxisData[1]-t[1]);Math.abs(this.startingAxisData[0]-t[0])>o?(this.zVel=0,this.xVel=i,this.isMoving=!0):(this.xVel=0,this.zVel=s,this.isMoving=!0)}},handleTouchAxis:function(n){let e=this.data,t=n.detail.axis,i=0,s=0;e.enableNegX&&t[0]<0&&(i=-1),e.enablePosX&&t[0]>0&&(i=1),e.enablePosZ&&t[1]>0&&(s=-1),e.enableNegZ&&t[1]<0&&(s=1),Math.abs(t[0])>Math.abs(t[1])?(this.zVel=0,this.xVel=i):(this.xVel=0,this.zVel=s)}})});var KP=Cr((ry,uw)=>{"use strict";(function(n,e){typeof ry=="object"&&typeof uw=="object"?uw.exports=e():typeof define=="function"&&define.amd?define("nipplejs",[],e):typeof ry=="object"?ry.nipplejs=e():n.nipplejs=e()})(window,function(){return function(n){var e={};function t(i){if(e[i])return e[i].exports;var s=e[i]={i,l:!1,exports:{}};return n[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=n,t.c=e,t.d=function(i,s,o){t.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:o})},t.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},t.t=function(i,s){if(1&s&&(i=t(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var c in i)t.d(o,c,(function(l){return i[l]}).bind(null,c));return o},t.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return t.d(s,"a",s),s},t.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";t.r(e);var i,s=function(P,k){var z=k.x-P.x,Q=k.y-P.y;return Math.sqrt(z*z+Q*Q)},o=function(P){return P*(Math.PI/180)},c=function(P){return P*(180/Math.PI)},l=new Map,u=function(P){l.has(P)&&clearTimeout(l.get(P)),l.set(P,setTimeout(P,100))},h=function(P,k,z){for(var Q,Z=k.split(/[ ,]+/g),ce=0;ce<Z.length;ce+=1)Q=Z[ce],P.addEventListener?P.addEventListener(Q,z,!1):P.attachEvent&&P.attachEvent(Q,z)},p=function(P,k,z){for(var Q,Z=k.split(/[ ,]+/g),ce=0;ce<Z.length;ce+=1)Q=Z[ce],P.removeEventListener?P.removeEventListener(Q,z):P.detachEvent&&P.detachEvent(Q,z)},f=function(P){return P.preventDefault(),P.type.match(/^touch/)?P.changedTouches:P},m=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},A=function(P,k){k.top||k.right||k.bottom||k.left?(P.style.top=k.top,P.style.right=k.right,P.style.bottom=k.bottom,P.style.left=k.left):(P.style.left=k.x+"px",P.style.top=k.y+"px")},y=function(P,k,z){var Q=E(P);for(var Z in Q)if(Q.hasOwnProperty(Z))if(typeof k=="string")Q[Z]=k+" "+z;else{for(var ce="",Me=0,xe=k.length;Me<xe;Me+=1)ce+=k[Me]+" "+z+", ";Q[Z]=ce.slice(0,-2)}return Q},E=function(P){var k={};return k[P]="",["webkit","Moz","o"].forEach(function(z){k[z+P.charAt(0).toUpperCase()+P.slice(1)]=""}),k},x=function(P,k){for(var z in k)k.hasOwnProperty(z)&&(P[z]=k[z]);return P},v=function(P,k){if(P.length)for(var z=0,Q=P.length;z<Q;z+=1)k(P[z]);else k(P)},w="ontouchstart"in window,M=!!window.PointerEvent,T=!!window.MSPointerEvent,D={start:"mousedown",move:"mousemove",end:"mouseup"},L={};function I(){}M?i={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:T?i={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:w?(i={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},L=D):i=D,I.prototype.on=function(P,k){var z,Q=P.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var Z=0;Z<Q.length;Z+=1)z=Q[Z],this._handlers_[z]=this._handlers_[z]||[],this._handlers_[z].push(k);return this},I.prototype.off=function(P,k){return this._handlers_=this._handlers_||{},P===void 0?this._handlers_={}:k===void 0?this._handlers_[P]=null:this._handlers_[P]&&this._handlers_[P].indexOf(k)>=0&&this._handlers_[P].splice(this._handlers_[P].indexOf(k),1),this},I.prototype.trigger=function(P,k){var z,Q=this,Z=P.split(/[ ,]+/g);Q._handlers_=Q._handlers_||{};for(var ce=0;ce<Z.length;ce+=1)z=Z[ce],Q._handlers_[z]&&Q._handlers_[z].length&&Q._handlers_[z].forEach(function(Me){Me.call(Q,{type:z,target:Q},k)})},I.prototype.config=function(P){this.options=this.defaults||{},P&&(this.options=function(k,z){var Q={};for(var Z in k)k.hasOwnProperty(Z)&&z.hasOwnProperty(Z)?Q[Z]=z[Z]:k.hasOwnProperty(Z)&&(Q[Z]=k[Z]);return Q}(this.options,P))},I.prototype.bindEvt=function(P,k){var z=this;return z._domHandlers_=z._domHandlers_||{},z._domHandlers_[k]=function(){typeof z["on"+k]=="function"?z["on"+k].apply(z,arguments):console.warn('[WARNING] : Missing "on'+k+'" handler.')},h(P,i[k],z._domHandlers_[k]),L[k]&&h(P,L[k],z._domHandlers_[k]),z},I.prototype.unbindEvt=function(P,k){return this._domHandlers_=this._domHandlers_||{},p(P,i[k],this._domHandlers_[k]),L[k]&&p(P,L[k],this._domHandlers_[k]),delete this._domHandlers_[k],this};var F=I;function R(P,k){return this.identifier=k.identifier,this.position=k.position,this.frontPosition=k.frontPosition,this.collection=P,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(k),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=R.id,R.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}R.prototype=new F,R.constructor=R,R.id=0,R.prototype.buildEl=function(P){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},R.prototype.stylize=function(){if(this.options.dataOnly)return this;var P=this.options.fadeTime+"ms",k=function(Z,ce){var Me=E(Z);for(var xe in Me)Me.hasOwnProperty(xe)&&(Me[xe]=ce);return Me}("borderRadius","50%"),z=y("transition","opacity",P),Q={};return Q.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},Q.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},Q.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},x(Q.el,z),this.options.shape==="circle"&&x(Q.back,k),x(Q.front,k),this.applyStyles(Q),this},R.prototype.applyStyles=function(P){for(var k in this.ui)if(this.ui.hasOwnProperty(k))for(var z in P[k])this.ui[k].style[z]=P[k][z];return this},R.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},R.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},R.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},R.prototype.show=function(P){var k=this;return k.options.dataOnly||(clearTimeout(k.removeTimeout),clearTimeout(k.showTimeout),clearTimeout(k.restTimeout),k.addToDom(),k.restCallback(),setTimeout(function(){k.ui.el.style.opacity=1},0),k.showTimeout=setTimeout(function(){k.trigger("shown",k.instance),typeof P=="function"&&P.call(this)},k.options.fadeTime)),k},R.prototype.hide=function(P){var k=this;if(k.options.dataOnly)return k;if(k.ui.el.style.opacity=k.options.restOpacity,clearTimeout(k.removeTimeout),clearTimeout(k.showTimeout),clearTimeout(k.restTimeout),k.removeTimeout=setTimeout(function(){var Z=k.options.mode==="dynamic"?"none":"block";k.ui.el.style.display=Z,typeof P=="function"&&P.call(k),k.trigger("hidden",k.instance)},k.options.fadeTime),k.options.restJoystick){var z=k.options.restJoystick,Q={};Q.x=z===!0||z.x!==!1?0:k.instance.frontPosition.x,Q.y=z===!0||z.y!==!1?0:k.instance.frontPosition.y,k.setPosition(P,Q)}return k},R.prototype.setPosition=function(P,k){var z=this;z.frontPosition={x:k.x,y:k.y};var Q=z.options.fadeTime+"ms",Z={};Z.front=y("transition",["transform"],Q);var ce={front:{}};ce.front={transform:"translate("+z.frontPosition.x+"px,"+z.frontPosition.y+"px)"},z.applyStyles(Z),z.applyStyles(ce),z.restTimeout=setTimeout(function(){typeof P=="function"&&P.call(z),z.restCallback()},z.options.fadeTime)},R.prototype.restCallback=function(){var P={};P.front=y("transition","none",""),this.applyStyles(P),this.trigger("rested",this.instance)},R.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},R.prototype.computeDirection=function(P){var k,z,Q,Z=P.angle.radian,ce=Math.PI/4,Me=Math.PI/2;if(Z>ce&&Z<3*ce&&!P.lockX?k="up":Z>-ce&&Z<=ce&&!P.lockY?k="left":Z>3*-ce&&Z<=-ce&&!P.lockX?k="down":P.lockY||(k="right"),P.lockY||(z=Z>-Me&&Z<Me?"left":"right"),P.lockX||(Q=Z>0?"up":"down"),P.force>this.options.threshold){var xe,be={};for(xe in this.direction)this.direction.hasOwnProperty(xe)&&(be[xe]=this.direction[xe]);var Fe={};for(xe in this.direction={x:z,y:Q,angle:k},P.direction=this.direction,be)be[xe]===this.direction[xe]&&(Fe[xe]=!0);if(Fe.x&&Fe.y&&Fe.angle)return P;Fe.x&&Fe.y||this.trigger("plain",P),Fe.x||this.trigger("plain:"+z,P),Fe.y||this.trigger("plain:"+Q,P),Fe.angle||this.trigger("dir dir:"+k,P)}else this.resetDirection();return P};var N=R;function X(P,k){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=P,this.id=X.id,X.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(k),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var z=getComputedStyle(this.options.zone.parentElement);return z&&z.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}X.prototype=new F,X.constructor=X,X.id=0,X.prototype.prepareNipples=function(){var P=this.nipples;P.on=this.on.bind(this),P.off=this.off.bind(this),P.options=this.options,P.destroy=this.destroy.bind(this),P.ids=this.ids,P.id=this.id,P.processOnMove=this.processOnMove.bind(this),P.processOnEnd=this.processOnEnd.bind(this),P.get=function(k){if(k===void 0)return P[0];for(var z=0,Q=P.length;z<Q;z+=1)if(P[z].identifier===k)return P[z];return!1}},X.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},X.prototype.begin=function(){var P=this.options;if(P.mode==="static"){var k=this.createNipple(P.position,this.manager.getIdentifier());k.add(),this.idles.push(k)}},X.prototype.createNipple=function(P,k){var z=this.manager.scroll,Q={},Z=this.options,ce=this.parentIsFlex?z.x:z.x+this.box.left,Me=this.parentIsFlex?z.y:z.y+this.box.top;if(P.x&&P.y)Q={x:P.x-ce,y:P.y-Me};else if(P.top||P.right||P.bottom||P.left){var xe=document.createElement("DIV");xe.style.display="hidden",xe.style.top=P.top,xe.style.right=P.right,xe.style.bottom=P.bottom,xe.style.left=P.left,xe.style.position="absolute",Z.zone.appendChild(xe);var be=xe.getBoundingClientRect();Z.zone.removeChild(xe),Q=P,P={x:be.left+z.x,y:be.top+z.y}}var Fe=new N(this,{color:Z.color,size:Z.size,threshold:Z.threshold,fadeTime:Z.fadeTime,dataOnly:Z.dataOnly,restJoystick:Z.restJoystick,restOpacity:Z.restOpacity,mode:Z.mode,identifier:k,position:P,zone:Z.zone,frontPosition:{x:0,y:0},shape:Z.shape});return Z.dataOnly||(A(Fe.ui.el,Q),A(Fe.ui.front,Fe.frontPosition)),this.nipples.push(Fe),this.trigger("added "+Fe.identifier+":added",Fe),this.manager.trigger("added "+Fe.identifier+":added",Fe),this.bindNipple(Fe),Fe},X.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},X.prototype.bindNipple=function(P){var k,z=this,Q=function(Z,ce){k=Z.type+" "+ce.id+":"+Z.type,z.trigger(k,ce)};P.on("destroyed",z.onDestroyed.bind(z)),P.on("shown hidden rested dir plain",Q),P.on("dir:up dir:right dir:down dir:left",Q),P.on("plain:up plain:right plain:down plain:left",Q)},X.prototype.pressureFn=function(P,k,z){var Q=this,Z=0;clearInterval(Q.pressureIntervals[z]),Q.pressureIntervals[z]=setInterval((function(){var ce=P.force||P.pressure||P.webkitForce||0;ce!==Z&&(k.trigger("pressure",ce),Q.trigger("pressure "+k.identifier+":pressure",ce),Z=ce)}).bind(Q),100)},X.prototype.onstart=function(P){var k=this,z=k.options,Q=P;return P=f(P),k.updateBox(),v(P,function(Z){k.actives.length<z.maxNumberOfNipples?k.processOnStart(Z):Q.type.match(/^touch/)&&(Object.keys(k.manager.ids).forEach(function(ce){if(Object.values(Q.touches).findIndex(function(xe){return xe.identifier===ce})<0){var Me=[P[0]];Me.identifier=ce,k.processOnEnd(Me)}}),k.actives.length<z.maxNumberOfNipples&&k.processOnStart(Z))}),k.manager.bindDocument(),!1},X.prototype.processOnStart=function(P){var k,z=this,Q=z.options,Z=z.manager.getIdentifier(P),ce=P.force||P.pressure||P.webkitForce||0,Me={x:P.pageX,y:P.pageY},xe=z.getOrCreate(Z,Me);xe.identifier!==Z&&z.manager.removeIdentifier(xe.identifier),xe.identifier=Z;var be=function(Fe){Fe.trigger("start",Fe),z.trigger("start "+Fe.id+":start",Fe),Fe.show(),ce>0&&z.pressureFn(P,Fe,Fe.identifier),z.processOnMove(P)};if((k=z.idles.indexOf(xe))>=0&&z.idles.splice(k,1),z.actives.push(xe),z.ids.push(xe.identifier),Q.mode!=="semi")be(xe);else{if(!(s(Me,xe.position)<=Q.catchDistance))return xe.destroy(),void z.processOnStart(P);be(xe)}return xe},X.prototype.getOrCreate=function(P,k){var z,Q=this.options;return/(semi|static)/.test(Q.mode)?(z=this.idles[0])?(this.idles.splice(0,1),z):Q.mode==="semi"?this.createNipple(k,P):(console.warn("Coudln't find the needed nipple."),!1):z=this.createNipple(k,P)},X.prototype.processOnMove=function(P){var k=this.options,z=this.manager.getIdentifier(P),Q=this.nipples.get(z),Z=this.manager.scroll;if(function(De){return isNaN(De.buttons)?De.pressure!==0:De.buttons!==0}(P)){if(!Q)return console.error("Found zombie joystick with ID "+z),void this.manager.removeIdentifier(z);if(k.dynamicPage){var ce=Q.el.getBoundingClientRect();Q.position={x:Z.x+ce.left,y:Z.y+ce.top}}Q.identifier=z;var Me=Q.options.size/2,xe={x:P.pageX,y:P.pageY};k.lockX&&(xe.y=Q.position.y),k.lockY&&(xe.x=Q.position.x);var be,Fe,Ze,ut,it,gt,Rt,It,Ft,Ne,pn=s(xe,Q.position),St=(be=xe,Fe=Q.position,Ze=Fe.x-be.x,ut=Fe.y-be.y,c(Math.atan2(ut,Ze))),Vt=o(St),Ot=pn/Me,xn={distance:pn,position:xe};if(Q.options.shape==="circle"?(it=Math.min(pn,Me),Rt=Q.position,It=it,Ne={x:0,y:0},Ft=o(Ft=St),Ne.x=Rt.x-It*Math.cos(Ft),Ne.y=Rt.y-It*Math.sin(Ft),gt=Ne):(gt=function(De,he,ae){return{x:Math.min(Math.max(De.x,he.x-ae),he.x+ae),y:Math.min(Math.max(De.y,he.y-ae),he.y+ae)}}(xe,Q.position,Me),it=s(gt,Q.position)),k.follow){if(pn>Me){var Jt=xe.x-gt.x,Oe=xe.y-gt.y;Q.position.x+=Jt,Q.position.y+=Oe,Q.el.style.top=Q.position.y-(this.box.top+Z.y)+"px",Q.el.style.left=Q.position.x-(this.box.left+Z.x)+"px",pn=s(xe,Q.position)}}else xe=gt,pn=it;var Ie=xe.x-Q.position.x,yt=xe.y-Q.position.y;Q.frontPosition={x:Ie,y:yt},k.dataOnly||(Q.ui.front.style.transform="translate("+Ie+"px,"+yt+"px)");var kt={identifier:Q.identifier,position:xe,force:Ot,pressure:P.force||P.pressure||P.webkitForce||0,distance:pn,angle:{radian:Vt,degree:St},vector:{x:Ie/Me,y:-yt/Me},raw:xn,instance:Q,lockX:k.lockX,lockY:k.lockY};(kt=Q.computeDirection(kt)).angle={radian:o(180-St),degree:180-St},Q.trigger("move",kt),this.trigger("move "+Q.id+":move",kt)}else this.processOnEnd(P)},X.prototype.processOnEnd=function(P){var k=this,z=k.options,Q=k.manager.getIdentifier(P),Z=k.nipples.get(Q),ce=k.manager.removeIdentifier(Z.identifier);Z&&(z.dataOnly||Z.hide(function(){z.mode==="dynamic"&&(Z.trigger("removed",Z),k.trigger("removed "+Z.id+":removed",Z),k.manager.trigger("removed "+Z.id+":removed",Z),Z.destroy())}),clearInterval(k.pressureIntervals[Z.identifier]),Z.resetDirection(),Z.trigger("end",Z),k.trigger("end "+Z.id+":end",Z),k.ids.indexOf(Z.identifier)>=0&&k.ids.splice(k.ids.indexOf(Z.identifier),1),k.actives.indexOf(Z)>=0&&k.actives.splice(k.actives.indexOf(Z),1),/(semi|static)/.test(z.mode)?k.idles.push(Z):k.nipples.indexOf(Z)>=0&&k.nipples.splice(k.nipples.indexOf(Z),1),k.manager.unbindDocument(),/(semi|static)/.test(z.mode)&&(k.manager.ids[ce.id]=ce.identifier))},X.prototype.onDestroyed=function(P,k){this.nipples.indexOf(k)>=0&&this.nipples.splice(this.nipples.indexOf(k),1),this.actives.indexOf(k)>=0&&this.actives.splice(this.actives.indexOf(k),1),this.idles.indexOf(k)>=0&&this.idles.splice(this.idles.indexOf(k),1),this.ids.indexOf(k.identifier)>=0&&this.ids.splice(this.ids.indexOf(k.identifier),1),this.manager.removeIdentifier(k.identifier),this.manager.unbindDocument()},X.prototype.destroy=function(){for(var P in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(k){k.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(P)&&clearInterval(this.pressureIntervals[P]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var $=X;function te(P){var k=this;k.ids={},k.index=0,k.collections=[],k.scroll=m(),k.config(P),k.prepareCollections();var z=function(){var Z;k.collections.forEach(function(ce){ce.forEach(function(Me){Z=Me.el.getBoundingClientRect(),Me.position={x:k.scroll.x+Z.left,y:k.scroll.y+Z.top}})})};h(window,"resize",function(){u(z)});var Q=function(){k.scroll=m()};return h(window,"scroll",function(){u(Q)}),k.collections}te.prototype=new F,te.constructor=te,te.prototype.prepareCollections=function(){var P=this;P.collections.create=P.create.bind(P),P.collections.on=P.on.bind(P),P.collections.off=P.off.bind(P),P.collections.destroy=P.destroy.bind(P),P.collections.get=function(k){var z;return P.collections.every(function(Q){return!(z=Q.get(k))}),z}},te.prototype.create=function(P){return this.createCollection(P)},te.prototype.createCollection=function(P){var k=new $(this,P);return this.bindCollection(k),this.collections.push(k),k},te.prototype.bindCollection=function(P){var k,z=this,Q=function(Z,ce){k=Z.type+" "+ce.id+":"+Z.type,z.trigger(k,ce)};P.on("destroyed",z.onDestroyed.bind(z)),P.on("shown hidden rested dir plain",Q),P.on("dir:up dir:right dir:down dir:left",Q),P.on("plain:up plain:right plain:down plain:left",Q)},te.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},te.prototype.unbindDocument=function(P){Object.keys(this.ids).length&&P!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},te.prototype.getIdentifier=function(P){var k;return P?(k=P.identifier===void 0?P.pointerId:P.identifier)===void 0&&(k=this.latest||0):k=this.index,this.ids[k]===void 0&&(this.ids[k]=this.index,this.index+=1),this.latest=k,this.ids[k]},te.prototype.removeIdentifier=function(P){var k={};for(var z in this.ids)if(this.ids[z]===P){k.id=z,k.identifier=this.ids[z],delete this.ids[z];break}return k},te.prototype.onmove=function(P){return this.onAny("move",P),!1},te.prototype.onend=function(P){return this.onAny("end",P),!1},te.prototype.oncancel=function(P){return this.onAny("end",P),!1},te.prototype.onAny=function(P,k){var z,Q=this,Z="processOn"+P.charAt(0).toUpperCase()+P.slice(1);k=f(k);var ce=function(Me,xe,be){be.ids.indexOf(xe)>=0&&(be[Z](Me),Me._found_=!0)};return v(k,function(Me){z=Q.getIdentifier(Me),v(Q.collections,ce.bind(null,Me,z)),Me._found_||Q.removeIdentifier(z)}),!1},te.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(P){P.destroy()}),this.off()},te.prototype.onDestroyed=function(P,k){if(this.collections.indexOf(k)<0)return!1;this.collections.splice(this.collections.indexOf(k),1)};var U=new te;e.default={create:function(P){return U.create(P)},factory:U}}]).default})});var zQ={};var hw,$P=zc(()=>{"use strict";hw=uR(KP());AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;let n=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=n.pitchObject,this.yawObject=n.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(n){(this.data.moveJoystickPosition!==n.moveJoystickPosition||this.data.sideMargin!==n.sideMargin||this.data.bottomMargin!==n.bottomMargin||this.data.mode!==n.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==n.lookJoystickPosition||this.data.sideMargin!==n.sideMargin||this.data.bottomMargin!==n.bottomMargin||this.data.mode!==n.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){let n=this.moveData.force<1?this.moveData.force:1,e=this.moveData.angle.radian,t=Math.cos(e)*n,i=-Math.sin(e)*n;this.dVelocity.set(t,0,i)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(n){if(!this.isRotationActive())return;let e=this.lookData.force<1?this.lookData.force:1,t=this.lookData.angle.radian,i=this.lookVector;i.x=Math.cos(t)*e,i.y=Math.sin(t)*e,i.multiplyScalar(this.data.rotationSensitivity*n/1e3),this.yawObject.rotation.y-=i.x;let s=this.pitchObject.rotation.x+i.y;s=Math.max(-Math.PI/2,Math.min(Math.PI/2,s)),this.pitchObject.rotation.x=s},tick:function(n,e){this.updateRotation(e)},initLeftZone(){let n=document.createElement("div");n.setAttribute("id","joystickLeftZone"),n.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(n),this.leftZone=n},initRightZone(){let n=document.createElement("div");n.setAttribute("id","joystickRightZone"),n.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(n),this.rightZone=n},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();let n={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",n.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=hw.default.create(n),this.moveJoystick.on("move",(e,t)=>{this.moveData=t,this.moving=!0}),this.moveJoystick.on("end",(e,t)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();let n={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",n.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=hw.default.create(n),this.lookJoystick.on("move",(e,t)=>{this.lookData=t,this.rotating=!0}),this.lookJoystick.on("end",(e,t)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}})});var JP=Cr(()=>{"use strict";BP();VP();GP();jP();XP();YP();$P()});var eB=Cr((Dpe,ZP)=>{"use strict";var dw={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};ZP.exports=AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(dw)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];let n=this.el.getObject3D("mesh");n?this.load(n):this.el.addEventListener("model-loaded",e=>{this.load(e.detail.model)})},load:function(n){let e=this.el;this.model=n,this.mixer=new THREE.AnimationMixer(n),this.mixer.addEventListener("loop",t=>{e.emit("animation-loop",{action:t.action,loopDelta:t.loopDelta})}),this.mixer.addEventListener("finished",t=>{e.emit("animation-finished",{action:t.action,direction:t.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(n){if(!n)return;let e=this.data,t=AFRAME.utils.diff(e,n);if("clip"in t){this.stopAction(),e.clip&&this.playAction();return}this.activeActions.forEach(i=>{"duration"in t&&e.duration&&i.setDuration(e.duration),"clampWhenFinished"in t&&(i.clampWhenFinished=e.clampWhenFinished),("loop"in t||"repetitions"in t)&&i.setLoop(dw[e.loop],e.repetitions),"timeScale"in t&&i.setEffectiveTimeScale(e.timeScale)})},stopAction:function(){let n=this.data;for(let e=0;e<this.activeActions.length;e++)n.crossFadeDuration?this.activeActions[e].fadeOut(n.crossFadeDuration):this.activeActions[e].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;let n=this.model,e=this.data,t=n.animations||(n.geometry||{}).animations||[];if(!t.length)return;let i=e.useRegExp?e.clip:GQ(e.clip);for(let s,o=0;s=t[o];o++)if(s.name.match(i)){let c=this.mixer.clipAction(s,n);c.enabled=!0,c.clampWhenFinished=e.clampWhenFinished,e.duration&&c.setDuration(e.duration),e.timeScale!==1&&c.setEffectiveTimeScale(e.timeScale),c.startAt(this.mixer.time-e.startAt/1e3),c.setLoop(dw[e.loop],e.repetitions).fadeIn(e.crossFadeDuration).play(),this.activeActions.push(c)}},tick:function(n,e){this.mixer&&!isNaN(e)&&this.mixer.update(e/1e3)}});function GQ(n){return new RegExp("^"+n.split(/\*+/).map(WQ).join(".*")+"$")}function WQ(n){return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}});var nB=Cr((Lpe,tB)=>{"use strict";tB.exports=THREE.ColladaLoader=function(n){this.manager=n!==void 0?n:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(n,e,t,i){var s=this,o=s.path===void 0?THREE.LoaderUtils.extractUrlBase(n):s.path,c=new THREE.FileLoader(s.manager);c.setPath(s.path),c.load(n,function(l){e(s.parse(l,o))},t,i)},setPath:function(n){return this.path=n,this},setResourcePath:function(n){return this.resourcePath=n,this},options:{set convertUpAxis(n){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(n){return this.crossOrigin=n,this},parse:function(n,e){function t(oe,ue){for(var Ce=[],Be=oe.childNodes,Re=0,pt=Be.length;Re<pt;Re++){var Pt=Be[Re];Pt.nodeName===ue&&Ce.push(Pt)}return Ce}function i(oe){if(oe.length===0)return[];for(var ue=oe.trim().split(/\s+/),Ce=new Array(ue.length),Be=0,Re=ue.length;Be<Re;Be++)Ce[Be]=ue[Be];return Ce}function s(oe){if(oe.length===0)return[];for(var ue=oe.trim().split(/\s+/),Ce=new Array(ue.length),Be=0,Re=ue.length;Be<Re;Be++)Ce[Be]=parseFloat(ue[Be]);return Ce}function o(oe){if(oe.length===0)return[];for(var ue=oe.trim().split(/\s+/),Ce=new Array(ue.length),Be=0,Re=ue.length;Be<Re;Be++)Ce[Be]=parseInt(ue[Be]);return Ce}function c(oe){return oe.substring(1)}function l(){return"three_default_"+vt++}function u(oe){return Object.keys(oe).length===0}function h(oe){return{unit:p(t(oe,"unit")[0]),upAxis:f(t(oe,"up_axis")[0])}}function p(oe){return oe!==void 0&&oe.hasAttribute("meter")===!0?parseFloat(oe.getAttribute("meter")):1}function f(oe){return oe!==void 0?oe.textContent:"Y_UP"}function m(oe,ue,Ce,Be){var Re=t(oe,ue)[0];if(Re!==void 0)for(var pt=t(Re,Ce),Pt=0;Pt<pt.length;Pt++)Be(pt[Pt])}function A(oe,ue){for(var Ce in oe){var Be=oe[Ce];Be.build=ue(oe[Ce])}}function y(oe,ue){return oe.build!==void 0||(oe.build=ue(oe)),oe.build}function E(oe){for(var ue={sources:{},samplers:{},channels:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1){var pt;switch(Re.nodeName){case"source":pt=Re.getAttribute("id"),ue.sources[pt]=$e(Re);break;case"sampler":pt=Re.getAttribute("id"),ue.samplers[pt]=x(Re);break;case"channel":pt=Re.getAttribute("target"),ue.channels[pt]=v(Re);break;default:console.log(Re)}}}bt.animations[oe.getAttribute("id")]=ue}function x(oe){for(var ue={inputs:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"input":var pt=c(Re.getAttribute("source")),Pt=Re.getAttribute("semantic");ue.inputs[Pt]=pt;break}}return ue}function v(oe){var ue={},Ce=oe.getAttribute("target"),Be=Ce.split("/"),Re=Be.shift(),pt=Be.shift(),Pt=pt.indexOf("(")!==-1,Gt=pt.indexOf(".")!==-1;if(Gt)Be=pt.split("."),pt=Be.shift(),ue.member=Be.shift();else if(Pt){var Wt=pt.split("(");pt=Wt.shift();for(var Rn=0;Rn<Wt.length;Rn++)Wt[Rn]=parseInt(Wt[Rn].replace(/\)/,""));ue.indices=Wt}return ue.id=Re,ue.sid=pt,ue.arraySyntax=Pt,ue.memberSyntax=Gt,ue.sampler=c(oe.getAttribute("source")),ue}function w(oe){var ue=[],Ce=oe.channels,Be=oe.samplers,Re=oe.sources;for(var pt in Ce)if(Ce.hasOwnProperty(pt)){var Pt=Ce[pt],Gt=Be[Pt.sampler],Wt=Gt.inputs.INPUT,Rn=Gt.inputs.OUTPUT,sn=Re[Wt],Sn=Re[Rn],Jn=T(Pt,sn,Sn);R(Jn,ue)}return ue}function M(oe){return y(bt.animations[oe],w)}function T(oe,ue,Ce){var Be=bt.nodes[oe.id],Re=Wn(Be.id),pt=Be.transforms[oe.sid],Pt=Be.matrix.clone().transpose(),Gt,Wt,Rn,sn,Sn,Jn,Zn={};switch(pt){case"matrix":for(Rn=0,sn=ue.array.length;Rn<sn;Rn++)if(Gt=ue.array[Rn],Wt=Rn*Ce.stride,Zn[Gt]===void 0&&(Zn[Gt]={}),oe.arraySyntax===!0){var ri=Ce.array[Wt],On=oe.indices[0]+4*oe.indices[1];Zn[Gt][On]=ri}else for(Sn=0,Jn=Ce.stride;Sn<Jn;Sn++)Zn[Gt][Sn]=Ce.array[Wt+Sn];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break}var oi=D(Zn,Pt),ci={name:Re.uuid,keyframes:oi};return ci}function D(oe,ue){var Ce=[];for(var Be in oe)Ce.push({time:parseFloat(Be),value:oe[Be]});Ce.sort(pt);for(var Re=0;Re<16;Re++)N(Ce,Re,ue.elements[Re]);return Ce;function pt(Pt,Gt){return Pt.time-Gt.time}}var L=new THREE.Vector3,I=new THREE.Vector3,F=new THREE.Quaternion;function R(oe,ue){for(var Ce=oe.keyframes,Be=oe.name,Re=[],pt=[],Pt=[],Gt=[],Wt=0,Rn=Ce.length;Wt<Rn;Wt++){var sn=Ce[Wt],Sn=sn.time,Jn=sn.value;_e.fromArray(Jn).transpose(),_e.decompose(L,F,I),Re.push(Sn),pt.push(L.x,L.y,L.z),Pt.push(F.x,F.y,F.z,F.w),Gt.push(I.x,I.y,I.z)}return pt.length>0&&ue.push(new THREE.VectorKeyframeTrack(Be+".position",Re,pt)),Pt.length>0&&ue.push(new THREE.QuaternionKeyframeTrack(Be+".quaternion",Re,Pt)),Gt.length>0&&ue.push(new THREE.VectorKeyframeTrack(Be+".scale",Re,Gt)),ue}function N(oe,ue,Ce){var Be,Re=!0,pt,Pt;for(pt=0,Pt=oe.length;pt<Pt;pt++)Be=oe[pt],Be.value[ue]===void 0?Be.value[ue]=null:Re=!1;if(Re===!0)for(pt=0,Pt=oe.length;pt<Pt;pt++)Be=oe[pt],Be.value[ue]=Ce;else X(oe,ue)}function X(oe,ue){for(var Ce,Be,Re=0,pt=oe.length;Re<pt;Re++){var Pt=oe[Re];if(Pt.value[ue]===null){if(Ce=$(oe,Re,ue),Be=te(oe,Re,ue),Ce===null){Pt.value[ue]=Be.value[ue];continue}if(Be===null){Pt.value[ue]=Ce.value[ue];continue}U(Pt,Ce,Be,ue)}}}function $(oe,ue,Ce){for(;ue>=0;){var Be=oe[ue];if(Be.value[Ce]!==null)return Be;ue--}return null}function te(oe,ue,Ce){for(;ue<oe.length;){var Be=oe[ue];if(Be.value[Ce]!==null)return Be;ue++}return null}function U(oe,ue,Ce,Be){if(Ce.time-ue.time===0){oe.value[Be]=ue.value[Be];return}oe.value[Be]=(oe.time-ue.time)*(Ce.value[Be]-ue.value[Be])/(Ce.time-ue.time)+ue.value[Be]}function P(oe){for(var ue={name:oe.getAttribute("id")||"default",start:parseFloat(oe.getAttribute("start")||0),end:parseFloat(oe.getAttribute("end")||0),animations:[]},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"instance_animation":ue.animations.push(c(Re.getAttribute("url")));break}}bt.clips[oe.getAttribute("id")]=ue}function k(oe){for(var ue=[],Ce=oe.name,Be=oe.end-oe.start||-1,Re=oe.animations,pt=0,Pt=Re.length;pt<Pt;pt++)for(var Gt=M(Re[pt]),Wt=0,Rn=Gt.length;Wt<Rn;Wt++)ue.push(Gt[Wt]);return new THREE.AnimationClip(Ce,Be,ue)}function z(oe){return y(bt.clips[oe],k)}function Q(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"skin":ue.id=c(Re.getAttribute("source")),ue.skin=Z(Re);break;case"morph":ue.id=c(Re.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}bt.controllers[oe.getAttribute("id")]=ue}function Z(oe){for(var ue={sources:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"bind_shape_matrix":ue.bindShapeMatrix=s(Re.textContent);break;case"source":var pt=Re.getAttribute("id");ue.sources[pt]=$e(Re);break;case"joints":ue.joints=ce(Re);break;case"vertex_weights":ue.vertexWeights=Me(Re);break}}return ue}function ce(oe){for(var ue={inputs:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"input":var pt=Re.getAttribute("semantic"),Pt=c(Re.getAttribute("source"));ue.inputs[pt]=Pt;break}}return ue}function Me(oe){for(var ue={inputs:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"input":var pt=Re.getAttribute("semantic"),Pt=c(Re.getAttribute("source")),Gt=parseInt(Re.getAttribute("offset"));ue.inputs[pt]={id:Pt,offset:Gt};break;case"vcount":ue.vcount=o(Re.textContent);break;case"v":ue.v=o(Re.textContent);break}}return ue}function xe(oe){var ue={id:oe.id},Ce=bt.geometries[ue.id];return oe.skin!==void 0&&(ue.skin=be(oe.skin),Ce.sources.skinIndices=ue.skin.indices,Ce.sources.skinWeights=ue.skin.weights),ue}function be(oe){var ue=4,Ce={joints:[],indices:{array:[],stride:ue},weights:{array:[],stride:ue}},Be=oe.sources,Re=oe.vertexWeights,pt=Re.vcount,Pt=Re.v,Gt=Re.inputs.JOINT.offset,Wt=Re.inputs.WEIGHT.offset,Rn=oe.sources[oe.joints.inputs.JOINT],sn=oe.sources[oe.joints.inputs.INV_BIND_MATRIX],Sn=Be[Re.inputs.WEIGHT.id].array,Jn=0,Zn,ri,On;for(Zn=0,On=pt.length;Zn<On;Zn++){var oi=pt[Zn],ci=[];for(ri=0;ri<oi;ri++){var Pi=Pt[Jn+Gt],vr=Pt[Jn+Wt],Fr=Sn[vr];ci.push({index:Pi,weight:Fr}),Jn+=2}for(ci.sort(Oo),ri=0;ri<ue;ri++){var Ii=ci[ri];Ii!==void 0?(Ce.indices.array.push(Ii.index),Ce.weights.array.push(Ii.weight)):(Ce.indices.array.push(0),Ce.weights.array.push(0))}}for(oe.bindShapeMatrix?Ce.bindMatrix=new THREE.Matrix4().fromArray(oe.bindShapeMatrix).transpose():Ce.bindMatrix=new THREE.Matrix4().identity(),Zn=0,On=Rn.array.length;Zn<On;Zn++){var Qr=Rn.array[Zn],ai=new THREE.Matrix4().fromArray(sn.array,Zn*sn.stride).transpose();Ce.joints.push({name:Qr,boneInverse:ai})}return Ce;function Oo(xo,Os){return Os.weight-xo.weight}}function Fe(oe){return y(bt.controllers[oe],xe)}function Ze(oe){var ue={init_from:t(oe,"init_from")[0].textContent};bt.images[oe.getAttribute("id")]=ue}function ut(oe){return oe.build!==void 0?oe.build:oe.init_from}function it(oe){var ue=bt.images[oe];return ue!==void 0?y(ue,ut):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",oe),null)}function gt(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"profile_COMMON":ue.profile=Rt(Re);break}}bt.effects[oe.getAttribute("id")]=ue}function Rt(oe){for(var ue={surfaces:{},samplers:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"newparam":It(Re,ue);break;case"technique":ue.technique=pn(Re);break;case"extra":ue.extra=Oe(Re);break}}return ue}function It(oe,ue){for(var Ce=oe.getAttribute("sid"),Be=0,Re=oe.childNodes.length;Be<Re;Be++){var pt=oe.childNodes[Be];if(pt.nodeType===1)switch(pt.nodeName){case"surface":ue.surfaces[Ce]=Ft(pt);break;case"sampler2D":ue.samplers[Ce]=Ne(pt);break}}}function Ft(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"init_from":ue.init_from=Re.textContent;break}}return ue}function Ne(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"source":ue.source=Re.textContent;break}}return ue}function pn(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"constant":case"lambert":case"blinn":case"phong":ue.type=Re.nodeName,ue.parameters=St(Re);break}}return ue}function St(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":ue[Re.nodeName]=Vt(Re);break;case"transparent":ue[Re.nodeName]={opaque:Re.getAttribute("opaque"),data:Vt(Re)};break}}return ue}function Vt(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"color":ue[Re.nodeName]=s(Re.textContent);break;case"float":ue[Re.nodeName]=parseFloat(Re.textContent);break;case"texture":ue[Re.nodeName]={id:Re.getAttribute("texture"),extra:Ot(Re)};break}}return ue}function Ot(oe){for(var ue={technique:{}},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"extra":xn(Re,ue);break}}return ue}function xn(oe,ue){for(var Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"technique":Jt(Re,ue);break}}}function Jt(oe,ue){for(var Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":ue.technique[Re.nodeName]=parseFloat(Re.textContent);break;case"wrapU":case"wrapV":Re.textContent.toUpperCase()==="TRUE"?ue.technique[Re.nodeName]=1:Re.textContent.toUpperCase()==="FALSE"?ue.technique[Re.nodeName]=0:ue.technique[Re.nodeName]=parseInt(Re.textContent);break}}}function Oe(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"technique":ue.technique=Ie(Re);break}}return ue}function Ie(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"double_sided":ue[Re.nodeName]=parseInt(Re.textContent);break}}return ue}function yt(oe){return oe}function kt(oe){return y(bt.effects[oe],yt)}function De(oe){for(var ue={name:oe.getAttribute("name")},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"instance_effect":ue.url=c(Re.getAttribute("url"));break}}bt.materials[oe.getAttribute("id")]=ue}function he(oe){var ue,Ce=oe.slice((oe.lastIndexOf(".")-1>>>0)+2);switch(Ce=Ce.toLowerCase(),Ce){case"tga":ue=Se;break;default:ue=ye}return ue}function ae(oe){var ue=kt(oe.url),Ce=ue.profile.technique,Be=ue.profile.extra,Re;switch(Ce.type){case"phong":case"blinn":Re=new THREE.MeshPhongMaterial;break;case"lambert":Re=new THREE.MeshLambertMaterial;break;default:Re=new THREE.MeshBasicMaterial;break}Re.name=oe.name;function pt(Jn){var Zn=ue.profile.samplers[Jn.id],ri=null;if(Zn!==void 0){var On=ue.profile.surfaces[Zn.source];ri=it(On.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),ri=it(Jn.id);if(ri!==null){var oi=he(ri);if(oi!==void 0){var ci=oi.load(ri),Pi=Jn.extra;if(Pi!==void 0&&Pi.technique!==void 0&&u(Pi.technique)===!1){var vr=Pi.technique;ci.wrapS=vr.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,ci.wrapT=vr.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,ci.offset.set(vr.offsetU||0,vr.offsetV||0),ci.repeat.set(vr.repeatU||1,vr.repeatV||1)}else ci.wrapS=THREE.RepeatWrapping,ci.wrapT=THREE.RepeatWrapping;return ci}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",ri),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",Jn.id),null}var Pt=Ce.parameters;for(var Gt in Pt){var Wt=Pt[Gt];switch(Gt){case"diffuse":Wt.color&&Re.color.fromArray(Wt.color),Wt.texture&&(Re.map=pt(Wt.texture));break;case"specular":Wt.color&&Re.specular&&Re.specular.fromArray(Wt.color),Wt.texture&&(Re.specularMap=pt(Wt.texture));break;case"bump":Wt.texture&&(Re.normalMap=pt(Wt.texture));break;case"ambient":Wt.texture&&(Re.lightMap=pt(Wt.texture));break;case"shininess":Wt.float&&Re.shininess&&(Re.shininess=Wt.float);break;case"emission":Wt.color&&Re.emissive&&Re.emissive.fromArray(Wt.color),Wt.texture&&(Re.emissiveMap=pt(Wt.texture));break}}var Rn=Pt.transparent,sn=Pt.transparency;if(sn===void 0&&Rn&&(sn={float:1}),Rn===void 0&&sn&&(Rn={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Rn&&sn)if(Rn.data.texture)Re.transparent=!0;else{var Sn=Rn.data.color;switch(Rn.opaque){case"A_ONE":Re.opacity=Sn[3]*sn.float;break;case"RGB_ZERO":Re.opacity=1-Sn[0]*sn.float;break;case"A_ZERO":Re.opacity=1-Sn[3]*sn.float;break;case"RGB_ONE":Re.opacity=Sn[0]*sn.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Rn.opaque)}Re.opacity<1&&(Re.transparent=!0)}return Be!==void 0&&Be.technique!==void 0&&Be.technique.double_sided===1&&(Re.side=THREE.DoubleSide),Re}function de(oe){return y(bt.materials[oe],ae)}function we(oe){for(var ue={name:oe.getAttribute("name")},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"optics":ue.optics=Ae(Re);break}}bt.cameras[oe.getAttribute("id")]=ue}function Ae(oe){for(var ue=0;ue<oe.childNodes.length;ue++){var Ce=oe.childNodes[ue];switch(Ce.nodeName){case"technique_common":return Le(Ce)}}return{}}function Le(oe){for(var ue={},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];switch(Be.nodeName){case"perspective":case"orthographic":ue.technique=Be.nodeName,ue.parameters=Ee(Be);break}}return ue}function Ee(oe){for(var ue={},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];switch(Be.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":ue[Be.nodeName]=parseFloat(Be.textContent);break}}return ue}function ze(oe){var ue;switch(oe.optics.technique){case"perspective":ue=new THREE.PerspectiveCamera(oe.optics.parameters.yfov,oe.optics.parameters.aspect_ratio,oe.optics.parameters.znear,oe.optics.parameters.zfar);break;case"orthographic":var Ce=oe.optics.parameters.ymag,Be=oe.optics.parameters.xmag,Re=oe.optics.parameters.aspect_ratio;Be=Be===void 0?Ce*Re:Be,Ce=Ce===void 0?Be/Re:Ce,Be*=.5,Ce*=.5,ue=new THREE.OrthographicCamera(-Be,Be,Ce,-Ce,oe.optics.parameters.znear,oe.optics.parameters.zfar);break;default:ue=new THREE.PerspectiveCamera;break}return ue.name=oe.name,ue}function Ge(oe){var ue=bt.cameras[oe];return ue!==void 0?y(ue,ze):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",oe),null)}function ee(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"technique_common":ue=V(Re);break}}bt.lights[oe.getAttribute("id")]=ue}function V(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"directional":case"point":case"spot":case"ambient":ue.technique=Re.nodeName,ue.parameters=G(Re)}}return ue}function G(oe){for(var ue={},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"color":var pt=s(Re.textContent);ue.color=new THREE.Color().fromArray(pt);break;case"falloff_angle":ue.falloffAngle=parseFloat(Re.textContent);break;case"quadratic_attenuation":var Pt=parseFloat(Re.textContent);ue.distance=Pt?Math.sqrt(1/Pt):0;break}}return ue}function pe(oe){var ue;switch(oe.technique){case"directional":ue=new THREE.DirectionalLight;break;case"point":ue=new THREE.PointLight;break;case"spot":ue=new THREE.SpotLight;break;case"ambient":ue=new THREE.AmbientLight;break}return oe.parameters.color&&ue.color.copy(oe.parameters.color),oe.parameters.distance&&(ue.distance=oe.parameters.distance),ue}function Ue(oe){var ue=bt.lights[oe];return ue!==void 0?y(ue,pe):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",oe),null)}function Qe(oe){var ue={name:oe.getAttribute("name"),sources:{},vertices:{},primitives:[]},Ce=t(oe,"mesh")[0];if(Ce!==void 0){for(var Be=0;Be<Ce.childNodes.length;Be++){var Re=Ce.childNodes[Be];if(Re.nodeType===1){var pt=Re.getAttribute("id");switch(Re.nodeName){case"source":ue.sources[pt]=$e(Re);break;case"vertices":ue.vertices=nt(Re);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Re.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":ue.primitives.push(ge(Re));break;default:console.log(Re)}}}bt.geometries[oe.getAttribute("id")]=ue}}function $e(oe){for(var ue={array:[],stride:3},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"float_array":ue.array=s(Be.textContent);break;case"Name_array":ue.array=i(Be.textContent);break;case"technique_common":var Re=t(Be,"accessor")[0];Re!==void 0&&(ue.stride=parseInt(Re.getAttribute("stride")));break}}return ue}function nt(oe){for(var ue={},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];Be.nodeType===1&&(ue[Be.getAttribute("semantic")]=c(Be.getAttribute("source")))}return ue}function ge(oe){for(var ue={type:oe.nodeName,material:oe.getAttribute("material"),count:parseInt(oe.getAttribute("count")),inputs:{},stride:0,hasUV:!1},Ce=0,Be=oe.childNodes.length;Ce<Be;Ce++){var Re=oe.childNodes[Ce];if(Re.nodeType===1)switch(Re.nodeName){case"input":var pt=c(Re.getAttribute("source")),Pt=Re.getAttribute("semantic"),Gt=parseInt(Re.getAttribute("offset")),Wt=parseInt(Re.getAttribute("set")),Rn=Wt>0?Pt+Wt:Pt;ue.inputs[Rn]={id:pt,offset:Gt},ue.stride=Math.max(ue.stride,Gt+1),Pt==="TEXCOORD"&&(ue.hasUV=!0);break;case"vcount":ue.vcount=o(Re.textContent);break;case"p":ue.p=o(Re.textContent);break}}return ue}function ot(oe){for(var ue={},Ce=0;Ce<oe.length;Ce++){var Be=oe[Ce];ue[Be.type]===void 0&&(ue[Be.type]=[]),ue[Be.type].push(Be)}return ue}function et(oe){for(var ue=0,Ce=0,Be=oe.length;Ce<Be;Ce++){var Re=oe[Ce];Re.hasUV===!0&&ue++}ue>0&&ue<oe.length&&(oe.uvsNeedsFix=!0)}function tt(oe){var ue={},Ce=oe.sources,Be=oe.vertices,Re=oe.primitives;if(Re.length===0)return{};var pt=ot(Re);for(var Pt in pt){var Gt=pt[Pt];et(Gt),ue[Pt]=_t(Gt,Ce,Be)}return ue}function _t(oe,ue,Ce){for(var Be={},Re={array:[],stride:0},pt={array:[],stride:0},Pt={array:[],stride:0},Gt={array:[],stride:0},Wt={array:[],stride:0},Rn={array:[],stride:4},sn={array:[],stride:4},Sn=new THREE.BufferGeometry,Jn=[],Zn=0,ri=0;ri<oe.length;ri++){var On=oe[ri],oi=On.inputs,ci=0;switch(On.type){case"lines":case"linestrips":ci=On.count*2;break;case"triangles":ci=On.count*3;break;case"polylist":for(var Pi=0;Pi<On.count;Pi++){var vr=On.vcount[Pi];switch(vr){case 3:ci+=3;break;case 4:ci+=6;break;default:ci+=(vr-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",On.type)}Sn.addGroup(Zn,ci,ri),Zn+=ci,On.material&&Jn.push(On.material);for(var Fr in oi){var Ii=oi[Fr];switch(Fr){case"VERTEX":for(var Qr in Ce){var ai=Ce[Qr];switch(Qr){case"POSITION":var Oo=Re.array.length;if(tn(On,ue[ai],Ii.offset,Re.array),Re.stride=ue[ai].stride,ue.skinWeights&&ue.skinIndices&&(tn(On,ue.skinIndices,Ii.offset,Rn.array),tn(On,ue.skinWeights,Ii.offset,sn.array)),On.hasUV===!1&&oe.uvsNeedsFix===!0)for(var ci=(Re.array.length-Oo)/Re.stride,xo=0;xo<ci;xo++)Pt.array.push(0,0);break;case"NORMAL":tn(On,ue[ai],Ii.offset,pt.array),pt.stride=ue[ai].stride;break;case"COLOR":tn(On,ue[ai],Ii.offset,Wt.array),Wt.stride=ue[ai].stride;break;case"TEXCOORD":tn(On,ue[ai],Ii.offset,Pt.array),Pt.stride=ue[ai].stride;break;case"TEXCOORD1":tn(On,ue[ai],Ii.offset,Gt.array),Pt.stride=ue[ai].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Qr)}}break;case"NORMAL":tn(On,ue[Ii.id],Ii.offset,pt.array),pt.stride=ue[Ii.id].stride;break;case"COLOR":tn(On,ue[Ii.id],Ii.offset,Wt.array),Wt.stride=ue[Ii.id].stride;break;case"TEXCOORD":tn(On,ue[Ii.id],Ii.offset,Pt.array),Pt.stride=ue[Ii.id].stride;break;case"TEXCOORD1":tn(On,ue[Ii.id],Ii.offset,Gt.array),Gt.stride=ue[Ii.id].stride;break}}}return Re.array.length>0&&Sn.addAttribute("position",new THREE.Float32BufferAttribute(Re.array,Re.stride)),pt.array.length>0&&Sn.addAttribute("normal",new THREE.Float32BufferAttribute(pt.array,pt.stride)),Wt.array.length>0&&Sn.addAttribute("color",new THREE.Float32BufferAttribute(Wt.array,Wt.stride)),Pt.array.length>0&&Sn.addAttribute("uv",new THREE.Float32BufferAttribute(Pt.array,Pt.stride)),Gt.array.length>0&&Sn.addAttribute("uv2",new THREE.Float32BufferAttribute(Gt.array,Gt.stride)),Rn.array.length>0&&Sn.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Rn.array,Rn.stride)),sn.array.length>0&&Sn.addAttribute("skinWeight",new THREE.Float32BufferAttribute(sn.array,sn.stride)),Be.data=Sn,Be.type=oe[0].type,Be.materialKeys=Jn,Be}function tn(oe,ue,Ce,Be){var Re=oe.p,pt=oe.stride,Pt=oe.vcount;function Gt(Fr){for(var Ii=Re[Fr+Ce]*Rn,Qr=Ii+Rn;Ii<Qr;Ii++)Be.push(Wt[Ii])}var Wt=ue.array,Rn=ue.stride;if(oe.vcount!==void 0)for(var sn=0,Sn=0,Jn=Pt.length;Sn<Jn;Sn++){var Zn=Pt[Sn];if(Zn===4){var ri=sn+pt*0,On=sn+pt*1,oi=sn+pt*2,ci=sn+pt*3;Gt(ri),Gt(On),Gt(ci),Gt(On),Gt(oi),Gt(ci)}else if(Zn===3){var ri=sn+pt*0,On=sn+pt*1,oi=sn+pt*2;Gt(ri),Gt(On),Gt(oi)}else if(Zn>4)for(var Pi=1,vr=Zn-2;Pi<=vr;Pi++){var ri=sn+pt*0,On=sn+pt*Pi,oi=sn+pt*(Pi+1);Gt(ri),Gt(On),Gt(oi)}sn+=pt*Zn}else for(var Sn=0,Jn=Re.length;Sn<Jn;Sn+=pt)Gt(Sn)}function En(oe){return y(bt.geometries[oe],tt)}function Cn(oe){for(var ue={name:oe.getAttribute("name")||"",joints:{},links:[]},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"technique_common":jt(Be,ue);break}}bt.kinematicsModels[oe.getAttribute("id")]=ue}function en(oe){return oe.build!==void 0?oe.build:oe}function xt(oe){return y(bt.kinematicsModels[oe],en)}function jt(oe,ue){for(var Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"joint":ue.joints[Be.getAttribute("sid")]=Pn(Be);break;case"link":ue.links.push(Kn(Be));break}}}function Pn(oe){for(var ue,Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"prismatic":case"revolute":ue=In(Be);break}}return ue}function In(oe,Ce){for(var Ce={sid:oe.getAttribute("sid"),name:oe.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:oe.nodeName,static:!1,zeroPosition:0,middlePosition:0},Be=0;Be<oe.childNodes.length;Be++){var Re=oe.childNodes[Be];if(Re.nodeType===1)switch(Re.nodeName){case"axis":var pt=s(Re.textContent);Ce.axis.fromArray(pt);break;case"limits":var Pt=Re.getElementsByTagName("max")[0],Gt=Re.getElementsByTagName("min")[0];Ce.limits.max=parseFloat(Pt.textContent),Ce.limits.min=parseFloat(Gt.textContent);break}}return Ce.limits.min>=Ce.limits.max&&(Ce.static=!0),Ce.middlePosition=(Ce.limits.min+Ce.limits.max)/2,Ce}function Kn(oe){for(var ue={sid:oe.getAttribute("sid"),name:oe.getAttribute("name")||"",attachments:[],transforms:[]},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"attachment_full":ue.attachments.push(Gn(Be));break;case"matrix":case"translate":case"rotate":ue.transforms.push(fi(Be));break}}return ue}function Gn(oe){for(var ue={joint:oe.getAttribute("joint").split("/").pop(),transforms:[],links:[]},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"link":ue.links.push(Kn(Be));break;case"matrix":case"translate":case"rotate":ue.transforms.push(fi(Be));break}}return ue}function fi(oe){var ue={type:oe.nodeName},Ce=s(oe.textContent);switch(ue.type){case"matrix":ue.obj=new THREE.Matrix4,ue.obj.fromArray(Ce).transpose();break;case"translate":ue.obj=new THREE.Vector3,ue.obj.fromArray(Ce);break;case"rotate":ue.obj=new THREE.Vector3,ue.obj.fromArray(Ce),ue.angle=THREE.MathUtils.degToRad(Ce[3]);break}return ue}function xi(oe){for(var ue={name:oe.getAttribute("name")||"",rigidBodies:{}},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"rigid_body":ue.rigidBodies[Be.getAttribute("name")]={},Ti(Be,ue.rigidBodies[Be.getAttribute("name")]);break}}bt.physicsModels[oe.getAttribute("id")]=ue}function Ti(oe,ue){for(var Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"technique_common":ir(Be,ue);break}}}function ir(oe,ue){for(var Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"inertia":ue.inertia=s(Be.textContent);break;case"mass":ue.mass=s(Be.textContent)[0];break}}}function dr(oe){for(var ue={bindJointAxis:[]},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"bind_joint_axis":ue.bindJointAxis.push(Ai(Be));break}}bt.kinematicsScenes[c(oe.getAttribute("url"))]=ue}function Ai(oe){for(var ue={target:oe.getAttribute("target").split("/").pop()},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"axis":var Re=Be.getElementsByTagName("param")[0];ue.axis=Re.textContent;var pt=ue.axis.split("inst_").pop().split("axis")[0];ue.jointIndex=pt.substr(0,pt.length-1);break}}return ue}function Mi(oe){return oe.build!==void 0?oe.build:oe}function ne(oe){return y(bt.kinematicsScenes[oe],Mi)}function Y(){var oe=Object.keys(bt.kinematicsModels)[0],ue=Object.keys(bt.kinematicsScenes)[0],Ce=Object.keys(bt.visualScenes)[0];if(oe===void 0||ue===void 0)return;for(var Be=xt(oe),Re=ne(ue),pt=zn(Ce),Pt=Re.bindJointAxis,Gt={},Wt=0,Rn=Pt.length;Wt<Rn;Wt++){var sn=Pt[Wt],Sn=$n.querySelector('[sid="'+sn.target+'"]');if(Sn){var Jn=Sn.parentElement;Zn(sn.jointIndex,Jn)}}function Zn(On,oi){var ci=oi.getAttribute("name"),Pi=Be.joints[On];pt.traverse(function(vr){vr.name===ci&&(Gt[On]={object:vr,transforms:le(oi),joint:Pi,position:Pi.zeroPosition})})}var ri=new THREE.Matrix4;at={joints:Be&&Be.joints,getJointValue:function(On){var oi=Gt[On];if(oi)return oi.position;console.warn("THREE.ColladaLoader: Joint "+On+" doesn't exist.")},setJointValue:function(On,oi){var ci=Gt[On];if(ci){var Pi=ci.joint;if(oi>Pi.limits.max||oi<Pi.limits.min)console.warn("THREE.ColladaLoader: Joint "+On+" value "+oi+" outside of limits (min: "+Pi.limits.min+", max: "+Pi.limits.max+").");else if(Pi.static)console.warn("THREE.ColladaLoader: Joint "+On+" is static.");else{var vr=ci.object,Fr=Pi.axis,Ii=ci.transforms;_e.identity();for(var Qr=0;Qr<Ii.length;Qr++){var ai=Ii[Qr];if(ai.sid&&ai.sid.indexOf(On)!==-1)switch(Pi.type){case"revolute":_e.multiply(ri.makeRotationAxis(Fr,THREE.MathUtils.degToRad(oi)));break;case"prismatic":_e.multiply(ri.makeTranslation(Fr.x*oi,Fr.y*oi,Fr.z*oi));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Pi.type);break}else switch(ai.type){case"matrix":_e.multiply(ai.obj);break;case"translate":_e.multiply(ri.makeTranslation(ai.obj.x,ai.obj.y,ai.obj.z));break;case"scale":_e.scale(ai.obj);break;case"rotate":_e.multiply(ri.makeRotationAxis(ai.obj,ai.angle));break}}vr.matrix.copy(_e),vr.matrix.decompose(vr.position,vr.quaternion,vr.scale),Gt[On].position=oi}}else console.log("THREE.ColladaLoader: "+On+" does not exist.")}}}function le(oe){for(var ue=[],Ce=$n.querySelector('[id="'+oe.id+'"]'),Be=0;Be<Ce.childNodes.length;Be++){var Re=Ce.childNodes[Be];if(Re.nodeType===1)switch(Re.nodeName){case"matrix":var Pt=s(Re.textContent),pt=new THREE.Matrix4().fromArray(Pt).transpose();ue.push({sid:Re.getAttribute("sid"),type:Re.nodeName,obj:pt});break;case"translate":case"scale":var Pt=s(Re.textContent),Gt=new THREE.Vector3().fromArray(Pt);ue.push({sid:Re.getAttribute("sid"),type:Re.nodeName,obj:Gt});break;case"rotate":var Pt=s(Re.textContent),Gt=new THREE.Vector3().fromArray(Pt),Wt=THREE.MathUtils.degToRad(Pt[3]);ue.push({sid:Re.getAttribute("sid"),type:Re.nodeName,obj:Gt,angle:Wt});break}}return ue}function me(oe){for(var ue=oe.getElementsByTagName("node"),Ce=0;Ce<ue.length;Ce++){var Be=ue[Ce];Be.hasAttribute("id")===!1&&Be.setAttribute("id",l())}}var _e=new THREE.Matrix4,Xe=new THREE.Vector3;function rt(oe){for(var ue={name:oe.getAttribute("name")||"",type:oe.getAttribute("type"),id:oe.getAttribute("id"),sid:oe.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];if(Be.nodeType===1)switch(Be.nodeName){case"node":ue.nodes.push(Be.getAttribute("id")),rt(Be);break;case"instance_camera":ue.instanceCameras.push(c(Be.getAttribute("url")));break;case"instance_controller":ue.instanceControllers.push(At(Be));break;case"instance_light":ue.instanceLights.push(c(Be.getAttribute("url")));break;case"instance_geometry":ue.instanceGeometries.push(At(Be));break;case"instance_node":ue.instanceNodes.push(c(Be.getAttribute("url")));break;case"matrix":var pt=s(Be.textContent);ue.matrix.multiply(_e.fromArray(pt).transpose()),ue.transforms[Be.getAttribute("sid")]=Be.nodeName;break;case"translate":var pt=s(Be.textContent);Xe.fromArray(pt),ue.matrix.multiply(_e.makeTranslation(Xe.x,Xe.y,Xe.z)),ue.transforms[Be.getAttribute("sid")]=Be.nodeName;break;case"rotate":var pt=s(Be.textContent),Re=THREE.MathUtils.degToRad(pt[3]);ue.matrix.multiply(_e.makeRotationAxis(Xe.fromArray(pt),Re)),ue.transforms[Be.getAttribute("sid")]=Be.nodeName;break;case"scale":var pt=s(Be.textContent);ue.matrix.scale(Xe.fromArray(pt)),ue.transforms[Be.getAttribute("sid")]=Be.nodeName;break;case"extra":break;default:console.log(Be)}}return Hn(ue.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",ue.id):bt.nodes[ue.id]=ue,ue}function At(oe){for(var ue={id:c(oe.getAttribute("url")),materials:{},skeletons:[]},Ce=0;Ce<oe.childNodes.length;Ce++){var Be=oe.childNodes[Ce];switch(Be.nodeName){case"bind_material":for(var Re=Be.getElementsByTagName("instance_material"),pt=0;pt<Re.length;pt++){var Pt=Re[pt],Gt=Pt.getAttribute("symbol"),Wt=Pt.getAttribute("target");ue.materials[Gt]=c(Wt)}break;case"skeleton":ue.skeletons.push(c(Be.textContent));break;default:break}}return ue}function Ct(oe,ue){var Ce=[],Be=[],Re,pt,Pt;for(Re=0;Re<oe.length;Re++){var Gt=oe[Re],Wt;if(Hn(Gt))Wt=Wn(Gt),Tt(Wt,ue,Ce);else if(lr(Gt))for(var Rn=bt.visualScenes[Gt],sn=Rn.children,pt=0;pt<sn.length;pt++){var Sn=sn[pt];if(Sn.type==="JOINT"){var Wt=Wn(Sn.id);Tt(Wt,ue,Ce)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Gt)}for(Re=0;Re<ue.length;Re++)for(pt=0;pt<Ce.length;pt++)if(Pt=Ce[pt],Pt.bone.name===ue[Re].name){Be[Re]=Pt,Pt.processed=!0;break}for(Re=0;Re<Ce.length;Re++)Pt=Ce[Re],Pt.processed===!1&&(Be.push(Pt),Pt.processed=!0);var Jn=[],Zn=[];for(Re=0;Re<Be.length;Re++)Pt=Be[Re],Jn.push(Pt.bone),Zn.push(Pt.boneInverse);return new THREE.Skeleton(Jn,Zn)}function Tt(oe,ue,Ce){oe.traverse(function(Be){if(Be.isBone===!0){for(var Re,pt=0;pt<ue.length;pt++){var Pt=ue[pt];if(Pt.name===Be.name){Re=Pt.boneInverse;break}}Re===void 0&&(Re=new THREE.Matrix4),Ce.push({bone:Be,boneInverse:Re,processed:!1})}})}function mt(oe){for(var ue=[],Ce=oe.matrix,Be=oe.nodes,Re=oe.type,pt=oe.instanceCameras,Pt=oe.instanceControllers,Gt=oe.instanceLights,Wt=oe.instanceGeometries,Rn=oe.instanceNodes,sn=0,Sn=Be.length;sn<Sn;sn++)ue.push(Wn(Be[sn]));for(var sn=0,Sn=pt.length;sn<Sn;sn++){var Jn=Ge(pt[sn]);Jn!==null&&ue.push(Jn.clone())}for(var sn=0,Sn=Pt.length;sn<Sn;sn++)for(var Zn=Pt[sn],ri=Fe(Zn.id),On=En(ri.id),oi=Ln(On,Zn.materials),ci=Zn.skeletons,Pi=ri.skin.joints,vr=Ct(ci,Pi),Fr=0,Ii=oi.length;Fr<Ii;Fr++){var ai=oi[Fr];ai.isSkinnedMesh&&(ai.bind(vr,ri.skin.bindMatrix),ai.normalizeSkinWeights()),ue.push(ai)}for(var sn=0,Sn=Gt.length;sn<Sn;sn++){var Qr=Ue(Gt[sn]);Qr!==null&&ue.push(Qr.clone())}for(var sn=0,Sn=Wt.length;sn<Sn;sn++)for(var Zn=Wt[sn],On=En(Zn.id),oi=Ln(On,Zn.materials),Fr=0,Ii=oi.length;Fr<Ii;Fr++)ue.push(oi[Fr]);for(var sn=0,Sn=Rn.length;sn<Sn;sn++)ue.push(Wn(Rn[sn]).clone());var ai;if(Be.length===0&&ue.length===1)ai=ue[0];else{ai=Re==="JOINT"?new THREE.Bone:new THREE.Group;for(var sn=0;sn<ue.length;sn++)ai.add(ue[sn])}return ai.name===""&&(ai.name=Re==="JOINT"?oe.sid:oe.name),ai.matrix.copy(Ce),ai.matrix.decompose(ai.position,ai.quaternion,ai.scale),ai}var Bt=new THREE.MeshBasicMaterial({color:16711935});function cn(oe,ue){for(var Ce=[],Be=0,Re=oe.length;Be<Re;Be++){var pt=ue[oe[Be]];pt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",oe[Be]),Ce.push(Bt)):Ce.push(de(pt))}return Ce}function Ln(oe,ue){var Ce=[];for(var Be in oe){var Re=oe[Be],pt=cn(Re.materialKeys,ue);pt.length===0&&(Be==="lines"||Be==="linestrips"?pt.push(new THREE.LineBasicMaterial):pt.push(new THREE.MeshPhongMaterial));var Pt=Re.data.attributes.skinIndex!==void 0;if(Pt)for(var Gt=0,Wt=pt.length;Gt<Wt;Gt++)pt[Gt].skinning=!0;var Rn=pt.length===1?pt[0]:pt,sn;switch(Be){case"lines":sn=new THREE.LineSegments(Re.data,Rn);break;case"linestrips":sn=new THREE.Line(Re.data,Rn);break;case"triangles":case"polylist":Pt?sn=new THREE.SkinnedMesh(Re.data,Rn):sn=new THREE.Mesh(Re.data,Rn);break}Ce.push(sn)}return Ce}function Hn(oe){return bt.nodes[oe]!==void 0}function Wn(oe){return y(bt.nodes[oe],mt)}function mn(oe){var ue={name:oe.getAttribute("name"),children:[]};me(oe);for(var Ce=t(oe,"node"),Be=0;Be<Ce.length;Be++)ue.children.push(rt(Ce[Be]));bt.visualScenes[oe.getAttribute("id")]=ue}function Yt(oe){var ue=new THREE.Group;ue.name=oe.name;for(var Ce=oe.children,Be=0;Be<Ce.length;Be++){var Re=Ce[Be];ue.add(Wn(Re.id))}return ue}function lr(oe){return bt.visualScenes[oe]!==void 0}function zn(oe){return y(bt.visualScenes[oe],Yt)}function yn(oe){var ue=t(oe,"instance_visual_scene")[0];return zn(c(ue.getAttribute("url")))}function Ei(){var oe=bt.clips;if(u(oe)===!0){if(u(bt.animations)===!1){var ue=[];for(var Ce in bt.animations)for(var Be=M(Ce),Re=0,pt=Be.length;Re<pt;Re++)ue.push(Be[Re]);He.push(new THREE.AnimationClip("default",-1,ue))}}else for(var Ce in oe)He.push(z(Ce))}if(n.length===0)return{scene:new THREE.Scene};var ur=new DOMParser().parseFromString(n,"application/xml"),$n=t(ur,"COLLADA")[0],q=$n.getAttribute("version");console.log("THREE.ColladaLoader: File version",q);var re=h(t($n,"asset")[0]),ye=new THREE.TextureLoader(this.manager);ye.setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);var Se;THREE.TGALoader&&(Se=new THREE.TGALoader(this.manager),Se.setPath(this.resourcePath||e));var He=[],at={},vt=0,bt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};m($n,"library_animations","animation",E),m($n,"library_animation_clips","animation_clip",P),m($n,"library_controllers","controller",Q),m($n,"library_images","image",Ze),m($n,"library_effects","effect",gt),m($n,"library_materials","material",De),m($n,"library_cameras","camera",we),m($n,"library_lights","light",ee),m($n,"library_geometries","geometry",Qe),m($n,"library_nodes","node",rt),m($n,"library_visual_scenes","visual_scene",mn),m($n,"library_kinematics_models","kinematics_model",Cn),m($n,"library_physics_models","physics_model",xi),m($n,"scene","instance_kinematics_scene",dr),A(bt.animations,w),A(bt.clips,k),A(bt.controllers,xe),A(bt.images,ut),A(bt.effects,yt),A(bt.materials,ae),A(bt.cameras,ze),A(bt.lights,pe),A(bt.geometries,tt),A(bt.visualScenes,Yt),Ei(),Y();var qt=yn(t($n,"scene")[0]);return re.upAxis==="Z_UP"&&qt.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),qt.scale.multiplyScalar(re.unit),{animations:He,kinematics:at,library:bt,scene:qt}}}});var rB=Cr((Ppe,iB)=>{"use strict";THREE.ColladaLoader=nB();iB.exports.Component=AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var n=this,e=this.el,t=this.data,i=this.el.sceneEl.systems.renderer;t&&(this.remove(),this.loader.load(t,function(s){n.model=s.scene,n.model.traverse(function(o){if(o.isMesh){var c=o.material;c.color&&i.applyColorCorrection(c.color),c.map&&i.applyColorCorrection(c.map),c.emissive&&i.applyColorCorrection(c.emissive),c.emissiveMap&&i.applyColorCorrection(c.emissiveMap)}}),e.setObject3D("mesh",n.model),e.emit("model-loaded",{format:"collada",model:n.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})});function mu(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(fo[n&255]+fo[n>>8&255]+fo[n>>16&255]+fo[n>>24&255]+"-"+fo[e&255]+fo[e>>8&255]+"-"+fo[e>>16&15|64]+fo[e>>24&255]+"-"+fo[t&63|128]+fo[t>>8&255]+"-"+fo[t>>16&255]+fo[t>>24&255]+fo[i&255]+fo[i>>8&255]+fo[i>>16&255]+fo[i>>24&255]).toLowerCase()}function eo(n,e,t){return Math.max(e,Math.min(t,n))}function BC(n,e){return(n%e+e)%e}function jX(n,e,t,i,s){return i+(n-e)*(s-i)/(t-e)}function QX(n,e,t){return n!==e?(t-n)/(e-n):0}function gg(n,e,t){return(1-t)*n+t*e}function XX(n,e,t,i){return gg(n,e,1-Math.exp(-t*i))}function qX(n,e=1){return e-Math.abs(BC(n,e*2)-e)}function YX(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function KX(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function $X(n,e){return n+Math.floor(Math.random()*(e-n+1))}function JX(n,e){return n+Math.random()*(e-n)}function ZX(n){return n*(.5-Math.random())}function eq(n){n!==void 0&&(jB=n);let e=jB+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function tq(n){return n*mg}function nq(n){return n*jf}function Jw(n){return(n&n-1)===0&&n!==0}function iq(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function ky(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function rq(n,e,t,i,s){let o=Math.cos,c=Math.sin,l=o(t/2),u=c(t/2),h=o((e+i)/2),p=c((e+i)/2),f=o((e-i)/2),m=c((e-i)/2),A=o((i-e)/2),y=c((i-e)/2);switch(s){case"XYX":n.set(l*p,u*f,u*m,l*h);break;case"YZY":n.set(u*m,l*p,u*f,l*h);break;case"ZXZ":n.set(u*f,u*m,l*p,l*h);break;case"XZX":n.set(l*p,u*y,u*A,l*h);break;case"YXY":n.set(u*A,l*p,u*y,l*h);break;case"ZYZ":n.set(u*y,u*A,l*p,l*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Bf(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Io(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}function tN(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function _g(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function sq(){let n=_g("canvas");return n.style.display="block",n}function Ag(n){n in QB||(QB[n]=!0,console.warn(n))}function kf(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Ew(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}function _w(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Vy.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}function Mw(n,e,t,i,s){for(let o=0,c=n.length-3;o<=c;o+=3){Th.fromArray(n,o);let l=s.x*Math.abs(Th.x)+s.y*Math.abs(Th.y)+s.z*Math.abs(Th.z),u=e.dot(Th),h=t.dot(Th),p=i.dot(Th);if(Math.max(-Math.max(u,h,p),Math.min(u,h,p))>l)return!1}return!0}function Pw(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function yq(n,e,t,i,s,o,c,l){let u;if(e.side===Wo?u=i.intersectTriangle(c,o,s,!0,l):u=i.intersectTriangle(s,o,c,e.side===au,l),u===null)return null;_y.copy(l),_y.applyMatrix4(n.matrixWorld);let h=t.ray.origin.distanceTo(_y);return h<t.near||h>t.far?null:{distance:h,point:_y.clone(),object:n}}function by(n,e,t,i,s,o,c,l,u,h){n.getVertexPosition(l,Tf),n.getVertexPosition(u,If),n.getVertexPosition(h,Rf);let p=yq(n,e,t,i,Tf,If,Rf,Ey);if(p){s&&(vy.fromBufferAttribute(s,l),yy.fromBufferAttribute(s,u),xy.fromBufferAttribute(s,h),p.uv=Of.getInterpolation(Ey,Tf,If,Rf,vy,yy,xy,new gr)),o&&(vy.fromBufferAttribute(o,l),yy.fromBufferAttribute(o,u),xy.fromBufferAttribute(o,h),p.uv1=Of.getInterpolation(Ey,Tf,If,Rf,vy,yy,xy,new gr),p.uv2=p.uv1),c&&(sO.fromBufferAttribute(c,l),oO.fromBufferAttribute(c,u),aO.fromBufferAttribute(c,h),p.normal=Of.getInterpolation(Ey,Tf,If,Rf,sO,oO,aO,new Et),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));let f={a:l,b:u,c:h,normal:new Et,materialIndex:0};Of.getNormal(Tf,If,Rf,f.normal),p.face=f}return p}function Xf(n){let e={};for(let t in n){e[t]={};for(let i in n[t]){let s=n[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():Array.isArray(s)?e[t][i]=s.slice():e[t][i]=s}}return e}function Ro(n){let e={};for(let t=0;t<n.length;t++){let i=Xf(n[t]);for(let s in i)e[s]=i[s]}return e}function xq(n){let e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function iN(n){return n.getRenderTarget()===null?n.outputColorSpace:Vr.workingColorSpace}function rN(){let n=null,e=!1,t=null,i=null;function s(o,c){t(o,c),i=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function Cq(n,e){let t=e.isWebGL2,i=new WeakMap;function s(h,p){let f=h.array,m=h.usage,A=f.byteLength,y=n.createBuffer();n.bindBuffer(p,y),n.bufferData(p,f,m),h.onUploadCallback();let E;if(f instanceof Float32Array)E=n.FLOAT;else if(f instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)E=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else E=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)E=n.SHORT;else if(f instanceof Uint32Array)E=n.UNSIGNED_INT;else if(f instanceof Int32Array)E=n.INT;else if(f instanceof Int8Array)E=n.BYTE;else if(f instanceof Uint8Array)E=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)E=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:y,type:E,bytesPerElement:f.BYTES_PER_ELEMENT,version:h.version,size:A}}function o(h,p,f){let m=p.array,A=p._updateRange,y=p.updateRanges;if(n.bindBuffer(f,h),A.count===-1&&y.length===0&&n.bufferSubData(f,0,m),y.length!==0){for(let E=0,x=y.length;E<x;E++){let v=y[E];t?n.bufferSubData(f,v.start*m.BYTES_PER_ELEMENT,m,v.start,v.count):n.bufferSubData(f,v.start*m.BYTES_PER_ELEMENT,m.subarray(v.start,v.start+v.count))}p.clearUpdateRanges()}A.count!==-1&&(t?n.bufferSubData(f,A.offset*m.BYTES_PER_ELEMENT,m,A.offset,A.count):n.bufferSubData(f,A.offset*m.BYTES_PER_ELEMENT,m.subarray(A.offset,A.offset+A.count)),A.count=-1),p.onUploadCallback()}function c(h){return h.isInterleavedBufferAttribute&&(h=h.data),i.get(h)}function l(h){h.isInterleavedBufferAttribute&&(h=h.data);let p=i.get(h);p&&(n.deleteBuffer(p.buffer),i.delete(h))}function u(h,p){if(h.isGLBufferAttribute){let m=i.get(h);(!m||m.version<h.version)&&i.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);let f=i.get(h);if(f===void 0)i.set(h,s(h,p));else if(f.version<h.version){if(f.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");o(f.buffer,h,p),f.version=h.version}}return{get:c,remove:l,update:u}}function o$(n,e,t,i,s,o,c){let l=new Si(0),u=o===!0?0:1,h,p,f=null,m=0,A=null;function y(x,v){let w=!1,M=v.isScene===!0?v.background:null;M&&M.isTexture&&(M=(v.backgroundBlurriness>0?t:e).get(M)),M===null?E(l,u):M&&M.isColor&&(E(M,1),w=!0);let T=n.xr.getEnvironmentBlendMode();T==="additive"?i.buffers.color.setClear(0,0,0,1,c):T==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,c),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),M&&(M.isCubeTexture||M.mapping===dx)?(p===void 0&&(p=new la(new Mg(1,1,1),new fl({name:"BackgroundCubeMaterial",uniforms:Xf(Cc.backgroundCube.uniforms),vertexShader:Cc.backgroundCube.vertexShader,fragmentShader:Cc.backgroundCube.fragmentShader,side:Wo,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(D,L,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(p)),p.material.uniforms.envMap.value=M,p.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,p.material.toneMapped=Vr.getTransfer(M.colorSpace)!==Jr,(f!==M||m!==M.version||A!==n.toneMapping)&&(p.material.needsUpdate=!0,f=M,m=M.version,A=n.toneMapping),p.layers.enableAll(),x.unshift(p,p.geometry,p.material,0,0,null)):M&&M.isTexture&&(h===void 0&&(h=new la(new iC(2,2),new fl({name:"BackgroundMaterial",uniforms:Xf(Cc.background.uniforms),vertexShader:Cc.background.vertexShader,fragmentShader:Cc.background.fragmentShader,side:au,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=M,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=Vr.getTransfer(M.colorSpace)!==Jr,M.matrixAutoUpdate===!0&&M.updateMatrix(),h.material.uniforms.uvTransform.value.copy(M.matrix),(f!==M||m!==M.version||A!==n.toneMapping)&&(h.material.needsUpdate=!0,f=M,m=M.version,A=n.toneMapping),h.layers.enableAll(),x.unshift(h,h.geometry,h.material,0,0,null))}function E(x,v){x.getRGB(wy,iN(n)),i.buffers.color.setClear(wy.r,wy.g,wy.b,v,c)}return{getClearColor:function(){return l},setClearColor:function(x,v=1){l.set(x),u=v,E(l,u)},getClearAlpha:function(){return u},setClearAlpha:function(x){u=x,E(l,u)},render:y}}function a$(n,e,t,i){let s=n.getParameter(n.MAX_VERTEX_ATTRIBS),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),c=i.isWebGL2||o!==null,l={},u=x(null),h=u,p=!1;function f(U,P,k,z,Q){let Z=!1;if(c){let ce=E(z,k,P);h!==ce&&(h=ce,A(h.object)),Z=v(U,z,k,Q),Z&&w(U,z,k,Q)}else{let ce=P.wireframe===!0;(h.geometry!==z.id||h.program!==k.id||h.wireframe!==ce)&&(h.geometry=z.id,h.program=k.id,h.wireframe=ce,Z=!0)}Q!==null&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(Z||p)&&(p=!1,F(U,P,k,z),Q!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))}function m(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function A(U){return i.isWebGL2?n.bindVertexArray(U):o.bindVertexArrayOES(U)}function y(U){return i.isWebGL2?n.deleteVertexArray(U):o.deleteVertexArrayOES(U)}function E(U,P,k){let z=k.wireframe===!0,Q=l[U.id];Q===void 0&&(Q={},l[U.id]=Q);let Z=Q[P.id];Z===void 0&&(Z={},Q[P.id]=Z);let ce=Z[z];return ce===void 0&&(ce=x(m()),Z[z]=ce),ce}function x(U){let P=[],k=[],z=[];for(let Q=0;Q<s;Q++)P[Q]=0,k[Q]=0,z[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:k,attributeDivisors:z,object:U,attributes:{},index:null}}function v(U,P,k,z){let Q=h.attributes,Z=P.attributes,ce=0,Me=k.getAttributes();for(let xe in Me)if(Me[xe].location>=0){let Fe=Q[xe],Ze=Z[xe];if(Ze===void 0&&(xe==="instanceMatrix"&&U.instanceMatrix&&(Ze=U.instanceMatrix),xe==="instanceColor"&&U.instanceColor&&(Ze=U.instanceColor)),Fe===void 0||Fe.attribute!==Ze||Ze&&Fe.data!==Ze.data)return!0;ce++}return h.attributesNum!==ce||h.index!==z}function w(U,P,k,z){let Q={},Z=P.attributes,ce=0,Me=k.getAttributes();for(let xe in Me)if(Me[xe].location>=0){let Fe=Z[xe];Fe===void 0&&(xe==="instanceMatrix"&&U.instanceMatrix&&(Fe=U.instanceMatrix),xe==="instanceColor"&&U.instanceColor&&(Fe=U.instanceColor));let Ze={};Ze.attribute=Fe,Fe&&Fe.data&&(Ze.data=Fe.data),Q[xe]=Ze,ce++}h.attributes=Q,h.attributesNum=ce,h.index=z}function M(){let U=h.newAttributes;for(let P=0,k=U.length;P<k;P++)U[P]=0}function T(U){D(U,0)}function D(U,P){let k=h.newAttributes,z=h.enabledAttributes,Q=h.attributeDivisors;k[U]=1,z[U]===0&&(n.enableVertexAttribArray(U),z[U]=1),Q[U]!==P&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,P),Q[U]=P)}function L(){let U=h.newAttributes,P=h.enabledAttributes;for(let k=0,z=P.length;k<z;k++)P[k]!==U[k]&&(n.disableVertexAttribArray(k),P[k]=0)}function I(U,P,k,z,Q,Z,ce){ce===!0?n.vertexAttribIPointer(U,P,k,Q,Z):n.vertexAttribPointer(U,P,k,z,Q,Z)}function F(U,P,k,z){if(i.isWebGL2===!1&&(U.isInstancedMesh||z.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();let Q=z.attributes,Z=k.getAttributes(),ce=P.defaultAttributeValues;for(let Me in Z){let xe=Z[Me];if(xe.location>=0){let be=Q[Me];if(be===void 0&&(Me==="instanceMatrix"&&U.instanceMatrix&&(be=U.instanceMatrix),Me==="instanceColor"&&U.instanceColor&&(be=U.instanceColor)),be!==void 0){let Fe=be.normalized,Ze=be.itemSize,ut=t.get(be);if(ut===void 0)continue;let it=ut.buffer,gt=ut.type,Rt=ut.bytesPerElement,It=i.isWebGL2===!0&&(gt===n.INT||gt===n.UNSIGNED_INT||be.gpuType===QO);if(be.isInterleavedBufferAttribute){let Ft=be.data,Ne=Ft.stride,pn=be.offset;if(Ft.isInstancedInterleavedBuffer){for(let St=0;St<xe.locationSize;St++)D(xe.location+St,Ft.meshPerAttribute);U.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Ft.meshPerAttribute*Ft.count)}else for(let St=0;St<xe.locationSize;St++)T(xe.location+St);n.bindBuffer(n.ARRAY_BUFFER,it);for(let St=0;St<xe.locationSize;St++)I(xe.location+St,Ze/xe.locationSize,gt,Fe,Ne*Rt,(pn+Ze/xe.locationSize*St)*Rt,It)}else{if(be.isInstancedBufferAttribute){for(let Ft=0;Ft<xe.locationSize;Ft++)D(xe.location+Ft,be.meshPerAttribute);U.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=be.meshPerAttribute*be.count)}else for(let Ft=0;Ft<xe.locationSize;Ft++)T(xe.location+Ft);n.bindBuffer(n.ARRAY_BUFFER,it);for(let Ft=0;Ft<xe.locationSize;Ft++)I(xe.location+Ft,Ze/xe.locationSize,gt,Fe,Ze*Rt,Ze/xe.locationSize*Ft*Rt,It)}}else if(ce!==void 0){let Fe=ce[Me];if(Fe!==void 0)switch(Fe.length){case 2:n.vertexAttrib2fv(xe.location,Fe);break;case 3:n.vertexAttrib3fv(xe.location,Fe);break;case 4:n.vertexAttrib4fv(xe.location,Fe);break;default:n.vertexAttrib1fv(xe.location,Fe)}}}}L()}function R(){$();for(let U in l){let P=l[U];for(let k in P){let z=P[k];for(let Q in z)y(z[Q].object),delete z[Q];delete P[k]}delete l[U]}}function N(U){if(l[U.id]===void 0)return;let P=l[U.id];for(let k in P){let z=P[k];for(let Q in z)y(z[Q].object),delete z[Q];delete P[k]}delete l[U.id]}function X(U){for(let P in l){let k=l[P];if(k[U.id]===void 0)continue;let z=k[U.id];for(let Q in z)y(z[Q].object),delete z[Q];delete k[U.id]}}function $(){te(),p=!0,h!==u&&(h=u,A(h.object))}function te(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:f,reset:$,resetDefaultState:te,dispose:R,releaseStatesOfGeometry:N,releaseStatesOfProgram:X,initAttributes:M,enableAttribute:T,disableUnusedAttributes:L}}function c$(n,e,t,i){let s=i.isWebGL2,o;function c(p){o=p}function l(p,f){n.drawArrays(o,p,f),t.update(f,o,1)}function u(p,f,m){if(m===0)return;let A,y;if(s)A=n,y="drawArraysInstanced";else if(A=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",A===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[y](o,p,f,m),t.update(f,o,m)}function h(p,f,m){if(m===0)return;let A=e.get("WEBGL_multi_draw");if(A===null)for(let y=0;y<m;y++)this.render(p[y],f[y]);else{A.multiDrawArraysWEBGL(o,p,0,f,0,m);let y=0;for(let E=0;E<m;E++)y+=f[E];t.update(y,o,1)}}this.setMode=c,this.render=l,this.renderInstances=u,this.renderMultiDraw=h}function l$(n,e,t){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext",l=t.precision!==void 0?t.precision:"highp",u=o(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let h=c||e.has("WEBGL_draw_buffers"),p=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),E=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),v=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),M=m>0,T=c||e.has("OES_texture_float"),D=M&&T,L=c?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:c,drawBuffers:h,getMaxAnisotropy:s,getMaxPrecision:o,precision:l,logarithmicDepthBuffer:p,maxTextures:f,maxVertexTextures:m,maxTextureSize:A,maxCubemapSize:y,maxAttributes:E,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:M,floatFragmentTextures:T,floatVertexTextures:D,maxSamples:L}}function u$(n){let e=this,t=null,i=0,s=!1,o=!1,c=new sl,l=new $i,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){let A=f.length!==0||m||i!==0||s;return s=m,i=f.length,A},this.beginShadows=function(){o=!0,p(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,m){t=p(f,m,0)},this.setState=function(f,m,A){let y=f.clippingPlanes,E=f.clipIntersection,x=f.clipShadows,v=n.get(f);if(!s||y===null||y.length===0||o&&!x)o?p(null):h();else{let w=o?0:i,M=w*4,T=v.clippingState||null;u.value=T,T=p(y,m,M,A);for(let D=0;D!==M;++D)T[D]=t[D];v.clippingState=T,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=w}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function p(f,m,A,y){let E=f!==null?f.length:0,x=null;if(E!==0){if(x=u.value,y!==!0||x===null){let v=A+E*4,w=m.matrixWorldInverse;l.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let M=0,T=A;M!==E;++M,T+=4)c.copy(f[M]).applyMatrix4(w,l),c.normal.toArray(x,T),x[T+3]=c.constant}u.value=x,u.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,x}}function h$(n){let e=new WeakMap;function t(c,l){return l===yg?c.mapping=Hf:l===Yw&&(c.mapping=zf),c}function i(c){if(c&&c.isTexture){let l=c.mapping;if(l===yg||l===Yw)if(e.has(c)){let u=e.get(c).texture;return t(u,c.mapping)}else{let u=c.image;if(u&&u.height>0){let h=new nC(u.height/2);return h.fromEquirectangularTexture(n,c),e.set(c,h),c.addEventListener("dispose",s),t(h.texture,c.mapping)}else return null}}return c}function s(c){let l=c.target;l.removeEventListener("dispose",s);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}function d$(n){let e=[],t=[],i=[],s=n,o=n-Nf+1+cO.length;for(let c=0;c<o;c++){let l=Math.pow(2,s);t.push(l);let u=1/l;c>n-Nf?u=cO[c-n+Nf-1]:c===0&&(u=0),i.push(u);let h=1/(l-2),p=-h,f=1+h,m=[p,p,f,p,f,f,p,p,f,f,p,f],A=6,y=6,E=3,x=2,v=1,w=new Float32Array(E*y*A),M=new Float32Array(x*y*A),T=new Float32Array(v*y*A);for(let L=0;L<A;L++){let I=L%3*2/3-1,F=L>2?0:-1,R=[I,F,0,I+2/3,F,0,I+2/3,F+1,0,I,F,0,I+2/3,F+1,0,I,F+1,0];w.set(R,E*y*L),M.set(m,x*y*L);let N=[L,L,L,L,L,L];T.set(N,v*y*L)}let D=new Ra;D.setAttribute("position",new Ia(w,E)),D.setAttribute("uv",new Ia(M,x)),D.setAttribute("faceIndex",new Ia(T,v)),e.push(D),s>Nf&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function hO(n,e,t){let i=new hl(n,e,t);return i.texture.mapping=dx,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Cy(n,e,t,i,s){n.viewport.set(e,t,i,s),n.scissor.set(e,t,i,s)}function f$(n,e,t){let i=new Float32Array(Ph),s=new Et(0,1,0);return new fl({name:"SphericalGaussianBlur",defines:{n:Ph,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:OC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ru,depthTest:!1,depthWrite:!1})}function dO(){return new fl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:OC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ru,depthTest:!1,depthWrite:!1})}function fO(){return new fl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:OC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ru,depthTest:!1,depthWrite:!1})}function OC(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function p$(n){let e=new WeakMap,t=null;function i(l){if(l&&l.isTexture){let u=l.mapping,h=u===yg||u===Yw,p=u===Hf||u===zf;if(h||p)if(l.isRenderTargetTexture&&l.needsPMREMUpdate===!0){l.needsPMREMUpdate=!1;let f=e.get(l);return t===null&&(t=new qy(n)),f=h?t.fromEquirectangular(l,f):t.fromCubemap(l,f),e.set(l,f),f.texture}else{if(e.has(l))return e.get(l).texture;{let f=l.image;if(h&&f&&f.height>0||p&&f&&s(f)){t===null&&(t=new qy(n));let m=h?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,m),l.addEventListener("dispose",o),m.texture}else return null}}}return l}function s(l){let u=0,h=6;for(let p=0;p<h;p++)l[p]!==void 0&&u++;return u===h}function o(l){let u=l.target;u.removeEventListener("dispose",o);let h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function c(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:c}}function m$(n){let e={};function t(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(i)}return e[i]=s,s}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){let s=t(i);return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function g$(n,e,t,i){let s={},o=new WeakMap;function c(f){let m=f.target;m.index!==null&&e.remove(m.index);for(let y in m.attributes)e.remove(m.attributes[y]);for(let y in m.morphAttributes){let E=m.morphAttributes[y];for(let x=0,v=E.length;x<v;x++)e.remove(E[x])}m.removeEventListener("dispose",c),delete s[m.id];let A=o.get(m);A&&(e.remove(A),o.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function l(f,m){return s[m.id]===!0||(m.addEventListener("dispose",c),s[m.id]=!0,t.memory.geometries++),m}function u(f){let m=f.attributes;for(let y in m)e.update(m[y],n.ARRAY_BUFFER);let A=f.morphAttributes;for(let y in A){let E=A[y];for(let x=0,v=E.length;x<v;x++)e.update(E[x],n.ARRAY_BUFFER)}}function h(f){let m=[],A=f.index,y=f.attributes.position,E=0;if(A!==null){let w=A.array;E=A.version;for(let M=0,T=w.length;M<T;M+=3){let D=w[M+0],L=w[M+1],I=w[M+2];m.push(D,L,L,I,I,D)}}else if(y!==void 0){let w=y.array;E=y.version;for(let M=0,T=w.length/3-1;M<T;M+=3){let D=M+0,L=M+1,I=M+2;m.push(D,L,L,I,I,D)}}else return;let x=new(tN(m)?jy:Qf)(m,1);x.version=E;let v=o.get(f);v&&e.remove(v),o.set(f,x)}function p(f){let m=o.get(f);if(m){let A=f.index;A!==null&&m.version<A.version&&h(f)}else h(f);return o.get(f)}return{get:l,update:u,getWireframeAttribute:p}}function A$(n,e,t,i){let s=i.isWebGL2,o;function c(A){o=A}let l,u;function h(A){l=A.type,u=A.bytesPerElement}function p(A,y){n.drawElements(o,y,l,A*u),t.update(y,o,1)}function f(A,y,E){if(E===0)return;let x,v;if(s)x=n,v="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](o,y,l,A*u,E),t.update(y,o,E)}function m(A,y,E){if(E===0)return;let x=e.get("WEBGL_multi_draw");if(x===null)for(let v=0;v<E;v++)this.render(A[v]/u,y[v]);else{x.multiDrawElementsWEBGL(o,y,0,l,A,0,E);let v=0;for(let w=0;w<E;w++)v+=y[w];t.update(v,o,1)}}this.setMode=c,this.setIndex=h,this.render=p,this.renderInstances=f,this.renderMultiDraw=m}function v$(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,c,l){switch(t.calls++,c){case n.TRIANGLES:t.triangles+=l*(o/3);break;case n.LINES:t.lines+=l*(o/2);break;case n.LINE_STRIP:t.lines+=l*(o-1);break;case n.LINE_LOOP:t.lines+=l*o;break;case n.POINTS:t.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:i}}function y$(n,e){return n[0]-e[0]}function x$(n,e){return Math.abs(e[1])-Math.abs(n[1])}function E$(n,e,t){let i={},s=new Float32Array(8),o=new WeakMap,c=new br,l=[];for(let h=0;h<8;h++)l[h]=[h,0];function u(h,p,f){let m=h.morphTargetInfluences;if(e.isWebGL2===!0){let y=p.morphAttributes.position||p.morphAttributes.normal||p.morphAttributes.color,E=y!==void 0?y.length:0,x=o.get(p);if(x===void 0||x.count!==E){let P=function(){te.dispose(),o.delete(p),p.removeEventListener("dispose",P)};var A=P;x!==void 0&&x.texture.dispose();let M=p.morphAttributes.position!==void 0,T=p.morphAttributes.normal!==void 0,D=p.morphAttributes.color!==void 0,L=p.morphAttributes.position||[],I=p.morphAttributes.normal||[],F=p.morphAttributes.color||[],R=0;M===!0&&(R=1),T===!0&&(R=2),D===!0&&(R=3);let N=p.attributes.position.count*R,X=1;N>e.maxTextureSize&&(X=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);let $=new Float32Array(N*X*4*E),te=new zy($,N,X,E);te.type=al,te.needsUpdate=!0;let U=R*4;for(let k=0;k<E;k++){let z=L[k],Q=I[k],Z=F[k],ce=N*X*4*k;for(let Me=0;Me<z.count;Me++){let xe=Me*U;M===!0&&(c.fromBufferAttribute(z,Me),$[ce+xe+0]=c.x,$[ce+xe+1]=c.y,$[ce+xe+2]=c.z,$[ce+xe+3]=0),T===!0&&(c.fromBufferAttribute(Q,Me),$[ce+xe+4]=c.x,$[ce+xe+5]=c.y,$[ce+xe+6]=c.z,$[ce+xe+7]=0),D===!0&&(c.fromBufferAttribute(Z,Me),$[ce+xe+8]=c.x,$[ce+xe+9]=c.y,$[ce+xe+10]=c.z,$[ce+xe+11]=Z.itemSize===4?c.w:1)}}x={count:E,texture:te,size:new gr(N,X)},o.set(p,x),p.addEventListener("dispose",P)}let v=0;for(let M=0;M<m.length;M++)v+=m[M];let w=p.morphTargetsRelative?1:1-v;f.getUniforms().setValue(n,"morphTargetBaseInfluence",w),f.getUniforms().setValue(n,"morphTargetInfluences",m),f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{let y=m===void 0?0:m.length,E=i[p.id];if(E===void 0||E.length!==y){E=[];for(let T=0;T<y;T++)E[T]=[T,0];i[p.id]=E}for(let T=0;T<y;T++){let D=E[T];D[0]=T,D[1]=m[T]}E.sort(x$);for(let T=0;T<8;T++)T<y&&E[T][1]?(l[T][0]=E[T][0],l[T][1]=E[T][1]):(l[T][0]=Number.MAX_SAFE_INTEGER,l[T][1]=0);l.sort(y$);let x=p.morphAttributes.position,v=p.morphAttributes.normal,w=0;for(let T=0;T<8;T++){let D=l[T],L=D[0],I=D[1];L!==Number.MAX_SAFE_INTEGER&&I?(x&&p.getAttribute("morphTarget"+T)!==x[L]&&p.setAttribute("morphTarget"+T,x[L]),v&&p.getAttribute("morphNormal"+T)!==v[L]&&p.setAttribute("morphNormal"+T,v[L]),s[T]=I,w+=I):(x&&p.hasAttribute("morphTarget"+T)===!0&&p.deleteAttribute("morphTarget"+T),v&&p.hasAttribute("morphNormal"+T)===!0&&p.deleteAttribute("morphNormal"+T),s[T]=0)}let M=p.morphTargetsRelative?1:1-w;f.getUniforms().setValue(n,"morphTargetBaseInfluence",M),f.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:u}}function _$(n,e,t,i){let s=new WeakMap;function o(u){let h=i.render.frame,p=u.geometry,f=e.get(u,p);if(s.get(f)!==h&&(e.update(f),s.set(f,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),s.get(u)!==h&&(t.update(u.instanceMatrix,n.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,n.ARRAY_BUFFER),s.set(u,h))),u.isSkinnedMesh){let m=u.skeleton;s.get(m)!==h&&(m.update(),s.set(m,h))}return f}function c(){s=new WeakMap}function l(u){let h=u.target;h.removeEventListener("dispose",l),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:o,dispose:c}}function Zf(n,e,t){let i=n[0];if(i<=0||i>0)return n;let s=e*t,o=pO[s];if(o===void 0&&(o=new Float32Array(s),pO[s]=o),e!==0){i.toArray(o,0);for(let c=1,l=0;c!==e;++c)l+=t,n[c].toArray(o,l)}return o}function Ds(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ls(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function px(n,e){let t=mO[e];t===void 0&&(t=new Int32Array(e),mO[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function b$(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function M$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ds(t,e))return;n.uniform2fv(this.addr,e),Ls(t,e)}}function w$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ds(t,e))return;n.uniform3fv(this.addr,e),Ls(t,e)}}function C$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ds(t,e))return;n.uniform4fv(this.addr,e),Ls(t,e)}}function S$(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ds(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ls(t,e)}else{if(Ds(t,i))return;vO.set(i),n.uniformMatrix2fv(this.addr,!1,vO),Ls(t,i)}}function T$(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ds(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ls(t,e)}else{if(Ds(t,i))return;AO.set(i),n.uniformMatrix3fv(this.addr,!1,AO),Ls(t,i)}}function I$(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ds(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ls(t,e)}else{if(Ds(t,i))return;gO.set(i),n.uniformMatrix4fv(this.addr,!1,gO),Ls(t,i)}}function R$(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function D$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ds(t,e))return;n.uniform2iv(this.addr,e),Ls(t,e)}}function L$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ds(t,e))return;n.uniform3iv(this.addr,e),Ls(t,e)}}function P$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ds(t,e))return;n.uniform4iv(this.addr,e),Ls(t,e)}}function B$(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function O$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ds(t,e))return;n.uniform2uiv(this.addr,e),Ls(t,e)}}function N$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ds(t,e))return;n.uniform3uiv(this.addr,e),Ls(t,e)}}function F$(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ds(t,e))return;n.uniform4uiv(this.addr,e),Ls(t,e)}}function U$(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s);let o=this.type===n.SAMPLER_2D_SHADOW?oN:sN;t.setTexture2D(e||o,s)}function k$(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||cN,s)}function V$(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||lN,s)}function H$(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||aN,s)}function z$(n){switch(n){case 5126:return b$;case 35664:return M$;case 35665:return w$;case 35666:return C$;case 35674:return S$;case 35675:return T$;case 35676:return I$;case 5124:case 35670:return R$;case 35667:case 35671:return D$;case 35668:case 35672:return L$;case 35669:case 35673:return P$;case 5125:return B$;case 36294:return O$;case 36295:return N$;case 36296:return F$;case 35678:case 36198:case 36298:case 36306:case 35682:return U$;case 35679:case 36299:case 36307:return k$;case 35680:case 36300:case 36308:case 36293:return V$;case 36289:case 36303:case 36311:case 36292:return H$}}function G$(n,e){n.uniform1fv(this.addr,e)}function W$(n,e){let t=Zf(e,this.size,2);n.uniform2fv(this.addr,t)}function j$(n,e){let t=Zf(e,this.size,3);n.uniform3fv(this.addr,t)}function Q$(n,e){let t=Zf(e,this.size,4);n.uniform4fv(this.addr,t)}function X$(n,e){let t=Zf(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function q$(n,e){let t=Zf(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Y$(n,e){let t=Zf(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function K$(n,e){n.uniform1iv(this.addr,e)}function $$(n,e){n.uniform2iv(this.addr,e)}function J$(n,e){n.uniform3iv(this.addr,e)}function Z$(n,e){n.uniform4iv(this.addr,e)}function eJ(n,e){n.uniform1uiv(this.addr,e)}function tJ(n,e){n.uniform2uiv(this.addr,e)}function nJ(n,e){n.uniform3uiv(this.addr,e)}function iJ(n,e){n.uniform4uiv(this.addr,e)}function rJ(n,e,t){let i=this.cache,s=e.length,o=px(t,s);Ds(i,o)||(n.uniform1iv(this.addr,o),Ls(i,o));for(let c=0;c!==s;++c)t.setTexture2D(e[c]||sN,o[c])}function sJ(n,e,t){let i=this.cache,s=e.length,o=px(t,s);Ds(i,o)||(n.uniform1iv(this.addr,o),Ls(i,o));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||cN,o[c])}function oJ(n,e,t){let i=this.cache,s=e.length,o=px(t,s);Ds(i,o)||(n.uniform1iv(this.addr,o),Ls(i,o));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||lN,o[c])}function aJ(n,e,t){let i=this.cache,s=e.length,o=px(t,s);Ds(i,o)||(n.uniform1iv(this.addr,o),Ls(i,o));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||aN,o[c])}function cJ(n){switch(n){case 5126:return G$;case 35664:return W$;case 35665:return j$;case 35666:return Q$;case 35674:return X$;case 35675:return q$;case 35676:return Y$;case 5124:case 35670:return K$;case 35667:case 35671:return $$;case 35668:case 35672:return J$;case 35669:case 35673:return Z$;case 5125:return eJ;case 36294:return tJ;case 36295:return nJ;case 36296:return iJ;case 35678:case 36198:case 36298:case 36306:case 35682:return rJ;case 35679:case 36299:case 36307:return sJ;case 35680:case 36300:case 36308:case 36293:return oJ;case 36289:case 36303:case 36311:case 36292:return aJ}}function yO(n,e){n.seq.push(e),n.map[e.id]=e}function lJ(n,e,t){let i=n.name,s=i.length;for(Hw.lastIndex=0;;){let o=Hw.exec(i),c=Hw.lastIndex,l=o[1],u=o[2]==="]",h=o[3];if(u&&(l=l|0),h===void 0||h==="["&&c+2===s){yO(t,h===void 0?new rC(l,n,e):new sC(l,n,e));break}else{let f=t.map[l];f===void 0&&(f=new oC(l),yO(t,f)),t=f}}}function xO(n,e,t){let i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function dJ(n,e){let t=n.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let c=s;c<o;c++){let l=c+1;i.push(`${l===e?">":" "} ${l}: ${t[c]}`)}return i.join(`
`)}function fJ(n){let e=Vr.getPrimaries(Vr.workingColorSpace),t=Vr.getPrimaries(n),i;switch(e===t?i="":e===Fy&&t===Ny?i="LinearDisplayP3ToLinearSRGB":e===Ny&&t===Fy&&(i="LinearSRGBToLinearDisplayP3"),n){case ul:case fx:return[i,"LinearTransferOETF"];case cs:case PC:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function EO(n,e,t){let i=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(i&&s==="")return"";let o=/ERROR: 0:(\d+)/.exec(s);if(o){let c=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+dJ(n.getShaderSource(e),c)}else return s}function pJ(n,e){let t=fJ(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function mJ(n,e){let t;switch(e){case yX:t="Linear";break;case xX:t="Reinhard";break;case EX:t="OptimizedCineon";break;case _X:t="ACESFilmic";break;case bX:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function gJ(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(pg).join(`
`)}function AJ(n){let e=[];for(let t in n){let i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function vJ(n,e){let t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let o=n.getActiveAttrib(e,s),c=o.name,l=1;o.type===n.FLOAT_MAT2&&(l=2),o.type===n.FLOAT_MAT3&&(l=3),o.type===n.FLOAT_MAT4&&(l=4),t[c]={type:o.type,location:n.getAttribLocation(e,c),locationSize:l}}return t}function pg(n){return n!==""}function _O(n,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function bO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function aC(n){return n.replace(yJ,EJ)}function EJ(n,e){let t=Ki[e];if(t===void 0){let i=xJ.get(e);if(i!==void 0)t=Ki[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return aC(t)}function MO(n){return n.replace(_J,bJ)}function bJ(n,e,t,i){let s="";for(let o=parseInt(e);o<parseInt(t);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function wO(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function MJ(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===jO?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===XQ?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===rl&&(e="SHADOWMAP_TYPE_VSM"),e}function wJ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Hf:case zf:e="ENVMAP_TYPE_CUBE";break;case dx:e="ENVMAP_TYPE_CUBE_UV";break}return e}function CJ(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case zf:e="ENVMAP_MODE_REFRACTION";break}return e}function SJ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case hx:e="ENVMAP_BLENDING_MULTIPLY";break;case AX:e="ENVMAP_BLENDING_MIX";break;case vX:e="ENVMAP_BLENDING_ADD";break}return e}function TJ(n){let e=n.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function IJ(n,e,t,i){let s=n.getContext(),o=t.defines,c=t.vertexShader,l=t.fragmentShader,u=MJ(t),h=wJ(t),p=CJ(t),f=SJ(t),m=TJ(t),A=t.isWebGL2?"":gJ(t),y=AJ(o),E=s.createProgram(),x,v,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(pg).join(`
`),x.length>0&&(x+=`
`),v=[A,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(pg).join(`
`),v.length>0&&(v+=`
`)):(x=[wO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(pg).join(`
`),v=[A,wO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+p:"",t.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==su?"#define TONE_MAPPING":"",t.toneMapping!==su?Ki.tonemapping_pars_fragment:"",t.toneMapping!==su?mJ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ki.colorspace_pars_fragment,pJ("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(pg).join(`
`)),c=aC(c),c=_O(c,t),c=bO(c,t),l=aC(l),l=_O(l,t),l=bO(l,t),c=MO(c),l=MO(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,v=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===WB?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===WB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let M=w+x+c,T=w+v+l,D=xO(s,s.VERTEX_SHADER,M),L=xO(s,s.FRAGMENT_SHADER,T);s.attachShader(E,D),s.attachShader(E,L),t.index0AttributeName!==void 0?s.bindAttribLocation(E,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(E,0,"position"),s.linkProgram(E);function I(X){if(n.debug.checkShaderErrors){let $=s.getProgramInfoLog(E).trim(),te=s.getShaderInfoLog(D).trim(),U=s.getShaderInfoLog(L).trim(),P=!0,k=!0;if(s.getProgramParameter(E,s.LINK_STATUS)===!1)if(P=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,E,D,L);else{let z=EO(s,D,"vertex"),Q=EO(s,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(E,s.VALIDATE_STATUS)+`

Program Info Log: `+$+`
`+z+`
`+Q)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(te===""||U==="")&&(k=!1);k&&(X.diagnostics={runnable:P,programLog:$,vertexShader:{log:te,prefix:x},fragmentShader:{log:U,prefix:v}})}s.deleteShader(D),s.deleteShader(L),F=new Vf(s,E),R=vJ(s,E)}let F;this.getUniforms=function(){return F===void 0&&I(this),F};let R;this.getAttributes=function(){return R===void 0&&I(this),R};let N=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=s.getProgramParameter(E,uJ)),N},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(E),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=hJ++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=D,this.fragmentShader=L,this}function DJ(n,e,t,i,s,o,c){let l=new Gy,u=new cC,h=[],p=s.isWebGL2,f=s.logarithmicDepthBuffer,m=s.vertexTextures,A=s.precision,y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(R){return R===0?"uv":`uv${R}`}function x(R,N,X,$,te){let U=$.fog,P=te.geometry,k=R.isMeshStandardMaterial?$.environment:null,z=(R.isMeshStandardMaterial?t:e).get(R.envMap||k),Q=z&&z.mapping===dx?z.image.height:null,Z=y[R.type];R.precision!==null&&(A=s.getMaxPrecision(R.precision),A!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",A,"instead."));let ce=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,Me=ce!==void 0?ce.length:0,xe=0;P.morphAttributes.position!==void 0&&(xe=1),P.morphAttributes.normal!==void 0&&(xe=2),P.morphAttributes.color!==void 0&&(xe=3);let be,Fe,Ze,ut;if(Z){let en=Cc[Z];be=en.vertexShader,Fe=en.fragmentShader}else be=R.vertexShader,Fe=R.fragmentShader,u.update(R),Ze=u.getVertexShaderID(R),ut=u.getFragmentShaderID(R);let it=n.getRenderTarget(),gt=te.isInstancedMesh===!0,Rt=te.isBatchedMesh===!0,It=!!R.map,Ft=!!R.matcap,Ne=!!z,pn=!!R.aoMap,St=!!R.lightMap,Vt=!!R.bumpMap,Ot=!!R.normalMap,xn=!!R.displacementMap,Jt=!!R.emissiveMap,Oe=!!R.metalnessMap,Ie=!!R.roughnessMap,yt=R.anisotropy>0,kt=R.clearcoat>0,De=R.iridescence>0,he=R.sheen>0,ae=R.transmission>0,de=yt&&!!R.anisotropyMap,we=kt&&!!R.clearcoatMap,Ae=kt&&!!R.clearcoatNormalMap,Le=kt&&!!R.clearcoatRoughnessMap,Ee=De&&!!R.iridescenceMap,ze=De&&!!R.iridescenceThicknessMap,Ge=he&&!!R.sheenColorMap,ee=he&&!!R.sheenRoughnessMap,V=!!R.specularMap,G=!!R.specularColorMap,pe=!!R.specularIntensityMap,Ue=ae&&!!R.transmissionMap,Qe=ae&&!!R.thicknessMap,$e=!!R.gradientMap,nt=!!R.alphaMap,ge=R.alphaTest>0,ot=!!R.alphaHash,et=!!R.extensions,tt=!!P.attributes.uv1,_t=!!P.attributes.uv2,tn=!!P.attributes.uv3,En=su;return R.toneMapped&&(it===null||it.isXRRenderTarget===!0)&&(En=n.toneMapping),{isWebGL2:p,shaderID:Z,shaderType:R.type,shaderName:R.name,vertexShader:be,fragmentShader:Fe,defines:R.defines,customVertexShaderID:Ze,customFragmentShaderID:ut,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:A,batching:Rt,instancing:gt,instancingColor:gt&&te.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:it===null?n.outputColorSpace:it.isXRRenderTarget===!0?it.texture.colorSpace:ul,map:It,matcap:Ft,envMap:Ne,envMapMode:Ne&&z.mapping,envMapCubeUVHeight:Q,aoMap:pn,lightMap:St,bumpMap:Vt,normalMap:Ot,displacementMap:m&&xn,emissiveMap:Jt,normalMapObjectSpace:Ot&&R.normalMapType===FX,normalMapTangentSpace:Ot&&R.normalMapType===LC,metalnessMap:Oe,roughnessMap:Ie,anisotropy:yt,anisotropyMap:de,clearcoat:kt,clearcoatMap:we,clearcoatNormalMap:Ae,clearcoatRoughnessMap:Le,iridescence:De,iridescenceMap:Ee,iridescenceThicknessMap:ze,sheen:he,sheenColorMap:Ge,sheenRoughnessMap:ee,specularMap:V,specularColorMap:G,specularIntensityMap:pe,transmission:ae,transmissionMap:Ue,thicknessMap:Qe,gradientMap:$e,opaque:R.transparent===!1&&R.blending===Uf,alphaMap:nt,alphaTest:ge,alphaHash:ot,combine:R.combine,mapUv:It&&E(R.map.channel),aoMapUv:pn&&E(R.aoMap.channel),lightMapUv:St&&E(R.lightMap.channel),bumpMapUv:Vt&&E(R.bumpMap.channel),normalMapUv:Ot&&E(R.normalMap.channel),displacementMapUv:xn&&E(R.displacementMap.channel),emissiveMapUv:Jt&&E(R.emissiveMap.channel),metalnessMapUv:Oe&&E(R.metalnessMap.channel),roughnessMapUv:Ie&&E(R.roughnessMap.channel),anisotropyMapUv:de&&E(R.anisotropyMap.channel),clearcoatMapUv:we&&E(R.clearcoatMap.channel),clearcoatNormalMapUv:Ae&&E(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Le&&E(R.clearcoatRoughnessMap.channel),iridescenceMapUv:Ee&&E(R.iridescenceMap.channel),iridescenceThicknessMapUv:ze&&E(R.iridescenceThicknessMap.channel),sheenColorMapUv:Ge&&E(R.sheenColorMap.channel),sheenRoughnessMapUv:ee&&E(R.sheenRoughnessMap.channel),specularMapUv:V&&E(R.specularMap.channel),specularColorMapUv:G&&E(R.specularColorMap.channel),specularIntensityMapUv:pe&&E(R.specularIntensityMap.channel),transmissionMapUv:Ue&&E(R.transmissionMap.channel),thicknessMapUv:Qe&&E(R.thicknessMap.channel),alphaMapUv:nt&&E(R.alphaMap.channel),vertexTangents:!!P.attributes.tangent&&(Ot||yt),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!P.attributes.color&&P.attributes.color.itemSize===4,vertexUv1s:tt,vertexUv2s:_t,vertexUv3s:tn,pointsUvs:te.isPoints===!0&&!!P.attributes.uv&&(It||nt),fog:!!U,useFog:R.fog===!0,fogExp2:U&&U.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:te.isSkinnedMesh===!0,morphTargets:P.morphAttributes.position!==void 0,morphNormals:P.morphAttributes.normal!==void 0,morphColors:P.morphAttributes.color!==void 0,morphTargetsCount:Me,morphTextureStride:xe,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:R.dithering,shadowMapEnabled:n.shadowMap.enabled&&X.length>0,shadowMapType:n.shadowMap.type,toneMapping:En,useLegacyLights:n._useLegacyLights,decodeVideoTexture:It&&R.map.isVideoTexture===!0&&Vr.getTransfer(R.map.colorSpace)===Jr,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===ol,flipSided:R.side===Wo,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionDerivatives:et&&R.extensions.derivatives===!0,extensionFragDepth:et&&R.extensions.fragDepth===!0,extensionDrawBuffers:et&&R.extensions.drawBuffers===!0,extensionShaderTextureLOD:et&&R.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:p||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()}}function v(R){let N=[];if(R.shaderID?N.push(R.shaderID):(N.push(R.customVertexShaderID),N.push(R.customFragmentShaderID)),R.defines!==void 0)for(let X in R.defines)N.push(X),N.push(R.defines[X]);return R.isRawShaderMaterial===!1&&(w(N,R),M(N,R),N.push(n.outputColorSpace)),N.push(R.customProgramCacheKey),N.join()}function w(R,N){R.push(N.precision),R.push(N.outputColorSpace),R.push(N.envMapMode),R.push(N.envMapCubeUVHeight),R.push(N.mapUv),R.push(N.alphaMapUv),R.push(N.lightMapUv),R.push(N.aoMapUv),R.push(N.bumpMapUv),R.push(N.normalMapUv),R.push(N.displacementMapUv),R.push(N.emissiveMapUv),R.push(N.metalnessMapUv),R.push(N.roughnessMapUv),R.push(N.anisotropyMapUv),R.push(N.clearcoatMapUv),R.push(N.clearcoatNormalMapUv),R.push(N.clearcoatRoughnessMapUv),R.push(N.iridescenceMapUv),R.push(N.iridescenceThicknessMapUv),R.push(N.sheenColorMapUv),R.push(N.sheenRoughnessMapUv),R.push(N.specularMapUv),R.push(N.specularColorMapUv),R.push(N.specularIntensityMapUv),R.push(N.transmissionMapUv),R.push(N.thicknessMapUv),R.push(N.combine),R.push(N.fogExp2),R.push(N.sizeAttenuation),R.push(N.morphTargetsCount),R.push(N.morphAttributeCount),R.push(N.numDirLights),R.push(N.numPointLights),R.push(N.numSpotLights),R.push(N.numSpotLightMaps),R.push(N.numHemiLights),R.push(N.numRectAreaLights),R.push(N.numDirLightShadows),R.push(N.numPointLightShadows),R.push(N.numSpotLightShadows),R.push(N.numSpotLightShadowsWithMaps),R.push(N.numLightProbes),R.push(N.shadowMapType),R.push(N.toneMapping),R.push(N.numClippingPlanes),R.push(N.numClipIntersection),R.push(N.depthPacking)}function M(R,N){l.disableAll(),N.isWebGL2&&l.enable(0),N.supportsVertexTextures&&l.enable(1),N.instancing&&l.enable(2),N.instancingColor&&l.enable(3),N.matcap&&l.enable(4),N.envMap&&l.enable(5),N.normalMapObjectSpace&&l.enable(6),N.normalMapTangentSpace&&l.enable(7),N.clearcoat&&l.enable(8),N.iridescence&&l.enable(9),N.alphaTest&&l.enable(10),N.vertexColors&&l.enable(11),N.vertexAlphas&&l.enable(12),N.vertexUv1s&&l.enable(13),N.vertexUv2s&&l.enable(14),N.vertexUv3s&&l.enable(15),N.vertexTangents&&l.enable(16),N.anisotropy&&l.enable(17),N.alphaHash&&l.enable(18),N.batching&&l.enable(19),R.push(l.mask),l.disableAll(),N.fog&&l.enable(0),N.useFog&&l.enable(1),N.flatShading&&l.enable(2),N.logarithmicDepthBuffer&&l.enable(3),N.skinning&&l.enable(4),N.morphTargets&&l.enable(5),N.morphNormals&&l.enable(6),N.morphColors&&l.enable(7),N.premultipliedAlpha&&l.enable(8),N.shadowMapEnabled&&l.enable(9),N.useLegacyLights&&l.enable(10),N.doubleSided&&l.enable(11),N.flipSided&&l.enable(12),N.useDepthPacking&&l.enable(13),N.dithering&&l.enable(14),N.transmission&&l.enable(15),N.sheen&&l.enable(16),N.opaque&&l.enable(17),N.pointsUvs&&l.enable(18),N.decodeVideoTexture&&l.enable(19),R.push(l.mask)}function T(R){let N=y[R.type],X;if(N){let $=Cc[N];X=Eq.clone($.uniforms)}else X=R.uniforms;return X}function D(R,N){let X;for(let $=0,te=h.length;$<te;$++){let U=h[$];if(U.cacheKey===N){X=U,++X.usedTimes;break}}return X===void 0&&(X=new IJ(n,N,R,o),h.push(X)),X}function L(R){if(--R.usedTimes===0){let N=h.indexOf(R);h[N]=h[h.length-1],h.pop(),R.destroy()}}function I(R){u.remove(R)}function F(){u.dispose()}return{getParameters:x,getProgramCacheKey:v,getUniforms:T,acquireProgram:D,releaseProgram:L,releaseShaderCache:I,programs:h,dispose:F}}function LJ(){let n=new WeakMap;function e(o){let c=n.get(o);return c===void 0&&(c={},n.set(o,c)),c}function t(o){n.delete(o)}function i(o,c,l){n.get(o)[c]=l}function s(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:s}}function PJ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function CO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function SO(){let n=[],e=0,t=[],i=[],s=[];function o(){e=0,t.length=0,i.length=0,s.length=0}function c(f,m,A,y,E,x){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:m,material:A,groupOrder:y,renderOrder:f.renderOrder,z:E,group:x},n[e]=v):(v.id=f.id,v.object=f,v.geometry=m,v.material=A,v.groupOrder=y,v.renderOrder=f.renderOrder,v.z=E,v.group=x),e++,v}function l(f,m,A,y,E,x){let v=c(f,m,A,y,E,x);A.transmission>0?i.push(v):A.transparent===!0?s.push(v):t.push(v)}function u(f,m,A,y,E,x){let v=c(f,m,A,y,E,x);A.transmission>0?i.unshift(v):A.transparent===!0?s.unshift(v):t.unshift(v)}function h(f,m){t.length>1&&t.sort(f||PJ),i.length>1&&i.sort(m||CO),s.length>1&&s.sort(m||CO)}function p(){for(let f=e,m=n.length;f<m;f++){let A=n[f];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:i,transparent:s,init:o,push:l,unshift:u,finish:p,sort:h}}function BJ(){let n=new WeakMap;function e(i,s){let o=n.get(i),c;return o===void 0?(c=new SO,n.set(i,[c])):s>=o.length?(c=new SO,o.push(c)):c=o[s],c}function t(){n=new WeakMap}return{get:e,dispose:t}}function OJ(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Et,color:new Si};break;case"SpotLight":t={position:new Et,direction:new Et,color:new Si,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Et,color:new Si,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Et,skyColor:new Si,groundColor:new Si};break;case"RectAreaLight":t={color:new Si,position:new Et,halfWidth:new Et,halfHeight:new Et};break}return n[e.id]=t,t}}}function NJ(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gr};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gr};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gr,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}function UJ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function kJ(n,e){let t=new OJ,i=NJ(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)s.probe.push(new Et);let o=new Et,c=new yi,l=new yi;function u(p,f){let m=0,A=0,y=0;for(let $=0;$<9;$++)s.probe[$].set(0,0,0);let E=0,x=0,v=0,w=0,M=0,T=0,D=0,L=0,I=0,F=0,R=0;p.sort(UJ);let N=f===!0?Math.PI:1;for(let $=0,te=p.length;$<te;$++){let U=p[$],P=U.color,k=U.intensity,z=U.distance,Q=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)m+=P.r*k*N,A+=P.g*k*N,y+=P.b*k*N;else if(U.isLightProbe){for(let Z=0;Z<9;Z++)s.probe[Z].addScaledVector(U.sh.coefficients[Z],k);R++}else if(U.isDirectionalLight){let Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*N),U.castShadow){let ce=U.shadow,Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,s.directionalShadow[E]=Me,s.directionalShadowMap[E]=Q,s.directionalShadowMatrix[E]=U.shadow.matrix,T++}s.directional[E]=Z,E++}else if(U.isSpotLight){let Z=t.get(U);Z.position.setFromMatrixPosition(U.matrixWorld),Z.color.copy(P).multiplyScalar(k*N),Z.distance=z,Z.coneCos=Math.cos(U.angle),Z.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),Z.decay=U.decay,s.spot[v]=Z;let ce=U.shadow;if(U.map&&(s.spotLightMap[I]=U.map,I++,ce.updateMatrices(U),U.castShadow&&F++),s.spotLightMatrix[v]=ce.matrix,U.castShadow){let Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,s.spotShadow[v]=Me,s.spotShadowMap[v]=Q,L++}v++}else if(U.isRectAreaLight){let Z=t.get(U);Z.color.copy(P).multiplyScalar(k),Z.halfWidth.set(U.width*.5,0,0),Z.halfHeight.set(0,U.height*.5,0),s.rectArea[w]=Z,w++}else if(U.isPointLight){let Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*N),Z.distance=U.distance,Z.decay=U.decay,U.castShadow){let ce=U.shadow,Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,Me.shadowCameraNear=ce.camera.near,Me.shadowCameraFar=ce.camera.far,s.pointShadow[x]=Me,s.pointShadowMap[x]=Q,s.pointShadowMatrix[x]=U.shadow.matrix,D++}s.point[x]=Z,x++}else if(U.isHemisphereLight){let Z=t.get(U);Z.skyColor.copy(U.color).multiplyScalar(k*N),Z.groundColor.copy(U.groundColor).multiplyScalar(k*N),s.hemi[M]=Z,M++}}w>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Un.LTC_FLOAT_1,s.rectAreaLTC2=Un.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=Un.LTC_HALF_1,s.rectAreaLTC2=Un.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=m,s.ambient[1]=A,s.ambient[2]=y;let X=s.hash;(X.directionalLength!==E||X.pointLength!==x||X.spotLength!==v||X.rectAreaLength!==w||X.hemiLength!==M||X.numDirectionalShadows!==T||X.numPointShadows!==D||X.numSpotShadows!==L||X.numSpotMaps!==I||X.numLightProbes!==R)&&(s.directional.length=E,s.spot.length=v,s.rectArea.length=w,s.point.length=x,s.hemi.length=M,s.directionalShadow.length=T,s.directionalShadowMap.length=T,s.pointShadow.length=D,s.pointShadowMap.length=D,s.spotShadow.length=L,s.spotShadowMap.length=L,s.directionalShadowMatrix.length=T,s.pointShadowMatrix.length=D,s.spotLightMatrix.length=L+I-F,s.spotLightMap.length=I,s.numSpotLightShadowsWithMaps=F,s.numLightProbes=R,X.directionalLength=E,X.pointLength=x,X.spotLength=v,X.rectAreaLength=w,X.hemiLength=M,X.numDirectionalShadows=T,X.numPointShadows=D,X.numSpotShadows=L,X.numSpotMaps=I,X.numLightProbes=R,s.version=FJ++)}function h(p,f){let m=0,A=0,y=0,E=0,x=0,v=f.matrixWorldInverse;for(let w=0,M=p.length;w<M;w++){let T=p[w];if(T.isDirectionalLight){let D=s.directional[m];D.direction.setFromMatrixPosition(T.matrixWorld),o.setFromMatrixPosition(T.target.matrixWorld),D.direction.sub(o),D.direction.transformDirection(v),m++}else if(T.isSpotLight){let D=s.spot[y];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),D.direction.setFromMatrixPosition(T.matrixWorld),o.setFromMatrixPosition(T.target.matrixWorld),D.direction.sub(o),D.direction.transformDirection(v),y++}else if(T.isRectAreaLight){let D=s.rectArea[E];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),l.identity(),c.copy(T.matrixWorld),c.premultiply(v),l.extractRotation(c),D.halfWidth.set(T.width*.5,0,0),D.halfHeight.set(0,T.height*.5,0),D.halfWidth.applyMatrix4(l),D.halfHeight.applyMatrix4(l),E++}else if(T.isPointLight){let D=s.point[A];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),A++}else if(T.isHemisphereLight){let D=s.hemi[x];D.direction.setFromMatrixPosition(T.matrixWorld),D.direction.transformDirection(v),x++}}}return{setup:u,setupView:h,state:s}}function TO(n,e){let t=new kJ(n,e),i=[],s=[];function o(){i.length=0,s.length=0}function c(f){i.push(f)}function l(f){s.push(f)}function u(f){t.setup(i,f)}function h(f){t.setupView(i,f)}return{init:o,state:{lightsArray:i,shadowsArray:s,lights:t},setupLights:u,setupLightsView:h,pushLight:c,pushShadow:l}}function VJ(n,e){let t=new WeakMap;function i(o,c=0){let l=t.get(o),u;return l===void 0?(u=new TO(n,e),t.set(o,[u])):c>=l.length?(u=new TO(n,e),l.push(u)):u=l[c],u}function s(){t=new WeakMap}return{get:i,dispose:s}}function GJ(n,e,t){let i=new wg,s=new gr,o=new gr,c=new br,l=new uC({depthPacking:NX}),u=new hC,h={},p=t.maxTextureSize,f={[au]:Wo,[Wo]:au,[ol]:ol},m=new fl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gr},radius:{value:4}},vertexShader:HJ,fragmentShader:zJ}),A=m.clone();A.defines.HORIZONTAL_PASS=1;let y=new Ra;y.setAttribute("position",new Ia(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let E=new la(y,m),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=jO;let v=this.type;this.render=function(D,L,I){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||D.length===0)return;let F=n.getRenderTarget(),R=n.getActiveCubeFace(),N=n.getActiveMipmapLevel(),X=n.state;X.setBlending(ru),X.buffers.color.setClear(1,1,1,1),X.buffers.depth.setTest(!0),X.setScissorTest(!1);let $=v!==rl&&this.type===rl,te=v===rl&&this.type!==rl;for(let U=0,P=D.length;U<P;U++){let k=D[U],z=k.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;s.copy(z.mapSize);let Q=z.getFrameExtents();if(s.multiply(Q),o.copy(z.mapSize),(s.x>p||s.y>p)&&(s.x>p&&(o.x=Math.floor(p/Q.x),s.x=o.x*Q.x,z.mapSize.x=o.x),s.y>p&&(o.y=Math.floor(p/Q.y),s.y=o.y*Q.y,z.mapSize.y=o.y)),z.map===null||$===!0||te===!0){let ce=this.type!==rl?{minFilter:Zs,magFilter:Zs}:{};z.map!==null&&z.map.dispose(),z.map=new hl(s.x,s.y,ce),z.map.texture.name=k.name+".shadowMap",z.camera.updateProjectionMatrix()}n.setRenderTarget(z.map),n.clear();let Z=z.getViewportCount();for(let ce=0;ce<Z;ce++){let Me=z.getViewport(ce);c.set(o.x*Me.x,o.y*Me.y,o.x*Me.z,o.y*Me.w),X.viewport(c),z.updateMatrices(k,ce),i=z.getFrustum(),T(L,I,z.camera,k,this.type)}z.isPointLightShadow!==!0&&this.type===rl&&w(z,I),z.needsUpdate=!1}v=this.type,x.needsUpdate=!1,n.setRenderTarget(F,R,N)};function w(D,L){let I=e.update(E);m.defines.VSM_SAMPLES!==D.blurSamples&&(m.defines.VSM_SAMPLES=D.blurSamples,A.defines.VSM_SAMPLES=D.blurSamples,m.needsUpdate=!0,A.needsUpdate=!0),D.mapPass===null&&(D.mapPass=new hl(s.x,s.y)),m.uniforms.shadow_pass.value=D.map.texture,m.uniforms.resolution.value=D.mapSize,m.uniforms.radius.value=D.radius,n.setRenderTarget(D.mapPass),n.clear(),n.renderBufferDirect(L,null,I,m,E,null),A.uniforms.shadow_pass.value=D.mapPass.texture,A.uniforms.resolution.value=D.mapSize,A.uniforms.radius.value=D.radius,n.setRenderTarget(D.map),n.clear(),n.renderBufferDirect(L,null,I,A,E,null)}function M(D,L,I,F){let R=null,N=I.isPointLight===!0?D.customDistanceMaterial:D.customDepthMaterial;if(N!==void 0)R=N;else if(R=I.isPointLight===!0?u:l,n.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){let X=R.uuid,$=L.uuid,te=h[X];te===void 0&&(te={},h[X]=te);let U=te[$];U===void 0&&(U=R.clone(),te[$]=U),R=U}if(R.visible=L.visible,R.wireframe=L.wireframe,F===rl?R.side=L.shadowSide!==null?L.shadowSide:L.side:R.side=L.shadowSide!==null?L.shadowSide:f[L.side],R.alphaMap=L.alphaMap,R.alphaTest=L.alphaTest,R.map=L.map,R.clipShadows=L.clipShadows,R.clippingPlanes=L.clippingPlanes,R.clipIntersection=L.clipIntersection,R.displacementMap=L.displacementMap,R.displacementScale=L.displacementScale,R.displacementBias=L.displacementBias,R.wireframeLinewidth=L.wireframeLinewidth,R.linewidth=L.linewidth,I.isPointLight===!0&&R.isMeshDistanceMaterial===!0){let X=n.properties.get(R);X.light=I}return R}function T(D,L,I,F,R){if(D.visible===!1)return;if(D.layers.test(L.layers)&&(D.isMesh||D.isLine||D.isPoints)&&(D.castShadow||D.receiveShadow&&R===rl)&&(!D.frustumCulled||i.intersectsObject(D))){D.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,D.matrixWorld);let $=e.update(D),te=D.material;if(Array.isArray(te)){let U=$.groups;for(let P=0,k=U.length;P<k;P++){let z=U[P],Q=te[z.materialIndex];if(Q&&Q.visible){let Z=M(D,Q,F,R);D.onBeforeShadow(n,D,L,I,$,Z,z),n.renderBufferDirect(I,null,$,Z,D,z),D.onAfterShadow(n,D,L,I,$,Z,z)}}}else if(te.visible){let U=M(D,te,F,R);D.onBeforeShadow(n,D,L,I,$,U,null),n.renderBufferDirect(I,null,$,U,D,null),D.onAfterShadow(n,D,L,I,$,U,null)}}let X=D.children;for(let $=0,te=X.length;$<te;$++)T(X[$],L,I,F,R)}}function WJ(n,e,t){let i=t.isWebGL2;function s(){let ge=!1,ot=new br,et=null,tt=new br(0,0,0,0);return{setMask:function(_t){et!==_t&&!ge&&(n.colorMask(_t,_t,_t,_t),et=_t)},setLocked:function(_t){ge=_t},setClear:function(_t,tn,En,Cn,en){en===!0&&(_t*=Cn,tn*=Cn,En*=Cn),ot.set(_t,tn,En,Cn),tt.equals(ot)===!1&&(n.clearColor(_t,tn,En,Cn),tt.copy(ot))},reset:function(){ge=!1,et=null,tt.set(-1,0,0,0)}}}function o(){let ge=!1,ot=null,et=null,tt=null;return{setTest:function(_t){_t?Rt(n.DEPTH_TEST):It(n.DEPTH_TEST)},setMask:function(_t){ot!==_t&&!ge&&(n.depthMask(_t),ot=_t)},setFunc:function(_t){if(et!==_t){switch(_t){case uX:n.depthFunc(n.NEVER);break;case hX:n.depthFunc(n.ALWAYS);break;case dX:n.depthFunc(n.LESS);break;case Ly:n.depthFunc(n.LEQUAL);break;case fX:n.depthFunc(n.EQUAL);break;case pX:n.depthFunc(n.GEQUAL);break;case mX:n.depthFunc(n.GREATER);break;case gX:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}et=_t}},setLocked:function(_t){ge=_t},setClear:function(_t){tt!==_t&&(n.clearDepth(_t),tt=_t)},reset:function(){ge=!1,ot=null,et=null,tt=null}}}function c(){let ge=!1,ot=null,et=null,tt=null,_t=null,tn=null,En=null,Cn=null,en=null;return{setTest:function(xt){ge||(xt?Rt(n.STENCIL_TEST):It(n.STENCIL_TEST))},setMask:function(xt){ot!==xt&&!ge&&(n.stencilMask(xt),ot=xt)},setFunc:function(xt,jt,Pn){(et!==xt||tt!==jt||_t!==Pn)&&(n.stencilFunc(xt,jt,Pn),et=xt,tt=jt,_t=Pn)},setOp:function(xt,jt,Pn){(tn!==xt||En!==jt||Cn!==Pn)&&(n.stencilOp(xt,jt,Pn),tn=xt,En=jt,Cn=Pn)},setLocked:function(xt){ge=xt},setClear:function(xt){en!==xt&&(n.clearStencil(xt),en=xt)},reset:function(){ge=!1,ot=null,et=null,tt=null,_t=null,tn=null,En=null,Cn=null,en=null}}}let l=new s,u=new o,h=new c,p=new WeakMap,f=new WeakMap,m={},A={},y=new WeakMap,E=[],x=null,v=!1,w=null,M=null,T=null,D=null,L=null,I=null,F=null,R=new Si(0,0,0),N=0,X=!1,$=null,te=null,U=null,P=null,k=null,z=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Q=!1,Z=0,ce=n.getParameter(n.VERSION);ce.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(ce)[1]),Q=Z>=1):ce.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),Q=Z>=2);let Me=null,xe={},be=n.getParameter(n.SCISSOR_BOX),Fe=n.getParameter(n.VIEWPORT),Ze=new br().fromArray(be),ut=new br().fromArray(Fe);function it(ge,ot,et,tt){let _t=new Uint8Array(4),tn=n.createTexture();n.bindTexture(ge,tn),n.texParameteri(ge,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ge,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let En=0;En<et;En++)i&&(ge===n.TEXTURE_3D||ge===n.TEXTURE_2D_ARRAY)?n.texImage3D(ot,0,n.RGBA,1,1,tt,0,n.RGBA,n.UNSIGNED_BYTE,_t):n.texImage2D(ot+En,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,_t);return tn}let gt={};gt[n.TEXTURE_2D]=it(n.TEXTURE_2D,n.TEXTURE_2D,1),gt[n.TEXTURE_CUBE_MAP]=it(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(gt[n.TEXTURE_2D_ARRAY]=it(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),gt[n.TEXTURE_3D]=it(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),l.setClear(0,0,0,1),u.setClear(1),h.setClear(0),Rt(n.DEPTH_TEST),u.setFunc(Ly),Jt(!1),Oe(sB),Rt(n.CULL_FACE),Ot(ru);function Rt(ge){m[ge]!==!0&&(n.enable(ge),m[ge]=!0)}function It(ge){m[ge]!==!1&&(n.disable(ge),m[ge]=!1)}function Ft(ge,ot){return A[ge]!==ot?(n.bindFramebuffer(ge,ot),A[ge]=ot,i&&(ge===n.DRAW_FRAMEBUFFER&&(A[n.FRAMEBUFFER]=ot),ge===n.FRAMEBUFFER&&(A[n.DRAW_FRAMEBUFFER]=ot)),!0):!1}function Ne(ge,ot){let et=E,tt=!1;if(ge)if(et=y.get(ot),et===void 0&&(et=[],y.set(ot,et)),ge.isWebGLMultipleRenderTargets){let _t=ge.texture;if(et.length!==_t.length||et[0]!==n.COLOR_ATTACHMENT0){for(let tn=0,En=_t.length;tn<En;tn++)et[tn]=n.COLOR_ATTACHMENT0+tn;et.length=_t.length,tt=!0}}else et[0]!==n.COLOR_ATTACHMENT0&&(et[0]=n.COLOR_ATTACHMENT0,tt=!0);else et[0]!==n.BACK&&(et[0]=n.BACK,tt=!0);tt&&(t.isWebGL2?n.drawBuffers(et):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(et))}function pn(ge){return x!==ge?(n.useProgram(ge),x=ge,!0):!1}let St={[Lh]:n.FUNC_ADD,[YQ]:n.FUNC_SUBTRACT,[KQ]:n.FUNC_REVERSE_SUBTRACT};if(i)St[lB]=n.MIN,St[uB]=n.MAX;else{let ge=e.get("EXT_blend_minmax");ge!==null&&(St[lB]=ge.MIN_EXT,St[uB]=ge.MAX_EXT)}let Vt={[$Q]:n.ZERO,[JQ]:n.ONE,[ZQ]:n.SRC_COLOR,[Xw]:n.SRC_ALPHA,[sX]:n.SRC_ALPHA_SATURATE,[iX]:n.DST_COLOR,[tX]:n.DST_ALPHA,[eX]:n.ONE_MINUS_SRC_COLOR,[qw]:n.ONE_MINUS_SRC_ALPHA,[rX]:n.ONE_MINUS_DST_COLOR,[nX]:n.ONE_MINUS_DST_ALPHA,[oX]:n.CONSTANT_COLOR,[aX]:n.ONE_MINUS_CONSTANT_COLOR,[cX]:n.CONSTANT_ALPHA,[lX]:n.ONE_MINUS_CONSTANT_ALPHA};function Ot(ge,ot,et,tt,_t,tn,En,Cn,en,xt){if(ge===ru){v===!0&&(It(n.BLEND),v=!1);return}if(v===!1&&(Rt(n.BLEND),v=!0),ge!==qQ){if(ge!==w||xt!==X){if((M!==Lh||L!==Lh)&&(n.blendEquation(n.FUNC_ADD),M=Lh,L=Lh),xt)switch(ge){case Uf:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case oB:n.blendFunc(n.ONE,n.ONE);break;case aB:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case cB:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ge);break}else switch(ge){case Uf:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case oB:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case aB:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case cB:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ge);break}T=null,D=null,I=null,F=null,R.set(0,0,0),N=0,w=ge,X=xt}return}_t=_t||ot,tn=tn||et,En=En||tt,(ot!==M||_t!==L)&&(n.blendEquationSeparate(St[ot],St[_t]),M=ot,L=_t),(et!==T||tt!==D||tn!==I||En!==F)&&(n.blendFuncSeparate(Vt[et],Vt[tt],Vt[tn],Vt[En]),T=et,D=tt,I=tn,F=En),(Cn.equals(R)===!1||en!==N)&&(n.blendColor(Cn.r,Cn.g,Cn.b,en),R.copy(Cn),N=en),w=ge,X=!1}function xn(ge,ot){ge.side===ol?It(n.CULL_FACE):Rt(n.CULL_FACE);let et=ge.side===Wo;ot&&(et=!et),Jt(et),ge.blending===Uf&&ge.transparent===!1?Ot(ru):Ot(ge.blending,ge.blendEquation,ge.blendSrc,ge.blendDst,ge.blendEquationAlpha,ge.blendSrcAlpha,ge.blendDstAlpha,ge.blendColor,ge.blendAlpha,ge.premultipliedAlpha),u.setFunc(ge.depthFunc),u.setTest(ge.depthTest),u.setMask(ge.depthWrite),l.setMask(ge.colorWrite);let tt=ge.stencilWrite;h.setTest(tt),tt&&(h.setMask(ge.stencilWriteMask),h.setFunc(ge.stencilFunc,ge.stencilRef,ge.stencilFuncMask),h.setOp(ge.stencilFail,ge.stencilZFail,ge.stencilZPass)),yt(ge.polygonOffset,ge.polygonOffsetFactor,ge.polygonOffsetUnits),ge.alphaToCoverage===!0?Rt(n.SAMPLE_ALPHA_TO_COVERAGE):It(n.SAMPLE_ALPHA_TO_COVERAGE)}function Jt(ge){$!==ge&&(ge?n.frontFace(n.CW):n.frontFace(n.CCW),$=ge)}function Oe(ge){ge!==jQ?(Rt(n.CULL_FACE),ge!==te&&(ge===sB?n.cullFace(n.BACK):ge===QQ?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):It(n.CULL_FACE),te=ge}function Ie(ge){ge!==U&&(Q&&n.lineWidth(ge),U=ge)}function yt(ge,ot,et){ge?(Rt(n.POLYGON_OFFSET_FILL),(P!==ot||k!==et)&&(n.polygonOffset(ot,et),P=ot,k=et)):It(n.POLYGON_OFFSET_FILL)}function kt(ge){ge?Rt(n.SCISSOR_TEST):It(n.SCISSOR_TEST)}function De(ge){ge===void 0&&(ge=n.TEXTURE0+z-1),Me!==ge&&(n.activeTexture(ge),Me=ge)}function he(ge,ot,et){et===void 0&&(Me===null?et=n.TEXTURE0+z-1:et=Me);let tt=xe[et];tt===void 0&&(tt={type:void 0,texture:void 0},xe[et]=tt),(tt.type!==ge||tt.texture!==ot)&&(Me!==et&&(n.activeTexture(et),Me=et),n.bindTexture(ge,ot||gt[ge]),tt.type=ge,tt.texture=ot)}function ae(){let ge=xe[Me];ge!==void 0&&ge.type!==void 0&&(n.bindTexture(ge.type,null),ge.type=void 0,ge.texture=void 0)}function de(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function we(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ae(){try{n.texSubImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Le(){try{n.texSubImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ee(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function ze(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ge(){try{n.texStorage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function ee(){try{n.texStorage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function V(){try{n.texImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function G(){try{n.texImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function pe(ge){Ze.equals(ge)===!1&&(n.scissor(ge.x,ge.y,ge.z,ge.w),Ze.copy(ge))}function Ue(ge){ut.equals(ge)===!1&&(n.viewport(ge.x,ge.y,ge.z,ge.w),ut.copy(ge))}function Qe(ge,ot){let et=f.get(ot);et===void 0&&(et=new WeakMap,f.set(ot,et));let tt=et.get(ge);tt===void 0&&(tt=n.getUniformBlockIndex(ot,ge.name),et.set(ge,tt))}function $e(ge,ot){let tt=f.get(ot).get(ge);p.get(ot)!==tt&&(n.uniformBlockBinding(ot,tt,ge.__bindingPointIndex),p.set(ot,tt))}function nt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),m={},Me=null,xe={},A={},y=new WeakMap,E=[],x=null,v=!1,w=null,M=null,T=null,D=null,L=null,I=null,F=null,R=new Si(0,0,0),N=0,X=!1,$=null,te=null,U=null,P=null,k=null,Ze.set(0,0,n.canvas.width,n.canvas.height),ut.set(0,0,n.canvas.width,n.canvas.height),l.reset(),u.reset(),h.reset()}return{buffers:{color:l,depth:u,stencil:h},enable:Rt,disable:It,bindFramebuffer:Ft,drawBuffers:Ne,useProgram:pn,setBlending:Ot,setMaterial:xn,setFlipSided:Jt,setCullFace:Oe,setLineWidth:Ie,setPolygonOffset:yt,setScissorTest:kt,activeTexture:De,bindTexture:he,unbindTexture:ae,compressedTexImage2D:de,compressedTexImage3D:we,texImage2D:V,texImage3D:G,updateUBOMapping:Qe,uniformBlockBinding:$e,texStorage2D:Ge,texStorage3D:ee,texSubImage2D:Ae,texSubImage3D:Le,compressedTexSubImage2D:Ee,compressedTexSubImage3D:ze,scissor:pe,viewport:Ue,reset:nt}}function jJ(n,e,t,i,s,o,c){let l=s.isWebGL2,u=s.maxTextures,h=s.maxCubemapSize,p=s.maxTextureSize,f=s.maxSamples,m=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,A=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap,E,x=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(De,he){return v?new OffscreenCanvas(De,he):_g("canvas")}function M(De,he,ae,de){let we=1;if((De.width>de||De.height>de)&&(we=de/Math.max(De.width,De.height)),we<1||he===!0)if(typeof HTMLImageElement<"u"&&De instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&De instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&De instanceof ImageBitmap){let Ae=he?ky:Math.floor,Le=Ae(we*De.width),Ee=Ae(we*De.height);E===void 0&&(E=w(Le,Ee));let ze=ae?w(Le,Ee):E;return ze.width=Le,ze.height=Ee,ze.getContext("2d").drawImage(De,0,0,Le,Ee),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+De.width+"x"+De.height+") to ("+Le+"x"+Ee+")."),ze}else return"data"in De&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+De.width+"x"+De.height+")."),De;return De}function T(De){return Jw(De.width)&&Jw(De.height)}function D(De){return l?!1:De.wrapS!==Go||De.wrapT!==Go||De.minFilter!==Zs&&De.minFilter!==Ca}function L(De,he){return De.generateMipmaps&&he&&De.minFilter!==Zs&&De.minFilter!==Ca}function I(De){n.generateMipmap(De)}function F(De,he,ae,de,we=!1){if(l===!1)return he;if(De!==null){if(n[De]!==void 0)return n[De];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+De+"'")}let Ae=he;if(he===n.RED&&(ae===n.FLOAT&&(Ae=n.R32F),ae===n.HALF_FLOAT&&(Ae=n.R16F),ae===n.UNSIGNED_BYTE&&(Ae=n.R8)),he===n.RED_INTEGER&&(ae===n.UNSIGNED_BYTE&&(Ae=n.R8UI),ae===n.UNSIGNED_SHORT&&(Ae=n.R16UI),ae===n.UNSIGNED_INT&&(Ae=n.R32UI),ae===n.BYTE&&(Ae=n.R8I),ae===n.SHORT&&(Ae=n.R16I),ae===n.INT&&(Ae=n.R32I)),he===n.RG&&(ae===n.FLOAT&&(Ae=n.RG32F),ae===n.HALF_FLOAT&&(Ae=n.RG16F),ae===n.UNSIGNED_BYTE&&(Ae=n.RG8)),he===n.RGBA){let Le=we?Oy:Vr.getTransfer(de);ae===n.FLOAT&&(Ae=n.RGBA32F),ae===n.HALF_FLOAT&&(Ae=n.RGBA16F),ae===n.UNSIGNED_BYTE&&(Ae=Le===Jr?n.SRGB8_ALPHA8:n.RGBA8),ae===n.UNSIGNED_SHORT_4_4_4_4&&(Ae=n.RGBA4),ae===n.UNSIGNED_SHORT_5_5_5_1&&(Ae=n.RGB5_A1)}return(Ae===n.R16F||Ae===n.R32F||Ae===n.RG16F||Ae===n.RG32F||Ae===n.RGBA16F||Ae===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function R(De,he,ae){return L(De,ae)===!0||De.isFramebufferTexture&&De.minFilter!==Zs&&De.minFilter!==Ca?Math.log2(Math.max(he.width,he.height))+1:De.mipmaps!==void 0&&De.mipmaps.length>0?De.mipmaps.length:De.isCompressedTexture&&Array.isArray(De.image)?he.mipmaps.length:1}function N(De){return De===Zs||De===fB||De===fw?n.NEAREST:n.LINEAR}function X(De){let he=De.target;he.removeEventListener("dispose",X),te(he),he.isVideoTexture&&y.delete(he)}function $(De){let he=De.target;he.removeEventListener("dispose",$),P(he)}function te(De){let he=i.get(De);if(he.__webglInit===void 0)return;let ae=De.source,de=x.get(ae);if(de){let we=de[he.__cacheKey];we.usedTimes--,we.usedTimes===0&&U(De),Object.keys(de).length===0&&x.delete(ae)}i.remove(De)}function U(De){let he=i.get(De);n.deleteTexture(he.__webglTexture);let ae=De.source,de=x.get(ae);delete de[he.__cacheKey],c.memory.textures--}function P(De){let he=De.texture,ae=i.get(De),de=i.get(he);if(de.__webglTexture!==void 0&&(n.deleteTexture(de.__webglTexture),c.memory.textures--),De.depthTexture&&De.depthTexture.dispose(),De.isWebGLCubeRenderTarget)for(let we=0;we<6;we++){if(Array.isArray(ae.__webglFramebuffer[we]))for(let Ae=0;Ae<ae.__webglFramebuffer[we].length;Ae++)n.deleteFramebuffer(ae.__webglFramebuffer[we][Ae]);else n.deleteFramebuffer(ae.__webglFramebuffer[we]);ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer[we])}else{if(Array.isArray(ae.__webglFramebuffer))for(let we=0;we<ae.__webglFramebuffer.length;we++)n.deleteFramebuffer(ae.__webglFramebuffer[we]);else n.deleteFramebuffer(ae.__webglFramebuffer);if(ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let we=0;we<ae.__webglColorRenderbuffer.length;we++)ae.__webglColorRenderbuffer[we]&&n.deleteRenderbuffer(ae.__webglColorRenderbuffer[we]);ae.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(De.isWebGLMultipleRenderTargets)for(let we=0,Ae=he.length;we<Ae;we++){let Le=i.get(he[we]);Le.__webglTexture&&(n.deleteTexture(Le.__webglTexture),c.memory.textures--),i.remove(he[we])}i.remove(he),i.remove(De)}let k=0;function z(){k=0}function Q(){let De=k;return De>=u&&console.warn("THREE.WebGLTextures: Trying to use "+De+" texture units while this GPU supports only "+u),k+=1,De}function Z(De){let he=[];return he.push(De.wrapS),he.push(De.wrapT),he.push(De.wrapR||0),he.push(De.magFilter),he.push(De.minFilter),he.push(De.anisotropy),he.push(De.internalFormat),he.push(De.format),he.push(De.type),he.push(De.generateMipmaps),he.push(De.premultiplyAlpha),he.push(De.flipY),he.push(De.unpackAlignment),he.push(De.colorSpace),he.join()}function ce(De,he){let ae=i.get(De);if(De.isVideoTexture&&yt(De),De.isRenderTargetTexture===!1&&De.version>0&&ae.__version!==De.version){let de=De.image;if(de===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(de.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Rt(ae,De,he);return}}t.bindTexture(n.TEXTURE_2D,ae.__webglTexture,n.TEXTURE0+he)}function Me(De,he){let ae=i.get(De);if(De.version>0&&ae.__version!==De.version){Rt(ae,De,he);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ae.__webglTexture,n.TEXTURE0+he)}function xe(De,he){let ae=i.get(De);if(De.version>0&&ae.__version!==De.version){Rt(ae,De,he);return}t.bindTexture(n.TEXTURE_3D,ae.__webglTexture,n.TEXTURE0+he)}function be(De,he){let ae=i.get(De);if(De.version>0&&ae.__version!==De.version){It(ae,De,he);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture,n.TEXTURE0+he)}let Fe={[Gf]:n.REPEAT,[Go]:n.CLAMP_TO_EDGE,[Kw]:n.MIRRORED_REPEAT},Ze={[Zs]:n.NEAREST,[fB]:n.NEAREST_MIPMAP_NEAREST,[fw]:n.NEAREST_MIPMAP_LINEAR,[Ca]:n.LINEAR,[wX]:n.LINEAR_MIPMAP_NEAREST,[xg]:n.LINEAR_MIPMAP_LINEAR},ut={[UX]:n.NEVER,[WX]:n.ALWAYS,[kX]:n.LESS,[eN]:n.LEQUAL,[VX]:n.EQUAL,[GX]:n.GEQUAL,[HX]:n.GREATER,[zX]:n.NOTEQUAL};function it(De,he,ae){if(ae?(n.texParameteri(De,n.TEXTURE_WRAP_S,Fe[he.wrapS]),n.texParameteri(De,n.TEXTURE_WRAP_T,Fe[he.wrapT]),(De===n.TEXTURE_3D||De===n.TEXTURE_2D_ARRAY)&&n.texParameteri(De,n.TEXTURE_WRAP_R,Fe[he.wrapR]),n.texParameteri(De,n.TEXTURE_MAG_FILTER,Ze[he.magFilter]),n.texParameteri(De,n.TEXTURE_MIN_FILTER,Ze[he.minFilter])):(n.texParameteri(De,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(De,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(De===n.TEXTURE_3D||De===n.TEXTURE_2D_ARRAY)&&n.texParameteri(De,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(he.wrapS!==Go||he.wrapT!==Go)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(De,n.TEXTURE_MAG_FILTER,N(he.magFilter)),n.texParameteri(De,n.TEXTURE_MIN_FILTER,N(he.minFilter)),he.minFilter!==Zs&&he.minFilter!==Ca&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),he.compareFunction&&(n.texParameteri(De,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(De,n.TEXTURE_COMPARE_FUNC,ut[he.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){let de=e.get("EXT_texture_filter_anisotropic");if(he.magFilter===Zs||he.minFilter!==fw&&he.minFilter!==xg||he.type===al&&e.has("OES_texture_float_linear")===!1||l===!1&&he.type===Eg&&e.has("OES_texture_half_float_linear")===!1)return;(he.anisotropy>1||i.get(he).__currentAnisotropy)&&(n.texParameterf(De,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(he.anisotropy,s.getMaxAnisotropy())),i.get(he).__currentAnisotropy=he.anisotropy)}}function gt(De,he){let ae=!1;De.__webglInit===void 0&&(De.__webglInit=!0,he.addEventListener("dispose",X));let de=he.source,we=x.get(de);we===void 0&&(we={},x.set(de,we));let Ae=Z(he);if(Ae!==De.__cacheKey){we[Ae]===void 0&&(we[Ae]={texture:n.createTexture(),usedTimes:0},c.memory.textures++,ae=!0),we[Ae].usedTimes++;let Le=we[De.__cacheKey];Le!==void 0&&(we[De.__cacheKey].usedTimes--,Le.usedTimes===0&&U(he)),De.__cacheKey=Ae,De.__webglTexture=we[Ae].texture}return ae}function Rt(De,he,ae){let de=n.TEXTURE_2D;(he.isDataArrayTexture||he.isCompressedArrayTexture)&&(de=n.TEXTURE_2D_ARRAY),he.isData3DTexture&&(de=n.TEXTURE_3D);let we=gt(De,he),Ae=he.source;t.bindTexture(de,De.__webglTexture,n.TEXTURE0+ae);let Le=i.get(Ae);if(Ae.version!==Le.__version||we===!0){t.activeTexture(n.TEXTURE0+ae);let Ee=Vr.getPrimaries(Vr.workingColorSpace),ze=he.colorSpace===Ta?null:Vr.getPrimaries(he.colorSpace),Ge=he.colorSpace===Ta||Ee===ze?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,he.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,he.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);let ee=D(he)&&T(he.image)===!1,V=M(he.image,ee,!1,p);V=kt(he,V);let G=T(V)||l,pe=o.convert(he.format,he.colorSpace),Ue=o.convert(he.type),Qe=F(he.internalFormat,pe,Ue,he.colorSpace,he.isVideoTexture);it(de,he,G);let $e,nt=he.mipmaps,ge=l&&he.isVideoTexture!==!0&&Qe!==JO,ot=Le.__version===void 0||we===!0,et=R(he,V,G);if(he.isDepthTexture)Qe=n.DEPTH_COMPONENT,l?he.type===al?Qe=n.DEPTH_COMPONENT32F:he.type===iu?Qe=n.DEPTH_COMPONENT24:he.type===Bh?Qe=n.DEPTH24_STENCIL8:Qe=n.DEPTH_COMPONENT16:he.type===al&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),he.format===Oh&&Qe===n.DEPTH_COMPONENT&&he.type!==DC&&he.type!==iu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),he.type=iu,Ue=o.convert(he.type)),he.format===Wf&&Qe===n.DEPTH_COMPONENT&&(Qe=n.DEPTH_STENCIL,he.type!==Bh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),he.type=Bh,Ue=o.convert(he.type))),ot&&(ge?t.texStorage2D(n.TEXTURE_2D,1,Qe,V.width,V.height):t.texImage2D(n.TEXTURE_2D,0,Qe,V.width,V.height,0,pe,Ue,null));else if(he.isDataTexture)if(nt.length>0&&G){ge&&ot&&t.texStorage2D(n.TEXTURE_2D,et,Qe,nt[0].width,nt[0].height);for(let tt=0,_t=nt.length;tt<_t;tt++)$e=nt[tt],ge?t.texSubImage2D(n.TEXTURE_2D,tt,0,0,$e.width,$e.height,pe,Ue,$e.data):t.texImage2D(n.TEXTURE_2D,tt,Qe,$e.width,$e.height,0,pe,Ue,$e.data);he.generateMipmaps=!1}else ge?(ot&&t.texStorage2D(n.TEXTURE_2D,et,Qe,V.width,V.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,V.width,V.height,pe,Ue,V.data)):t.texImage2D(n.TEXTURE_2D,0,Qe,V.width,V.height,0,pe,Ue,V.data);else if(he.isCompressedTexture)if(he.isCompressedArrayTexture){ge&&ot&&t.texStorage3D(n.TEXTURE_2D_ARRAY,et,Qe,nt[0].width,nt[0].height,V.depth);for(let tt=0,_t=nt.length;tt<_t;tt++)$e=nt[tt],he.format!==Sa?pe!==null?ge?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,tt,0,0,0,$e.width,$e.height,V.depth,pe,$e.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,tt,Qe,$e.width,$e.height,V.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ge?t.texSubImage3D(n.TEXTURE_2D_ARRAY,tt,0,0,0,$e.width,$e.height,V.depth,pe,Ue,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,tt,Qe,$e.width,$e.height,V.depth,0,pe,Ue,$e.data)}else{ge&&ot&&t.texStorage2D(n.TEXTURE_2D,et,Qe,nt[0].width,nt[0].height);for(let tt=0,_t=nt.length;tt<_t;tt++)$e=nt[tt],he.format!==Sa?pe!==null?ge?t.compressedTexSubImage2D(n.TEXTURE_2D,tt,0,0,$e.width,$e.height,pe,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,tt,Qe,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ge?t.texSubImage2D(n.TEXTURE_2D,tt,0,0,$e.width,$e.height,pe,Ue,$e.data):t.texImage2D(n.TEXTURE_2D,tt,Qe,$e.width,$e.height,0,pe,Ue,$e.data)}else if(he.isDataArrayTexture)ge?(ot&&t.texStorage3D(n.TEXTURE_2D_ARRAY,et,Qe,V.width,V.height,V.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,V.width,V.height,V.depth,pe,Ue,V.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Qe,V.width,V.height,V.depth,0,pe,Ue,V.data);else if(he.isData3DTexture)ge?(ot&&t.texStorage3D(n.TEXTURE_3D,et,Qe,V.width,V.height,V.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,V.width,V.height,V.depth,pe,Ue,V.data)):t.texImage3D(n.TEXTURE_3D,0,Qe,V.width,V.height,V.depth,0,pe,Ue,V.data);else if(he.isFramebufferTexture){if(ot)if(ge)t.texStorage2D(n.TEXTURE_2D,et,Qe,V.width,V.height);else{let tt=V.width,_t=V.height;for(let tn=0;tn<et;tn++)t.texImage2D(n.TEXTURE_2D,tn,Qe,tt,_t,0,pe,Ue,null),tt>>=1,_t>>=1}}else if(nt.length>0&&G){ge&&ot&&t.texStorage2D(n.TEXTURE_2D,et,Qe,nt[0].width,nt[0].height);for(let tt=0,_t=nt.length;tt<_t;tt++)$e=nt[tt],ge?t.texSubImage2D(n.TEXTURE_2D,tt,0,0,pe,Ue,$e):t.texImage2D(n.TEXTURE_2D,tt,Qe,pe,Ue,$e);he.generateMipmaps=!1}else ge?(ot&&t.texStorage2D(n.TEXTURE_2D,et,Qe,V.width,V.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,pe,Ue,V)):t.texImage2D(n.TEXTURE_2D,0,Qe,pe,Ue,V);L(he,G)&&I(de),Le.__version=Ae.version,he.onUpdate&&he.onUpdate(he)}De.__version=he.version}function It(De,he,ae){if(he.image.length!==6)return;let de=gt(De,he),we=he.source;t.bindTexture(n.TEXTURE_CUBE_MAP,De.__webglTexture,n.TEXTURE0+ae);let Ae=i.get(we);if(we.version!==Ae.__version||de===!0){t.activeTexture(n.TEXTURE0+ae);let Le=Vr.getPrimaries(Vr.workingColorSpace),Ee=he.colorSpace===Ta?null:Vr.getPrimaries(he.colorSpace),ze=he.colorSpace===Ta||Le===Ee?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,he.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,he.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ze);let Ge=he.isCompressedTexture||he.image[0].isCompressedTexture,ee=he.image[0]&&he.image[0].isDataTexture,V=[];for(let tt=0;tt<6;tt++)!Ge&&!ee?V[tt]=M(he.image[tt],!1,!0,h):V[tt]=ee?he.image[tt].image:he.image[tt],V[tt]=kt(he,V[tt]);let G=V[0],pe=T(G)||l,Ue=o.convert(he.format,he.colorSpace),Qe=o.convert(he.type),$e=F(he.internalFormat,Ue,Qe,he.colorSpace),nt=l&&he.isVideoTexture!==!0,ge=Ae.__version===void 0||de===!0,ot=R(he,G,pe);it(n.TEXTURE_CUBE_MAP,he,pe);let et;if(Ge){nt&&ge&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ot,$e,G.width,G.height);for(let tt=0;tt<6;tt++){et=V[tt].mipmaps;for(let _t=0;_t<et.length;_t++){let tn=et[_t];he.format!==Sa?Ue!==null?nt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t,0,0,tn.width,tn.height,Ue,tn.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t,$e,tn.width,tn.height,0,tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):nt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t,0,0,tn.width,tn.height,Ue,Qe,tn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t,$e,tn.width,tn.height,0,Ue,Qe,tn.data)}}}else{et=he.mipmaps,nt&&ge&&(et.length>0&&ot++,t.texStorage2D(n.TEXTURE_CUBE_MAP,ot,$e,V[0].width,V[0].height));for(let tt=0;tt<6;tt++)if(ee){nt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0,0,0,V[tt].width,V[tt].height,Ue,Qe,V[tt].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0,$e,V[tt].width,V[tt].height,0,Ue,Qe,V[tt].data);for(let _t=0;_t<et.length;_t++){let En=et[_t].image[tt].image;nt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t+1,0,0,En.width,En.height,Ue,Qe,En.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t+1,$e,En.width,En.height,0,Ue,Qe,En.data)}}else{nt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0,0,0,Ue,Qe,V[tt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0,$e,Ue,Qe,V[tt]);for(let _t=0;_t<et.length;_t++){let tn=et[_t];nt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t+1,0,0,Ue,Qe,tn.image[tt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,_t+1,$e,Ue,Qe,tn.image[tt])}}}L(he,pe)&&I(n.TEXTURE_CUBE_MAP),Ae.__version=we.version,he.onUpdate&&he.onUpdate(he)}De.__version=he.version}function Ft(De,he,ae,de,we,Ae){let Le=o.convert(ae.format,ae.colorSpace),Ee=o.convert(ae.type),ze=F(ae.internalFormat,Le,Ee,ae.colorSpace);if(!i.get(he).__hasExternalTextures){let ee=Math.max(1,he.width>>Ae),V=Math.max(1,he.height>>Ae);we===n.TEXTURE_3D||we===n.TEXTURE_2D_ARRAY?t.texImage3D(we,Ae,ze,ee,V,he.depth,0,Le,Ee,null):t.texImage2D(we,Ae,ze,ee,V,0,Le,Ee,null)}t.bindFramebuffer(n.FRAMEBUFFER,De),Ie(he)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,de,we,i.get(ae).__webglTexture,0,Oe(he)):(we===n.TEXTURE_2D||we>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&we<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,de,we,i.get(ae).__webglTexture,Ae),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ne(De,he,ae){if(n.bindRenderbuffer(n.RENDERBUFFER,De),he.depthBuffer&&!he.stencilBuffer){let de=l===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ae||Ie(he)){let we=he.depthTexture;we&&we.isDepthTexture&&(we.type===al?de=n.DEPTH_COMPONENT32F:we.type===iu&&(de=n.DEPTH_COMPONENT24));let Ae=Oe(he);Ie(he)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ae,de,he.width,he.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ae,de,he.width,he.height)}else n.renderbufferStorage(n.RENDERBUFFER,de,he.width,he.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,De)}else if(he.depthBuffer&&he.stencilBuffer){let de=Oe(he);ae&&Ie(he)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,he.width,he.height):Ie(he)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,he.width,he.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,he.width,he.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,De)}else{let de=he.isWebGLMultipleRenderTargets===!0?he.texture:[he.texture];for(let we=0;we<de.length;we++){let Ae=de[we],Le=o.convert(Ae.format,Ae.colorSpace),Ee=o.convert(Ae.type),ze=F(Ae.internalFormat,Le,Ee,Ae.colorSpace),Ge=Oe(he);ae&&Ie(he)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ge,ze,he.width,he.height):Ie(he)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ge,ze,he.width,he.height):n.renderbufferStorage(n.RENDERBUFFER,ze,he.width,he.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function pn(De,he){if(he&&he.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,De),!(he.depthTexture&&he.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(he.depthTexture).__webglTexture||he.depthTexture.image.width!==he.width||he.depthTexture.image.height!==he.height)&&(he.depthTexture.image.width=he.width,he.depthTexture.image.height=he.height,he.depthTexture.needsUpdate=!0),ce(he.depthTexture,0);let de=i.get(he.depthTexture).__webglTexture,we=Oe(he);if(he.depthTexture.format===Oh)Ie(he)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0,we):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0);else if(he.depthTexture.format===Wf)Ie(he)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0,we):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0);else throw new Error("Unknown depthTexture format")}function St(De){let he=i.get(De),ae=De.isWebGLCubeRenderTarget===!0;if(De.depthTexture&&!he.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");pn(he.__webglFramebuffer,De)}else if(ae){he.__webglDepthbuffer=[];for(let de=0;de<6;de++)t.bindFramebuffer(n.FRAMEBUFFER,he.__webglFramebuffer[de]),he.__webglDepthbuffer[de]=n.createRenderbuffer(),Ne(he.__webglDepthbuffer[de],De,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,he.__webglFramebuffer),he.__webglDepthbuffer=n.createRenderbuffer(),Ne(he.__webglDepthbuffer,De,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Vt(De,he,ae){let de=i.get(De);he!==void 0&&Ft(de.__webglFramebuffer,De,De.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ae!==void 0&&St(De)}function Ot(De){let he=De.texture,ae=i.get(De),de=i.get(he);De.addEventListener("dispose",$),De.isWebGLMultipleRenderTargets!==!0&&(de.__webglTexture===void 0&&(de.__webglTexture=n.createTexture()),de.__version=he.version,c.memory.textures++);let we=De.isWebGLCubeRenderTarget===!0,Ae=De.isWebGLMultipleRenderTargets===!0,Le=T(De)||l;if(we){ae.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)if(l&&he.mipmaps&&he.mipmaps.length>0){ae.__webglFramebuffer[Ee]=[];for(let ze=0;ze<he.mipmaps.length;ze++)ae.__webglFramebuffer[Ee][ze]=n.createFramebuffer()}else ae.__webglFramebuffer[Ee]=n.createFramebuffer()}else{if(l&&he.mipmaps&&he.mipmaps.length>0){ae.__webglFramebuffer=[];for(let Ee=0;Ee<he.mipmaps.length;Ee++)ae.__webglFramebuffer[Ee]=n.createFramebuffer()}else ae.__webglFramebuffer=n.createFramebuffer();if(Ae)if(s.drawBuffers){let Ee=De.texture;for(let ze=0,Ge=Ee.length;ze<Ge;ze++){let ee=i.get(Ee[ze]);ee.__webglTexture===void 0&&(ee.__webglTexture=n.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&De.samples>0&&Ie(De)===!1){let Ee=Ae?he:[he];ae.__webglMultisampledFramebuffer=n.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ae.__webglMultisampledFramebuffer);for(let ze=0;ze<Ee.length;ze++){let Ge=Ee[ze];ae.__webglColorRenderbuffer[ze]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ae.__webglColorRenderbuffer[ze]);let ee=o.convert(Ge.format,Ge.colorSpace),V=o.convert(Ge.type),G=F(Ge.internalFormat,ee,V,Ge.colorSpace,De.isXRRenderTarget===!0),pe=Oe(De);n.renderbufferStorageMultisample(n.RENDERBUFFER,pe,G,De.width,De.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ze,n.RENDERBUFFER,ae.__webglColorRenderbuffer[ze])}n.bindRenderbuffer(n.RENDERBUFFER,null),De.depthBuffer&&(ae.__webglDepthRenderbuffer=n.createRenderbuffer(),Ne(ae.__webglDepthRenderbuffer,De,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(we){t.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture),it(n.TEXTURE_CUBE_MAP,he,Le);for(let Ee=0;Ee<6;Ee++)if(l&&he.mipmaps&&he.mipmaps.length>0)for(let ze=0;ze<he.mipmaps.length;ze++)Ft(ae.__webglFramebuffer[Ee][ze],De,he,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ze);else Ft(ae.__webglFramebuffer[Ee],De,he,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0);L(he,Le)&&I(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ae){let Ee=De.texture;for(let ze=0,Ge=Ee.length;ze<Ge;ze++){let ee=Ee[ze],V=i.get(ee);t.bindTexture(n.TEXTURE_2D,V.__webglTexture),it(n.TEXTURE_2D,ee,Le),Ft(ae.__webglFramebuffer,De,ee,n.COLOR_ATTACHMENT0+ze,n.TEXTURE_2D,0),L(ee,Le)&&I(n.TEXTURE_2D)}t.unbindTexture()}else{let Ee=n.TEXTURE_2D;if((De.isWebGL3DRenderTarget||De.isWebGLArrayRenderTarget)&&(l?Ee=De.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ee,de.__webglTexture),it(Ee,he,Le),l&&he.mipmaps&&he.mipmaps.length>0)for(let ze=0;ze<he.mipmaps.length;ze++)Ft(ae.__webglFramebuffer[ze],De,he,n.COLOR_ATTACHMENT0,Ee,ze);else Ft(ae.__webglFramebuffer,De,he,n.COLOR_ATTACHMENT0,Ee,0);L(he,Le)&&I(Ee),t.unbindTexture()}De.depthBuffer&&St(De)}function xn(De){let he=T(De)||l,ae=De.isWebGLMultipleRenderTargets===!0?De.texture:[De.texture];for(let de=0,we=ae.length;de<we;de++){let Ae=ae[de];if(L(Ae,he)){let Le=De.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ee=i.get(Ae).__webglTexture;t.bindTexture(Le,Ee),I(Le),t.unbindTexture()}}}function Jt(De){if(l&&De.samples>0&&Ie(De)===!1){let he=De.isWebGLMultipleRenderTargets?De.texture:[De.texture],ae=De.width,de=De.height,we=n.COLOR_BUFFER_BIT,Ae=[],Le=De.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ee=i.get(De),ze=De.isWebGLMultipleRenderTargets===!0;if(ze)for(let Ge=0;Ge<he.length;Ge++)t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglFramebuffer);for(let Ge=0;Ge<he.length;Ge++){Ae.push(n.COLOR_ATTACHMENT0+Ge),De.depthBuffer&&Ae.push(Le);let ee=Ee.__ignoreDepthValues!==void 0?Ee.__ignoreDepthValues:!1;if(ee===!1&&(De.depthBuffer&&(we|=n.DEPTH_BUFFER_BIT),De.stencilBuffer&&(we|=n.STENCIL_BUFFER_BIT)),ze&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[Ge]),ee===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Le]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Le])),ze){let V=i.get(he[Ge]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,V,0)}n.blitFramebuffer(0,0,ae,de,0,0,ae,de,we,n.NEAREST),A&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ae)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ze)for(let Ge=0;Ge<he.length;Ge++){t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[Ge]);let ee=i.get(he[Ge]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.TEXTURE_2D,ee,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer)}}function Oe(De){return Math.min(f,De.samples)}function Ie(De){let he=i.get(De);return l&&De.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&he.__useRenderToTexture!==!1}function yt(De){let he=c.render.frame;y.get(De)!==he&&(y.set(De,he),De.update())}function kt(De,he){let ae=De.colorSpace,de=De.format,we=De.type;return De.isCompressedTexture===!0||De.isVideoTexture===!0||De.format===$w||ae!==ul&&ae!==Ta&&(Vr.getTransfer(ae)===Jr?l===!1?e.has("EXT_sRGB")===!0&&de===Sa?(De.format=$w,De.minFilter=Ca,De.generateMipmaps=!1):he=Vy.sRGBToLinear(he):(de!==Sa||we!==ou)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ae)),he}this.allocateTextureUnit=Q,this.resetTextureUnits=z,this.setTexture2D=ce,this.setTexture2DArray=Me,this.setTexture3D=xe,this.setTextureCube=be,this.rebindTextures=Vt,this.setupRenderTarget=Ot,this.updateRenderTargetMipmap=xn,this.updateMultisampleRenderTarget=Jt,this.setupDepthRenderbuffer=St,this.setupFrameBufferTexture=Ft,this.useMultisampledRTT=Ie}function QJ(n,e,t){let i=t.isWebGL2;function s(o,c=Ta){let l,u=Vr.getTransfer(c);if(o===ou)return n.UNSIGNED_BYTE;if(o===XO)return n.UNSIGNED_SHORT_4_4_4_4;if(o===qO)return n.UNSIGNED_SHORT_5_5_5_1;if(o===CX)return n.BYTE;if(o===SX)return n.SHORT;if(o===DC)return n.UNSIGNED_SHORT;if(o===QO)return n.INT;if(o===iu)return n.UNSIGNED_INT;if(o===al)return n.FLOAT;if(o===Eg)return i?n.HALF_FLOAT:(l=e.get("OES_texture_half_float"),l!==null?l.HALF_FLOAT_OES:null);if(o===TX)return n.ALPHA;if(o===Sa)return n.RGBA;if(o===IX)return n.LUMINANCE;if(o===RX)return n.LUMINANCE_ALPHA;if(o===Oh)return n.DEPTH_COMPONENT;if(o===Wf)return n.DEPTH_STENCIL;if(o===$w)return l=e.get("EXT_sRGB"),l!==null?l.SRGB_ALPHA_EXT:null;if(o===DX)return n.RED;if(o===YO)return n.RED_INTEGER;if(o===LX)return n.RG;if(o===KO)return n.RG_INTEGER;if(o===$O)return n.RGBA_INTEGER;if(o===pw||o===mw||o===gw||o===Aw)if(u===Jr)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(o===pw)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===mw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===gw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===Aw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(o===pw)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===mw)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===gw)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===Aw)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===pB||o===mB||o===gB||o===AB)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(o===pB)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===mB)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===gB)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===AB)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===JO)return l=e.get("WEBGL_compressed_texture_etc1"),l!==null?l.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===vB||o===yB)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(o===vB)return u===Jr?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(o===yB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===xB||o===EB||o===_B||o===bB||o===MB||o===wB||o===CB||o===SB||o===TB||o===IB||o===RB||o===DB||o===LB||o===PB)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(o===xB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===EB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===_B)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===bB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===MB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===wB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===CB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===SB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===TB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===IB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===RB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===DB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===LB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===PB)return u===Jr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===vw||o===BB||o===OB)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(o===vw)return u===Jr?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(o===BB)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(o===OB)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(o===PX||o===NB||o===FB||o===UB)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(o===vw)return l.COMPRESSED_RED_RGTC1_EXT;if(o===NB)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(o===FB)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(o===UB)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return o===Bh?i?n.UNSIGNED_INT_24_8:(l=e.get("WEBGL_depth_texture"),l!==null?l.UNSIGNED_INT_24_8_WEBGL:null):n[o]!==void 0?n[o]:null}return{convert:s}}function qJ(n,e){function t(x,v){x.matrixAutoUpdate===!0&&x.updateMatrix(),v.value.copy(x.matrix)}function i(x,v){v.color.getRGB(x.fogColor.value,iN(n)),v.isFog?(x.fogNear.value=v.near,x.fogFar.value=v.far):v.isFogExp2&&(x.fogDensity.value=v.density)}function s(x,v,w,M,T){v.isMeshBasicMaterial||v.isMeshLambertMaterial?o(x,v):v.isMeshToonMaterial?(o(x,v),f(x,v)):v.isMeshPhongMaterial?(o(x,v),p(x,v)):v.isMeshStandardMaterial?(o(x,v),m(x,v),v.isMeshPhysicalMaterial&&A(x,v,T)):v.isMeshMatcapMaterial?(o(x,v),y(x,v)):v.isMeshDepthMaterial?o(x,v):v.isMeshDistanceMaterial?(o(x,v),E(x,v)):v.isMeshNormalMaterial?o(x,v):v.isLineBasicMaterial?(c(x,v),v.isLineDashedMaterial&&l(x,v)):v.isPointsMaterial?u(x,v,w,M):v.isSpriteMaterial?h(x,v):v.isShadowMaterial?(x.color.value.copy(v.color),x.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function o(x,v){x.opacity.value=v.opacity,v.color&&x.diffuse.value.copy(v.color),v.emissive&&x.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.bumpMap&&(x.bumpMap.value=v.bumpMap,t(v.bumpMap,x.bumpMapTransform),x.bumpScale.value=v.bumpScale,v.side===Wo&&(x.bumpScale.value*=-1)),v.normalMap&&(x.normalMap.value=v.normalMap,t(v.normalMap,x.normalMapTransform),x.normalScale.value.copy(v.normalScale),v.side===Wo&&x.normalScale.value.negate()),v.displacementMap&&(x.displacementMap.value=v.displacementMap,t(v.displacementMap,x.displacementMapTransform),x.displacementScale.value=v.displacementScale,x.displacementBias.value=v.displacementBias),v.emissiveMap&&(x.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,x.emissiveMapTransform)),v.specularMap&&(x.specularMap.value=v.specularMap,t(v.specularMap,x.specularMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest);let w=e.get(v).envMap;if(w&&(x.envMap.value=w,x.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=v.reflectivity,x.ior.value=v.ior,x.refractionRatio.value=v.refractionRatio),v.lightMap){x.lightMap.value=v.lightMap;let M=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=v.lightMapIntensity*M,t(v.lightMap,x.lightMapTransform)}v.aoMap&&(x.aoMap.value=v.aoMap,x.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,x.aoMapTransform))}function c(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform))}function l(x,v){x.dashSize.value=v.dashSize,x.totalSize.value=v.dashSize+v.gapSize,x.scale.value=v.scale}function u(x,v,w,M){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.size.value=v.size*w,x.scale.value=M*.5,v.map&&(x.map.value=v.map,t(v.map,x.uvTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function h(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.rotation.value=v.rotation,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function p(x,v){x.specular.value.copy(v.specular),x.shininess.value=Math.max(v.shininess,1e-4)}function f(x,v){v.gradientMap&&(x.gradientMap.value=v.gradientMap)}function m(x,v){x.metalness.value=v.metalness,v.metalnessMap&&(x.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,x.metalnessMapTransform)),x.roughness.value=v.roughness,v.roughnessMap&&(x.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,x.roughnessMapTransform)),e.get(v).envMap&&(x.envMapIntensity.value=v.envMapIntensity)}function A(x,v,w){x.ior.value=v.ior,v.sheen>0&&(x.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),x.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(x.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,x.sheenColorMapTransform)),v.sheenRoughnessMap&&(x.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,x.sheenRoughnessMapTransform))),v.clearcoat>0&&(x.clearcoat.value=v.clearcoat,x.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(x.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,x.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(x.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Wo&&x.clearcoatNormalScale.value.negate())),v.iridescence>0&&(x.iridescence.value=v.iridescence,x.iridescenceIOR.value=v.iridescenceIOR,x.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(x.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,x.iridescenceMapTransform)),v.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),v.transmission>0&&(x.transmission.value=v.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),v.transmissionMap&&(x.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,x.transmissionMapTransform)),x.thickness.value=v.thickness,v.thicknessMap&&(x.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=v.attenuationDistance,x.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(x.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(x.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=v.specularIntensity,x.specularColor.value.copy(v.specularColor),v.specularColorMap&&(x.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,x.specularColorMapTransform)),v.specularIntensityMap&&(x.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,x.specularIntensityMapTransform))}function y(x,v){v.matcap&&(x.matcap.value=v.matcap)}function E(x,v){let w=e.get(v).light;x.referencePosition.value.setFromMatrixPosition(w.matrixWorld),x.nearDistance.value=w.shadow.camera.near,x.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function YJ(n,e,t,i){let s={},o={},c=[],l=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(w,M){let T=M.program;i.uniformBlockBinding(w,T)}function h(w,M){let T=s[w.id];T===void 0&&(y(w),T=p(w),s[w.id]=T,w.addEventListener("dispose",x));let D=M.program;i.updateUBOMapping(w,D);let L=e.render.frame;o[w.id]!==L&&(m(w),o[w.id]=L)}function p(w){let M=f();w.__bindingPointIndex=M;let T=n.createBuffer(),D=w.__size,L=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,T),n.bufferData(n.UNIFORM_BUFFER,D,L),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,T),T}function f(){for(let w=0;w<l;w++)if(c.indexOf(w)===-1)return c.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(w){let M=s[w.id],T=w.uniforms,D=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let L=0,I=T.length;L<I;L++){let F=T[L];if(A(F,L,D)===!0){let R=F.__offset,N=Array.isArray(F.value)?F.value:[F.value],X=0;for(let $=0;$<N.length;$++){let te=N[$],U=E(te);typeof te=="number"?(F.__data[0]=te,n.bufferSubData(n.UNIFORM_BUFFER,R+X,F.__data)):te.isMatrix3?(F.__data[0]=te.elements[0],F.__data[1]=te.elements[1],F.__data[2]=te.elements[2],F.__data[3]=te.elements[0],F.__data[4]=te.elements[3],F.__data[5]=te.elements[4],F.__data[6]=te.elements[5],F.__data[7]=te.elements[0],F.__data[8]=te.elements[6],F.__data[9]=te.elements[7],F.__data[10]=te.elements[8],F.__data[11]=te.elements[0]):(te.toArray(F.__data,X),X+=U.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,R,F.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function A(w,M,T){let D=w.value;if(T[M]===void 0){if(typeof D=="number")T[M]=D;else{let L=Array.isArray(D)?D:[D],I=[];for(let F=0;F<L.length;F++)I.push(L[F].clone());T[M]=I}return!0}else if(typeof D=="number"){if(T[M]!==D)return T[M]=D,!0}else{let L=Array.isArray(T[M])?T[M]:[T[M]],I=Array.isArray(D)?D:[D];for(let F=0;F<L.length;F++){let R=L[F];if(R.equals(I[F])===!1)return R.copy(I[F]),!0}}return!1}function y(w){let M=w.uniforms,T=0,D=16,L=0;for(let I=0,F=M.length;I<F;I++){let R=M[I],N={boundary:0,storage:0},X=Array.isArray(R.value)?R.value:[R.value];for(let $=0,te=X.length;$<te;$++){let U=X[$],P=E(U);N.boundary+=P.boundary,N.storage+=P.storage}if(R.__data=new Float32Array(N.storage/Float32Array.BYTES_PER_ELEMENT),R.__offset=T,I>0){L=T%D;let $=D-L;L!==0&&$-N.boundary<0&&(T+=D-L,R.__offset=T)}T+=N.storage}return L=T%D,L>0&&(T+=D-L),w.__size=T,w.__cache={},this}function E(w){let M={boundary:0,storage:0};return typeof w=="number"?(M.boundary=4,M.storage=4):w.isVector2?(M.boundary=8,M.storage=8):w.isVector3||w.isColor?(M.boundary=16,M.storage=12):w.isVector4?(M.boundary=16,M.storage=16):w.isMatrix3?(M.boundary=48,M.storage=48):w.isMatrix4?(M.boundary=64,M.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),M}function x(w){let M=w.target;M.removeEventListener("dispose",x);let T=c.indexOf(M.__bindingPointIndex);c.splice(T,1),n.deleteBuffer(s[M.id]),delete s[M.id],delete o[M.id]}function v(){for(let w in s)n.deleteBuffer(s[w]);c=[],s={},o={}}return{bind:u,update:h,dispose:v}}function uN(n,e,t,i,s){let o,c;if(s===pZ(n,e,t,i)>0)for(o=e;o<t;o+=i)c=UO(o,n[o],n[o+1],c);else for(o=t-i;o>=e;o-=i)c=UO(o,n[o],n[o+1],c);return c&&mx(c,c.next)&&(Ig(c),c=c.next),c}function Fh(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(mx(t,t.next)||ss(t.prev,t,t.next)===0)){if(Ig(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Sg(n,e,t,i,s,o,c){if(!n)return;!c&&o&&cZ(n,i,s,o);let l=n,u,h;for(;n.prev!==n.next;){if(u=n.prev,h=n.next,o?eZ(n,i,s,o):ZJ(n)){e.push(u.i/t|0),e.push(n.i/t|0),e.push(h.i/t|0),Ig(n),n=h.next,l=h.next;continue}if(n=h,n===l){c?c===1?(n=tZ(Fh(n),e,t),Sg(n,e,t,i,s,o,2)):c===2&&nZ(n,e,t,i,s,o):Sg(Fh(n),e,t,i,s,o,1);break}}}function ZJ(n){let e=n.prev,t=n,i=n.next;if(ss(e,t,i)>=0)return!1;let s=e.x,o=t.x,c=i.x,l=e.y,u=t.y,h=i.y,p=s<o?s<c?s:c:o<c?o:c,f=l<u?l<h?l:h:u<h?u:h,m=s>o?s>c?s:c:o>c?o:c,A=l>u?l>h?l:h:u>h?u:h,y=i.next;for(;y!==e;){if(y.x>=p&&y.x<=m&&y.y>=f&&y.y<=A&&Ff(s,l,o,u,c,h,y.x,y.y)&&ss(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function eZ(n,e,t,i){let s=n.prev,o=n,c=n.next;if(ss(s,o,c)>=0)return!1;let l=s.x,u=o.x,h=c.x,p=s.y,f=o.y,m=c.y,A=l<u?l<h?l:h:u<h?u:h,y=p<f?p<m?p:m:f<m?f:m,E=l>u?l>h?l:h:u>h?u:h,x=p>f?p>m?p:m:f>m?f:m,v=AC(A,y,e,t,i),w=AC(E,x,e,t,i),M=n.prevZ,T=n.nextZ;for(;M&&M.z>=v&&T&&T.z<=w;){if(M.x>=A&&M.x<=E&&M.y>=y&&M.y<=x&&M!==s&&M!==c&&Ff(l,p,u,f,h,m,M.x,M.y)&&ss(M.prev,M,M.next)>=0||(M=M.prevZ,T.x>=A&&T.x<=E&&T.y>=y&&T.y<=x&&T!==s&&T!==c&&Ff(l,p,u,f,h,m,T.x,T.y)&&ss(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;M&&M.z>=v;){if(M.x>=A&&M.x<=E&&M.y>=y&&M.y<=x&&M!==s&&M!==c&&Ff(l,p,u,f,h,m,M.x,M.y)&&ss(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;T&&T.z<=w;){if(T.x>=A&&T.x<=E&&T.y>=y&&T.y<=x&&T!==s&&T!==c&&Ff(l,p,u,f,h,m,T.x,T.y)&&ss(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function tZ(n,e,t){let i=n;do{let s=i.prev,o=i.next.next;!mx(s,o)&&hN(s,i,i.next,o)&&Tg(s,o)&&Tg(o,s)&&(e.push(s.i/t|0),e.push(i.i/t|0),e.push(o.i/t|0),Ig(i),Ig(i.next),i=n=o),i=i.next}while(i!==n);return Fh(i)}function nZ(n,e,t,i,s,o){let c=n;do{let l=c.next.next;for(;l!==c.prev;){if(c.i!==l.i&&hZ(c,l)){let u=dN(c,l);c=Fh(c,c.next),u=Fh(u,u.next),Sg(c,e,t,i,s,o,0),Sg(u,e,t,i,s,o,0);return}l=l.next}c=c.next}while(c!==n)}function iZ(n,e,t,i){let s=[],o,c,l,u,h;for(o=0,c=e.length;o<c;o++)l=e[o]*i,u=o<c-1?e[o+1]*i:n.length,h=uN(n,l,u,i,!1),h===h.next&&(h.steiner=!0),s.push(uZ(h));for(s.sort(rZ),o=0;o<s.length;o++)t=sZ(s[o],t);return t}function rZ(n,e){return n.x-e.x}function sZ(n,e){let t=oZ(n,e);if(!t)return e;let i=dN(t,n);return Fh(i,i.next),Fh(t,t.next)}function oZ(n,e){let t=e,i=-1/0,s,o=n.x,c=n.y;do{if(c<=t.y&&c>=t.next.y&&t.next.y!==t.y){let m=t.x+(c-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=o&&m>i&&(i=m,s=t.x<t.next.x?t:t.next,m===o))return s}t=t.next}while(t!==e);if(!s)return null;let l=s,u=s.x,h=s.y,p=1/0,f;t=s;do o>=t.x&&t.x>=u&&o!==t.x&&Ff(c<h?o:i,c,u,h,c<h?i:o,c,t.x,t.y)&&(f=Math.abs(c-t.y)/(o-t.x),Tg(t,n)&&(f<p||f===p&&(t.x>s.x||t.x===s.x&&aZ(s,t)))&&(s=t,p=f)),t=t.next;while(t!==l);return s}function aZ(n,e){return ss(n.prev,n,e.prev)<0&&ss(e.next,n,n.next)<0}function cZ(n,e,t,i){let s=n;do s.z===0&&(s.z=AC(s.x,s.y,e,t,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,lZ(s)}function lZ(n){let e,t,i,s,o,c,l,u,h=1;do{for(t=n,n=null,o=null,c=0;t;){for(c++,i=t,l=0,e=0;e<h&&(l++,i=i.nextZ,!!i);e++);for(u=h;l>0||u>0&&i;)l!==0&&(u===0||!i||t.z<=i.z)?(s=t,t=t.nextZ,l--):(s=i,i=i.nextZ,u--),o?o.nextZ=s:n=s,s.prevZ=o,o=s;t=i}o.nextZ=null,h*=2}while(c>1);return n}function AC(n,e,t,i,s){return n=(n-t)*s|0,e=(e-i)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function uZ(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Ff(n,e,t,i,s,o,c,l){return(s-c)*(e-l)>=(n-c)*(o-l)&&(n-c)*(i-l)>=(t-c)*(e-l)&&(t-c)*(o-l)>=(s-c)*(i-l)}function hZ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!dZ(n,e)&&(Tg(n,e)&&Tg(e,n)&&fZ(n,e)&&(ss(n.prev,n,e.prev)||ss(n,e.prev,e))||mx(n,e)&&ss(n.prev,n,n.next)>0&&ss(e.prev,e,e.next)>0)}function ss(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function mx(n,e){return n.x===e.x&&n.y===e.y}function hN(n,e,t,i){let s=Ry(ss(n,e,t)),o=Ry(ss(n,e,i)),c=Ry(ss(t,i,n)),l=Ry(ss(t,i,e));return!!(s!==o&&c!==l||s===0&&Iy(n,t,e)||o===0&&Iy(n,i,e)||c===0&&Iy(t,n,i)||l===0&&Iy(t,e,i))}function Iy(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Ry(n){return n>0?1:n<0?-1:0}function dZ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&hN(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Tg(n,e){return ss(n.prev,n,n.next)<0?ss(n,e,n.next)>=0&&ss(n,n.prev,e)>=0:ss(n,e,n.prev)<0||ss(n,n.next,e)<0}function fZ(n,e){let t=n,i=!1,s=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&s<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function dN(n,e){let t=new vC(n.i,n.x,n.y),i=new vC(e.i,e.x,e.y),s=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=s,s.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function UO(n,e,t,i){let s=new vC(n,e,t);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Ig(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function vC(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pZ(n,e,t,i){let s=0;for(let o=e,c=t-i;o<t;o+=i)s+=(n[c]-n[o])*(n[o+1]+n[c+1]),c=o;return s}function kO(n){let e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function VO(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}function Dy(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function mZ(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function gZ(n){function e(s,o){return n[s]-n[o]}let t=n.length,i=new Array(t);for(let s=0;s!==t;++s)i[s]=s;return i.sort(e),i}function HO(n,e,t){let i=n.length,s=new n.constructor(i);for(let o=0,c=0;c!==i;++o){let l=t[o]*e;for(let u=0;u!==e;++u)s[c++]=n[l+u]}return s}function fN(n,e,t,i){let s=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[s++];if(o===void 0)return;let c=o[i];if(c!==void 0)if(Array.isArray(c))do c=o[i],c!==void 0&&(e.push(o.time),t.push.apply(t,c)),o=n[s++];while(o!==void 0);else if(c.toArray!==void 0)do c=o[i],c!==void 0&&(e.push(o.time),c.toArray(t,t.length)),o=n[s++];while(o!==void 0);else do c=o[i],c!==void 0&&(e.push(o.time),t.push(c)),o=n[s++];while(o!==void 0)}function AZ(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return du;case"vector":case"vector2":case"vector3":case"vector4":return pu;case"color":return nx;case"quaternion":return Sc;case"bool":case"boolean":return hu;case"string":return fu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function vZ(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=AZ(n.type);if(n.times===void 0){let t=[],i=[];fN(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}var RC,jQ,sB,QQ,jO,XQ,rl,au,Wo,ol,ru,Uf,oB,aB,cB,qQ,Lh,YQ,KQ,lB,uB,$Q,JQ,ZQ,eX,Xw,qw,tX,nX,iX,rX,sX,oX,aX,cX,lX,uX,hX,dX,Ly,fX,pX,mX,gX,hx,AX,vX,su,yX,xX,EX,_X,bX,hB,MX,dB,Hf,zf,yg,Yw,dx,Gf,Go,Kw,Zs,fB,fw,Ca,wX,xg,ou,CX,SX,DC,QO,iu,al,Eg,XO,qO,Bh,TX,Sa,IX,RX,Oh,Wf,DX,YO,LX,KO,$O,pw,mw,gw,Aw,pB,mB,gB,AB,JO,vB,yB,xB,EB,_B,bB,MB,wB,CB,SB,TB,IB,RB,DB,LB,PB,vw,BB,OB,PX,NB,FB,UB,Py,By,yw,kB,VB,HB,BX,ZO,Nh,OX,NX,LC,FX,Ta,cs,ul,PC,fx,Oy,Jr,Ny,Fy,vf,zB,UX,kX,VX,eN,HX,zX,GX,WX,GB,WB,$w,cl,Uy,cu,fo,jB,mg,jf,go,gr,$i,xw,QB,XB,qB,sy,oq,Vr,yf,Vy,aq,Hy,cq,La,br,Zw,hl,zy,eC,io,Et,bw,YB,lu,Jc,Ja,oy,xf,Ef,_f,Jl,Zl,Sh,lg,ay,cy,Th,lq,ug,ww,uu,Zc,Cw,ly,eu,Sw,uy,Tw,bg,yi,bf,Za,uq,hq,tu,hy,aa,KB,$B,Pa,Gy,dq,JB,Mf,el,dy,hg,fq,pq,ZB,eO,tO,mq,gq,mo,ec,tl,Iw,nl,wf,Cf,nO,Rw,Dw,Lw,fy,Of,nN,nu,py,Si,po,Aq,dl,Wy,ys,my,Ia,Qf,jy,no,vq,wa,Bw,Sf,ca,dg,js,Ra,iO,Ih,gy,rO,Tf,If,Rf,Ow,Ay,vy,yy,xy,sO,oO,aO,Ey,_y,la,Mg,Eq,_q,bq,fl,Qy,to,Df,Lf,tC,Xy,nC,Nw,Mq,wq,sl,Rh,My,wg,iC,Sq,Tq,Iq,Rq,Dq,Lq,Pq,Bq,Oq,Nq,Fq,Uq,kq,Vq,Hq,zq,Gq,Wq,jq,Qq,Xq,qq,Yq,Kq,$q,Jq,Zq,eY,tY,nY,iY,rY,sY,oY,aY,cY,lY,uY,hY,dY,fY,pY,mY,gY,AY,vY,yY,xY,EY,_Y,bY,MY,wY,CY,SY,TY,IY,RY,DY,LY,PY,BY,OY,NY,FY,UY,kY,VY,HY,zY,GY,WY,jY,QY,XY,qY,YY,KY,$Y,JY,ZY,eK,tK,nK,iK,rK,sK,oK,aK,cK,lK,uK,hK,dK,fK,pK,mK,gK,AK,vK,yK,xK,EK,_K,bK,MK,wK,CK,SK,TK,IK,RK,DK,LK,PK,BK,OK,NK,FK,UK,kK,VK,HK,zK,GK,WK,jK,QK,XK,qK,YK,KK,$K,JK,ZK,e$,t$,n$,i$,r$,s$,Ki,Un,Cc,wy,qf,Nf,cO,Ph,Fw,lO,Uw,kw,Vw,Dh,Pf,uO,qy,Yy,sN,oN,aN,cN,lN,pO,mO,gO,AO,vO,rC,sC,oC,Hw,Vf,uJ,hJ,yJ,xJ,_J,RJ,cC,lC,FJ,uC,hC,HJ,zJ,dC,ll,XJ,vg,fC,pC,mC,IO,RO,DO,KJ,LO,Sy,zw,PO,Gw,Ky,Yf,gC,BO,$J,$y,Cg,OO,NO,FO,Ww,Ty,Jy,Zy,JJ,ex,Kf,tx,$f,yC,xC,EC,Da,hu,nx,du,_C,Sc,fu,pu,ix,rx,bC,yZ,Uh,il,MC,sx,wC,ox,Jf,jw,zO,GO,Rg,CC,ax,WO,fg,Qw,SC,Dg,TC,cx,lx,ux,NC,xZ,FC,EZ,_Z,bZ,MZ,wZ,CZ,SZ,IC,qr,Bpe,gx=zc(()=>{"use strict";RC="159",jQ=0,sB=1,QQ=2,jO=1,XQ=2,rl=3,au=0,Wo=1,ol=2,ru=0,Uf=1,oB=2,aB=3,cB=4,qQ=5,Lh=100,YQ=101,KQ=102,lB=103,uB=104,$Q=200,JQ=201,ZQ=202,eX=203,Xw=204,qw=205,tX=206,nX=207,iX=208,rX=209,sX=210,oX=211,aX=212,cX=213,lX=214,uX=0,hX=1,dX=2,Ly=3,fX=4,pX=5,mX=6,gX=7,hx=0,AX=1,vX=2,su=0,yX=1,xX=2,EX=3,_X=4,bX=5,hB="attached",MX="detached",dB=300,Hf=301,zf=302,yg=303,Yw=304,dx=306,Gf=1e3,Go=1001,Kw=1002,Zs=1003,fB=1004,fw=1005,Ca=1006,wX=1007,xg=1008,ou=1009,CX=1010,SX=1011,DC=1012,QO=1013,iu=1014,al=1015,Eg=1016,XO=1017,qO=1018,Bh=1020,TX=1021,Sa=1023,IX=1024,RX=1025,Oh=1026,Wf=1027,DX=1028,YO=1029,LX=1030,KO=1031,$O=1033,pw=33776,mw=33777,gw=33778,Aw=33779,pB=35840,mB=35841,gB=35842,AB=35843,JO=36196,vB=37492,yB=37496,xB=37808,EB=37809,_B=37810,bB=37811,MB=37812,wB=37813,CB=37814,SB=37815,TB=37816,IB=37817,RB=37818,DB=37819,LB=37820,PB=37821,vw=36492,BB=36494,OB=36495,PX=36283,NB=36284,FB=36285,UB=36286,Py=2300,By=2301,yw=2302,kB=2400,VB=2401,HB=2402,BX=2500,ZO=3e3,Nh=3001,OX=3200,NX=3201,LC=0,FX=1,Ta="",cs="srgb",ul="srgb-linear",PC="display-p3",fx="display-p3-linear",Oy="linear",Jr="srgb",Ny="rec709",Fy="p3",vf=7680,zB=519,UX=512,kX=513,VX=514,eN=515,HX=516,zX=517,GX=518,WX=519,GB=35044,WB="300 es",$w=1035,cl=2e3,Uy=2001,cu=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let s=this._listeners[e];if(s!==void 0){let o=s.indexOf(t);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let s=i.slice(0);for(let o=0,c=s.length;o<c;o++)s[o].call(this,e);e.target=null}}},fo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],jB=1234567,mg=Math.PI/180,jf=180/Math.PI;go={DEG2RAD:mg,RAD2DEG:jf,generateUUID:mu,clamp:eo,euclideanModulo:BC,mapLinear:jX,inverseLerp:QX,lerp:gg,damp:XX,pingpong:qX,smoothstep:YX,smootherstep:KX,randInt:$X,randFloat:JX,randFloatSpread:ZX,seededRandom:eq,degToRad:tq,radToDeg:nq,isPowerOfTwo:Jw,ceilPowerOfTwo:iq,floorPowerOfTwo:ky,setQuaternionFromProperEuler:rq,normalize:Io,denormalize:Bf},gr=class n{constructor(e=0,t=0){n.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(eo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),s=Math.sin(t),o=this.x-e.x,c=this.y-e.y;return this.x=o*i-c*s+e.x,this.y=o*s+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},$i=class n{constructor(e,t,i,s,o,c,l,u,h){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,l,u,h)}set(e,t,i,s,o,c,l,u,h){let p=this.elements;return p[0]=e,p[1]=s,p[2]=l,p[3]=t,p[4]=o,p[5]=u,p[6]=i,p[7]=c,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,c=i[0],l=i[3],u=i[6],h=i[1],p=i[4],f=i[7],m=i[2],A=i[5],y=i[8],E=s[0],x=s[3],v=s[6],w=s[1],M=s[4],T=s[7],D=s[2],L=s[5],I=s[8];return o[0]=c*E+l*w+u*D,o[3]=c*x+l*M+u*L,o[6]=c*v+l*T+u*I,o[1]=h*E+p*w+f*D,o[4]=h*x+p*M+f*L,o[7]=h*v+p*T+f*I,o[2]=m*E+A*w+y*D,o[5]=m*x+A*M+y*L,o[8]=m*v+A*T+y*I,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8];return t*c*p-t*l*h-i*o*p+i*l*u+s*o*h-s*c*u}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=p*c-l*h,m=l*u-p*o,A=h*o-c*u,y=t*f+i*m+s*A;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);let E=1/y;return e[0]=f*E,e[1]=(s*h-p*i)*E,e[2]=(l*i-s*c)*E,e[3]=m*E,e[4]=(p*t-s*u)*E,e[5]=(s*o-l*t)*E,e[6]=A*E,e[7]=(i*u-h*t)*E,e[8]=(c*t-i*o)*E,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,o,c,l){let u=Math.cos(o),h=Math.sin(o);return this.set(i*u,i*h,-i*(u*c+h*l)+c+e,-s*h,s*u,-s*(-h*c+u*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(xw.makeScale(e,t)),this}rotate(e){return this.premultiply(xw.makeRotation(-e)),this}translate(e,t){return this.premultiply(xw.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},xw=new $i;QB={};XB=new $i().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),qB=new $i().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),sy={[ul]:{transfer:Oy,primaries:Ny,toReference:n=>n,fromReference:n=>n},[cs]:{transfer:Jr,primaries:Ny,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[fx]:{transfer:Oy,primaries:Fy,toReference:n=>n.applyMatrix3(qB),fromReference:n=>n.applyMatrix3(XB)},[PC]:{transfer:Jr,primaries:Fy,toReference:n=>n.convertSRGBToLinear().applyMatrix3(qB),fromReference:n=>n.applyMatrix3(XB).convertLinearToSRGB()}},oq=new Set([ul,fx]),Vr={enabled:!0,_workingColorSpace:ul,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!oq.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;let i=sy[e].toReference,s=sy[t].fromReference;return s(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return sy[n].primaries},getTransfer:function(n){return n===Ta?Oy:sy[n].transfer}};Vy=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{yf===void 0&&(yf=_g("canvas")),yf.width=e.width,yf.height=e.height;let i=yf.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=yf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=_g("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let c=0;c<o.length;c++)o[c]=kf(o[c]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(kf(t[i]/255)*255):t[i]=kf(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},aq=0,Hy=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:aq++}),this.uuid=mu(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let c=0,l=s.length;c<l;c++)s[c].isDataTexture?o.push(_w(s[c].image)):o.push(_w(s[c]))}else o=_w(s);i.url=o}return t||(e.images[this.uuid]=i),i}};cq=0,La=(()=>{class n extends cu{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,s=Go,o=Go,c=Ca,l=xg,u=Sa,h=ou,p=n.DEFAULT_ANISOTROPY,f=Ta){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cq++}),this.uuid=mu(),this.name="",this.source=new Hy(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=o,this.magFilter=c,this.minFilter=l,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=h,this.offset=new gr(0,0),this.repeat=new gr(1,1),this.center=new gr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new $i,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Ag("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===Nh?cs:Ta),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==dB)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Gf:t.x=t.x-Math.floor(t.x);break;case Go:t.x=t.x<0?0:1;break;case Kw:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Gf:t.y=t.y-Math.floor(t.y);break;case Go:t.y=t.y<0?0:1;break;case Kw:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Ag("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===cs?Nh:ZO}set encoding(t){Ag("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Nh?cs:Ta}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=dB,n.DEFAULT_ANISOTROPY=1,n})(),br=class n{constructor(e=0,t=0,i=0,s=1){n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=this.w,c=e.elements;return this.x=c[0]*t+c[4]*i+c[8]*s+c[12]*o,this.y=c[1]*t+c[5]*i+c[9]*s+c[13]*o,this.z=c[2]*t+c[6]*i+c[10]*s+c[14]*o,this.w=c[3]*t+c[7]*i+c[11]*s+c[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,o,u=e.elements,h=u[0],p=u[4],f=u[8],m=u[1],A=u[5],y=u[9],E=u[2],x=u[6],v=u[10];if(Math.abs(p-m)<.01&&Math.abs(f-E)<.01&&Math.abs(y-x)<.01){if(Math.abs(p+m)<.1&&Math.abs(f+E)<.1&&Math.abs(y+x)<.1&&Math.abs(h+A+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let M=(h+1)/2,T=(A+1)/2,D=(v+1)/2,L=(p+m)/4,I=(f+E)/4,F=(y+x)/4;return M>T&&M>D?M<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(M),s=L/i,o=I/i):T>D?T<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),i=L/s,o=F/s):D<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(D),i=I/o,s=F/o),this.set(i,s,o,t),this}let w=Math.sqrt((x-y)*(x-y)+(f-E)*(f-E)+(m-p)*(m-p));return Math.abs(w)<.001&&(w=1),this.x=(x-y)/w,this.y=(f-E)/w,this.z=(m-p)/w,this.w=Math.acos((h+A+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Zw=class extends cu{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new br(0,0,e,t),this.scissorTest=!1,this.viewport=new br(0,0,e,t);let s={width:e,height:t,depth:1};i.encoding!==void 0&&(Ag("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Nh?cs:Ta),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ca,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new La(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Hy(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},hl=class extends Zw{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},zy=class extends La{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Zs,this.minFilter=Zs,this.wrapR=Go,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},eC=class extends La{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Zs,this.minFilter=Zs,this.wrapR=Go,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},io=class{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,o,c,l){let u=i[s+0],h=i[s+1],p=i[s+2],f=i[s+3],m=o[c+0],A=o[c+1],y=o[c+2],E=o[c+3];if(l===0){e[t+0]=u,e[t+1]=h,e[t+2]=p,e[t+3]=f;return}if(l===1){e[t+0]=m,e[t+1]=A,e[t+2]=y,e[t+3]=E;return}if(f!==E||u!==m||h!==A||p!==y){let x=1-l,v=u*m+h*A+p*y+f*E,w=v>=0?1:-1,M=1-v*v;if(M>Number.EPSILON){let D=Math.sqrt(M),L=Math.atan2(D,v*w);x=Math.sin(x*L)/D,l=Math.sin(l*L)/D}let T=l*w;if(u=u*x+m*T,h=h*x+A*T,p=p*x+y*T,f=f*x+E*T,x===1-l){let D=1/Math.sqrt(u*u+h*h+p*p+f*f);u*=D,h*=D,p*=D,f*=D}}e[t]=u,e[t+1]=h,e[t+2]=p,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,s,o,c){let l=i[s],u=i[s+1],h=i[s+2],p=i[s+3],f=o[c],m=o[c+1],A=o[c+2],y=o[c+3];return e[t]=l*y+p*f+u*A-h*m,e[t+1]=u*y+p*m+h*f-l*A,e[t+2]=h*y+p*A+l*m-u*f,e[t+3]=p*y-l*f-u*m-h*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,s=e._y,o=e._z,c=e._order,l=Math.cos,u=Math.sin,h=l(i/2),p=l(s/2),f=l(o/2),m=u(i/2),A=u(s/2),y=u(o/2);switch(c){case"XYZ":this._x=m*p*f+h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f-m*A*y;break;case"YXZ":this._x=m*p*f+h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f+m*A*y;break;case"ZXY":this._x=m*p*f-h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f-m*A*y;break;case"ZYX":this._x=m*p*f-h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f+m*A*y;break;case"YZX":this._x=m*p*f+h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f-m*A*y;break;case"XZY":this._x=m*p*f-h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f+m*A*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],s=t[4],o=t[8],c=t[1],l=t[5],u=t[9],h=t[2],p=t[6],f=t[10],m=i+l+f;if(m>0){let A=.5/Math.sqrt(m+1);this._w=.25/A,this._x=(p-u)*A,this._y=(o-h)*A,this._z=(c-s)*A}else if(i>l&&i>f){let A=2*Math.sqrt(1+i-l-f);this._w=(p-u)/A,this._x=.25*A,this._y=(s+c)/A,this._z=(o+h)/A}else if(l>f){let A=2*Math.sqrt(1+l-i-f);this._w=(o-h)/A,this._x=(s+c)/A,this._y=.25*A,this._z=(u+p)/A}else{let A=2*Math.sqrt(1+f-i-l);this._w=(c-s)/A,this._x=(o+h)/A,this._y=(u+p)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(eo(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,s=e._y,o=e._z,c=e._w,l=t._x,u=t._y,h=t._z,p=t._w;return this._x=i*p+c*l+s*h-o*u,this._y=s*p+c*u+o*l-i*h,this._z=o*p+c*h+i*u-s*l,this._w=c*p-i*l-s*u-o*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,s=this._y,o=this._z,c=this._w,l=c*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=c,this._x=i,this._y=s,this._z=o,this;let u=1-l*l;if(u<=Number.EPSILON){let A=1-t;return this._w=A*c+t*this._w,this._x=A*i+t*this._x,this._y=A*s+t*this._y,this._z=A*o+t*this._z,this.normalize(),this._onChangeCallback(),this}let h=Math.sqrt(u),p=Math.atan2(h,l),f=Math.sin((1-t)*p)/h,m=Math.sin(t*p)/h;return this._w=c*f+this._w*m,this._x=i*f+this._x*m,this._y=s*f+this._y*m,this._z=o*f+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),s=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(s),i*Math.sin(o),i*Math.cos(o),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Et=class n{constructor(e=0,t=0,i=0){n.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(YB.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(YB.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*s,this.y=o[1]*t+o[4]*i+o[7]*s,this.z=o[2]*t+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=e.elements,c=1/(o[3]*t+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*s+o[12])*c,this.y=(o[1]*t+o[5]*i+o[9]*s+o[13])*c,this.z=(o[2]*t+o[6]*i+o[10]*s+o[14])*c,this}applyQuaternion(e){let t=this.x,i=this.y,s=this.z,o=e.x,c=e.y,l=e.z,u=e.w,h=2*(c*s-l*i),p=2*(l*t-o*s),f=2*(o*i-c*t);return this.x=t+u*h+c*f-l*p,this.y=i+u*p+l*h-o*f,this.z=s+u*f+o*p-c*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s,this.y=o[1]*t+o[5]*i+o[9]*s,this.z=o[2]*t+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,s=e.y,o=e.z,c=t.x,l=t.y,u=t.z;return this.x=s*u-o*l,this.y=o*c-i*u,this.z=i*l-s*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return bw.copy(this).projectOnVector(e),this.sub(bw)}reflect(e){return this.sub(bw.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(eo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},bw=new Et,YB=new io,lu=class{constructor(e=new Et(1/0,1/0,1/0),t=new Et(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Ja.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Ja.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Ja.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let o=i.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let c=0,l=o.count;c<l;c++)e.isMesh===!0?e.getVertexPosition(c,Ja):Ja.fromBufferAttribute(o,c),Ja.applyMatrix4(e.matrixWorld),this.expandByPoint(Ja);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),oy.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),oy.copy(i.boundingBox)),oy.applyMatrix4(e.matrixWorld),this.union(oy)}let s=e.children;for(let o=0,c=s.length;o<c;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ja),Ja.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lg),ay.subVectors(this.max,lg),xf.subVectors(e.a,lg),Ef.subVectors(e.b,lg),_f.subVectors(e.c,lg),Jl.subVectors(Ef,xf),Zl.subVectors(_f,Ef),Sh.subVectors(xf,_f);let t=[0,-Jl.z,Jl.y,0,-Zl.z,Zl.y,0,-Sh.z,Sh.y,Jl.z,0,-Jl.x,Zl.z,0,-Zl.x,Sh.z,0,-Sh.x,-Jl.y,Jl.x,0,-Zl.y,Zl.x,0,-Sh.y,Sh.x,0];return!Mw(t,xf,Ef,_f,ay)||(t=[1,0,0,0,1,0,0,0,1],!Mw(t,xf,Ef,_f,ay))?!1:(cy.crossVectors(Jl,Zl),t=[cy.x,cy.y,cy.z],Mw(t,xf,Ef,_f,ay))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ja).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ja).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Jc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Jc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Jc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Jc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Jc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Jc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Jc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Jc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Jc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Jc=[new Et,new Et,new Et,new Et,new Et,new Et,new Et,new Et],Ja=new Et,oy=new lu,xf=new Et,Ef=new Et,_f=new Et,Jl=new Et,Zl=new Et,Sh=new Et,lg=new Et,ay=new Et,cy=new Et,Th=new Et;lq=new lu,ug=new Et,ww=new Et,uu=class{constructor(e=new Et,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):lq.setFromPoints(e).getCenter(i);let s=0;for(let o=0,c=e.length;o<c;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ug.subVectors(e,this.center);let t=ug.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(ug,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ww.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ug.copy(e.center).add(ww)),this.expandByPoint(ug.copy(e.center).sub(ww))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Zc=new Et,Cw=new Et,ly=new Et,eu=new Et,Sw=new Et,uy=new Et,Tw=new Et,bg=class{constructor(e=new Et,t=new Et(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Zc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zc.copy(this.origin).addScaledVector(this.direction,t),Zc.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Cw.copy(e).add(t).multiplyScalar(.5),ly.copy(t).sub(e).normalize(),eu.copy(this.origin).sub(Cw);let o=e.distanceTo(t)*.5,c=-this.direction.dot(ly),l=eu.dot(this.direction),u=-eu.dot(ly),h=eu.lengthSq(),p=Math.abs(1-c*c),f,m,A,y;if(p>0)if(f=c*u-l,m=c*l-u,y=o*p,f>=0)if(m>=-y)if(m<=y){let E=1/p;f*=E,m*=E,A=f*(f+c*m+2*l)+m*(c*f+m+2*u)+h}else m=o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;else m=-o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;else m<=-y?(f=Math.max(0,-(-c*o+l)),m=f>0?-o:Math.min(Math.max(-o,-u),o),A=-f*f+m*(m+2*u)+h):m<=y?(f=0,m=Math.min(Math.max(-o,-u),o),A=m*(m+2*u)+h):(f=Math.max(0,-(c*o+l)),m=f>0?o:Math.min(Math.max(-o,-u),o),A=-f*f+m*(m+2*u)+h);else m=c>0?-o:o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(Cw).addScaledVector(ly,m),A}intersectSphere(e,t){Zc.subVectors(e.center,this.origin);let i=Zc.dot(this.direction),s=Zc.dot(Zc)-i*i,o=e.radius*e.radius;if(s>o)return null;let c=Math.sqrt(o-s),l=i-c,u=i+c;return u<0?null:l<0?this.at(u,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,o,c,l,u,h=1/this.direction.x,p=1/this.direction.y,f=1/this.direction.z,m=this.origin;return h>=0?(i=(e.min.x-m.x)*h,s=(e.max.x-m.x)*h):(i=(e.max.x-m.x)*h,s=(e.min.x-m.x)*h),p>=0?(o=(e.min.y-m.y)*p,c=(e.max.y-m.y)*p):(o=(e.max.y-m.y)*p,c=(e.min.y-m.y)*p),i>c||o>s||((o>i||isNaN(i))&&(i=o),(c<s||isNaN(s))&&(s=c),f>=0?(l=(e.min.z-m.z)*f,u=(e.max.z-m.z)*f):(l=(e.max.z-m.z)*f,u=(e.min.z-m.z)*f),i>u||l>s)||((l>i||i!==i)&&(i=l),(u<s||s!==s)&&(s=u),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,Zc)!==null}intersectTriangle(e,t,i,s,o){Sw.subVectors(t,e),uy.subVectors(i,e),Tw.crossVectors(Sw,uy);let c=this.direction.dot(Tw),l;if(c>0){if(s)return null;l=1}else if(c<0)l=-1,c=-c;else return null;eu.subVectors(this.origin,e);let u=l*this.direction.dot(uy.crossVectors(eu,uy));if(u<0)return null;let h=l*this.direction.dot(Sw.cross(eu));if(h<0||u+h>c)return null;let p=-l*eu.dot(Tw);return p<0?null:this.at(p/c,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},yi=class n{constructor(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x)}set(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x){let v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=s,v[1]=o,v[5]=c,v[9]=l,v[13]=u,v[2]=h,v[6]=p,v[10]=f,v[14]=m,v[3]=A,v[7]=y,v[11]=E,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,s=1/bf.setFromMatrixColumn(e,0).length(),o=1/bf.setFromMatrixColumn(e,1).length(),c=1/bf.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*c,t[9]=i[9]*c,t[10]=i[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,s=e.y,o=e.z,c=Math.cos(i),l=Math.sin(i),u=Math.cos(s),h=Math.sin(s),p=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){let m=c*p,A=c*f,y=l*p,E=l*f;t[0]=u*p,t[4]=-u*f,t[8]=h,t[1]=A+y*h,t[5]=m-E*h,t[9]=-l*u,t[2]=E-m*h,t[6]=y+A*h,t[10]=c*u}else if(e.order==="YXZ"){let m=u*p,A=u*f,y=h*p,E=h*f;t[0]=m+E*l,t[4]=y*l-A,t[8]=c*h,t[1]=c*f,t[5]=c*p,t[9]=-l,t[2]=A*l-y,t[6]=E+m*l,t[10]=c*u}else if(e.order==="ZXY"){let m=u*p,A=u*f,y=h*p,E=h*f;t[0]=m-E*l,t[4]=-c*f,t[8]=y+A*l,t[1]=A+y*l,t[5]=c*p,t[9]=E-m*l,t[2]=-c*h,t[6]=l,t[10]=c*u}else if(e.order==="ZYX"){let m=c*p,A=c*f,y=l*p,E=l*f;t[0]=u*p,t[4]=y*h-A,t[8]=m*h+E,t[1]=u*f,t[5]=E*h+m,t[9]=A*h-y,t[2]=-h,t[6]=l*u,t[10]=c*u}else if(e.order==="YZX"){let m=c*u,A=c*h,y=l*u,E=l*h;t[0]=u*p,t[4]=E-m*f,t[8]=y*f+A,t[1]=f,t[5]=c*p,t[9]=-l*p,t[2]=-h*p,t[6]=A*f+y,t[10]=m-E*f}else if(e.order==="XZY"){let m=c*u,A=c*h,y=l*u,E=l*h;t[0]=u*p,t[4]=-f,t[8]=h*p,t[1]=m*f+E,t[5]=c*p,t[9]=A*f-y,t[2]=y*f-A,t[6]=l*p,t[10]=E*f+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(uq,e,hq)}lookAt(e,t,i){let s=this.elements;return aa.subVectors(e,t),aa.lengthSq()===0&&(aa.z=1),aa.normalize(),tu.crossVectors(i,aa),tu.lengthSq()===0&&(Math.abs(i.z)===1?aa.x+=1e-4:aa.z+=1e-4,aa.normalize(),tu.crossVectors(i,aa)),tu.normalize(),hy.crossVectors(aa,tu),s[0]=tu.x,s[4]=hy.x,s[8]=aa.x,s[1]=tu.y,s[5]=hy.y,s[9]=aa.y,s[2]=tu.z,s[6]=hy.z,s[10]=aa.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,c=i[0],l=i[4],u=i[8],h=i[12],p=i[1],f=i[5],m=i[9],A=i[13],y=i[2],E=i[6],x=i[10],v=i[14],w=i[3],M=i[7],T=i[11],D=i[15],L=s[0],I=s[4],F=s[8],R=s[12],N=s[1],X=s[5],$=s[9],te=s[13],U=s[2],P=s[6],k=s[10],z=s[14],Q=s[3],Z=s[7],ce=s[11],Me=s[15];return o[0]=c*L+l*N+u*U+h*Q,o[4]=c*I+l*X+u*P+h*Z,o[8]=c*F+l*$+u*k+h*ce,o[12]=c*R+l*te+u*z+h*Me,o[1]=p*L+f*N+m*U+A*Q,o[5]=p*I+f*X+m*P+A*Z,o[9]=p*F+f*$+m*k+A*ce,o[13]=p*R+f*te+m*z+A*Me,o[2]=y*L+E*N+x*U+v*Q,o[6]=y*I+E*X+x*P+v*Z,o[10]=y*F+E*$+x*k+v*ce,o[14]=y*R+E*te+x*z+v*Me,o[3]=w*L+M*N+T*U+D*Q,o[7]=w*I+M*X+T*P+D*Z,o[11]=w*F+M*$+T*k+D*ce,o[15]=w*R+M*te+T*z+D*Me,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],s=e[8],o=e[12],c=e[1],l=e[5],u=e[9],h=e[13],p=e[2],f=e[6],m=e[10],A=e[14],y=e[3],E=e[7],x=e[11],v=e[15];return y*(+o*u*f-s*h*f-o*l*m+i*h*m+s*l*A-i*u*A)+E*(+t*u*A-t*h*m+o*c*m-s*c*A+s*h*p-o*u*p)+x*(+t*h*f-t*l*A-o*c*f+i*c*A+o*l*p-i*h*p)+v*(-s*l*p-t*u*f+t*l*m+s*c*f-i*c*m+i*u*p)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=e[9],m=e[10],A=e[11],y=e[12],E=e[13],x=e[14],v=e[15],w=f*x*h-E*m*h+E*u*A-l*x*A-f*u*v+l*m*v,M=y*m*h-p*x*h-y*u*A+c*x*A+p*u*v-c*m*v,T=p*E*h-y*f*h+y*l*A-c*E*A-p*l*v+c*f*v,D=y*f*u-p*E*u-y*l*m+c*E*m+p*l*x-c*f*x,L=t*w+i*M+s*T+o*D;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let I=1/L;return e[0]=w*I,e[1]=(E*m*o-f*x*o-E*s*A+i*x*A+f*s*v-i*m*v)*I,e[2]=(l*x*o-E*u*o+E*s*h-i*x*h-l*s*v+i*u*v)*I,e[3]=(f*u*o-l*m*o-f*s*h+i*m*h+l*s*A-i*u*A)*I,e[4]=M*I,e[5]=(p*x*o-y*m*o+y*s*A-t*x*A-p*s*v+t*m*v)*I,e[6]=(y*u*o-c*x*o-y*s*h+t*x*h+c*s*v-t*u*v)*I,e[7]=(c*m*o-p*u*o+p*s*h-t*m*h-c*s*A+t*u*A)*I,e[8]=T*I,e[9]=(y*f*o-p*E*o-y*i*A+t*E*A+p*i*v-t*f*v)*I,e[10]=(c*E*o-y*l*o+y*i*h-t*E*h-c*i*v+t*l*v)*I,e[11]=(p*l*o-c*f*o-p*i*h+t*f*h+c*i*A-t*l*A)*I,e[12]=D*I,e[13]=(p*E*s-y*f*s+y*i*m-t*E*m-p*i*x+t*f*x)*I,e[14]=(y*l*s-c*E*s-y*i*u+t*E*u+c*i*x-t*l*x)*I,e[15]=(c*f*s-p*l*s+p*i*u-t*f*u-c*i*m+t*l*m)*I,this}scale(e){let t=this.elements,i=e.x,s=e.y,o=e.z;return t[0]*=i,t[4]*=s,t[8]*=o,t[1]*=i,t[5]*=s,t[9]*=o,t[2]*=i,t[6]*=s,t[10]*=o,t[3]*=i,t[7]*=s,t[11]*=o,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),s=Math.sin(t),o=1-i,c=e.x,l=e.y,u=e.z,h=o*c,p=o*l;return this.set(h*c+i,h*l-s*u,h*u+s*l,0,h*l+s*u,p*l+i,p*u-s*c,0,h*u-s*l,p*u+s*c,o*u*u+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,o,c){return this.set(1,i,o,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){let s=this.elements,o=t._x,c=t._y,l=t._z,u=t._w,h=o+o,p=c+c,f=l+l,m=o*h,A=o*p,y=o*f,E=c*p,x=c*f,v=l*f,w=u*h,M=u*p,T=u*f,D=i.x,L=i.y,I=i.z;return s[0]=(1-(E+v))*D,s[1]=(A+T)*D,s[2]=(y-M)*D,s[3]=0,s[4]=(A-T)*L,s[5]=(1-(m+v))*L,s[6]=(x+w)*L,s[7]=0,s[8]=(y+M)*I,s[9]=(x-w)*I,s[10]=(1-(m+E))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){let s=this.elements,o=bf.set(s[0],s[1],s[2]).length(),c=bf.set(s[4],s[5],s[6]).length(),l=bf.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Za.copy(this);let h=1/o,p=1/c,f=1/l;return Za.elements[0]*=h,Za.elements[1]*=h,Za.elements[2]*=h,Za.elements[4]*=p,Za.elements[5]*=p,Za.elements[6]*=p,Za.elements[8]*=f,Za.elements[9]*=f,Za.elements[10]*=f,t.setFromRotationMatrix(Za),i.x=o,i.y=c,i.z=l,this}makePerspective(e,t,i,s,o,c,l=cl){let u=this.elements,h=2*o/(t-e),p=2*o/(i-s),f=(t+e)/(t-e),m=(i+s)/(i-s),A,y;if(l===cl)A=-(c+o)/(c-o),y=-2*c*o/(c-o);else if(l===Uy)A=-c/(c-o),y=-c*o/(c-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=h,u[4]=0,u[8]=f,u[12]=0,u[1]=0,u[5]=p,u[9]=m,u[13]=0,u[2]=0,u[6]=0,u[10]=A,u[14]=y,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,i,s,o,c,l=cl){let u=this.elements,h=1/(t-e),p=1/(i-s),f=1/(c-o),m=(t+e)*h,A=(i+s)*p,y,E;if(l===cl)y=(c+o)*f,E=-2*f;else if(l===Uy)y=o*f,E=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-m,u[1]=0,u[5]=2*p,u[9]=0,u[13]=-A,u[2]=0,u[6]=0,u[10]=E,u[14]=-y,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},bf=new Et,Za=new yi,uq=new Et(0,0,0),hq=new Et(1,1,1),tu=new Et,hy=new Et,aa=new Et,KB=new yi,$B=new io,Pa=(()=>{class n{constructor(t=0,i=0,s=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,o=this._order){return this._x=t,this._y=i,this._z=s,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){let o=t.elements,c=o[0],l=o[4],u=o[8],h=o[1],p=o[5],f=o[9],m=o[2],A=o[6],y=o[10];switch(i){case"XYZ":this._y=Math.asin(eo(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-l,c)):(this._x=Math.atan2(A,p),this._z=0);break;case"YXZ":this._x=Math.asin(-eo(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,y),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-m,c),this._z=0);break;case"ZXY":this._x=Math.asin(eo(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-m,y),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(h,c));break;case"ZYX":this._y=Math.asin(-eo(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(A,y),this._z=Math.atan2(h,c)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(eo(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,p),this._y=Math.atan2(-m,c)):(this._x=0,this._y=Math.atan2(u,y));break;case"XZY":this._z=Math.asin(-eo(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(A,p),this._y=Math.atan2(u,c)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return KB.makeRotationFromQuaternion(t),this.setFromRotationMatrix(KB,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return $B.setFromEuler(this),this.setFromQuaternion($B,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})(),Gy=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},dq=0,JB=new Et,Mf=new io,el=new yi,dy=new Et,hg=new Et,fq=new Et,pq=new io,ZB=new Et(1,0,0),eO=new Et(0,1,0),tO=new Et(0,0,1),mq={type:"added"},gq={type:"removed"},mo=(()=>{class n extends cu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dq++}),this.uuid=mu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let t=new Et,i=new Pa,s=new io,o=new Et(1,1,1);function c(){s.setFromEuler(i,!1)}function l(){i.setFromQuaternion(s,void 0,!1)}i._onChange(c),s._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new yi},normalMatrix:{value:new $i}}),this.matrix=new yi,this.matrixWorld=new yi,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Gy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Mf.setFromAxisAngle(t,i),this.quaternion.multiply(Mf),this}rotateOnWorldAxis(t,i){return Mf.setFromAxisAngle(t,i),this.quaternion.premultiply(Mf),this}rotateX(t){return this.rotateOnAxis(ZB,t)}rotateY(t){return this.rotateOnAxis(eO,t)}rotateZ(t){return this.rotateOnAxis(tO,t)}translateOnAxis(t,i){return JB.copy(t).applyQuaternion(this.quaternion),this.position.add(JB.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(ZB,t)}translateY(t){return this.translateOnAxis(eO,t)}translateZ(t){return this.translateOnAxis(tO,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(el.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?dy.copy(t):dy.set(t,i,s);let o=this.parent;this.updateWorldMatrix(!0,!1),hg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?el.lookAt(hg,dy,this.up):el.lookAt(dy,hg,this.up),this.quaternion.setFromRotationMatrix(el),o&&(el.extractRotation(o.matrixWorld),Mf.setFromRotationMatrix(el),this.quaternion.premultiply(Mf.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mq)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}let i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(gq)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),el.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),el.multiply(t.parent.matrixWorld)),t.applyMatrix4(el),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,o=this.children.length;s<o;s++){let l=this.children[s].getObjectByProperty(t,i);if(l!==void 0)return l}}getObjectsByProperty(t,i,s=[]){this[t]===i&&s.push(this);let o=this.children;for(let c=0,l=o.length;c<l;c++)o[c].getObjectsByProperty(t,i,s);return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hg,t,fq),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hg,pq,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverseVisible(t)}traverseAncestors(t){let i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let i=this.children;for(let s=0,o=i.length;s<o;s++){let c=i[s];(c.matrixWorldAutoUpdate===!0||t===!0)&&c.updateMatrixWorld(t)}}updateWorldMatrix(t,i){let s=this.parent;if(t===!0&&s!==null&&s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){let o=this.children;for(let c=0,l=o.length;c<l;c++){let u=o[c];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(t){let i=t===void 0||typeof t=="string",s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),o.maxGeometryCount=this._maxGeometryCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function c(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(t)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=c(t.geometries,this.geometry);let u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){let h=u.shapes;if(Array.isArray(h))for(let p=0,f=h.length;p<f;p++){let m=h[p];c(t.shapes,m)}else c(t.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let u=[];for(let h=0,p=this.material.length;h<p;h++)u.push(c(t.materials,this.material[h]));o.material=u}else o.material=c(t.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){let h=this.animations[u];o.animations.push(c(t.animations,h))}}if(i){let u=l(t.geometries),h=l(t.materials),p=l(t.textures),f=l(t.images),m=l(t.shapes),A=l(t.skeletons),y=l(t.animations),E=l(t.nodes);u.length>0&&(s.geometries=u),h.length>0&&(s.materials=h),p.length>0&&(s.textures=p),f.length>0&&(s.images=f),m.length>0&&(s.shapes=m),A.length>0&&(s.skeletons=A),y.length>0&&(s.animations=y),E.length>0&&(s.nodes=E)}return s.object=o,s;function l(u){let h=[];for(let p in u){let f=u[p];delete f.metadata,h.push(f)}return h}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let s=0;s<t.children.length;s++){let o=t.children[s];this.add(o.clone())}return this}}return n.DEFAULT_UP=new Et(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})(),ec=new Et,tl=new Et,Iw=new Et,nl=new Et,wf=new Et,Cf=new Et,nO=new Et,Rw=new Et,Dw=new Et,Lw=new Et,fy=!1,Of=class n{constructor(e=new Et,t=new Et,i=new Et){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),ec.subVectors(e,t),s.cross(ec);let o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,t,i,s,o){ec.subVectors(s,t),tl.subVectors(i,t),Iw.subVectors(e,t);let c=ec.dot(ec),l=ec.dot(tl),u=ec.dot(Iw),h=tl.dot(tl),p=tl.dot(Iw),f=c*h-l*l;if(f===0)return o.set(-2,-1,-1);let m=1/f,A=(h*u-l*p)*m,y=(c*p-l*u)*m;return o.set(1-A-y,y,A)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,nl),nl.x>=0&&nl.y>=0&&nl.x+nl.y<=1}static getUV(e,t,i,s,o,c,l,u){return fy===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),fy=!0),this.getInterpolation(e,t,i,s,o,c,l,u)}static getInterpolation(e,t,i,s,o,c,l,u){return this.getBarycoord(e,t,i,s,nl),u.setScalar(0),u.addScaledVector(o,nl.x),u.addScaledVector(c,nl.y),u.addScaledVector(l,nl.z),u}static isFrontFacing(e,t,i,s){return ec.subVectors(i,t),tl.subVectors(e,t),ec.cross(tl).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ec.subVectors(this.c,this.b),tl.subVectors(this.a,this.b),ec.cross(tl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return n.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,s,o){return fy===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),fy=!0),n.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}getInterpolation(e,t,i,s,o){return n.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}containsPoint(e){return n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,s=this.b,o=this.c,c,l;wf.subVectors(s,i),Cf.subVectors(o,i),Rw.subVectors(e,i);let u=wf.dot(Rw),h=Cf.dot(Rw);if(u<=0&&h<=0)return t.copy(i);Dw.subVectors(e,s);let p=wf.dot(Dw),f=Cf.dot(Dw);if(p>=0&&f<=p)return t.copy(s);let m=u*f-p*h;if(m<=0&&u>=0&&p<=0)return c=u/(u-p),t.copy(i).addScaledVector(wf,c);Lw.subVectors(e,o);let A=wf.dot(Lw),y=Cf.dot(Lw);if(y>=0&&A<=y)return t.copy(o);let E=A*h-u*y;if(E<=0&&h>=0&&y<=0)return l=h/(h-y),t.copy(i).addScaledVector(Cf,l);let x=p*y-A*f;if(x<=0&&f-p>=0&&A-y>=0)return nO.subVectors(o,s),l=(f-p)/(f-p+(A-y)),t.copy(s).addScaledVector(nO,l);let v=1/(x+E+m);return c=E*v,l=m*v,t.copy(i).addScaledVector(wf,c).addScaledVector(Cf,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},nN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nu={h:0,s:0,l:0},py={h:0,s:0,l:0};Si=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){let s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=cs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Vr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,s=Vr.workingColorSpace){return this.r=e,this.g=t,this.b=i,Vr.toWorkingColorSpace(this,s),this}setHSL(e,t,i,s=Vr.workingColorSpace){if(e=BC(e,1),t=eo(t,0,1),i=eo(i,0,1),t===0)this.r=this.g=this.b=i;else{let o=i<=.5?i*(1+t):i+t-i*t,c=2*i-o;this.r=Pw(c,o,e+1/3),this.g=Pw(c,o,e),this.b=Pw(c,o,e-1/3)}return Vr.toWorkingColorSpace(this,s),this}setStyle(e,t=cs){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o,c=s[1],l=s[2];switch(c){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){let o=s[1],c=o.length;if(c===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(c===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=cs){let i=nN[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=kf(e.r),this.g=kf(e.g),this.b=kf(e.b),this}copyLinearToSRGB(e){return this.r=Ew(e.r),this.g=Ew(e.g),this.b=Ew(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=cs){return Vr.fromWorkingColorSpace(po.copy(this),e),Math.round(eo(po.r*255,0,255))*65536+Math.round(eo(po.g*255,0,255))*256+Math.round(eo(po.b*255,0,255))}getHexString(e=cs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Vr.workingColorSpace){Vr.fromWorkingColorSpace(po.copy(this),t);let i=po.r,s=po.g,o=po.b,c=Math.max(i,s,o),l=Math.min(i,s,o),u,h,p=(l+c)/2;if(l===c)u=0,h=0;else{let f=c-l;switch(h=p<=.5?f/(c+l):f/(2-c-l),c){case i:u=(s-o)/f+(s<o?6:0);break;case s:u=(o-i)/f+2;break;case o:u=(i-s)/f+4;break}u/=6}return e.h=u,e.s=h,e.l=p,e}getRGB(e,t=Vr.workingColorSpace){return Vr.fromWorkingColorSpace(po.copy(this),t),e.r=po.r,e.g=po.g,e.b=po.b,e}getStyle(e=cs){Vr.fromWorkingColorSpace(po.copy(this),e);let t=po.r,i=po.g,s=po.b;return e!==cs?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(nu),this.setHSL(nu.h+e,nu.s+t,nu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(nu),e.getHSL(py);let i=gg(nu.h,py.h,t),s=gg(nu.s,py.s,t),o=gg(nu.l,py.l,t);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*s,this.g=o[1]*t+o[4]*i+o[7]*s,this.b=o[2]*t+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},po=new Si;Si.NAMES=nN;Aq=0,dl=class extends cu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Aq++}),this.uuid=mu(),this.name="",this.type="Material",this.blending=Uf,this.side=au,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Xw,this.blendDst=qw,this.blendEquation=Lh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Si(0,0,0),this.blendAlpha=0,this.depthFunc=Ly,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=zB,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=vf,this.stencilZFail=vf,this.stencilZPass=vf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Uf&&(i.blending=this.blending),this.side!==au&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Xw&&(i.blendSrc=this.blendSrc),this.blendDst!==qw&&(i.blendDst=this.blendDst),this.blendEquation!==Lh&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ly&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==zB&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==vf&&(i.stencilFail=this.stencilFail),this.stencilZFail!==vf&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==vf&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){let c=[];for(let l in o){let u=o[l];delete u.metadata,c.push(u)}return c}if(t){let o=s(e.textures),c=s(e.images);o.length>0&&(i.textures=o),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let s=t.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Wy=class extends dl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Si(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=hx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},ys=new Et,my=new gr,Ia=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=GB,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=al,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)my.fromBufferAttribute(this,t),my.applyMatrix3(e),this.setXY(t,my.x,my.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyMatrix3(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyMatrix4(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyNormalMatrix(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.transformDirection(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Bf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Io(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Bf(t,this.array)),t}setX(e,t){return this.normalized&&(t=Io(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Bf(t,this.array)),t}setY(e,t){return this.normalized&&(t=Io(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Bf(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Io(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Bf(t,this.array)),t}setW(e,t){return this.normalized&&(t=Io(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Io(t,this.array),i=Io(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=Io(t,this.array),i=Io(i,this.array),s=Io(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e*=this.itemSize,this.normalized&&(t=Io(t,this.array),i=Io(i,this.array),s=Io(s,this.array),o=Io(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==GB&&(e.usage=this.usage),e}},Qf=class extends Ia{constructor(e,t,i){super(new Uint16Array(e),t,i)}},jy=class extends Ia{constructor(e,t,i){super(new Uint32Array(e),t,i)}},no=class extends Ia{constructor(e,t,i){super(new Float32Array(e),t,i)}},vq=0,wa=new yi,Bw=new mo,Sf=new Et,ca=new lu,dg=new lu,js=new Et,Ra=class n extends cu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:vq++}),this.uuid=mu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(tN(e)?jy:Qf)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let o=new $i().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}let s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wa.makeRotationFromQuaternion(e),this.applyMatrix4(wa),this}rotateX(e){return wa.makeRotationX(e),this.applyMatrix4(wa),this}rotateY(e){return wa.makeRotationY(e),this.applyMatrix4(wa),this}rotateZ(e){return wa.makeRotationZ(e),this.applyMatrix4(wa),this}translate(e,t,i){return wa.makeTranslation(e,t,i),this.applyMatrix4(wa),this}scale(e,t,i){return wa.makeScale(e,t,i),this.applyMatrix4(wa),this}lookAt(e){return Bw.lookAt(e),Bw.updateMatrix(),this.applyMatrix4(Bw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Sf).negate(),this.translate(Sf.x,Sf.y,Sf.z),this}setFromPoints(e){let t=[];for(let i=0,s=e.length;i<s;i++){let o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new no(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new lu);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Et(-1/0,-1/0,-1/0),new Et(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){let o=t[i];ca.setFromBufferAttribute(o),this.morphTargetsRelative?(js.addVectors(this.boundingBox.min,ca.min),this.boundingBox.expandByPoint(js),js.addVectors(this.boundingBox.max,ca.max),this.boundingBox.expandByPoint(js)):(this.boundingBox.expandByPoint(ca.min),this.boundingBox.expandByPoint(ca.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new uu);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Et,1/0);return}if(e){let i=this.boundingSphere.center;if(ca.setFromBufferAttribute(e),t)for(let o=0,c=t.length;o<c;o++){let l=t[o];dg.setFromBufferAttribute(l),this.morphTargetsRelative?(js.addVectors(ca.min,dg.min),ca.expandByPoint(js),js.addVectors(ca.max,dg.max),ca.expandByPoint(js)):(ca.expandByPoint(dg.min),ca.expandByPoint(dg.max))}ca.getCenter(i);let s=0;for(let o=0,c=e.count;o<c;o++)js.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(js));if(t)for(let o=0,c=t.length;o<c;o++){let l=t[o],u=this.morphTargetsRelative;for(let h=0,p=l.count;h<p;h++)js.fromBufferAttribute(l,h),u&&(Sf.fromBufferAttribute(e,h),js.add(Sf)),s=Math.max(s,i.distanceToSquared(js))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,s=t.position.array,o=t.normal.array,c=t.uv.array,l=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ia(new Float32Array(4*l),4));let u=this.getAttribute("tangent").array,h=[],p=[];for(let N=0;N<l;N++)h[N]=new Et,p[N]=new Et;let f=new Et,m=new Et,A=new Et,y=new gr,E=new gr,x=new gr,v=new Et,w=new Et;function M(N,X,$){f.fromArray(s,N*3),m.fromArray(s,X*3),A.fromArray(s,$*3),y.fromArray(c,N*2),E.fromArray(c,X*2),x.fromArray(c,$*2),m.sub(f),A.sub(f),E.sub(y),x.sub(y);let te=1/(E.x*x.y-x.x*E.y);isFinite(te)&&(v.copy(m).multiplyScalar(x.y).addScaledVector(A,-E.y).multiplyScalar(te),w.copy(A).multiplyScalar(E.x).addScaledVector(m,-x.x).multiplyScalar(te),h[N].add(v),h[X].add(v),h[$].add(v),p[N].add(w),p[X].add(w),p[$].add(w))}let T=this.groups;T.length===0&&(T=[{start:0,count:i.length}]);for(let N=0,X=T.length;N<X;++N){let $=T[N],te=$.start,U=$.count;for(let P=te,k=te+U;P<k;P+=3)M(i[P+0],i[P+1],i[P+2])}let D=new Et,L=new Et,I=new Et,F=new Et;function R(N){I.fromArray(o,N*3),F.copy(I);let X=h[N];D.copy(X),D.sub(I.multiplyScalar(I.dot(X))).normalize(),L.crossVectors(F,X);let te=L.dot(p[N])<0?-1:1;u[N*4]=D.x,u[N*4+1]=D.y,u[N*4+2]=D.z,u[N*4+3]=te}for(let N=0,X=T.length;N<X;++N){let $=T[N],te=$.start,U=$.count;for(let P=te,k=te+U;P<k;P+=3)R(i[P+0]),R(i[P+1]),R(i[P+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ia(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,A=i.count;m<A;m++)i.setXYZ(m,0,0,0);let s=new Et,o=new Et,c=new Et,l=new Et,u=new Et,h=new Et,p=new Et,f=new Et;if(e)for(let m=0,A=e.count;m<A;m+=3){let y=e.getX(m+0),E=e.getX(m+1),x=e.getX(m+2);s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,E),c.fromBufferAttribute(t,x),p.subVectors(c,o),f.subVectors(s,o),p.cross(f),l.fromBufferAttribute(i,y),u.fromBufferAttribute(i,E),h.fromBufferAttribute(i,x),l.add(p),u.add(p),h.add(p),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(E,u.x,u.y,u.z),i.setXYZ(x,h.x,h.y,h.z)}else for(let m=0,A=t.count;m<A;m+=3)s.fromBufferAttribute(t,m+0),o.fromBufferAttribute(t,m+1),c.fromBufferAttribute(t,m+2),p.subVectors(c,o),f.subVectors(s,o),p.cross(f),i.setXYZ(m+0,p.x,p.y,p.z),i.setXYZ(m+1,p.x,p.y,p.z),i.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)js.fromBufferAttribute(e,t),js.normalize(),e.setXYZ(t,js.x,js.y,js.z)}toNonIndexed(){function e(l,u){let h=l.array,p=l.itemSize,f=l.normalized,m=new h.constructor(u.length*p),A=0,y=0;for(let E=0,x=u.length;E<x;E++){l.isInterleavedBufferAttribute?A=u[E]*l.data.stride+l.offset:A=u[E]*p;for(let v=0;v<p;v++)m[y++]=h[A++]}return new Ia(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new n,i=this.index.array,s=this.attributes;for(let l in s){let u=s[l],h=e(u,i);t.setAttribute(l,h)}let o=this.morphAttributes;for(let l in o){let u=[],h=o[l];for(let p=0,f=h.length;p<f;p++){let m=h[p],A=e(m,i);u.push(A)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;let c=this.groups;for(let l=0,u=c.length;l<u;l++){let h=c[l];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let u=this.parameters;for(let h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let u in i){let h=i[u];e.data.attributes[u]=h.toJSON(e.data)}let s={},o=!1;for(let u in this.morphAttributes){let h=this.morphAttributes[u],p=[];for(let f=0,m=h.length;f<m;f++){let A=h[f];p.push(A.toJSON(e.data))}p.length>0&&(s[u]=p,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);let c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));let l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let s=e.attributes;for(let h in s){let p=s[h];this.setAttribute(h,p.clone(t))}let o=e.morphAttributes;for(let h in o){let p=[],f=o[h];for(let m=0,A=f.length;m<A;m++)p.push(f[m].clone(t));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;let c=e.groups;for(let h=0,p=c.length;h<p;h++){let f=c[h];this.addGroup(f.start,f.count,f.materialIndex)}let l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},iO=new yi,Ih=new bg,gy=new uu,rO=new Et,Tf=new Et,If=new Et,Rf=new Et,Ow=new Et,Ay=new Et,vy=new gr,yy=new gr,xy=new gr,sO=new Et,oO=new Et,aO=new Et,Ey=new Et,_y=new Et,la=class extends mo{constructor(e=new Ra,t=new Wy){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,c=s.length;o<c;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,t){let i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,c=i.morphTargetsRelative;t.fromBufferAttribute(s,e);let l=this.morphTargetInfluences;if(o&&l){Ay.set(0,0,0);for(let u=0,h=o.length;u<h;u++){let p=l[u],f=o[u];p!==0&&(Ow.fromBufferAttribute(f,e),c?Ay.addScaledVector(Ow,p):Ay.addScaledVector(Ow.sub(t),p))}t.add(Ay)}return t}raycast(e,t){let i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),gy.copy(i.boundingSphere),gy.applyMatrix4(o),Ih.copy(e.ray).recast(e.near),!(gy.containsPoint(Ih.origin)===!1&&(Ih.intersectSphere(gy,rO)===null||Ih.origin.distanceToSquared(rO)>(e.far-e.near)**2))&&(iO.copy(o).invert(),Ih.copy(e.ray).applyMatrix4(iO),!(i.boundingBox!==null&&Ih.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Ih)))}_computeIntersections(e,t,i){let s,o=this.geometry,c=this.material,l=o.index,u=o.attributes.position,h=o.attributes.uv,p=o.attributes.uv1,f=o.attributes.normal,m=o.groups,A=o.drawRange;if(l!==null)if(Array.isArray(c))for(let y=0,E=m.length;y<E;y++){let x=m[y],v=c[x.materialIndex],w=Math.max(x.start,A.start),M=Math.min(l.count,Math.min(x.start+x.count,A.start+A.count));for(let T=w,D=M;T<D;T+=3){let L=l.getX(T),I=l.getX(T+1),F=l.getX(T+2);s=by(this,v,e,i,h,p,f,L,I,F),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=x.materialIndex,t.push(s))}}else{let y=Math.max(0,A.start),E=Math.min(l.count,A.start+A.count);for(let x=y,v=E;x<v;x+=3){let w=l.getX(x),M=l.getX(x+1),T=l.getX(x+2);s=by(this,c,e,i,h,p,f,w,M,T),s&&(s.faceIndex=Math.floor(x/3),t.push(s))}}else if(u!==void 0)if(Array.isArray(c))for(let y=0,E=m.length;y<E;y++){let x=m[y],v=c[x.materialIndex],w=Math.max(x.start,A.start),M=Math.min(u.count,Math.min(x.start+x.count,A.start+A.count));for(let T=w,D=M;T<D;T+=3){let L=T,I=T+1,F=T+2;s=by(this,v,e,i,h,p,f,L,I,F),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=x.materialIndex,t.push(s))}}else{let y=Math.max(0,A.start),E=Math.min(u.count,A.start+A.count);for(let x=y,v=E;x<v;x+=3){let w=x,M=x+1,T=x+2;s=by(this,c,e,i,h,p,f,w,M,T),s&&(s.faceIndex=Math.floor(x/3),t.push(s))}}}};Mg=class n extends Ra{constructor(e=1,t=1,i=1,s=1,o=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:o,depthSegments:c};let l=this;s=Math.floor(s),o=Math.floor(o),c=Math.floor(c);let u=[],h=[],p=[],f=[],m=0,A=0;y("z","y","x",-1,-1,i,t,e,c,o,0),y("z","y","x",1,-1,i,t,-e,c,o,1),y("x","z","y",1,1,e,i,t,s,c,2),y("x","z","y",1,-1,e,i,-t,s,c,3),y("x","y","z",1,-1,e,t,i,s,o,4),y("x","y","z",-1,-1,e,t,-i,s,o,5),this.setIndex(u),this.setAttribute("position",new no(h,3)),this.setAttribute("normal",new no(p,3)),this.setAttribute("uv",new no(f,2));function y(E,x,v,w,M,T,D,L,I,F,R){let N=T/I,X=D/F,$=T/2,te=D/2,U=L/2,P=I+1,k=F+1,z=0,Q=0,Z=new Et;for(let ce=0;ce<k;ce++){let Me=ce*X-te;for(let xe=0;xe<P;xe++){let be=xe*N-$;Z[E]=be*w,Z[x]=Me*M,Z[v]=U,h.push(Z.x,Z.y,Z.z),Z[E]=0,Z[x]=0,Z[v]=L>0?1:-1,p.push(Z.x,Z.y,Z.z),f.push(xe/I),f.push(1-ce/F),z+=1}}for(let ce=0;ce<F;ce++)for(let Me=0;Me<I;Me++){let xe=m+Me+P*ce,be=m+Me+P*(ce+1),Fe=m+(Me+1)+P*(ce+1),Ze=m+(Me+1)+P*ce;u.push(xe,be,Ze),u.push(be,Fe,Ze),Q+=6}l.addGroup(A,Q,R),A+=Q,m+=z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};Eq={clone:Xf,merge:Ro},_q=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,bq=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,fl=class extends dl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=_q,this.fragmentShader=bq,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xf(e.uniforms),this.uniformsGroups=xq(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let s in this.uniforms){let c=this.uniforms[s].value;c&&c.isTexture?t.uniforms[s]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?t.uniforms[s]={type:"c",value:c.getHex()}:c&&c.isVector2?t.uniforms[s]={type:"v2",value:c.toArray()}:c&&c.isVector3?t.uniforms[s]={type:"v3",value:c.toArray()}:c&&c.isVector4?t.uniforms[s]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?t.uniforms[s]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?t.uniforms[s]={type:"m4",value:c.toArray()}:t.uniforms[s]={value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},Qy=class extends mo{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new yi,this.projectionMatrix=new yi,this.projectionMatrixInverse=new yi,this.coordinateSystem=cl}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},to=class extends Qy{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=jf*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(mg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jf*2*Math.atan(Math.tan(mg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,s,o,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(mg*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,o=-.5*s,c=this.view;if(this.view!==null&&this.view.enabled){let u=c.fullWidth,h=c.fullHeight;o+=c.offsetX*s/u,t-=c.offsetY*i/h,s*=c.width/u,i*=c.height/h}let l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Df=-90,Lf=1,tC=class extends mo{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let s=new to(Df,Lf,e,t);s.layers=this.layers,this.add(s);let o=new to(Df,Lf,e,t);o.layers=this.layers,this.add(o);let c=new to(Df,Lf,e,t);c.layers=this.layers,this.add(c);let l=new to(Df,Lf,e,t);l.layers=this.layers,this.add(l);let u=new to(Df,Lf,e,t);u.layers=this.layers,this.add(u);let h=new to(Df,Lf,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,s,o,c,l,u]=t;for(let h of t)this.remove(h);if(e===cl)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===Uy)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[o,c,l,u,h,p]=this.children,f=e.getRenderTarget(),m=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;let E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,o),e.setRenderTarget(i,1,s),e.render(t,c),e.setRenderTarget(i,2,s),e.render(t,l),e.setRenderTarget(i,3,s),e.render(t,u),e.setRenderTarget(i,4,s),e.render(t,h),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,s),e.render(t,p),e.setRenderTarget(f,m,A),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}},Xy=class extends La{constructor(e,t,i,s,o,c,l,u,h,p){e=e!==void 0?e:[],t=t!==void 0?t:Hf,super(e,t,i,s,o,c,l,u,h,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},nC=class extends hl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];t.encoding!==void 0&&(Ag("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Nh?cs:Ta),this.texture=new Xy(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ca}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Mg(5,5,5),o=new fl({name:"CubemapFromEquirect",uniforms:Xf(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Wo,blending:ru});o.uniforms.tEquirect.value=t;let c=new la(s,o),l=t.minFilter;return t.minFilter===xg&&(t.minFilter=Ca),new tC(1,10,this).update(e,c),t.minFilter=l,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,i,s){let o=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,i,s);e.setRenderTarget(o)}},Nw=new Et,Mq=new Et,wq=new $i,sl=class{constructor(e=new Et(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let s=Nw.subVectors(i,t).cross(Mq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta(Nw),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||wq.getNormalMatrix(e),s=this.coplanarPoint(Nw).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Rh=new uu,My=new Et,wg=class{constructor(e=new sl,t=new sl,i=new sl,s=new sl,o=new sl,c=new sl){this.planes=[e,t,i,s,o,c]}set(e,t,i,s,o,c){let l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(c),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=cl){let i=this.planes,s=e.elements,o=s[0],c=s[1],l=s[2],u=s[3],h=s[4],p=s[5],f=s[6],m=s[7],A=s[8],y=s[9],E=s[10],x=s[11],v=s[12],w=s[13],M=s[14],T=s[15];if(i[0].setComponents(u-o,m-h,x-A,T-v).normalize(),i[1].setComponents(u+o,m+h,x+A,T+v).normalize(),i[2].setComponents(u+c,m+p,x+y,T+w).normalize(),i[3].setComponents(u-c,m-p,x-y,T-w).normalize(),i[4].setComponents(u-l,m-f,x-E,T-M).normalize(),t===cl)i[5].setComponents(u+l,m+f,x+E,T+M).normalize();else if(t===Uy)i[5].setComponents(l,f,E,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Rh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Rh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Rh)}intersectsSprite(e){return Rh.center.set(0,0,0),Rh.radius=.7071067811865476,Rh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Rh)}intersectsSphere(e){let t=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let s=t[i];if(My.x=s.normal.x>0?e.max.x:e.min.x,My.y=s.normal.y>0?e.max.y:e.min.y,My.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(My)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};iC=class n extends Ra{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};let o=e/2,c=t/2,l=Math.floor(i),u=Math.floor(s),h=l+1,p=u+1,f=e/l,m=t/u,A=[],y=[],E=[],x=[];for(let v=0;v<p;v++){let w=v*m-c;for(let M=0;M<h;M++){let T=M*f-o;y.push(T,-w,0),E.push(0,0,1),x.push(M/l),x.push(1-v/u)}}for(let v=0;v<u;v++)for(let w=0;w<l;w++){let M=w+h*v,T=w+h*(v+1),D=w+1+h*(v+1),L=w+1+h*v;A.push(M,T,L),A.push(T,D,L)}this.setIndex(A),this.setAttribute("position",new no(y,3)),this.setAttribute("normal",new no(E,3)),this.setAttribute("uv",new no(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}},Sq=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Tq=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Iq=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Rq=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Dq=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Lq=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Pq=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Bq=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Oq=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Nq=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,Fq=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Uq=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,kq=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Vq=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Hq=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,zq=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Gq=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Wq=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,jq=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Qq=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Xq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,qq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Yq=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Kq=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,$q=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Jq=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Zq=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,eY=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,tY=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,nY=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,iY="gl_FragColor = linearToOutputTexel( gl_FragColor );",rY=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,sY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,oY=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,aY=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,cY=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,lY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,uY=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,hY=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,dY=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fY=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,pY=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,mY=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,gY=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,AY=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,vY=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,yY=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,xY=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,EY=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,_Y=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,bY=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,MY=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,wY=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,CY=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,SY=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,TY=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,IY=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,RY=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,DY=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,LY=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,PY=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,BY=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,OY=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,NY=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,FY=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,UY=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,kY=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,VY=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,HY=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,zY=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,GY=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,WY=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,jY=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,QY=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,XY=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,qY=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,YY=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,KY=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,$Y=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,JY=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,ZY=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,eK=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,tK=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,nK=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,iK=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,rK=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,sK=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,oK=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,aK=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,cK=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,lK=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,uK=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,hK=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,dK=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,fK=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,pK=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,mK=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,gK=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,AK=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,vK=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,yK=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,xK=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,EK=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,_K=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,bK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,MK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,wK=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,CK=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,SK=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,IK=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,DK=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,LK=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,PK=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,BK=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,OK=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,NK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,FK=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,UK=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,kK=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,VK=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,HK=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zK=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GK=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WK=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,jK=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QK=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,XK=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,qK=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YK=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,KK=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,$K=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JK=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ZK=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,e$=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,t$=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,n$=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,i$=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,r$=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,s$=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ki={alphahash_fragment:Sq,alphahash_pars_fragment:Tq,alphamap_fragment:Iq,alphamap_pars_fragment:Rq,alphatest_fragment:Dq,alphatest_pars_fragment:Lq,aomap_fragment:Pq,aomap_pars_fragment:Bq,batching_pars_vertex:Oq,batching_vertex:Nq,begin_vertex:Fq,beginnormal_vertex:Uq,bsdfs:kq,iridescence_fragment:Vq,bumpmap_pars_fragment:Hq,clipping_planes_fragment:zq,clipping_planes_pars_fragment:Gq,clipping_planes_pars_vertex:Wq,clipping_planes_vertex:jq,color_fragment:Qq,color_pars_fragment:Xq,color_pars_vertex:qq,color_vertex:Yq,common:Kq,cube_uv_reflection_fragment:$q,defaultnormal_vertex:Jq,displacementmap_pars_vertex:Zq,displacementmap_vertex:eY,emissivemap_fragment:tY,emissivemap_pars_fragment:nY,colorspace_fragment:iY,colorspace_pars_fragment:rY,envmap_fragment:sY,envmap_common_pars_fragment:oY,envmap_pars_fragment:aY,envmap_pars_vertex:cY,envmap_physical_pars_fragment:xY,envmap_vertex:lY,fog_vertex:uY,fog_pars_vertex:hY,fog_fragment:dY,fog_pars_fragment:fY,gradientmap_pars_fragment:pY,lightmap_fragment:mY,lightmap_pars_fragment:gY,lights_lambert_fragment:AY,lights_lambert_pars_fragment:vY,lights_pars_begin:yY,lights_toon_fragment:EY,lights_toon_pars_fragment:_Y,lights_phong_fragment:bY,lights_phong_pars_fragment:MY,lights_physical_fragment:wY,lights_physical_pars_fragment:CY,lights_fragment_begin:SY,lights_fragment_maps:TY,lights_fragment_end:IY,logdepthbuf_fragment:RY,logdepthbuf_pars_fragment:DY,logdepthbuf_pars_vertex:LY,logdepthbuf_vertex:PY,map_fragment:BY,map_pars_fragment:OY,map_particle_fragment:NY,map_particle_pars_fragment:FY,metalnessmap_fragment:UY,metalnessmap_pars_fragment:kY,morphcolor_vertex:VY,morphnormal_vertex:HY,morphtarget_pars_vertex:zY,morphtarget_vertex:GY,normal_fragment_begin:WY,normal_fragment_maps:jY,normal_pars_fragment:QY,normal_pars_vertex:XY,normal_vertex:qY,normalmap_pars_fragment:YY,clearcoat_normal_fragment_begin:KY,clearcoat_normal_fragment_maps:$Y,clearcoat_pars_fragment:JY,iridescence_pars_fragment:ZY,opaque_fragment:eK,packing:tK,premultiplied_alpha_fragment:nK,project_vertex:iK,dithering_fragment:rK,dithering_pars_fragment:sK,roughnessmap_fragment:oK,roughnessmap_pars_fragment:aK,shadowmap_pars_fragment:cK,shadowmap_pars_vertex:lK,shadowmap_vertex:uK,shadowmask_pars_fragment:hK,skinbase_vertex:dK,skinning_pars_vertex:fK,skinning_vertex:pK,skinnormal_vertex:mK,specularmap_fragment:gK,specularmap_pars_fragment:AK,tonemapping_fragment:vK,tonemapping_pars_fragment:yK,transmission_fragment:xK,transmission_pars_fragment:EK,uv_pars_fragment:_K,uv_pars_vertex:bK,uv_vertex:MK,worldpos_vertex:wK,background_vert:CK,background_frag:SK,backgroundCube_vert:TK,backgroundCube_frag:IK,cube_vert:RK,cube_frag:DK,depth_vert:LK,depth_frag:PK,distanceRGBA_vert:BK,distanceRGBA_frag:OK,equirect_vert:NK,equirect_frag:FK,linedashed_vert:UK,linedashed_frag:kK,meshbasic_vert:VK,meshbasic_frag:HK,meshlambert_vert:zK,meshlambert_frag:GK,meshmatcap_vert:WK,meshmatcap_frag:jK,meshnormal_vert:QK,meshnormal_frag:XK,meshphong_vert:qK,meshphong_frag:YK,meshphysical_vert:KK,meshphysical_frag:$K,meshtoon_vert:JK,meshtoon_frag:ZK,points_vert:e$,points_frag:t$,shadow_vert:n$,shadow_frag:i$,sprite_vert:r$,sprite_frag:s$},Un={common:{diffuse:{value:new Si(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new $i},alphaMap:{value:null},alphaMapTransform:{value:new $i},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new $i}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new $i}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new $i}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new $i},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new $i},normalScale:{value:new gr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new $i},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new $i}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new $i}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new $i}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Si(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Si(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new $i},alphaTest:{value:0},uvTransform:{value:new $i}},sprite:{diffuse:{value:new Si(16777215)},opacity:{value:1},center:{value:new gr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new $i},alphaMap:{value:null},alphaMapTransform:{value:new $i},alphaTest:{value:0}}},Cc={basic:{uniforms:Ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.fog]),vertexShader:Ki.meshbasic_vert,fragmentShader:Ki.meshbasic_frag},lambert:{uniforms:Ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Si(0)}}]),vertexShader:Ki.meshlambert_vert,fragmentShader:Ki.meshlambert_frag},phong:{uniforms:Ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Si(0)},specular:{value:new Si(1118481)},shininess:{value:30}}]),vertexShader:Ki.meshphong_vert,fragmentShader:Ki.meshphong_frag},standard:{uniforms:Ro([Un.common,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.roughnessmap,Un.metalnessmap,Un.fog,Un.lights,{emissive:{value:new Si(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ki.meshphysical_vert,fragmentShader:Ki.meshphysical_frag},toon:{uniforms:Ro([Un.common,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.gradientmap,Un.fog,Un.lights,{emissive:{value:new Si(0)}}]),vertexShader:Ki.meshtoon_vert,fragmentShader:Ki.meshtoon_frag},matcap:{uniforms:Ro([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,{matcap:{value:null}}]),vertexShader:Ki.meshmatcap_vert,fragmentShader:Ki.meshmatcap_frag},points:{uniforms:Ro([Un.points,Un.fog]),vertexShader:Ki.points_vert,fragmentShader:Ki.points_frag},dashed:{uniforms:Ro([Un.common,Un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ki.linedashed_vert,fragmentShader:Ki.linedashed_frag},depth:{uniforms:Ro([Un.common,Un.displacementmap]),vertexShader:Ki.depth_vert,fragmentShader:Ki.depth_frag},normal:{uniforms:Ro([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,{opacity:{value:1}}]),vertexShader:Ki.meshnormal_vert,fragmentShader:Ki.meshnormal_frag},sprite:{uniforms:Ro([Un.sprite,Un.fog]),vertexShader:Ki.sprite_vert,fragmentShader:Ki.sprite_frag},background:{uniforms:{uvTransform:{value:new $i},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ki.background_vert,fragmentShader:Ki.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ki.backgroundCube_vert,fragmentShader:Ki.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ki.cube_vert,fragmentShader:Ki.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ki.equirect_vert,fragmentShader:Ki.equirect_frag},distanceRGBA:{uniforms:Ro([Un.common,Un.displacementmap,{referencePosition:{value:new Et},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ki.distanceRGBA_vert,fragmentShader:Ki.distanceRGBA_frag},shadow:{uniforms:Ro([Un.lights,Un.fog,{color:{value:new Si(0)},opacity:{value:1}}]),vertexShader:Ki.shadow_vert,fragmentShader:Ki.shadow_frag}};Cc.physical={uniforms:Ro([Cc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new $i},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new $i},clearcoatNormalScale:{value:new gr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new $i},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new $i},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new $i},sheen:{value:0},sheenColor:{value:new Si(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new $i},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new $i},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new $i},transmissionSamplerSize:{value:new gr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new $i},attenuationDistance:{value:0},attenuationColor:{value:new Si(0)},specularColor:{value:new Si(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new $i},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new $i},anisotropyVector:{value:new gr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new $i}}]),vertexShader:Ki.meshphysical_vert,fragmentShader:Ki.meshphysical_frag};wy={r:0,b:0,g:0};qf=class extends Qy{constructor(e=-1,t=1,i=1,s=-1,o=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=o,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,o,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,o=i-e,c=i+e,l=s+t,u=s-t;if(this.view!==null&&this.view.enabled){let h=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,c=o+h*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(o,c,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Nf=4,cO=[.125,.215,.35,.446,.526,.582],Ph=20,Fw=new qf,lO=new Si,Uw=null,kw=0,Vw=0,Dh=(1+Math.sqrt(5))/2,Pf=1/Dh,uO=[new Et(1,1,1),new Et(-1,1,1),new Et(1,1,-1),new Et(-1,1,-1),new Et(0,Dh,Pf),new Et(0,Dh,-Pf),new Et(Pf,0,Dh),new Et(-Pf,0,Dh),new Et(Dh,Pf,0),new Et(-Dh,Pf,0)],qy=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100){Uw=this._renderer.getRenderTarget(),kw=this._renderer.getActiveCubeFace(),Vw=this._renderer.getActiveMipmapLevel(),this._setSize(256);let o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,s,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=fO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=dO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Uw,kw,Vw),e.scissorTest=!1,Cy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Hf||e.mapping===zf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Uw=this._renderer.getRenderTarget(),kw=this._renderer.getActiveCubeFace(),Vw=this._renderer.getActiveMipmapLevel();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ca,minFilter:Ca,generateMipmaps:!1,type:Eg,format:Sa,colorSpace:ul,depthBuffer:!1},s=hO(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=hO(e,t,i);let{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=d$(o)),this._blurMaterial=f$(o,e,t)}return s}_compileMaterial(e){let t=new la(this._lodPlanes[0],e);this._renderer.compile(t,Fw)}_sceneToCubeUV(e,t,i,s){let l=new to(90,1,t,i),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],p=this._renderer,f=p.autoClear,m=p.toneMapping;p.getClearColor(lO),p.toneMapping=su,p.autoClear=!1;let A=new Wy({name:"PMREM.Background",side:Wo,depthWrite:!1,depthTest:!1}),y=new la(new Mg,A),E=!1,x=e.background;x?x.isColor&&(A.color.copy(x),e.background=null,E=!0):(A.color.copy(lO),E=!0);for(let v=0;v<6;v++){let w=v%3;w===0?(l.up.set(0,u[v],0),l.lookAt(h[v],0,0)):w===1?(l.up.set(0,0,u[v]),l.lookAt(0,h[v],0)):(l.up.set(0,u[v],0),l.lookAt(0,0,h[v]));let M=this._cubeSize;Cy(s,w*M,v>2?M:0,M,M),p.setRenderTarget(s),E&&p.render(y,l),p.render(e,l)}y.geometry.dispose(),y.material.dispose(),p.toneMapping=m,p.autoClear=f,e.background=x}_textureToCubeUV(e,t){let i=this._renderer,s=e.mapping===Hf||e.mapping===zf;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=fO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=dO());let o=s?this._cubemapMaterial:this._equirectMaterial,c=new la(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;let u=this._cubeSize;Cy(t,0,0,3*u,2*u),i.setRenderTarget(t),i.render(c,Fw)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),c=uO[(s-1)%uO.length];this._blur(e,s-1,s,o,c)}t.autoClear=i}_blur(e,t,i,s,o){let c=this._pingPongRenderTarget;this._halfBlur(e,c,t,i,s,"latitudinal",o),this._halfBlur(c,e,i,i,s,"longitudinal",o)}_halfBlur(e,t,i,s,o,c,l){let u=this._renderer,h=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let p=3,f=new la(this._lodPlanes[s],h),m=h.uniforms,A=this._sizeLods[i]-1,y=isFinite(o)?Math.PI/(2*A):2*Math.PI/(2*Ph-1),E=o/y,x=isFinite(o)?1+Math.floor(p*E):Ph;x>Ph&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Ph}`);let v=[],w=0;for(let I=0;I<Ph;++I){let F=I/E,R=Math.exp(-F*F/2);v.push(R),I===0?w+=R:I<x&&(w+=2*R)}for(let I=0;I<v.length;I++)v[I]=v[I]/w;m.envMap.value=e.texture,m.samples.value=x,m.weights.value=v,m.latitudinal.value=c==="latitudinal",l&&(m.poleAxis.value=l);let{_lodMax:M}=this;m.dTheta.value=y,m.mipInt.value=M-i;let T=this._sizeLods[s],D=3*T*(s>M-Nf?s-M+Nf:0),L=4*(this._cubeSize-T);Cy(t,D,L,3*T,2*T),u.setRenderTarget(t),u.render(f,Fw)}};Yy=class extends La{constructor(e,t,i,s,o,c,l,u,h,p){if(p=p!==void 0?p:Oh,p!==Oh&&p!==Wf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===Oh&&(i=iu),i===void 0&&p===Wf&&(i=Bh),super(null,s,o,c,l,u,p,i,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:Zs,this.minFilter=u!==void 0?u:Zs,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},sN=new La,oN=new Yy(1,1);oN.compareFunction=eN;aN=new zy,cN=new eC,lN=new Xy,pO=[],mO=[],gO=new Float32Array(16),AO=new Float32Array(9),vO=new Float32Array(4);rC=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=z$(t.type)}},sC=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=cJ(t.type)}},oC=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let s=this.seq;for(let o=0,c=s.length;o!==c;++o){let l=s[o];l.setValue(e,t[l.id],i)}}},Hw=/(\w+)(\])?(\[|\.)?/g;Vf=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){let o=e.getActiveUniform(t,s),c=e.getUniformLocation(t,o.name);lJ(o,c,this)}}setValue(e,t,i,s){let o=this.map[t];o!==void 0&&o.setValue(e,i,s)}setOptional(e,t,i){let s=t[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let o=0,c=t.length;o!==c;++o){let l=t[o],u=i[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,s)}}static seqWithValue(e,t){let i=[];for(let s=0,o=e.length;s!==o;++s){let c=e[s];c.id in t&&i.push(c)}return i}};uJ=37297,hJ=0;yJ=/^[ \t]*#include +<([\w\d./]+)>/gm;xJ=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);_J=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;RJ=0,cC=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(t),o=this._getShaderStage(i),c=this._getShaderCacheForMaterial(e);return c.has(s)===!1&&(c.add(s),s.usedTimes++),c.has(o)===!1&&(c.add(o),o.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new lC(e),t.set(e,i)),i}},lC=class{constructor(e){this.id=RJ++,this.code=e,this.usedTimes=0}};FJ=0;uC=class extends dl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=OX,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},hC=class extends dl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},HJ=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,zJ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;dC=class extends to{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},ll=class extends mo{constructor(){super(),this.isGroup=!0,this.type="Group"}},XJ={type:"move"},vg=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ll,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ll,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Et,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Et),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ll,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Et,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Et),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let s=null,o=null,c=null,l=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){c=!0;for(let E of e.hand.values()){let x=t.getJointPose(E,i),v=this._getHandJoint(h,E);x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=x.radius),v.visible=x!==null}let p=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],m=p.position.distanceTo(f.position),A=.02,y=.005;h.inputState.pinching&&m>A+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=A-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(s=t.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(XJ)))}return l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),h!==null&&(h.visible=c!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new ll;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},fC=class extends cu{constructor(e,t){super();let i=this,s=null,o=1,c=null,l="local-floor",u=1,h=null,p=null,f=null,m=null,A=null,y=null,E=t.getContextAttributes(),x=null,v=null,w=[],M=[],T=new gr,D=null,L=new to;L.layers.enable(1),L.viewport=new br;let I=new to;I.layers.enable(2),I.viewport=new br;let F=[L,I],R=new dC;R.layers.enable(1),R.layers.enable(2);let N=null,X=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new vg,w[be]=Fe),Fe.getTargetRaySpace()},this.getControllerGrip=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new vg,w[be]=Fe),Fe.getGripSpace()},this.getHand=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new vg,w[be]=Fe),Fe.getHandSpace()};function $(be){let Fe=M.indexOf(be.inputSource);if(Fe===-1)return;let Ze=w[Fe];Ze!==void 0&&(Ze.update(be.inputSource,be.frame,h||c),Ze.dispatchEvent({type:be.type,data:be.inputSource}))}function te(){s.removeEventListener("select",$),s.removeEventListener("selectstart",$),s.removeEventListener("selectend",$),s.removeEventListener("squeeze",$),s.removeEventListener("squeezestart",$),s.removeEventListener("squeezeend",$),s.removeEventListener("end",te),s.removeEventListener("inputsourceschange",U);for(let be=0;be<w.length;be++){let Fe=M[be];Fe!==null&&(M[be]=null,w[be].disconnect(Fe))}N=null,X=null,e.setRenderTarget(x),A=null,m=null,f=null,s=null,v=null,xe.stop(),i.isPresenting=!1,e.setPixelRatio(D),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(be){o=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(be){l=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||c},this.setReferenceSpace=function(be){h=be},this.getBaseLayer=function(){return m!==null?m:A},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return s},this.setSession=function(be){return So(this,null,function*(){if(s=be,s!==null){if(x=e.getRenderTarget(),s.addEventListener("select",$),s.addEventListener("selectstart",$),s.addEventListener("selectend",$),s.addEventListener("squeeze",$),s.addEventListener("squeezestart",$),s.addEventListener("squeezeend",$),s.addEventListener("end",te),s.addEventListener("inputsourceschange",U),E.xrCompatible!==!0&&(yield t.makeXRCompatible()),D=e.getPixelRatio(),e.getSize(T),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let Fe={antialias:s.renderState.layers===void 0?E.antialias:!0,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:o};A=new XRWebGLLayer(s,t,Fe),s.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),v=new hl(A.framebufferWidth,A.framebufferHeight,{format:Sa,type:ou,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil})}else{let Fe=null,Ze=null,ut=null;E.depth&&(ut=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Fe=E.stencil?Wf:Oh,Ze=E.stencil?Bh:iu);let it={colorFormat:t.RGBA8,depthFormat:ut,scaleFactor:o};f=new XRWebGLBinding(s,t),m=f.createProjectionLayer(it),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),v=new hl(m.textureWidth,m.textureHeight,{format:Sa,type:ou,depthTexture:new Yy(m.textureWidth,m.textureHeight,Ze,void 0,void 0,void 0,void 0,void 0,void 0,Fe),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0});let gt=e.properties.get(v);gt.__ignoreDepthValues=m.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(u),h=null,c=yield s.requestReferenceSpace(l),xe.setContext(s),xe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function U(be){for(let Fe=0;Fe<be.removed.length;Fe++){let Ze=be.removed[Fe],ut=M.indexOf(Ze);ut>=0&&(M[ut]=null,w[ut].disconnect(Ze))}for(let Fe=0;Fe<be.added.length;Fe++){let Ze=be.added[Fe],ut=M.indexOf(Ze);if(ut===-1){for(let gt=0;gt<w.length;gt++)if(gt>=M.length){M.push(Ze),ut=gt;break}else if(M[gt]===null){M[gt]=Ze,ut=gt;break}if(ut===-1)break}let it=w[ut];it&&it.connect(Ze)}}let P=new Et,k=new Et;function z(be,Fe,Ze){P.setFromMatrixPosition(Fe.matrixWorld),k.setFromMatrixPosition(Ze.matrixWorld);let ut=P.distanceTo(k),it=Fe.projectionMatrix.elements,gt=Ze.projectionMatrix.elements,Rt=it[14]/(it[10]-1),It=it[14]/(it[10]+1),Ft=(it[9]+1)/it[5],Ne=(it[9]-1)/it[5],pn=(it[8]-1)/it[0],St=(gt[8]+1)/gt[0],Vt=Rt*pn,Ot=Rt*St,xn=ut/(-pn+St),Jt=xn*-pn;Fe.matrixWorld.decompose(be.position,be.quaternion,be.scale),be.translateX(Jt),be.translateZ(xn),be.matrixWorld.compose(be.position,be.quaternion,be.scale),be.matrixWorldInverse.copy(be.matrixWorld).invert();let Oe=Rt+xn,Ie=It+xn,yt=Vt-Jt,kt=Ot+(ut-Jt),De=Ft*It/Ie*Oe,he=Ne*It/Ie*Oe;be.projectionMatrix.makePerspective(yt,kt,De,he,Oe,Ie),be.projectionMatrixInverse.copy(be.projectionMatrix).invert()}function Q(be,Fe){Fe===null?be.matrixWorld.copy(be.matrix):be.matrixWorld.multiplyMatrices(Fe.matrixWorld,be.matrix),be.matrixWorldInverse.copy(be.matrixWorld).invert()}this.updateCamera=function(be){if(s===null)return;R.near=I.near=L.near=be.near,R.far=I.far=L.far=be.far,(N!==R.near||X!==R.far)&&(s.updateRenderState({depthNear:R.near,depthFar:R.far}),N=R.near,X=R.far);let Fe=be.parent,Ze=R.cameras;Q(R,Fe);for(let ut=0;ut<Ze.length;ut++)Q(Ze[ut],Fe);Ze.length===2?z(R,L,I):R.projectionMatrix.copy(L.projectionMatrix),Z(be,R,Fe)};function Z(be,Fe,Ze){Ze===null?be.matrix.copy(Fe.matrixWorld):(be.matrix.copy(Ze.matrixWorld),be.matrix.invert(),be.matrix.multiply(Fe.matrixWorld)),be.matrix.decompose(be.position,be.quaternion,be.scale),be.updateMatrixWorld(!0),be.projectionMatrix.copy(Fe.projectionMatrix),be.projectionMatrixInverse.copy(Fe.projectionMatrixInverse),be.isPerspectiveCamera&&(be.fov=jf*2*Math.atan(1/be.projectionMatrix.elements[5]),be.zoom=1)}this.getCamera=function(){return R},this.getFoveation=function(){if(!(m===null&&A===null))return u},this.setFoveation=function(be){u=be,m!==null&&(m.fixedFoveation=be),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=be)};let ce=null;function Me(be,Fe){if(p=Fe.getViewerPose(h||c),y=Fe,p!==null){let Ze=p.views;A!==null&&(e.setRenderTargetFramebuffer(v,A.framebuffer),e.setRenderTarget(v));let ut=!1;Ze.length!==R.cameras.length&&(R.cameras.length=0,ut=!0);for(let it=0;it<Ze.length;it++){let gt=Ze[it],Rt=null;if(A!==null)Rt=A.getViewport(gt);else{let Ft=f.getViewSubImage(m,gt);Rt=Ft.viewport,it===0&&(e.setRenderTargetTextures(v,Ft.colorTexture,m.ignoreDepthValues?void 0:Ft.depthStencilTexture),e.setRenderTarget(v))}let It=F[it];It===void 0&&(It=new to,It.layers.enable(it),It.viewport=new br,F[it]=It),It.matrix.fromArray(gt.transform.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale),It.projectionMatrix.fromArray(gt.projectionMatrix),It.projectionMatrixInverse.copy(It.projectionMatrix).invert(),It.viewport.set(Rt.x,Rt.y,Rt.width,Rt.height),it===0&&(R.matrix.copy(It.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),ut===!0&&R.cameras.push(It)}}for(let Ze=0;Ze<w.length;Ze++){let ut=M[Ze],it=w[Ze];ut!==null&&it!==void 0&&it.update(ut,Fe,h||c)}ce&&ce(be,Fe),Fe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Fe}),y=null}let xe=new rN;xe.setAnimationLoop(Me),this.setAnimationLoop=function(be){ce=be},this.dispose=function(){}}};pC=class{constructor(e={}){let{canvas:t=sq(),context:i=null,depth:s=!0,stencil:o=!0,alpha:c=!1,antialias:l=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let m;i!==null?m=i.getContextAttributes().alpha:m=c;let A=new Uint32Array(4),y=new Int32Array(4),E=null,x=null,v=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=cs,this._useLegacyLights=!1,this.toneMapping=su,this.toneMappingExposure=1;let M=this,T=!1,D=0,L=0,I=null,F=-1,R=null,N=new br,X=new br,$=null,te=new Si(0),U=0,P=t.width,k=t.height,z=1,Q=null,Z=null,ce=new br(0,0,P,k),Me=new br(0,0,P,k),xe=!1,be=new wg,Fe=!1,Ze=!1,ut=null,it=new yi,gt=new gr,Rt=new Et,It={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ft(){return I===null?z:1}let Ne=i;function pn(ne,Y){for(let le=0;le<ne.length;le++){let me=ne[le],_e=t.getContext(me,Y);if(_e!==null)return _e}return null}try{let ne={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${RC}`),t.addEventListener("webglcontextlost",nt,!1),t.addEventListener("webglcontextrestored",ge,!1),t.addEventListener("webglcontextcreationerror",ot,!1),Ne===null){let Y=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&Y.shift(),Ne=pn(Y,ne),Ne===null)throw pn(Y)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ne instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Ne.getShaderPrecisionFormat===void 0&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}let St,Vt,Ot,xn,Jt,Oe,Ie,yt,kt,De,he,ae,de,we,Ae,Le,Ee,ze,Ge,ee,V,G,pe,Ue;function Qe(){St=new m$(Ne),Vt=new l$(Ne,St,e),St.init(Vt),G=new QJ(Ne,St,Vt),Ot=new WJ(Ne,St,Vt),xn=new v$(Ne),Jt=new LJ,Oe=new jJ(Ne,St,Ot,Jt,Vt,G,xn),Ie=new h$(M),yt=new p$(M),kt=new Cq(Ne,Vt),pe=new a$(Ne,St,kt,Vt),De=new g$(Ne,kt,xn,pe),he=new _$(Ne,De,kt,xn),Ge=new E$(Ne,Vt,Oe),Le=new u$(Jt),ae=new DJ(M,Ie,yt,St,Vt,pe,Le),de=new qJ(M,Jt),we=new BJ,Ae=new VJ(St,Vt),ze=new o$(M,Ie,yt,Ot,he,m,u),Ee=new GJ(M,he,Vt),Ue=new YJ(Ne,xn,Vt,Ot),ee=new c$(Ne,St,xn,Vt),V=new A$(Ne,St,xn,Vt),xn.programs=ae.programs,M.capabilities=Vt,M.extensions=St,M.properties=Jt,M.renderLists=we,M.shadowMap=Ee,M.state=Ot,M.info=xn}Qe();let $e=new fC(M,Ne);this.xr=$e,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){let ne=St.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){let ne=St.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(ne){ne!==void 0&&(z=ne,this.setSize(P,k,!1))},this.getSize=function(ne){return ne.set(P,k)},this.setSize=function(ne,Y,le=!0){if($e.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}P=ne,k=Y,t.width=Math.floor(ne*z),t.height=Math.floor(Y*z),le===!0&&(t.style.width=ne+"px",t.style.height=Y+"px"),this.setViewport(0,0,ne,Y)},this.getDrawingBufferSize=function(ne){return ne.set(P*z,k*z).floor()},this.setDrawingBufferSize=function(ne,Y,le){P=ne,k=Y,z=le,t.width=Math.floor(ne*le),t.height=Math.floor(Y*le),this.setViewport(0,0,ne,Y)},this.getCurrentViewport=function(ne){return ne.copy(N)},this.getViewport=function(ne){return ne.copy(ce)},this.setViewport=function(ne,Y,le,me){ne.isVector4?ce.set(ne.x,ne.y,ne.z,ne.w):ce.set(ne,Y,le,me),Ot.viewport(N.copy(ce).multiplyScalar(z).floor())},this.getScissor=function(ne){return ne.copy(Me)},this.setScissor=function(ne,Y,le,me){ne.isVector4?Me.set(ne.x,ne.y,ne.z,ne.w):Me.set(ne,Y,le,me),Ot.scissor(X.copy(Me).multiplyScalar(z).floor())},this.getScissorTest=function(){return xe},this.setScissorTest=function(ne){Ot.setScissorTest(xe=ne)},this.setOpaqueSort=function(ne){Q=ne},this.setTransparentSort=function(ne){Z=ne},this.getClearColor=function(ne){return ne.copy(ze.getClearColor())},this.setClearColor=function(){ze.setClearColor.apply(ze,arguments)},this.getClearAlpha=function(){return ze.getClearAlpha()},this.setClearAlpha=function(){ze.setClearAlpha.apply(ze,arguments)},this.clear=function(ne=!0,Y=!0,le=!0){let me=0;if(ne){let _e=!1;if(I!==null){let Xe=I.texture.format;_e=Xe===$O||Xe===KO||Xe===YO}if(_e){let Xe=I.texture.type,rt=Xe===ou||Xe===iu||Xe===DC||Xe===Bh||Xe===XO||Xe===qO,At=ze.getClearColor(),Ct=ze.getClearAlpha(),Tt=At.r,mt=At.g,Bt=At.b;rt?(A[0]=Tt,A[1]=mt,A[2]=Bt,A[3]=Ct,Ne.clearBufferuiv(Ne.COLOR,0,A)):(y[0]=Tt,y[1]=mt,y[2]=Bt,y[3]=Ct,Ne.clearBufferiv(Ne.COLOR,0,y))}else me|=Ne.COLOR_BUFFER_BIT}Y&&(me|=Ne.DEPTH_BUFFER_BIT),le&&(me|=Ne.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ne.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nt,!1),t.removeEventListener("webglcontextrestored",ge,!1),t.removeEventListener("webglcontextcreationerror",ot,!1),we.dispose(),Ae.dispose(),Jt.dispose(),Ie.dispose(),yt.dispose(),he.dispose(),pe.dispose(),Ue.dispose(),ae.dispose(),$e.dispose(),$e.removeEventListener("sessionstart",en),$e.removeEventListener("sessionend",xt),ut&&(ut.dispose(),ut=null),jt.stop()};function nt(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function ge(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;let ne=xn.autoReset,Y=Ee.enabled,le=Ee.autoUpdate,me=Ee.needsUpdate,_e=Ee.type;Qe(),xn.autoReset=ne,Ee.enabled=Y,Ee.autoUpdate=le,Ee.needsUpdate=me,Ee.type=_e}function ot(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function et(ne){let Y=ne.target;Y.removeEventListener("dispose",et),tt(Y)}function tt(ne){_t(ne),Jt.remove(ne)}function _t(ne){let Y=Jt.get(ne).programs;Y!==void 0&&(Y.forEach(function(le){ae.releaseProgram(le)}),ne.isShaderMaterial&&ae.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Y,le,me,_e,Xe){Y===null&&(Y=It);let rt=_e.isMesh&&_e.matrixWorld.determinant()<0,At=dr(ne,Y,le,me,_e);Ot.setMaterial(me,rt);let Ct=le.index,Tt=1;if(me.wireframe===!0){if(Ct=De.getWireframeAttribute(le),Ct===void 0)return;Tt=2}let mt=le.drawRange,Bt=le.attributes.position,cn=mt.start*Tt,Ln=(mt.start+mt.count)*Tt;Xe!==null&&(cn=Math.max(cn,Xe.start*Tt),Ln=Math.min(Ln,(Xe.start+Xe.count)*Tt)),Ct!==null?(cn=Math.max(cn,0),Ln=Math.min(Ln,Ct.count)):Bt!=null&&(cn=Math.max(cn,0),Ln=Math.min(Ln,Bt.count));let Hn=Ln-cn;if(Hn<0||Hn===1/0)return;pe.setup(_e,me,At,le,Ct);let Wn,mn=ee;if(Ct!==null&&(Wn=kt.get(Ct),mn=V,mn.setIndex(Wn)),_e.isMesh)me.wireframe===!0?(Ot.setLineWidth(me.wireframeLinewidth*Ft()),mn.setMode(Ne.LINES)):mn.setMode(Ne.TRIANGLES);else if(_e.isLine){let Yt=me.linewidth;Yt===void 0&&(Yt=1),Ot.setLineWidth(Yt*Ft()),_e.isLineSegments?mn.setMode(Ne.LINES):_e.isLineLoop?mn.setMode(Ne.LINE_LOOP):mn.setMode(Ne.LINE_STRIP)}else _e.isPoints?mn.setMode(Ne.POINTS):_e.isSprite&&mn.setMode(Ne.TRIANGLES);if(_e.isBatchedMesh)mn.renderMultiDraw(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount);else if(_e.isInstancedMesh)mn.renderInstances(cn,Hn,_e.count);else if(le.isInstancedBufferGeometry){let Yt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,lr=Math.min(le.instanceCount,Yt);mn.renderInstances(cn,Hn,lr)}else mn.render(cn,Hn)};function tn(ne,Y,le){ne.transparent===!0&&ne.side===ol&&ne.forceSinglePass===!1?(ne.side=Wo,ne.needsUpdate=!0,xi(ne,Y,le),ne.side=au,ne.needsUpdate=!0,xi(ne,Y,le),ne.side=ol):xi(ne,Y,le)}this.compile=function(ne,Y,le=null){le===null&&(le=ne),x=Ae.get(le),x.init(),w.push(x),le.traverseVisible(function(_e){_e.isLight&&_e.layers.test(Y.layers)&&(x.pushLight(_e),_e.castShadow&&x.pushShadow(_e))}),ne!==le&&ne.traverseVisible(function(_e){_e.isLight&&_e.layers.test(Y.layers)&&(x.pushLight(_e),_e.castShadow&&x.pushShadow(_e))}),x.setupLights(M._useLegacyLights);let me=new Set;return ne.traverse(function(_e){let Xe=_e.material;if(Xe)if(Array.isArray(Xe))for(let rt=0;rt<Xe.length;rt++){let At=Xe[rt];tn(At,le,_e),me.add(At)}else tn(Xe,le,_e),me.add(Xe)}),w.pop(),x=null,me},this.compileAsync=function(ne,Y,le=null){let me=this.compile(ne,Y,le);return new Promise(_e=>{function Xe(){if(me.forEach(function(rt){Jt.get(rt).currentProgram.isReady()&&me.delete(rt)}),me.size===0){_e(ne);return}setTimeout(Xe,10)}St.get("KHR_parallel_shader_compile")!==null?Xe():setTimeout(Xe,10)})};let En=null;function Cn(ne){En&&En(ne)}function en(){jt.stop()}function xt(){jt.start()}let jt=new rN;jt.setAnimationLoop(Cn),typeof self<"u"&&jt.setContext(self),this.setAnimationLoop=function(ne){En=ne,$e.setAnimationLoop(ne),ne===null?jt.stop():jt.start()},$e.addEventListener("sessionstart",en),$e.addEventListener("sessionend",xt),this.render=function(ne,Y){if(Y!==void 0&&Y.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Y.parent===null&&Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),$e.enabled===!0&&$e.isPresenting===!0&&($e.cameraAutoUpdate===!0&&$e.updateCamera(Y),Y=$e.getCamera()),ne.isScene===!0&&ne.onBeforeRender(M,ne,Y,I),x=Ae.get(ne,w.length),x.init(),w.push(x),it.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),be.setFromProjectionMatrix(it),Ze=this.localClippingEnabled,Fe=Le.init(this.clippingPlanes,Ze),E=we.get(ne,v.length),E.init(),v.push(E),Pn(ne,Y,0,M.sortObjects),E.finish(),M.sortObjects===!0&&E.sort(Q,Z),this.info.render.frame++,Fe===!0&&Le.beginShadows();let le=x.state.shadowsArray;if(Ee.render(le,ne,Y),Fe===!0&&Le.endShadows(),this.info.autoReset===!0&&this.info.reset(),ze.render(E,ne),x.setupLights(M._useLegacyLights),Y.isArrayCamera){let me=Y.cameras;for(let _e=0,Xe=me.length;_e<Xe;_e++){let rt=me[_e];In(E,ne,rt,rt.viewport)}}else In(E,ne,Y);I!==null&&(Oe.updateMultisampleRenderTarget(I),Oe.updateRenderTargetMipmap(I)),ne.isScene===!0&&ne.onAfterRender(M,ne,Y),pe.resetDefaultState(),F=-1,R=null,w.pop(),w.length>0?x=w[w.length-1]:x=null,v.pop(),v.length>0?E=v[v.length-1]:E=null};function Pn(ne,Y,le,me){if(ne.visible===!1)return;if(ne.layers.test(Y.layers)){if(ne.isGroup)le=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Y);else if(ne.isLight)x.pushLight(ne),ne.castShadow&&x.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||be.intersectsSprite(ne)){me&&Rt.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(it);let rt=he.update(ne),At=ne.material;At.visible&&E.push(ne,rt,At,le,Rt.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||be.intersectsObject(ne))){let rt=he.update(ne),At=ne.material;if(me&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),Rt.copy(ne.boundingSphere.center)):(rt.boundingSphere===null&&rt.computeBoundingSphere(),Rt.copy(rt.boundingSphere.center)),Rt.applyMatrix4(ne.matrixWorld).applyMatrix4(it)),Array.isArray(At)){let Ct=rt.groups;for(let Tt=0,mt=Ct.length;Tt<mt;Tt++){let Bt=Ct[Tt],cn=At[Bt.materialIndex];cn&&cn.visible&&E.push(ne,rt,cn,le,Rt.z,Bt)}}else At.visible&&E.push(ne,rt,At,le,Rt.z,null)}}let Xe=ne.children;for(let rt=0,At=Xe.length;rt<At;rt++)Pn(Xe[rt],Y,le,me)}function In(ne,Y,le,me){let _e=ne.opaque,Xe=ne.transmissive,rt=ne.transparent;x.setupLightsView(le),Fe===!0&&Le.setGlobalState(M.clippingPlanes,le),Xe.length>0&&Kn(_e,Xe,Y,le),me&&Ot.viewport(N.copy(me)),_e.length>0&&Gn(_e,Y,le),Xe.length>0&&Gn(Xe,Y,le),rt.length>0&&Gn(rt,Y,le),Ot.buffers.depth.setTest(!0),Ot.buffers.depth.setMask(!0),Ot.buffers.color.setMask(!0),Ot.setPolygonOffset(!1)}function Kn(ne,Y,le,me){if((le.isScene===!0?le.overrideMaterial:null)!==null)return;let Xe=Vt.isWebGL2;ut===null&&(ut=new hl(1,1,{generateMipmaps:!0,type:St.has("EXT_color_buffer_half_float")?Eg:ou,minFilter:xg,samples:Xe?4:0})),M.getDrawingBufferSize(gt),Xe?ut.setSize(gt.x,gt.y):ut.setSize(ky(gt.x),ky(gt.y));let rt=M.getRenderTarget();M.setRenderTarget(ut),M.getClearColor(te),U=M.getClearAlpha(),U<1&&M.setClearColor(16777215,.5),M.clear();let At=M.toneMapping;M.toneMapping=su,Gn(ne,le,me),Oe.updateMultisampleRenderTarget(ut),Oe.updateRenderTargetMipmap(ut);let Ct=!1;for(let Tt=0,mt=Y.length;Tt<mt;Tt++){let Bt=Y[Tt],cn=Bt.object,Ln=Bt.geometry,Hn=Bt.material,Wn=Bt.group;if(Hn.side===ol&&cn.layers.test(me.layers)){let mn=Hn.side;Hn.side=Wo,Hn.needsUpdate=!0,fi(cn,le,me,Ln,Hn,Wn),Hn.side=mn,Hn.needsUpdate=!0,Ct=!0}}Ct===!0&&(Oe.updateMultisampleRenderTarget(ut),Oe.updateRenderTargetMipmap(ut)),M.setRenderTarget(rt),M.setClearColor(te,U),M.toneMapping=At}function Gn(ne,Y,le){let me=Y.isScene===!0?Y.overrideMaterial:null;for(let _e=0,Xe=ne.length;_e<Xe;_e++){let rt=ne[_e],At=rt.object,Ct=rt.geometry,Tt=me===null?rt.material:me,mt=rt.group;At.layers.test(le.layers)&&fi(At,Y,le,Ct,Tt,mt)}}function fi(ne,Y,le,me,_e,Xe){ne.onBeforeRender(M,Y,le,me,_e,Xe),ne.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),_e.onBeforeRender(M,Y,le,me,ne,Xe),_e.transparent===!0&&_e.side===ol&&_e.forceSinglePass===!1?(_e.side=Wo,_e.needsUpdate=!0,M.renderBufferDirect(le,Y,me,_e,ne,Xe),_e.side=au,_e.needsUpdate=!0,M.renderBufferDirect(le,Y,me,_e,ne,Xe),_e.side=ol):M.renderBufferDirect(le,Y,me,_e,ne,Xe),ne.onAfterRender(M,Y,le,me,_e,Xe)}function xi(ne,Y,le){Y.isScene!==!0&&(Y=It);let me=Jt.get(ne),_e=x.state.lights,Xe=x.state.shadowsArray,rt=_e.state.version,At=ae.getParameters(ne,_e.state,Xe,Y,le),Ct=ae.getProgramCacheKey(At),Tt=me.programs;me.environment=ne.isMeshStandardMaterial?Y.environment:null,me.fog=Y.fog,me.envMap=(ne.isMeshStandardMaterial?yt:Ie).get(ne.envMap||me.environment),Tt===void 0&&(ne.addEventListener("dispose",et),Tt=new Map,me.programs=Tt);let mt=Tt.get(Ct);if(mt!==void 0){if(me.currentProgram===mt&&me.lightsStateVersion===rt)return ir(ne,At),mt}else At.uniforms=ae.getUniforms(ne),ne.onBuild(le,At,M),ne.onBeforeCompile(At,M),mt=ae.acquireProgram(At,Ct),Tt.set(Ct,mt),me.uniforms=At.uniforms;let Bt=me.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(Bt.clippingPlanes=Le.uniform),ir(ne,At),me.needsLights=Mi(ne),me.lightsStateVersion=rt,me.needsLights&&(Bt.ambientLightColor.value=_e.state.ambient,Bt.lightProbe.value=_e.state.probe,Bt.directionalLights.value=_e.state.directional,Bt.directionalLightShadows.value=_e.state.directionalShadow,Bt.spotLights.value=_e.state.spot,Bt.spotLightShadows.value=_e.state.spotShadow,Bt.rectAreaLights.value=_e.state.rectArea,Bt.ltc_1.value=_e.state.rectAreaLTC1,Bt.ltc_2.value=_e.state.rectAreaLTC2,Bt.pointLights.value=_e.state.point,Bt.pointLightShadows.value=_e.state.pointShadow,Bt.hemisphereLights.value=_e.state.hemi,Bt.directionalShadowMap.value=_e.state.directionalShadowMap,Bt.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,Bt.spotShadowMap.value=_e.state.spotShadowMap,Bt.spotLightMatrix.value=_e.state.spotLightMatrix,Bt.spotLightMap.value=_e.state.spotLightMap,Bt.pointShadowMap.value=_e.state.pointShadowMap,Bt.pointShadowMatrix.value=_e.state.pointShadowMatrix),me.currentProgram=mt,me.uniformsList=null,mt}function Ti(ne){if(ne.uniformsList===null){let Y=ne.currentProgram.getUniforms();ne.uniformsList=Vf.seqWithValue(Y.seq,ne.uniforms)}return ne.uniformsList}function ir(ne,Y){let le=Jt.get(ne);le.outputColorSpace=Y.outputColorSpace,le.batching=Y.batching,le.instancing=Y.instancing,le.instancingColor=Y.instancingColor,le.skinning=Y.skinning,le.morphTargets=Y.morphTargets,le.morphNormals=Y.morphNormals,le.morphColors=Y.morphColors,le.morphTargetsCount=Y.morphTargetsCount,le.numClippingPlanes=Y.numClippingPlanes,le.numIntersection=Y.numClipIntersection,le.vertexAlphas=Y.vertexAlphas,le.vertexTangents=Y.vertexTangents,le.toneMapping=Y.toneMapping}function dr(ne,Y,le,me,_e){Y.isScene!==!0&&(Y=It),Oe.resetTextureUnits();let Xe=Y.fog,rt=me.isMeshStandardMaterial?Y.environment:null,At=I===null?M.outputColorSpace:I.isXRRenderTarget===!0?I.texture.colorSpace:ul,Ct=(me.isMeshStandardMaterial?yt:Ie).get(me.envMap||rt),Tt=me.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,mt=!!le.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),Bt=!!le.morphAttributes.position,cn=!!le.morphAttributes.normal,Ln=!!le.morphAttributes.color,Hn=su;me.toneMapped&&(I===null||I.isXRRenderTarget===!0)&&(Hn=M.toneMapping);let Wn=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,mn=Wn!==void 0?Wn.length:0,Yt=Jt.get(me),lr=x.state.lights;if(Fe===!0&&(Ze===!0||ne!==R)){let Se=ne===R&&me.id===F;Le.setState(me,ne,Se)}let zn=!1;me.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==lr.state.version||Yt.outputColorSpace!==At||_e.isBatchedMesh&&Yt.batching===!1||!_e.isBatchedMesh&&Yt.batching===!0||_e.isInstancedMesh&&Yt.instancing===!1||!_e.isInstancedMesh&&Yt.instancing===!0||_e.isSkinnedMesh&&Yt.skinning===!1||!_e.isSkinnedMesh&&Yt.skinning===!0||_e.isInstancedMesh&&Yt.instancingColor===!0&&_e.instanceColor===null||_e.isInstancedMesh&&Yt.instancingColor===!1&&_e.instanceColor!==null||Yt.envMap!==Ct||me.fog===!0&&Yt.fog!==Xe||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==Le.numPlanes||Yt.numIntersection!==Le.numIntersection)||Yt.vertexAlphas!==Tt||Yt.vertexTangents!==mt||Yt.morphTargets!==Bt||Yt.morphNormals!==cn||Yt.morphColors!==Ln||Yt.toneMapping!==Hn||Vt.isWebGL2===!0&&Yt.morphTargetsCount!==mn)&&(zn=!0):(zn=!0,Yt.__version=me.version);let yn=Yt.currentProgram;zn===!0&&(yn=xi(me,Y,_e));let Ei=!1,ur=!1,$n=!1,q=yn.getUniforms(),re=Yt.uniforms;if(Ot.useProgram(yn.program)&&(Ei=!0,ur=!0,$n=!0),me.id!==F&&(F=me.id,ur=!0),Ei||R!==ne){q.setValue(Ne,"projectionMatrix",ne.projectionMatrix),q.setValue(Ne,"viewMatrix",ne.matrixWorldInverse);let Se=q.map.cameraPosition;Se!==void 0&&Se.setValue(Ne,Rt.setFromMatrixPosition(ne.matrixWorld)),Vt.logarithmicDepthBuffer&&q.setValue(Ne,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&q.setValue(Ne,"isOrthographic",ne.isOrthographicCamera===!0),R!==ne&&(R=ne,ur=!0,$n=!0)}if(_e.isSkinnedMesh){q.setOptional(Ne,_e,"bindMatrix"),q.setOptional(Ne,_e,"bindMatrixInverse");let Se=_e.skeleton;Se&&(Vt.floatVertexTextures?(Se.boneTexture===null&&Se.computeBoneTexture(),q.setValue(Ne,"boneTexture",Se.boneTexture,Oe)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}_e.isBatchedMesh&&(q.setOptional(Ne,_e,"batchingTexture"),q.setValue(Ne,"batchingTexture",_e._matricesTexture,Oe));let ye=le.morphAttributes;if((ye.position!==void 0||ye.normal!==void 0||ye.color!==void 0&&Vt.isWebGL2===!0)&&Ge.update(_e,le,yn),(ur||Yt.receiveShadow!==_e.receiveShadow)&&(Yt.receiveShadow=_e.receiveShadow,q.setValue(Ne,"receiveShadow",_e.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(re.envMap.value=Ct,re.flipEnvMap.value=Ct.isCubeTexture&&Ct.isRenderTargetTexture===!1?-1:1),ur&&(q.setValue(Ne,"toneMappingExposure",M.toneMappingExposure),Yt.needsLights&&Ai(re,$n),Xe&&me.fog===!0&&de.refreshFogUniforms(re,Xe),de.refreshMaterialUniforms(re,me,z,k,ut),Vf.upload(Ne,Ti(Yt),re,Oe)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(Vf.upload(Ne,Ti(Yt),re,Oe),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&q.setValue(Ne,"center",_e.center),q.setValue(Ne,"modelViewMatrix",_e.modelViewMatrix),q.setValue(Ne,"normalMatrix",_e.normalMatrix),q.setValue(Ne,"modelMatrix",_e.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){let Se=me.uniformsGroups;for(let He=0,at=Se.length;He<at;He++)if(Vt.isWebGL2){let vt=Se[He];Ue.update(vt,yn),Ue.bind(vt,yn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return yn}function Ai(ne,Y){ne.ambientLightColor.needsUpdate=Y,ne.lightProbe.needsUpdate=Y,ne.directionalLights.needsUpdate=Y,ne.directionalLightShadows.needsUpdate=Y,ne.pointLights.needsUpdate=Y,ne.pointLightShadows.needsUpdate=Y,ne.spotLights.needsUpdate=Y,ne.spotLightShadows.needsUpdate=Y,ne.rectAreaLights.needsUpdate=Y,ne.hemisphereLights.needsUpdate=Y}function Mi(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return I},this.setRenderTargetTextures=function(ne,Y,le){Jt.get(ne.texture).__webglTexture=Y,Jt.get(ne.depthTexture).__webglTexture=le;let me=Jt.get(ne);me.__hasExternalTextures=!0,me.__hasExternalTextures&&(me.__autoAllocateDepthBuffer=le===void 0,me.__autoAllocateDepthBuffer||St.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ne,Y){let le=Jt.get(ne);le.__webglFramebuffer=Y,le.__useDefaultFramebuffer=Y===void 0},this.setRenderTarget=function(ne,Y=0,le=0){I=ne,D=Y,L=le;let me=!0,_e=null,Xe=!1,rt=!1;if(ne){let Ct=Jt.get(ne);Ct.__useDefaultFramebuffer!==void 0?(Ot.bindFramebuffer(Ne.FRAMEBUFFER,null),me=!1):Ct.__webglFramebuffer===void 0?Oe.setupRenderTarget(ne):Ct.__hasExternalTextures&&Oe.rebindTextures(ne,Jt.get(ne.texture).__webglTexture,Jt.get(ne.depthTexture).__webglTexture);let Tt=ne.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(rt=!0);let mt=Jt.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(mt[Y])?_e=mt[Y][le]:_e=mt[Y],Xe=!0):Vt.isWebGL2&&ne.samples>0&&Oe.useMultisampledRTT(ne)===!1?_e=Jt.get(ne).__webglMultisampledFramebuffer:Array.isArray(mt)?_e=mt[le]:_e=mt,N.copy(ne.viewport),X.copy(ne.scissor),$=ne.scissorTest}else N.copy(ce).multiplyScalar(z).floor(),X.copy(Me).multiplyScalar(z).floor(),$=xe;if(Ot.bindFramebuffer(Ne.FRAMEBUFFER,_e)&&Vt.drawBuffers&&me&&Ot.drawBuffers(ne,_e),Ot.viewport(N),Ot.scissor(X),Ot.setScissorTest($),Xe){let Ct=Jt.get(ne.texture);Ne.framebufferTexture2D(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_CUBE_MAP_POSITIVE_X+Y,Ct.__webglTexture,le)}else if(rt){let Ct=Jt.get(ne.texture),Tt=Y||0;Ne.framebufferTextureLayer(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ct.__webglTexture,le||0,Tt)}F=-1},this.readRenderTargetPixels=function(ne,Y,le,me,_e,Xe,rt){if(!(ne&&ne.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let At=Jt.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&rt!==void 0&&(At=At[rt]),At){Ot.bindFramebuffer(Ne.FRAMEBUFFER,At);try{let Ct=ne.texture,Tt=Ct.format,mt=Ct.type;if(Tt!==Sa&&G.convert(Tt)!==Ne.getParameter(Ne.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Bt=mt===Eg&&(St.has("EXT_color_buffer_half_float")||Vt.isWebGL2&&St.has("EXT_color_buffer_float"));if(mt!==ou&&G.convert(mt)!==Ne.getParameter(Ne.IMPLEMENTATION_COLOR_READ_TYPE)&&!(mt===al&&(Vt.isWebGL2||St.has("OES_texture_float")||St.has("WEBGL_color_buffer_float")))&&!Bt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Y>=0&&Y<=ne.width-me&&le>=0&&le<=ne.height-_e&&Ne.readPixels(Y,le,me,_e,G.convert(Tt),G.convert(mt),Xe)}finally{let Ct=I!==null?Jt.get(I).__webglFramebuffer:null;Ot.bindFramebuffer(Ne.FRAMEBUFFER,Ct)}}},this.copyFramebufferToTexture=function(ne,Y,le=0){let me=Math.pow(2,-le),_e=Math.floor(Y.image.width*me),Xe=Math.floor(Y.image.height*me);Oe.setTexture2D(Y,0),Ne.copyTexSubImage2D(Ne.TEXTURE_2D,le,0,0,ne.x,ne.y,_e,Xe),Ot.unbindTexture()},this.copyTextureToTexture=function(ne,Y,le,me=0){let _e=Y.image.width,Xe=Y.image.height,rt=G.convert(le.format),At=G.convert(le.type);Oe.setTexture2D(le,0),Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,le.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,le.unpackAlignment),Y.isDataTexture?Ne.texSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,_e,Xe,rt,At,Y.image.data):Y.isCompressedTexture?Ne.compressedTexSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,Y.mipmaps[0].width,Y.mipmaps[0].height,rt,Y.mipmaps[0].data):Ne.texSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,rt,At,Y.image),me===0&&le.generateMipmaps&&Ne.generateMipmap(Ne.TEXTURE_2D),Ot.unbindTexture()},this.copyTextureToTexture3D=function(ne,Y,le,me,_e=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Xe=ne.max.x-ne.min.x+1,rt=ne.max.y-ne.min.y+1,At=ne.max.z-ne.min.z+1,Ct=G.convert(me.format),Tt=G.convert(me.type),mt;if(me.isData3DTexture)Oe.setTexture3D(me,0),mt=Ne.TEXTURE_3D;else if(me.isDataArrayTexture)Oe.setTexture2DArray(me,0),mt=Ne.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,me.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,me.unpackAlignment);let Bt=Ne.getParameter(Ne.UNPACK_ROW_LENGTH),cn=Ne.getParameter(Ne.UNPACK_IMAGE_HEIGHT),Ln=Ne.getParameter(Ne.UNPACK_SKIP_PIXELS),Hn=Ne.getParameter(Ne.UNPACK_SKIP_ROWS),Wn=Ne.getParameter(Ne.UNPACK_SKIP_IMAGES),mn=le.isCompressedTexture?le.mipmaps[0]:le.image;Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,mn.width),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,mn.height),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,ne.min.x),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,ne.min.y),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,ne.min.z),le.isDataTexture||le.isData3DTexture?Ne.texSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,Tt,mn.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ne.compressedTexSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,mn.data)):Ne.texSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,Tt,mn),Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,Bt),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,cn),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,Ln),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,Hn),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,Wn),_e===0&&me.generateMipmaps&&Ne.generateMipmap(mt),Ot.unbindTexture()},this.initTexture=function(ne){ne.isCubeTexture?Oe.setTextureCube(ne,0):ne.isData3DTexture?Oe.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?Oe.setTexture2DArray(ne,0):Oe.setTexture2D(ne,0),Ot.unbindTexture()},this.resetState=function(){D=0,L=0,I=null,Ot.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return cl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===PC?"display-p3":"srgb",t.unpackColorSpace=Vr.workingColorSpace===fx?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===cs?Nh:ZO}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Nh?cs:ul}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}},mC=class extends pC{};mC.prototype.isWebGL1Renderer=!0;IO=new Et,RO=new br,DO=new br,KJ=new Et,LO=new yi,Sy=new Et,zw=new uu,PO=new yi,Gw=new bg,Ky=class extends la{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=hB,this.bindMatrix=new yi,this.bindMatrixInverse=new yi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new lu),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Sy),this.boundingBox.expandByPoint(Sy)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new uu),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Sy),this.boundingSphere.expandByPoint(Sy)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),zw.copy(this.boundingSphere),zw.applyMatrix4(s),e.ray.intersectsSphere(zw)!==!1&&(PO.copy(s).invert(),Gw.copy(e.ray).applyMatrix4(PO),!(this.boundingBox!==null&&Gw.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Gw)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new br,t=this.geometry.attributes.skinWeight;for(let i=0,s=t.count;i<s;i++){e.fromBufferAttribute(t,i);let o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===hB?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===MX?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let i=this.skeleton,s=this.geometry;RO.fromBufferAttribute(s.attributes.skinIndex,e),DO.fromBufferAttribute(s.attributes.skinWeight,e),IO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){let c=DO.getComponent(o);if(c!==0){let l=RO.getComponent(o);LO.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),t.addScaledVector(KJ.copy(IO).applyMatrix4(LO),c)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}},Yf=class extends mo{constructor(){super(),this.isBone=!0,this.type="Bone"}},gC=class extends La{constructor(e=null,t=1,i=1,s,o,c,l,u,h=Zs,p=Zs,f,m){super(null,c,l,u,h,p,s,o,f,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},BO=new yi,$J=new yi,$y=class n{constructor(e=[],t=[]){this.uuid=mu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new yi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new yi;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let o=0,c=e.length;o<c;o++){let l=e[o]?e[o].matrixWorld:$J;BO.multiplyMatrices(l,t[o]),BO.toArray(i,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new n(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new gC(t,e,e,Sa,al);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){let o=e.bones[i],c=t[o];c===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),c=new Yf),this.bones.push(c),this.boneInverses.push(new yi().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let s=0,o=t.length;s<o;s++){let c=t[s];e.bones.push(c.uuid);let l=i[s];e.boneInverses.push(l.toArray())}return e}},Cg=class extends dl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Si(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},OO=new Et,NO=new Et,FO=new yi,Ww=new bg,Ty=new uu,Jy=class extends mo{constructor(e=new Ra,t=new Cg){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let s=1,o=t.count;s<o;s++)OO.fromBufferAttribute(t,s-1),NO.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=OO.distanceTo(NO);e.setAttribute("lineDistance",new no(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Ty.copy(i.boundingSphere),Ty.applyMatrix4(s),Ty.radius+=o,e.ray.intersectsSphere(Ty)===!1)return;FO.copy(s).invert(),Ww.copy(e.ray).applyMatrix4(FO);let l=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Et,p=new Et,f=new Et,m=new Et,A=this.isLineSegments?2:1,y=i.index,x=i.attributes.position;if(y!==null){let v=Math.max(0,c.start),w=Math.min(y.count,c.start+c.count);for(let M=v,T=w-1;M<T;M+=A){let D=y.getX(M),L=y.getX(M+1);if(h.fromBufferAttribute(x,D),p.fromBufferAttribute(x,L),Ww.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);let F=e.ray.origin.distanceTo(m);F<e.near||F>e.far||t.push({distance:F,point:f.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,c.start),w=Math.min(x.count,c.start+c.count);for(let M=v,T=w-1;M<T;M+=A){if(h.fromBufferAttribute(x,M),p.fromBufferAttribute(x,M+1),Ww.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);let L=e.ray.origin.distanceTo(m);L<e.near||L>e.far||t.push({distance:L,point:f.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,c=s.length;o<c;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}},Zy=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,s=this.getPoint(0),o=0;t.push(0);for(let c=1;c<=e;c++)i=this.getPoint(c/e),o+=i.distanceTo(s),t.push(o),s=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),s=0,o=i.length,c;t?c=t:c=e*i[o-1];let l=0,u=o-1,h;for(;l<=u;)if(s=Math.floor(l+(u-l)/2),h=i[s]-c,h<0)l=s+1;else if(h>0)u=s-1;else{u=s;break}if(s=u,i[s]===c)return s/(o-1);let p=i[s],m=i[s+1]-p,A=(c-p)/m;return(s+A)/(o-1)}getTangent(e,t){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);let c=this.getPoint(s),l=this.getPoint(o),u=t||(c.isVector2?new gr:new Et);return u.copy(l).sub(c).normalize(),u}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new Et,s=[],o=[],c=[],l=new Et,u=new yi;for(let A=0;A<=e;A++){let y=A/e;s[A]=this.getTangentAt(y,new Et)}o[0]=new Et,c[0]=new Et;let h=Number.MAX_VALUE,p=Math.abs(s[0].x),f=Math.abs(s[0].y),m=Math.abs(s[0].z);p<=h&&(h=p,i.set(1,0,0)),f<=h&&(h=f,i.set(0,1,0)),m<=h&&i.set(0,0,1),l.crossVectors(s[0],i).normalize(),o[0].crossVectors(s[0],l),c[0].crossVectors(s[0],o[0]);for(let A=1;A<=e;A++){if(o[A]=o[A-1].clone(),c[A]=c[A-1].clone(),l.crossVectors(s[A-1],s[A]),l.length()>Number.EPSILON){l.normalize();let y=Math.acos(eo(s[A-1].dot(s[A]),-1,1));o[A].applyMatrix4(u.makeRotationAxis(l,y))}c[A].crossVectors(s[A],o[A])}if(t===!0){let A=Math.acos(eo(o[0].dot(o[e]),-1,1));A/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(A=-A);for(let y=1;y<=e;y++)o[y].applyMatrix4(u.makeRotationAxis(s[y],A*y)),c[y].crossVectors(s[y],o[y])}return{tangents:s,normals:o,binormals:c}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},JJ={triangulate:function(n,e,t=2){let i=e&&e.length,s=i?e[0]*t:n.length,o=uN(n,0,s,t,!0),c=[];if(!o||o.next===o.prev)return c;let l,u,h,p,f,m,A;if(i&&(o=iZ(n,e,o,t)),n.length>80*t){l=h=n[0],u=p=n[1];for(let y=t;y<s;y+=t)f=n[y],m=n[y+1],f<l&&(l=f),m<u&&(u=m),f>h&&(h=f),m>p&&(p=m);A=Math.max(h-l,p-u),A=A!==0?32767/A:0}return Sg(o,c,t,l,u,A,0),c}};ex=class n{static area(e){let t=e.length,i=0;for(let s=t-1,o=0;o<t;s=o++)i+=e[s].x*e[o].y-e[o].x*e[s].y;return i*.5}static isClockWise(e){return n.area(e)<0}static triangulateShape(e,t){let i=[],s=[],o=[];kO(e),VO(i,e);let c=e.length;t.forEach(kO);for(let u=0;u<t.length;u++)s.push(c),c+=t[u].length,VO(i,t[u]);let l=JJ.triangulate(i,s);for(let u=0;u<l.length;u+=3)o.push(l.slice(u,u+3));return o}};Kf=class extends dl{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Si(16777215),this.specular=new Si(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Si(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=LC,this.normalScale=new gr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=hx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},tx=class extends dl{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Si(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Si(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=LC,this.normalScale=new gr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=hx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};$f=class{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,s=t[i],o=t[i-1];n:{e:{let c;t:{i:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(o=s,s=t[++i],e<s)break e}c=t.length;break t}if(!(e>=o)){let l=t[1];e<l&&(i=2,o=l);for(let u=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(s=o,o=t[--i-1],e>=o)break e}c=i,i=0;break t}break n}for(;i<c;){let l=i+c>>>1;e<t[l]?c=l:i=l+1}if(s=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let c=0;c!==s;++c)t[c]=i[o+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},yC=class extends $f{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:kB,endingEnd:kB}}intervalChanged_(e,t,i){let s=this.parameterPositions,o=e-2,c=e+1,l=s[o],u=s[c];if(l===void 0)switch(this.getSettings_().endingStart){case VB:o=e,l=2*t-i;break;case HB:o=s.length-2,l=t+s[o]-s[o+1];break;default:o=e,l=i}if(u===void 0)switch(this.getSettings_().endingEnd){case VB:c=e,u=2*i-t;break;case HB:c=1,u=i+s[1]-s[0];break;default:c=e-1,u=t}let h=(i-t)*.5,p=this.valueSize;this._weightPrev=h/(t-l),this._weightNext=h/(u-i),this._offsetPrev=o*p,this._offsetNext=c*p}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,A=this._weightNext,y=(i-t)/(s-t),E=y*y,x=E*y,v=-m*x+2*m*E-m*y,w=(1+m)*x+(-1.5-2*m)*E+(-.5+m)*y+1,M=(-1-A)*x+(1.5+A)*E+.5*y,T=A*x-A*E;for(let D=0;D!==l;++D)o[D]=v*c[p+D]+w*c[h+D]+M*c[u+D]+T*c[f+D];return o}},xC=class extends $f{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=(i-t)/(s-t),f=1-p;for(let m=0;m!==l;++m)o[m]=c[h+m]*f+c[u+m]*p;return o}},EC=class extends $f{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}},Da=class{constructor(e,t,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Dy(t,this.TimeBufferType),this.values=Dy(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Dy(e.times,Array),values:Dy(e.values,Array)};let s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new EC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new xC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new yC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Py:t=this.InterpolantFactoryMethodDiscrete;break;case By:t=this.InterpolantFactoryMethodLinear;break;case yw:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Py;case this.InterpolantFactoryMethodLinear:return By;case this.InterpolantFactoryMethodSmooth:return yw}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){let i=this.times,s=i.length,o=0,c=s-1;for(;o!==s&&i[o]<e;)++o;for(;c!==-1&&i[c]>t;)--c;if(++c,o!==0||c!==s){o>=c&&(c=Math.max(c,1),o=c-1);let l=this.getValueSize();this.times=i.slice(o,c),this.values=this.values.slice(o*l,c*l)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let l=0;l!==o;l++){let u=i[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(c!==null&&c>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,c),e=!1;break}c=u}if(s!==void 0&&mZ(s))for(let l=0,u=s.length;l!==u;++l){let h=s[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===yw,o=e.length-1,c=1;for(let l=1;l<o;++l){let u=!1,h=e[l],p=e[l+1];if(h!==p&&(l!==1||h!==e[0]))if(s)u=!0;else{let f=l*i,m=f-i,A=f+i;for(let y=0;y!==i;++y){let E=t[f+y];if(E!==t[m+y]||E!==t[A+y]){u=!0;break}}}if(u){if(l!==c){e[c]=e[l];let f=l*i,m=c*i;for(let A=0;A!==i;++A)t[m+A]=t[f+A]}++c}}if(o>0){e[c]=e[o];for(let l=o*i,u=c*i,h=0;h!==i;++h)t[u+h]=t[l+h];++c}return c!==e.length?(this.times=e.slice(0,c),this.values=t.slice(0,c*i)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),i=this.constructor,s=new i(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}};Da.prototype.TimeBufferType=Float32Array;Da.prototype.ValueBufferType=Float32Array;Da.prototype.DefaultInterpolation=By;hu=class extends Da{};hu.prototype.ValueTypeName="bool";hu.prototype.ValueBufferType=Array;hu.prototype.DefaultInterpolation=Py;hu.prototype.InterpolantFactoryMethodLinear=void 0;hu.prototype.InterpolantFactoryMethodSmooth=void 0;nx=class extends Da{};nx.prototype.ValueTypeName="color";du=class extends Da{};du.prototype.ValueTypeName="number";_C=class extends $f{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=(i-t)/(s-t),h=e*l;for(let p=h+l;h!==p;h+=4)io.slerpFlat(o,0,c,h-l,c,h,u);return o}},Sc=class extends Da{InterpolantFactoryMethodLinear(e){return new _C(this.times,this.values,this.getValueSize(),e)}};Sc.prototype.ValueTypeName="quaternion";Sc.prototype.DefaultInterpolation=By;Sc.prototype.InterpolantFactoryMethodSmooth=void 0;fu=class extends Da{};fu.prototype.ValueTypeName="string";fu.prototype.ValueBufferType=Array;fu.prototype.DefaultInterpolation=Py;fu.prototype.InterpolantFactoryMethodLinear=void 0;fu.prototype.InterpolantFactoryMethodSmooth=void 0;pu=class extends Da{};pu.prototype.ValueTypeName="vector";ix=class{constructor(e,t=-1,i,s=BX){this.name=e,this.tracks=i,this.duration=t,this.blendMode=s,this.uuid=mu(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,s=1/(e.fps||1);for(let c=0,l=i.length;c!==l;++c)t.push(vZ(i[c]).scale(s));let o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){let t=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,c=i.length;o!==c;++o)t.push(Da.toJSON(i[o]));return s}static CreateFromMorphTargetSequence(e,t,i,s){let o=t.length,c=[];for(let l=0;l<o;l++){let u=[],h=[];u.push((l+o-1)%o,l,(l+1)%o),h.push(0,1,0);let p=gZ(u);u=HO(u,1,p),h=HO(h,1,p),!s&&u[0]===0&&(u.push(o),h.push(h[0])),c.push(new du(".morphTargetInfluences["+t[l].name+"]",u,h).scale(1/i))}return new this(e,-1,c)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===t)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let s={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){let h=e[l],p=h.name.match(o);if(p&&p.length>1){let f=p[1],m=s[f];m||(s[f]=m=[]),m.push(h)}}let c=[];for(let l in s)c.push(this.CreateFromMorphTargetSequence(l,s[l],t,i));return c}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(f,m,A,y,E){if(A.length!==0){let x=[],v=[];fN(A,x,v,y),x.length!==0&&E.push(new f(m,x,v))}},s=[],o=e.name||"default",c=e.fps||30,l=e.blendMode,u=e.length||-1,h=e.hierarchy||[];for(let f=0;f<h.length;f++){let m=h[f].keys;if(!(!m||m.length===0))if(m[0].morphTargets){let A={},y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let E=0;E<m[y].morphTargets.length;E++)A[m[y].morphTargets[E]]=-1;for(let E in A){let x=[],v=[];for(let w=0;w!==m[y].morphTargets.length;++w){let M=m[y];x.push(M.time),v.push(M.morphTarget===E?1:0)}s.push(new du(".morphTargetInfluence["+E+"]",x,v))}u=A.length*c}else{let A=".bones["+t[f].name+"]";i(pu,A+".position",m,"pos",s),i(Sc,A+".quaternion",m,"rot",s),i(pu,A+".scale",m,"scl",s)}}return s.length===0?null:new this(o,u,s,l)}resetDuration(){let e=this.tracks,t=0;for(let i=0,s=e.length;i!==s;++i){let o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};rx={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}},bC=class{constructor(e,t,i){let s=this,o=!1,c=0,l=0,u,h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(p){l++,o===!1&&s.onStart!==void 0&&s.onStart(p,c,l),o=!0},this.itemEnd=function(p){c++,s.onProgress!==void 0&&s.onProgress(p,c,l),c===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(p){s.onError!==void 0&&s.onError(p)},this.resolveURL=function(p){return u?u(p):p},this.setURLModifier=function(p){return u=p,this},this.addHandler=function(p,f){return h.push(p,f),this},this.removeHandler=function(p){let f=h.indexOf(p);return f!==-1&&h.splice(f,2),this},this.getHandler=function(p){for(let f=0,m=h.length;f<m;f+=2){let A=h[f],y=h[f+1];if(A.global&&(A.lastIndex=0),A.test(p))return y}return null}}},yZ=new bC,Uh=(()=>{class n{constructor(t){this.manager=t!==void 0?t:yZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){let s=this;return new Promise(function(o,c){s.load(t,o,i,c)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})(),il={},MC=class extends Error{constructor(e,t){super(e),this.response=t}},sx=class extends Uh{constructor(e){super(e)}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=rx.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(il[e]!==void 0){il[e].push({onLoad:t,onProgress:i,onError:s});return}il[e]=[],il[e].push({onLoad:t,onProgress:i,onError:s});let c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,u=this.responseType;fetch(c).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;let p=il[e],f=h.body.getReader(),m=h.headers.get("Content-Length")||h.headers.get("X-File-Size"),A=m?parseInt(m):0,y=A!==0,E=0,x=new ReadableStream({start(v){w();function w(){f.read().then(({done:M,value:T})=>{if(M)v.close();else{E+=T.byteLength;let D=new ProgressEvent("progress",{lengthComputable:y,loaded:E,total:A});for(let L=0,I=p.length;L<I;L++){let F=p[L];F.onProgress&&F.onProgress(D)}v.enqueue(T),w()}})}}});return new Response(x)}else throw new MC(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(p=>new DOMParser().parseFromString(p,l));case"json":return h.json();default:if(l===void 0)return h.text();{let f=/charset="?([^;"\s]*)"?/i.exec(l),m=f&&f[1]?f[1].toLowerCase():void 0,A=new TextDecoder(m);return h.arrayBuffer().then(y=>A.decode(y))}}}).then(h=>{rx.add(e,h);let p=il[e];delete il[e];for(let f=0,m=p.length;f<m;f++){let A=p[f];A.onLoad&&A.onLoad(h)}}).catch(h=>{let p=il[e];if(p===void 0)throw this.manager.itemError(e),h;delete il[e];for(let f=0,m=p.length;f<m;f++){let A=p[f];A.onError&&A.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},wC=class extends Uh{constructor(e){super(e)}load(e,t,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=this,c=rx.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(c),o.manager.itemEnd(e)},0),c;let l=_g("img");function u(){p(),rx.add(e,this),t&&t(this),o.manager.itemEnd(e)}function h(f){p(),s&&s(f),o.manager.itemError(e),o.manager.itemEnd(e)}function p(){l.removeEventListener("load",u,!1),l.removeEventListener("error",h,!1)}return l.addEventListener("load",u,!1),l.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}},ox=class extends Uh{constructor(e){super(e)}load(e,t,i,s){let o=new La,c=new wC(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(l){o.image=l,o.needsUpdate=!0,t!==void 0&&t(o)},i,s),o}},Jf=class extends mo{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Si(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},jw=new yi,zO=new Et,GO=new Et,Rg=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gr(512,512),this.map=null,this.mapPass=null,this.matrix=new yi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wg,this._frameExtents=new gr(1,1),this._viewportCount=1,this._viewports=[new br(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;zO.setFromMatrixPosition(e.matrixWorld),t.position.copy(zO),GO.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(GO),t.updateMatrixWorld(),jw.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jw),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(jw)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},CC=class extends Rg{constructor(){super(new to(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=jf*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||s!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=s,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},ax=class extends Jf{constructor(e,t,i=0,s=Math.PI/3,o=0,c=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mo.DEFAULT_UP),this.updateMatrix(),this.target=new mo,this.distance=i,this.angle=s,this.penumbra=o,this.decay=c,this.map=null,this.shadow=new CC}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},WO=new yi,fg=new Et,Qw=new Et,SC=class extends Rg{constructor(){super(new to(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gr(4,2),this._viewportCount=6,this._viewports=[new br(2,1,1,1),new br(0,1,1,1),new br(3,1,1,1),new br(1,1,1,1),new br(3,0,1,1),new br(1,0,1,1)],this._cubeDirections=[new Et(1,0,0),new Et(-1,0,0),new Et(0,0,1),new Et(0,0,-1),new Et(0,1,0),new Et(0,-1,0)],this._cubeUps=[new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,0,1),new Et(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,s=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),fg.setFromMatrixPosition(e.matrixWorld),i.position.copy(fg),Qw.copy(i.position),Qw.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Qw),i.updateMatrixWorld(),s.makeTranslation(-fg.x,-fg.y,-fg.z),WO.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(WO)}},Dg=class extends Jf{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new SC}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},TC=class extends Rg{constructor(){super(new qf(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},cx=class extends Jf{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mo.DEFAULT_UP),this.updateMatrix(),this.target=new mo,this.shadow=new TC}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},lx=class extends Jf{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},ux=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,s=e.length;i<s;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},NC="\\[\\]\\.:\\/",xZ=new RegExp("["+NC+"]","g"),FC="[^"+NC+"]",EZ="[^"+NC.replace("\\.","")+"]",_Z=/((?:WC+[\/:])*)/.source.replace("WC",FC),bZ=/(WCOD+)?/.source.replace("WCOD",EZ),MZ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",FC),wZ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",FC),CZ=new RegExp("^"+_Z+bZ+MZ+wZ+"$"),SZ=["material","materials","bones","map"],IC=class{constructor(e,t,i){let s=i||qr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},qr=(()=>{class n{constructor(t,i,s){this.path=i,this.parsedPath=s||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,s):new n(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(xZ,"")}static parseTrackName(t){let i=CZ.exec(t);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=s.nodeName&&s.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let c=s.nodeName.substring(o+1);SZ.indexOf(c)!==-1&&(s.nodeName=s.nodeName.substring(0,o),s.objectName=c)}if(s.propertyName===null||s.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(i===void 0||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){let s=t.skeleton.getBoneByName(i);if(s!==void 0)return s}if(t.children){let s=function(c){for(let l=0;l<c.length;l++){let u=c[l];if(u.name===i||u.uuid===i)return u;let h=s(u.children);if(h)return h}return null},o=s(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)t[i++]=s[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node,i=this.parsedPath,s=i.objectName,o=i.propertyName,c=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(s){let p=i.objectIndex;switch(s){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===p){p=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[s]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[s]}if(p!==void 0){if(t[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[p]}}let l=t[o];if(l===void 0){let p=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+o+" but it wasn't found.",t);return}let u=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(c!==void 0){if(o==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[c]!==void 0&&(c=t.morphTargetDictionary[c])}h=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=c}else l.fromArray!==void 0&&l.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(h=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=o;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=IC,n})();qr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qr.prototype.GetterByBindingType=[qr.prototype._getValue_direct,qr.prototype._getValue_array,qr.prototype._getValue_arrayElement,qr.prototype._getValue_toArray];qr.prototype.SetterByBindingTypeAndVersioning=[[qr.prototype._setValue_direct,qr.prototype._setValue_direct_setNeedsUpdate,qr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qr.prototype._setValue_array,qr.prototype._setValue_array_setNeedsUpdate,qr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qr.prototype._setValue_arrayElement,qr.prototype._setValue_arrayElement_setNeedsUpdate,qr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qr.prototype._setValue_fromArray,qr.prototype._setValue_fromArray_setNeedsUpdate,qr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];Bpe=new Float32Array(1);typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:RC}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=RC)});function _N(n,e){return NZ((UZ(n),n.subarray(2,-4)),e)}var pN,TZ,Ba,gu,VC,mN,gN,IZ,AN,vN,yN,RZ,xN,DZ,Fpe,HC,pl,Lr,Lg,Pg,Lr,Lr,Lr,Lr,EN,Lr,LZ,PZ,UC,tc,kC,BZ,OZ,NZ,FZ,UZ,kZ,VZ,bN=zc(()=>{"use strict";pN=function(n){return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))},TZ=function(n){return new Worker(n)};try{URL.revokeObjectURL(pN(""))}catch{pN=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},TZ=function(e){return new Worker(e,{type:"module"})}}Ba=Uint8Array,gu=Uint16Array,VC=Uint32Array,mN=new Ba([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gN=new Ba([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),IZ=new Ba([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),AN=function(n,e){for(var t=new gu(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var s=new VC(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)s[o]=o-t[i]<<5|i;return[t,s]},vN=AN(mN,2),yN=vN[0],RZ=vN[1];yN[28]=258,RZ[258]=28;xN=AN(gN,0),DZ=xN[0],Fpe=xN[1],HC=new gu(32768);for(Lr=0;Lr<32768;++Lr)pl=(Lr&43690)>>>1|(Lr&21845)<<1,pl=(pl&52428)>>>2|(pl&13107)<<2,pl=(pl&61680)>>>4|(pl&3855)<<4,HC[Lr]=((pl&65280)>>>8|(pl&255)<<8)>>>1;Lg=function(n,e,t){for(var i=n.length,s=0,o=new gu(e);s<i;++s)++o[n[s]-1];var c=new gu(e);for(s=0;s<e;++s)c[s]=c[s-1]+o[s-1]<<1;var l;if(t){l=new gu(1<<e);var u=15-e;for(s=0;s<i;++s)if(n[s])for(var h=s<<4|n[s],p=e-n[s],f=c[n[s]-1]++<<p,m=f|(1<<p)-1;f<=m;++f)l[HC[f]>>>u]=h}else for(l=new gu(i),s=0;s<i;++s)n[s]&&(l[s]=HC[c[n[s]-1]++]>>>15-n[s]);return l},Pg=new Ba(288);for(Lr=0;Lr<144;++Lr)Pg[Lr]=8;for(Lr=144;Lr<256;++Lr)Pg[Lr]=9;for(Lr=256;Lr<280;++Lr)Pg[Lr]=7;for(Lr=280;Lr<288;++Lr)Pg[Lr]=8;EN=new Ba(32);for(Lr=0;Lr<32;++Lr)EN[Lr]=5;LZ=Lg(Pg,9,1),PZ=Lg(EN,5,1),UC=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},tc=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},kC=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},BZ=function(n){return(n/8|0)+(n&7&&1)},OZ=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof gu?gu:n instanceof VC?VC:Ba)(t-e);return i.set(n.subarray(e,t)),i},NZ=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new Ba(0);var s=!e||t,o=!t||t.i;t||(t={}),e||(e=new Ba(i*3));var c=function(ut){var it=e.length;if(ut>it){var gt=new Ba(Math.max(it*2,ut));gt.set(e),e=gt}},l=t.f||0,u=t.p||0,h=t.b||0,p=t.l,f=t.d,m=t.m,A=t.n,y=i*8;do{if(!p){t.f=l=tc(n,u,1);var E=tc(n,u+1,3);if(u+=3,E)if(E==1)p=LZ,f=PZ,m=9,A=5;else if(E==2){var M=tc(n,u,31)+257,T=tc(n,u+10,15)+4,D=M+tc(n,u+5,31)+1;u+=14;for(var L=new Ba(D),I=new Ba(19),F=0;F<T;++F)I[IZ[F]]=tc(n,u+F*3,7);u+=T*3;for(var R=UC(I),N=(1<<R)-1,X=Lg(I,R,1),F=0;F<D;){var $=X[tc(n,u,N)];u+=$&15;var x=$>>>4;if(x<16)L[F++]=x;else{var te=0,U=0;for(x==16?(U=3+tc(n,u,3),u+=2,te=L[F-1]):x==17?(U=3+tc(n,u,7),u+=3):x==18&&(U=11+tc(n,u,127),u+=7);U--;)L[F++]=te}}var P=L.subarray(0,M),k=L.subarray(M);m=UC(P),A=UC(k),p=Lg(P,m,1),f=Lg(k,A,1)}else throw"invalid block type";else{var x=BZ(u)+4,v=n[x-4]|n[x-3]<<8,w=x+v;if(w>i){if(o)throw"unexpected EOF";break}s&&c(h+v),e.set(n.subarray(x,w),h),t.b=h+=v,t.p=u=w*8;continue}if(u>y){if(o)throw"unexpected EOF";break}}s&&c(h+131072);for(var z=(1<<m)-1,Q=(1<<A)-1,Z=u;;Z=u){var te=p[kC(n,u)&z],ce=te>>>4;if(u+=te&15,u>y){if(o)throw"unexpected EOF";break}if(!te)throw"invalid length/literal";if(ce<256)e[h++]=ce;else if(ce==256){Z=u,p=null;break}else{var Me=ce-254;if(ce>264){var F=ce-257,xe=mN[F];Me=tc(n,u,(1<<xe)-1)+yN[F],u+=xe}var be=f[kC(n,u)&Q],Fe=be>>>4;if(!be)throw"invalid distance";u+=be&15;var k=DZ[Fe];if(Fe>3){var xe=gN[Fe];k+=kC(n,u)&(1<<xe)-1,u+=xe}if(u>y){if(o)throw"unexpected EOF";break}s&&c(h+131072);for(var Ze=h+Me;h<Ze;h+=4)e[h]=e[h-k],e[h+1]=e[h+1-k],e[h+2]=e[h+2-k],e[h+3]=e[h+3-k];h=Ze}}t.l=p,t.p=Z,t.b=h,p&&(l=1,t.m=m,t.d=f,t.n=A)}while(!l);return h==e.length?e:OZ(e,0,h)},FZ=new Ba(0),UZ=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};kZ=typeof TextDecoder<"u"&&new TextDecoder,VZ=0;try{kZ.decode(FZ,{stream:!0}),VZ=1}catch{}});function MN(n,e,t){let i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;let s=n,o=i,c=Math.floor((s+o)/2);for(;e<t[c]||e>=t[c+1];)e<t[c]?o=c:s=c,c=Math.floor((s+o)/2);return c}function zZ(n,e,t,i){let s=[],o=[],c=[];s[0]=1;for(let l=1;l<=t;++l){o[l]=e-i[n+1-l],c[l]=i[n+l]-e;let u=0;for(let h=0;h<l;++h){let p=c[h+1],f=o[l-h],m=s[h]/(p+f);s[h]=u+p*m,u=f*m}s[l]=u}return s}function wN(n,e,t,i){let s=MN(n,i,e),o=zZ(s,i,n,e),c=new br(0,0,0,0);for(let l=0;l<=n;++l){let u=t[s-n+l],h=o[l],p=u.w*h;c.x+=u.x*p,c.y+=u.y*p,c.z+=u.z*p,c.w+=u.w*h}return c}function GZ(n,e,t,i,s){let o=[];for(let f=0;f<=t;++f)o[f]=0;let c=[];for(let f=0;f<=i;++f)c[f]=o.slice(0);let l=[];for(let f=0;f<=t;++f)l[f]=o.slice(0);l[0][0]=1;let u=o.slice(0),h=o.slice(0);for(let f=1;f<=t;++f){u[f]=e-s[n+1-f],h[f]=s[n+f]-e;let m=0;for(let A=0;A<f;++A){let y=h[A+1],E=u[f-A];l[f][A]=y+E;let x=l[A][f-1]/l[f][A];l[A][f]=m+y*x,m=E*x}l[f][f]=m}for(let f=0;f<=t;++f)c[0][f]=l[f][t];for(let f=0;f<=t;++f){let m=0,A=1,y=[];for(let E=0;E<=t;++E)y[E]=o.slice(0);y[0][0]=1;for(let E=1;E<=i;++E){let x=0,v=f-E,w=t-E;f>=E&&(y[A][0]=y[m][0]/l[w+1][v],x=y[A][0]*l[v][w]);let M=v>=-1?1:-v,T=f-1<=w?E-1:t-f;for(let L=M;L<=T;++L)y[A][L]=(y[m][L]-y[m][L-1])/l[w+1][v+L],x+=y[A][L]*l[v+L][w];f<=w&&(y[A][E]=-y[m][E-1]/l[w+1][f],x+=y[A][E]*l[f][w]),c[E][f]=x;let D=m;m=A,A=D}}let p=t;for(let f=1;f<=i;++f){for(let m=0;m<=t;++m)c[f][m]*=p;p*=t-f}return c}function WZ(n,e,t,i,s){let o=s<n?s:n,c=[],l=MN(n,i,e),u=GZ(l,i,n,o,e),h=[];for(let p=0;p<t.length;++p){let f=t[p].clone(),m=f.w;f.x*=m,f.y*=m,f.z*=m,h[p]=f}for(let p=0;p<=o;++p){let f=h[l-n].clone().multiplyScalar(u[p][0]);for(let m=1;m<=n;++m)f.add(h[l-n+m].clone().multiplyScalar(u[p][m]));c[p]=f}for(let p=o+1;p<=s+1;++p)c[p]=new br(0,0,0);return c}function jZ(n,e){let t=1;for(let s=2;s<=n;++s)t*=s;let i=1;for(let s=2;s<=e;++s)i*=s;for(let s=2;s<=n-e;++s)i*=s;return t/i}function QZ(n){let e=n.length,t=[],i=[];for(let o=0;o<e;++o){let c=n[o];t[o]=new Et(c.x,c.y,c.z),i[o]=c.w}let s=[];for(let o=0;o<e;++o){let c=t[o].clone();for(let l=1;l<=o;++l)c.sub(s[o-l].clone().multiplyScalar(jZ(o,l)*i[l]));s[o]=c.divideScalar(i[0])}return s}function CN(n,e,t,i,s){let o=WZ(n,e,t,i,s);return QZ(o)}var SN=zc(()=>{"use strict";gx()});var Ax,TN=zc(()=>{"use strict";gx();SN();Ax=class extends Zy{constructor(e,t,i,s,o){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=s||0,this.endKnot=o||this.knots.length-1;for(let c=0;c<i.length;++c){let l=i[c];this.controlPoints[c]=new br(l.x,l.y,l.z,l.w)}}getPoint(e,t=new Et){let i=t,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=wN(this.degree,this.knots,this.controlPoints,s);return o.w!==1&&o.divideScalar(o.w),i.set(o.x,o.y,o.z)}getTangent(e,t=new Et){let i=t,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=CN(this.degree,this.knots,this.controlPoints,s,1);return i.copy(o[1]).normalize(),i}}});function qZ(n){let e="Kaydara FBX Binary  \0";return n.byteLength>=e.length&&e===LN(n,0,e.length)}function YZ(n){let e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],t=0;function i(s){let o=n[s-1];return n=n.slice(t+s),t++,o}for(let s=0;s<e.length;++s)if(i(1)===e[s])return!1;return!0}function IN(n){let e=/FBXVersion: (\d+)/,t=n.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function KZ(n){return n/46186158e3}function vx(n,e,t,i){let s;switch(i.mappingType){case"ByPolygonVertex":s=n;break;case"ByPolygon":s=e;break;case"ByVertice":s=t;break;case"AllSame":s=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(s=i.indices[s]);let o=s*i.dataSize,c=o+i.dataSize;return ZZ($Z,i.buffer,o,c)}function RN(n){let e=new yi,t=new yi,i=new yi,s=new yi,o=new yi,c=new yi,l=new yi,u=new yi,h=new yi,p=new yi,f=new yi,m=new yi,A=n.inheritType?n.inheritType:0;if(n.translation&&e.setPosition(ep.fromArray(n.translation)),n.preRotation){let N=n.preRotation.map(go.degToRad);N.push(n.eulerOrder||Pa.DEFAULT_ORDER),t.makeRotationFromEuler(zC.fromArray(N))}if(n.rotation){let N=n.rotation.map(go.degToRad);N.push(n.eulerOrder||Pa.DEFAULT_ORDER),i.makeRotationFromEuler(zC.fromArray(N))}if(n.postRotation){let N=n.postRotation.map(go.degToRad);N.push(n.eulerOrder||Pa.DEFAULT_ORDER),s.makeRotationFromEuler(zC.fromArray(N)),s.invert()}n.scale&&o.scale(ep.fromArray(n.scale)),n.scalingOffset&&l.setPosition(ep.fromArray(n.scalingOffset)),n.scalingPivot&&c.setPosition(ep.fromArray(n.scalingPivot)),n.rotationOffset&&u.setPosition(ep.fromArray(n.rotationOffset)),n.rotationPivot&&h.setPosition(ep.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(f.copy(n.parentMatrix),p.copy(n.parentMatrixWorld));let y=t.clone().multiply(i).multiply(s),E=new yi;E.extractRotation(p);let x=new yi;x.copyPosition(p);let v=x.clone().invert().multiply(p),w=E.clone().invert().multiply(v),M=o,T=new yi;if(A===0)T.copy(E).multiply(y).multiply(w).multiply(M);else if(A===1)T.copy(E).multiply(w).multiply(y).multiply(M);else{let X=new yi().scale(new Et().setFromMatrixScale(f)).clone().invert(),$=w.clone().multiply(X);T.copy(E).multiply(y).multiply($).multiply(M)}let D=h.clone().invert(),L=c.clone().invert(),I=e.clone().multiply(u).multiply(h).multiply(t).multiply(i).multiply(s).multiply(D).multiply(l).multiply(c).multiply(o).multiply(L),F=new yi().copyPosition(I),R=p.clone().multiply(F);return m.copyPosition(R),I=m.clone().multiply(T),I.premultiply(p.invert()),I}function DN(n){n=n||0;let e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return n===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function GC(n){return n.split(",").map(function(t){return parseFloat(t)})}function LN(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=n.byteLength),new TextDecoder().decode(new Uint8Array(n,e,t))}function JZ(n,e){for(let t=0,i=n.length,s=e.length;t<s;t++,i++)n[i]=e[t]}function ZZ(n,e,t,i){for(let s=t,o=0;s<i;s++,o++)n[o]=e[s];return n}var nr,ps,Do,yx,WC,jC,QC,XC,qC,xx,Ex,$Z,zC,ep,PN=zc(()=>{"use strict";gx();bN();TN();yx=class extends Uh{constructor(e){super(e)}load(e,t,i,s){let o=this,c=o.path===""?ux.extractUrlBase(e):o.path,l=new sx(this.manager);l.setPath(o.path),l.setResponseType("arraybuffer"),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(u){try{t(o.parse(u,c))}catch(h){s?s(h):console.error(h),o.manager.itemError(e)}},i,s)}parse(e,t){if(qZ(e))nr=new qC().parse(e);else{let s=LN(e);if(!YZ(s))throw new Error("THREE.FBXLoader: Unknown format.");if(IN(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+IN(s));nr=new XC().parse(s)}let i=new ox(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new WC(i,this.manager).parse(nr)}},WC=class{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){ps=this.parseConnections();let e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),s=this.parseDeformers(),o=new jC().parse(s);return this.parseScene(s,o,i),Do}parseConnections(){let e=new Map;return"Connections"in nr&&nr.Connections.connections.forEach(function(i){let s=i[0],o=i[1],c=i[2];e.has(s)||e.set(s,{parents:[],children:[]});let l={ID:o,relationship:c};e.get(s).parents.push(l),e.has(o)||e.set(o,{parents:[],children:[]});let u={ID:s,relationship:c};e.get(o).children.push(u)}),e}parseImages(){let e={},t={};if("Video"in nr.Objects){let i=nr.Objects.Video;for(let s in i){let o=i[s],c=parseInt(s);if(e[c]=o.RelativeFilename||o.Filename,"Content"in o){let l=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,u=typeof o.Content=="string"&&o.Content!=="";if(l||u){let h=this.parseImage(i[s]);t[o.RelativeFilename||o.Filename]=h}}}}for(let i in e){let s=e[i];t[s]!==void 0?e[i]=t[s]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){let t=e.Content,i=e.RelativeFilename||e.Filename,s=i.slice(i.lastIndexOf(".")+1).toLowerCase(),o;switch(s){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),o="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof t=="string")return"data:"+o+";base64,"+t;{let c=new Uint8Array(t);return window.URL.createObjectURL(new Blob([c],{type:o}))}}parseTextures(e){let t=new Map;if("Texture"in nr.Objects){let i=nr.Objects.Texture;for(let s in i){let o=this.parseTexture(i[s],e);t.set(parseInt(s),o)}}return t}parseTexture(e,t){let i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;let s=e.WrapModeU,o=e.WrapModeV,c=s!==void 0?s.value:0,l=o!==void 0?o.value:0;if(i.wrapS=c===0?Gf:Go,i.wrapT=l===0?Gf:Go,"Scaling"in e){let u=e.Scaling.value;i.repeat.x=u[0],i.repeat.y=u[1]}if("Translation"in e){let u=e.Translation.value;i.offset.x=u[0],i.offset.y=u[1]}return i}loadTexture(e,t){let i,s=this.textureLoader.path,o=ps.get(e.id).children;o!==void 0&&o.length>0&&t[o[0].ID]!==void 0&&(i=t[o[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let c,l=e.FileName.slice(-3).toLowerCase();if(l==="tga"){let u=this.manager.getHandler(".tga");u===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),c=new La):(u.setPath(this.textureLoader.path),c=u.load(i))}else if(l==="dds"){let u=this.manager.getHandler(".dds");u===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),c=new La):(u.setPath(this.textureLoader.path),c=u.load(i))}else l==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),c=new La):c=this.textureLoader.load(i);return this.textureLoader.setPath(s),c}parseMaterials(e){let t=new Map;if("Material"in nr.Objects){let i=nr.Objects.Material;for(let s in i){let o=this.parseMaterial(i[s],e);o!==null&&t.set(parseInt(s),o)}}return t}parseMaterial(e,t){let i=e.id,s=e.attrName,o=e.ShadingModel;if(typeof o=="object"&&(o=o.value),!ps.has(i))return null;let c=this.parseParameters(e,t,i),l;switch(o.toLowerCase()){case"phong":l=new Kf;break;case"lambert":l=new tx;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),l=new Kf;break}return l.setValues(c),l.name=s,l}parseParameters(e,t,i){let s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new Si().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new Si().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new Si().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new Si().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new Si().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new Si().fromArray(e.SpecularColor.value).convertSRGBToLinear());let o=this;return ps.get(i).children.forEach(function(c){let l=c.relationship;switch(l){case"Bump":s.bumpMap=o.getTexture(t,c.ID);break;case"Maya|TEX_ao_map":s.aoMap=o.getTexture(t,c.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=o.getTexture(t,c.ID),s.map!==void 0&&(s.map.colorSpace=cs);break;case"DisplacementColor":s.displacementMap=o.getTexture(t,c.ID);break;case"EmissiveColor":s.emissiveMap=o.getTexture(t,c.ID),s.emissiveMap!==void 0&&(s.emissiveMap.colorSpace=cs);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=o.getTexture(t,c.ID);break;case"ReflectionColor":s.envMap=o.getTexture(t,c.ID),s.envMap!==void 0&&(s.envMap.mapping=yg,s.envMap.colorSpace=cs);break;case"SpecularColor":s.specularMap=o.getTexture(t,c.ID),s.specularMap!==void 0&&(s.specularMap.colorSpace=cs);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=o.getTexture(t,c.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l);break}}),s}getTexture(e,t){return"LayeredTexture"in nr.Objects&&t in nr.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=ps.get(t).children[0].ID),e.get(t)}parseDeformers(){let e={},t={};if("Deformer"in nr.Objects){let i=nr.Objects.Deformer;for(let s in i){let o=i[s],c=ps.get(parseInt(s));if(o.attrType==="Skin"){let l=this.parseSkeleton(c,i);l.ID=s,c.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=c.parents[0].ID,e[s]=l}else if(o.attrType==="BlendShape"){let l={id:s};l.rawTargets=this.parseMorphTargets(c,i),l.id=s,c.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[s]=l}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){let i=[];return e.children.forEach(function(s){let o=t[s.ID];if(o.attrType!=="Cluster")return;let c={ID:s.ID,indices:[],weights:[],transformLink:new yi().fromArray(o.TransformLink.a)};"Indexes"in o&&(c.indices=o.Indexes.a,c.weights=o.Weights.a),i.push(c)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){let i=[];for(let s=0;s<e.children.length;s++){let o=e.children[s],c=t[o.ID],l={name:c.attrName,initialWeight:c.DeformPercent,id:c.id,fullWeights:c.FullWeights.a};if(c.attrType!=="BlendShapeChannel")return;l.geoID=ps.get(parseInt(o.ID)).children.filter(function(u){return u.relationship===void 0})[0].ID,i.push(l)}return i}parseScene(e,t,i){Do=new ll;let s=this.parseModels(e.skeletons,t,i),o=nr.Objects.Model,c=this;s.forEach(function(u){let h=o[u.ID];c.setLookAtProperties(u,h),ps.get(u.ID).parents.forEach(function(f){let m=s.get(f.ID);m!==void 0&&m.add(u)}),u.parent===null&&Do.add(u)}),this.bindSkeleton(e.skeletons,t,s),this.addGlobalSceneSettings(),Do.traverse(function(u){if(u.userData.transformData){u.parent&&(u.userData.transformData.parentMatrix=u.parent.matrix,u.userData.transformData.parentMatrixWorld=u.parent.matrixWorld);let h=RN(u.userData.transformData);u.applyMatrix4(h),u.updateWorldMatrix()}});let l=new QC().parse();Do.children.length===1&&Do.children[0].isGroup&&(Do.children[0].animations=l,Do=Do.children[0]),Do.animations=l}parseModels(e,t,i){let s=new Map,o=nr.Objects.Model;for(let c in o){let l=parseInt(c),u=o[c],h=ps.get(l),p=this.buildSkeleton(h,e,l,u.attrName);if(!p){switch(u.attrType){case"Camera":p=this.createCamera(h);break;case"Light":p=this.createLight(h);break;case"Mesh":p=this.createMesh(h,t,i);break;case"NurbsCurve":p=this.createCurve(h,t);break;case"LimbNode":case"Root":p=new Yf;break;case"Null":default:p=new ll;break}p.name=u.attrName?qr.sanitizeNodeName(u.attrName):"",p.userData.originalName=u.attrName,p.ID=l}this.getTransformData(p,u),s.set(l,p)}return s}buildSkeleton(e,t,i,s){let o=null;return e.parents.forEach(function(c){for(let l in t){let u=t[l];u.rawBones.forEach(function(h,p){if(h.ID===c.ID){let f=o;o=new Yf,o.matrixWorld.copy(h.transformLink),o.name=s?qr.sanitizeNodeName(s):"",o.userData.originalName=s,o.ID=i,u.bones[p]=o,f!==null&&o.add(f)}})}}),o}createCamera(e){let t,i;if(e.children.forEach(function(s){let o=nr.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)t=new mo;else{let s=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(s=1);let o=1;i.NearPlane!==void 0&&(o=i.NearPlane.value/1e3);let c=1e3;i.FarPlane!==void 0&&(c=i.FarPlane.value/1e3);let l=window.innerWidth,u=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(l=i.AspectWidth.value,u=i.AspectHeight.value);let h=l/u,p=45;i.FieldOfView!==void 0&&(p=i.FieldOfView.value);let f=i.FocalLength?i.FocalLength.value:null;switch(s){case 0:t=new to(p,h,o,c),f!==null&&t.setFocalLength(f);break;case 1:t=new qf(-l/2,l/2,u/2,-u/2,o,c);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),t=new mo;break}}return t}createLight(e){let t,i;if(e.children.forEach(function(s){let o=nr.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)t=new mo;else{let s;i.LightType===void 0?s=0:s=i.LightType.value;let o=16777215;i.Color!==void 0&&(o=new Si().fromArray(i.Color.value).convertSRGBToLinear());let c=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(c=0);let l=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?l=0:l=i.FarAttenuationEnd.value);let u=1;switch(s){case 0:t=new Dg(o,c,l,u);break;case 1:t=new cx(o,c);break;case 2:let h=Math.PI/3;i.InnerAngle!==void 0&&(h=go.degToRad(i.InnerAngle.value));let p=0;i.OuterAngle!==void 0&&(p=go.degToRad(i.OuterAngle.value),p=Math.max(p,1)),t=new ax(o,c,l,h,p,u);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new Dg(o,c);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,i){let s,o=null,c=null,l=[];return e.children.forEach(function(u){t.has(u.ID)&&(o=t.get(u.ID)),i.has(u.ID)&&l.push(i.get(u.ID))}),l.length>1?c=l:l.length>0?c=l[0]:(c=new Kf({name:Uh.DEFAULT_MATERIAL_NAME,color:13421772}),l.push(c)),"color"in o.attributes&&l.forEach(function(u){u.vertexColors=!0}),o.FBX_Deformer?(s=new Ky(o,c),s.normalizeSkinWeights()):s=new la(o,c),s}createCurve(e,t){let i=e.children.reduce(function(o,c){return t.has(c.ID)&&(o=t.get(c.ID)),o},null),s=new Cg({name:Uh.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Jy(i,s)}getTransformData(e,t){let i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?i.eulerOrder=DN(t.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&ps.get(e.ID).children.forEach(function(s){if(s.relationship==="LookAtProperty"){let o=nr.Objects.Model[s.ID];if("Lcl_Translation"in o){let c=o.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(c),Do.add(e.target)):e.lookAt(new Et().fromArray(c))}}})}bindSkeleton(e,t,i){let s=this.parsePoseNodes();for(let o in e){let c=e[o];ps.get(parseInt(c.ID)).parents.forEach(function(u){if(t.has(u.ID)){let h=u.ID;ps.get(h).parents.forEach(function(f){i.has(f.ID)&&i.get(f.ID).bind(new $y(c.bones),s[f.ID])})}})}}parsePoseNodes(){let e={};if("Pose"in nr.Objects){let t=nr.Objects.Pose;for(let i in t)if(t[i].attrType==="BindPose"&&t[i].NbPoseNodes>0){let s=t[i].PoseNode;Array.isArray(s)?s.forEach(function(o){e[o.Node]=new yi().fromArray(o.Matrix.a)}):e[s.Node]=new yi().fromArray(s.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in nr){if("AmbientColor"in nr.GlobalSettings){let e=nr.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],s=e[2];if(t!==0||i!==0||s!==0){let o=new Si(t,i,s).convertSRGBToLinear();Do.add(new lx(o,1))}}"UnitScaleFactor"in nr.GlobalSettings&&(Do.userData.unitScaleFactor=nr.GlobalSettings.UnitScaleFactor.value)}}},jC=class{constructor(){this.negativeMaterialIndices=!1}parse(e){let t=new Map;if("Geometry"in nr.Objects){let i=nr.Objects.Geometry;for(let s in i){let o=ps.get(parseInt(s)),c=this.parseGeometry(o,i[s],e);t.set(parseInt(s),c)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){let s=i.skeletons,o=[],c=e.parents.map(function(f){return nr.Objects.Model[f.ID]});if(c.length===0)return;let l=e.children.reduce(function(f,m){return s[m.ID]!==void 0&&(f=s[m.ID]),f},null);e.children.forEach(function(f){i.morphTargets[f.ID]!==void 0&&o.push(i.morphTargets[f.ID])});let u=c[0],h={};"RotationOrder"in u&&(h.eulerOrder=DN(u.RotationOrder.value)),"InheritType"in u&&(h.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(h.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(h.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(h.scale=u.GeometricScaling.value);let p=RN(h);return this.genGeometry(t,l,o,p)}genGeometry(e,t,i,s){let o=new Ra;e.attrName&&(o.name=e.attrName);let c=this.parseGeoNode(e,t),l=this.genBuffers(c),u=new no(l.vertex,3);if(u.applyMatrix4(s),o.setAttribute("position",u),l.colors.length>0&&o.setAttribute("color",new no(l.colors,3)),t&&(o.setAttribute("skinIndex",new Qf(l.weightsIndices,4)),o.setAttribute("skinWeight",new no(l.vertexWeights,4)),o.FBX_Deformer=t),l.normal.length>0){let h=new $i().getNormalMatrix(s),p=new no(l.normal,3);p.applyNormalMatrix(h),o.setAttribute("normal",p)}if(l.uvs.forEach(function(h,p){let f=p===0?"uv":`uv${p}`;o.setAttribute(f,new no(l.uvs[p],2))}),c.material&&c.material.mappingType!=="AllSame"){let h=l.materialIndex[0],p=0;if(l.materialIndex.forEach(function(f,m){f!==h&&(o.addGroup(p,m-p,h),h=f,p=m)}),o.groups.length>0){let f=o.groups[o.groups.length-1],m=f.start+f.count;m!==l.materialIndex.length&&o.addGroup(m,l.materialIndex.length-m,h)}o.groups.length===0&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(o,e,i,s),o}parseGeoNode(e,t){let i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return i.weightTable={},t!==null&&(i.skeleton=t,t.rawBones.forEach(function(s,o){s.indices.forEach(function(c,l){i.weightTable[c]===void 0&&(i.weightTable[c]=[]),i.weightTable[c].push({id:o,weight:s.weights[l]})})})),i}genBuffers(e){let t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},i=0,s=0,o=!1,c=[],l=[],u=[],h=[],p=[],f=[],m=this;return e.vertexIndices.forEach(function(A,y){let E,x=!1;A<0&&(A=A^-1,x=!0);let v=[],w=[];if(c.push(A*3,A*3+1,A*3+2),e.color){let M=vx(y,i,A,e.color);u.push(M[0],M[1],M[2])}if(e.skeleton){if(e.weightTable[A]!==void 0&&e.weightTable[A].forEach(function(M){w.push(M.weight),v.push(M.id)}),w.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);let M=[0,0,0,0],T=[0,0,0,0];w.forEach(function(D,L){let I=D,F=v[L];T.forEach(function(R,N,X){if(I>R){X[N]=I,I=R;let $=M[N];M[N]=F,F=$}})}),v=M,w=T}for(;w.length<4;)w.push(0),v.push(0);for(let M=0;M<4;++M)p.push(w[M]),f.push(v[M])}if(e.normal){let M=vx(y,i,A,e.normal);l.push(M[0],M[1],M[2])}e.material&&e.material.mappingType!=="AllSame"&&(E=vx(y,i,A,e.material)[0],E<0&&(m.negativeMaterialIndices=!0,E=0)),e.uv&&e.uv.forEach(function(M,T){let D=vx(y,i,A,M);h[T]===void 0&&(h[T]=[]),h[T].push(D[0]),h[T].push(D[1])}),s++,x&&(m.genFace(t,e,c,E,l,u,h,p,f,s),i++,s=0,c=[],l=[],u=[],h=[],p=[],f=[])}),t}getNormalNewell(e){let t=new Et(0,0,0);for(let i=0;i<e.length;i++){let s=e[i],o=e[(i+1)%e.length];t.x+=(s.y-o.y)*(s.z+o.z),t.y+=(s.z-o.z)*(s.x+o.x),t.z+=(s.x-o.x)*(s.y+o.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){let t=this.getNormalNewell(e),s=(Math.abs(t.z)>.5?new Et(0,1,0):new Et(0,0,1)).cross(t).normalize(),o=t.clone().cross(s).normalize();return{normal:t,tangent:s,bitangent:o}}flattenVertex(e,t,i){return new gr(e.dot(t),e.dot(i))}genFace(e,t,i,s,o,c,l,u,h,p){let f;if(p>3){let m=[];for(let x=0;x<i.length;x+=3)m.push(new Et(t.vertexPositions[i[x]],t.vertexPositions[i[x+1]],t.vertexPositions[i[x+2]]));let{tangent:A,bitangent:y}=this.getNormalTangentAndBitangent(m),E=[];for(let x of m)E.push(this.flattenVertex(x,A,y));f=ex.triangulateShape(E,[])}else f=[[0,1,2]];for(let[m,A,y]of f)e.vertex.push(t.vertexPositions[i[m*3]]),e.vertex.push(t.vertexPositions[i[m*3+1]]),e.vertex.push(t.vertexPositions[i[m*3+2]]),e.vertex.push(t.vertexPositions[i[A*3]]),e.vertex.push(t.vertexPositions[i[A*3+1]]),e.vertex.push(t.vertexPositions[i[A*3+2]]),e.vertex.push(t.vertexPositions[i[y*3]]),e.vertex.push(t.vertexPositions[i[y*3+1]]),e.vertex.push(t.vertexPositions[i[y*3+2]]),t.skeleton&&(e.vertexWeights.push(u[m*4]),e.vertexWeights.push(u[m*4+1]),e.vertexWeights.push(u[m*4+2]),e.vertexWeights.push(u[m*4+3]),e.vertexWeights.push(u[A*4]),e.vertexWeights.push(u[A*4+1]),e.vertexWeights.push(u[A*4+2]),e.vertexWeights.push(u[A*4+3]),e.vertexWeights.push(u[y*4]),e.vertexWeights.push(u[y*4+1]),e.vertexWeights.push(u[y*4+2]),e.vertexWeights.push(u[y*4+3]),e.weightsIndices.push(h[m*4]),e.weightsIndices.push(h[m*4+1]),e.weightsIndices.push(h[m*4+2]),e.weightsIndices.push(h[m*4+3]),e.weightsIndices.push(h[A*4]),e.weightsIndices.push(h[A*4+1]),e.weightsIndices.push(h[A*4+2]),e.weightsIndices.push(h[A*4+3]),e.weightsIndices.push(h[y*4]),e.weightsIndices.push(h[y*4+1]),e.weightsIndices.push(h[y*4+2]),e.weightsIndices.push(h[y*4+3])),t.color&&(e.colors.push(c[m*3]),e.colors.push(c[m*3+1]),e.colors.push(c[m*3+2]),e.colors.push(c[A*3]),e.colors.push(c[A*3+1]),e.colors.push(c[A*3+2]),e.colors.push(c[y*3]),e.colors.push(c[y*3+1]),e.colors.push(c[y*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),t.normal&&(e.normal.push(o[m*3]),e.normal.push(o[m*3+1]),e.normal.push(o[m*3+2]),e.normal.push(o[A*3]),e.normal.push(o[A*3+1]),e.normal.push(o[A*3+2]),e.normal.push(o[y*3]),e.normal.push(o[y*3+1]),e.normal.push(o[y*3+2])),t.uv&&t.uv.forEach(function(E,x){e.uvs[x]===void 0&&(e.uvs[x]=[]),e.uvs[x].push(l[x][m*2]),e.uvs[x].push(l[x][m*2+1]),e.uvs[x].push(l[x][A*2]),e.uvs[x].push(l[x][A*2+1]),e.uvs[x].push(l[x][y*2]),e.uvs[x].push(l[x][y*2+1])})}addMorphTargets(e,t,i,s){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];let o=this;i.forEach(function(c){c.rawTargets.forEach(function(l){let u=nr.Objects.Geometry[l.geoID];u!==void 0&&o.genMorphGeometry(e,t,u,s,l.name)})})}genMorphGeometry(e,t,i,s,o){let c=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],l=i.Vertices!==void 0?i.Vertices.a:[],u=i.Indexes!==void 0?i.Indexes.a:[],h=e.attributes.position.count*3,p=new Float32Array(h);for(let y=0;y<u.length;y++){let E=u[y]*3;p[E]=l[y*3],p[E+1]=l[y*3+1],p[E+2]=l[y*3+2]}let f={vertexIndices:c,vertexPositions:p},m=this.genBuffers(f),A=new no(m.vertex,3);A.name=o||i.attrName,A.applyMatrix4(s),e.morphAttributes.position.push(A)}parseNormals(e){let t=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Normals.a,o=[];return i==="IndexToDirect"&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:o,mappingType:t,referenceType:i}}parseUVs(e){let t=e.MappingInformationType,i=e.ReferenceInformationType,s=e.UV.a,o=[];return i==="IndexToDirect"&&(o=e.UVIndex.a),{dataSize:2,buffer:s,indices:o,mappingType:t,referenceType:i}}parseVertexColors(e){let t=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Colors.a,o=[];i==="IndexToDirect"&&(o=e.ColorIndex.a);for(let c=0,l=new Si;c<s.length;c+=4)l.fromArray(s,c).convertSRGBToLinear().toArray(s,c);return{dataSize:4,buffer:s,indices:o,mappingType:t,referenceType:i}}parseMaterialIndices(e){let t=e.MappingInformationType,i=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};let s=e.Materials.a,o=[];for(let c=0;c<s.length;++c)o.push(c);return{dataSize:1,buffer:s,indices:o,mappingType:t,referenceType:i}}parseNurbsGeometry(e){let t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ra;let i=t-1,s=e.KnotVector.a,o=[],c=e.Points.a;for(let f=0,m=c.length;f<m;f+=4)o.push(new br().fromArray(c,f));let l,u;if(e.Form==="Closed")o.push(o[0]);else if(e.Form==="Periodic"){l=i,u=s.length-1-l;for(let f=0;f<i;++f)o.push(o[f])}let p=new Ax(i,s,o,l,u).getPoints(o.length*12);return new Ra().setFromPoints(p)}},QC=class{parse(){let e=[],t=this.parseClips();if(t!==void 0)for(let i in t){let s=t[i],o=this.addClip(s);e.push(o)}return e}parseClips(){if(nr.Objects.AnimationCurve===void 0)return;let e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);let t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){let e=nr.Objects.AnimationCurveNode,t=new Map;for(let i in e){let s=e[i];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){let o={id:s.id,attr:s.attrName,curves:{}};t.set(o.id,o)}}return t}parseAnimationCurves(e){let t=nr.Objects.AnimationCurve;for(let i in t){let s={id:t[i].id,times:t[i].KeyTime.a.map(KZ),values:t[i].KeyValueFloat.a},o=ps.get(s.id);if(o!==void 0){let c=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?e.get(c).curves.x=s:l.match(/Y/)?e.get(c).curves.y=s:l.match(/Z/)?e.get(c).curves.z=s:l.match(/DeformPercent/)&&e.has(c)&&(e.get(c).curves.morph=s)}}}parseAnimationLayers(e){let t=nr.Objects.AnimationLayer,i=new Map;for(let s in t){let o=[],c=ps.get(parseInt(s));c!==void 0&&(c.children.forEach(function(u,h){if(e.has(u.ID)){let p=e.get(u.ID);if(p.curves.x!==void 0||p.curves.y!==void 0||p.curves.z!==void 0){if(o[h]===void 0){let f=ps.get(u.ID).parents.filter(function(m){return m.relationship!==void 0})[0].ID;if(f!==void 0){let m=nr.Objects.Model[f.toString()];if(m===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",u);return}let A={modelName:m.attrName?qr.sanitizeNodeName(m.attrName):"",ID:m.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Do.traverse(function(y){y.ID===m.id&&(A.transform=y.matrix,y.userData.transformData&&(A.eulerOrder=y.userData.transformData.eulerOrder))}),A.transform||(A.transform=new yi),"PreRotation"in m&&(A.preRotation=m.PreRotation.value),"PostRotation"in m&&(A.postRotation=m.PostRotation.value),o[h]=A}}o[h]&&(o[h][p.attr]=p)}else if(p.curves.morph!==void 0){if(o[h]===void 0){let f=ps.get(u.ID).parents.filter(function(v){return v.relationship!==void 0})[0].ID,m=ps.get(f).parents[0].ID,A=ps.get(m).parents[0].ID,y=ps.get(A).parents[0].ID,E=nr.Objects.Model[y],x={modelName:E.attrName?qr.sanitizeNodeName(E.attrName):"",morphName:nr.Objects.Deformer[f].attrName};o[h]=x}o[h][p.attr]=p}}}),i.set(parseInt(s),o))}return i}parseAnimStacks(e){let t=nr.Objects.AnimationStack,i={};for(let s in t){let o=ps.get(parseInt(s)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");let c=e.get(o[0].ID);i[s]={name:t[s].attrName,layer:c}}return i}addClip(e){let t=[],i=this;return e.layer.forEach(function(s){t=t.concat(i.generateTracks(s))}),new ix(e.name,-1,t)}generateTracks(e){let t=[],i=new Et,s=new Et;if(e.transform&&e.transform.decompose(i,new io,s),i=i.toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){let o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");o!==void 0&&t.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){let o=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&t.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){let o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&t.push(o)}if(e.DeformPercent!==void 0){let o=this.generateMorphTrack(e);o!==void 0&&t.push(o)}return t}generateVectorTrack(e,t,i,s){let o=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(o,t,i);return new pu(e+"."+s,o,c)}generateRotationTrack(e,t,i,s,o){let c,l;if(t.x!==void 0&&t.y!==void 0&&t.z!==void 0){let f=this.interpolateRotations(t.x,t.y,t.z,o);c=f[0],l=f[1]}i!==void 0&&(i=i.map(go.degToRad),i.push(o),i=new Pa().fromArray(i),i=new io().setFromEuler(i)),s!==void 0&&(s=s.map(go.degToRad),s.push(o),s=new Pa().fromArray(s),s=new io().setFromEuler(s).invert());let u=new io,h=new Pa,p=[];if(!l||!c)return new Sc(e+".quaternion",[],[]);for(let f=0;f<l.length;f+=3)h.set(l[f],l[f+1],l[f+2],o),u.setFromEuler(h),i!==void 0&&u.premultiply(i),s!==void 0&&u.multiply(s),f>2&&new io().fromArray(p,(f-3)/3*4).dot(u)<0&&u.set(-u.x,-u.y,-u.z,-u.w),u.toArray(p,f/3*4);return new Sc(e+".quaternion",c,p)}generateMorphTrack(e){let t=e.DeformPercent.curves.morph,i=t.values.map(function(o){return o/100}),s=Do.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new du(e.modelName+".morphTargetInfluences["+s+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(i,s){return i-s}),t.length>1){let i=1,s=t[0];for(let o=1;o<t.length;o++){let c=t[o];c!==s&&(t[i]=c,s=c,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){let s=i,o=[],c=-1,l=-1,u=-1;return e.forEach(function(h){if(t.x&&(c=t.x.times.indexOf(h)),t.y&&(l=t.y.times.indexOf(h)),t.z&&(u=t.z.times.indexOf(h)),c!==-1){let p=t.x.values[c];o.push(p),s[0]=p}else o.push(s[0]);if(l!==-1){let p=t.y.values[l];o.push(p),s[1]=p}else o.push(s[1]);if(u!==-1){let p=t.z.values[u];o.push(p),s[2]=p}else o.push(s[2])}),o}interpolateRotations(e,t,i,s){let o=[],c=[];o.push(e.times[0]),c.push(go.degToRad(e.values[0])),c.push(go.degToRad(t.values[0])),c.push(go.degToRad(i.values[0]));for(let l=1;l<e.values.length;l++){let u=[e.values[l-1],t.values[l-1],i.values[l-1]];if(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))continue;let h=u.map(go.degToRad),p=[e.values[l],t.values[l],i.values[l]];if(isNaN(p[0])||isNaN(p[1])||isNaN(p[2]))continue;let f=p.map(go.degToRad),m=[p[0]-u[0],p[1]-u[1],p[2]-u[2]],A=[Math.abs(m[0]),Math.abs(m[1]),Math.abs(m[2])];if(A[0]>=180||A[1]>=180||A[2]>=180){let E=Math.max(...A)/180,x=new Pa(...h,s),v=new Pa(...f,s),w=new io().setFromEuler(x),M=new io().setFromEuler(v);w.dot(M)&&M.set(-M.x,-M.y,-M.z,-M.w);let T=e.times[l-1],D=e.times[l]-T,L=new io,I=new Pa;for(let F=0;F<1;F+=1/E)L.copy(w.clone().slerp(M.clone(),F)),o.push(T+F*D),I.setFromQuaternion(L,s),c.push(I.x),c.push(I.y),c.push(I.z)}else o.push(e.times[l]),c.push(go.degToRad(e.values[l])),c.push(go.degToRad(t.values[l])),c.push(go.degToRad(i.values[l]))}return[o,c]}},XC=class{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new Ex,this.nodeStack=[],this.currentProp=[],this.currentPropName="";let t=this,i=e.split(/[\r\n]+/);return i.forEach(function(s,o){let c=s.match(/^[\s\t]*;/),l=s.match(/^[\s\t]*$/);if(c||l)return;let u=s.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),h=s.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),p=s.match("^\\t{"+(t.currentIndent-1)+"}}");u?t.parseNodeBegin(s,u):h?t.parseNodeProperty(s,h,i[++o]):p?t.popStack():s.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,t){let i=t[1].trim().replace(/^"/,"").replace(/"$/,""),s=t[2].split(",").map(function(u){return u.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:i},c=this.parseNodeAttr(s),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,o):i in l?(i==="PoseNode"?l.PoseNode.push(o):l[i].id!==void 0&&(l[i]={},l[i][l[i].id]=l[i]),c.id!==""&&(l[i][c.id]=o)):typeof c.id=="number"?(l[i]={},l[i][c.id]=o):i!=="Properties70"&&(i==="PoseNode"?l[i]=[o]:l[i]=o),typeof c.id=="number"&&(o.id=c.id),c.name!==""&&(o.attrName=c.name),c.type!==""&&(o.attrType=c.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",s="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:t,name:i,type:s}}parseNodeProperty(e,t,i){let s=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&o===","&&(o=i.replace(/"/g,"").replace(/,$/,"").trim());let c=this.getCurrentNode();if(c.name==="Properties70"){this.parseNodeSpecialProperty(e,s,o);return}if(s==="C"){let u=o.split(",").slice(1),h=parseInt(u[0]),p=parseInt(u[1]),f=o.split(",").slice(3);f=f.map(function(m){return m.trim().replace(/^"/,"")}),s="connections",o=[h,p],JZ(o,f),c[s]===void 0&&(c[s]=[])}s==="Node"&&(c.id=o),s in c&&Array.isArray(c[s])?c[s].push(o):s!=="a"?c[s]=o:c.a=o,this.setCurrentProp(c,s),s==="a"&&o.slice(-1)!==","&&(c.a=GC(o))}parseNodePropertyContinued(e){let t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=GC(t.a))}parseNodeSpecialProperty(e,t,i){let s=i.split('",').map(function(p){return p.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=s[0],c=s[1],l=s[2],u=s[3],h=s[4];switch(c){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=GC(h);break}this.getPrevNode()[o]={type:c,type2:l,flag:u,value:h},this.setCurrentProp(this.getPrevNode(),o)}},qC=class{parse(e){let t=new xx(e);t.skip(23);let i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);let s=new Ex;for(;!this.endOfContent(t);){let o=this.parseNode(t,i);o!==null&&s.add(o.name,o)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){let i={},s=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();let c=e.getUint8(),l=e.getString(c);if(s===0)return null;let u=[];for(let m=0;m<o;m++)u.push(this.parseProperty(e));let h=u.length>0?u[0]:"",p=u.length>1?u[1]:"",f=u.length>2?u[2]:"";for(i.singleProperty=o===1&&e.getOffset()===s;s>e.getOffset();){let m=this.parseNode(e,t);m!==null&&this.parseSubNode(l,i,m)}return i.propertyList=u,typeof h=="number"&&(i.id=h),p!==""&&(i.attrName=p),f!==""&&(i.attrType=f),l!==""&&(i.name=l),i}parseSubNode(e,t,i){if(i.singleProperty===!0){let s=i.propertyList[0];Array.isArray(s)?(t[i.name]=i,i.a=s):t[i.name]=s}else if(e==="Connections"&&i.name==="C"){let s=[];i.propertyList.forEach(function(o,c){c!==0&&s.push(o)}),t.connections===void 0&&(t.connections=[]),t.connections.push(s)}else if(i.name==="Properties70")Object.keys(i).forEach(function(o){t[o]=i[o]});else if(e==="Properties70"&&i.name==="P"){let s=i.propertyList[0],o=i.propertyList[1],c=i.propertyList[2],l=i.propertyList[3],u;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),o==="Color"||o==="ColorRGB"||o==="Vector"||o==="Vector3D"||o.indexOf("Lcl_")===0?u=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:u=i.propertyList[4],t[s]={type:o,type2:c,flag:l,value:u}}else t[i.name]===void 0?typeof i.id=="number"?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:i.name==="PoseNode"?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):t[i.name][i.id]===void 0&&(t[i.name][i.id]=i)}parseProperty(e){let t=e.getString(1),i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":let s=e.getUint32(),o=e.getUint32(),c=e.getUint32();if(o===0)switch(t){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}let l=_N(new Uint8Array(e.getArrayBuffer(c))),u=new xx(l.buffer);switch(t){case"b":case"c":return u.getBooleanArray(s);case"d":return u.getFloat64Array(s);case"f":return u.getFloat32Array(s);case"i":return u.getInt32Array(s);case"l":return u.getInt64Array(s)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},xx=class{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){let t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){let e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){let e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){let e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){let t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){let e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){let t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){let e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){let t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){let e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){let t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){let t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=this.offset,i=new Uint8Array(this.dv.buffer,t,e);this.skip(e);let s=i.indexOf(0);return s>=0&&(i=new Uint8Array(this.dv.buffer,t,s)),this._textDecoder.decode(i)}},Ex=class{add(e,t){this[e]=t}};$Z=[];zC=new Pa,ep=new Et});var eee={};var BN=zc(()=>{"use strict";PN();THREE.FBXLoader=yx;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let n=this.data;if(!n.src)return;this.remove();let e=new THREE.FBXLoader;n.crossorigin&&e.setCrossOrigin(n.crossorigin),e.load(n.src,this.load.bind(this))},load:function(n){this.model=n,this.el.setObject3D("mesh",n),this.el.emit("model-loaded",{format:"fbx",model:n})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})});var NN=Cr((jpe,ON)=>{"use strict";function tee(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function nee(n,e){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.id=e,t.src=n,t}function YC(n){let e=document.getElementById(n),t=e.parentNode;try{t&&t.removeChild(e)}catch{}}function iee(n){let e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)}function ree(n,e,t){return new t(function(i,s){let o=e.timeout||5e3,c=tee(),l=nee(n,c),u=setTimeout(function(){s(new Error("Script request to "+n+" timed out")),YC(c)},o),h=function(p){clearTimeout(p)};l.addEventListener("load",function(p){i({ok:!0}),h(u),YC(c)}),l.addEventListener("error",function(p){s(new Error("Script request to "+n+" failed "+p)),h(u),YC(c)}),iee(l)})}function see(n){return n=n||{},function(e,t){return t=t||{},ree(e,t,n.Promise||Promise)}}ON.exports=see});var UN=Cr((Qpe,FN)=>{"use strict";var oee=NN()(),aee="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",cee=function(){let n;return function(){return n=n||oee(aee),n}}();FN.exports=AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=cee().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){let n=this,e=this.el,t=this.data;t&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(t,function(s){n.model=s.scene,n.model.animations=s.animations,e.setObject3D("mesh",n.model),e.emit("model-loaded",{format:"gltf",model:n.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})});var VN=Cr((Xpe,kN)=>{"use strict";kN.exports=AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let n,e=this.data;e.src&&(this.remove(),n=new THREE.ObjectLoader,e.crossorigin&&n.setCrossOrigin(e.crossorigin),n.load(e.src,t=>{t.traverse(i=>{i instanceof THREE.SkinnedMesh&&i.material&&(i.material.skinning=!!(i.geometry&&i.geometry.bones||[]).length)}),this.load(t)}))},load:function(n){this.model=n,this.el.setObject3D("mesh",n),this.el.emit("model-loaded",{format:"json",model:n})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})});var HN=Cr(()=>{"use strict";eB();rB();BN();UN();VN()});var GN=Cr((Kpe,zN)=>{"use strict";zN.exports=AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){let n=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!n)throw new Error("No `checkpoint-controls` component found.");n.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}})});var jN=Cr(($pe,WN)=>{"use strict";function lee(n){return n?Array.isArray(n)?n:n.materials?n.materials:[n]:[]}function Bg(n,e,t,i){n&&(e=e||[],n.traverse(s=>{if(!s.isMesh)return;lee(s.material).forEach(c=>{c&&!("envMap"in c)||e.length&&e.indexOf(c.name)===-1||(c.envMap=t,c.reflectivity=i,c.needsUpdate=!0)})}))}WN.exports=AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){let n=this.data;this.texture=new THREE.CubeTextureLoader().load([n.path+"posx."+n.extension,n.path+"negx."+n.extension,n.path+"posy."+n.extension,n.path+"negy."+n.extension,n.path+"posz."+n.extension,n.path+"negz."+n.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{let e=this.el.getObject3D("mesh"),t=this.data;Bg(e,t.materials,this.texture,t.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(n){let e=this.data,t=this.el.getObject3D("mesh"),i=[],s=[];if(e.materials.length&&(n.materials?(i=e.materials.filter(o=>!n.materials.includes(o)),s=n.materials.filter(o=>!e.materials.includes(o))):i=e.materials),i.length&&Bg(t,i,this.texture,e.reflectivity),s.length&&Bg(t,s,null,1),n.materials&&e.reflectivity!==n.reflectivity){let o=e.materials.filter(c=>n.materials.includes(c));o.length&&Bg(t,o,this.texture,e.reflectivity)}this.data.enableBackground&&!n.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&n.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);let n=this.el.getObject3D("mesh"),e=this.data;Bg(n,e.materials,null,1),e.enableBackground&&this.setBackground(null)},setBackground:function(n){this.el.sceneEl.object3D.background=n}})});var XN=Cr((Jpe,QN)=>{"use strict";QN.exports=AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){let n=this.el;n.addEventListener("hit",this.onHit),n.addEventListener("gripdown",this.onGripClose),n.addEventListener("gripup",this.onGripOpen),n.addEventListener("trackpaddown",this.onGripClose),n.addEventListener("trackpadup",this.onGripOpen),n.addEventListener("triggerdown",this.onGripClose),n.addEventListener("triggerup",this.onGripOpen)},pause:function(){let n=this.el;n.removeEventListener("hit",this.onHit),n.removeEventListener("gripdown",this.onGripClose),n.removeEventListener("gripup",this.onGripOpen),n.removeEventListener("trackpaddown",this.onGripClose),n.removeEventListener("trackpadup",this.onGripOpen),n.removeEventListener("triggerdown",this.onGripClose),n.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){let n=this.hitEl;this.grabbing=!1,n&&(n.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(n){let e=n.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}})});var YN=Cr((Zpe,qN)=>{"use strict";qN.exports=AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(n=>{n.isMesh&&(n.material=this.material)})}})});var $N=Cr((eme,KN)=>{"use strict";KN.exports=AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){let n=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(n,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){let n=this.data,e;n.objects?e=this.el.sceneEl.querySelectorAll(n.objects):e=this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){let n=new THREE.Vector3,e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,s=new THREE.Box3,o=[],c=new Map;return function(l){if(!this.data.enabled)return;let u=this.prevCheckTime;if(u&&l-u<this.data.interval)return;this.prevCheckTime=l;let h=this.el,p=this.data,f=h.getObject3D("mesh"),m;if(!f)return;o.length=0,c.clear(),h.object3D.getWorldPosition(n),h.object3D.getWorldScale(t),m=p.radius*y(t),this.els.forEach(A),o.sort((E,x)=>c.get(E)>c.get(x)?1:-1).forEach(this.handleHit),this.collisions.filter(E=>!c.has(E)).forEach(this.handleHitEnd),uee(this.collisions,o);function A(E){let x,v,w,M;E.isEntity&&(v=E.getObject3D("mesh"),v&&(s.setFromObject(v).getSize(i),M=Math.max(i.x,i.y,i.z)/2,x=Math.sqrt(2*M*M),s.getCenter(e),x&&(w=n.distanceTo(e),w<x+m&&(o.push(E),c.set(E,w)))))}function y(E){return Math.max(E.x,E.y,E.z)}}}(),handleHit:function(n){n.emit("hit"),n.addState(this.data.state),this.eventDetail.el=n,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(n){n.emit("hitend"),n.removeState(this.data.state),this.eventDetail.el=n,this.el.emit("hitend",this.eventDetail)}});function uee(n,e){n.length=0;for(let t=0;t<e.length;t++)n[t]=e[t]}});var JN=Cr(()=>{"use strict";GN();jN();XN();YN();$N()});var eF=Cr((ime,ZN)=>{"use strict";ZN.exports=AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var n=this;let e=this.el.getObject3D("mesh"),t=this.el.sceneEl.object3D;if(!e)return;let i;if(e.traverse(o=>{o.isMesh&&(!n.nodeName||o.name===n.nodeName)&&(i=o)}),!i)return;let s=i.geometry.clone();i.updateWorldMatrix(!0,!1),s.applyMatrix4(i.matrixWorld),this.system.setNavMeshGeometry(s),this.hasLoadedNavMesh=!0}})});var nF=Cr((rme,tF)=>{"use strict";tF.exports=AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){let n=new THREE.Vector3,e=new THREE.Vector3,t=new THREE.Vector3;return function(i,s){let o=this.el,c=this.data,l=this.raycaster,u=c.speed*s/1e3;if(!c.active)return;if(!this.path.length){let y=this.el.object3D.position;this.group=this.group||this.system.getGroup(y),this.path=this.system.getPath(y,n.copy(c.destination),this.group)||[],o.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",c.destination),this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}let h=o.object3D.position,p=this.path[0];e.subVectors(p,h);let f=e.length(),m;if(f<u){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}t.copy(h),m=this.path[0]}else t.copy(e.setLength(u)).add(h),m=p;m.y=h.y,o.object3D.lookAt(m),l.ray.origin.copy(t),l.ray.origin.y+=1.5,l.ray.direction={x:0,y:-1,z:0};let A=l.intersectObject(this.system.getNavMesh());A.length?(e.subVectors(A[0].point,h),h.add(e.setLength(u))):h.copy(t)}}()})});function Xg(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ao[n&255]+Ao[n>>8&255]+Ao[n>>16&255]+Ao[n>>24&255]+"-"+Ao[e&255]+Ao[e>>8&255]+"-"+Ao[e>>16&15|64]+Ao[e>>24&255]+"-"+Ao[t&63|128]+Ao[t>>8&255]+"-"+Ao[t>>16&255]+Ao[t>>24&255]+Ao[i&255]+Ao[i>>8&255]+Ao[i>>16&255]+Ao[i>>24&255]).toLowerCase()}function Qo(n,e,t){return Math.max(e,Math.min(t,n))}function hte(n,e){return(n%e+e)%e}function rS(n,e,t){return(1-t)*n+t*e}function zF(n){return(n&n-1)===0&&n!==0}function NS(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Og(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function jo(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}function VU(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Zx(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function dte(){let n=Zx("canvas");return n.style.display="block",n}function Vg(n){n in GF||(GF[n]=!0,console.warn(n))}function Ep(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function oS(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}function aS(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?eE.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}function lS(n,e,t,i,s){for(let o=0,c=n.length-3;o<=c;o+=3){Vh.fromArray(n,o);let l=s.x*Math.abs(Vh.x)+s.y*Math.abs(Vh.y)+s.z*Math.abs(Vh.z),u=e.dot(Vh),h=t.dot(Vh),p=i.dot(Vh);if(Math.max(-Math.max(u,h,p),Math.min(u,h,p))>l)return!1}return!0}function vS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function Ste(n,e,t,i,s,o,c,l){let u;if(e.side===Xo?u=i.intersectTriangle(c,o,s,!0,l):u=i.intersectTriangle(s,o,c,e.side===Tu,l),u===null)return null;kx.copy(l),kx.applyMatrix4(n.matrixWorld);let h=t.ray.origin.distanceTo(kx);return h<t.near||h>t.far?null:{distance:h,point:kx.clone(),object:n}}function Vx(n,e,t,i,s,o,c,l,u,h){n.getVertexPosition(l,hp),n.getVertexPosition(u,dp),n.getVertexPosition(h,fp);let p=Ste(n,e,t,i,hp,dp,fp,Ux);if(p){s&&(Ox.fromBufferAttribute(s,l),Nx.fromBufferAttribute(s,u),Fx.fromBufferAttribute(s,h),p.uv=Mu.getInterpolation(Ux,hp,dp,fp,Ox,Nx,Fx,new zr)),o&&(Ox.fromBufferAttribute(o,l),Nx.fromBufferAttribute(o,u),Fx.fromBufferAttribute(o,h),p.uv1=Mu.getInterpolation(Ux,hp,dp,fp,Ox,Nx,Fx,new zr),p.uv2=p.uv1),c&&(nU.fromBufferAttribute(c,l),iU.fromBufferAttribute(c,u),rU.fromBufferAttribute(c,h),p.normal=Mu.getInterpolation(Ux,hp,dp,fp,nU,iU,rU,new Lt),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));let f={a:l,b:u,c:h,normal:new Lt,materialIndex:0};Mu.getNormal(hp,dp,fp,f.normal),p.face=f}return p}function Sp(n){let e={};for(let t in n){e[t]={};for(let i in n[t]){let s=n[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():Array.isArray(s)?e[t][i]=s.slice():e[t][i]=s}}return e}function Lo(n){let e={};for(let t=0;t<n.length;t++){let i=Sp(n[t]);for(let s in i)e[s]=i[s]}return e}function Tte(n){let e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function zU(n){return n.getRenderTarget()===null?n.outputColorSpace:Hr.workingColorSpace}function GU(){let n=null,e=!1,t=null,i=null;function s(o,c){t(o,c),i=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function Bte(n,e){let t=e.isWebGL2,i=new WeakMap;function s(h,p){let f=h.array,m=h.usage,A=f.byteLength,y=n.createBuffer();n.bindBuffer(p,y),n.bufferData(p,f,m),h.onUploadCallback();let E;if(f instanceof Float32Array)E=n.FLOAT;else if(f instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)E=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else E=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)E=n.SHORT;else if(f instanceof Uint32Array)E=n.UNSIGNED_INT;else if(f instanceof Int32Array)E=n.INT;else if(f instanceof Int8Array)E=n.BYTE;else if(f instanceof Uint8Array)E=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)E=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:y,type:E,bytesPerElement:f.BYTES_PER_ELEMENT,version:h.version,size:A}}function o(h,p,f){let m=p.array,A=p._updateRange,y=p.updateRanges;if(n.bindBuffer(f,h),A.count===-1&&y.length===0&&n.bufferSubData(f,0,m),y.length!==0){for(let E=0,x=y.length;E<x;E++){let v=y[E];t?n.bufferSubData(f,v.start*m.BYTES_PER_ELEMENT,m,v.start,v.count):n.bufferSubData(f,v.start*m.BYTES_PER_ELEMENT,m.subarray(v.start,v.start+v.count))}p.clearUpdateRanges()}A.count!==-1&&(t?n.bufferSubData(f,A.offset*m.BYTES_PER_ELEMENT,m,A.offset,A.count):n.bufferSubData(f,A.offset*m.BYTES_PER_ELEMENT,m.subarray(A.offset,A.offset+A.count)),A.count=-1),p.onUploadCallback()}function c(h){return h.isInterleavedBufferAttribute&&(h=h.data),i.get(h)}function l(h){h.isInterleavedBufferAttribute&&(h=h.data);let p=i.get(h);p&&(n.deleteBuffer(p.buffer),i.delete(h))}function u(h,p){if(h.isGLBufferAttribute){let m=i.get(h);(!m||m.version<h.version)&&i.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);let f=i.get(h);if(f===void 0)i.set(h,s(h,p));else if(f.version<h.version){if(f.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");o(f.buffer,h,p),f.version=h.version}}return{get:c,remove:l,update:u}}function pre(n,e,t,i,s,o,c){let l=new cr(0),u=o===!0?0:1,h,p,f=null,m=0,A=null;function y(x,v){let w=!1,M=v.isScene===!0?v.background:null;M&&M.isTexture&&(M=(v.backgroundBlurriness>0?t:e).get(M)),M===null?E(l,u):M&&M.isColor&&(E(M,1),w=!0);let T=n.xr.getEnvironmentBlendMode();T==="additive"?i.buffers.color.setClear(0,0,0,1,c):T==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,c),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),M&&(M.isCubeTexture||M.mapping===fE)?(p===void 0&&(p=new yo(new wl(1,1,1),new Cl({name:"BackgroundCubeMaterial",uniforms:Sp(Tc.backgroundCube.uniforms),vertexShader:Tc.backgroundCube.vertexShader,fragmentShader:Tc.backgroundCube.fragmentShader,side:Xo,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(D,L,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(p)),p.material.uniforms.envMap.value=M,p.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,p.material.toneMapped=Hr.getTransfer(M.colorSpace)!==Zr,(f!==M||m!==M.version||A!==n.toneMapping)&&(p.material.needsUpdate=!0,f=M,m=M.version,A=n.toneMapping),p.layers.enableAll(),x.unshift(p,p.geometry,p.material,0,0,null)):M&&M.isTexture&&(h===void 0&&(h=new yo(new HS(2,2),new Cl({name:"BackgroundMaterial",uniforms:Sp(Tc.background.uniforms),vertexShader:Tc.background.vertexShader,fragmentShader:Tc.background.fragmentShader,side:Tu,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=M,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=Hr.getTransfer(M.colorSpace)!==Zr,M.matrixAutoUpdate===!0&&M.updateMatrix(),h.material.uniforms.uvTransform.value.copy(M.matrix),(f!==M||m!==M.version||A!==n.toneMapping)&&(h.material.needsUpdate=!0,f=M,m=M.version,A=n.toneMapping),h.layers.enableAll(),x.unshift(h,h.geometry,h.material,0,0,null))}function E(x,v){x.getRGB(zx,zU(n)),i.buffers.color.setClear(zx.r,zx.g,zx.b,v,c)}return{getClearColor:function(){return l},setClearColor:function(x,v=1){l.set(x),u=v,E(l,u)},getClearAlpha:function(){return u},setClearAlpha:function(x){u=x,E(l,u)},render:y}}function mre(n,e,t,i){let s=n.getParameter(n.MAX_VERTEX_ATTRIBS),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),c=i.isWebGL2||o!==null,l={},u=x(null),h=u,p=!1;function f(U,P,k,z,Q){let Z=!1;if(c){let ce=E(z,k,P);h!==ce&&(h=ce,A(h.object)),Z=v(U,z,k,Q),Z&&w(U,z,k,Q)}else{let ce=P.wireframe===!0;(h.geometry!==z.id||h.program!==k.id||h.wireframe!==ce)&&(h.geometry=z.id,h.program=k.id,h.wireframe=ce,Z=!0)}Q!==null&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(Z||p)&&(p=!1,F(U,P,k,z),Q!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))}function m(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function A(U){return i.isWebGL2?n.bindVertexArray(U):o.bindVertexArrayOES(U)}function y(U){return i.isWebGL2?n.deleteVertexArray(U):o.deleteVertexArrayOES(U)}function E(U,P,k){let z=k.wireframe===!0,Q=l[U.id];Q===void 0&&(Q={},l[U.id]=Q);let Z=Q[P.id];Z===void 0&&(Z={},Q[P.id]=Z);let ce=Z[z];return ce===void 0&&(ce=x(m()),Z[z]=ce),ce}function x(U){let P=[],k=[],z=[];for(let Q=0;Q<s;Q++)P[Q]=0,k[Q]=0,z[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:k,attributeDivisors:z,object:U,attributes:{},index:null}}function v(U,P,k,z){let Q=h.attributes,Z=P.attributes,ce=0,Me=k.getAttributes();for(let xe in Me)if(Me[xe].location>=0){let Fe=Q[xe],Ze=Z[xe];if(Ze===void 0&&(xe==="instanceMatrix"&&U.instanceMatrix&&(Ze=U.instanceMatrix),xe==="instanceColor"&&U.instanceColor&&(Ze=U.instanceColor)),Fe===void 0||Fe.attribute!==Ze||Ze&&Fe.data!==Ze.data)return!0;ce++}return h.attributesNum!==ce||h.index!==z}function w(U,P,k,z){let Q={},Z=P.attributes,ce=0,Me=k.getAttributes();for(let xe in Me)if(Me[xe].location>=0){let Fe=Z[xe];Fe===void 0&&(xe==="instanceMatrix"&&U.instanceMatrix&&(Fe=U.instanceMatrix),xe==="instanceColor"&&U.instanceColor&&(Fe=U.instanceColor));let Ze={};Ze.attribute=Fe,Fe&&Fe.data&&(Ze.data=Fe.data),Q[xe]=Ze,ce++}h.attributes=Q,h.attributesNum=ce,h.index=z}function M(){let U=h.newAttributes;for(let P=0,k=U.length;P<k;P++)U[P]=0}function T(U){D(U,0)}function D(U,P){let k=h.newAttributes,z=h.enabledAttributes,Q=h.attributeDivisors;k[U]=1,z[U]===0&&(n.enableVertexAttribArray(U),z[U]=1),Q[U]!==P&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,P),Q[U]=P)}function L(){let U=h.newAttributes,P=h.enabledAttributes;for(let k=0,z=P.length;k<z;k++)P[k]!==U[k]&&(n.disableVertexAttribArray(k),P[k]=0)}function I(U,P,k,z,Q,Z,ce){ce===!0?n.vertexAttribIPointer(U,P,k,Q,Z):n.vertexAttribPointer(U,P,k,z,Q,Z)}function F(U,P,k,z){if(i.isWebGL2===!1&&(U.isInstancedMesh||z.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();let Q=z.attributes,Z=k.getAttributes(),ce=P.defaultAttributeValues;for(let Me in Z){let xe=Z[Me];if(xe.location>=0){let be=Q[Me];if(be===void 0&&(Me==="instanceMatrix"&&U.instanceMatrix&&(be=U.instanceMatrix),Me==="instanceColor"&&U.instanceColor&&(be=U.instanceColor)),be!==void 0){let Fe=be.normalized,Ze=be.itemSize,ut=t.get(be);if(ut===void 0)continue;let it=ut.buffer,gt=ut.type,Rt=ut.bytesPerElement,It=i.isWebGL2===!0&&(gt===n.INT||gt===n.UNSIGNED_INT||be.gpuType===DU);if(be.isInterleavedBufferAttribute){let Ft=be.data,Ne=Ft.stride,pn=be.offset;if(Ft.isInstancedInterleavedBuffer){for(let St=0;St<xe.locationSize;St++)D(xe.location+St,Ft.meshPerAttribute);U.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Ft.meshPerAttribute*Ft.count)}else for(let St=0;St<xe.locationSize;St++)T(xe.location+St);n.bindBuffer(n.ARRAY_BUFFER,it);for(let St=0;St<xe.locationSize;St++)I(xe.location+St,Ze/xe.locationSize,gt,Fe,Ne*Rt,(pn+Ze/xe.locationSize*St)*Rt,It)}else{if(be.isInstancedBufferAttribute){for(let Ft=0;Ft<xe.locationSize;Ft++)D(xe.location+Ft,be.meshPerAttribute);U.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=be.meshPerAttribute*be.count)}else for(let Ft=0;Ft<xe.locationSize;Ft++)T(xe.location+Ft);n.bindBuffer(n.ARRAY_BUFFER,it);for(let Ft=0;Ft<xe.locationSize;Ft++)I(xe.location+Ft,Ze/xe.locationSize,gt,Fe,Ze*Rt,Ze/xe.locationSize*Ft*Rt,It)}}else if(ce!==void 0){let Fe=ce[Me];if(Fe!==void 0)switch(Fe.length){case 2:n.vertexAttrib2fv(xe.location,Fe);break;case 3:n.vertexAttrib3fv(xe.location,Fe);break;case 4:n.vertexAttrib4fv(xe.location,Fe);break;default:n.vertexAttrib1fv(xe.location,Fe)}}}}L()}function R(){$();for(let U in l){let P=l[U];for(let k in P){let z=P[k];for(let Q in z)y(z[Q].object),delete z[Q];delete P[k]}delete l[U]}}function N(U){if(l[U.id]===void 0)return;let P=l[U.id];for(let k in P){let z=P[k];for(let Q in z)y(z[Q].object),delete z[Q];delete P[k]}delete l[U.id]}function X(U){for(let P in l){let k=l[P];if(k[U.id]===void 0)continue;let z=k[U.id];for(let Q in z)y(z[Q].object),delete z[Q];delete k[U.id]}}function $(){te(),p=!0,h!==u&&(h=u,A(h.object))}function te(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:f,reset:$,resetDefaultState:te,dispose:R,releaseStatesOfGeometry:N,releaseStatesOfProgram:X,initAttributes:M,enableAttribute:T,disableUnusedAttributes:L}}function gre(n,e,t,i){let s=i.isWebGL2,o;function c(p){o=p}function l(p,f){n.drawArrays(o,p,f),t.update(f,o,1)}function u(p,f,m){if(m===0)return;let A,y;if(s)A=n,y="drawArraysInstanced";else if(A=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",A===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[y](o,p,f,m),t.update(f,o,m)}function h(p,f,m){if(m===0)return;let A=e.get("WEBGL_multi_draw");if(A===null)for(let y=0;y<m;y++)this.render(p[y],f[y]);else{A.multiDrawArraysWEBGL(o,p,0,f,0,m);let y=0;for(let E=0;E<m;E++)y+=f[E];t.update(y,o,1)}}this.setMode=c,this.render=l,this.renderInstances=u,this.renderMultiDraw=h}function Are(n,e,t){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext",l=t.precision!==void 0?t.precision:"highp",u=o(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let h=c||e.has("WEBGL_draw_buffers"),p=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),E=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),v=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),M=m>0,T=c||e.has("OES_texture_float"),D=M&&T,L=c?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:c,drawBuffers:h,getMaxAnisotropy:s,getMaxPrecision:o,precision:l,logarithmicDepthBuffer:p,maxTextures:f,maxVertexTextures:m,maxTextureSize:A,maxCubemapSize:y,maxAttributes:E,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:M,floatFragmentTextures:T,floatVertexTextures:D,maxSamples:L}}function vre(n){let e=this,t=null,i=0,s=!1,o=!1,c=new Fa,l=new ar,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){let A=f.length!==0||m||i!==0||s;return s=m,i=f.length,A},this.beginShadows=function(){o=!0,p(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,m){t=p(f,m,0)},this.setState=function(f,m,A){let y=f.clippingPlanes,E=f.clipIntersection,x=f.clipShadows,v=n.get(f);if(!s||y===null||y.length===0||o&&!x)o?p(null):h();else{let w=o?0:i,M=w*4,T=v.clippingState||null;u.value=T,T=p(y,m,M,A);for(let D=0;D!==M;++D)T[D]=t[D];v.clippingState=T,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=w}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function p(f,m,A,y){let E=f!==null?f.length:0,x=null;if(E!==0){if(x=u.value,y!==!0||x===null){let v=A+E*4,w=m.matrixWorldInverse;l.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let M=0,T=A;M!==E;++M,T+=4)c.copy(f[M]).applyMatrix4(w,l),c.normal.toArray(x,T),x[T+3]=c.constant}u.value=x,u.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,x}}function yre(n){let e=new WeakMap;function t(c,l){return l===RS?c.mapping=bp:l===DS&&(c.mapping=Mp),c}function i(c){if(c&&c.isTexture){let l=c.mapping;if(l===RS||l===DS)if(e.has(c)){let u=e.get(c).texture;return t(u,c.mapping)}else{let u=c.image;if(u&&u.height>0){let h=new VS(u.height/2);return h.fromEquirectangularTexture(n,c),e.set(c,h),c.addEventListener("dispose",s),t(h.texture,c.mapping)}else return null}}return c}function s(c){let l=c.target;l.removeEventListener("dispose",s);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}function xre(n){let e=[],t=[],i=[],s=n,o=n-Ap+1+sU.length;for(let c=0;c<o;c++){let l=Math.pow(2,s);t.push(l);let u=1/l;c>n-Ap?u=sU[c-n+Ap-1]:c===0&&(u=0),i.push(u);let h=1/(l-2),p=-h,f=1+h,m=[p,p,f,p,f,f,p,p,f,f,p,f],A=6,y=6,E=3,x=2,v=1,w=new Float32Array(E*y*A),M=new Float32Array(x*y*A),T=new Float32Array(v*y*A);for(let L=0;L<A;L++){let I=L%3*2/3-1,F=L>2?0:-1,R=[I,F,0,I+2/3,F,0,I+2/3,F+1,0,I,F,0,I+2/3,F+1,0,I,F+1,0];w.set(R,E*y*L),M.set(m,x*y*L);let N=[L,L,L,L,L,L];T.set(N,v*y*L)}let D=new ka;D.setAttribute("position",new Bo(w,E)),D.setAttribute("uv",new Bo(M,x)),D.setAttribute("faceIndex",new Bo(T,v)),e.push(D),s>Ap&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function cU(n,e,t){let i=new Ml(n,e,t);return i.texture.mapping=fE,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Gx(n,e,t,i,s){n.viewport.set(e,t,i,s),n.scissor.set(e,t,i,s)}function Ere(n,e,t){let i=new Float32Array(jh),s=new Lt(0,1,0);return new Cl({name:"SphericalGaussianBlur",defines:{n:jh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:d2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function lU(){return new Cl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:d2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function uU(){return new Cl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:d2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function d2(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function _re(n){let e=new WeakMap,t=null;function i(l){if(l&&l.isTexture){let u=l.mapping,h=u===RS||u===DS,p=u===bp||u===Mp;if(h||p)if(l.isRenderTargetTexture&&l.needsPMREMUpdate===!0){l.needsPMREMUpdate=!1;let f=e.get(l);return t===null&&(t=new uE(n)),f=h?t.fromEquirectangular(l,f):t.fromCubemap(l,f),e.set(l,f),f.texture}else{if(e.has(l))return e.get(l).texture;{let f=l.image;if(h&&f&&f.height>0||p&&f&&s(f)){t===null&&(t=new uE(n));let m=h?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,m),l.addEventListener("dispose",o),m.texture}else return null}}}return l}function s(l){let u=0,h=6;for(let p=0;p<h;p++)l[p]!==void 0&&u++;return u===h}function o(l){let u=l.target;u.removeEventListener("dispose",o);let h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function c(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:c}}function bre(n){let e={};function t(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(i)}return e[i]=s,s}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){let s=t(i);return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function Mre(n,e,t,i){let s={},o=new WeakMap;function c(f){let m=f.target;m.index!==null&&e.remove(m.index);for(let y in m.attributes)e.remove(m.attributes[y]);for(let y in m.morphAttributes){let E=m.morphAttributes[y];for(let x=0,v=E.length;x<v;x++)e.remove(E[x])}m.removeEventListener("dispose",c),delete s[m.id];let A=o.get(m);A&&(e.remove(A),o.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function l(f,m){return s[m.id]===!0||(m.addEventListener("dispose",c),s[m.id]=!0,t.memory.geometries++),m}function u(f){let m=f.attributes;for(let y in m)e.update(m[y],n.ARRAY_BUFFER);let A=f.morphAttributes;for(let y in A){let E=A[y];for(let x=0,v=E.length;x<v;x++)e.update(E[x],n.ARRAY_BUFFER)}}function h(f){let m=[],A=f.index,y=f.attributes.position,E=0;if(A!==null){let w=A.array;E=A.version;for(let M=0,T=w.length;M<T;M+=3){let D=w[M+0],L=w[M+1],I=w[M+2];m.push(D,L,L,I,I,D)}}else if(y!==void 0){let w=y.array;E=y.version;for(let M=0,T=w.length/3-1;M<T;M+=3){let D=M+0,L=M+1,I=M+2;m.push(D,L,L,I,I,D)}}else return;let x=new(VU(m)?oE:sE)(m,1);x.version=E;let v=o.get(f);v&&e.remove(v),o.set(f,x)}function p(f){let m=o.get(f);if(m){let A=f.index;A!==null&&m.version<A.version&&h(f)}else h(f);return o.get(f)}return{get:l,update:u,getWireframeAttribute:p}}function wre(n,e,t,i){let s=i.isWebGL2,o;function c(A){o=A}let l,u;function h(A){l=A.type,u=A.bytesPerElement}function p(A,y){n.drawElements(o,y,l,A*u),t.update(y,o,1)}function f(A,y,E){if(E===0)return;let x,v;if(s)x=n,v="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](o,y,l,A*u,E),t.update(y,o,E)}function m(A,y,E){if(E===0)return;let x=e.get("WEBGL_multi_draw");if(x===null)for(let v=0;v<E;v++)this.render(A[v]/u,y[v]);else{x.multiDrawElementsWEBGL(o,y,0,l,A,0,E);let v=0;for(let w=0;w<E;w++)v+=y[w];t.update(v,o,1)}}this.setMode=c,this.setIndex=h,this.render=p,this.renderInstances=f,this.renderMultiDraw=m}function Cre(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,c,l){switch(t.calls++,c){case n.TRIANGLES:t.triangles+=l*(o/3);break;case n.LINES:t.lines+=l*(o/2);break;case n.LINE_STRIP:t.lines+=l*(o-1);break;case n.LINE_LOOP:t.lines+=l*o;break;case n.POINTS:t.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:i}}function Sre(n,e){return n[0]-e[0]}function Tre(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Ire(n,e,t){let i={},s=new Float32Array(8),o=new WeakMap,c=new so,l=[];for(let h=0;h<8;h++)l[h]=[h,0];function u(h,p,f){let m=h.morphTargetInfluences;if(e.isWebGL2===!0){let y=p.morphAttributes.position||p.morphAttributes.normal||p.morphAttributes.color,E=y!==void 0?y.length:0,x=o.get(p);if(x===void 0||x.count!==E){let P=function(){te.dispose(),o.delete(p),p.removeEventListener("dispose",P)};var A=P;x!==void 0&&x.texture.dispose();let M=p.morphAttributes.position!==void 0,T=p.morphAttributes.normal!==void 0,D=p.morphAttributes.color!==void 0,L=p.morphAttributes.position||[],I=p.morphAttributes.normal||[],F=p.morphAttributes.color||[],R=0;M===!0&&(R=1),T===!0&&(R=2),D===!0&&(R=3);let N=p.attributes.position.count*R,X=1;N>e.maxTextureSize&&(X=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);let $=new Float32Array(N*X*4*E),te=new nE($,N,X,E);te.type=bu,te.needsUpdate=!0;let U=R*4;for(let k=0;k<E;k++){let z=L[k],Q=I[k],Z=F[k],ce=N*X*4*k;for(let Me=0;Me<z.count;Me++){let xe=Me*U;M===!0&&(c.fromBufferAttribute(z,Me),$[ce+xe+0]=c.x,$[ce+xe+1]=c.y,$[ce+xe+2]=c.z,$[ce+xe+3]=0),T===!0&&(c.fromBufferAttribute(Q,Me),$[ce+xe+4]=c.x,$[ce+xe+5]=c.y,$[ce+xe+6]=c.z,$[ce+xe+7]=0),D===!0&&(c.fromBufferAttribute(Z,Me),$[ce+xe+8]=c.x,$[ce+xe+9]=c.y,$[ce+xe+10]=c.z,$[ce+xe+11]=Z.itemSize===4?c.w:1)}}x={count:E,texture:te,size:new zr(N,X)},o.set(p,x),p.addEventListener("dispose",P)}let v=0;for(let M=0;M<m.length;M++)v+=m[M];let w=p.morphTargetsRelative?1:1-v;f.getUniforms().setValue(n,"morphTargetBaseInfluence",w),f.getUniforms().setValue(n,"morphTargetInfluences",m),f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{let y=m===void 0?0:m.length,E=i[p.id];if(E===void 0||E.length!==y){E=[];for(let T=0;T<y;T++)E[T]=[T,0];i[p.id]=E}for(let T=0;T<y;T++){let D=E[T];D[0]=T,D[1]=m[T]}E.sort(Tre);for(let T=0;T<8;T++)T<y&&E[T][1]?(l[T][0]=E[T][0],l[T][1]=E[T][1]):(l[T][0]=Number.MAX_SAFE_INTEGER,l[T][1]=0);l.sort(Sre);let x=p.morphAttributes.position,v=p.morphAttributes.normal,w=0;for(let T=0;T<8;T++){let D=l[T],L=D[0],I=D[1];L!==Number.MAX_SAFE_INTEGER&&I?(x&&p.getAttribute("morphTarget"+T)!==x[L]&&p.setAttribute("morphTarget"+T,x[L]),v&&p.getAttribute("morphNormal"+T)!==v[L]&&p.setAttribute("morphNormal"+T,v[L]),s[T]=I,w+=I):(x&&p.hasAttribute("morphTarget"+T)===!0&&p.deleteAttribute("morphTarget"+T),v&&p.hasAttribute("morphNormal"+T)===!0&&p.deleteAttribute("morphNormal"+T),s[T]=0)}let M=p.morphTargetsRelative?1:1-w;f.getUniforms().setValue(n,"morphTargetBaseInfluence",M),f.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:u}}function Rre(n,e,t,i){let s=new WeakMap;function o(u){let h=i.render.frame,p=u.geometry,f=e.get(u,p);if(s.get(f)!==h&&(e.update(f),s.set(f,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),s.get(u)!==h&&(t.update(u.instanceMatrix,n.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,n.ARRAY_BUFFER),s.set(u,h))),u.isSkinnedMesh){let m=u.skeleton;s.get(m)!==h&&(m.update(),s.set(m,h))}return f}function c(){s=new WeakMap}function l(u){let h=u.target;h.removeEventListener("dispose",l),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:o,dispose:c}}function Rp(n,e,t){let i=n[0];if(i<=0||i>0)return n;let s=e*t,o=hU[s];if(o===void 0&&(o=new Float32Array(s),hU[s]=o),e!==0){i.toArray(o,0);for(let c=1,l=0;c!==e;++c)l+=t,n[c].toArray(o,l)}return o}function Ps(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Bs(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function mE(n,e){let t=dU[e];t===void 0&&(t=new Int32Array(e),dU[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Dre(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Lre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2fv(this.addr,e),Bs(t,e)}}function Pre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ps(t,e))return;n.uniform3fv(this.addr,e),Bs(t,e)}}function Bre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4fv(this.addr,e),Bs(t,e)}}function Ore(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Bs(t,e)}else{if(Ps(t,i))return;mU.set(i),n.uniformMatrix2fv(this.addr,!1,mU),Bs(t,i)}}function Nre(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Bs(t,e)}else{if(Ps(t,i))return;pU.set(i),n.uniformMatrix3fv(this.addr,!1,pU),Bs(t,i)}}function Fre(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Bs(t,e)}else{if(Ps(t,i))return;fU.set(i),n.uniformMatrix4fv(this.addr,!1,fU),Bs(t,i)}}function Ure(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function kre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2iv(this.addr,e),Bs(t,e)}}function Vre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ps(t,e))return;n.uniform3iv(this.addr,e),Bs(t,e)}}function Hre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4iv(this.addr,e),Bs(t,e)}}function zre(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Gre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2uiv(this.addr,e),Bs(t,e)}}function Wre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ps(t,e))return;n.uniform3uiv(this.addr,e),Bs(t,e)}}function jre(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4uiv(this.addr,e),Bs(t,e)}}function Qre(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s);let o=this.type===n.SAMPLER_2D_SHADOW?jU:WU;t.setTexture2D(e||o,s)}function Xre(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||XU,s)}function qre(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||qU,s)}function Yre(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||QU,s)}function Kre(n){switch(n){case 5126:return Dre;case 35664:return Lre;case 35665:return Pre;case 35666:return Bre;case 35674:return Ore;case 35675:return Nre;case 35676:return Fre;case 5124:case 35670:return Ure;case 35667:case 35671:return kre;case 35668:case 35672:return Vre;case 35669:case 35673:return Hre;case 5125:return zre;case 36294:return Gre;case 36295:return Wre;case 36296:return jre;case 35678:case 36198:case 36298:case 36306:case 35682:return Qre;case 35679:case 36299:case 36307:return Xre;case 35680:case 36300:case 36308:case 36293:return qre;case 36289:case 36303:case 36311:case 36292:return Yre}}function $re(n,e){n.uniform1fv(this.addr,e)}function Jre(n,e){let t=Rp(e,this.size,2);n.uniform2fv(this.addr,t)}function Zre(n,e){let t=Rp(e,this.size,3);n.uniform3fv(this.addr,t)}function ese(n,e){let t=Rp(e,this.size,4);n.uniform4fv(this.addr,t)}function tse(n,e){let t=Rp(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function nse(n,e){let t=Rp(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function ise(n,e){let t=Rp(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function rse(n,e){n.uniform1iv(this.addr,e)}function sse(n,e){n.uniform2iv(this.addr,e)}function ose(n,e){n.uniform3iv(this.addr,e)}function ase(n,e){n.uniform4iv(this.addr,e)}function cse(n,e){n.uniform1uiv(this.addr,e)}function lse(n,e){n.uniform2uiv(this.addr,e)}function use(n,e){n.uniform3uiv(this.addr,e)}function hse(n,e){n.uniform4uiv(this.addr,e)}function dse(n,e,t){let i=this.cache,s=e.length,o=mE(t,s);Ps(i,o)||(n.uniform1iv(this.addr,o),Bs(i,o));for(let c=0;c!==s;++c)t.setTexture2D(e[c]||WU,o[c])}function fse(n,e,t){let i=this.cache,s=e.length,o=mE(t,s);Ps(i,o)||(n.uniform1iv(this.addr,o),Bs(i,o));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||XU,o[c])}function pse(n,e,t){let i=this.cache,s=e.length,o=mE(t,s);Ps(i,o)||(n.uniform1iv(this.addr,o),Bs(i,o));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||qU,o[c])}function mse(n,e,t){let i=this.cache,s=e.length,o=mE(t,s);Ps(i,o)||(n.uniform1iv(this.addr,o),Bs(i,o));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||QU,o[c])}function gse(n){switch(n){case 5126:return $re;case 35664:return Jre;case 35665:return Zre;case 35666:return ese;case 35674:return tse;case 35675:return nse;case 35676:return ise;case 5124:case 35670:return rse;case 35667:case 35671:return sse;case 35668:case 35672:return ose;case 35669:case 35673:return ase;case 5125:return cse;case 36294:return lse;case 36295:return use;case 36296:return hse;case 35678:case 36198:case 36298:case 36306:case 35682:return dse;case 35679:case 36299:case 36307:return fse;case 35680:case 36300:case 36308:case 36293:return pse;case 36289:case 36303:case 36311:case 36292:return mse}}function gU(n,e){n.seq.push(e),n.map[e.id]=e}function Ase(n,e,t){let i=n.name,s=i.length;for(CS.lastIndex=0;;){let o=CS.exec(i),c=CS.lastIndex,l=o[1],u=o[2]==="]",h=o[3];if(u&&(l=l|0),h===void 0||h==="["&&c+2===s){gU(t,h===void 0?new GS(l,n,e):new WS(l,n,e));break}else{let f=t.map[l];f===void 0&&(f=new jS(l),gU(t,f)),t=f}}}function AU(n,e,t){let i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function xse(n,e){let t=n.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let c=s;c<o;c++){let l=c+1;i.push(`${l===e?">":" "} ${l}: ${t[c]}`)}return i.join(`
`)}function Ese(n){let e=Hr.getPrimaries(Hr.workingColorSpace),t=Hr.getPrimaries(n),i;switch(e===t?i="":e===$x&&t===Kx?i="LinearDisplayP3ToLinearSRGB":e===Kx&&t===$x&&(i="LinearSRGBToLinearDisplayP3"),n){case bl:case pE:return[i,"LinearTransferOETF"];case ro:case h2:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function vU(n,e,t){let i=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(i&&s==="")return"";let o=/ERROR: 0:(\d+)/.exec(s);if(o){let c=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+xse(n.getShaderSource(e),c)}else return s}function _se(n,e){let t=Ese(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function bse(n,e){let t;switch(e){case kee:t="Linear";break;case Vee:t="Reinhard";break;case Hee:t="OptimizedCineon";break;case zee:t="ACESFilmic";break;case Wee:t="AgX";break;case Gee:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Mse(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(vp).join(`
`)}function wse(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(vp).join(`
`)}function Cse(n){let e=[];for(let t in n){let i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Sse(n,e){let t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let o=n.getActiveAttrib(e,s),c=o.name,l=1;o.type===n.FLOAT_MAT2&&(l=2),o.type===n.FLOAT_MAT3&&(l=3),o.type===n.FLOAT_MAT4&&(l=4),t[c]={type:o.type,location:n.getAttribLocation(e,c),locationSize:l}}return t}function vp(n){return n!==""}function yU(n,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function xU(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function QS(n){return n.replace(Tse,Rse)}function Rse(n,e){let t=Ji[e];if(t===void 0){let i=Ise.get(e);if(i!==void 0)t=Ji[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return QS(t)}function EU(n){return n.replace(Dse,Lse)}function Lse(n,e,t,i){let s="";for(let o=parseInt(e);o<parseInt(t);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function _U(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Pse(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===IU?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===fee?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===xl&&(e="SHADOWMAP_TYPE_VSM"),e}function Bse(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case bp:case Mp:e="ENVMAP_TYPE_CUBE";break;case fE:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ose(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Mp:e="ENVMAP_MODE_REFRACTION";break}return e}function Nse(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case RU:e="ENVMAP_BLENDING_MULTIPLY";break;case Fee:e="ENVMAP_BLENDING_MIX";break;case Uee:e="ENVMAP_BLENDING_ADD";break}return e}function Fse(n){let e=n.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function Use(n,e,t,i){let s=n.getContext(),o=t.defines,c=t.vertexShader,l=t.fragmentShader,u=Pse(t),h=Bse(t),p=Ose(t),f=Nse(t),m=Fse(t),A=t.isWebGL2?"":Mse(t),y=wse(t),E=Cse(o),x=s.createProgram(),v,w,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(vp).join(`
`),v.length>0&&(v+=`
`),w=[A,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(vp).join(`
`),w.length>0&&(w+=`
`)):(v=[_U(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(vp).join(`
`),w=[A,_U(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+p:"",t.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Cu?"#define TONE_MAPPING":"",t.toneMapping!==Cu?Ji.tonemapping_pars_fragment:"",t.toneMapping!==Cu?bse("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ji.colorspace_pars_fragment,_se("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(vp).join(`
`)),c=QS(c),c=yU(c,t),c=xU(c,t),l=QS(l),l=yU(l,t),l=xU(l,t),c=EU(c),l=EU(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,v=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===HF?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===HF?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);let T=M+v+c,D=M+w+l,L=AU(s,s.VERTEX_SHADER,T),I=AU(s,s.FRAGMENT_SHADER,D);s.attachShader(x,L),s.attachShader(x,I),t.index0AttributeName!==void 0?s.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);function F($){if(n.debug.checkShaderErrors){let te=s.getProgramInfoLog(x).trim(),U=s.getShaderInfoLog(L).trim(),P=s.getShaderInfoLog(I).trim(),k=!0,z=!0;if(s.getProgramParameter(x,s.LINK_STATUS)===!1)if(k=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,x,L,I);else{let Q=vU(s,L,"vertex"),Z=vU(s,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(x,s.VALIDATE_STATUS)+`

Program Info Log: `+te+`
`+Q+`
`+Z)}else te!==""?console.warn("THREE.WebGLProgram: Program Info Log:",te):(U===""||P==="")&&(z=!1);z&&($.diagnostics={runnable:k,programLog:te,vertexShader:{log:U,prefix:v},fragmentShader:{log:P,prefix:w}})}s.deleteShader(L),s.deleteShader(I),R=new _p(s,x),N=Sse(s,x)}let R;this.getUniforms=function(){return R===void 0&&F(this),R};let N;this.getAttributes=function(){return N===void 0&&F(this),N};let X=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return X===!1&&(X=s.getProgramParameter(x,vse)),X},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=yse++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=L,this.fragmentShader=I,this}function Vse(n,e,t,i,s,o,c){let l=new rE,u=new XS,h=[],p=s.isWebGL2,f=s.logarithmicDepthBuffer,m=s.vertexTextures,A=s.precision,y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(R){return R===0?"uv":`uv${R}`}function x(R,N,X,$,te){let U=$.fog,P=te.geometry,k=R.isMeshStandardMaterial?$.environment:null,z=(R.isMeshStandardMaterial?t:e).get(R.envMap||k),Q=z&&z.mapping===fE?z.image.height:null,Z=y[R.type];R.precision!==null&&(A=s.getMaxPrecision(R.precision),A!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",A,"instead."));let ce=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,Me=ce!==void 0?ce.length:0,xe=0;P.morphAttributes.position!==void 0&&(xe=1),P.morphAttributes.normal!==void 0&&(xe=2),P.morphAttributes.color!==void 0&&(xe=3);let be,Fe,Ze,ut;if(Z){let en=Tc[Z];be=en.vertexShader,Fe=en.fragmentShader}else be=R.vertexShader,Fe=R.fragmentShader,u.update(R),Ze=u.getVertexShaderID(R),ut=u.getFragmentShaderID(R);let it=n.getRenderTarget(),gt=te.isInstancedMesh===!0,Rt=te.isBatchedMesh===!0,It=!!R.map,Ft=!!R.matcap,Ne=!!z,pn=!!R.aoMap,St=!!R.lightMap,Vt=!!R.bumpMap,Ot=!!R.normalMap,xn=!!R.displacementMap,Jt=!!R.emissiveMap,Oe=!!R.metalnessMap,Ie=!!R.roughnessMap,yt=R.anisotropy>0,kt=R.clearcoat>0,De=R.iridescence>0,he=R.sheen>0,ae=R.transmission>0,de=yt&&!!R.anisotropyMap,we=kt&&!!R.clearcoatMap,Ae=kt&&!!R.clearcoatNormalMap,Le=kt&&!!R.clearcoatRoughnessMap,Ee=De&&!!R.iridescenceMap,ze=De&&!!R.iridescenceThicknessMap,Ge=he&&!!R.sheenColorMap,ee=he&&!!R.sheenRoughnessMap,V=!!R.specularMap,G=!!R.specularColorMap,pe=!!R.specularIntensityMap,Ue=ae&&!!R.transmissionMap,Qe=ae&&!!R.thicknessMap,$e=!!R.gradientMap,nt=!!R.alphaMap,ge=R.alphaTest>0,ot=!!R.alphaHash,et=!!R.extensions,tt=!!P.attributes.uv1,_t=!!P.attributes.uv2,tn=!!P.attributes.uv3,En=Cu;return R.toneMapped&&(it===null||it.isXRRenderTarget===!0)&&(En=n.toneMapping),{isWebGL2:p,shaderID:Z,shaderType:R.type,shaderName:R.name,vertexShader:be,fragmentShader:Fe,defines:R.defines,customVertexShaderID:Ze,customFragmentShaderID:ut,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:A,batching:Rt,instancing:gt,instancingColor:gt&&te.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:it===null?n.outputColorSpace:it.isXRRenderTarget===!0?it.texture.colorSpace:bl,map:It,matcap:Ft,envMap:Ne,envMapMode:Ne&&z.mapping,envMapCubeUVHeight:Q,aoMap:pn,lightMap:St,bumpMap:Vt,normalMap:Ot,displacementMap:m&&xn,emissiveMap:Jt,normalMapObjectSpace:Ot&&R.normalMapType===ite,normalMapTangentSpace:Ot&&R.normalMapType===nte,metalnessMap:Oe,roughnessMap:Ie,anisotropy:yt,anisotropyMap:de,clearcoat:kt,clearcoatMap:we,clearcoatNormalMap:Ae,clearcoatRoughnessMap:Le,iridescence:De,iridescenceMap:Ee,iridescenceThicknessMap:ze,sheen:he,sheenColorMap:Ge,sheenRoughnessMap:ee,specularMap:V,specularColorMap:G,specularIntensityMap:pe,transmission:ae,transmissionMap:Ue,thicknessMap:Qe,gradientMap:$e,opaque:R.transparent===!1&&R.blending===xp,alphaMap:nt,alphaTest:ge,alphaHash:ot,combine:R.combine,mapUv:It&&E(R.map.channel),aoMapUv:pn&&E(R.aoMap.channel),lightMapUv:St&&E(R.lightMap.channel),bumpMapUv:Vt&&E(R.bumpMap.channel),normalMapUv:Ot&&E(R.normalMap.channel),displacementMapUv:xn&&E(R.displacementMap.channel),emissiveMapUv:Jt&&E(R.emissiveMap.channel),metalnessMapUv:Oe&&E(R.metalnessMap.channel),roughnessMapUv:Ie&&E(R.roughnessMap.channel),anisotropyMapUv:de&&E(R.anisotropyMap.channel),clearcoatMapUv:we&&E(R.clearcoatMap.channel),clearcoatNormalMapUv:Ae&&E(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Le&&E(R.clearcoatRoughnessMap.channel),iridescenceMapUv:Ee&&E(R.iridescenceMap.channel),iridescenceThicknessMapUv:ze&&E(R.iridescenceThicknessMap.channel),sheenColorMapUv:Ge&&E(R.sheenColorMap.channel),sheenRoughnessMapUv:ee&&E(R.sheenRoughnessMap.channel),specularMapUv:V&&E(R.specularMap.channel),specularColorMapUv:G&&E(R.specularColorMap.channel),specularIntensityMapUv:pe&&E(R.specularIntensityMap.channel),transmissionMapUv:Ue&&E(R.transmissionMap.channel),thicknessMapUv:Qe&&E(R.thicknessMap.channel),alphaMapUv:nt&&E(R.alphaMap.channel),vertexTangents:!!P.attributes.tangent&&(Ot||yt),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!P.attributes.color&&P.attributes.color.itemSize===4,vertexUv1s:tt,vertexUv2s:_t,vertexUv3s:tn,pointsUvs:te.isPoints===!0&&!!P.attributes.uv&&(It||nt),fog:!!U,useFog:R.fog===!0,fogExp2:U&&U.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:te.isSkinnedMesh===!0,morphTargets:P.morphAttributes.position!==void 0,morphNormals:P.morphAttributes.normal!==void 0,morphColors:P.morphAttributes.color!==void 0,morphTargetsCount:Me,morphTextureStride:xe,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:R.dithering,shadowMapEnabled:n.shadowMap.enabled&&X.length>0,shadowMapType:n.shadowMap.type,toneMapping:En,useLegacyLights:n._useLegacyLights,decodeVideoTexture:It&&R.map.isVideoTexture===!0&&Hr.getTransfer(R.map.colorSpace)===Zr,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===El,flipSided:R.side===Xo,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionDerivatives:et&&R.extensions.derivatives===!0,extensionFragDepth:et&&R.extensions.fragDepth===!0,extensionDrawBuffers:et&&R.extensions.drawBuffers===!0,extensionShaderTextureLOD:et&&R.extensions.shaderTextureLOD===!0,extensionClipCullDistance:et&&R.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:p||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()}}function v(R){let N=[];if(R.shaderID?N.push(R.shaderID):(N.push(R.customVertexShaderID),N.push(R.customFragmentShaderID)),R.defines!==void 0)for(let X in R.defines)N.push(X),N.push(R.defines[X]);return R.isRawShaderMaterial===!1&&(w(N,R),M(N,R),N.push(n.outputColorSpace)),N.push(R.customProgramCacheKey),N.join()}function w(R,N){R.push(N.precision),R.push(N.outputColorSpace),R.push(N.envMapMode),R.push(N.envMapCubeUVHeight),R.push(N.mapUv),R.push(N.alphaMapUv),R.push(N.lightMapUv),R.push(N.aoMapUv),R.push(N.bumpMapUv),R.push(N.normalMapUv),R.push(N.displacementMapUv),R.push(N.emissiveMapUv),R.push(N.metalnessMapUv),R.push(N.roughnessMapUv),R.push(N.anisotropyMapUv),R.push(N.clearcoatMapUv),R.push(N.clearcoatNormalMapUv),R.push(N.clearcoatRoughnessMapUv),R.push(N.iridescenceMapUv),R.push(N.iridescenceThicknessMapUv),R.push(N.sheenColorMapUv),R.push(N.sheenRoughnessMapUv),R.push(N.specularMapUv),R.push(N.specularColorMapUv),R.push(N.specularIntensityMapUv),R.push(N.transmissionMapUv),R.push(N.thicknessMapUv),R.push(N.combine),R.push(N.fogExp2),R.push(N.sizeAttenuation),R.push(N.morphTargetsCount),R.push(N.morphAttributeCount),R.push(N.numDirLights),R.push(N.numPointLights),R.push(N.numSpotLights),R.push(N.numSpotLightMaps),R.push(N.numHemiLights),R.push(N.numRectAreaLights),R.push(N.numDirLightShadows),R.push(N.numPointLightShadows),R.push(N.numSpotLightShadows),R.push(N.numSpotLightShadowsWithMaps),R.push(N.numLightProbes),R.push(N.shadowMapType),R.push(N.toneMapping),R.push(N.numClippingPlanes),R.push(N.numClipIntersection),R.push(N.depthPacking)}function M(R,N){l.disableAll(),N.isWebGL2&&l.enable(0),N.supportsVertexTextures&&l.enable(1),N.instancing&&l.enable(2),N.instancingColor&&l.enable(3),N.matcap&&l.enable(4),N.envMap&&l.enable(5),N.normalMapObjectSpace&&l.enable(6),N.normalMapTangentSpace&&l.enable(7),N.clearcoat&&l.enable(8),N.iridescence&&l.enable(9),N.alphaTest&&l.enable(10),N.vertexColors&&l.enable(11),N.vertexAlphas&&l.enable(12),N.vertexUv1s&&l.enable(13),N.vertexUv2s&&l.enable(14),N.vertexUv3s&&l.enable(15),N.vertexTangents&&l.enable(16),N.anisotropy&&l.enable(17),N.alphaHash&&l.enable(18),N.batching&&l.enable(19),R.push(l.mask),l.disableAll(),N.fog&&l.enable(0),N.useFog&&l.enable(1),N.flatShading&&l.enable(2),N.logarithmicDepthBuffer&&l.enable(3),N.skinning&&l.enable(4),N.morphTargets&&l.enable(5),N.morphNormals&&l.enable(6),N.morphColors&&l.enable(7),N.premultipliedAlpha&&l.enable(8),N.shadowMapEnabled&&l.enable(9),N.useLegacyLights&&l.enable(10),N.doubleSided&&l.enable(11),N.flipSided&&l.enable(12),N.useDepthPacking&&l.enable(13),N.dithering&&l.enable(14),N.transmission&&l.enable(15),N.sheen&&l.enable(16),N.opaque&&l.enable(17),N.pointsUvs&&l.enable(18),N.decodeVideoTexture&&l.enable(19),R.push(l.mask)}function T(R){let N=y[R.type],X;if(N){let $=Tc[N];X=Ite.clone($.uniforms)}else X=R.uniforms;return X}function D(R,N){let X;for(let $=0,te=h.length;$<te;$++){let U=h[$];if(U.cacheKey===N){X=U,++X.usedTimes;break}}return X===void 0&&(X=new Use(n,N,R,o),h.push(X)),X}function L(R){if(--R.usedTimes===0){let N=h.indexOf(R);h[N]=h[h.length-1],h.pop(),R.destroy()}}function I(R){u.remove(R)}function F(){u.dispose()}return{getParameters:x,getProgramCacheKey:v,getUniforms:T,acquireProgram:D,releaseProgram:L,releaseShaderCache:I,programs:h,dispose:F}}function Hse(){let n=new WeakMap;function e(o){let c=n.get(o);return c===void 0&&(c={},n.set(o,c)),c}function t(o){n.delete(o)}function i(o,c,l){n.get(o)[c]=l}function s(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:s}}function zse(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function bU(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function MU(){let n=[],e=0,t=[],i=[],s=[];function o(){e=0,t.length=0,i.length=0,s.length=0}function c(f,m,A,y,E,x){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:m,material:A,groupOrder:y,renderOrder:f.renderOrder,z:E,group:x},n[e]=v):(v.id=f.id,v.object=f,v.geometry=m,v.material=A,v.groupOrder=y,v.renderOrder=f.renderOrder,v.z=E,v.group=x),e++,v}function l(f,m,A,y,E,x){let v=c(f,m,A,y,E,x);A.transmission>0?i.push(v):A.transparent===!0?s.push(v):t.push(v)}function u(f,m,A,y,E,x){let v=c(f,m,A,y,E,x);A.transmission>0?i.unshift(v):A.transparent===!0?s.unshift(v):t.unshift(v)}function h(f,m){t.length>1&&t.sort(f||zse),i.length>1&&i.sort(m||bU),s.length>1&&s.sort(m||bU)}function p(){for(let f=e,m=n.length;f<m;f++){let A=n[f];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:i,transparent:s,init:o,push:l,unshift:u,finish:p,sort:h}}function Gse(){let n=new WeakMap;function e(i,s){let o=n.get(i),c;return o===void 0?(c=new MU,n.set(i,[c])):s>=o.length?(c=new MU,o.push(c)):c=o[s],c}function t(){n=new WeakMap}return{get:e,dispose:t}}function Wse(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Lt,color:new cr};break;case"SpotLight":t={position:new Lt,direction:new Lt,color:new cr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Lt,color:new cr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Lt,skyColor:new cr,groundColor:new cr};break;case"RectAreaLight":t={color:new cr,position:new Lt,halfWidth:new Lt,halfHeight:new Lt};break}return n[e.id]=t,t}}}function jse(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zr};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zr};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zr,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}function Xse(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function qse(n,e){let t=new Wse,i=jse(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)s.probe.push(new Lt);let o=new Lt,c=new oo,l=new oo;function u(p,f){let m=0,A=0,y=0;for(let $=0;$<9;$++)s.probe[$].set(0,0,0);let E=0,x=0,v=0,w=0,M=0,T=0,D=0,L=0,I=0,F=0,R=0;p.sort(Xse);let N=f===!0?Math.PI:1;for(let $=0,te=p.length;$<te;$++){let U=p[$],P=U.color,k=U.intensity,z=U.distance,Q=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)m+=P.r*k*N,A+=P.g*k*N,y+=P.b*k*N;else if(U.isLightProbe){for(let Z=0;Z<9;Z++)s.probe[Z].addScaledVector(U.sh.coefficients[Z],k);R++}else if(U.isDirectionalLight){let Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*N),U.castShadow){let ce=U.shadow,Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,s.directionalShadow[E]=Me,s.directionalShadowMap[E]=Q,s.directionalShadowMatrix[E]=U.shadow.matrix,T++}s.directional[E]=Z,E++}else if(U.isSpotLight){let Z=t.get(U);Z.position.setFromMatrixPosition(U.matrixWorld),Z.color.copy(P).multiplyScalar(k*N),Z.distance=z,Z.coneCos=Math.cos(U.angle),Z.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),Z.decay=U.decay,s.spot[v]=Z;let ce=U.shadow;if(U.map&&(s.spotLightMap[I]=U.map,I++,ce.updateMatrices(U),U.castShadow&&F++),s.spotLightMatrix[v]=ce.matrix,U.castShadow){let Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,s.spotShadow[v]=Me,s.spotShadowMap[v]=Q,L++}v++}else if(U.isRectAreaLight){let Z=t.get(U);Z.color.copy(P).multiplyScalar(k),Z.halfWidth.set(U.width*.5,0,0),Z.halfHeight.set(0,U.height*.5,0),s.rectArea[w]=Z,w++}else if(U.isPointLight){let Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*N),Z.distance=U.distance,Z.decay=U.decay,U.castShadow){let ce=U.shadow,Me=i.get(U);Me.shadowBias=ce.bias,Me.shadowNormalBias=ce.normalBias,Me.shadowRadius=ce.radius,Me.shadowMapSize=ce.mapSize,Me.shadowCameraNear=ce.camera.near,Me.shadowCameraFar=ce.camera.far,s.pointShadow[x]=Me,s.pointShadowMap[x]=Q,s.pointShadowMatrix[x]=U.shadow.matrix,D++}s.point[x]=Z,x++}else if(U.isHemisphereLight){let Z=t.get(U);Z.skyColor.copy(U.color).multiplyScalar(k*N),Z.groundColor.copy(U.groundColor).multiplyScalar(k*N),s.hemi[M]=Z,M++}}w>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Bn.LTC_FLOAT_1,s.rectAreaLTC2=Bn.LTC_FLOAT_2):(s.rectAreaLTC1=Bn.LTC_HALF_1,s.rectAreaLTC2=Bn.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Bn.LTC_FLOAT_1,s.rectAreaLTC2=Bn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=Bn.LTC_HALF_1,s.rectAreaLTC2=Bn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=m,s.ambient[1]=A,s.ambient[2]=y;let X=s.hash;(X.directionalLength!==E||X.pointLength!==x||X.spotLength!==v||X.rectAreaLength!==w||X.hemiLength!==M||X.numDirectionalShadows!==T||X.numPointShadows!==D||X.numSpotShadows!==L||X.numSpotMaps!==I||X.numLightProbes!==R)&&(s.directional.length=E,s.spot.length=v,s.rectArea.length=w,s.point.length=x,s.hemi.length=M,s.directionalShadow.length=T,s.directionalShadowMap.length=T,s.pointShadow.length=D,s.pointShadowMap.length=D,s.spotShadow.length=L,s.spotShadowMap.length=L,s.directionalShadowMatrix.length=T,s.pointShadowMatrix.length=D,s.spotLightMatrix.length=L+I-F,s.spotLightMap.length=I,s.numSpotLightShadowsWithMaps=F,s.numLightProbes=R,X.directionalLength=E,X.pointLength=x,X.spotLength=v,X.rectAreaLength=w,X.hemiLength=M,X.numDirectionalShadows=T,X.numPointShadows=D,X.numSpotShadows=L,X.numSpotMaps=I,X.numLightProbes=R,s.version=Qse++)}function h(p,f){let m=0,A=0,y=0,E=0,x=0,v=f.matrixWorldInverse;for(let w=0,M=p.length;w<M;w++){let T=p[w];if(T.isDirectionalLight){let D=s.directional[m];D.direction.setFromMatrixPosition(T.matrixWorld),o.setFromMatrixPosition(T.target.matrixWorld),D.direction.sub(o),D.direction.transformDirection(v),m++}else if(T.isSpotLight){let D=s.spot[y];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),D.direction.setFromMatrixPosition(T.matrixWorld),o.setFromMatrixPosition(T.target.matrixWorld),D.direction.sub(o),D.direction.transformDirection(v),y++}else if(T.isRectAreaLight){let D=s.rectArea[E];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),l.identity(),c.copy(T.matrixWorld),c.premultiply(v),l.extractRotation(c),D.halfWidth.set(T.width*.5,0,0),D.halfHeight.set(0,T.height*.5,0),D.halfWidth.applyMatrix4(l),D.halfHeight.applyMatrix4(l),E++}else if(T.isPointLight){let D=s.point[A];D.position.setFromMatrixPosition(T.matrixWorld),D.position.applyMatrix4(v),A++}else if(T.isHemisphereLight){let D=s.hemi[x];D.direction.setFromMatrixPosition(T.matrixWorld),D.direction.transformDirection(v),x++}}}return{setup:u,setupView:h,state:s}}function wU(n,e){let t=new qse(n,e),i=[],s=[];function o(){i.length=0,s.length=0}function c(f){i.push(f)}function l(f){s.push(f)}function u(f){t.setup(i,f)}function h(f){t.setupView(i,f)}return{init:o,state:{lightsArray:i,shadowsArray:s,lights:t},setupLights:u,setupLightsView:h,pushLight:c,pushShadow:l}}function Yse(n,e){let t=new WeakMap;function i(o,c=0){let l=t.get(o),u;return l===void 0?(u=new wU(n,e),t.set(o,[u])):c>=l.length?(u=new wU(n,e),l.push(u)):u=l[c],u}function s(){t=new WeakMap}return{get:i,dispose:s}}function Jse(n,e,t){let i=new lE,s=new zr,o=new zr,c=new so,l=new YS({depthPacking:tte}),u=new KS,h={},p=t.maxTextureSize,f={[Tu]:Xo,[Xo]:Tu,[El]:El},m=new Cl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new zr},radius:{value:4}},vertexShader:Kse,fragmentShader:$se}),A=m.clone();A.defines.HORIZONTAL_PASS=1;let y=new ka;y.setAttribute("position",new Bo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let E=new yo(y,m),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=IU;let v=this.type;this.render=function(L,I,F){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||L.length===0)return;let R=n.getRenderTarget(),N=n.getActiveCubeFace(),X=n.getActiveMipmapLevel(),$=n.state;$.setBlending(wu),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);let te=v!==xl&&this.type===xl,U=v===xl&&this.type!==xl;for(let P=0,k=L.length;P<k;P++){let z=L[P],Q=z.shadow;if(Q===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(Q.autoUpdate===!1&&Q.needsUpdate===!1)continue;s.copy(Q.mapSize);let Z=Q.getFrameExtents();if(s.multiply(Z),o.copy(Q.mapSize),(s.x>p||s.y>p)&&(s.x>p&&(o.x=Math.floor(p/Z.x),s.x=o.x*Z.x,Q.mapSize.x=o.x),s.y>p&&(o.y=Math.floor(p/Z.y),s.y=o.y*Z.y,Q.mapSize.y=o.y)),Q.map===null||te===!0||U===!0){let Me=this.type!==xl?{minFilter:Po,magFilter:Po}:{};Q.map!==null&&Q.map.dispose(),Q.map=new Ml(s.x,s.y,Me),Q.map.texture.name=z.name+".shadowMap",Q.camera.updateProjectionMatrix()}n.setRenderTarget(Q.map),n.clear();let ce=Q.getViewportCount();for(let Me=0;Me<ce;Me++){let xe=Q.getViewport(Me);c.set(o.x*xe.x,o.y*xe.y,o.x*xe.z,o.y*xe.w),$.viewport(c),Q.updateMatrices(z,Me),i=Q.getFrustum(),T(I,F,Q.camera,z,this.type)}Q.isPointLightShadow!==!0&&this.type===xl&&w(Q,F),Q.needsUpdate=!1}v=this.type,x.needsUpdate=!1,n.setRenderTarget(R,N,X)};function w(L,I){let F=e.update(E);m.defines.VSM_SAMPLES!==L.blurSamples&&(m.defines.VSM_SAMPLES=L.blurSamples,A.defines.VSM_SAMPLES=L.blurSamples,m.needsUpdate=!0,A.needsUpdate=!0),L.mapPass===null&&(L.mapPass=new Ml(s.x,s.y)),m.uniforms.shadow_pass.value=L.map.texture,m.uniforms.resolution.value=L.mapSize,m.uniforms.radius.value=L.radius,n.setRenderTarget(L.mapPass),n.clear(),n.renderBufferDirect(I,null,F,m,E,null),A.uniforms.shadow_pass.value=L.mapPass.texture,A.uniforms.resolution.value=L.mapSize,A.uniforms.radius.value=L.radius,n.setRenderTarget(L.map),n.clear(),n.renderBufferDirect(I,null,F,A,E,null)}function M(L,I,F,R){let N=null,X=F.isPointLight===!0?L.customDistanceMaterial:L.customDepthMaterial;if(X!==void 0)N=X;else if(N=F.isPointLight===!0?u:l,n.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){let $=N.uuid,te=I.uuid,U=h[$];U===void 0&&(U={},h[$]=U);let P=U[te];P===void 0&&(P=N.clone(),U[te]=P,I.addEventListener("dispose",D)),N=P}if(N.visible=I.visible,N.wireframe=I.wireframe,R===xl?N.side=I.shadowSide!==null?I.shadowSide:I.side:N.side=I.shadowSide!==null?I.shadowSide:f[I.side],N.alphaMap=I.alphaMap,N.alphaTest=I.alphaTest,N.map=I.map,N.clipShadows=I.clipShadows,N.clippingPlanes=I.clippingPlanes,N.clipIntersection=I.clipIntersection,N.displacementMap=I.displacementMap,N.displacementScale=I.displacementScale,N.displacementBias=I.displacementBias,N.wireframeLinewidth=I.wireframeLinewidth,N.linewidth=I.linewidth,F.isPointLight===!0&&N.isMeshDistanceMaterial===!0){let $=n.properties.get(N);$.light=F}return N}function T(L,I,F,R,N){if(L.visible===!1)return;if(L.layers.test(I.layers)&&(L.isMesh||L.isLine||L.isPoints)&&(L.castShadow||L.receiveShadow&&N===xl)&&(!L.frustumCulled||i.intersectsObject(L))){L.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,L.matrixWorld);let te=e.update(L),U=L.material;if(Array.isArray(U)){let P=te.groups;for(let k=0,z=P.length;k<z;k++){let Q=P[k],Z=U[Q.materialIndex];if(Z&&Z.visible){let ce=M(L,Z,R,N);L.onBeforeShadow(n,L,I,F,te,ce,Q),n.renderBufferDirect(F,null,te,ce,L,Q),L.onAfterShadow(n,L,I,F,te,ce,Q)}}}else if(U.visible){let P=M(L,U,R,N);L.onBeforeShadow(n,L,I,F,te,P,null),n.renderBufferDirect(F,null,te,P,L,null),L.onAfterShadow(n,L,I,F,te,P,null)}}let $=L.children;for(let te=0,U=$.length;te<U;te++)T($[te],I,F,R,N)}function D(L){L.target.removeEventListener("dispose",D);for(let F in h){let R=h[F],N=L.target.uuid;N in R&&(R[N].dispose(),delete R[N])}}}function Zse(n,e,t){let i=t.isWebGL2;function s(){let ge=!1,ot=new so,et=null,tt=new so(0,0,0,0);return{setMask:function(_t){et!==_t&&!ge&&(n.colorMask(_t,_t,_t,_t),et=_t)},setLocked:function(_t){ge=_t},setClear:function(_t,tn,En,Cn,en){en===!0&&(_t*=Cn,tn*=Cn,En*=Cn),ot.set(_t,tn,En,Cn),tt.equals(ot)===!1&&(n.clearColor(_t,tn,En,Cn),tt.copy(ot))},reset:function(){ge=!1,et=null,tt.set(-1,0,0,0)}}}function o(){let ge=!1,ot=null,et=null,tt=null;return{setTest:function(_t){_t?Rt(n.DEPTH_TEST):It(n.DEPTH_TEST)},setMask:function(_t){ot!==_t&&!ge&&(n.depthMask(_t),ot=_t)},setFunc:function(_t){if(et!==_t){switch(_t){case Ree:n.depthFunc(n.NEVER);break;case Dee:n.depthFunc(n.ALWAYS);break;case Lee:n.depthFunc(n.LESS);break;case Qx:n.depthFunc(n.LEQUAL);break;case Pee:n.depthFunc(n.EQUAL);break;case Bee:n.depthFunc(n.GEQUAL);break;case Oee:n.depthFunc(n.GREATER);break;case Nee:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}et=_t}},setLocked:function(_t){ge=_t},setClear:function(_t){tt!==_t&&(n.clearDepth(_t),tt=_t)},reset:function(){ge=!1,ot=null,et=null,tt=null}}}function c(){let ge=!1,ot=null,et=null,tt=null,_t=null,tn=null,En=null,Cn=null,en=null;return{setTest:function(xt){ge||(xt?Rt(n.STENCIL_TEST):It(n.STENCIL_TEST))},setMask:function(xt){ot!==xt&&!ge&&(n.stencilMask(xt),ot=xt)},setFunc:function(xt,jt,Pn){(et!==xt||tt!==jt||_t!==Pn)&&(n.stencilFunc(xt,jt,Pn),et=xt,tt=jt,_t=Pn)},setOp:function(xt,jt,Pn){(tn!==xt||En!==jt||Cn!==Pn)&&(n.stencilOp(xt,jt,Pn),tn=xt,En=jt,Cn=Pn)},setLocked:function(xt){ge=xt},setClear:function(xt){en!==xt&&(n.clearStencil(xt),en=xt)},reset:function(){ge=!1,ot=null,et=null,tt=null,_t=null,tn=null,En=null,Cn=null,en=null}}}let l=new s,u=new o,h=new c,p=new WeakMap,f=new WeakMap,m={},A={},y=new WeakMap,E=[],x=null,v=!1,w=null,M=null,T=null,D=null,L=null,I=null,F=null,R=new cr(0,0,0),N=0,X=!1,$=null,te=null,U=null,P=null,k=null,z=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Q=!1,Z=0,ce=n.getParameter(n.VERSION);ce.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(ce)[1]),Q=Z>=1):ce.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),Q=Z>=2);let Me=null,xe={},be=n.getParameter(n.SCISSOR_BOX),Fe=n.getParameter(n.VIEWPORT),Ze=new so().fromArray(be),ut=new so().fromArray(Fe);function it(ge,ot,et,tt){let _t=new Uint8Array(4),tn=n.createTexture();n.bindTexture(ge,tn),n.texParameteri(ge,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ge,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let En=0;En<et;En++)i&&(ge===n.TEXTURE_3D||ge===n.TEXTURE_2D_ARRAY)?n.texImage3D(ot,0,n.RGBA,1,1,tt,0,n.RGBA,n.UNSIGNED_BYTE,_t):n.texImage2D(ot+En,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,_t);return tn}let gt={};gt[n.TEXTURE_2D]=it(n.TEXTURE_2D,n.TEXTURE_2D,1),gt[n.TEXTURE_CUBE_MAP]=it(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(gt[n.TEXTURE_2D_ARRAY]=it(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),gt[n.TEXTURE_3D]=it(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),l.setClear(0,0,0,1),u.setClear(1),h.setClear(0),Rt(n.DEPTH_TEST),u.setFunc(Qx),Jt(!1),Oe(iF),Rt(n.CULL_FACE),Ot(wu);function Rt(ge){m[ge]!==!0&&(n.enable(ge),m[ge]=!0)}function It(ge){m[ge]!==!1&&(n.disable(ge),m[ge]=!1)}function Ft(ge,ot){return A[ge]!==ot?(n.bindFramebuffer(ge,ot),A[ge]=ot,i&&(ge===n.DRAW_FRAMEBUFFER&&(A[n.FRAMEBUFFER]=ot),ge===n.FRAMEBUFFER&&(A[n.DRAW_FRAMEBUFFER]=ot)),!0):!1}function Ne(ge,ot){let et=E,tt=!1;if(ge)if(et=y.get(ot),et===void 0&&(et=[],y.set(ot,et)),ge.isWebGLMultipleRenderTargets){let _t=ge.texture;if(et.length!==_t.length||et[0]!==n.COLOR_ATTACHMENT0){for(let tn=0,En=_t.length;tn<En;tn++)et[tn]=n.COLOR_ATTACHMENT0+tn;et.length=_t.length,tt=!0}}else et[0]!==n.COLOR_ATTACHMENT0&&(et[0]=n.COLOR_ATTACHMENT0,tt=!0);else et[0]!==n.BACK&&(et[0]=n.BACK,tt=!0);tt&&(t.isWebGL2?n.drawBuffers(et):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(et))}function pn(ge){return x!==ge?(n.useProgram(ge),x=ge,!0):!1}let St={[Wh]:n.FUNC_ADD,[mee]:n.FUNC_SUBTRACT,[gee]:n.FUNC_REVERSE_SUBTRACT};if(i)St[aF]=n.MIN,St[cF]=n.MAX;else{let ge=e.get("EXT_blend_minmax");ge!==null&&(St[aF]=ge.MIN_EXT,St[cF]=ge.MAX_EXT)}let Vt={[Aee]:n.ZERO,[vee]:n.ONE,[yee]:n.SRC_COLOR,[TS]:n.SRC_ALPHA,[wee]:n.SRC_ALPHA_SATURATE,[bee]:n.DST_COLOR,[Eee]:n.DST_ALPHA,[xee]:n.ONE_MINUS_SRC_COLOR,[IS]:n.ONE_MINUS_SRC_ALPHA,[Mee]:n.ONE_MINUS_DST_COLOR,[_ee]:n.ONE_MINUS_DST_ALPHA,[Cee]:n.CONSTANT_COLOR,[See]:n.ONE_MINUS_CONSTANT_COLOR,[Tee]:n.CONSTANT_ALPHA,[Iee]:n.ONE_MINUS_CONSTANT_ALPHA};function Ot(ge,ot,et,tt,_t,tn,En,Cn,en,xt){if(ge===wu){v===!0&&(It(n.BLEND),v=!1);return}if(v===!1&&(Rt(n.BLEND),v=!0),ge!==pee){if(ge!==w||xt!==X){if((M!==Wh||L!==Wh)&&(n.blendEquation(n.FUNC_ADD),M=Wh,L=Wh),xt)switch(ge){case xp:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case rF:n.blendFunc(n.ONE,n.ONE);break;case sF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case oF:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ge);break}else switch(ge){case xp:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case rF:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case sF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case oF:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ge);break}T=null,D=null,I=null,F=null,R.set(0,0,0),N=0,w=ge,X=xt}return}_t=_t||ot,tn=tn||et,En=En||tt,(ot!==M||_t!==L)&&(n.blendEquationSeparate(St[ot],St[_t]),M=ot,L=_t),(et!==T||tt!==D||tn!==I||En!==F)&&(n.blendFuncSeparate(Vt[et],Vt[tt],Vt[tn],Vt[En]),T=et,D=tt,I=tn,F=En),(Cn.equals(R)===!1||en!==N)&&(n.blendColor(Cn.r,Cn.g,Cn.b,en),R.copy(Cn),N=en),w=ge,X=!1}function xn(ge,ot){ge.side===El?It(n.CULL_FACE):Rt(n.CULL_FACE);let et=ge.side===Xo;ot&&(et=!et),Jt(et),ge.blending===xp&&ge.transparent===!1?Ot(wu):Ot(ge.blending,ge.blendEquation,ge.blendSrc,ge.blendDst,ge.blendEquationAlpha,ge.blendSrcAlpha,ge.blendDstAlpha,ge.blendColor,ge.blendAlpha,ge.premultipliedAlpha),u.setFunc(ge.depthFunc),u.setTest(ge.depthTest),u.setMask(ge.depthWrite),l.setMask(ge.colorWrite);let tt=ge.stencilWrite;h.setTest(tt),tt&&(h.setMask(ge.stencilWriteMask),h.setFunc(ge.stencilFunc,ge.stencilRef,ge.stencilFuncMask),h.setOp(ge.stencilFail,ge.stencilZFail,ge.stencilZPass)),yt(ge.polygonOffset,ge.polygonOffsetFactor,ge.polygonOffsetUnits),ge.alphaToCoverage===!0?Rt(n.SAMPLE_ALPHA_TO_COVERAGE):It(n.SAMPLE_ALPHA_TO_COVERAGE)}function Jt(ge){$!==ge&&(ge?n.frontFace(n.CW):n.frontFace(n.CCW),$=ge)}function Oe(ge){ge!==hee?(Rt(n.CULL_FACE),ge!==te&&(ge===iF?n.cullFace(n.BACK):ge===dee?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):It(n.CULL_FACE),te=ge}function Ie(ge){ge!==U&&(Q&&n.lineWidth(ge),U=ge)}function yt(ge,ot,et){ge?(Rt(n.POLYGON_OFFSET_FILL),(P!==ot||k!==et)&&(n.polygonOffset(ot,et),P=ot,k=et)):It(n.POLYGON_OFFSET_FILL)}function kt(ge){ge?Rt(n.SCISSOR_TEST):It(n.SCISSOR_TEST)}function De(ge){ge===void 0&&(ge=n.TEXTURE0+z-1),Me!==ge&&(n.activeTexture(ge),Me=ge)}function he(ge,ot,et){et===void 0&&(Me===null?et=n.TEXTURE0+z-1:et=Me);let tt=xe[et];tt===void 0&&(tt={type:void 0,texture:void 0},xe[et]=tt),(tt.type!==ge||tt.texture!==ot)&&(Me!==et&&(n.activeTexture(et),Me=et),n.bindTexture(ge,ot||gt[ge]),tt.type=ge,tt.texture=ot)}function ae(){let ge=xe[Me];ge!==void 0&&ge.type!==void 0&&(n.bindTexture(ge.type,null),ge.type=void 0,ge.texture=void 0)}function de(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function we(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ae(){try{n.texSubImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Le(){try{n.texSubImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ee(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function ze(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function Ge(){try{n.texStorage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function ee(){try{n.texStorage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function V(){try{n.texImage2D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function G(){try{n.texImage3D.apply(n,arguments)}catch(ge){console.error("THREE.WebGLState:",ge)}}function pe(ge){Ze.equals(ge)===!1&&(n.scissor(ge.x,ge.y,ge.z,ge.w),Ze.copy(ge))}function Ue(ge){ut.equals(ge)===!1&&(n.viewport(ge.x,ge.y,ge.z,ge.w),ut.copy(ge))}function Qe(ge,ot){let et=f.get(ot);et===void 0&&(et=new WeakMap,f.set(ot,et));let tt=et.get(ge);tt===void 0&&(tt=n.getUniformBlockIndex(ot,ge.name),et.set(ge,tt))}function $e(ge,ot){let tt=f.get(ot).get(ge);p.get(ot)!==tt&&(n.uniformBlockBinding(ot,tt,ge.__bindingPointIndex),p.set(ot,tt))}function nt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),m={},Me=null,xe={},A={},y=new WeakMap,E=[],x=null,v=!1,w=null,M=null,T=null,D=null,L=null,I=null,F=null,R=new cr(0,0,0),N=0,X=!1,$=null,te=null,U=null,P=null,k=null,Ze.set(0,0,n.canvas.width,n.canvas.height),ut.set(0,0,n.canvas.width,n.canvas.height),l.reset(),u.reset(),h.reset()}return{buffers:{color:l,depth:u,stencil:h},enable:Rt,disable:It,bindFramebuffer:Ft,drawBuffers:Ne,useProgram:pn,setBlending:Ot,setMaterial:xn,setFlipSided:Jt,setCullFace:Oe,setLineWidth:Ie,setPolygonOffset:yt,setScissorTest:kt,activeTexture:De,bindTexture:he,unbindTexture:ae,compressedTexImage2D:de,compressedTexImage3D:we,texImage2D:V,texImage3D:G,updateUBOMapping:Qe,uniformBlockBinding:$e,texStorage2D:Ge,texStorage3D:ee,texSubImage2D:Ae,texSubImage3D:Le,compressedTexSubImage2D:Ee,compressedTexSubImage3D:ze,scissor:pe,viewport:Ue,reset:nt}}function eoe(n,e,t,i,s,o,c){let l=s.isWebGL2,u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,f,m=new WeakMap,A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(Oe,Ie){return A?new OffscreenCanvas(Oe,Ie):Zx("canvas")}function E(Oe,Ie,yt,kt){let De=1;if((Oe.width>kt||Oe.height>kt)&&(De=kt/Math.max(Oe.width,Oe.height)),De<1||Ie===!0)if(typeof HTMLImageElement<"u"&&Oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Oe instanceof ImageBitmap){let he=Ie?NS:Math.floor,ae=he(De*Oe.width),de=he(De*Oe.height);f===void 0&&(f=y(ae,de));let we=yt?y(ae,de):f;return we.width=ae,we.height=de,we.getContext("2d").drawImage(Oe,0,0,ae,de),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Oe.width+"x"+Oe.height+") to ("+ae+"x"+de+")."),we}else return"data"in Oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Oe.width+"x"+Oe.height+")."),Oe;return Oe}function x(Oe){return zF(Oe.width)&&zF(Oe.height)}function v(Oe){return l?!1:Oe.wrapS!==sc||Oe.wrapT!==sc||Oe.minFilter!==Po&&Oe.minFilter!==Na}function w(Oe,Ie){return Oe.generateMipmaps&&Ie&&Oe.minFilter!==Po&&Oe.minFilter!==Na}function M(Oe){n.generateMipmap(Oe)}function T(Oe,Ie,yt,kt,De=!1){if(l===!1)return Ie;if(Oe!==null){if(n[Oe]!==void 0)return n[Oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Oe+"'")}let he=Ie;if(Ie===n.RED&&(yt===n.FLOAT&&(he=n.R32F),yt===n.HALF_FLOAT&&(he=n.R16F),yt===n.UNSIGNED_BYTE&&(he=n.R8)),Ie===n.RED_INTEGER&&(yt===n.UNSIGNED_BYTE&&(he=n.R8UI),yt===n.UNSIGNED_SHORT&&(he=n.R16UI),yt===n.UNSIGNED_INT&&(he=n.R32UI),yt===n.BYTE&&(he=n.R8I),yt===n.SHORT&&(he=n.R16I),yt===n.INT&&(he=n.R32I)),Ie===n.RG&&(yt===n.FLOAT&&(he=n.RG32F),yt===n.HALF_FLOAT&&(he=n.RG16F),yt===n.UNSIGNED_BYTE&&(he=n.RG8)),Ie===n.RGBA){let ae=De?Yx:Hr.getTransfer(kt);yt===n.FLOAT&&(he=n.RGBA32F),yt===n.HALF_FLOAT&&(he=n.RGBA16F),yt===n.UNSIGNED_BYTE&&(he=ae===Zr?n.SRGB8_ALPHA8:n.RGBA8),yt===n.UNSIGNED_SHORT_4_4_4_4&&(he=n.RGBA4),yt===n.UNSIGNED_SHORT_5_5_5_1&&(he=n.RGB5_A1)}return(he===n.R16F||he===n.R32F||he===n.RG16F||he===n.RG32F||he===n.RGBA16F||he===n.RGBA32F)&&e.get("EXT_color_buffer_float"),he}function D(Oe,Ie,yt){return w(Oe,yt)===!0||Oe.isFramebufferTexture&&Oe.minFilter!==Po&&Oe.minFilter!==Na?Math.log2(Math.max(Ie.width,Ie.height))+1:Oe.mipmaps!==void 0&&Oe.mipmaps.length>0?Oe.mipmaps.length:Oe.isCompressedTexture&&Array.isArray(Oe.image)?Ie.mipmaps.length:1}function L(Oe){return Oe===Po||Oe===uF||Oe===KC?n.NEAREST:n.LINEAR}function I(Oe){let Ie=Oe.target;Ie.removeEventListener("dispose",I),R(Ie),Ie.isVideoTexture&&p.delete(Ie)}function F(Oe){let Ie=Oe.target;Ie.removeEventListener("dispose",F),X(Ie)}function R(Oe){let Ie=i.get(Oe);if(Ie.__webglInit===void 0)return;let yt=Oe.source,kt=m.get(yt);if(kt){let De=kt[Ie.__cacheKey];De.usedTimes--,De.usedTimes===0&&N(Oe),Object.keys(kt).length===0&&m.delete(yt)}i.remove(Oe)}function N(Oe){let Ie=i.get(Oe);n.deleteTexture(Ie.__webglTexture);let yt=Oe.source,kt=m.get(yt);delete kt[Ie.__cacheKey],c.memory.textures--}function X(Oe){let Ie=Oe.texture,yt=i.get(Oe),kt=i.get(Ie);if(kt.__webglTexture!==void 0&&(n.deleteTexture(kt.__webglTexture),c.memory.textures--),Oe.depthTexture&&Oe.depthTexture.dispose(),Oe.isWebGLCubeRenderTarget)for(let De=0;De<6;De++){if(Array.isArray(yt.__webglFramebuffer[De]))for(let he=0;he<yt.__webglFramebuffer[De].length;he++)n.deleteFramebuffer(yt.__webglFramebuffer[De][he]);else n.deleteFramebuffer(yt.__webglFramebuffer[De]);yt.__webglDepthbuffer&&n.deleteRenderbuffer(yt.__webglDepthbuffer[De])}else{if(Array.isArray(yt.__webglFramebuffer))for(let De=0;De<yt.__webglFramebuffer.length;De++)n.deleteFramebuffer(yt.__webglFramebuffer[De]);else n.deleteFramebuffer(yt.__webglFramebuffer);if(yt.__webglDepthbuffer&&n.deleteRenderbuffer(yt.__webglDepthbuffer),yt.__webglMultisampledFramebuffer&&n.deleteFramebuffer(yt.__webglMultisampledFramebuffer),yt.__webglColorRenderbuffer)for(let De=0;De<yt.__webglColorRenderbuffer.length;De++)yt.__webglColorRenderbuffer[De]&&n.deleteRenderbuffer(yt.__webglColorRenderbuffer[De]);yt.__webglDepthRenderbuffer&&n.deleteRenderbuffer(yt.__webglDepthRenderbuffer)}if(Oe.isWebGLMultipleRenderTargets)for(let De=0,he=Ie.length;De<he;De++){let ae=i.get(Ie[De]);ae.__webglTexture&&(n.deleteTexture(ae.__webglTexture),c.memory.textures--),i.remove(Ie[De])}i.remove(Ie),i.remove(Oe)}let $=0;function te(){$=0}function U(){let Oe=$;return Oe>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Oe+" texture units while this GPU supports only "+s.maxTextures),$+=1,Oe}function P(Oe){let Ie=[];return Ie.push(Oe.wrapS),Ie.push(Oe.wrapT),Ie.push(Oe.wrapR||0),Ie.push(Oe.magFilter),Ie.push(Oe.minFilter),Ie.push(Oe.anisotropy),Ie.push(Oe.internalFormat),Ie.push(Oe.format),Ie.push(Oe.type),Ie.push(Oe.generateMipmaps),Ie.push(Oe.premultiplyAlpha),Ie.push(Oe.flipY),Ie.push(Oe.unpackAlignment),Ie.push(Oe.colorSpace),Ie.join()}function k(Oe,Ie){let yt=i.get(Oe);if(Oe.isVideoTexture&&xn(Oe),Oe.isRenderTargetTexture===!1&&Oe.version>0&&yt.__version!==Oe.version){let kt=Oe.image;if(kt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(kt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ze(yt,Oe,Ie);return}}t.bindTexture(n.TEXTURE_2D,yt.__webglTexture,n.TEXTURE0+Ie)}function z(Oe,Ie){let yt=i.get(Oe);if(Oe.version>0&&yt.__version!==Oe.version){Ze(yt,Oe,Ie);return}t.bindTexture(n.TEXTURE_2D_ARRAY,yt.__webglTexture,n.TEXTURE0+Ie)}function Q(Oe,Ie){let yt=i.get(Oe);if(Oe.version>0&&yt.__version!==Oe.version){Ze(yt,Oe,Ie);return}t.bindTexture(n.TEXTURE_3D,yt.__webglTexture,n.TEXTURE0+Ie)}function Z(Oe,Ie){let yt=i.get(Oe);if(Oe.version>0&&yt.__version!==Oe.version){ut(yt,Oe,Ie);return}t.bindTexture(n.TEXTURE_CUBE_MAP,yt.__webglTexture,n.TEXTURE0+Ie)}let ce={[LS]:n.REPEAT,[sc]:n.CLAMP_TO_EDGE,[PS]:n.MIRRORED_REPEAT},Me={[Po]:n.NEAREST,[uF]:n.NEAREST_MIPMAP_NEAREST,[KC]:n.NEAREST_MIPMAP_LINEAR,[Na]:n.LINEAR,[jee]:n.LINEAR_MIPMAP_NEAREST,[zg]:n.LINEAR_MIPMAP_LINEAR},xe={[rte]:n.NEVER,[ute]:n.ALWAYS,[ste]:n.LESS,[kU]:n.LEQUAL,[ote]:n.EQUAL,[lte]:n.GEQUAL,[ate]:n.GREATER,[cte]:n.NOTEQUAL};function be(Oe,Ie,yt){if(yt?(n.texParameteri(Oe,n.TEXTURE_WRAP_S,ce[Ie.wrapS]),n.texParameteri(Oe,n.TEXTURE_WRAP_T,ce[Ie.wrapT]),(Oe===n.TEXTURE_3D||Oe===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Oe,n.TEXTURE_WRAP_R,ce[Ie.wrapR]),n.texParameteri(Oe,n.TEXTURE_MAG_FILTER,Me[Ie.magFilter]),n.texParameteri(Oe,n.TEXTURE_MIN_FILTER,Me[Ie.minFilter])):(n.texParameteri(Oe,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(Oe,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(Oe===n.TEXTURE_3D||Oe===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Oe,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(Ie.wrapS!==sc||Ie.wrapT!==sc)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Oe,n.TEXTURE_MAG_FILTER,L(Ie.magFilter)),n.texParameteri(Oe,n.TEXTURE_MIN_FILTER,L(Ie.minFilter)),Ie.minFilter!==Po&&Ie.minFilter!==Na&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Ie.compareFunction&&(n.texParameteri(Oe,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Oe,n.TEXTURE_COMPARE_FUNC,xe[Ie.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){let kt=e.get("EXT_texture_filter_anisotropic");if(Ie.magFilter===Po||Ie.minFilter!==KC&&Ie.minFilter!==zg||Ie.type===bu&&e.has("OES_texture_float_linear")===!1||l===!1&&Ie.type===Gg&&e.has("OES_texture_half_float_linear")===!1)return;(Ie.anisotropy>1||i.get(Ie).__currentAnisotropy)&&(n.texParameterf(Oe,kt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ie.anisotropy,s.getMaxAnisotropy())),i.get(Ie).__currentAnisotropy=Ie.anisotropy)}}function Fe(Oe,Ie){let yt=!1;Oe.__webglInit===void 0&&(Oe.__webglInit=!0,Ie.addEventListener("dispose",I));let kt=Ie.source,De=m.get(kt);De===void 0&&(De={},m.set(kt,De));let he=P(Ie);if(he!==Oe.__cacheKey){De[he]===void 0&&(De[he]={texture:n.createTexture(),usedTimes:0},c.memory.textures++,yt=!0),De[he].usedTimes++;let ae=De[Oe.__cacheKey];ae!==void 0&&(De[Oe.__cacheKey].usedTimes--,ae.usedTimes===0&&N(Ie)),Oe.__cacheKey=he,Oe.__webglTexture=De[he].texture}return yt}function Ze(Oe,Ie,yt){let kt=n.TEXTURE_2D;(Ie.isDataArrayTexture||Ie.isCompressedArrayTexture)&&(kt=n.TEXTURE_2D_ARRAY),Ie.isData3DTexture&&(kt=n.TEXTURE_3D);let De=Fe(Oe,Ie),he=Ie.source;t.bindTexture(kt,Oe.__webglTexture,n.TEXTURE0+yt);let ae=i.get(he);if(he.version!==ae.__version||De===!0){t.activeTexture(n.TEXTURE0+yt);let de=Hr.getPrimaries(Hr.workingColorSpace),we=Ie.colorSpace===Ua?null:Hr.getPrimaries(Ie.colorSpace),Ae=Ie.colorSpace===Ua||de===we?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ie.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ie.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ie.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ae);let Le=v(Ie)&&x(Ie.image)===!1,Ee=E(Ie.image,Le,!1,s.maxTextureSize);Ee=Jt(Ie,Ee);let ze=x(Ee)||l,Ge=o.convert(Ie.format,Ie.colorSpace),ee=o.convert(Ie.type),V=T(Ie.internalFormat,Ge,ee,Ie.colorSpace,Ie.isVideoTexture);be(kt,Ie,ze);let G,pe=Ie.mipmaps,Ue=l&&Ie.isVideoTexture!==!0&&V!==FU,Qe=ae.__version===void 0||De===!0,$e=D(Ie,Ee,ze);if(Ie.isDepthTexture)V=n.DEPTH_COMPONENT,l?Ie.type===bu?V=n.DEPTH_COMPONENT32F:Ie.type===_u?V=n.DEPTH_COMPONENT24:Ie.type===Qh?V=n.DEPTH24_STENCIL8:V=n.DEPTH_COMPONENT16:Ie.type===bu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ie.format===Xh&&V===n.DEPTH_COMPONENT&&Ie.type!==u2&&Ie.type!==_u&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ie.type=_u,ee=o.convert(Ie.type)),Ie.format===wp&&V===n.DEPTH_COMPONENT&&(V=n.DEPTH_STENCIL,Ie.type!==Qh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ie.type=Qh,ee=o.convert(Ie.type))),Qe&&(Ue?t.texStorage2D(n.TEXTURE_2D,1,V,Ee.width,Ee.height):t.texImage2D(n.TEXTURE_2D,0,V,Ee.width,Ee.height,0,Ge,ee,null));else if(Ie.isDataTexture)if(pe.length>0&&ze){Ue&&Qe&&t.texStorage2D(n.TEXTURE_2D,$e,V,pe[0].width,pe[0].height);for(let nt=0,ge=pe.length;nt<ge;nt++)G=pe[nt],Ue?t.texSubImage2D(n.TEXTURE_2D,nt,0,0,G.width,G.height,Ge,ee,G.data):t.texImage2D(n.TEXTURE_2D,nt,V,G.width,G.height,0,Ge,ee,G.data);Ie.generateMipmaps=!1}else Ue?(Qe&&t.texStorage2D(n.TEXTURE_2D,$e,V,Ee.width,Ee.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ee.width,Ee.height,Ge,ee,Ee.data)):t.texImage2D(n.TEXTURE_2D,0,V,Ee.width,Ee.height,0,Ge,ee,Ee.data);else if(Ie.isCompressedTexture)if(Ie.isCompressedArrayTexture){Ue&&Qe&&t.texStorage3D(n.TEXTURE_2D_ARRAY,$e,V,pe[0].width,pe[0].height,Ee.depth);for(let nt=0,ge=pe.length;nt<ge;nt++)G=pe[nt],Ie.format!==oc?Ge!==null?Ue?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,nt,0,0,0,G.width,G.height,Ee.depth,Ge,G.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,nt,V,G.width,G.height,Ee.depth,0,G.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ue?t.texSubImage3D(n.TEXTURE_2D_ARRAY,nt,0,0,0,G.width,G.height,Ee.depth,Ge,ee,G.data):t.texImage3D(n.TEXTURE_2D_ARRAY,nt,V,G.width,G.height,Ee.depth,0,Ge,ee,G.data)}else{Ue&&Qe&&t.texStorage2D(n.TEXTURE_2D,$e,V,pe[0].width,pe[0].height);for(let nt=0,ge=pe.length;nt<ge;nt++)G=pe[nt],Ie.format!==oc?Ge!==null?Ue?t.compressedTexSubImage2D(n.TEXTURE_2D,nt,0,0,G.width,G.height,Ge,G.data):t.compressedTexImage2D(n.TEXTURE_2D,nt,V,G.width,G.height,0,G.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ue?t.texSubImage2D(n.TEXTURE_2D,nt,0,0,G.width,G.height,Ge,ee,G.data):t.texImage2D(n.TEXTURE_2D,nt,V,G.width,G.height,0,Ge,ee,G.data)}else if(Ie.isDataArrayTexture)Ue?(Qe&&t.texStorage3D(n.TEXTURE_2D_ARRAY,$e,V,Ee.width,Ee.height,Ee.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ee.width,Ee.height,Ee.depth,Ge,ee,Ee.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,V,Ee.width,Ee.height,Ee.depth,0,Ge,ee,Ee.data);else if(Ie.isData3DTexture)Ue?(Qe&&t.texStorage3D(n.TEXTURE_3D,$e,V,Ee.width,Ee.height,Ee.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ee.width,Ee.height,Ee.depth,Ge,ee,Ee.data)):t.texImage3D(n.TEXTURE_3D,0,V,Ee.width,Ee.height,Ee.depth,0,Ge,ee,Ee.data);else if(Ie.isFramebufferTexture){if(Qe)if(Ue)t.texStorage2D(n.TEXTURE_2D,$e,V,Ee.width,Ee.height);else{let nt=Ee.width,ge=Ee.height;for(let ot=0;ot<$e;ot++)t.texImage2D(n.TEXTURE_2D,ot,V,nt,ge,0,Ge,ee,null),nt>>=1,ge>>=1}}else if(pe.length>0&&ze){Ue&&Qe&&t.texStorage2D(n.TEXTURE_2D,$e,V,pe[0].width,pe[0].height);for(let nt=0,ge=pe.length;nt<ge;nt++)G=pe[nt],Ue?t.texSubImage2D(n.TEXTURE_2D,nt,0,0,Ge,ee,G):t.texImage2D(n.TEXTURE_2D,nt,V,Ge,ee,G);Ie.generateMipmaps=!1}else Ue?(Qe&&t.texStorage2D(n.TEXTURE_2D,$e,V,Ee.width,Ee.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ge,ee,Ee)):t.texImage2D(n.TEXTURE_2D,0,V,Ge,ee,Ee);w(Ie,ze)&&M(kt),ae.__version=he.version,Ie.onUpdate&&Ie.onUpdate(Ie)}Oe.__version=Ie.version}function ut(Oe,Ie,yt){if(Ie.image.length!==6)return;let kt=Fe(Oe,Ie),De=Ie.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture,n.TEXTURE0+yt);let he=i.get(De);if(De.version!==he.__version||kt===!0){t.activeTexture(n.TEXTURE0+yt);let ae=Hr.getPrimaries(Hr.workingColorSpace),de=Ie.colorSpace===Ua?null:Hr.getPrimaries(Ie.colorSpace),we=Ie.colorSpace===Ua||ae===de?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ie.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ie.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ie.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,we);let Ae=Ie.isCompressedTexture||Ie.image[0].isCompressedTexture,Le=Ie.image[0]&&Ie.image[0].isDataTexture,Ee=[];for(let nt=0;nt<6;nt++)!Ae&&!Le?Ee[nt]=E(Ie.image[nt],!1,!0,s.maxCubemapSize):Ee[nt]=Le?Ie.image[nt].image:Ie.image[nt],Ee[nt]=Jt(Ie,Ee[nt]);let ze=Ee[0],Ge=x(ze)||l,ee=o.convert(Ie.format,Ie.colorSpace),V=o.convert(Ie.type),G=T(Ie.internalFormat,ee,V,Ie.colorSpace),pe=l&&Ie.isVideoTexture!==!0,Ue=he.__version===void 0||kt===!0,Qe=D(Ie,ze,Ge);be(n.TEXTURE_CUBE_MAP,Ie,Ge);let $e;if(Ae){pe&&Ue&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,G,ze.width,ze.height);for(let nt=0;nt<6;nt++){$e=Ee[nt].mipmaps;for(let ge=0;ge<$e.length;ge++){let ot=$e[ge];Ie.format!==oc?ee!==null?pe?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge,0,0,ot.width,ot.height,ee,ot.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge,G,ot.width,ot.height,0,ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge,0,0,ot.width,ot.height,ee,V,ot.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge,G,ot.width,ot.height,0,ee,V,ot.data)}}}else{$e=Ie.mipmaps,pe&&Ue&&($e.length>0&&Qe++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,G,Ee[0].width,Ee[0].height));for(let nt=0;nt<6;nt++)if(Le){pe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,Ee[nt].width,Ee[nt].height,ee,V,Ee[nt].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,G,Ee[nt].width,Ee[nt].height,0,ee,V,Ee[nt].data);for(let ge=0;ge<$e.length;ge++){let et=$e[ge].image[nt].image;pe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge+1,0,0,et.width,et.height,ee,V,et.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge+1,G,et.width,et.height,0,ee,V,et.data)}}else{pe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,ee,V,Ee[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,G,ee,V,Ee[nt]);for(let ge=0;ge<$e.length;ge++){let ot=$e[ge];pe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge+1,0,0,ee,V,ot.image[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ge+1,G,ee,V,ot.image[nt])}}}w(Ie,Ge)&&M(n.TEXTURE_CUBE_MAP),he.__version=De.version,Ie.onUpdate&&Ie.onUpdate(Ie)}Oe.__version=Ie.version}function it(Oe,Ie,yt,kt,De,he){let ae=o.convert(yt.format,yt.colorSpace),de=o.convert(yt.type),we=T(yt.internalFormat,ae,de,yt.colorSpace);if(!i.get(Ie).__hasExternalTextures){let Le=Math.max(1,Ie.width>>he),Ee=Math.max(1,Ie.height>>he);De===n.TEXTURE_3D||De===n.TEXTURE_2D_ARRAY?t.texImage3D(De,he,we,Le,Ee,Ie.depth,0,ae,de,null):t.texImage2D(De,he,we,Le,Ee,0,ae,de,null)}t.bindFramebuffer(n.FRAMEBUFFER,Oe),Ot(Ie)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,kt,De,i.get(yt).__webglTexture,0,Vt(Ie)):(De===n.TEXTURE_2D||De>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&De<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,kt,De,i.get(yt).__webglTexture,he),t.bindFramebuffer(n.FRAMEBUFFER,null)}function gt(Oe,Ie,yt){if(n.bindRenderbuffer(n.RENDERBUFFER,Oe),Ie.depthBuffer&&!Ie.stencilBuffer){let kt=l===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(yt||Ot(Ie)){let De=Ie.depthTexture;De&&De.isDepthTexture&&(De.type===bu?kt=n.DEPTH_COMPONENT32F:De.type===_u&&(kt=n.DEPTH_COMPONENT24));let he=Vt(Ie);Ot(Ie)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,he,kt,Ie.width,Ie.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,he,kt,Ie.width,Ie.height)}else n.renderbufferStorage(n.RENDERBUFFER,kt,Ie.width,Ie.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,Oe)}else if(Ie.depthBuffer&&Ie.stencilBuffer){let kt=Vt(Ie);yt&&Ot(Ie)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,kt,n.DEPTH24_STENCIL8,Ie.width,Ie.height):Ot(Ie)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,kt,n.DEPTH24_STENCIL8,Ie.width,Ie.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,Ie.width,Ie.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,Oe)}else{let kt=Ie.isWebGLMultipleRenderTargets===!0?Ie.texture:[Ie.texture];for(let De=0;De<kt.length;De++){let he=kt[De],ae=o.convert(he.format,he.colorSpace),de=o.convert(he.type),we=T(he.internalFormat,ae,de,he.colorSpace),Ae=Vt(Ie);yt&&Ot(Ie)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ae,we,Ie.width,Ie.height):Ot(Ie)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ae,we,Ie.width,Ie.height):n.renderbufferStorage(n.RENDERBUFFER,we,Ie.width,Ie.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Rt(Oe,Ie){if(Ie&&Ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Oe),!(Ie.depthTexture&&Ie.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Ie.depthTexture).__webglTexture||Ie.depthTexture.image.width!==Ie.width||Ie.depthTexture.image.height!==Ie.height)&&(Ie.depthTexture.image.width=Ie.width,Ie.depthTexture.image.height=Ie.height,Ie.depthTexture.needsUpdate=!0),k(Ie.depthTexture,0);let kt=i.get(Ie.depthTexture).__webglTexture,De=Vt(Ie);if(Ie.depthTexture.format===Xh)Ot(Ie)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,kt,0,De):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,kt,0);else if(Ie.depthTexture.format===wp)Ot(Ie)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,kt,0,De):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,kt,0);else throw new Error("Unknown depthTexture format")}function It(Oe){let Ie=i.get(Oe),yt=Oe.isWebGLCubeRenderTarget===!0;if(Oe.depthTexture&&!Ie.__autoAllocateDepthBuffer){if(yt)throw new Error("target.depthTexture not supported in Cube render targets");Rt(Ie.__webglFramebuffer,Oe)}else if(yt){Ie.__webglDepthbuffer=[];for(let kt=0;kt<6;kt++)t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer[kt]),Ie.__webglDepthbuffer[kt]=n.createRenderbuffer(),gt(Ie.__webglDepthbuffer[kt],Oe,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),Ie.__webglDepthbuffer=n.createRenderbuffer(),gt(Ie.__webglDepthbuffer,Oe,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ft(Oe,Ie,yt){let kt=i.get(Oe);Ie!==void 0&&it(kt.__webglFramebuffer,Oe,Oe.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),yt!==void 0&&It(Oe)}function Ne(Oe){let Ie=Oe.texture,yt=i.get(Oe),kt=i.get(Ie);Oe.addEventListener("dispose",F),Oe.isWebGLMultipleRenderTargets!==!0&&(kt.__webglTexture===void 0&&(kt.__webglTexture=n.createTexture()),kt.__version=Ie.version,c.memory.textures++);let De=Oe.isWebGLCubeRenderTarget===!0,he=Oe.isWebGLMultipleRenderTargets===!0,ae=x(Oe)||l;if(De){yt.__webglFramebuffer=[];for(let de=0;de<6;de++)if(l&&Ie.mipmaps&&Ie.mipmaps.length>0){yt.__webglFramebuffer[de]=[];for(let we=0;we<Ie.mipmaps.length;we++)yt.__webglFramebuffer[de][we]=n.createFramebuffer()}else yt.__webglFramebuffer[de]=n.createFramebuffer()}else{if(l&&Ie.mipmaps&&Ie.mipmaps.length>0){yt.__webglFramebuffer=[];for(let de=0;de<Ie.mipmaps.length;de++)yt.__webglFramebuffer[de]=n.createFramebuffer()}else yt.__webglFramebuffer=n.createFramebuffer();if(he)if(s.drawBuffers){let de=Oe.texture;for(let we=0,Ae=de.length;we<Ae;we++){let Le=i.get(de[we]);Le.__webglTexture===void 0&&(Le.__webglTexture=n.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&Oe.samples>0&&Ot(Oe)===!1){let de=he?Ie:[Ie];yt.__webglMultisampledFramebuffer=n.createFramebuffer(),yt.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,yt.__webglMultisampledFramebuffer);for(let we=0;we<de.length;we++){let Ae=de[we];yt.__webglColorRenderbuffer[we]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,yt.__webglColorRenderbuffer[we]);let Le=o.convert(Ae.format,Ae.colorSpace),Ee=o.convert(Ae.type),ze=T(Ae.internalFormat,Le,Ee,Ae.colorSpace,Oe.isXRRenderTarget===!0),Ge=Vt(Oe);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ge,ze,Oe.width,Oe.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+we,n.RENDERBUFFER,yt.__webglColorRenderbuffer[we])}n.bindRenderbuffer(n.RENDERBUFFER,null),Oe.depthBuffer&&(yt.__webglDepthRenderbuffer=n.createRenderbuffer(),gt(yt.__webglDepthRenderbuffer,Oe,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(De){t.bindTexture(n.TEXTURE_CUBE_MAP,kt.__webglTexture),be(n.TEXTURE_CUBE_MAP,Ie,ae);for(let de=0;de<6;de++)if(l&&Ie.mipmaps&&Ie.mipmaps.length>0)for(let we=0;we<Ie.mipmaps.length;we++)it(yt.__webglFramebuffer[de][we],Oe,Ie,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+de,we);else it(yt.__webglFramebuffer[de],Oe,Ie,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+de,0);w(Ie,ae)&&M(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(he){let de=Oe.texture;for(let we=0,Ae=de.length;we<Ae;we++){let Le=de[we],Ee=i.get(Le);t.bindTexture(n.TEXTURE_2D,Ee.__webglTexture),be(n.TEXTURE_2D,Le,ae),it(yt.__webglFramebuffer,Oe,Le,n.COLOR_ATTACHMENT0+we,n.TEXTURE_2D,0),w(Le,ae)&&M(n.TEXTURE_2D)}t.unbindTexture()}else{let de=n.TEXTURE_2D;if((Oe.isWebGL3DRenderTarget||Oe.isWebGLArrayRenderTarget)&&(l?de=Oe.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(de,kt.__webglTexture),be(de,Ie,ae),l&&Ie.mipmaps&&Ie.mipmaps.length>0)for(let we=0;we<Ie.mipmaps.length;we++)it(yt.__webglFramebuffer[we],Oe,Ie,n.COLOR_ATTACHMENT0,de,we);else it(yt.__webglFramebuffer,Oe,Ie,n.COLOR_ATTACHMENT0,de,0);w(Ie,ae)&&M(de),t.unbindTexture()}Oe.depthBuffer&&It(Oe)}function pn(Oe){let Ie=x(Oe)||l,yt=Oe.isWebGLMultipleRenderTargets===!0?Oe.texture:[Oe.texture];for(let kt=0,De=yt.length;kt<De;kt++){let he=yt[kt];if(w(he,Ie)){let ae=Oe.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,de=i.get(he).__webglTexture;t.bindTexture(ae,de),M(ae),t.unbindTexture()}}}function St(Oe){if(l&&Oe.samples>0&&Ot(Oe)===!1){let Ie=Oe.isWebGLMultipleRenderTargets?Oe.texture:[Oe.texture],yt=Oe.width,kt=Oe.height,De=n.COLOR_BUFFER_BIT,he=[],ae=Oe.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,de=i.get(Oe),we=Oe.isWebGLMultipleRenderTargets===!0;if(we)for(let Ae=0;Ae<Ie.length;Ae++)t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ae,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,de.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ae,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,de.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,de.__webglFramebuffer);for(let Ae=0;Ae<Ie.length;Ae++){he.push(n.COLOR_ATTACHMENT0+Ae),Oe.depthBuffer&&he.push(ae);let Le=de.__ignoreDepthValues!==void 0?de.__ignoreDepthValues:!1;if(Le===!1&&(Oe.depthBuffer&&(De|=n.DEPTH_BUFFER_BIT),Oe.stencilBuffer&&(De|=n.STENCIL_BUFFER_BIT)),we&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,de.__webglColorRenderbuffer[Ae]),Le===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[ae]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[ae])),we){let Ee=i.get(Ie[Ae]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ee,0)}n.blitFramebuffer(0,0,yt,kt,0,0,yt,kt,De,n.NEAREST),h&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,he)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),we)for(let Ae=0;Ae<Ie.length;Ae++){t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ae,n.RENDERBUFFER,de.__webglColorRenderbuffer[Ae]);let Le=i.get(Ie[Ae]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,de.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ae,n.TEXTURE_2D,Le,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,de.__webglMultisampledFramebuffer)}}function Vt(Oe){return Math.min(s.maxSamples,Oe.samples)}function Ot(Oe){let Ie=i.get(Oe);return l&&Oe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Ie.__useRenderToTexture!==!1}function xn(Oe){let Ie=c.render.frame;p.get(Oe)!==Ie&&(p.set(Oe,Ie),Oe.update())}function Jt(Oe,Ie){let yt=Oe.colorSpace,kt=Oe.format,De=Oe.type;return Oe.isCompressedTexture===!0||Oe.isVideoTexture===!0||Oe.format===BS||yt!==bl&&yt!==Ua&&(Hr.getTransfer(yt)===Zr?l===!1?e.has("EXT_sRGB")===!0&&kt===oc?(Oe.format=BS,Oe.minFilter=Na,Oe.generateMipmaps=!1):Ie=eE.sRGBToLinear(Ie):(kt!==oc||De!==Su)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",yt)),Ie}this.allocateTextureUnit=U,this.resetTextureUnits=te,this.setTexture2D=k,this.setTexture2DArray=z,this.setTexture3D=Q,this.setTextureCube=Z,this.rebindTextures=Ft,this.setupRenderTarget=Ne,this.updateRenderTargetMipmap=pn,this.updateMultisampleRenderTarget=St,this.setupDepthRenderbuffer=It,this.setupFrameBufferTexture=it,this.useMultisampledRTT=Ot}function toe(n,e,t){let i=t.isWebGL2;function s(o,c=Ua){let l,u=Hr.getTransfer(c);if(o===Su)return n.UNSIGNED_BYTE;if(o===LU)return n.UNSIGNED_SHORT_4_4_4_4;if(o===PU)return n.UNSIGNED_SHORT_5_5_5_1;if(o===Qee)return n.BYTE;if(o===Xee)return n.SHORT;if(o===u2)return n.UNSIGNED_SHORT;if(o===DU)return n.INT;if(o===_u)return n.UNSIGNED_INT;if(o===bu)return n.FLOAT;if(o===Gg)return i?n.HALF_FLOAT:(l=e.get("OES_texture_half_float"),l!==null?l.HALF_FLOAT_OES:null);if(o===qee)return n.ALPHA;if(o===oc)return n.RGBA;if(o===Yee)return n.LUMINANCE;if(o===Kee)return n.LUMINANCE_ALPHA;if(o===Xh)return n.DEPTH_COMPONENT;if(o===wp)return n.DEPTH_STENCIL;if(o===BS)return l=e.get("EXT_sRGB"),l!==null?l.SRGB_ALPHA_EXT:null;if(o===$ee)return n.RED;if(o===BU)return n.RED_INTEGER;if(o===Jee)return n.RG;if(o===OU)return n.RG_INTEGER;if(o===NU)return n.RGBA_INTEGER;if(o===$C||o===JC||o===ZC||o===eS)if(u===Zr)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(o===$C)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===JC)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===ZC)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===eS)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(o===$C)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===JC)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===ZC)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===eS)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===hF||o===dF||o===fF||o===pF)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(o===hF)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===dF)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===fF)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===pF)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===FU)return l=e.get("WEBGL_compressed_texture_etc1"),l!==null?l.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===mF||o===gF)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(o===mF)return u===Zr?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(o===gF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===AF||o===vF||o===yF||o===xF||o===EF||o===_F||o===bF||o===MF||o===wF||o===CF||o===SF||o===TF||o===IF||o===RF)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(o===AF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===vF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===yF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===xF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===EF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===_F)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===bF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===MF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===wF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===CF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===SF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===TF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===IF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===RF)return u===Zr?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===tS||o===DF||o===LF)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(o===tS)return u===Zr?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(o===DF)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(o===LF)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(o===Zee||o===PF||o===BF||o===OF)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(o===tS)return l.COMPRESSED_RED_RGTC1_EXT;if(o===PF)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(o===BF)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(o===OF)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return o===Qh?i?n.UNSIGNED_INT_24_8:(l=e.get("WEBGL_depth_texture"),l!==null?l.UNSIGNED_INT_24_8_WEBGL:null):n[o]!==void 0?n[o]:null}return{convert:s}}function ioe(n,e){function t(x,v){x.matrixAutoUpdate===!0&&x.updateMatrix(),v.value.copy(x.matrix)}function i(x,v){v.color.getRGB(x.fogColor.value,zU(n)),v.isFog?(x.fogNear.value=v.near,x.fogFar.value=v.far):v.isFogExp2&&(x.fogDensity.value=v.density)}function s(x,v,w,M,T){v.isMeshBasicMaterial||v.isMeshLambertMaterial?o(x,v):v.isMeshToonMaterial?(o(x,v),f(x,v)):v.isMeshPhongMaterial?(o(x,v),p(x,v)):v.isMeshStandardMaterial?(o(x,v),m(x,v),v.isMeshPhysicalMaterial&&A(x,v,T)):v.isMeshMatcapMaterial?(o(x,v),y(x,v)):v.isMeshDepthMaterial?o(x,v):v.isMeshDistanceMaterial?(o(x,v),E(x,v)):v.isMeshNormalMaterial?o(x,v):v.isLineBasicMaterial?(c(x,v),v.isLineDashedMaterial&&l(x,v)):v.isPointsMaterial?u(x,v,w,M):v.isSpriteMaterial?h(x,v):v.isShadowMaterial?(x.color.value.copy(v.color),x.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function o(x,v){x.opacity.value=v.opacity,v.color&&x.diffuse.value.copy(v.color),v.emissive&&x.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.bumpMap&&(x.bumpMap.value=v.bumpMap,t(v.bumpMap,x.bumpMapTransform),x.bumpScale.value=v.bumpScale,v.side===Xo&&(x.bumpScale.value*=-1)),v.normalMap&&(x.normalMap.value=v.normalMap,t(v.normalMap,x.normalMapTransform),x.normalScale.value.copy(v.normalScale),v.side===Xo&&x.normalScale.value.negate()),v.displacementMap&&(x.displacementMap.value=v.displacementMap,t(v.displacementMap,x.displacementMapTransform),x.displacementScale.value=v.displacementScale,x.displacementBias.value=v.displacementBias),v.emissiveMap&&(x.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,x.emissiveMapTransform)),v.specularMap&&(x.specularMap.value=v.specularMap,t(v.specularMap,x.specularMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest);let w=e.get(v).envMap;if(w&&(x.envMap.value=w,x.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=v.reflectivity,x.ior.value=v.ior,x.refractionRatio.value=v.refractionRatio),v.lightMap){x.lightMap.value=v.lightMap;let M=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=v.lightMapIntensity*M,t(v.lightMap,x.lightMapTransform)}v.aoMap&&(x.aoMap.value=v.aoMap,x.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,x.aoMapTransform))}function c(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform))}function l(x,v){x.dashSize.value=v.dashSize,x.totalSize.value=v.dashSize+v.gapSize,x.scale.value=v.scale}function u(x,v,w,M){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.size.value=v.size*w,x.scale.value=M*.5,v.map&&(x.map.value=v.map,t(v.map,x.uvTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function h(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.rotation.value=v.rotation,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function p(x,v){x.specular.value.copy(v.specular),x.shininess.value=Math.max(v.shininess,1e-4)}function f(x,v){v.gradientMap&&(x.gradientMap.value=v.gradientMap)}function m(x,v){x.metalness.value=v.metalness,v.metalnessMap&&(x.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,x.metalnessMapTransform)),x.roughness.value=v.roughness,v.roughnessMap&&(x.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,x.roughnessMapTransform)),e.get(v).envMap&&(x.envMapIntensity.value=v.envMapIntensity)}function A(x,v,w){x.ior.value=v.ior,v.sheen>0&&(x.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),x.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(x.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,x.sheenColorMapTransform)),v.sheenRoughnessMap&&(x.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,x.sheenRoughnessMapTransform))),v.clearcoat>0&&(x.clearcoat.value=v.clearcoat,x.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(x.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,x.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(x.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Xo&&x.clearcoatNormalScale.value.negate())),v.iridescence>0&&(x.iridescence.value=v.iridescence,x.iridescenceIOR.value=v.iridescenceIOR,x.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(x.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,x.iridescenceMapTransform)),v.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),v.transmission>0&&(x.transmission.value=v.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),v.transmissionMap&&(x.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,x.transmissionMapTransform)),x.thickness.value=v.thickness,v.thicknessMap&&(x.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=v.attenuationDistance,x.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(x.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(x.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=v.specularIntensity,x.specularColor.value.copy(v.specularColor),v.specularColorMap&&(x.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,x.specularColorMapTransform)),v.specularIntensityMap&&(x.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,x.specularIntensityMapTransform))}function y(x,v){v.matcap&&(x.matcap.value=v.matcap)}function E(x,v){let w=e.get(v).light;x.referencePosition.value.setFromMatrixPosition(w.matrixWorld),x.nearDistance.value=w.shadow.camera.near,x.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function roe(n,e,t,i){let s={},o={},c=[],l=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(w,M){let T=M.program;i.uniformBlockBinding(w,T)}function h(w,M){let T=s[w.id];T===void 0&&(y(w),T=p(w),s[w.id]=T,w.addEventListener("dispose",x));let D=M.program;i.updateUBOMapping(w,D);let L=e.render.frame;o[w.id]!==L&&(m(w),o[w.id]=L)}function p(w){let M=f();w.__bindingPointIndex=M;let T=n.createBuffer(),D=w.__size,L=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,T),n.bufferData(n.UNIFORM_BUFFER,D,L),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,T),T}function f(){for(let w=0;w<l;w++)if(c.indexOf(w)===-1)return c.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(w){let M=s[w.id],T=w.uniforms,D=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let L=0,I=T.length;L<I;L++){let F=Array.isArray(T[L])?T[L]:[T[L]];for(let R=0,N=F.length;R<N;R++){let X=F[R];if(A(X,L,R,D)===!0){let $=X.__offset,te=Array.isArray(X.value)?X.value:[X.value],U=0;for(let P=0;P<te.length;P++){let k=te[P],z=E(k);typeof k=="number"||typeof k=="boolean"?(X.__data[0]=k,n.bufferSubData(n.UNIFORM_BUFFER,$+U,X.__data)):k.isMatrix3?(X.__data[0]=k.elements[0],X.__data[1]=k.elements[1],X.__data[2]=k.elements[2],X.__data[3]=0,X.__data[4]=k.elements[3],X.__data[5]=k.elements[4],X.__data[6]=k.elements[5],X.__data[7]=0,X.__data[8]=k.elements[6],X.__data[9]=k.elements[7],X.__data[10]=k.elements[8],X.__data[11]=0):(k.toArray(X.__data,U),U+=z.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,$,X.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function A(w,M,T,D){let L=w.value,I=M+"_"+T;if(D[I]===void 0)return typeof L=="number"||typeof L=="boolean"?D[I]=L:D[I]=L.clone(),!0;{let F=D[I];if(typeof L=="number"||typeof L=="boolean"){if(F!==L)return D[I]=L,!0}else if(F.equals(L)===!1)return F.copy(L),!0}return!1}function y(w){let M=w.uniforms,T=0,D=16;for(let I=0,F=M.length;I<F;I++){let R=Array.isArray(M[I])?M[I]:[M[I]];for(let N=0,X=R.length;N<X;N++){let $=R[N],te=Array.isArray($.value)?$.value:[$.value];for(let U=0,P=te.length;U<P;U++){let k=te[U],z=E(k),Q=T%D;Q!==0&&D-Q<z.boundary&&(T+=D-Q),$.__data=new Float32Array(z.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=T,T+=z.storage}}}let L=T%D;return L>0&&(T+=D-L),w.__size=T,w.__cache={},this}function E(w){let M={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(M.boundary=4,M.storage=4):w.isVector2?(M.boundary=8,M.storage=8):w.isVector3||w.isColor?(M.boundary=16,M.storage=12):w.isVector4?(M.boundary=16,M.storage=16):w.isMatrix3?(M.boundary=48,M.storage=48):w.isMatrix4?(M.boundary=64,M.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),M}function x(w){let M=w.target;M.removeEventListener("dispose",x);let T=c.indexOf(M.__bindingPointIndex);c.splice(T,1),n.deleteBuffer(s[M.id]),delete s[M.id],delete o[M.id]}function v(){for(let w in s)n.deleteBuffer(s[w]);c=[],s={},o={}}return{bind:u,update:h,dispose:v}}function jx(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function soe(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}var l2,hee,iF,dee,IU,fee,xl,Tu,Xo,El,wu,xp,rF,sF,oF,pee,Wh,mee,gee,aF,cF,Aee,vee,yee,xee,TS,IS,Eee,_ee,bee,Mee,wee,Cee,See,Tee,Iee,Ree,Dee,Lee,Qx,Pee,Bee,Oee,Nee,RU,Fee,Uee,Cu,kee,Vee,Hee,zee,Gee,Wee,lF,bp,Mp,RS,DS,fE,LS,sc,PS,Po,uF,KC,Na,jee,zg,Su,Qee,Xee,u2,DU,_u,bu,Gg,LU,PU,Qh,qee,oc,Yee,Kee,Xh,wp,$ee,BU,Jee,OU,NU,$C,JC,ZC,eS,hF,dF,fF,pF,FU,mF,gF,AF,vF,yF,xF,EF,_F,bF,MF,wF,CF,SF,TF,IF,RF,tS,DF,LF,Zee,PF,BF,OF,Xx,qx,nS,NF,FF,UF,UU,qh,ete,tte,nte,ite,Ua,ro,bl,h2,pE,Yx,Zr,Kx,$x,tp,kF,rte,ste,ote,kU,ate,cte,lte,ute,VF,HF,BS,_l,Jx,Iu,Ao,iS,OS,zr,ar,sS,GF,WF,jF,_x,fte,Hr,np,eE,pte,tE,mte,Ip,so,FS,Ml,nE,US,Ru,Lt,cS,QF,Yh,ml,nc,bx,ip,rp,sp,Au,vu,kh,Ng,Mx,wx,Vh,gte,Fg,uS,Cp,gl,hS,Cx,yu,dS,Sx,fS,iE,oo,op,ic,Ate,vte,xu,Tx,ua,XF,qF,yte,rE,xte,YF,ap,Al,Ix,Ug,Ete,_te,KF,$F,JF,bte,Mte,Sl,rc,vl,pS,yl,cp,lp,ZF,mS,gS,AS,Rx,Mu,HU,Eu,Dx,cr,vo,wte,Kh,Ic,xs,Lx,Bo,sE,oE,fa,Cte,Oa,yS,up,ha,kg,Qs,ka,eU,Hh,Px,tU,hp,dp,fp,xS,Bx,Ox,Nx,Fx,nU,iU,rU,Ux,kx,yo,wl,Ite,Rte,Dte,Cl,aE,da,pp,mp,kS,cE,VS,ES,Lte,Pte,Fa,zh,Hx,lE,HS,Ote,Nte,Fte,Ute,kte,Vte,Hte,zte,Gte,Wte,jte,Qte,Xte,qte,Yte,Kte,$te,Jte,Zte,ene,tne,nne,ine,rne,sne,one,ane,cne,lne,une,hne,dne,fne,pne,mne,gne,Ane,vne,yne,xne,Ene,_ne,bne,Mne,wne,Cne,Sne,Tne,Ine,Rne,Dne,Lne,Pne,Bne,One,Nne,Fne,Une,kne,Vne,Hne,zne,Gne,Wne,jne,Qne,Xne,qne,Yne,Kne,$ne,Jne,Zne,eie,tie,nie,iie,rie,sie,oie,aie,cie,lie,uie,hie,die,fie,pie,mie,gie,Aie,vie,yie,xie,Eie,_ie,bie,Mie,wie,Cie,Sie,Tie,Iie,Rie,Die,Lie,Pie,Bie,Oie,Nie,Fie,Uie,kie,Vie,Hie,zie,Gie,Wie,jie,Qie,Xie,qie,Yie,Kie,$ie,Jie,Zie,ere,tre,nre,ire,rre,sre,ore,are,cre,lre,ure,hre,dre,fre,Ji,Bn,Tc,zx,zS,Ap,sU,jh,_S,oU,bS,MS,wS,Gh,gp,aU,uE,hE,WU,jU,QU,XU,qU,hU,dU,fU,pU,mU,GS,WS,jS,CS,_p,vse,yse,Tse,Ise,Dse,kse,XS,qS,Qse,YS,KS,Kse,$se,$S,yp,noe,Hg,JS,ZS,e2,Wg,CU,SU,TU,SS,Wx,dE,jg,Tp,t2,n2,i2,ac,$h,r2,s2,o2,Qg,Jh,a2,f2,ooe,p2,aoe,coe,loe,uoe,hoe,doe,foe,c2,ms,sme,YU=zc(()=>{"use strict";l2="160",hee=0,iF=1,dee=2,IU=1,fee=2,xl=3,Tu=0,Xo=1,El=2,wu=0,xp=1,rF=2,sF=3,oF=4,pee=5,Wh=100,mee=101,gee=102,aF=103,cF=104,Aee=200,vee=201,yee=202,xee=203,TS=204,IS=205,Eee=206,_ee=207,bee=208,Mee=209,wee=210,Cee=211,See=212,Tee=213,Iee=214,Ree=0,Dee=1,Lee=2,Qx=3,Pee=4,Bee=5,Oee=6,Nee=7,RU=0,Fee=1,Uee=2,Cu=0,kee=1,Vee=2,Hee=3,zee=4,Gee=5,Wee=6,lF=300,bp=301,Mp=302,RS=303,DS=304,fE=306,LS=1e3,sc=1001,PS=1002,Po=1003,uF=1004,KC=1005,Na=1006,jee=1007,zg=1008,Su=1009,Qee=1010,Xee=1011,u2=1012,DU=1013,_u=1014,bu=1015,Gg=1016,LU=1017,PU=1018,Qh=1020,qee=1021,oc=1023,Yee=1024,Kee=1025,Xh=1026,wp=1027,$ee=1028,BU=1029,Jee=1030,OU=1031,NU=1033,$C=33776,JC=33777,ZC=33778,eS=33779,hF=35840,dF=35841,fF=35842,pF=35843,FU=36196,mF=37492,gF=37496,AF=37808,vF=37809,yF=37810,xF=37811,EF=37812,_F=37813,bF=37814,MF=37815,wF=37816,CF=37817,SF=37818,TF=37819,IF=37820,RF=37821,tS=36492,DF=36494,LF=36495,Zee=36283,PF=36284,BF=36285,OF=36286,Xx=2300,qx=2301,nS=2302,NF=2400,FF=2401,UF=2402,UU=3e3,qh=3001,ete=3200,tte=3201,nte=0,ite=1,Ua="",ro="srgb",bl="srgb-linear",h2="display-p3",pE="display-p3-linear",Yx="linear",Zr="srgb",Kx="rec709",$x="p3",tp=7680,kF=519,rte=512,ste=513,ote=514,kU=515,ate=516,cte=517,lte=518,ute=519,VF=35044,HF="300 es",BS=1035,_l=2e3,Jx=2001,Iu=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let s=this._listeners[e];if(s!==void 0){let o=s.indexOf(t);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let s=i.slice(0);for(let o=0,c=s.length;o<c;o++)s[o].call(this,e);e.target=null}}},Ao=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],iS=Math.PI/180,OS=180/Math.PI;zr=class n{constructor(e=0,t=0){n.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Qo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),s=Math.sin(t),o=this.x-e.x,c=this.y-e.y;return this.x=o*i-c*s+e.x,this.y=o*s+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},ar=class n{constructor(e,t,i,s,o,c,l,u,h){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,l,u,h)}set(e,t,i,s,o,c,l,u,h){let p=this.elements;return p[0]=e,p[1]=s,p[2]=l,p[3]=t,p[4]=o,p[5]=u,p[6]=i,p[7]=c,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,c=i[0],l=i[3],u=i[6],h=i[1],p=i[4],f=i[7],m=i[2],A=i[5],y=i[8],E=s[0],x=s[3],v=s[6],w=s[1],M=s[4],T=s[7],D=s[2],L=s[5],I=s[8];return o[0]=c*E+l*w+u*D,o[3]=c*x+l*M+u*L,o[6]=c*v+l*T+u*I,o[1]=h*E+p*w+f*D,o[4]=h*x+p*M+f*L,o[7]=h*v+p*T+f*I,o[2]=m*E+A*w+y*D,o[5]=m*x+A*M+y*L,o[8]=m*v+A*T+y*I,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8];return t*c*p-t*l*h-i*o*p+i*l*u+s*o*h-s*c*u}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=p*c-l*h,m=l*u-p*o,A=h*o-c*u,y=t*f+i*m+s*A;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);let E=1/y;return e[0]=f*E,e[1]=(s*h-p*i)*E,e[2]=(l*i-s*c)*E,e[3]=m*E,e[4]=(p*t-s*u)*E,e[5]=(s*o-l*t)*E,e[6]=A*E,e[7]=(i*u-h*t)*E,e[8]=(c*t-i*o)*E,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,o,c,l){let u=Math.cos(o),h=Math.sin(o);return this.set(i*u,i*h,-i*(u*c+h*l)+c+e,-s*h,s*u,-s*(-h*c+u*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(sS.makeScale(e,t)),this}rotate(e){return this.premultiply(sS.makeRotation(-e)),this}translate(e,t){return this.premultiply(sS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},sS=new ar;GF={};WF=new ar().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),jF=new ar().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),_x={[bl]:{transfer:Yx,primaries:Kx,toReference:n=>n,fromReference:n=>n},[ro]:{transfer:Zr,primaries:Kx,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[pE]:{transfer:Yx,primaries:$x,toReference:n=>n.applyMatrix3(jF),fromReference:n=>n.applyMatrix3(WF)},[h2]:{transfer:Zr,primaries:$x,toReference:n=>n.convertSRGBToLinear().applyMatrix3(jF),fromReference:n=>n.applyMatrix3(WF).convertLinearToSRGB()}},fte=new Set([bl,pE]),Hr={enabled:!0,_workingColorSpace:bl,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!fte.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;let i=_x[e].toReference,s=_x[t].fromReference;return s(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return _x[n].primaries},getTransfer:function(n){return n===Ua?Yx:_x[n].transfer}};eE=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{np===void 0&&(np=Zx("canvas")),np.width=e.width,np.height=e.height;let i=np.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=np}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Zx("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let c=0;c<o.length;c++)o[c]=Ep(o[c]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Ep(t[i]/255)*255):t[i]=Ep(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},pte=0,tE=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:pte++}),this.uuid=Xg(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let c=0,l=s.length;c<l;c++)s[c].isDataTexture?o.push(aS(s[c].image)):o.push(aS(s[c]))}else o=aS(s);i.url=o}return t||(e.images[this.uuid]=i),i}};mte=0,Ip=(()=>{class n extends Iu{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,s=sc,o=sc,c=Na,l=zg,u=oc,h=Su,p=n.DEFAULT_ANISOTROPY,f=Ua){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mte++}),this.uuid=Xg(),this.name="",this.source=new tE(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=o,this.magFilter=c,this.minFilter=l,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=h,this.offset=new zr(0,0),this.repeat=new zr(1,1),this.center=new zr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ar,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Vg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===qh?ro:Ua),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==lF)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case LS:t.x=t.x-Math.floor(t.x);break;case sc:t.x=t.x<0?0:1;break;case PS:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case LS:t.y=t.y-Math.floor(t.y);break;case sc:t.y=t.y<0?0:1;break;case PS:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Vg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ro?qh:UU}set encoding(t){Vg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===qh?ro:Ua}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=lF,n.DEFAULT_ANISOTROPY=1,n})(),so=class n{constructor(e=0,t=0,i=0,s=1){n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=this.w,c=e.elements;return this.x=c[0]*t+c[4]*i+c[8]*s+c[12]*o,this.y=c[1]*t+c[5]*i+c[9]*s+c[13]*o,this.z=c[2]*t+c[6]*i+c[10]*s+c[14]*o,this.w=c[3]*t+c[7]*i+c[11]*s+c[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,o,u=e.elements,h=u[0],p=u[4],f=u[8],m=u[1],A=u[5],y=u[9],E=u[2],x=u[6],v=u[10];if(Math.abs(p-m)<.01&&Math.abs(f-E)<.01&&Math.abs(y-x)<.01){if(Math.abs(p+m)<.1&&Math.abs(f+E)<.1&&Math.abs(y+x)<.1&&Math.abs(h+A+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let M=(h+1)/2,T=(A+1)/2,D=(v+1)/2,L=(p+m)/4,I=(f+E)/4,F=(y+x)/4;return M>T&&M>D?M<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(M),s=L/i,o=I/i):T>D?T<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),i=L/s,o=F/s):D<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(D),i=I/o,s=F/o),this.set(i,s,o,t),this}let w=Math.sqrt((x-y)*(x-y)+(f-E)*(f-E)+(m-p)*(m-p));return Math.abs(w)<.001&&(w=1),this.x=(x-y)/w,this.y=(f-E)/w,this.z=(m-p)/w,this.w=Math.acos((h+A+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},FS=class extends Iu{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new so(0,0,e,t),this.scissorTest=!1,this.viewport=new so(0,0,e,t);let s={width:e,height:t,depth:1};i.encoding!==void 0&&(Vg("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===qh?ro:Ua),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Na,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Ip(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new tE(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Ml=class extends FS{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},nE=class extends Ip{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Po,this.minFilter=Po,this.wrapR=sc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},US=class extends Ip{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Po,this.minFilter=Po,this.wrapR=sc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Ru=class{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,o,c,l){let u=i[s+0],h=i[s+1],p=i[s+2],f=i[s+3],m=o[c+0],A=o[c+1],y=o[c+2],E=o[c+3];if(l===0){e[t+0]=u,e[t+1]=h,e[t+2]=p,e[t+3]=f;return}if(l===1){e[t+0]=m,e[t+1]=A,e[t+2]=y,e[t+3]=E;return}if(f!==E||u!==m||h!==A||p!==y){let x=1-l,v=u*m+h*A+p*y+f*E,w=v>=0?1:-1,M=1-v*v;if(M>Number.EPSILON){let D=Math.sqrt(M),L=Math.atan2(D,v*w);x=Math.sin(x*L)/D,l=Math.sin(l*L)/D}let T=l*w;if(u=u*x+m*T,h=h*x+A*T,p=p*x+y*T,f=f*x+E*T,x===1-l){let D=1/Math.sqrt(u*u+h*h+p*p+f*f);u*=D,h*=D,p*=D,f*=D}}e[t]=u,e[t+1]=h,e[t+2]=p,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,s,o,c){let l=i[s],u=i[s+1],h=i[s+2],p=i[s+3],f=o[c],m=o[c+1],A=o[c+2],y=o[c+3];return e[t]=l*y+p*f+u*A-h*m,e[t+1]=u*y+p*m+h*f-l*A,e[t+2]=h*y+p*A+l*m-u*f,e[t+3]=p*y-l*f-u*m-h*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let i=e._x,s=e._y,o=e._z,c=e._order,l=Math.cos,u=Math.sin,h=l(i/2),p=l(s/2),f=l(o/2),m=u(i/2),A=u(s/2),y=u(o/2);switch(c){case"XYZ":this._x=m*p*f+h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f-m*A*y;break;case"YXZ":this._x=m*p*f+h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f+m*A*y;break;case"ZXY":this._x=m*p*f-h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f-m*A*y;break;case"ZYX":this._x=m*p*f-h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f+m*A*y;break;case"YZX":this._x=m*p*f+h*A*y,this._y=h*A*f+m*p*y,this._z=h*p*y-m*A*f,this._w=h*p*f-m*A*y;break;case"XZY":this._x=m*p*f-h*A*y,this._y=h*A*f-m*p*y,this._z=h*p*y+m*A*f,this._w=h*p*f+m*A*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],s=t[4],o=t[8],c=t[1],l=t[5],u=t[9],h=t[2],p=t[6],f=t[10],m=i+l+f;if(m>0){let A=.5/Math.sqrt(m+1);this._w=.25/A,this._x=(p-u)*A,this._y=(o-h)*A,this._z=(c-s)*A}else if(i>l&&i>f){let A=2*Math.sqrt(1+i-l-f);this._w=(p-u)/A,this._x=.25*A,this._y=(s+c)/A,this._z=(o+h)/A}else if(l>f){let A=2*Math.sqrt(1+l-i-f);this._w=(o-h)/A,this._x=(s+c)/A,this._y=.25*A,this._z=(u+p)/A}else{let A=2*Math.sqrt(1+f-i-l);this._w=(c-s)/A,this._x=(o+h)/A,this._y=(u+p)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qo(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,s=e._y,o=e._z,c=e._w,l=t._x,u=t._y,h=t._z,p=t._w;return this._x=i*p+c*l+s*h-o*u,this._y=s*p+c*u+o*l-i*h,this._z=o*p+c*h+i*u-s*l,this._w=c*p-i*l-s*u-o*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,s=this._y,o=this._z,c=this._w,l=c*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=c,this._x=i,this._y=s,this._z=o,this;let u=1-l*l;if(u<=Number.EPSILON){let A=1-t;return this._w=A*c+t*this._w,this._x=A*i+t*this._x,this._y=A*s+t*this._y,this._z=A*o+t*this._z,this.normalize(),this}let h=Math.sqrt(u),p=Math.atan2(h,l),f=Math.sin((1-t)*p)/h,m=Math.sin(t*p)/h;return this._w=c*f+this._w*m,this._x=i*f+this._x*m,this._y=s*f+this._y*m,this._z=o*f+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),s=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(s),i*Math.sin(o),i*Math.cos(o),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Lt=class n{constructor(e=0,t=0,i=0){n.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(QF.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(QF.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*s,this.y=o[1]*t+o[4]*i+o[7]*s,this.z=o[2]*t+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=e.elements,c=1/(o[3]*t+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*s+o[12])*c,this.y=(o[1]*t+o[5]*i+o[9]*s+o[13])*c,this.z=(o[2]*t+o[6]*i+o[10]*s+o[14])*c,this}applyQuaternion(e){let t=this.x,i=this.y,s=this.z,o=e.x,c=e.y,l=e.z,u=e.w,h=2*(c*s-l*i),p=2*(l*t-o*s),f=2*(o*i-c*t);return this.x=t+u*h+c*f-l*p,this.y=i+u*p+l*h-o*f,this.z=s+u*f+o*p-c*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s,this.y=o[1]*t+o[5]*i+o[9]*s,this.z=o[2]*t+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,s=e.y,o=e.z,c=t.x,l=t.y,u=t.z;return this.x=s*u-o*l,this.y=o*c-i*u,this.z=i*l-s*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return cS.copy(this).projectOnVector(e),this.sub(cS)}reflect(e){return this.sub(cS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Qo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},cS=new Lt,QF=new Ru,Yh=class{constructor(e=new Lt(1/0,1/0,1/0),t=new Lt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(nc.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(nc.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=nc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let o=i.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let c=0,l=o.count;c<l;c++)e.isMesh===!0?e.getVertexPosition(c,nc):nc.fromBufferAttribute(o,c),nc.applyMatrix4(e.matrixWorld),this.expandByPoint(nc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),bx.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),bx.copy(i.boundingBox)),bx.applyMatrix4(e.matrixWorld),this.union(bx)}let s=e.children;for(let o=0,c=s.length;o<c;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,nc),nc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ng),Mx.subVectors(this.max,Ng),ip.subVectors(e.a,Ng),rp.subVectors(e.b,Ng),sp.subVectors(e.c,Ng),Au.subVectors(rp,ip),vu.subVectors(sp,rp),kh.subVectors(ip,sp);let t=[0,-Au.z,Au.y,0,-vu.z,vu.y,0,-kh.z,kh.y,Au.z,0,-Au.x,vu.z,0,-vu.x,kh.z,0,-kh.x,-Au.y,Au.x,0,-vu.y,vu.x,0,-kh.y,kh.x,0];return!lS(t,ip,rp,sp,Mx)||(t=[1,0,0,0,1,0,0,0,1],!lS(t,ip,rp,sp,Mx))?!1:(wx.crossVectors(Au,vu),t=[wx.x,wx.y,wx.z],lS(t,ip,rp,sp,Mx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,nc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(nc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ml[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ml[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ml[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ml[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ml[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ml[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ml[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ml[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ml),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},ml=[new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt],nc=new Lt,bx=new Yh,ip=new Lt,rp=new Lt,sp=new Lt,Au=new Lt,vu=new Lt,kh=new Lt,Ng=new Lt,Mx=new Lt,wx=new Lt,Vh=new Lt;gte=new Yh,Fg=new Lt,uS=new Lt,Cp=class{constructor(e=new Lt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):gte.setFromPoints(e).getCenter(i);let s=0;for(let o=0,c=e.length;o<c;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Fg.subVectors(e,this.center);let t=Fg.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(Fg,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(uS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Fg.copy(e.center).add(uS)),this.expandByPoint(Fg.copy(e.center).sub(uS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},gl=new Lt,hS=new Lt,Cx=new Lt,yu=new Lt,dS=new Lt,Sx=new Lt,fS=new Lt,iE=class{constructor(e=new Lt,t=new Lt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,gl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=gl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(gl.copy(this.origin).addScaledVector(this.direction,t),gl.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){hS.copy(e).add(t).multiplyScalar(.5),Cx.copy(t).sub(e).normalize(),yu.copy(this.origin).sub(hS);let o=e.distanceTo(t)*.5,c=-this.direction.dot(Cx),l=yu.dot(this.direction),u=-yu.dot(Cx),h=yu.lengthSq(),p=Math.abs(1-c*c),f,m,A,y;if(p>0)if(f=c*u-l,m=c*l-u,y=o*p,f>=0)if(m>=-y)if(m<=y){let E=1/p;f*=E,m*=E,A=f*(f+c*m+2*l)+m*(c*f+m+2*u)+h}else m=o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;else m=-o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;else m<=-y?(f=Math.max(0,-(-c*o+l)),m=f>0?-o:Math.min(Math.max(-o,-u),o),A=-f*f+m*(m+2*u)+h):m<=y?(f=0,m=Math.min(Math.max(-o,-u),o),A=m*(m+2*u)+h):(f=Math.max(0,-(c*o+l)),m=f>0?o:Math.min(Math.max(-o,-u),o),A=-f*f+m*(m+2*u)+h);else m=c>0?-o:o,f=Math.max(0,-(c*m+l)),A=-f*f+m*(m+2*u)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(hS).addScaledVector(Cx,m),A}intersectSphere(e,t){gl.subVectors(e.center,this.origin);let i=gl.dot(this.direction),s=gl.dot(gl)-i*i,o=e.radius*e.radius;if(s>o)return null;let c=Math.sqrt(o-s),l=i-c,u=i+c;return u<0?null:l<0?this.at(u,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,o,c,l,u,h=1/this.direction.x,p=1/this.direction.y,f=1/this.direction.z,m=this.origin;return h>=0?(i=(e.min.x-m.x)*h,s=(e.max.x-m.x)*h):(i=(e.max.x-m.x)*h,s=(e.min.x-m.x)*h),p>=0?(o=(e.min.y-m.y)*p,c=(e.max.y-m.y)*p):(o=(e.max.y-m.y)*p,c=(e.min.y-m.y)*p),i>c||o>s||((o>i||isNaN(i))&&(i=o),(c<s||isNaN(s))&&(s=c),f>=0?(l=(e.min.z-m.z)*f,u=(e.max.z-m.z)*f):(l=(e.max.z-m.z)*f,u=(e.min.z-m.z)*f),i>u||l>s)||((l>i||i!==i)&&(i=l),(u<s||s!==s)&&(s=u),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,gl)!==null}intersectTriangle(e,t,i,s,o){dS.subVectors(t,e),Sx.subVectors(i,e),fS.crossVectors(dS,Sx);let c=this.direction.dot(fS),l;if(c>0){if(s)return null;l=1}else if(c<0)l=-1,c=-c;else return null;yu.subVectors(this.origin,e);let u=l*this.direction.dot(Sx.crossVectors(yu,Sx));if(u<0)return null;let h=l*this.direction.dot(dS.cross(yu));if(h<0||u+h>c)return null;let p=-l*yu.dot(fS);return p<0?null:this.at(p/c,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},oo=class n{constructor(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x)}set(e,t,i,s,o,c,l,u,h,p,f,m,A,y,E,x){let v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=s,v[1]=o,v[5]=c,v[9]=l,v[13]=u,v[2]=h,v[6]=p,v[10]=f,v[14]=m,v[3]=A,v[7]=y,v[11]=E,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,s=1/op.setFromMatrixColumn(e,0).length(),o=1/op.setFromMatrixColumn(e,1).length(),c=1/op.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*c,t[9]=i[9]*c,t[10]=i[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,s=e.y,o=e.z,c=Math.cos(i),l=Math.sin(i),u=Math.cos(s),h=Math.sin(s),p=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){let m=c*p,A=c*f,y=l*p,E=l*f;t[0]=u*p,t[4]=-u*f,t[8]=h,t[1]=A+y*h,t[5]=m-E*h,t[9]=-l*u,t[2]=E-m*h,t[6]=y+A*h,t[10]=c*u}else if(e.order==="YXZ"){let m=u*p,A=u*f,y=h*p,E=h*f;t[0]=m+E*l,t[4]=y*l-A,t[8]=c*h,t[1]=c*f,t[5]=c*p,t[9]=-l,t[2]=A*l-y,t[6]=E+m*l,t[10]=c*u}else if(e.order==="ZXY"){let m=u*p,A=u*f,y=h*p,E=h*f;t[0]=m-E*l,t[4]=-c*f,t[8]=y+A*l,t[1]=A+y*l,t[5]=c*p,t[9]=E-m*l,t[2]=-c*h,t[6]=l,t[10]=c*u}else if(e.order==="ZYX"){let m=c*p,A=c*f,y=l*p,E=l*f;t[0]=u*p,t[4]=y*h-A,t[8]=m*h+E,t[1]=u*f,t[5]=E*h+m,t[9]=A*h-y,t[2]=-h,t[6]=l*u,t[10]=c*u}else if(e.order==="YZX"){let m=c*u,A=c*h,y=l*u,E=l*h;t[0]=u*p,t[4]=E-m*f,t[8]=y*f+A,t[1]=f,t[5]=c*p,t[9]=-l*p,t[2]=-h*p,t[6]=A*f+y,t[10]=m-E*f}else if(e.order==="XZY"){let m=c*u,A=c*h,y=l*u,E=l*h;t[0]=u*p,t[4]=-f,t[8]=h*p,t[1]=m*f+E,t[5]=c*p,t[9]=A*f-y,t[2]=y*f-A,t[6]=l*p,t[10]=E*f+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ate,e,vte)}lookAt(e,t,i){let s=this.elements;return ua.subVectors(e,t),ua.lengthSq()===0&&(ua.z=1),ua.normalize(),xu.crossVectors(i,ua),xu.lengthSq()===0&&(Math.abs(i.z)===1?ua.x+=1e-4:ua.z+=1e-4,ua.normalize(),xu.crossVectors(i,ua)),xu.normalize(),Tx.crossVectors(ua,xu),s[0]=xu.x,s[4]=Tx.x,s[8]=ua.x,s[1]=xu.y,s[5]=Tx.y,s[9]=ua.y,s[2]=xu.z,s[6]=Tx.z,s[10]=ua.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,c=i[0],l=i[4],u=i[8],h=i[12],p=i[1],f=i[5],m=i[9],A=i[13],y=i[2],E=i[6],x=i[10],v=i[14],w=i[3],M=i[7],T=i[11],D=i[15],L=s[0],I=s[4],F=s[8],R=s[12],N=s[1],X=s[5],$=s[9],te=s[13],U=s[2],P=s[6],k=s[10],z=s[14],Q=s[3],Z=s[7],ce=s[11],Me=s[15];return o[0]=c*L+l*N+u*U+h*Q,o[4]=c*I+l*X+u*P+h*Z,o[8]=c*F+l*$+u*k+h*ce,o[12]=c*R+l*te+u*z+h*Me,o[1]=p*L+f*N+m*U+A*Q,o[5]=p*I+f*X+m*P+A*Z,o[9]=p*F+f*$+m*k+A*ce,o[13]=p*R+f*te+m*z+A*Me,o[2]=y*L+E*N+x*U+v*Q,o[6]=y*I+E*X+x*P+v*Z,o[10]=y*F+E*$+x*k+v*ce,o[14]=y*R+E*te+x*z+v*Me,o[3]=w*L+M*N+T*U+D*Q,o[7]=w*I+M*X+T*P+D*Z,o[11]=w*F+M*$+T*k+D*ce,o[15]=w*R+M*te+T*z+D*Me,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],s=e[8],o=e[12],c=e[1],l=e[5],u=e[9],h=e[13],p=e[2],f=e[6],m=e[10],A=e[14],y=e[3],E=e[7],x=e[11],v=e[15];return y*(+o*u*f-s*h*f-o*l*m+i*h*m+s*l*A-i*u*A)+E*(+t*u*A-t*h*m+o*c*m-s*c*A+s*h*p-o*u*p)+x*(+t*h*f-t*l*A-o*c*f+i*c*A+o*l*p-i*h*p)+v*(-s*l*p-t*u*f+t*l*m+s*c*f-i*c*m+i*u*p)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=e[9],m=e[10],A=e[11],y=e[12],E=e[13],x=e[14],v=e[15],w=f*x*h-E*m*h+E*u*A-l*x*A-f*u*v+l*m*v,M=y*m*h-p*x*h-y*u*A+c*x*A+p*u*v-c*m*v,T=p*E*h-y*f*h+y*l*A-c*E*A-p*l*v+c*f*v,D=y*f*u-p*E*u-y*l*m+c*E*m+p*l*x-c*f*x,L=t*w+i*M+s*T+o*D;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let I=1/L;return e[0]=w*I,e[1]=(E*m*o-f*x*o-E*s*A+i*x*A+f*s*v-i*m*v)*I,e[2]=(l*x*o-E*u*o+E*s*h-i*x*h-l*s*v+i*u*v)*I,e[3]=(f*u*o-l*m*o-f*s*h+i*m*h+l*s*A-i*u*A)*I,e[4]=M*I,e[5]=(p*x*o-y*m*o+y*s*A-t*x*A-p*s*v+t*m*v)*I,e[6]=(y*u*o-c*x*o-y*s*h+t*x*h+c*s*v-t*u*v)*I,e[7]=(c*m*o-p*u*o+p*s*h-t*m*h-c*s*A+t*u*A)*I,e[8]=T*I,e[9]=(y*f*o-p*E*o-y*i*A+t*E*A+p*i*v-t*f*v)*I,e[10]=(c*E*o-y*l*o+y*i*h-t*E*h-c*i*v+t*l*v)*I,e[11]=(p*l*o-c*f*o-p*i*h+t*f*h+c*i*A-t*l*A)*I,e[12]=D*I,e[13]=(p*E*s-y*f*s+y*i*m-t*E*m-p*i*x+t*f*x)*I,e[14]=(y*l*s-c*E*s-y*i*u+t*E*u+c*i*x-t*l*x)*I,e[15]=(c*f*s-p*l*s+p*i*u-t*f*u-c*i*m+t*l*m)*I,this}scale(e){let t=this.elements,i=e.x,s=e.y,o=e.z;return t[0]*=i,t[4]*=s,t[8]*=o,t[1]*=i,t[5]*=s,t[9]*=o,t[2]*=i,t[6]*=s,t[10]*=o,t[3]*=i,t[7]*=s,t[11]*=o,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),s=Math.sin(t),o=1-i,c=e.x,l=e.y,u=e.z,h=o*c,p=o*l;return this.set(h*c+i,h*l-s*u,h*u+s*l,0,h*l+s*u,p*l+i,p*u-s*c,0,h*u-s*l,p*u+s*c,o*u*u+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,o,c){return this.set(1,i,o,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){let s=this.elements,o=t._x,c=t._y,l=t._z,u=t._w,h=o+o,p=c+c,f=l+l,m=o*h,A=o*p,y=o*f,E=c*p,x=c*f,v=l*f,w=u*h,M=u*p,T=u*f,D=i.x,L=i.y,I=i.z;return s[0]=(1-(E+v))*D,s[1]=(A+T)*D,s[2]=(y-M)*D,s[3]=0,s[4]=(A-T)*L,s[5]=(1-(m+v))*L,s[6]=(x+w)*L,s[7]=0,s[8]=(y+M)*I,s[9]=(x-w)*I,s[10]=(1-(m+E))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){let s=this.elements,o=op.set(s[0],s[1],s[2]).length(),c=op.set(s[4],s[5],s[6]).length(),l=op.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],ic.copy(this);let h=1/o,p=1/c,f=1/l;return ic.elements[0]*=h,ic.elements[1]*=h,ic.elements[2]*=h,ic.elements[4]*=p,ic.elements[5]*=p,ic.elements[6]*=p,ic.elements[8]*=f,ic.elements[9]*=f,ic.elements[10]*=f,t.setFromRotationMatrix(ic),i.x=o,i.y=c,i.z=l,this}makePerspective(e,t,i,s,o,c,l=_l){let u=this.elements,h=2*o/(t-e),p=2*o/(i-s),f=(t+e)/(t-e),m=(i+s)/(i-s),A,y;if(l===_l)A=-(c+o)/(c-o),y=-2*c*o/(c-o);else if(l===Jx)A=-c/(c-o),y=-c*o/(c-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=h,u[4]=0,u[8]=f,u[12]=0,u[1]=0,u[5]=p,u[9]=m,u[13]=0,u[2]=0,u[6]=0,u[10]=A,u[14]=y,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,i,s,o,c,l=_l){let u=this.elements,h=1/(t-e),p=1/(i-s),f=1/(c-o),m=(t+e)*h,A=(i+s)*p,y,E;if(l===_l)y=(c+o)*f,E=-2*f;else if(l===Jx)y=o*f,E=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-m,u[1]=0,u[5]=2*p,u[9]=0,u[13]=-A,u[2]=0,u[6]=0,u[10]=E,u[14]=-y,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},op=new Lt,ic=new oo,Ate=new Lt(0,0,0),vte=new Lt(1,1,1),xu=new Lt,Tx=new Lt,ua=new Lt,XF=new oo,qF=new Ru,yte=(()=>{class n{constructor(t=0,i=0,s=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,o=this._order){return this._x=t,this._y=i,this._z=s,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){let o=t.elements,c=o[0],l=o[4],u=o[8],h=o[1],p=o[5],f=o[9],m=o[2],A=o[6],y=o[10];switch(i){case"XYZ":this._y=Math.asin(Qo(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-l,c)):(this._x=Math.atan2(A,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Qo(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,y),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-m,c),this._z=0);break;case"ZXY":this._x=Math.asin(Qo(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-m,y),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(h,c));break;case"ZYX":this._y=Math.asin(-Qo(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(A,y),this._z=Math.atan2(h,c)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(Qo(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,p),this._y=Math.atan2(-m,c)):(this._x=0,this._y=Math.atan2(u,y));break;case"XZY":this._z=Math.asin(-Qo(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(A,p),this._y=Math.atan2(u,c)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return XF.makeRotationFromQuaternion(t),this.setFromRotationMatrix(XF,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return qF.setFromEuler(this),this.setFromQuaternion(qF,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})(),rE=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},xte=0,YF=new Lt,ap=new Ru,Al=new oo,Ix=new Lt,Ug=new Lt,Ete=new Lt,_te=new Ru,KF=new Lt(1,0,0),$F=new Lt(0,1,0),JF=new Lt(0,0,1),bte={type:"added"},Mte={type:"removed"},Sl=(()=>{class n extends Iu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xte++}),this.uuid=Xg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let t=new Lt,i=new yte,s=new Ru,o=new Lt(1,1,1);function c(){s.setFromEuler(i,!1)}function l(){i.setFromQuaternion(s,void 0,!1)}i._onChange(c),s._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new oo},normalMatrix:{value:new ar}}),this.matrix=new oo,this.matrixWorld=new oo,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new rE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return ap.setFromAxisAngle(t,i),this.quaternion.multiply(ap),this}rotateOnWorldAxis(t,i){return ap.setFromAxisAngle(t,i),this.quaternion.premultiply(ap),this}rotateX(t){return this.rotateOnAxis(KF,t)}rotateY(t){return this.rotateOnAxis($F,t)}rotateZ(t){return this.rotateOnAxis(JF,t)}translateOnAxis(t,i){return YF.copy(t).applyQuaternion(this.quaternion),this.position.add(YF.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(KF,t)}translateY(t){return this.translateOnAxis($F,t)}translateZ(t){return this.translateOnAxis(JF,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Al.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?Ix.copy(t):Ix.set(t,i,s);let o=this.parent;this.updateWorldMatrix(!0,!1),Ug.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Al.lookAt(Ug,Ix,this.up):Al.lookAt(Ix,Ug,this.up),this.quaternion.setFromRotationMatrix(Al),o&&(Al.extractRotation(o.matrixWorld),ap.setFromRotationMatrix(Al),this.quaternion.premultiply(ap.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(bte)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}let i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Mte)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Al.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Al.multiply(t.parent.matrixWorld)),t.applyMatrix4(Al),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,o=this.children.length;s<o;s++){let l=this.children[s].getObjectByProperty(t,i);if(l!==void 0)return l}}getObjectsByProperty(t,i,s=[]){this[t]===i&&s.push(this);let o=this.children;for(let c=0,l=o.length;c<l;c++)o[c].getObjectsByProperty(t,i,s);return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ug,t,Ete),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ug,_te,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverseVisible(t)}traverseAncestors(t){let i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let i=this.children;for(let s=0,o=i.length;s<o;s++){let c=i[s];(c.matrixWorldAutoUpdate===!0||t===!0)&&c.updateMatrixWorld(t)}}updateWorldMatrix(t,i){let s=this.parent;if(t===!0&&s!==null&&s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){let o=this.children;for(let c=0,l=o.length;c<l;c++){let u=o[c];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(t){let i=t===void 0||typeof t=="string",s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),o.maxGeometryCount=this._maxGeometryCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function c(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(t)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=c(t.geometries,this.geometry);let u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){let h=u.shapes;if(Array.isArray(h))for(let p=0,f=h.length;p<f;p++){let m=h[p];c(t.shapes,m)}else c(t.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let u=[];for(let h=0,p=this.material.length;h<p;h++)u.push(c(t.materials,this.material[h]));o.material=u}else o.material=c(t.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){let h=this.animations[u];o.animations.push(c(t.animations,h))}}if(i){let u=l(t.geometries),h=l(t.materials),p=l(t.textures),f=l(t.images),m=l(t.shapes),A=l(t.skeletons),y=l(t.animations),E=l(t.nodes);u.length>0&&(s.geometries=u),h.length>0&&(s.materials=h),p.length>0&&(s.textures=p),f.length>0&&(s.images=f),m.length>0&&(s.shapes=m),A.length>0&&(s.skeletons=A),y.length>0&&(s.animations=y),E.length>0&&(s.nodes=E)}return s.object=o,s;function l(u){let h=[];for(let p in u){let f=u[p];delete f.metadata,h.push(f)}return h}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let s=0;s<t.children.length;s++){let o=t.children[s];this.add(o.clone())}return this}}return n.DEFAULT_UP=new Lt(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})(),rc=new Lt,vl=new Lt,pS=new Lt,yl=new Lt,cp=new Lt,lp=new Lt,ZF=new Lt,mS=new Lt,gS=new Lt,AS=new Lt,Rx=!1,Mu=class n{constructor(e=new Lt,t=new Lt,i=new Lt){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),rc.subVectors(e,t),s.cross(rc);let o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,t,i,s,o){rc.subVectors(s,t),vl.subVectors(i,t),pS.subVectors(e,t);let c=rc.dot(rc),l=rc.dot(vl),u=rc.dot(pS),h=vl.dot(vl),p=vl.dot(pS),f=c*h-l*l;if(f===0)return o.set(0,0,0),null;let m=1/f,A=(h*u-l*p)*m,y=(c*p-l*u)*m;return o.set(1-A-y,y,A)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,yl)===null?!1:yl.x>=0&&yl.y>=0&&yl.x+yl.y<=1}static getUV(e,t,i,s,o,c,l,u){return Rx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Rx=!0),this.getInterpolation(e,t,i,s,o,c,l,u)}static getInterpolation(e,t,i,s,o,c,l,u){return this.getBarycoord(e,t,i,s,yl)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(o,yl.x),u.addScaledVector(c,yl.y),u.addScaledVector(l,yl.z),u)}static isFrontFacing(e,t,i,s){return rc.subVectors(i,t),vl.subVectors(e,t),rc.cross(vl).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return rc.subVectors(this.c,this.b),vl.subVectors(this.a,this.b),rc.cross(vl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return n.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,s,o){return Rx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Rx=!0),n.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}getInterpolation(e,t,i,s,o){return n.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}containsPoint(e){return n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,s=this.b,o=this.c,c,l;cp.subVectors(s,i),lp.subVectors(o,i),mS.subVectors(e,i);let u=cp.dot(mS),h=lp.dot(mS);if(u<=0&&h<=0)return t.copy(i);gS.subVectors(e,s);let p=cp.dot(gS),f=lp.dot(gS);if(p>=0&&f<=p)return t.copy(s);let m=u*f-p*h;if(m<=0&&u>=0&&p<=0)return c=u/(u-p),t.copy(i).addScaledVector(cp,c);AS.subVectors(e,o);let A=cp.dot(AS),y=lp.dot(AS);if(y>=0&&A<=y)return t.copy(o);let E=A*h-u*y;if(E<=0&&h>=0&&y<=0)return l=h/(h-y),t.copy(i).addScaledVector(lp,l);let x=p*y-A*f;if(x<=0&&f-p>=0&&A-y>=0)return ZF.subVectors(o,s),l=(f-p)/(f-p+(A-y)),t.copy(s).addScaledVector(ZF,l);let v=1/(x+E+m);return c=E*v,l=m*v,t.copy(i).addScaledVector(cp,c).addScaledVector(lp,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},HU={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Eu={h:0,s:0,l:0},Dx={h:0,s:0,l:0};cr=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){let s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ro){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Hr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,s=Hr.workingColorSpace){return this.r=e,this.g=t,this.b=i,Hr.toWorkingColorSpace(this,s),this}setHSL(e,t,i,s=Hr.workingColorSpace){if(e=hte(e,1),t=Qo(t,0,1),i=Qo(i,0,1),t===0)this.r=this.g=this.b=i;else{let o=i<=.5?i*(1+t):i+t-i*t,c=2*i-o;this.r=vS(c,o,e+1/3),this.g=vS(c,o,e),this.b=vS(c,o,e-1/3)}return Hr.toWorkingColorSpace(this,s),this}setStyle(e,t=ro){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o,c=s[1],l=s[2];switch(c){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){let o=s[1],c=o.length;if(c===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(c===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ro){let i=HU[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ep(e.r),this.g=Ep(e.g),this.b=Ep(e.b),this}copyLinearToSRGB(e){return this.r=oS(e.r),this.g=oS(e.g),this.b=oS(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ro){return Hr.fromWorkingColorSpace(vo.copy(this),e),Math.round(Qo(vo.r*255,0,255))*65536+Math.round(Qo(vo.g*255,0,255))*256+Math.round(Qo(vo.b*255,0,255))}getHexString(e=ro){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Hr.workingColorSpace){Hr.fromWorkingColorSpace(vo.copy(this),t);let i=vo.r,s=vo.g,o=vo.b,c=Math.max(i,s,o),l=Math.min(i,s,o),u,h,p=(l+c)/2;if(l===c)u=0,h=0;else{let f=c-l;switch(h=p<=.5?f/(c+l):f/(2-c-l),c){case i:u=(s-o)/f+(s<o?6:0);break;case s:u=(o-i)/f+2;break;case o:u=(i-s)/f+4;break}u/=6}return e.h=u,e.s=h,e.l=p,e}getRGB(e,t=Hr.workingColorSpace){return Hr.fromWorkingColorSpace(vo.copy(this),t),e.r=vo.r,e.g=vo.g,e.b=vo.b,e}getStyle(e=ro){Hr.fromWorkingColorSpace(vo.copy(this),e);let t=vo.r,i=vo.g,s=vo.b;return e!==ro?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(Eu),this.setHSL(Eu.h+e,Eu.s+t,Eu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Eu),e.getHSL(Dx);let i=rS(Eu.h,Dx.h,t),s=rS(Eu.s,Dx.s,t),o=rS(Eu.l,Dx.l,t);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*s,this.g=o[1]*t+o[4]*i+o[7]*s,this.b=o[2]*t+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},vo=new cr;cr.NAMES=HU;wte=0,Kh=class extends Iu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:wte++}),this.uuid=Xg(),this.name="",this.type="Material",this.blending=xp,this.side=Tu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=TS,this.blendDst=IS,this.blendEquation=Wh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new cr(0,0,0),this.blendAlpha=0,this.depthFunc=Qx,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=kF,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tp,this.stencilZFail=tp,this.stencilZPass=tp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==xp&&(i.blending=this.blending),this.side!==Tu&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==TS&&(i.blendSrc=this.blendSrc),this.blendDst!==IS&&(i.blendDst=this.blendDst),this.blendEquation!==Wh&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Qx&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==kF&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==tp&&(i.stencilFail=this.stencilFail),this.stencilZFail!==tp&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==tp&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){let c=[];for(let l in o){let u=o[l];delete u.metadata,c.push(u)}return c}if(t){let o=s(e.textures),c=s(e.images);o.length>0&&(i.textures=o),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let s=t.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Ic=class extends Kh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=RU,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},xs=new Lt,Lx=new zr,Bo=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=VF,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=bu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Lx.fromBufferAttribute(this,t),Lx.applyMatrix3(e),this.setXY(t,Lx.x,Lx.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyMatrix3(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyMatrix4(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyNormalMatrix(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.transformDirection(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Og(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=jo(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Og(t,this.array)),t}setX(e,t){return this.normalized&&(t=jo(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Og(t,this.array)),t}setY(e,t){return this.normalized&&(t=jo(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Og(t,this.array)),t}setZ(e,t){return this.normalized&&(t=jo(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Og(t,this.array)),t}setW(e,t){return this.normalized&&(t=jo(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=jo(t,this.array),i=jo(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=jo(t,this.array),i=jo(i,this.array),s=jo(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e*=this.itemSize,this.normalized&&(t=jo(t,this.array),i=jo(i,this.array),s=jo(s,this.array),o=jo(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==VF&&(e.usage=this.usage),e}},sE=class extends Bo{constructor(e,t,i){super(new Uint16Array(e),t,i)}},oE=class extends Bo{constructor(e,t,i){super(new Uint32Array(e),t,i)}},fa=class extends Bo{constructor(e,t,i){super(new Float32Array(e),t,i)}},Cte=0,Oa=new oo,yS=new Sl,up=new Lt,ha=new Yh,kg=new Yh,Qs=new Lt,ka=class n extends Iu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Cte++}),this.uuid=Xg(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(VU(e)?oE:sE)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let o=new ar().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}let s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Oa.makeRotationFromQuaternion(e),this.applyMatrix4(Oa),this}rotateX(e){return Oa.makeRotationX(e),this.applyMatrix4(Oa),this}rotateY(e){return Oa.makeRotationY(e),this.applyMatrix4(Oa),this}rotateZ(e){return Oa.makeRotationZ(e),this.applyMatrix4(Oa),this}translate(e,t,i){return Oa.makeTranslation(e,t,i),this.applyMatrix4(Oa),this}scale(e,t,i){return Oa.makeScale(e,t,i),this.applyMatrix4(Oa),this}lookAt(e){return yS.lookAt(e),yS.updateMatrix(),this.applyMatrix4(yS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(up).negate(),this.translate(up.x,up.y,up.z),this}setFromPoints(e){let t=[];for(let i=0,s=e.length;i<s;i++){let o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new fa(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yh);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Lt(-1/0,-1/0,-1/0),new Lt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){let o=t[i];ha.setFromBufferAttribute(o),this.morphTargetsRelative?(Qs.addVectors(this.boundingBox.min,ha.min),this.boundingBox.expandByPoint(Qs),Qs.addVectors(this.boundingBox.max,ha.max),this.boundingBox.expandByPoint(Qs)):(this.boundingBox.expandByPoint(ha.min),this.boundingBox.expandByPoint(ha.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Cp);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Lt,1/0);return}if(e){let i=this.boundingSphere.center;if(ha.setFromBufferAttribute(e),t)for(let o=0,c=t.length;o<c;o++){let l=t[o];kg.setFromBufferAttribute(l),this.morphTargetsRelative?(Qs.addVectors(ha.min,kg.min),ha.expandByPoint(Qs),Qs.addVectors(ha.max,kg.max),ha.expandByPoint(Qs)):(ha.expandByPoint(kg.min),ha.expandByPoint(kg.max))}ha.getCenter(i);let s=0;for(let o=0,c=e.count;o<c;o++)Qs.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(Qs));if(t)for(let o=0,c=t.length;o<c;o++){let l=t[o],u=this.morphTargetsRelative;for(let h=0,p=l.count;h<p;h++)Qs.fromBufferAttribute(l,h),u&&(up.fromBufferAttribute(e,h),Qs.add(up)),s=Math.max(s,i.distanceToSquared(Qs))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,s=t.position.array,o=t.normal.array,c=t.uv.array,l=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Bo(new Float32Array(4*l),4));let u=this.getAttribute("tangent").array,h=[],p=[];for(let N=0;N<l;N++)h[N]=new Lt,p[N]=new Lt;let f=new Lt,m=new Lt,A=new Lt,y=new zr,E=new zr,x=new zr,v=new Lt,w=new Lt;function M(N,X,$){f.fromArray(s,N*3),m.fromArray(s,X*3),A.fromArray(s,$*3),y.fromArray(c,N*2),E.fromArray(c,X*2),x.fromArray(c,$*2),m.sub(f),A.sub(f),E.sub(y),x.sub(y);let te=1/(E.x*x.y-x.x*E.y);isFinite(te)&&(v.copy(m).multiplyScalar(x.y).addScaledVector(A,-E.y).multiplyScalar(te),w.copy(A).multiplyScalar(E.x).addScaledVector(m,-x.x).multiplyScalar(te),h[N].add(v),h[X].add(v),h[$].add(v),p[N].add(w),p[X].add(w),p[$].add(w))}let T=this.groups;T.length===0&&(T=[{start:0,count:i.length}]);for(let N=0,X=T.length;N<X;++N){let $=T[N],te=$.start,U=$.count;for(let P=te,k=te+U;P<k;P+=3)M(i[P+0],i[P+1],i[P+2])}let D=new Lt,L=new Lt,I=new Lt,F=new Lt;function R(N){I.fromArray(o,N*3),F.copy(I);let X=h[N];D.copy(X),D.sub(I.multiplyScalar(I.dot(X))).normalize(),L.crossVectors(F,X);let te=L.dot(p[N])<0?-1:1;u[N*4]=D.x,u[N*4+1]=D.y,u[N*4+2]=D.z,u[N*4+3]=te}for(let N=0,X=T.length;N<X;++N){let $=T[N],te=$.start,U=$.count;for(let P=te,k=te+U;P<k;P+=3)R(i[P+0]),R(i[P+1]),R(i[P+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Bo(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,A=i.count;m<A;m++)i.setXYZ(m,0,0,0);let s=new Lt,o=new Lt,c=new Lt,l=new Lt,u=new Lt,h=new Lt,p=new Lt,f=new Lt;if(e)for(let m=0,A=e.count;m<A;m+=3){let y=e.getX(m+0),E=e.getX(m+1),x=e.getX(m+2);s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,E),c.fromBufferAttribute(t,x),p.subVectors(c,o),f.subVectors(s,o),p.cross(f),l.fromBufferAttribute(i,y),u.fromBufferAttribute(i,E),h.fromBufferAttribute(i,x),l.add(p),u.add(p),h.add(p),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(E,u.x,u.y,u.z),i.setXYZ(x,h.x,h.y,h.z)}else for(let m=0,A=t.count;m<A;m+=3)s.fromBufferAttribute(t,m+0),o.fromBufferAttribute(t,m+1),c.fromBufferAttribute(t,m+2),p.subVectors(c,o),f.subVectors(s,o),p.cross(f),i.setXYZ(m+0,p.x,p.y,p.z),i.setXYZ(m+1,p.x,p.y,p.z),i.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Qs.fromBufferAttribute(e,t),Qs.normalize(),e.setXYZ(t,Qs.x,Qs.y,Qs.z)}toNonIndexed(){function e(l,u){let h=l.array,p=l.itemSize,f=l.normalized,m=new h.constructor(u.length*p),A=0,y=0;for(let E=0,x=u.length;E<x;E++){l.isInterleavedBufferAttribute?A=u[E]*l.data.stride+l.offset:A=u[E]*p;for(let v=0;v<p;v++)m[y++]=h[A++]}return new Bo(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new n,i=this.index.array,s=this.attributes;for(let l in s){let u=s[l],h=e(u,i);t.setAttribute(l,h)}let o=this.morphAttributes;for(let l in o){let u=[],h=o[l];for(let p=0,f=h.length;p<f;p++){let m=h[p],A=e(m,i);u.push(A)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;let c=this.groups;for(let l=0,u=c.length;l<u;l++){let h=c[l];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let u=this.parameters;for(let h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let u in i){let h=i[u];e.data.attributes[u]=h.toJSON(e.data)}let s={},o=!1;for(let u in this.morphAttributes){let h=this.morphAttributes[u],p=[];for(let f=0,m=h.length;f<m;f++){let A=h[f];p.push(A.toJSON(e.data))}p.length>0&&(s[u]=p,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);let c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));let l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let s=e.attributes;for(let h in s){let p=s[h];this.setAttribute(h,p.clone(t))}let o=e.morphAttributes;for(let h in o){let p=[],f=o[h];for(let m=0,A=f.length;m<A;m++)p.push(f[m].clone(t));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;let c=e.groups;for(let h=0,p=c.length;h<p;h++){let f=c[h];this.addGroup(f.start,f.count,f.materialIndex)}let l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},eU=new oo,Hh=new iE,Px=new Cp,tU=new Lt,hp=new Lt,dp=new Lt,fp=new Lt,xS=new Lt,Bx=new Lt,Ox=new zr,Nx=new zr,Fx=new zr,nU=new Lt,iU=new Lt,rU=new Lt,Ux=new Lt,kx=new Lt,yo=class extends Sl{constructor(e=new ka,t=new Ic){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,c=s.length;o<c;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,t){let i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,c=i.morphTargetsRelative;t.fromBufferAttribute(s,e);let l=this.morphTargetInfluences;if(o&&l){Bx.set(0,0,0);for(let u=0,h=o.length;u<h;u++){let p=l[u],f=o[u];p!==0&&(xS.fromBufferAttribute(f,e),c?Bx.addScaledVector(xS,p):Bx.addScaledVector(xS.sub(t),p))}t.add(Bx)}return t}raycast(e,t){let i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Px.copy(i.boundingSphere),Px.applyMatrix4(o),Hh.copy(e.ray).recast(e.near),!(Px.containsPoint(Hh.origin)===!1&&(Hh.intersectSphere(Px,tU)===null||Hh.origin.distanceToSquared(tU)>(e.far-e.near)**2))&&(eU.copy(o).invert(),Hh.copy(e.ray).applyMatrix4(eU),!(i.boundingBox!==null&&Hh.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Hh)))}_computeIntersections(e,t,i){let s,o=this.geometry,c=this.material,l=o.index,u=o.attributes.position,h=o.attributes.uv,p=o.attributes.uv1,f=o.attributes.normal,m=o.groups,A=o.drawRange;if(l!==null)if(Array.isArray(c))for(let y=0,E=m.length;y<E;y++){let x=m[y],v=c[x.materialIndex],w=Math.max(x.start,A.start),M=Math.min(l.count,Math.min(x.start+x.count,A.start+A.count));for(let T=w,D=M;T<D;T+=3){let L=l.getX(T),I=l.getX(T+1),F=l.getX(T+2);s=Vx(this,v,e,i,h,p,f,L,I,F),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=x.materialIndex,t.push(s))}}else{let y=Math.max(0,A.start),E=Math.min(l.count,A.start+A.count);for(let x=y,v=E;x<v;x+=3){let w=l.getX(x),M=l.getX(x+1),T=l.getX(x+2);s=Vx(this,c,e,i,h,p,f,w,M,T),s&&(s.faceIndex=Math.floor(x/3),t.push(s))}}else if(u!==void 0)if(Array.isArray(c))for(let y=0,E=m.length;y<E;y++){let x=m[y],v=c[x.materialIndex],w=Math.max(x.start,A.start),M=Math.min(u.count,Math.min(x.start+x.count,A.start+A.count));for(let T=w,D=M;T<D;T+=3){let L=T,I=T+1,F=T+2;s=Vx(this,v,e,i,h,p,f,L,I,F),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=x.materialIndex,t.push(s))}}else{let y=Math.max(0,A.start),E=Math.min(u.count,A.start+A.count);for(let x=y,v=E;x<v;x+=3){let w=x,M=x+1,T=x+2;s=Vx(this,c,e,i,h,p,f,w,M,T),s&&(s.faceIndex=Math.floor(x/3),t.push(s))}}}};wl=class n extends ka{constructor(e=1,t=1,i=1,s=1,o=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:o,depthSegments:c};let l=this;s=Math.floor(s),o=Math.floor(o),c=Math.floor(c);let u=[],h=[],p=[],f=[],m=0,A=0;y("z","y","x",-1,-1,i,t,e,c,o,0),y("z","y","x",1,-1,i,t,-e,c,o,1),y("x","z","y",1,1,e,i,t,s,c,2),y("x","z","y",1,-1,e,i,-t,s,c,3),y("x","y","z",1,-1,e,t,i,s,o,4),y("x","y","z",-1,-1,e,t,-i,s,o,5),this.setIndex(u),this.setAttribute("position",new fa(h,3)),this.setAttribute("normal",new fa(p,3)),this.setAttribute("uv",new fa(f,2));function y(E,x,v,w,M,T,D,L,I,F,R){let N=T/I,X=D/F,$=T/2,te=D/2,U=L/2,P=I+1,k=F+1,z=0,Q=0,Z=new Lt;for(let ce=0;ce<k;ce++){let Me=ce*X-te;for(let xe=0;xe<P;xe++){let be=xe*N-$;Z[E]=be*w,Z[x]=Me*M,Z[v]=U,h.push(Z.x,Z.y,Z.z),Z[E]=0,Z[x]=0,Z[v]=L>0?1:-1,p.push(Z.x,Z.y,Z.z),f.push(xe/I),f.push(1-ce/F),z+=1}}for(let ce=0;ce<F;ce++)for(let Me=0;Me<I;Me++){let xe=m+Me+P*ce,be=m+Me+P*(ce+1),Fe=m+(Me+1)+P*(ce+1),Ze=m+(Me+1)+P*ce;u.push(xe,be,Ze),u.push(be,Fe,Ze),Q+=6}l.addGroup(A,Q,R),A+=Q,m+=z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};Ite={clone:Sp,merge:Lo},Rte=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Dte=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Cl=class extends Kh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Rte,this.fragmentShader=Dte,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sp(e.uniforms),this.uniformsGroups=Tte(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let s in this.uniforms){let c=this.uniforms[s].value;c&&c.isTexture?t.uniforms[s]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?t.uniforms[s]={type:"c",value:c.getHex()}:c&&c.isVector2?t.uniforms[s]={type:"v2",value:c.toArray()}:c&&c.isVector3?t.uniforms[s]={type:"v3",value:c.toArray()}:c&&c.isVector4?t.uniforms[s]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?t.uniforms[s]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?t.uniforms[s]={type:"m4",value:c.toArray()}:t.uniforms[s]={value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},aE=class extends Sl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new oo,this.projectionMatrix=new oo,this.projectionMatrixInverse=new oo,this.coordinateSystem=_l}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},da=class extends aE{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=OS*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(iS*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return OS*2*Math.atan(Math.tan(iS*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,s,o,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(iS*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,o=-.5*s,c=this.view;if(this.view!==null&&this.view.enabled){let u=c.fullWidth,h=c.fullHeight;o+=c.offsetX*s/u,t-=c.offsetY*i/h,s*=c.width/u,i*=c.height/h}let l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},pp=-90,mp=1,kS=class extends Sl{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let s=new da(pp,mp,e,t);s.layers=this.layers,this.add(s);let o=new da(pp,mp,e,t);o.layers=this.layers,this.add(o);let c=new da(pp,mp,e,t);c.layers=this.layers,this.add(c);let l=new da(pp,mp,e,t);l.layers=this.layers,this.add(l);let u=new da(pp,mp,e,t);u.layers=this.layers,this.add(u);let h=new da(pp,mp,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,s,o,c,l,u]=t;for(let h of t)this.remove(h);if(e===_l)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===Jx)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[o,c,l,u,h,p]=this.children,f=e.getRenderTarget(),m=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;let E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,o),e.setRenderTarget(i,1,s),e.render(t,c),e.setRenderTarget(i,2,s),e.render(t,l),e.setRenderTarget(i,3,s),e.render(t,u),e.setRenderTarget(i,4,s),e.render(t,h),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,s),e.render(t,p),e.setRenderTarget(f,m,A),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}},cE=class extends Ip{constructor(e,t,i,s,o,c,l,u,h,p){e=e!==void 0?e:[],t=t!==void 0?t:bp,super(e,t,i,s,o,c,l,u,h,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},VS=class extends Ml{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];t.encoding!==void 0&&(Vg("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===qh?ro:Ua),this.texture=new cE(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Na}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new wl(5,5,5),o=new Cl({name:"CubemapFromEquirect",uniforms:Sp(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Xo,blending:wu});o.uniforms.tEquirect.value=t;let c=new yo(s,o),l=t.minFilter;return t.minFilter===zg&&(t.minFilter=Na),new kS(1,10,this).update(e,c),t.minFilter=l,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,i,s){let o=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,i,s);e.setRenderTarget(o)}},ES=new Lt,Lte=new Lt,Pte=new ar,Fa=class{constructor(e=new Lt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let s=ES.subVectors(i,t).cross(Lte.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta(ES),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||Pte.getNormalMatrix(e),s=this.coplanarPoint(ES).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},zh=new Cp,Hx=new Lt,lE=class{constructor(e=new Fa,t=new Fa,i=new Fa,s=new Fa,o=new Fa,c=new Fa){this.planes=[e,t,i,s,o,c]}set(e,t,i,s,o,c){let l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(c),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=_l){let i=this.planes,s=e.elements,o=s[0],c=s[1],l=s[2],u=s[3],h=s[4],p=s[5],f=s[6],m=s[7],A=s[8],y=s[9],E=s[10],x=s[11],v=s[12],w=s[13],M=s[14],T=s[15];if(i[0].setComponents(u-o,m-h,x-A,T-v).normalize(),i[1].setComponents(u+o,m+h,x+A,T+v).normalize(),i[2].setComponents(u+c,m+p,x+y,T+w).normalize(),i[3].setComponents(u-c,m-p,x-y,T-w).normalize(),i[4].setComponents(u-l,m-f,x-E,T-M).normalize(),t===_l)i[5].setComponents(u+l,m+f,x+E,T+M).normalize();else if(t===Jx)i[5].setComponents(l,f,E,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),zh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),zh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(zh)}intersectsSprite(e){return zh.center.set(0,0,0),zh.radius=.7071067811865476,zh.applyMatrix4(e.matrixWorld),this.intersectsSphere(zh)}intersectsSphere(e){let t=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let s=t[i];if(Hx.x=s.normal.x>0?e.max.x:e.min.x,Hx.y=s.normal.y>0?e.max.y:e.min.y,Hx.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Hx)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};HS=class n extends ka{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};let o=e/2,c=t/2,l=Math.floor(i),u=Math.floor(s),h=l+1,p=u+1,f=e/l,m=t/u,A=[],y=[],E=[],x=[];for(let v=0;v<p;v++){let w=v*m-c;for(let M=0;M<h;M++){let T=M*f-o;y.push(T,-w,0),E.push(0,0,1),x.push(M/l),x.push(1-v/u)}}for(let v=0;v<u;v++)for(let w=0;w<l;w++){let M=w+h*v,T=w+h*(v+1),D=w+1+h*(v+1),L=w+1+h*v;A.push(M,T,L),A.push(T,D,L)}this.setIndex(A),this.setAttribute("position",new fa(y,3)),this.setAttribute("normal",new fa(E,3)),this.setAttribute("uv",new fa(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}},Ote=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Nte=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Fte=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Ute=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,kte=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Vte=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Hte=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,zte=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Gte=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Wte=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,jte=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Qte=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Xte=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,qte=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Yte=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Kte=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,$te=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Jte=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Zte=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ene=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,tne=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,nne=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ine=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,rne=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,sne=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,one=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,ane=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,cne=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,lne=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,une=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,hne="gl_FragColor = linearToOutputTexel( gl_FragColor );",dne=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,fne=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,pne=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,mne=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,gne=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Ane=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vne=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,yne=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,xne=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Ene=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,_ne=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,bne=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Mne=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,wne=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Cne=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Sne=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Tne=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Ine=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Rne=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Dne=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Lne=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Pne=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Bne=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,One=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Nne=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Fne=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Une=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,kne=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Vne=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Hne=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,zne=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Gne=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Wne=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,jne=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Qne=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Xne=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,qne=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Yne=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Kne=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,$ne=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Jne=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Zne=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,eie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,tie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,nie=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,iie=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,rie=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,sie=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,oie=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,aie=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,cie=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,lie=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,uie=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,hie=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,die=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,fie=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,pie=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,mie=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,gie=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Aie=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,vie=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,yie=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,xie=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Eie=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,_ie=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,bie=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Mie=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wie=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Cie=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Sie=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Tie=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Iie=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Rie=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Die=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Lie=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Pie=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Bie=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Oie=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nie=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Fie=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Uie=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,kie=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Vie=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Hie=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,zie=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Gie=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Wie=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,jie=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Qie=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xie=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qie=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Yie=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kie=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$ie=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jie=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Zie=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ere=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,tre=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,nre=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ire=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rre=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,sre=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ore=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,are=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cre=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,lre=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ure=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hre=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,dre=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fre=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ji={alphahash_fragment:Ote,alphahash_pars_fragment:Nte,alphamap_fragment:Fte,alphamap_pars_fragment:Ute,alphatest_fragment:kte,alphatest_pars_fragment:Vte,aomap_fragment:Hte,aomap_pars_fragment:zte,batching_pars_vertex:Gte,batching_vertex:Wte,begin_vertex:jte,beginnormal_vertex:Qte,bsdfs:Xte,iridescence_fragment:qte,bumpmap_pars_fragment:Yte,clipping_planes_fragment:Kte,clipping_planes_pars_fragment:$te,clipping_planes_pars_vertex:Jte,clipping_planes_vertex:Zte,color_fragment:ene,color_pars_fragment:tne,color_pars_vertex:nne,color_vertex:ine,common:rne,cube_uv_reflection_fragment:sne,defaultnormal_vertex:one,displacementmap_pars_vertex:ane,displacementmap_vertex:cne,emissivemap_fragment:lne,emissivemap_pars_fragment:une,colorspace_fragment:hne,colorspace_pars_fragment:dne,envmap_fragment:fne,envmap_common_pars_fragment:pne,envmap_pars_fragment:mne,envmap_pars_vertex:gne,envmap_physical_pars_fragment:Tne,envmap_vertex:Ane,fog_vertex:vne,fog_pars_vertex:yne,fog_fragment:xne,fog_pars_fragment:Ene,gradientmap_pars_fragment:_ne,lightmap_fragment:bne,lightmap_pars_fragment:Mne,lights_lambert_fragment:wne,lights_lambert_pars_fragment:Cne,lights_pars_begin:Sne,lights_toon_fragment:Ine,lights_toon_pars_fragment:Rne,lights_phong_fragment:Dne,lights_phong_pars_fragment:Lne,lights_physical_fragment:Pne,lights_physical_pars_fragment:Bne,lights_fragment_begin:One,lights_fragment_maps:Nne,lights_fragment_end:Fne,logdepthbuf_fragment:Une,logdepthbuf_pars_fragment:kne,logdepthbuf_pars_vertex:Vne,logdepthbuf_vertex:Hne,map_fragment:zne,map_pars_fragment:Gne,map_particle_fragment:Wne,map_particle_pars_fragment:jne,metalnessmap_fragment:Qne,metalnessmap_pars_fragment:Xne,morphcolor_vertex:qne,morphnormal_vertex:Yne,morphtarget_pars_vertex:Kne,morphtarget_vertex:$ne,normal_fragment_begin:Jne,normal_fragment_maps:Zne,normal_pars_fragment:eie,normal_pars_vertex:tie,normal_vertex:nie,normalmap_pars_fragment:iie,clearcoat_normal_fragment_begin:rie,clearcoat_normal_fragment_maps:sie,clearcoat_pars_fragment:oie,iridescence_pars_fragment:aie,opaque_fragment:cie,packing:lie,premultiplied_alpha_fragment:uie,project_vertex:hie,dithering_fragment:die,dithering_pars_fragment:fie,roughnessmap_fragment:pie,roughnessmap_pars_fragment:mie,shadowmap_pars_fragment:gie,shadowmap_pars_vertex:Aie,shadowmap_vertex:vie,shadowmask_pars_fragment:yie,skinbase_vertex:xie,skinning_pars_vertex:Eie,skinning_vertex:_ie,skinnormal_vertex:bie,specularmap_fragment:Mie,specularmap_pars_fragment:wie,tonemapping_fragment:Cie,tonemapping_pars_fragment:Sie,transmission_fragment:Tie,transmission_pars_fragment:Iie,uv_pars_fragment:Rie,uv_pars_vertex:Die,uv_vertex:Lie,worldpos_vertex:Pie,background_vert:Bie,background_frag:Oie,backgroundCube_vert:Nie,backgroundCube_frag:Fie,cube_vert:Uie,cube_frag:kie,depth_vert:Vie,depth_frag:Hie,distanceRGBA_vert:zie,distanceRGBA_frag:Gie,equirect_vert:Wie,equirect_frag:jie,linedashed_vert:Qie,linedashed_frag:Xie,meshbasic_vert:qie,meshbasic_frag:Yie,meshlambert_vert:Kie,meshlambert_frag:$ie,meshmatcap_vert:Jie,meshmatcap_frag:Zie,meshnormal_vert:ere,meshnormal_frag:tre,meshphong_vert:nre,meshphong_frag:ire,meshphysical_vert:rre,meshphysical_frag:sre,meshtoon_vert:ore,meshtoon_frag:are,points_vert:cre,points_frag:lre,shadow_vert:ure,shadow_frag:hre,sprite_vert:dre,sprite_frag:fre},Bn={common:{diffuse:{value:new cr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ar},alphaMap:{value:null},alphaMapTransform:{value:new ar},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ar}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ar}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ar}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ar},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ar},normalScale:{value:new zr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ar},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ar}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ar}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ar}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new cr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new cr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ar},alphaTest:{value:0},uvTransform:{value:new ar}},sprite:{diffuse:{value:new cr(16777215)},opacity:{value:1},center:{value:new zr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ar},alphaMap:{value:null},alphaMapTransform:{value:new ar},alphaTest:{value:0}}},Tc={basic:{uniforms:Lo([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.fog]),vertexShader:Ji.meshbasic_vert,fragmentShader:Ji.meshbasic_frag},lambert:{uniforms:Lo([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,Bn.lights,{emissive:{value:new cr(0)}}]),vertexShader:Ji.meshlambert_vert,fragmentShader:Ji.meshlambert_frag},phong:{uniforms:Lo([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,Bn.lights,{emissive:{value:new cr(0)},specular:{value:new cr(1118481)},shininess:{value:30}}]),vertexShader:Ji.meshphong_vert,fragmentShader:Ji.meshphong_frag},standard:{uniforms:Lo([Bn.common,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.roughnessmap,Bn.metalnessmap,Bn.fog,Bn.lights,{emissive:{value:new cr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ji.meshphysical_vert,fragmentShader:Ji.meshphysical_frag},toon:{uniforms:Lo([Bn.common,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.gradientmap,Bn.fog,Bn.lights,{emissive:{value:new cr(0)}}]),vertexShader:Ji.meshtoon_vert,fragmentShader:Ji.meshtoon_frag},matcap:{uniforms:Lo([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,{matcap:{value:null}}]),vertexShader:Ji.meshmatcap_vert,fragmentShader:Ji.meshmatcap_frag},points:{uniforms:Lo([Bn.points,Bn.fog]),vertexShader:Ji.points_vert,fragmentShader:Ji.points_frag},dashed:{uniforms:Lo([Bn.common,Bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ji.linedashed_vert,fragmentShader:Ji.linedashed_frag},depth:{uniforms:Lo([Bn.common,Bn.displacementmap]),vertexShader:Ji.depth_vert,fragmentShader:Ji.depth_frag},normal:{uniforms:Lo([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,{opacity:{value:1}}]),vertexShader:Ji.meshnormal_vert,fragmentShader:Ji.meshnormal_frag},sprite:{uniforms:Lo([Bn.sprite,Bn.fog]),vertexShader:Ji.sprite_vert,fragmentShader:Ji.sprite_frag},background:{uniforms:{uvTransform:{value:new ar},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ji.background_vert,fragmentShader:Ji.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ji.backgroundCube_vert,fragmentShader:Ji.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ji.cube_vert,fragmentShader:Ji.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ji.equirect_vert,fragmentShader:Ji.equirect_frag},distanceRGBA:{uniforms:Lo([Bn.common,Bn.displacementmap,{referencePosition:{value:new Lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ji.distanceRGBA_vert,fragmentShader:Ji.distanceRGBA_frag},shadow:{uniforms:Lo([Bn.lights,Bn.fog,{color:{value:new cr(0)},opacity:{value:1}}]),vertexShader:Ji.shadow_vert,fragmentShader:Ji.shadow_frag}};Tc.physical={uniforms:Lo([Tc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ar},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ar},clearcoatNormalScale:{value:new zr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ar},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ar},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ar},sheen:{value:0},sheenColor:{value:new cr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ar},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ar},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ar},transmissionSamplerSize:{value:new zr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ar},attenuationDistance:{value:0},attenuationColor:{value:new cr(0)},specularColor:{value:new cr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ar},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ar},anisotropyVector:{value:new zr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ar}}]),vertexShader:Ji.meshphysical_vert,fragmentShader:Ji.meshphysical_frag};zx={r:0,b:0,g:0};zS=class extends aE{constructor(e=-1,t=1,i=1,s=-1,o=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=o,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,o,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,o=i-e,c=i+e,l=s+t,u=s-t;if(this.view!==null&&this.view.enabled){let h=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,c=o+h*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(o,c,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Ap=4,sU=[.125,.215,.35,.446,.526,.582],jh=20,_S=new zS,oU=new cr,bS=null,MS=0,wS=0,Gh=(1+Math.sqrt(5))/2,gp=1/Gh,aU=[new Lt(1,1,1),new Lt(-1,1,1),new Lt(1,1,-1),new Lt(-1,1,-1),new Lt(0,Gh,gp),new Lt(0,Gh,-gp),new Lt(gp,0,Gh),new Lt(-gp,0,Gh),new Lt(Gh,gp,0),new Lt(-Gh,gp,0)],uE=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100){bS=this._renderer.getRenderTarget(),MS=this._renderer.getActiveCubeFace(),wS=this._renderer.getActiveMipmapLevel(),this._setSize(256);let o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,s,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=uU(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=lU(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(bS,MS,wS),e.scissorTest=!1,Gx(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===bp||e.mapping===Mp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),bS=this._renderer.getRenderTarget(),MS=this._renderer.getActiveCubeFace(),wS=this._renderer.getActiveMipmapLevel();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Na,minFilter:Na,generateMipmaps:!1,type:Gg,format:oc,colorSpace:bl,depthBuffer:!1},s=cU(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=cU(e,t,i);let{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=xre(o)),this._blurMaterial=Ere(o,e,t)}return s}_compileMaterial(e){let t=new yo(this._lodPlanes[0],e);this._renderer.compile(t,_S)}_sceneToCubeUV(e,t,i,s){let l=new da(90,1,t,i),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],p=this._renderer,f=p.autoClear,m=p.toneMapping;p.getClearColor(oU),p.toneMapping=Cu,p.autoClear=!1;let A=new Ic({name:"PMREM.Background",side:Xo,depthWrite:!1,depthTest:!1}),y=new yo(new wl,A),E=!1,x=e.background;x?x.isColor&&(A.color.copy(x),e.background=null,E=!0):(A.color.copy(oU),E=!0);for(let v=0;v<6;v++){let w=v%3;w===0?(l.up.set(0,u[v],0),l.lookAt(h[v],0,0)):w===1?(l.up.set(0,0,u[v]),l.lookAt(0,h[v],0)):(l.up.set(0,u[v],0),l.lookAt(0,0,h[v]));let M=this._cubeSize;Gx(s,w*M,v>2?M:0,M,M),p.setRenderTarget(s),E&&p.render(y,l),p.render(e,l)}y.geometry.dispose(),y.material.dispose(),p.toneMapping=m,p.autoClear=f,e.background=x}_textureToCubeUV(e,t){let i=this._renderer,s=e.mapping===bp||e.mapping===Mp;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=uU()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=lU());let o=s?this._cubemapMaterial:this._equirectMaterial,c=new yo(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;let u=this._cubeSize;Gx(t,0,0,3*u,2*u),i.setRenderTarget(t),i.render(c,_S)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),c=aU[(s-1)%aU.length];this._blur(e,s-1,s,o,c)}t.autoClear=i}_blur(e,t,i,s,o){let c=this._pingPongRenderTarget;this._halfBlur(e,c,t,i,s,"latitudinal",o),this._halfBlur(c,e,i,i,s,"longitudinal",o)}_halfBlur(e,t,i,s,o,c,l){let u=this._renderer,h=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let p=3,f=new yo(this._lodPlanes[s],h),m=h.uniforms,A=this._sizeLods[i]-1,y=isFinite(o)?Math.PI/(2*A):2*Math.PI/(2*jh-1),E=o/y,x=isFinite(o)?1+Math.floor(p*E):jh;x>jh&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${jh}`);let v=[],w=0;for(let I=0;I<jh;++I){let F=I/E,R=Math.exp(-F*F/2);v.push(R),I===0?w+=R:I<x&&(w+=2*R)}for(let I=0;I<v.length;I++)v[I]=v[I]/w;m.envMap.value=e.texture,m.samples.value=x,m.weights.value=v,m.latitudinal.value=c==="latitudinal",l&&(m.poleAxis.value=l);let{_lodMax:M}=this;m.dTheta.value=y,m.mipInt.value=M-i;let T=this._sizeLods[s],D=3*T*(s>M-Ap?s-M+Ap:0),L=4*(this._cubeSize-T);Gx(t,D,L,3*T,2*T),u.setRenderTarget(t),u.render(f,_S)}};hE=class extends Ip{constructor(e,t,i,s,o,c,l,u,h,p){if(p=p!==void 0?p:Xh,p!==Xh&&p!==wp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===Xh&&(i=_u),i===void 0&&p===wp&&(i=Qh),super(null,s,o,c,l,u,p,i,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:Po,this.minFilter=u!==void 0?u:Po,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},WU=new Ip,jU=new hE(1,1);jU.compareFunction=kU;QU=new nE,XU=new US,qU=new cE,hU=[],dU=[],fU=new Float32Array(16),pU=new Float32Array(9),mU=new Float32Array(4);GS=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=Kre(t.type)}},WS=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=gse(t.type)}},jS=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let s=this.seq;for(let o=0,c=s.length;o!==c;++o){let l=s[o];l.setValue(e,t[l.id],i)}}},CS=/(\w+)(\])?(\[|\.)?/g;_p=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){let o=e.getActiveUniform(t,s),c=e.getUniformLocation(t,o.name);Ase(o,c,this)}}setValue(e,t,i,s){let o=this.map[t];o!==void 0&&o.setValue(e,i,s)}setOptional(e,t,i){let s=t[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let o=0,c=t.length;o!==c;++o){let l=t[o],u=i[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,s)}}static seqWithValue(e,t){let i=[];for(let s=0,o=e.length;s!==o;++s){let c=e[s];c.id in t&&i.push(c)}return i}};vse=37297,yse=0;Tse=/^[ \t]*#include +<([\w\d./]+)>/gm;Ise=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);Dse=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;kse=0,XS=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(t),o=this._getShaderStage(i),c=this._getShaderCacheForMaterial(e);return c.has(s)===!1&&(c.add(s),s.usedTimes++),c.has(o)===!1&&(c.add(o),o.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new qS(e),t.set(e,i)),i}},qS=class{constructor(e){this.id=kse++,this.code=e,this.usedTimes=0}};Qse=0;YS=class extends Kh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ete,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},KS=class extends Kh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Kse=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$se=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;$S=class extends da{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},yp=class extends Sl{constructor(){super(),this.isGroup=!0,this.type="Group"}},noe={type:"move"},Hg=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new yp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new yp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Lt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Lt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new yp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Lt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Lt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let s=null,o=null,c=null,l=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){c=!0;for(let E of e.hand.values()){let x=t.getJointPose(E,i),v=this._getHandJoint(h,E);x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=x.radius),v.visible=x!==null}let p=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],m=p.position.distanceTo(f.position),A=.02,y=.005;h.inputState.pinching&&m>A+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=A-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(s=t.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(noe)))}return l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),h!==null&&(h.visible=c!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new yp;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},JS=class extends Iu{constructor(e,t){super();let i=this,s=null,o=1,c=null,l="local-floor",u=1,h=null,p=null,f=null,m=null,A=null,y=null,E=t.getContextAttributes(),x=null,v=null,w=[],M=[],T=new zr,D=null,L=new da;L.layers.enable(1),L.viewport=new so;let I=new da;I.layers.enable(2),I.viewport=new so;let F=[L,I],R=new $S;R.layers.enable(1),R.layers.enable(2);let N=null,X=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new Hg,w[be]=Fe),Fe.getTargetRaySpace()},this.getControllerGrip=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new Hg,w[be]=Fe),Fe.getGripSpace()},this.getHand=function(be){let Fe=w[be];return Fe===void 0&&(Fe=new Hg,w[be]=Fe),Fe.getHandSpace()};function $(be){let Fe=M.indexOf(be.inputSource);if(Fe===-1)return;let Ze=w[Fe];Ze!==void 0&&(Ze.update(be.inputSource,be.frame,h||c),Ze.dispatchEvent({type:be.type,data:be.inputSource}))}function te(){s.removeEventListener("select",$),s.removeEventListener("selectstart",$),s.removeEventListener("selectend",$),s.removeEventListener("squeeze",$),s.removeEventListener("squeezestart",$),s.removeEventListener("squeezeend",$),s.removeEventListener("end",te),s.removeEventListener("inputsourceschange",U);for(let be=0;be<w.length;be++){let Fe=M[be];Fe!==null&&(M[be]=null,w[be].disconnect(Fe))}N=null,X=null,e.setRenderTarget(x),A=null,m=null,f=null,s=null,v=null,xe.stop(),i.isPresenting=!1,e.setPixelRatio(D),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(be){o=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(be){l=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||c},this.setReferenceSpace=function(be){h=be},this.getBaseLayer=function(){return m!==null?m:A},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return s},this.setSession=function(be){return So(this,null,function*(){if(s=be,s!==null){if(x=e.getRenderTarget(),s.addEventListener("select",$),s.addEventListener("selectstart",$),s.addEventListener("selectend",$),s.addEventListener("squeeze",$),s.addEventListener("squeezestart",$),s.addEventListener("squeezeend",$),s.addEventListener("end",te),s.addEventListener("inputsourceschange",U),E.xrCompatible!==!0&&(yield t.makeXRCompatible()),D=e.getPixelRatio(),e.getSize(T),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let Fe={antialias:s.renderState.layers===void 0?E.antialias:!0,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:o};A=new XRWebGLLayer(s,t,Fe),s.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),v=new Ml(A.framebufferWidth,A.framebufferHeight,{format:oc,type:Su,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil})}else{let Fe=null,Ze=null,ut=null;E.depth&&(ut=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Fe=E.stencil?wp:Xh,Ze=E.stencil?Qh:_u);let it={colorFormat:t.RGBA8,depthFormat:ut,scaleFactor:o};f=new XRWebGLBinding(s,t),m=f.createProjectionLayer(it),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),v=new Ml(m.textureWidth,m.textureHeight,{format:oc,type:Su,depthTexture:new hE(m.textureWidth,m.textureHeight,Ze,void 0,void 0,void 0,void 0,void 0,void 0,Fe),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0});let gt=e.properties.get(v);gt.__ignoreDepthValues=m.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(u),h=null,c=yield s.requestReferenceSpace(l),xe.setContext(s),xe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function U(be){for(let Fe=0;Fe<be.removed.length;Fe++){let Ze=be.removed[Fe],ut=M.indexOf(Ze);ut>=0&&(M[ut]=null,w[ut].disconnect(Ze))}for(let Fe=0;Fe<be.added.length;Fe++){let Ze=be.added[Fe],ut=M.indexOf(Ze);if(ut===-1){for(let gt=0;gt<w.length;gt++)if(gt>=M.length){M.push(Ze),ut=gt;break}else if(M[gt]===null){M[gt]=Ze,ut=gt;break}if(ut===-1)break}let it=w[ut];it&&it.connect(Ze)}}let P=new Lt,k=new Lt;function z(be,Fe,Ze){P.setFromMatrixPosition(Fe.matrixWorld),k.setFromMatrixPosition(Ze.matrixWorld);let ut=P.distanceTo(k),it=Fe.projectionMatrix.elements,gt=Ze.projectionMatrix.elements,Rt=it[14]/(it[10]-1),It=it[14]/(it[10]+1),Ft=(it[9]+1)/it[5],Ne=(it[9]-1)/it[5],pn=(it[8]-1)/it[0],St=(gt[8]+1)/gt[0],Vt=Rt*pn,Ot=Rt*St,xn=ut/(-pn+St),Jt=xn*-pn;Fe.matrixWorld.decompose(be.position,be.quaternion,be.scale),be.translateX(Jt),be.translateZ(xn),be.matrixWorld.compose(be.position,be.quaternion,be.scale),be.matrixWorldInverse.copy(be.matrixWorld).invert();let Oe=Rt+xn,Ie=It+xn,yt=Vt-Jt,kt=Ot+(ut-Jt),De=Ft*It/Ie*Oe,he=Ne*It/Ie*Oe;be.projectionMatrix.makePerspective(yt,kt,De,he,Oe,Ie),be.projectionMatrixInverse.copy(be.projectionMatrix).invert()}function Q(be,Fe){Fe===null?be.matrixWorld.copy(be.matrix):be.matrixWorld.multiplyMatrices(Fe.matrixWorld,be.matrix),be.matrixWorldInverse.copy(be.matrixWorld).invert()}this.updateCamera=function(be){if(s===null)return;R.near=I.near=L.near=be.near,R.far=I.far=L.far=be.far,(N!==R.near||X!==R.far)&&(s.updateRenderState({depthNear:R.near,depthFar:R.far}),N=R.near,X=R.far);let Fe=be.parent,Ze=R.cameras;Q(R,Fe);for(let ut=0;ut<Ze.length;ut++)Q(Ze[ut],Fe);Ze.length===2?z(R,L,I):R.projectionMatrix.copy(L.projectionMatrix),Z(be,R,Fe)};function Z(be,Fe,Ze){Ze===null?be.matrix.copy(Fe.matrixWorld):(be.matrix.copy(Ze.matrixWorld),be.matrix.invert(),be.matrix.multiply(Fe.matrixWorld)),be.matrix.decompose(be.position,be.quaternion,be.scale),be.updateMatrixWorld(!0),be.projectionMatrix.copy(Fe.projectionMatrix),be.projectionMatrixInverse.copy(Fe.projectionMatrixInverse),be.isPerspectiveCamera&&(be.fov=OS*2*Math.atan(1/be.projectionMatrix.elements[5]),be.zoom=1)}this.getCamera=function(){return R},this.getFoveation=function(){if(!(m===null&&A===null))return u},this.setFoveation=function(be){u=be,m!==null&&(m.fixedFoveation=be),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=be)};let ce=null;function Me(be,Fe){if(p=Fe.getViewerPose(h||c),y=Fe,p!==null){let Ze=p.views;A!==null&&(e.setRenderTargetFramebuffer(v,A.framebuffer),e.setRenderTarget(v));let ut=!1;Ze.length!==R.cameras.length&&(R.cameras.length=0,ut=!0);for(let it=0;it<Ze.length;it++){let gt=Ze[it],Rt=null;if(A!==null)Rt=A.getViewport(gt);else{let Ft=f.getViewSubImage(m,gt);Rt=Ft.viewport,it===0&&(e.setRenderTargetTextures(v,Ft.colorTexture,m.ignoreDepthValues?void 0:Ft.depthStencilTexture),e.setRenderTarget(v))}let It=F[it];It===void 0&&(It=new da,It.layers.enable(it),It.viewport=new so,F[it]=It),It.matrix.fromArray(gt.transform.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale),It.projectionMatrix.fromArray(gt.projectionMatrix),It.projectionMatrixInverse.copy(It.projectionMatrix).invert(),It.viewport.set(Rt.x,Rt.y,Rt.width,Rt.height),it===0&&(R.matrix.copy(It.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),ut===!0&&R.cameras.push(It)}}for(let Ze=0;Ze<w.length;Ze++){let ut=M[Ze],it=w[Ze];ut!==null&&it!==void 0&&it.update(ut,Fe,h||c)}ce&&ce(be,Fe),Fe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Fe}),y=null}let xe=new GU;xe.setAnimationLoop(Me),this.setAnimationLoop=function(be){ce=be},this.dispose=function(){}}};ZS=class{constructor(e={}){let{canvas:t=dte(),context:i=null,depth:s=!0,stencil:o=!0,alpha:c=!1,antialias:l=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let m;i!==null?m=i.getContextAttributes().alpha:m=c;let A=new Uint32Array(4),y=new Int32Array(4),E=null,x=null,v=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ro,this._useLegacyLights=!1,this.toneMapping=Cu,this.toneMappingExposure=1;let M=this,T=!1,D=0,L=0,I=null,F=-1,R=null,N=new so,X=new so,$=null,te=new cr(0),U=0,P=t.width,k=t.height,z=1,Q=null,Z=null,ce=new so(0,0,P,k),Me=new so(0,0,P,k),xe=!1,be=new lE,Fe=!1,Ze=!1,ut=null,it=new oo,gt=new zr,Rt=new Lt,It={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ft(){return I===null?z:1}let Ne=i;function pn(ne,Y){for(let le=0;le<ne.length;le++){let me=ne[le],_e=t.getContext(me,Y);if(_e!==null)return _e}return null}try{let ne={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${l2}`),t.addEventListener("webglcontextlost",nt,!1),t.addEventListener("webglcontextrestored",ge,!1),t.addEventListener("webglcontextcreationerror",ot,!1),Ne===null){let Y=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&Y.shift(),Ne=pn(Y,ne),Ne===null)throw pn(Y)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ne instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Ne.getShaderPrecisionFormat===void 0&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}let St,Vt,Ot,xn,Jt,Oe,Ie,yt,kt,De,he,ae,de,we,Ae,Le,Ee,ze,Ge,ee,V,G,pe,Ue;function Qe(){St=new bre(Ne),Vt=new Are(Ne,St,e),St.init(Vt),G=new toe(Ne,St,Vt),Ot=new Zse(Ne,St,Vt),xn=new Cre(Ne),Jt=new Hse,Oe=new eoe(Ne,St,Ot,Jt,Vt,G,xn),Ie=new yre(M),yt=new _re(M),kt=new Bte(Ne,Vt),pe=new mre(Ne,St,kt,Vt),De=new Mre(Ne,kt,xn,pe),he=new Rre(Ne,De,kt,xn),Ge=new Ire(Ne,Vt,Oe),Le=new vre(Jt),ae=new Vse(M,Ie,yt,St,Vt,pe,Le),de=new ioe(M,Jt),we=new Gse,Ae=new Yse(St,Vt),ze=new pre(M,Ie,yt,Ot,he,m,u),Ee=new Jse(M,he,Vt),Ue=new roe(Ne,xn,Vt,Ot),ee=new gre(Ne,St,xn,Vt),V=new wre(Ne,St,xn,Vt),xn.programs=ae.programs,M.capabilities=Vt,M.extensions=St,M.properties=Jt,M.renderLists=we,M.shadowMap=Ee,M.state=Ot,M.info=xn}Qe();let $e=new JS(M,Ne);this.xr=$e,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){let ne=St.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){let ne=St.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(ne){ne!==void 0&&(z=ne,this.setSize(P,k,!1))},this.getSize=function(ne){return ne.set(P,k)},this.setSize=function(ne,Y,le=!0){if($e.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}P=ne,k=Y,t.width=Math.floor(ne*z),t.height=Math.floor(Y*z),le===!0&&(t.style.width=ne+"px",t.style.height=Y+"px"),this.setViewport(0,0,ne,Y)},this.getDrawingBufferSize=function(ne){return ne.set(P*z,k*z).floor()},this.setDrawingBufferSize=function(ne,Y,le){P=ne,k=Y,z=le,t.width=Math.floor(ne*le),t.height=Math.floor(Y*le),this.setViewport(0,0,ne,Y)},this.getCurrentViewport=function(ne){return ne.copy(N)},this.getViewport=function(ne){return ne.copy(ce)},this.setViewport=function(ne,Y,le,me){ne.isVector4?ce.set(ne.x,ne.y,ne.z,ne.w):ce.set(ne,Y,le,me),Ot.viewport(N.copy(ce).multiplyScalar(z).floor())},this.getScissor=function(ne){return ne.copy(Me)},this.setScissor=function(ne,Y,le,me){ne.isVector4?Me.set(ne.x,ne.y,ne.z,ne.w):Me.set(ne,Y,le,me),Ot.scissor(X.copy(Me).multiplyScalar(z).floor())},this.getScissorTest=function(){return xe},this.setScissorTest=function(ne){Ot.setScissorTest(xe=ne)},this.setOpaqueSort=function(ne){Q=ne},this.setTransparentSort=function(ne){Z=ne},this.getClearColor=function(ne){return ne.copy(ze.getClearColor())},this.setClearColor=function(){ze.setClearColor.apply(ze,arguments)},this.getClearAlpha=function(){return ze.getClearAlpha()},this.setClearAlpha=function(){ze.setClearAlpha.apply(ze,arguments)},this.clear=function(ne=!0,Y=!0,le=!0){let me=0;if(ne){let _e=!1;if(I!==null){let Xe=I.texture.format;_e=Xe===NU||Xe===OU||Xe===BU}if(_e){let Xe=I.texture.type,rt=Xe===Su||Xe===_u||Xe===u2||Xe===Qh||Xe===LU||Xe===PU,At=ze.getClearColor(),Ct=ze.getClearAlpha(),Tt=At.r,mt=At.g,Bt=At.b;rt?(A[0]=Tt,A[1]=mt,A[2]=Bt,A[3]=Ct,Ne.clearBufferuiv(Ne.COLOR,0,A)):(y[0]=Tt,y[1]=mt,y[2]=Bt,y[3]=Ct,Ne.clearBufferiv(Ne.COLOR,0,y))}else me|=Ne.COLOR_BUFFER_BIT}Y&&(me|=Ne.DEPTH_BUFFER_BIT),le&&(me|=Ne.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ne.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nt,!1),t.removeEventListener("webglcontextrestored",ge,!1),t.removeEventListener("webglcontextcreationerror",ot,!1),we.dispose(),Ae.dispose(),Jt.dispose(),Ie.dispose(),yt.dispose(),he.dispose(),pe.dispose(),Ue.dispose(),ae.dispose(),$e.dispose(),$e.removeEventListener("sessionstart",en),$e.removeEventListener("sessionend",xt),ut&&(ut.dispose(),ut=null),jt.stop()};function nt(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function ge(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;let ne=xn.autoReset,Y=Ee.enabled,le=Ee.autoUpdate,me=Ee.needsUpdate,_e=Ee.type;Qe(),xn.autoReset=ne,Ee.enabled=Y,Ee.autoUpdate=le,Ee.needsUpdate=me,Ee.type=_e}function ot(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function et(ne){let Y=ne.target;Y.removeEventListener("dispose",et),tt(Y)}function tt(ne){_t(ne),Jt.remove(ne)}function _t(ne){let Y=Jt.get(ne).programs;Y!==void 0&&(Y.forEach(function(le){ae.releaseProgram(le)}),ne.isShaderMaterial&&ae.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Y,le,me,_e,Xe){Y===null&&(Y=It);let rt=_e.isMesh&&_e.matrixWorld.determinant()<0,At=dr(ne,Y,le,me,_e);Ot.setMaterial(me,rt);let Ct=le.index,Tt=1;if(me.wireframe===!0){if(Ct=De.getWireframeAttribute(le),Ct===void 0)return;Tt=2}let mt=le.drawRange,Bt=le.attributes.position,cn=mt.start*Tt,Ln=(mt.start+mt.count)*Tt;Xe!==null&&(cn=Math.max(cn,Xe.start*Tt),Ln=Math.min(Ln,(Xe.start+Xe.count)*Tt)),Ct!==null?(cn=Math.max(cn,0),Ln=Math.min(Ln,Ct.count)):Bt!=null&&(cn=Math.max(cn,0),Ln=Math.min(Ln,Bt.count));let Hn=Ln-cn;if(Hn<0||Hn===1/0)return;pe.setup(_e,me,At,le,Ct);let Wn,mn=ee;if(Ct!==null&&(Wn=kt.get(Ct),mn=V,mn.setIndex(Wn)),_e.isMesh)me.wireframe===!0?(Ot.setLineWidth(me.wireframeLinewidth*Ft()),mn.setMode(Ne.LINES)):mn.setMode(Ne.TRIANGLES);else if(_e.isLine){let Yt=me.linewidth;Yt===void 0&&(Yt=1),Ot.setLineWidth(Yt*Ft()),_e.isLineSegments?mn.setMode(Ne.LINES):_e.isLineLoop?mn.setMode(Ne.LINE_LOOP):mn.setMode(Ne.LINE_STRIP)}else _e.isPoints?mn.setMode(Ne.POINTS):_e.isSprite&&mn.setMode(Ne.TRIANGLES);if(_e.isBatchedMesh)mn.renderMultiDraw(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount);else if(_e.isInstancedMesh)mn.renderInstances(cn,Hn,_e.count);else if(le.isInstancedBufferGeometry){let Yt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,lr=Math.min(le.instanceCount,Yt);mn.renderInstances(cn,Hn,lr)}else mn.render(cn,Hn)};function tn(ne,Y,le){ne.transparent===!0&&ne.side===El&&ne.forceSinglePass===!1?(ne.side=Xo,ne.needsUpdate=!0,xi(ne,Y,le),ne.side=Tu,ne.needsUpdate=!0,xi(ne,Y,le),ne.side=El):xi(ne,Y,le)}this.compile=function(ne,Y,le=null){le===null&&(le=ne),x=Ae.get(le),x.init(),w.push(x),le.traverseVisible(function(_e){_e.isLight&&_e.layers.test(Y.layers)&&(x.pushLight(_e),_e.castShadow&&x.pushShadow(_e))}),ne!==le&&ne.traverseVisible(function(_e){_e.isLight&&_e.layers.test(Y.layers)&&(x.pushLight(_e),_e.castShadow&&x.pushShadow(_e))}),x.setupLights(M._useLegacyLights);let me=new Set;return ne.traverse(function(_e){let Xe=_e.material;if(Xe)if(Array.isArray(Xe))for(let rt=0;rt<Xe.length;rt++){let At=Xe[rt];tn(At,le,_e),me.add(At)}else tn(Xe,le,_e),me.add(Xe)}),w.pop(),x=null,me},this.compileAsync=function(ne,Y,le=null){let me=this.compile(ne,Y,le);return new Promise(_e=>{function Xe(){if(me.forEach(function(rt){Jt.get(rt).currentProgram.isReady()&&me.delete(rt)}),me.size===0){_e(ne);return}setTimeout(Xe,10)}St.get("KHR_parallel_shader_compile")!==null?Xe():setTimeout(Xe,10)})};let En=null;function Cn(ne){En&&En(ne)}function en(){jt.stop()}function xt(){jt.start()}let jt=new GU;jt.setAnimationLoop(Cn),typeof self<"u"&&jt.setContext(self),this.setAnimationLoop=function(ne){En=ne,$e.setAnimationLoop(ne),ne===null?jt.stop():jt.start()},$e.addEventListener("sessionstart",en),$e.addEventListener("sessionend",xt),this.render=function(ne,Y){if(Y!==void 0&&Y.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Y.parent===null&&Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),$e.enabled===!0&&$e.isPresenting===!0&&($e.cameraAutoUpdate===!0&&$e.updateCamera(Y),Y=$e.getCamera()),ne.isScene===!0&&ne.onBeforeRender(M,ne,Y,I),x=Ae.get(ne,w.length),x.init(),w.push(x),it.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),be.setFromProjectionMatrix(it),Ze=this.localClippingEnabled,Fe=Le.init(this.clippingPlanes,Ze),E=we.get(ne,v.length),E.init(),v.push(E),Pn(ne,Y,0,M.sortObjects),E.finish(),M.sortObjects===!0&&E.sort(Q,Z),this.info.render.frame++,Fe===!0&&Le.beginShadows();let le=x.state.shadowsArray;if(Ee.render(le,ne,Y),Fe===!0&&Le.endShadows(),this.info.autoReset===!0&&this.info.reset(),ze.render(E,ne),x.setupLights(M._useLegacyLights),Y.isArrayCamera){let me=Y.cameras;for(let _e=0,Xe=me.length;_e<Xe;_e++){let rt=me[_e];In(E,ne,rt,rt.viewport)}}else In(E,ne,Y);I!==null&&(Oe.updateMultisampleRenderTarget(I),Oe.updateRenderTargetMipmap(I)),ne.isScene===!0&&ne.onAfterRender(M,ne,Y),pe.resetDefaultState(),F=-1,R=null,w.pop(),w.length>0?x=w[w.length-1]:x=null,v.pop(),v.length>0?E=v[v.length-1]:E=null};function Pn(ne,Y,le,me){if(ne.visible===!1)return;if(ne.layers.test(Y.layers)){if(ne.isGroup)le=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Y);else if(ne.isLight)x.pushLight(ne),ne.castShadow&&x.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||be.intersectsSprite(ne)){me&&Rt.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(it);let rt=he.update(ne),At=ne.material;At.visible&&E.push(ne,rt,At,le,Rt.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||be.intersectsObject(ne))){let rt=he.update(ne),At=ne.material;if(me&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),Rt.copy(ne.boundingSphere.center)):(rt.boundingSphere===null&&rt.computeBoundingSphere(),Rt.copy(rt.boundingSphere.center)),Rt.applyMatrix4(ne.matrixWorld).applyMatrix4(it)),Array.isArray(At)){let Ct=rt.groups;for(let Tt=0,mt=Ct.length;Tt<mt;Tt++){let Bt=Ct[Tt],cn=At[Bt.materialIndex];cn&&cn.visible&&E.push(ne,rt,cn,le,Rt.z,Bt)}}else At.visible&&E.push(ne,rt,At,le,Rt.z,null)}}let Xe=ne.children;for(let rt=0,At=Xe.length;rt<At;rt++)Pn(Xe[rt],Y,le,me)}function In(ne,Y,le,me){let _e=ne.opaque,Xe=ne.transmissive,rt=ne.transparent;x.setupLightsView(le),Fe===!0&&Le.setGlobalState(M.clippingPlanes,le),Xe.length>0&&Kn(_e,Xe,Y,le),me&&Ot.viewport(N.copy(me)),_e.length>0&&Gn(_e,Y,le),Xe.length>0&&Gn(Xe,Y,le),rt.length>0&&Gn(rt,Y,le),Ot.buffers.depth.setTest(!0),Ot.buffers.depth.setMask(!0),Ot.buffers.color.setMask(!0),Ot.setPolygonOffset(!1)}function Kn(ne,Y,le,me){if((le.isScene===!0?le.overrideMaterial:null)!==null)return;let Xe=Vt.isWebGL2;ut===null&&(ut=new Ml(1,1,{generateMipmaps:!0,type:St.has("EXT_color_buffer_half_float")?Gg:Su,minFilter:zg,samples:Xe?4:0})),M.getDrawingBufferSize(gt),Xe?ut.setSize(gt.x,gt.y):ut.setSize(NS(gt.x),NS(gt.y));let rt=M.getRenderTarget();M.setRenderTarget(ut),M.getClearColor(te),U=M.getClearAlpha(),U<1&&M.setClearColor(16777215,.5),M.clear();let At=M.toneMapping;M.toneMapping=Cu,Gn(ne,le,me),Oe.updateMultisampleRenderTarget(ut),Oe.updateRenderTargetMipmap(ut);let Ct=!1;for(let Tt=0,mt=Y.length;Tt<mt;Tt++){let Bt=Y[Tt],cn=Bt.object,Ln=Bt.geometry,Hn=Bt.material,Wn=Bt.group;if(Hn.side===El&&cn.layers.test(me.layers)){let mn=Hn.side;Hn.side=Xo,Hn.needsUpdate=!0,fi(cn,le,me,Ln,Hn,Wn),Hn.side=mn,Hn.needsUpdate=!0,Ct=!0}}Ct===!0&&(Oe.updateMultisampleRenderTarget(ut),Oe.updateRenderTargetMipmap(ut)),M.setRenderTarget(rt),M.setClearColor(te,U),M.toneMapping=At}function Gn(ne,Y,le){let me=Y.isScene===!0?Y.overrideMaterial:null;for(let _e=0,Xe=ne.length;_e<Xe;_e++){let rt=ne[_e],At=rt.object,Ct=rt.geometry,Tt=me===null?rt.material:me,mt=rt.group;At.layers.test(le.layers)&&fi(At,Y,le,Ct,Tt,mt)}}function fi(ne,Y,le,me,_e,Xe){ne.onBeforeRender(M,Y,le,me,_e,Xe),ne.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),_e.onBeforeRender(M,Y,le,me,ne,Xe),_e.transparent===!0&&_e.side===El&&_e.forceSinglePass===!1?(_e.side=Xo,_e.needsUpdate=!0,M.renderBufferDirect(le,Y,me,_e,ne,Xe),_e.side=Tu,_e.needsUpdate=!0,M.renderBufferDirect(le,Y,me,_e,ne,Xe),_e.side=El):M.renderBufferDirect(le,Y,me,_e,ne,Xe),ne.onAfterRender(M,Y,le,me,_e,Xe)}function xi(ne,Y,le){Y.isScene!==!0&&(Y=It);let me=Jt.get(ne),_e=x.state.lights,Xe=x.state.shadowsArray,rt=_e.state.version,At=ae.getParameters(ne,_e.state,Xe,Y,le),Ct=ae.getProgramCacheKey(At),Tt=me.programs;me.environment=ne.isMeshStandardMaterial?Y.environment:null,me.fog=Y.fog,me.envMap=(ne.isMeshStandardMaterial?yt:Ie).get(ne.envMap||me.environment),Tt===void 0&&(ne.addEventListener("dispose",et),Tt=new Map,me.programs=Tt);let mt=Tt.get(Ct);if(mt!==void 0){if(me.currentProgram===mt&&me.lightsStateVersion===rt)return ir(ne,At),mt}else At.uniforms=ae.getUniforms(ne),ne.onBuild(le,At,M),ne.onBeforeCompile(At,M),mt=ae.acquireProgram(At,Ct),Tt.set(Ct,mt),me.uniforms=At.uniforms;let Bt=me.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(Bt.clippingPlanes=Le.uniform),ir(ne,At),me.needsLights=Mi(ne),me.lightsStateVersion=rt,me.needsLights&&(Bt.ambientLightColor.value=_e.state.ambient,Bt.lightProbe.value=_e.state.probe,Bt.directionalLights.value=_e.state.directional,Bt.directionalLightShadows.value=_e.state.directionalShadow,Bt.spotLights.value=_e.state.spot,Bt.spotLightShadows.value=_e.state.spotShadow,Bt.rectAreaLights.value=_e.state.rectArea,Bt.ltc_1.value=_e.state.rectAreaLTC1,Bt.ltc_2.value=_e.state.rectAreaLTC2,Bt.pointLights.value=_e.state.point,Bt.pointLightShadows.value=_e.state.pointShadow,Bt.hemisphereLights.value=_e.state.hemi,Bt.directionalShadowMap.value=_e.state.directionalShadowMap,Bt.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,Bt.spotShadowMap.value=_e.state.spotShadowMap,Bt.spotLightMatrix.value=_e.state.spotLightMatrix,Bt.spotLightMap.value=_e.state.spotLightMap,Bt.pointShadowMap.value=_e.state.pointShadowMap,Bt.pointShadowMatrix.value=_e.state.pointShadowMatrix),me.currentProgram=mt,me.uniformsList=null,mt}function Ti(ne){if(ne.uniformsList===null){let Y=ne.currentProgram.getUniforms();ne.uniformsList=_p.seqWithValue(Y.seq,ne.uniforms)}return ne.uniformsList}function ir(ne,Y){let le=Jt.get(ne);le.outputColorSpace=Y.outputColorSpace,le.batching=Y.batching,le.instancing=Y.instancing,le.instancingColor=Y.instancingColor,le.skinning=Y.skinning,le.morphTargets=Y.morphTargets,le.morphNormals=Y.morphNormals,le.morphColors=Y.morphColors,le.morphTargetsCount=Y.morphTargetsCount,le.numClippingPlanes=Y.numClippingPlanes,le.numIntersection=Y.numClipIntersection,le.vertexAlphas=Y.vertexAlphas,le.vertexTangents=Y.vertexTangents,le.toneMapping=Y.toneMapping}function dr(ne,Y,le,me,_e){Y.isScene!==!0&&(Y=It),Oe.resetTextureUnits();let Xe=Y.fog,rt=me.isMeshStandardMaterial?Y.environment:null,At=I===null?M.outputColorSpace:I.isXRRenderTarget===!0?I.texture.colorSpace:bl,Ct=(me.isMeshStandardMaterial?yt:Ie).get(me.envMap||rt),Tt=me.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,mt=!!le.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),Bt=!!le.morphAttributes.position,cn=!!le.morphAttributes.normal,Ln=!!le.morphAttributes.color,Hn=Cu;me.toneMapped&&(I===null||I.isXRRenderTarget===!0)&&(Hn=M.toneMapping);let Wn=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,mn=Wn!==void 0?Wn.length:0,Yt=Jt.get(me),lr=x.state.lights;if(Fe===!0&&(Ze===!0||ne!==R)){let Se=ne===R&&me.id===F;Le.setState(me,ne,Se)}let zn=!1;me.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==lr.state.version||Yt.outputColorSpace!==At||_e.isBatchedMesh&&Yt.batching===!1||!_e.isBatchedMesh&&Yt.batching===!0||_e.isInstancedMesh&&Yt.instancing===!1||!_e.isInstancedMesh&&Yt.instancing===!0||_e.isSkinnedMesh&&Yt.skinning===!1||!_e.isSkinnedMesh&&Yt.skinning===!0||_e.isInstancedMesh&&Yt.instancingColor===!0&&_e.instanceColor===null||_e.isInstancedMesh&&Yt.instancingColor===!1&&_e.instanceColor!==null||Yt.envMap!==Ct||me.fog===!0&&Yt.fog!==Xe||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==Le.numPlanes||Yt.numIntersection!==Le.numIntersection)||Yt.vertexAlphas!==Tt||Yt.vertexTangents!==mt||Yt.morphTargets!==Bt||Yt.morphNormals!==cn||Yt.morphColors!==Ln||Yt.toneMapping!==Hn||Vt.isWebGL2===!0&&Yt.morphTargetsCount!==mn)&&(zn=!0):(zn=!0,Yt.__version=me.version);let yn=Yt.currentProgram;zn===!0&&(yn=xi(me,Y,_e));let Ei=!1,ur=!1,$n=!1,q=yn.getUniforms(),re=Yt.uniforms;if(Ot.useProgram(yn.program)&&(Ei=!0,ur=!0,$n=!0),me.id!==F&&(F=me.id,ur=!0),Ei||R!==ne){q.setValue(Ne,"projectionMatrix",ne.projectionMatrix),q.setValue(Ne,"viewMatrix",ne.matrixWorldInverse);let Se=q.map.cameraPosition;Se!==void 0&&Se.setValue(Ne,Rt.setFromMatrixPosition(ne.matrixWorld)),Vt.logarithmicDepthBuffer&&q.setValue(Ne,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&q.setValue(Ne,"isOrthographic",ne.isOrthographicCamera===!0),R!==ne&&(R=ne,ur=!0,$n=!0)}if(_e.isSkinnedMesh){q.setOptional(Ne,_e,"bindMatrix"),q.setOptional(Ne,_e,"bindMatrixInverse");let Se=_e.skeleton;Se&&(Vt.floatVertexTextures?(Se.boneTexture===null&&Se.computeBoneTexture(),q.setValue(Ne,"boneTexture",Se.boneTexture,Oe)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}_e.isBatchedMesh&&(q.setOptional(Ne,_e,"batchingTexture"),q.setValue(Ne,"batchingTexture",_e._matricesTexture,Oe));let ye=le.morphAttributes;if((ye.position!==void 0||ye.normal!==void 0||ye.color!==void 0&&Vt.isWebGL2===!0)&&Ge.update(_e,le,yn),(ur||Yt.receiveShadow!==_e.receiveShadow)&&(Yt.receiveShadow=_e.receiveShadow,q.setValue(Ne,"receiveShadow",_e.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(re.envMap.value=Ct,re.flipEnvMap.value=Ct.isCubeTexture&&Ct.isRenderTargetTexture===!1?-1:1),ur&&(q.setValue(Ne,"toneMappingExposure",M.toneMappingExposure),Yt.needsLights&&Ai(re,$n),Xe&&me.fog===!0&&de.refreshFogUniforms(re,Xe),de.refreshMaterialUniforms(re,me,z,k,ut),_p.upload(Ne,Ti(Yt),re,Oe)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(_p.upload(Ne,Ti(Yt),re,Oe),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&q.setValue(Ne,"center",_e.center),q.setValue(Ne,"modelViewMatrix",_e.modelViewMatrix),q.setValue(Ne,"normalMatrix",_e.normalMatrix),q.setValue(Ne,"modelMatrix",_e.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){let Se=me.uniformsGroups;for(let He=0,at=Se.length;He<at;He++)if(Vt.isWebGL2){let vt=Se[He];Ue.update(vt,yn),Ue.bind(vt,yn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return yn}function Ai(ne,Y){ne.ambientLightColor.needsUpdate=Y,ne.lightProbe.needsUpdate=Y,ne.directionalLights.needsUpdate=Y,ne.directionalLightShadows.needsUpdate=Y,ne.pointLights.needsUpdate=Y,ne.pointLightShadows.needsUpdate=Y,ne.spotLights.needsUpdate=Y,ne.spotLightShadows.needsUpdate=Y,ne.rectAreaLights.needsUpdate=Y,ne.hemisphereLights.needsUpdate=Y}function Mi(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return I},this.setRenderTargetTextures=function(ne,Y,le){Jt.get(ne.texture).__webglTexture=Y,Jt.get(ne.depthTexture).__webglTexture=le;let me=Jt.get(ne);me.__hasExternalTextures=!0,me.__hasExternalTextures&&(me.__autoAllocateDepthBuffer=le===void 0,me.__autoAllocateDepthBuffer||St.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ne,Y){let le=Jt.get(ne);le.__webglFramebuffer=Y,le.__useDefaultFramebuffer=Y===void 0},this.setRenderTarget=function(ne,Y=0,le=0){I=ne,D=Y,L=le;let me=!0,_e=null,Xe=!1,rt=!1;if(ne){let Ct=Jt.get(ne);Ct.__useDefaultFramebuffer!==void 0?(Ot.bindFramebuffer(Ne.FRAMEBUFFER,null),me=!1):Ct.__webglFramebuffer===void 0?Oe.setupRenderTarget(ne):Ct.__hasExternalTextures&&Oe.rebindTextures(ne,Jt.get(ne.texture).__webglTexture,Jt.get(ne.depthTexture).__webglTexture);let Tt=ne.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(rt=!0);let mt=Jt.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(mt[Y])?_e=mt[Y][le]:_e=mt[Y],Xe=!0):Vt.isWebGL2&&ne.samples>0&&Oe.useMultisampledRTT(ne)===!1?_e=Jt.get(ne).__webglMultisampledFramebuffer:Array.isArray(mt)?_e=mt[le]:_e=mt,N.copy(ne.viewport),X.copy(ne.scissor),$=ne.scissorTest}else N.copy(ce).multiplyScalar(z).floor(),X.copy(Me).multiplyScalar(z).floor(),$=xe;if(Ot.bindFramebuffer(Ne.FRAMEBUFFER,_e)&&Vt.drawBuffers&&me&&Ot.drawBuffers(ne,_e),Ot.viewport(N),Ot.scissor(X),Ot.setScissorTest($),Xe){let Ct=Jt.get(ne.texture);Ne.framebufferTexture2D(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_CUBE_MAP_POSITIVE_X+Y,Ct.__webglTexture,le)}else if(rt){let Ct=Jt.get(ne.texture),Tt=Y||0;Ne.framebufferTextureLayer(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ct.__webglTexture,le||0,Tt)}F=-1},this.readRenderTargetPixels=function(ne,Y,le,me,_e,Xe,rt){if(!(ne&&ne.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let At=Jt.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&rt!==void 0&&(At=At[rt]),At){Ot.bindFramebuffer(Ne.FRAMEBUFFER,At);try{let Ct=ne.texture,Tt=Ct.format,mt=Ct.type;if(Tt!==oc&&G.convert(Tt)!==Ne.getParameter(Ne.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Bt=mt===Gg&&(St.has("EXT_color_buffer_half_float")||Vt.isWebGL2&&St.has("EXT_color_buffer_float"));if(mt!==Su&&G.convert(mt)!==Ne.getParameter(Ne.IMPLEMENTATION_COLOR_READ_TYPE)&&!(mt===bu&&(Vt.isWebGL2||St.has("OES_texture_float")||St.has("WEBGL_color_buffer_float")))&&!Bt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Y>=0&&Y<=ne.width-me&&le>=0&&le<=ne.height-_e&&Ne.readPixels(Y,le,me,_e,G.convert(Tt),G.convert(mt),Xe)}finally{let Ct=I!==null?Jt.get(I).__webglFramebuffer:null;Ot.bindFramebuffer(Ne.FRAMEBUFFER,Ct)}}},this.copyFramebufferToTexture=function(ne,Y,le=0){let me=Math.pow(2,-le),_e=Math.floor(Y.image.width*me),Xe=Math.floor(Y.image.height*me);Oe.setTexture2D(Y,0),Ne.copyTexSubImage2D(Ne.TEXTURE_2D,le,0,0,ne.x,ne.y,_e,Xe),Ot.unbindTexture()},this.copyTextureToTexture=function(ne,Y,le,me=0){let _e=Y.image.width,Xe=Y.image.height,rt=G.convert(le.format),At=G.convert(le.type);Oe.setTexture2D(le,0),Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,le.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,le.unpackAlignment),Y.isDataTexture?Ne.texSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,_e,Xe,rt,At,Y.image.data):Y.isCompressedTexture?Ne.compressedTexSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,Y.mipmaps[0].width,Y.mipmaps[0].height,rt,Y.mipmaps[0].data):Ne.texSubImage2D(Ne.TEXTURE_2D,me,ne.x,ne.y,rt,At,Y.image),me===0&&le.generateMipmaps&&Ne.generateMipmap(Ne.TEXTURE_2D),Ot.unbindTexture()},this.copyTextureToTexture3D=function(ne,Y,le,me,_e=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Xe=ne.max.x-ne.min.x+1,rt=ne.max.y-ne.min.y+1,At=ne.max.z-ne.min.z+1,Ct=G.convert(me.format),Tt=G.convert(me.type),mt;if(me.isData3DTexture)Oe.setTexture3D(me,0),mt=Ne.TEXTURE_3D;else if(me.isDataArrayTexture||me.isCompressedArrayTexture)Oe.setTexture2DArray(me,0),mt=Ne.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,me.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,me.unpackAlignment);let Bt=Ne.getParameter(Ne.UNPACK_ROW_LENGTH),cn=Ne.getParameter(Ne.UNPACK_IMAGE_HEIGHT),Ln=Ne.getParameter(Ne.UNPACK_SKIP_PIXELS),Hn=Ne.getParameter(Ne.UNPACK_SKIP_ROWS),Wn=Ne.getParameter(Ne.UNPACK_SKIP_IMAGES),mn=le.isCompressedTexture?le.mipmaps[_e]:le.image;Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,mn.width),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,mn.height),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,ne.min.x),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,ne.min.y),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,ne.min.z),le.isDataTexture||le.isData3DTexture?Ne.texSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,Tt,mn.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ne.compressedTexSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,mn.data)):Ne.texSubImage3D(mt,_e,Y.x,Y.y,Y.z,Xe,rt,At,Ct,Tt,mn),Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,Bt),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,cn),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,Ln),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,Hn),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,Wn),_e===0&&me.generateMipmaps&&Ne.generateMipmap(mt),Ot.unbindTexture()},this.initTexture=function(ne){ne.isCubeTexture?Oe.setTextureCube(ne,0):ne.isData3DTexture?Oe.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?Oe.setTexture2DArray(ne,0):Oe.setTexture2D(ne,0),Ot.unbindTexture()},this.resetState=function(){D=0,L=0,I=null,Ot.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return _l}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===h2?"display-p3":"srgb",t.unpackColorSpace=Hr.workingColorSpace===pE?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ro?qh:UU}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===qh?ro:bl}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}},e2=class extends ZS{};e2.prototype.isWebGL1Renderer=!0;Wg=class extends Kh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new cr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},CU=new Lt,SU=new Lt,TU=new oo,SS=new iE,Wx=new Cp,dE=class extends Sl{constructor(e=new ka,t=new Wg){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let s=1,o=t.count;s<o;s++)CU.fromBufferAttribute(t,s-1),SU.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=CU.distanceTo(SU);e.setAttribute("lineDistance",new fa(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Wx.copy(i.boundingSphere),Wx.applyMatrix4(s),Wx.radius+=o,e.ray.intersectsSphere(Wx)===!1)return;TU.copy(s).invert(),SS.copy(e.ray).applyMatrix4(TU);let l=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Lt,p=new Lt,f=new Lt,m=new Lt,A=this.isLineSegments?2:1,y=i.index,x=i.attributes.position;if(y!==null){let v=Math.max(0,c.start),w=Math.min(y.count,c.start+c.count);for(let M=v,T=w-1;M<T;M+=A){let D=y.getX(M),L=y.getX(M+1);if(h.fromBufferAttribute(x,D),p.fromBufferAttribute(x,L),SS.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);let F=e.ray.origin.distanceTo(m);F<e.near||F>e.far||t.push({distance:F,point:f.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,c.start),w=Math.min(x.count,c.start+c.count);for(let M=v,T=w-1;M<T;M+=A){if(h.fromBufferAttribute(x,M),p.fromBufferAttribute(x,M+1),SS.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);let L=e.ray.origin.distanceTo(m);L<e.near||L>e.far||t.push({distance:L,point:f.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,c=s.length;o<c;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}},jg=class n extends ka{constructor(e=1,t=32,i=16,s=0,o=Math.PI*2,c=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:s,phiLength:o,thetaStart:c,thetaLength:l},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let u=Math.min(c+l,Math.PI),h=0,p=[],f=new Lt,m=new Lt,A=[],y=[],E=[],x=[];for(let v=0;v<=i;v++){let w=[],M=v/i,T=0;v===0&&c===0?T=.5/t:v===i&&u===Math.PI&&(T=-.5/t);for(let D=0;D<=t;D++){let L=D/t;f.x=-e*Math.cos(s+L*o)*Math.sin(c+M*l),f.y=e*Math.cos(c+M*l),f.z=e*Math.sin(s+L*o)*Math.sin(c+M*l),y.push(f.x,f.y,f.z),m.copy(f).normalize(),E.push(m.x,m.y,m.z),x.push(L+T,1-M),w.push(h++)}p.push(w)}for(let v=0;v<i;v++)for(let w=0;w<t;w++){let M=p[v][w+1],T=p[v][w],D=p[v+1][w],L=p[v+1][w+1];(v!==0||c>0)&&A.push(M,T,L),(v!==i-1||u<Math.PI)&&A.push(T,D,L)}this.setIndex(A),this.setAttribute("position",new fa(y,3)),this.setAttribute("normal",new fa(E,3)),this.setAttribute("uv",new fa(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};Tp=class{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,s=t[i],o=t[i-1];n:{e:{let c;t:{i:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(o=s,s=t[++i],e<s)break e}c=t.length;break t}if(!(e>=o)){let l=t[1];e<l&&(i=2,o=l);for(let u=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(s=o,o=t[--i-1],e>=o)break e}c=i,i=0;break t}break n}for(;i<c;){let l=i+c>>>1;e<t[l]?c=l:i=l+1}if(s=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let c=0;c!==s;++c)t[c]=i[o+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},t2=class extends Tp{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:NF,endingEnd:NF}}intervalChanged_(e,t,i){let s=this.parameterPositions,o=e-2,c=e+1,l=s[o],u=s[c];if(l===void 0)switch(this.getSettings_().endingStart){case FF:o=e,l=2*t-i;break;case UF:o=s.length-2,l=t+s[o]-s[o+1];break;default:o=e,l=i}if(u===void 0)switch(this.getSettings_().endingEnd){case FF:c=e,u=2*i-t;break;case UF:c=1,u=i+s[1]-s[0];break;default:c=e-1,u=t}let h=(i-t)*.5,p=this.valueSize;this._weightPrev=h/(t-l),this._weightNext=h/(u-i),this._offsetPrev=o*p,this._offsetNext=c*p}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,A=this._weightNext,y=(i-t)/(s-t),E=y*y,x=E*y,v=-m*x+2*m*E-m*y,w=(1+m)*x+(-1.5-2*m)*E+(-.5+m)*y+1,M=(-1-A)*x+(1.5+A)*E+.5*y,T=A*x-A*E;for(let D=0;D!==l;++D)o[D]=v*c[p+D]+w*c[h+D]+M*c[u+D]+T*c[f+D];return o}},n2=class extends Tp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=(i-t)/(s-t),f=1-p;for(let m=0;m!==l;++m)o[m]=c[h+m]*f+c[u+m]*p;return o}},i2=class extends Tp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}},ac=class{constructor(e,t,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=jx(t,this.TimeBufferType),this.values=jx(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:jx(e.times,Array),values:jx(e.values,Array)};let s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new i2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new n2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new t2(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Xx:t=this.InterpolantFactoryMethodDiscrete;break;case qx:t=this.InterpolantFactoryMethodLinear;break;case nS:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xx;case this.InterpolantFactoryMethodLinear:return qx;case this.InterpolantFactoryMethodSmooth:return nS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){let i=this.times,s=i.length,o=0,c=s-1;for(;o!==s&&i[o]<e;)++o;for(;c!==-1&&i[c]>t;)--c;if(++c,o!==0||c!==s){o>=c&&(c=Math.max(c,1),o=c-1);let l=this.getValueSize();this.times=i.slice(o,c),this.values=this.values.slice(o*l,c*l)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let l=0;l!==o;l++){let u=i[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(c!==null&&c>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,c),e=!1;break}c=u}if(s!==void 0&&soe(s))for(let l=0,u=s.length;l!==u;++l){let h=s[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===nS,o=e.length-1,c=1;for(let l=1;l<o;++l){let u=!1,h=e[l],p=e[l+1];if(h!==p&&(l!==1||h!==e[0]))if(s)u=!0;else{let f=l*i,m=f-i,A=f+i;for(let y=0;y!==i;++y){let E=t[f+y];if(E!==t[m+y]||E!==t[A+y]){u=!0;break}}}if(u){if(l!==c){e[c]=e[l];let f=l*i,m=c*i;for(let A=0;A!==i;++A)t[m+A]=t[f+A]}++c}}if(o>0){e[c]=e[o];for(let l=o*i,u=c*i,h=0;h!==i;++h)t[u+h]=t[l+h];++c}return c!==e.length?(this.times=e.slice(0,c),this.values=t.slice(0,c*i)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),i=this.constructor,s=new i(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}};ac.prototype.TimeBufferType=Float32Array;ac.prototype.ValueBufferType=Float32Array;ac.prototype.DefaultInterpolation=qx;$h=class extends ac{};$h.prototype.ValueTypeName="bool";$h.prototype.ValueBufferType=Array;$h.prototype.DefaultInterpolation=Xx;$h.prototype.InterpolantFactoryMethodLinear=void 0;$h.prototype.InterpolantFactoryMethodSmooth=void 0;r2=class extends ac{};r2.prototype.ValueTypeName="color";s2=class extends ac{};s2.prototype.ValueTypeName="number";o2=class extends Tp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,u=(i-t)/(s-t),h=e*l;for(let p=h+l;h!==p;h+=4)Ru.slerpFlat(o,0,c,h-l,c,h,u);return o}},Qg=class extends ac{InterpolantFactoryMethodLinear(e){return new o2(this.times,this.values,this.getValueSize(),e)}};Qg.prototype.ValueTypeName="quaternion";Qg.prototype.DefaultInterpolation=qx;Qg.prototype.InterpolantFactoryMethodSmooth=void 0;Jh=class extends ac{};Jh.prototype.ValueTypeName="string";Jh.prototype.ValueBufferType=Array;Jh.prototype.DefaultInterpolation=Xx;Jh.prototype.InterpolantFactoryMethodLinear=void 0;Jh.prototype.InterpolantFactoryMethodSmooth=void 0;a2=class extends ac{};a2.prototype.ValueTypeName="vector";f2="\\[\\]\\.:\\/",ooe=new RegExp("["+f2+"]","g"),p2="[^"+f2+"]",aoe="[^"+f2.replace("\\.","")+"]",coe=/((?:WC+[\/:])*)/.source.replace("WC",p2),loe=/(WCOD+)?/.source.replace("WCOD",aoe),uoe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",p2),hoe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",p2),doe=new RegExp("^"+coe+loe+uoe+hoe+"$"),foe=["material","materials","bones","map"],c2=class{constructor(e,t,i){let s=i||ms.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},ms=(()=>{class n{constructor(t,i,s){this.path=i,this.parsedPath=s||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,s):new n(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(ooe,"")}static parseTrackName(t){let i=doe.exec(t);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=s.nodeName&&s.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let c=s.nodeName.substring(o+1);foe.indexOf(c)!==-1&&(s.nodeName=s.nodeName.substring(0,o),s.objectName=c)}if(s.propertyName===null||s.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(i===void 0||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){let s=t.skeleton.getBoneByName(i);if(s!==void 0)return s}if(t.children){let s=function(c){for(let l=0;l<c.length;l++){let u=c[l];if(u.name===i||u.uuid===i)return u;let h=s(u.children);if(h)return h}return null},o=s(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)t[i++]=s[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,c=s.length;o!==c;++o)s[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node,i=this.parsedPath,s=i.objectName,o=i.propertyName,c=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(s){let p=i.objectIndex;switch(s){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===p){p=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[s]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[s]}if(p!==void 0){if(t[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[p]}}let l=t[o];if(l===void 0){let p=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+o+" but it wasn't found.",t);return}let u=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(c!==void 0){if(o==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[c]!==void 0&&(c=t.morphTargetDictionary[c])}h=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=c}else l.fromArray!==void 0&&l.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(h=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=o;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=c2,n})();ms.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ms.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ms.prototype.GetterByBindingType=[ms.prototype._getValue_direct,ms.prototype._getValue_array,ms.prototype._getValue_arrayElement,ms.prototype._getValue_toArray];ms.prototype.SetterByBindingTypeAndVersioning=[[ms.prototype._setValue_direct,ms.prototype._setValue_direct_setNeedsUpdate,ms.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ms.prototype._setValue_array,ms.prototype._setValue_array_setNeedsUpdate,ms.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ms.prototype._setValue_arrayElement,ms.prototype._setValue_arrayElement_setNeedsUpdate,ms.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ms.prototype._setValue_fromArray,ms.prototype._setValue_fromArray_setNeedsUpdate,ms.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];sme=new Float32Array(1);typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l2}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l2)});var KU={};S7(KU,{Pathfinding:()=>qg,PathfindingHelper:()=>A2});var os,m2,g2,qg,Dp,A2,$U=zc(()=>{"use strict";YU();os=class{static roundNumber(e,t){let i=Math.pow(10,t);return Math.round(e*i)/i}static sample(e){return e[Math.floor(Math.random()*e.length)]}static distanceToSquared(e,t){var i=e.x-t.x,s=e.y-t.y,o=e.z-t.z;return i*i+s*s+o*o}static isPointInPoly(e,t){for(var i=!1,s=-1,o=e.length,c=o-1;++s<o;c=s)(e[s].z<=t.z&&t.z<e[c].z||e[c].z<=t.z&&t.z<e[s].z)&&t.x<(e[c].x-e[s].x)*(t.z-e[s].z)/(e[c].z-e[s].z)+e[s].x&&(i=!i);return i}static isVectorInPolygon(e,t,i){var s=1e5,o=-1e5,c=[];return t.vertexIds.forEach(l=>{s=Math.min(i[l].y,s),o=Math.max(i[l].y,o),c.push(i[l])}),!!(e.y<o+.5&&e.y>s-.5&&this.isPointInPoly(c,e))}static triarea2(e,t,i){return(i.x-e.x)*(t.z-e.z)-(t.x-e.x)*(i.z-e.z)}static vequal(e,t){return this.distanceToSquared(e,t)<1e-5}static mergeVertices(e,t=1e-4){t=Math.max(t,Number.EPSILON);for(var i={},s=e.getIndex(),o=e.getAttribute("position"),c=s?s.count:o.count,l=0,u=[],h=[],p=Math.log10(1/t),f=Math.pow(10,p),m=0;m<c;m++){var A=s?s.getX(m):m,y="";y+=~~(o.getX(A)*f)+",",y+=~~(o.getY(A)*f)+",",(y+=~~(o.getZ(A)*f)+",")in i?u.push(i[y]):(h.push(o.getX(A)),h.push(o.getY(A)),h.push(o.getZ(A)),i[y]=l,u.push(l),l++)}let E=new Bo(new Float32Array(h),o.itemSize,o.normalized),x=new ka;return x.setAttribute("position",E),x.setIndex(u),x}},m2=class{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){let e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e}remove(e){let t=this.content.indexOf(e),i=this.content.pop();t!==this.content.length-1&&(this.content[t]=i,this.scoreFunction(i)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){let t=this.content[e];for(;e>0;){let i=(e+1>>1)-1,s=this.content[i];if(!(this.scoreFunction(t)<this.scoreFunction(s)))break;this.content[i]=t,this.content[e]=s,e=i}}bubbleUp(e){let t=this.content.length,i=this.content[e],s=this.scoreFunction(i);for(;;){let o=e+1<<1,c=o-1,l,u=null;if(c<t&&(l=this.scoreFunction(this.content[c]),l<s&&(u=c)),o<t&&this.scoreFunction(this.content[o])<(u===null?s:l)&&(u=o),u===null)break;this.content[e]=this.content[u],this.content[u]=i,e=u}}},g2=class{constructor(){this.portals=[]}push(e,t){t===void 0&&(t=e),this.portals.push({left:e,right:t})}stringPull(){let e=this.portals,t=[],i,s,o,c=0,l=0,u=0;i=e[0].left,s=e[0].left,o=e[0].right,t.push(i);for(let h=1;h<e.length;h++){let p=e[h].left,f=e[h].right;if(os.triarea2(i,o,f)<=0){if(!(os.vequal(i,o)||os.triarea2(i,s,f)>0)){t.push(s),i=s,c=l,s=i,o=i,l=c,u=c,h=c;continue}o=f,u=h}if(os.triarea2(i,s,p)>=0){if(!(os.vequal(i,s)||os.triarea2(i,o,p)<0)){t.push(o),i=o,c=u,s=i,o=i,l=c,u=c,h=c;continue}s=p,l=h}}return t.length!==0&&os.vequal(t[t.length-1],e[e.length-1].left)||t.push(e[e.length-1].left),this.path=t,t}},qg=class{constructor(){this.zones={}}static createZone(e,t=1e-4){return(class{static buildZone(i,s){let o=this._buildNavigationMesh(i,s),c={};o.vertices.forEach(u=>{u.x=os.roundNumber(u.x,2),u.y=os.roundNumber(u.y,2),u.z=os.roundNumber(u.z,2)}),c.vertices=o.vertices;let l=this._buildPolygonGroups(o);return c.groups=new Array(l.length),l.forEach((u,h)=>{let p=new Map;u.forEach((m,A)=>{p.set(m,A)});let f=new Array(u.length);u.forEach((m,A)=>{let y=[];m.neighbours.forEach(v=>y.push(p.get(v)));let E=[];m.neighbours.forEach(v=>E.push(this._getSharedVerticesInOrder(m,v)));let x=new Lt(0,0,0);x.add(c.vertices[m.vertexIds[0]]),x.add(c.vertices[m.vertexIds[1]]),x.add(c.vertices[m.vertexIds[2]]),x.divideScalar(3),x.x=os.roundNumber(x.x,2),x.y=os.roundNumber(x.y,2),x.z=os.roundNumber(x.z,2),f[A]={id:A,neighbours:y,vertexIds:m.vertexIds,centroid:x,portals:E}}),c.groups[h]=f}),c}static _buildNavigationMesh(i,s){return i=os.mergeVertices(i,s),this._buildPolygonsFromGeometry(i)}static _spreadGroupId(i){let s=new Set([i]);for(;s.size>0;){let o=s;s=new Set,o.forEach(c=>{c.group=i.group,c.neighbours.forEach(l=>{l.group===void 0&&s.add(l)})})}}static _buildPolygonGroups(i){let s=[];return i.polygons.forEach(o=>{o.group!==void 0?s[o.group].push(o):(o.group=s.length,this._spreadGroupId(o),s.push([o]))}),s}static _buildPolygonNeighbours(i,s){let o=new Set,c=s[i.vertexIds[1]],l=s[i.vertexIds[2]];return s[i.vertexIds[0]].forEach(u=>{u!==i&&(c.includes(u)||l.includes(u))&&o.add(u)}),c.forEach(u=>{u!==i&&l.includes(u)&&o.add(u)}),o}static _buildPolygonsFromGeometry(i){let s=[],o=[],c=i.attributes.position,l=i.index,u=[];for(let h=0;h<c.count;h++)o.push(new Lt().fromBufferAttribute(c,h)),u[h]=[];for(let h=0;h<i.index.count;h+=3){let p=l.getX(h),f=l.getX(h+1),m=l.getX(h+2),A={vertexIds:[p,f,m],neighbours:null};s.push(A),u[p].push(A),u[f].push(A),u[m].push(A)}return s.forEach(h=>{h.neighbours=this._buildPolygonNeighbours(h,u)}),{polygons:s,vertices:o}}static _getSharedVerticesInOrder(i,s){let o=i.vertexIds,c=o[0],l=o[1],u=o[2],h=s.vertexIds,p=h.includes(c),f=h.includes(l),m=h.includes(u);return p&&f&&m?Array.from(o):p&&f?[c,l]:f&&m?[l,u]:p&&m?[u,c]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(e,t)}setZoneData(e,t){this.zones[e]=t}getRandomNode(e,t,i,s){if(!this.zones[e])return new Lt;i=i||null,s=s||0;let o=[];return this.zones[e].groups[t].forEach(c=>{i&&s?os.distanceToSquared(i,c.centroid)<s*s&&o.push(c.centroid):o.push(c.centroid)}),os.sample(o)||new Lt}getClosestNode(e,t,i,s=!1){let o=this.zones[t].vertices,c=null,l=1/0;return this.zones[t].groups[i].forEach(u=>{let h=os.distanceToSquared(u.centroid,e);h<l&&(!s||os.isVectorInPolygon(e,u,o))&&(c=u,l=h)}),c}findPath(e,t,i,s){let o=this.zones[i].groups[s],c=this.zones[i].vertices,l=this.getClosestNode(e,i,s,!0),u=this.getClosestNode(t,i,s,!0);if(!l||!u)return null;let h=(class{static init(A){for(let y=0;y<A.length;y++){let E=A[y];E.f=0,E.g=0,E.h=0,E.cost=1,E.visited=!1,E.closed=!1,E.parent=null}}static cleanUp(A){for(let y=0;y<A.length;y++){let E=A[y];delete E.f,delete E.g,delete E.h,delete E.cost,delete E.visited,delete E.closed,delete E.parent}}static heap(){return new m2(function(A){return A.f})}static search(A,y,E){this.init(A);let x=this.heap();for(x.push(y);x.size()>0;){let v=x.pop();if(v===E){let M=v,T=[];for(;M.parent;)T.push(M),M=M.parent;return this.cleanUp(T),T.reverse()}v.closed=!0;let w=this.neighbours(A,v);for(let M=0,T=w.length;M<T;M++){let D=w[M];if(D.closed)continue;let L=v.g+D.cost,I=D.visited;if(!I||L<D.g){if(D.visited=!0,D.parent=v,!D.centroid||!E.centroid)throw new Error("Unexpected state");D.h=D.h||this.heuristic(D.centroid,E.centroid),D.g=L,D.f=D.g+D.h,I?x.rescoreElement(D):x.push(D)}}}return[]}static heuristic(A,y){return os.distanceToSquared(A,y)}static neighbours(A,y){let E=[];for(let x=0;x<y.neighbours.length;x++)E.push(A[y.neighbours[x]]);return E}}).search(o,l,u),p=function(A,y){for(var E=0;E<A.neighbours.length;E++)if(A.neighbours[E]===y.id)return A.portals[E]},f=new g2;f.push(e);for(let A=0;A<h.length;A++){let y=h[A],E=h[A+1];if(E){let x=p(y,E);f.push(c[x[0]],c[x[1]])}}f.push(t),f.stringPull();let m=f.path.map(A=>new Lt(A.x,A.y,A.z));return m.shift(),m}};qg.prototype.getGroup=function(){let n=new Fa;return function(e,t,i=!1){if(!this.zones[e])return null;let s=null,o=Math.pow(50,2),c=this.zones[e];for(let l=0;l<c.groups.length;l++){let u=c.groups[l];for(let h of u){if(i&&(n.setFromCoplanarPoints(c.vertices[h.vertexIds[0]],c.vertices[h.vertexIds[1]],c.vertices[h.vertexIds[2]]),Math.abs(n.distanceToPoint(t))<.01)&&os.isPointInPoly([c.vertices[h.vertexIds[0]],c.vertices[h.vertexIds[1]],c.vertices[h.vertexIds[2]]],t))return l;let p=os.distanceToSquared(h.centroid,t);p<o&&(s=l,o=p)}}return s}}(),qg.prototype.clampStep=function(){let n=new Lt,e=new Fa,t=new Mu,i=new Lt,s,o,c=new Lt;return function(l,u,h,p,f,m){let A=this.zones[p].vertices,y=this.zones[p].groups[f],E=[h],x={};x[h.id]=0,s=void 0,c.set(0,0,0),o=1/0,e.setFromCoplanarPoints(A[h.vertexIds[0]],A[h.vertexIds[1]],A[h.vertexIds[2]]),e.projectPoint(u,n),i.copy(n);for(let v=E.pop();v;v=E.pop()){t.set(A[v.vertexIds[0]],A[v.vertexIds[1]],A[v.vertexIds[2]]),t.closestPointToPoint(i,n),n.distanceToSquared(i)<o&&(s=v,c.copy(n),o=n.distanceToSquared(i));let w=x[v.id];if(!(w>2))for(let M=0;M<v.neighbours.length;M++){let T=y[v.neighbours[M]];T.id in x||(E.push(T),x[T.id]=w+1)}}return m.copy(c),s}}();Dp={PLAYER:new cr(15631215).convertSRGBToLinear().getHex(),TARGET:new cr(14469912).convertSRGBToLinear().getHex(),PATH:new cr(41903).convertSRGBToLinear().getHex(),WAYPOINT:new cr(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new cr(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new cr(4417387).convertSRGBToLinear().getHex()},A2=class extends Sl{constructor(){super(),this._playerMarker=new yo(new jg(.25,32,32),new Ic({color:Dp.PLAYER})),this._targetMarker=new yo(new wl(.3,.3,.3),new Ic({color:Dp.TARGET})),this._nodeMarker=new yo(new wl(.1,.8,.1),new Ic({color:Dp.CLOSEST_NODE})),this._stepMarker=new yo(new wl(.1,1,.1),new Ic({color:Dp.CLAMPED_STEP})),this._pathMarker=new Sl,this._pathLineMaterial=new Wg({color:Dp.PATH,linewidth:2}),this._pathPointMaterial=new Ic({color:Dp.WAYPOINT}),this._pathPointGeometry=new jg(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(e=>{e.visible=!1,this.add(e)})}setPath(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);let t=new ka;t.setAttribute("position",new Bo(new Float32Array(3*e.length),3));for(let i=0;i<e.length;i++)t.attributes.position.setXYZ(i,e[i].x,e[i].y+.2,e[i].z);this._pathMarker.add(new dE(t,this._pathLineMaterial));for(let i=0;i<e.length-1;i++){let s=new yo(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(e[i]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this}setTargetPosition(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this}setNodePosition(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this}setStepPosition(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(e=>{e.visible=!1}),this}}});var e4=Cr((hme,ZU)=>{"use strict";var{Pathfinding:JU}=($U(),h1(KU)),Yg=new JU,Kg="level";ZU.exports=AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(n){this.navMesh=new THREE.Mesh(n),Yg.setZoneData(Kg,JU.createZone(n)),Array.from(this.agents).forEach(e=>e.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(n){this.agents.add(n)},removeAgent:function(n){this.agents.delete(n)},getPath:function(n,e,t){return this.navMesh?Yg.findPath(n,e,Kg,t):null},getGroup:function(n){return this.navMesh?Yg.getGroup(Kg,n):null},getNode:function(n,e){return this.navMesh?Yg.getClosestNode(n,Kg,e,!0):null},clampStep:function(n,e,t,i,s){if(this.navMesh){if(!i)return s.copy(e),this.getNode(e,t)}else return s.copy(e),null;return Yg.clampStep(n,e,i,Kg,t,s)}})});var t4=Cr(()=>{"use strict";eF();nF();e4()});var i4=Cr((pme,n4)=>{"use strict";n4.exports=AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}})});var r4=Cr((mme,v2)=>{"use strict";v2.exports.Primitive=AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});v2.exports.Component=AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){let n=this.el,e=this.data,t=n.components.material,i=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];let s=i.getAttribute("position");for(let o=0;o<s.count;o++)this.waves.push({z:s.getZ(o),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});t||(t={},t.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(i,t.material),n.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(n,e){if(!e)return;let t=this.mesh.geometry.getAttribute("position");for(let i=0;i<t.count;i++){let s=this.waves[i],o=s.z+Math.sin(s.ang)*s.amp;t.setZ(i,o),s.ang+=s.speed*e}t.needsUpdate=!0}})});var s4=Cr((gme,y2)=>{"use strict";y2.exports.Primitive=AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});y2.exports.Component=AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){let n=this.el,e=this.data,t=n.components.material;if(!e.path.length){console.error("[a-tube] `path` property expected but not found.");return}let i=new THREE.CatmullRomCurve3(e.path.map(function(o){return o=o.split(" "),new THREE.Vector3(Number(o[0]),Number(o[1]),Number(o[2]))})),s=new THREE.TubeGeometry(i,e.segments,e.radius,e.radialSegments,e.closed);t||(t={},t.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(s,t.material),this.el.setObject3D("mesh",this.mesh)},update:function(n){Object.keys(n).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}})});var o4=Cr(()=>{"use strict";i4();r4();s4()});var hR=null;var d1=1,dR=Symbol("SIGNAL");function ea(n){let e=hR;return hR=n,e}var fR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function T7(n){if(!(m1(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===d1)){if(!n.producerMustRecompute(n)&&!f1(n)){n.dirty=!1,n.lastCleanEpoch=d1;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=d1}}function pR(n){return n&&(n.nextProducerIndex=0),ea(n)}function mR(n,e){if(ea(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(m1(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)p1(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function f1(n){SA(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(T7(t),i!==t.version))return!0}return!1}function gR(n){if(SA(n),m1(n))for(let e=0;e<n.producerNode.length;e++)p1(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function p1(n,e){if(I7(n),SA(n),n.liveConsumerNode.length===1)for(let i=0;i<n.producerNode.length;i++)p1(n.producerNode[i],n.producerIndexOfThis[i]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let i=n.liveConsumerIndexOfThis[e],s=n.liveConsumerNode[e];SA(s),s.producerIndexOfThis[i]=e}}function m1(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function SA(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function I7(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function R7(){throw new Error}var D7=R7;function AR(n){D7=n}function Fi(n){return typeof n=="function"}function Ld(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var TA=Ld(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,s)=>`${s+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function gm(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Ts=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Fi(i))try{i()}catch(o){e=o instanceof TA?o.errors:[o]}let{_finalizers:s}=this;if(s){this._finalizers=null;for(let o of s)try{vR(o)}catch(c){e=e??[],c instanceof TA?e=[...e,...c.errors]:e.push(c)}}if(e)throw new TA(e)}}add(e){var t;if(e&&e!==this)if(this.closed)vR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&gm(t,e)}remove(e){let{_finalizers:t}=this;t&&gm(t,e),e instanceof n&&e._removeParent(this)}};Ts.EMPTY=(()=>{let n=new Ts;return n.closed=!0,n})();var g1=Ts.EMPTY;function IA(n){return n instanceof Ts||n&&"closed"in n&&Fi(n.remove)&&Fi(n.add)&&Fi(n.unsubscribe)}function vR(n){Fi(n)?n():n.unsubscribe()}var ja={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Pd={setTimeout(n,e,...t){let{delegate:i}=Pd;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Pd;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function RA(n){Pd.setTimeout(()=>{let{onUnhandledError:e}=ja;if(e)e(n);else throw n})}function Am(){}var yR=A1("C",void 0,void 0);function xR(n){return A1("E",void 0,n)}function ER(n){return A1("N",n,void 0)}function A1(n,e,t){return{kind:n,value:e,error:t}}var ah=null;function Bd(n){if(ja.useDeprecatedSynchronousErrorHandling){let e=!ah;if(e&&(ah={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=ah;if(ah=null,t)throw i}}else n()}function _R(n){ja.useDeprecatedSynchronousErrorHandling&&ah&&(ah.errorThrown=!0,ah.error=n)}var ch=class extends Ts{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,IA(e)&&e.add(this)):this.destination=B7}static create(e,t,i){return new Od(e,t,i)}next(e){this.isStopped?y1(ER(e),this):this._next(e)}error(e){this.isStopped?y1(xR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?y1(yR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},L7=Function.prototype.bind;function v1(n,e){return L7.call(n,e)}var x1=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){DA(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){DA(i)}else DA(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){DA(t)}}},Od=class extends ch{constructor(e,t,i){super();let s;if(Fi(e)||!e)s={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&ja.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),s={next:e.next&&v1(e.next,o),error:e.error&&v1(e.error,o),complete:e.complete&&v1(e.complete,o)}):s=e}this.destination=new x1(s)}};function DA(n){ja.useDeprecatedSynchronousErrorHandling?_R(n):RA(n)}function P7(n){throw n}function y1(n,e){let{onStoppedNotification:t}=ja;t&&Pd.setTimeout(()=>t(n,e))}var B7={closed:!0,next:Am,error:P7,complete:Am};var Nd=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ta(n){return n}function E1(...n){return _1(n)}function _1(n){return n.length===0?ta:n.length===1?n[0]:function(t){return n.reduce((i,s)=>s(i),t)}}var kr=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,s){let o=N7(t)?t:new Od(t,i,s);return Bd(()=>{let{operator:c,source:l}=this;o.add(c?c.call(o,l):l?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=bR(i),new i((s,o)=>{let c=new Od({next:l=>{try{t(l)}catch(u){o(u),c.unsubscribe()}},error:o,complete:s});this.subscribe(c)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Nd](){return this}pipe(...t){return _1(t)(this)}toPromise(t){return t=bR(t),new t((i,s)=>{let o;this.subscribe(c=>o=c,c=>s(c),()=>i(o))})}}return n.create=e=>new n(e),n})();function bR(n){var e;return(e=n??ja.Promise)!==null&&e!==void 0?e:Promise}function O7(n){return n&&Fi(n.next)&&Fi(n.error)&&Fi(n.complete)}function N7(n){return n&&n instanceof ch||O7(n)&&IA(n)}function b1(n){return Fi(n?.lift)}function yr(n){return e=>{if(b1(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function xr(n,e,t,i,s){return new M1(n,e,t,i,s)}var M1=class extends ch{constructor(e,t,i,s,o,c){super(e),this.onFinalize=o,this.shouldUnsubscribe=c,this._next=t?function(l){try{t(l)}catch(u){e.error(u)}}:super._next,this._error=s?function(l){try{s(l)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Fd(){return yr((n,e)=>{let t=null;n._refCount++;let i=xr(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let s=n._connection,o=t;t=null,s&&(!o||s===o)&&s.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var Ud=class extends kr{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,b1(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ts;let t=this.getSubject();e.add(this.source.subscribe(xr(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ts.EMPTY)}return e}refCount(){return Fd()(this)}};var MR=Ld(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var na=(()=>{class n extends kr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new LA(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new MR}next(t){Bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:s,observers:o}=this;return i||s?g1:(this.currentObservers=null,o.push(t),new Ts(()=>{this.currentObservers=null,gm(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:s,isStopped:o}=this;i?t.error(s):o&&t.complete()}asObservable(){let t=new kr;return t.source=this,t}}return n.create=(e,t)=>new LA(e,t),n})(),LA=class extends na{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:g1}};var Ks=class extends na{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var va=new kr(n=>n.complete());function wR(n){return n&&Fi(n.schedule)}function CR(n){return n[n.length-1]}function SR(n){return Fi(CR(n))?n.pop():void 0}function Hl(n){return wR(CR(n))?n.pop():void 0}function IR(n,e,t,i){function s(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function l(p){try{h(i.next(p))}catch(f){c(f)}}function u(p){try{h(i.throw(p))}catch(f){c(f)}}function h(p){p.done?o(p.value):s(p.value).then(l,u)}h((i=i.apply(n,e||[])).next())})}function TR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lh(n){return this instanceof lh?(this.v=n,this):new lh(n)}function RR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,o=[];return s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s;function c(m){i[m]&&(s[m]=function(A){return new Promise(function(y,E){o.push([m,A,y,E])>1||l(m,A)})})}function l(m,A){try{u(i[m](A))}catch(y){f(o[0][3],y)}}function u(m){m.value instanceof lh?Promise.resolve(m.value.v).then(h,p):f(o[0][2],m)}function h(m){l("next",m)}function p(m){l("throw",m)}function f(m,A){m(A),o.shift(),o.length&&l(o[0][0],o[0][1])}}function DR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof TR=="function"?TR(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(c){return new Promise(function(l,u){c=n[o](c),s(l,u,c.done,c.value)})}}function s(o,c,l,u){Promise.resolve(u).then(function(h){o({value:h,done:l})},c)}}var PA=n=>n&&typeof n.length=="number"&&typeof n!="function";function BA(n){return Fi(n?.then)}function OA(n){return Fi(n[Nd])}function NA(n){return Symbol.asyncIterator&&Fi(n?.[Symbol.asyncIterator])}function FA(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function F7(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var UA=F7();function kA(n){return Fi(n?.[UA])}function VA(n){return RR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:s}=yield lh(t.read());if(s)return yield lh(void 0);yield yield lh(i)}}finally{t.releaseLock()}})}function HA(n){return Fi(n?.getReader)}function zs(n){if(n instanceof kr)return n;if(n!=null){if(OA(n))return U7(n);if(PA(n))return k7(n);if(BA(n))return V7(n);if(NA(n))return LR(n);if(kA(n))return H7(n);if(HA(n))return z7(n)}throw FA(n)}function U7(n){return new kr(e=>{let t=n[Nd]();if(Fi(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function k7(n){return new kr(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function V7(n){return new kr(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,RA)})}function H7(n){return new kr(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function LR(n){return new kr(e=>{G7(n,e).catch(t=>e.error(t))})}function z7(n){return LR(VA(n))}function G7(n,e){var t,i,s,o;return IR(this,void 0,void 0,function*(){try{for(t=DR(n);i=yield t.next(),!i.done;){let c=i.value;if(e.next(c),e.closed)return}}catch(c){s={error:c}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(s)throw s.error}}e.complete()})}function zo(n,e,t,i=0,s=!1){let o=e.schedule(function(){t(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!s)return o}function zA(n,e=0){return yr((t,i)=>{t.subscribe(xr(i,s=>zo(i,n,()=>i.next(s),e),()=>zo(i,n,()=>i.complete(),e),s=>zo(i,n,()=>i.error(s),e)))})}function GA(n,e=0){return yr((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function PR(n,e){return zs(n).pipe(GA(e),zA(e))}function BR(n,e){return zs(n).pipe(GA(e),zA(e))}function OR(n,e){return new kr(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function NR(n,e){return new kr(t=>{let i;return zo(t,e,()=>{i=n[UA](),zo(t,e,()=>{let s,o;try{({value:s,done:o}=i.next())}catch(c){t.error(c);return}o?t.complete():t.next(s)},0,!0)}),()=>Fi(i?.return)&&i.return()})}function WA(n,e){if(!n)throw new Error("Iterable cannot be null");return new kr(t=>{zo(t,e,()=>{let i=n[Symbol.asyncIterator]();zo(t,e,()=>{i.next().then(s=>{s.done?t.complete():t.next(s.value)})},0,!0)})})}function FR(n,e){return WA(VA(n),e)}function UR(n,e){if(n!=null){if(OA(n))return PR(n,e);if(PA(n))return OR(n,e);if(BA(n))return BR(n,e);if(NA(n))return WA(n,e);if(kA(n))return NR(n,e);if(HA(n))return FR(n,e)}throw FA(n)}function Is(n,e){return e?UR(n,e):zs(n)}function Hi(...n){let e=Hl(n);return Is(n,e)}function kd(n,e){let t=Fi(n)?n:()=>n,i=s=>s.error(t());return new kr(e?s=>e.schedule(i,0,s):i)}function w1(n){return!!n&&(n instanceof kr||Fi(n.lift)&&Fi(n.subscribe))}var Gc=Ld(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Er(n,e){return yr((t,i)=>{let s=0;t.subscribe(xr(i,o=>{i.next(n.call(e,o,s++))}))})}var{isArray:W7}=Array;function j7(n,e){return W7(e)?n(...e):n(e)}function kR(n){return Er(e=>j7(n,e))}var{isArray:Q7}=Array,{getPrototypeOf:X7,prototype:q7,keys:Y7}=Object;function VR(n){if(n.length===1){let e=n[0];if(Q7(e))return{args:e,keys:null};if(K7(e)){let t=Y7(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function K7(n){return n&&typeof n=="object"&&X7(n)===q7}function HR(n,e){return n.reduce((t,i,s)=>(t[i]=e[s],t),{})}function jA(...n){let e=Hl(n),t=SR(n),{args:i,keys:s}=VR(n);if(i.length===0)return Is([],e);let o=new kr($7(i,e,s?c=>HR(s,c):ta));return t?o.pipe(kR(t)):o}function $7(n,e,t=ta){return i=>{zR(e,()=>{let{length:s}=n,o=new Array(s),c=s,l=s;for(let u=0;u<s;u++)zR(e,()=>{let h=Is(n[u],e),p=!1;h.subscribe(xr(i,f=>{o[u]=f,p||(p=!0,l--),l||i.next(t(o.slice()))},()=>{--c||i.complete()}))},i)},i)}}function zR(n,e,t){n?zo(t,n,e):e()}function GR(n,e,t,i,s,o,c,l){let u=[],h=0,p=0,f=!1,m=()=>{f&&!u.length&&!h&&e.complete()},A=E=>h<i?y(E):u.push(E),y=E=>{o&&e.next(E),h++;let x=!1;zs(t(E,p++)).subscribe(xr(e,v=>{s?.(v),o?A(v):e.next(v)},()=>{x=!0},void 0,()=>{if(x)try{for(h--;u.length&&h<i;){let v=u.shift();c?zo(e,c,()=>y(v)):y(v)}m()}catch(v){e.error(v)}}))};return n.subscribe(xr(e,A,()=>{f=!0,m()})),()=>{l?.()}}function Rs(n,e,t=1/0){return Fi(e)?Rs((i,s)=>Er((o,c)=>e(i,o,s,c))(zs(n(i,s))),t):(typeof e=="number"&&(t=e),yr((i,s)=>GR(i,s,n,t)))}function C1(n=1/0){return Rs(ta,n)}function WR(){return C1(1)}function Vd(...n){return WR()(Is(n,Hl(n)))}function QA(n){return new kr(e=>{zs(n()).subscribe(e)})}function Qa(n,e){return yr((t,i)=>{let s=0;t.subscribe(xr(i,o=>n.call(e,o,s++)&&i.next(o)))})}function zl(n){return yr((e,t)=>{let i=null,s=!1,o;i=e.subscribe(xr(t,void 0,void 0,c=>{o=zs(n(c,zl(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):s=!0})),s&&(i.unsubscribe(),i=null,o.subscribe(t))})}function jR(n,e,t,i,s){return(o,c)=>{let l=t,u=e,h=0;o.subscribe(xr(c,p=>{let f=h++;u=l?n(u,p,f):(l=!0,p),i&&c.next(u)},s&&(()=>{l&&c.next(u),c.complete()})))}}function Hd(n,e){return Fi(e)?Rs(n,e,1):Rs(n,1)}function Gl(n){return yr((e,t)=>{let i=!1;e.subscribe(xr(t,s=>{i=!0,t.next(s)},()=>{i||t.next(n),t.complete()}))})}function Wc(n){return n<=0?()=>va:yr((e,t)=>{let i=0;e.subscribe(xr(t,s=>{++i<=n&&(t.next(s),n<=i&&t.complete())}))})}function S1(n){return Er(()=>n)}function XA(n=J7){return yr((e,t)=>{let i=!1;e.subscribe(xr(t,s=>{i=!0,t.next(s)},()=>i?t.complete():t.error(n())))})}function J7(){return new Gc}function vm(n){return yr((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function mc(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Qa((s,o)=>n(s,o,i)):ta,Wc(1),t?Gl(e):XA(()=>new Gc))}function zd(n){return n<=0?()=>va:yr((e,t)=>{let i=[];e.subscribe(xr(t,s=>{i.push(s),n<i.length&&i.shift()},()=>{for(let s of i)t.next(s);t.complete()},void 0,()=>{i=null}))})}function T1(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Qa((s,o)=>n(s,o,i)):ta,zd(1),t?Gl(e):XA(()=>new Gc))}function I1(n,e){return yr(jR(n,e,arguments.length>=2,!0))}function R1(...n){let e=Hl(n);return yr((t,i)=>{(e?Vd(n,t,e):Vd(n,t)).subscribe(i)})}function Xa(n,e){return yr((t,i)=>{let s=null,o=0,c=!1,l=()=>c&&!s&&i.complete();t.subscribe(xr(i,u=>{s?.unsubscribe();let h=0,p=o++;zs(n(u,p)).subscribe(s=xr(i,f=>i.next(e?e(u,f,p,h++):f),()=>{s=null,l()}))},()=>{c=!0,l()}))})}function D1(n){return yr((e,t)=>{zs(n).subscribe(xr(t,()=>t.complete(),Am)),!t.closed&&e.subscribe(t)})}function Gs(n,e,t){let i=Fi(n)||e||t?{next:n,error:e,complete:t}:n;return i?yr((s,o)=>{var c;(c=i.subscribe)===null||c===void 0||c.call(i);let l=!0;s.subscribe(xr(o,u=>{var h;(h=i.next)===null||h===void 0||h.call(i,u),o.next(u)},()=>{var u;l=!1,(u=i.complete)===null||u===void 0||u.call(i),o.complete()},u=>{var h;l=!1,(h=i.error)===null||h===void 0||h.call(i,u),o.error(u)},()=>{var u,h;l&&((u=i.unsubscribe)===null||u===void 0||u.call(i)),(h=i.finalize)===null||h===void 0||h.call(i)}))}):ta}var ki=class extends Error{constructor(e,t){super(Tb(e,t)),this.code=e}};function Tb(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function jr(n){for(let e in n)if(n[e]===jr)return e;throw Error("Could not find renamed property on target object.")}function ia(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(ia).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function QR(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var Z7=jr({__forward_ref__:jr});function C3(n){return n.__forward_ref__=C3,n.toString=function(){return ia(this())},n}function To(n){return S3(n)?n():n}function S3(n){return typeof n=="function"&&n.hasOwnProperty(Z7)&&n.__forward_ref__===C3}function T3(n){return n&&!!n.\u0275providers}var eH=jr({\u0275cmp:jr}),tH=jr({\u0275dir:jr}),nH=jr({\u0275pipe:jr}),iH=jr({\u0275mod:jr}),ev=jr({\u0275fac:jr}),ym=jr({__NG_ELEMENT_ID__:jr}),XR=jr({__NG_ENV_ID__:jr});function I3(n){return typeof n=="string"?n:n==null?"":String(n)}function rH(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():I3(n)}function sH(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ki(-200,`Circular dependency in DI detected for ${n}${t}`)}function Ib(n,e){throw new ki(-201,!1)}function oH(n,e){n==null&&aH(e,n,null,"!=")}function aH(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(i==null?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}function Xi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function mv(n){return{providers:n.providers||[],imports:n.imports||[]}}function gv(n){return qR(n,D3)||qR(n,L3)}function R3(n){return gv(n)!==null}function qR(n,e){return n.hasOwnProperty(e)?n[e]:null}function cH(n){let e=n&&(n[D3]||n[L3]);return e||null}function YR(n){return n&&(n.hasOwnProperty(KR)||n.hasOwnProperty(lH))?n[KR]:null}var D3=jr({\u0275prov:jr}),KR=jr({\u0275inj:jr}),L3=jr({ngInjectableDef:jr}),lH=jr({ngInjectorDef:jr}),sr=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(sr||{}),W1;function uH(){return W1}function ya(n){let e=W1;return W1=n,e}function P3(n,e,t){let i=gv(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&sr.Optional)return null;if(e!==void 0)return e;Ib(n,"Injector")}var xm=globalThis;var _r=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Xi({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var hH={},bm=hH,dH="__NG_DI_FLAG__",tv="ngTempTokenPath",fH="ngTokenPath",pH=/\n/gm,mH="\u0275",$R="__source",Em;function Wl(n){let e=Em;return Em=n,e}function gH(n,e=sr.Default){if(Em===void 0)throw new ki(-203,!1);return Em===null?P3(n,void 0,e):Em.get(n,e&sr.Optional?null:void 0,e)}function mr(n,e=sr.Default){return(uH()||gH)(To(n),e)}function si(n,e=sr.Default){return mr(n,Av(e))}function Av(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function j1(n){let e=[];for(let t=0;t<n.length;t++){let i=To(n[t]);if(Array.isArray(i)){if(i.length===0)throw new ki(900,!1);let s,o=sr.Default;for(let c=0;c<i.length;c++){let l=i[c],u=AH(l);typeof u=="number"?u===-1?s=l.token:o|=u:s=l}e.push(mr(s,o))}else e.push(mr(i))}return e}function AH(n){return n[dH]}function vH(n,e,t,i){let s=n[tv];throw e[$R]&&s.unshift(e[$R]),n.message=yH(`
`+n.message,s,t,i),n[fH]=s,n[tv]=null,n}function yH(n,e,t,i=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==mH?n.slice(2):n;let s=ia(e);if(Array.isArray(e))s=e.map(ia).join(" -> ");else if(typeof e=="object"){let o=[];for(let c in e)if(e.hasOwnProperty(c)){let l=e[c];o.push(c+":"+(typeof l=="string"?JSON.stringify(l):ia(l)))}s=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${s}]: ${n.replace(pH,`
  `)}`}function vv(n){return{toString:n}.toString()}var B3=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(B3||{}),xc=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(xc||{}),Mm={},gc=[],jl=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(jl||{});function O3(n,e,t){let i=n.length;for(;;){let s=n.indexOf(e,t);if(s===-1)return s;if(s===0||n.charCodeAt(s-1)<=32){let o=e.length;if(s+o===i||n.charCodeAt(s+o)<=32)return s}t=s+1}}function Q1(n,e,t){let i=0;for(;i<t.length;){let s=t[i];if(typeof s=="number"){if(s!==0)break;i++;let o=t[i++],c=t[i++],l=t[i++];n.setAttribute(e,c,l,o)}else{let o=s,c=t[++i];EH(o)?n.setProperty(e,o,c):n.setAttribute(e,o,c),i++}}return i}function xH(n){return n===3||n===4||n===6}function EH(n){return n.charCodeAt(0)===64}function Rb(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let s=e[i];typeof s=="number"?t=s:t===0||(t===-1||t===2?JR(n,t,s,null,e[++i]):JR(n,t,s,null,null))}}return n}function JR(n,e,t,i,s){let o=0,c=n.length;if(e===-1)c=-1;else for(;o<n.length;){let l=n[o++];if(typeof l=="number"){if(l===e){c=-1;break}else if(l>e){c=o-1;break}}}for(;o<n.length;){let l=n[o];if(typeof l=="number")break;if(l===t){if(i===null){s!==null&&(n[o+1]=s);return}else if(i===n[o+1]){n[o+2]=s;return}}o++,i!==null&&o++,s!==null&&o++}c!==-1&&(n.splice(c,0,e),o=c+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i),s!==null&&n.splice(o++,0,s)}var N3="ng-template";function _H(n,e,t){let i=0,s=!0;for(;i<n.length;){let o=n[i++];if(typeof o=="string"&&s){let c=n[i++];if(t&&o==="class"&&O3(c.toLowerCase(),e,0)!==-1)return!0}else if(o===1){for(;i<n.length&&typeof(o=n[i++])=="string";)if(o.toLowerCase()===e)return!0;return!1}else typeof o=="number"&&(s=!1)}return!1}function F3(n){return n.type===4&&n.value!==N3}function bH(n,e,t){let i=n.type===4&&!t?N3:n.value;return e===i}function MH(n,e,t){let i=4,s=n.attrs||[],o=SH(s),c=!1;for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="number"){if(!c&&!qa(i)&&!qa(u))return!1;if(c&&qa(u))continue;c=!1,i=u|i&1;continue}if(!c)if(i&4){if(i=2|i&1,u!==""&&!bH(n,u,t)||u===""&&e.length===1){if(qa(i))return!1;c=!0}}else{let h=i&8?u:e[++l];if(i&8&&n.attrs!==null){if(!_H(n.attrs,h,t)){if(qa(i))return!1;c=!0}continue}let p=i&8?"class":u,f=wH(p,s,F3(n),t);if(f===-1){if(qa(i))return!1;c=!0;continue}if(h!==""){let m;f>o?m="":m=s[f+1].toLowerCase();let A=i&8?m:null;if(A&&O3(A,h,0)!==-1||i&2&&h!==m){if(qa(i))return!1;c=!0}}}}return qa(i)||c}function qa(n){return(n&1)===0}function wH(n,e,t,i){if(e===null)return-1;let s=0;if(i||!t){let o=!1;for(;s<e.length;){let c=e[s];if(c===n)return s;if(c===3||c===6)o=!0;else if(c===1||c===2){let l=e[++s];for(;typeof l=="string";)l=e[++s];continue}else{if(c===4)break;if(c===0){s+=4;continue}}s+=o?1:2}return-1}else return TH(e,n)}function CH(n,e,t=!1){for(let i=0;i<e.length;i++)if(MH(n,e[i],t))return!0;return!1}function SH(n){for(let e=0;e<n.length;e++){let t=n[e];if(xH(t))return e}return n.length}function TH(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function ZR(n,e){return n?":not("+e.trim()+")":e}function IH(n){let e=n[0],t=1,i=2,s="",o=!1;for(;t<n.length;){let c=n[t];if(typeof c=="string")if(i&2){let l=n[++t];s+="["+c+(l.length>0?'="'+l+'"':"")+"]"}else i&8?s+="."+c:i&4&&(s+=" "+c);else s!==""&&!qa(c)&&(e+=ZR(o,s),s=""),i=c,o=o||!qa(i);t++}return s!==""&&(e+=ZR(o,s)),e}function RH(n){return n.map(IH).join(",")}function DH(n){let e=[],t=[],i=1,s=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")s===2?o!==""&&e.push(o,n[++i]):s===8&&t.push(o);else{if(!qa(s))break;s=o}i++}return{attrs:e,classes:t}}function yv(n){return vv(()=>{let e=z3(n),t=As(di({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===B3.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||xc.Emulated,styles:n.styles||gc,_:null,schemas:n.schemas||null,tView:null,id:""});G3(t);let i=n.dependencies;return t.directiveDefs=t3(i,!1),t.pipeDefs=t3(i,!0),t.id=BH(t),t})}function LH(n){return hh(n)||U3(n)}function PH(n){return n!==null}function xv(n){return vv(()=>({type:n.type,bootstrap:n.bootstrap||gc,declarations:n.declarations||gc,imports:n.imports||gc,exports:n.exports||gc,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function e3(n,e){if(n==null)return Mm;let t={};for(let i in n)if(n.hasOwnProperty(i)){let s=n[i],o,c,l=jl.None;Array.isArray(s)?(l=s[0],o=s[1],c=s[2]??o):(o=s,c=s),e?(t[o]=l!==jl.None?[i,l]:i,e[o]=c):t[o]=i}return t}function Db(n){return vv(()=>{let e=z3(n);return G3(e),e})}function hh(n){return n[eH]||null}function U3(n){return n[tH]||null}function k3(n){return n[nH]||null}function V3(n){let e=hh(n)||U3(n)||k3(n);return e!==null?e.standalone:!1}function H3(n,e){let t=n[iH]||null;if(!t&&e===!0)throw new Error(`Type ${ia(n)} does not have '\u0275mod' property.`);return t}function z3(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Mm,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||gc,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:e3(n.inputs,e),outputs:e3(n.outputs),debugInfo:null}}function G3(n){n.features?.forEach(e=>e(n))}function t3(n,e){if(!n)return null;let t=e?k3:LH;return()=>(typeof n=="function"?n():n).map(i=>t(i)).filter(PH)}function BH(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let s of t)e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Xc=0,or=1,Ui=2,$s=3,Ya=4,Ka=5,nv=6,wm=7,jc=8,qd=9,Ql=10,Ea=11,Cm=12,n3=13,Bm=14,Ec=15,Om=16,Gd=17,yc=18,Ev=19,W3=20,_m=21,L1=22,dh=23,fh=25,j3=1;var ph=7,iv=8,Yd=9,ra=10,Lb=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Lb||{});function Qd(n){return Array.isArray(n)&&typeof n[j3]=="object"}function qc(n){return Array.isArray(n)&&n[j3]===!0}function Q3(n){return(n.flags&4)!==0}function Pb(n){return n.componentOffset>-1}function X3(n){return(n.flags&1)===1}function ef(n){return!!n.template}function OH(n){return(n[Ui]&512)!==0}function Kd(n,e){let t=n.hasOwnProperty(ev);return t?n[ev]:null}var X1=class{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function q3(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}function _v(){return Y3}function Y3(n){return n.type.prototype.ngOnChanges&&(n.setInput=FH),NH}_v.ngInherit=!0;function NH(){let n=$3(this),e=n?.current;if(e){let t=n.previous;if(t===Mm)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function FH(n,e,t,i,s){let o=this.declaredInputs[i],c=$3(n)||UH(n,{previous:Mm,current:null}),l=c.current||(c.current={}),u=c.previous,h=u[o];l[o]=new X1(h&&h.currentValue,t,u===Mm),q3(n,e,s,t)}var K3="__ngSimpleChanges__";function $3(n){return n[K3]||null}function UH(n,e){return n[K3]=e}var i3=null;var Ac=function(n,e,t){i3?.(n,e,t)},kH="svg",VH="math",HH=!1;function zH(){return HH}function _c(n){for(;Array.isArray(n);)n=n[Xc];return n}function GH(n,e){return _c(e[n])}function bc(n,e){return _c(e[n.index])}function WH(n,e){return n.data[e]}function tf(n,e){let t=e[n];return Qd(t)?t:t[Xc]}function jH(n){return(n[Ui]&4)===4}function Bb(n){return(n[Ui]&128)===128}function QH(n){return qc(n[$s])}function r3(n,e){return e==null?null:n[e]}function J3(n){n[Gd]=0}function XH(n){n[Ui]&1024||(n[Ui]|=1024,Bb(n)&&Sm(n))}function Z3(n){return n[Ui]&9216||n[dh]?.dirty}function q1(n){Z3(n)?Sm(n):n[Ui]&64&&(zH()?(n[Ui]|=1024,Sm(n)):n[Ql].changeDetectionScheduler?.notify())}function Sm(n){n[Ql].changeDetectionScheduler?.notify();let e=Tm(n);for(;e!==null&&!(e[Ui]&8192||(e[Ui]|=8192,!Bb(e)));)e=Tm(e)}function qH(n,e){if((n[Ui]&256)===256)throw new ki(911,!1);n[_m]===null&&(n[_m]=[]),n[_m].push(e)}function Tm(n){let e=n[$s];return qc(e)?e[$s]:e}var Or={lFrame:oD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function YH(){return Or.lFrame.elementDepthCount}function KH(){Or.lFrame.elementDepthCount++}function $H(){Or.lFrame.elementDepthCount--}function eD(){return Or.bindingsEnabled}function JH(){return Or.skipHydrationRootTNode!==null}function ZH(n){return Or.skipHydrationRootTNode===n}function ez(){Or.skipHydrationRootTNode=null}function Ws(){return Or.lFrame.lView}function Yc(){return Or.lFrame.tView}function $a(){let n=tD();for(;n!==null&&n.type===64;)n=n.parent;return n}function tD(){return Or.lFrame.currentTNode}function tz(){let n=Or.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function bv(n,e){let t=Or.lFrame;t.currentTNode=n,t.isParent=e}function nD(){return Or.lFrame.isParent}function nz(){Or.lFrame.isParent=!1}function iz(n){return Or.lFrame.bindingIndex=n}function rz(){return Or.lFrame.bindingIndex++}function sz(){return Or.lFrame.inI18n}function oz(n,e){let t=Or.lFrame;t.bindingIndex=t.bindingRootIndex=n,Y1(e)}function az(){return Or.lFrame.currentDirectiveIndex}function Y1(n){Or.lFrame.currentDirectiveIndex=n}function iD(){return Or.lFrame.currentQueryIndex}function Ob(n){Or.lFrame.currentQueryIndex=n}function cz(n){let e=n[or];return e.type===2?e.declTNode:e.type===1?n[Ka]:null}function rD(n,e,t){if(t&sr.SkipSelf){let s=e,o=n;for(;s=s.parent,s===null&&!(t&sr.Host);)if(s=cz(o),s===null||(o=o[Bm],s.type&10))break;if(s===null)return!1;e=s,n=o}let i=Or.lFrame=sD();return i.currentTNode=e,i.lView=n,!0}function Nb(n){let e=sD(),t=n[or];Or.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function sD(){let n=Or.lFrame,e=n===null?null:n.child;return e===null?oD(n):e}function oD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function aD(){let n=Or.lFrame;return Or.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var cD=aD;function Fb(){let n=aD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ub(){return Or.lFrame.selectedIndex}function mh(n){Or.lFrame.selectedIndex=n}function lz(){return Or.lFrame.currentNamespace}var lD=!0;function uD(){return lD}function hD(n){lD=n}function uz(n,e,t){let{ngOnChanges:i,ngOnInit:s,ngDoCheck:o}=e.type.prototype;if(i){let c=Y3(e);(t.preOrderHooks??=[]).push(n,c),(t.preOrderCheckHooks??=[]).push(n,c)}s&&(t.preOrderHooks??=[]).push(0-n,s),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function dD(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:c,ngAfterContentChecked:l,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:p}=o;c&&(n.contentHooks??=[]).push(-t,c),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),u&&(n.viewHooks??=[]).push(-t,u),h&&((n.viewHooks??=[]).push(t,h),(n.viewCheckHooks??=[]).push(t,h)),p!=null&&(n.destroyHooks??=[]).push(t,p)}}function qA(n,e,t){fD(n,e,3,t)}function YA(n,e,t,i){(n[Ui]&3)===t&&fD(n,e,t,i)}function P1(n,e){let t=n[Ui];(t&3)===e&&(t&=16383,t+=1,n[Ui]=t)}function fD(n,e,t,i){let s=i!==void 0?n[Gd]&65535:0,o=i??-1,c=e.length-1,l=0;for(let u=s;u<c;u++)if(typeof e[u+1]=="number"){if(l=e[u],i!=null&&l>=i)break}else e[u]<0&&(n[Gd]+=65536),(l<o||o==-1)&&(hz(n,t,e,u),n[Gd]=(n[Gd]&4294901760)+u+2),u++}function s3(n,e){Ac(4,n,e);let t=ea(null);try{e.call(n)}finally{ea(t),Ac(5,n,e)}}function hz(n,e,t,i){let s=t[i]<0,o=t[i+1],c=s?-t[i]:t[i],l=n[c];s?n[Ui]>>14<n[Gd]>>16&&(n[Ui]&3)===e&&(n[Ui]+=16384,s3(l,o)):s3(l,o)}var Xd=-1,gh=class{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}};function dz(n){return n instanceof gh}function fz(n){return(n.flags&8)!==0}function pz(n){return(n.flags&16)!==0}function pD(n){return n!==Xd}function rv(n){return n&32767}function mz(n){return n>>16}function sv(n,e){let t=mz(n),i=e;for(;t>0;)i=i[Bm],t--;return i}var K1=!0;function o3(n){let e=K1;return K1=n,e}var gz=256,mD=gz-1,gD=5,Az=0,vc={};function vz(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(ym)&&(i=t[ym]),i==null&&(i=t[ym]=Az++);let s=i&mD,o=1<<s;e.data[n+(s>>gD)]|=o}function ov(n,e){let t=AD(n,e);if(t!==-1)return t;let i=e[or];i.firstCreatePass&&(n.injectorIndex=e.length,B1(i.data,n),B1(e,null),B1(i.blueprint,null));let s=kb(n,e),o=n.injectorIndex;if(pD(s)){let c=rv(s),l=sv(s,e),u=l[or].data;for(let h=0;h<8;h++)e[o+h]=l[c+h]|u[c+h]}return e[o+8]=s,o}function B1(n,e){n.push(0,0,0,0,0,0,0,0,e)}function AD(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function kb(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,s=e;for(;s!==null;){if(i=_D(s),i===null)return Xd;if(t++,s=s[Bm],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Xd}function $1(n,e,t){vz(n,e,t)}function vD(n,e,t){if(t&sr.Optional||n!==void 0)return n;Ib(e,"NodeInjector")}function yD(n,e,t,i){if(t&sr.Optional&&i===void 0&&(i=null),!(t&(sr.Self|sr.Host))){let s=n[qd],o=ya(void 0);try{return s?s.get(e,i,t&sr.Optional):P3(e,i,t&sr.Optional)}finally{ya(o)}}return vD(i,e,t)}function xD(n,e,t,i=sr.Default,s){if(n!==null){if(e[Ui]&2048&&!(i&sr.Self)){let c=_z(n,e,t,i,vc);if(c!==vc)return c}let o=ED(n,e,t,i,vc);if(o!==vc)return o}return yD(e,t,i,s)}function ED(n,e,t,i,s){let o=xz(t);if(typeof o=="function"){if(!rD(e,n,i))return i&sr.Host?vD(s,t,i):yD(e,t,i,s);try{let c;if(c=o(i),c==null&&!(i&sr.Optional))Ib(t);else return c}finally{cD()}}else if(typeof o=="number"){let c=null,l=AD(n,e),u=Xd,h=i&sr.Host?e[Ec][Ka]:null;for((l===-1||i&sr.SkipSelf)&&(u=l===-1?kb(n,e):e[l+8],u===Xd||!c3(i,!1)?l=-1:(c=e[or],l=rv(u),e=sv(u,e)));l!==-1;){let p=e[or];if(a3(o,l,p.data)){let f=yz(l,e,t,c,i,h);if(f!==vc)return f}u=e[l+8],u!==Xd&&c3(i,e[or].data[l+8]===h)&&a3(o,l,e)?(c=p,l=rv(u),e=sv(u,e)):l=-1}}return s}function yz(n,e,t,i,s,o){let c=e[or],l=c.data[n+8],u=i==null?Pb(l)&&K1:i!=c&&(l.type&3)!==0,h=s&sr.Host&&o===l,p=KA(l,c,t,u,h);return p!==null?Ah(e,c,p,l):vc}function KA(n,e,t,i,s){let o=n.providerIndexes,c=e.data,l=o&1048575,u=n.directiveStart,h=n.directiveEnd,p=o>>20,f=i?l:l+p,m=s?l+p:h;for(let A=f;A<m;A++){let y=c[A];if(A<u&&t===y||A>=u&&y.type===t)return A}if(s){let A=c[u];if(A&&ef(A)&&A.type===t)return u}return null}function Ah(n,e,t,i){let s=n[t],o=e.data;if(dz(s)){let c=s;c.resolving&&sH(rH(o[t]));let l=o3(c.canSeeViewProviders);c.resolving=!0;let u,h=c.injectImpl?ya(c.injectImpl):null,p=rD(n,i,sr.Default);try{s=n[t]=c.factory(void 0,o,n,i),e.firstCreatePass&&t>=i.directiveStart&&uz(t,o[t],e)}finally{h!==null&&ya(h),o3(l),c.resolving=!1,cD()}}return s}function xz(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ym)?n[ym]:void 0;return typeof e=="number"?e>=0?e&mD:Ez:e}function a3(n,e,t){let i=1<<n;return!!(t[e+(n>>gD)]&i)}function c3(n,e){return!(n&sr.Self)&&!(n&sr.Host&&e)}var uh=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return xD(this._tNode,this._lView,e,Av(i),t)}};function Ez(){return new uh($a(),Ws())}function Vb(n){return vv(()=>{let e=n.prototype.constructor,t=e[ev]||J1(e),i=Object.prototype,s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==i;){let o=s[ev]||J1(s);if(o&&o!==t)return o;s=Object.getPrototypeOf(s)}return o=>new o})}function J1(n){return S3(n)?()=>{let e=J1(To(n));return e&&e()}:Kd(n)}function _z(n,e,t,i,s){let o=n,c=e;for(;o!==null&&c!==null&&c[Ui]&2048&&!(c[Ui]&512);){let l=ED(o,c,t,i|sr.Self,vc);if(l!==vc)return l;let u=o.parent;if(!u){let h=c[W3];if(h){let p=h.get(t,vc,i);if(p!==vc)return p}u=_D(c),c=c[Bm]}o=u}return s}function _D(n){let e=n[or],t=e.type;return t===2?e.declTNode:t===1?n[Ka]:null}function bz(n){return typeof n=="function"}function Mz(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let s=n[i],o=e[i];if(t&&(s=t(s),o=t(o)),o!==s)return!1}return!0}function wz(n){return n.flat(Number.POSITIVE_INFINITY)}function Hb(n,e){n.forEach(t=>Array.isArray(t)?Hb(t,e):e(t))}function bD(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function av(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var $d=new _r("ENVIRONMENT_INITIALIZER"),MD=new _r("INJECTOR",-1),wD=new _r("INJECTOR_DEF_TYPES"),cv=class{get(e,t=bm){if(t===bm){let i=new Error(`NullInjectorError: No provider for ${ia(e)}!`);throw i.name="NullInjectorError",i}return t}};function Mv(n){return{\u0275providers:n}}function Cz(...n){return{\u0275providers:CD(!0,n),\u0275fromNgModule:!0}}function CD(n,...e){let t=[],i=new Set,s,o=c=>{t.push(c)};return Hb(e,c=>{let l=c;Z1(l,o,[],i)&&(s||=[],s.push(l))}),s!==void 0&&SD(s,o),t}function SD(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:s}=n[t];zb(s,o=>{e(o,i)})}}function Z1(n,e,t,i){if(n=To(n),!n)return!1;let s=null,o=YR(n),c=!o&&hh(n);if(!o&&!c){let u=n.ngModule;if(o=YR(u),o)s=u;else return!1}else{if(c&&!c.standalone)return!1;s=n}let l=i.has(s);if(c){if(l)return!1;if(i.add(s),c.dependencies){let u=typeof c.dependencies=="function"?c.dependencies():c.dependencies;for(let h of u)Z1(h,e,t,i)}}else if(o){if(o.imports!=null&&!l){i.add(s);let h;try{Hb(o.imports,p=>{Z1(p,e,t,i)&&(h||=[],h.push(p))})}finally{}h!==void 0&&SD(h,e)}if(!l){let h=Kd(s)||(()=>new s);e({provide:s,useFactory:h,deps:gc},s),e({provide:wD,useValue:s,multi:!0},s),e({provide:$d,useValue:()=>mr(s),multi:!0},s)}let u=o.providers;if(u!=null&&!l){let h=n;zb(u,p=>{e(p,h)})}}else return!1;return s!==n&&n.providers!==void 0}function zb(n,e){for(let t of n)T3(t)&&(t=t.\u0275providers),Array.isArray(t)?zb(t,e):e(t)}var Sz=jr({provide:String,useValue:jr});function TD(n){return n!==null&&typeof n=="object"&&Sz in n}function Tz(n){return!!(n&&n.useExisting)}function Iz(n){return!!(n&&n.useFactory)}function Jd(n){return typeof n=="function"}function Rz(n){return!!n.useClass}var wv=new _r("Set Injector scope."),$A={},Dz={},O1;function Gb(){return O1===void 0&&(O1=new cv),O1}var _a=class{},Im=class extends _a{get destroyed(){return this._destroyed}constructor(e,t,i,s){super(),this.parent=t,this.source=i,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,tb(e,c=>this.processProvider(c)),this.records.set(MD,Wd(void 0,this)),s.has("environment")&&this.records.set(_a,Wd(void 0,this));let o=this.records.get(wv);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(wD,gc,sr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let t of this._ngOnDestroyHooks)t.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Wl(this),i=ya(void 0),s;try{return e()}finally{Wl(t),ya(i)}}get(e,t=bm,i=sr.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(XR))return e[XR](this);i=Av(i);let s,o=Wl(this),c=ya(void 0);try{if(!(i&sr.SkipSelf)){let u=this.records.get(e);if(u===void 0){let h=Nz(e)&&gv(e);h&&this.injectableDefInScope(h)?u=Wd(eb(e),$A):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let l=i&sr.Self?Gb():this.parent;return t=i&sr.Optional&&t===bm?null:t,l.get(e,t)}catch(l){if(l.name==="NullInjectorError"){if((l[tv]=l[tv]||[]).unshift(ia(e)),o)throw l;return vH(l,e,"R3InjectorError",this.source)}else throw l}finally{ya(c),Wl(o)}}resolveInjectorInitializers(){let e=Wl(this),t=ya(void 0),i;try{let s=this.get($d,gc,sr.Self);for(let o of s)o()}finally{Wl(e),ya(t)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(ia(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ki(205,!1)}processProvider(e){e=To(e);let t=Jd(e)?e:To(e&&e.provide),i=Pz(e);if(!Jd(e)&&e.multi===!0){let s=this.records.get(t);s||(s=Wd(void 0,$A,!0),s.factory=()=>j1(s.multi),this.records.set(t,s)),t=e,s.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===$A&&(t.value=Dz,t.value=t.factory()),typeof t.value=="object"&&t.value&&Oz(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;let t=To(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function eb(n){let e=gv(n),t=e!==null?e.factory:Kd(n);if(t!==null)return t;if(n instanceof _r)throw new ki(204,!1);if(n instanceof Function)return Lz(n);throw new ki(204,!1)}function Lz(n){if(n.length>0)throw new ki(204,!1);let t=cH(n);return t!==null?()=>t.factory(n):()=>new n}function Pz(n){if(TD(n))return Wd(void 0,n.useValue);{let e=ID(n);return Wd(e,$A)}}function ID(n,e,t){let i;if(Jd(n)){let s=To(n);return Kd(s)||eb(s)}else if(TD(n))i=()=>To(n.useValue);else if(Iz(n))i=()=>n.useFactory(...j1(n.deps||[]));else if(Tz(n))i=()=>mr(To(n.useExisting));else{let s=To(n&&(n.useClass||n.provide));if(Bz(n))i=()=>new s(...j1(n.deps));else return Kd(s)||eb(s)}return i}function Wd(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Bz(n){return!!n.deps}function Oz(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Nz(n){return typeof n=="function"||typeof n=="object"&&n instanceof _r}function tb(n,e){for(let t of n)Array.isArray(t)?tb(t,e):t&&T3(t)?tb(t.\u0275providers,e):e(t)}function yh(n,e){n instanceof Im&&n.assertNotDestroyed();let t,i=Wl(n),s=ya(void 0);try{return e()}finally{Wl(i),ya(s)}}function l3(n,e=null,t=null,i){let s=RD(n,e,t,i);return s.resolveInjectorInitializers(),s}function RD(n,e=null,t=null,i,s=new Set){let o=[t||gc,Cz(n)];return i=i||(typeof n=="object"?void 0:ia(n)),new Im(o,e||Gb(),i||null,s)}var nf=(()=>{let e=class e{static create(i,s){if(Array.isArray(i))return l3({name:""},s,i,"");{let o=i.name??"";return l3({name:o},i.parent,i.providers,o)}}};e.THROW_IF_NOT_FOUND=bm,e.NULL=new cv,e.\u0275prov=Xi({token:e,providedIn:"any",factory:()=>mr(MD)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var nb;function DD(n){nb=n}function Fz(){if(nb!==void 0)return nb;if(typeof document<"u")return document;throw new ki(210,!1)}var Wb=new _r("AppId",{providedIn:"root",factory:()=>Uz}),Uz="ng",jb=new _r("Platform Initializer"),rf=new _r("Platform ID",{providedIn:"platform",factory:()=>"unknown"});var Qb=new _r("CSP nonce",{providedIn:"root",factory:()=>Fz().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function LD(n){return n instanceof Function?n():n}function PD(n){return(n.flags&128)===128}var xh=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(xh||{});var BD=new Map,kz=0;function Vz(){return kz++}function Hz(n){BD.set(n[Ev],n)}function zz(n){BD.delete(n[Ev])}var u3="__ngContext__";function Zd(n,e){Qd(e)?(n[u3]=e[Ev],Hz(e)):n[u3]=e}var Gz;function Xb(n,e){return Gz(n,e)}function jd(n,e,t,i,s){if(i!=null){let o,c=!1;qc(i)?o=i:Qd(i)&&(c=!0,i=i[Xc]);let l=_c(i);n===0&&t!==null?s==null?kD(e,t,l):lv(e,t,l,s||null,!0):n===1&&t!==null?lv(e,t,l,s||null,!0):n===2?oG(e,l,c):n===3&&e.destroyNode(l),o!=null&&cG(e,n,o,t,s)}}function Wz(n,e){return n.createText(e)}function jz(n,e,t){n.setValue(e,t)}function OD(n,e,t){return n.createElement(e,t)}function Qz(n,e){ND(n,e),e[Xc]=null,e[Ka]=null}function Xz(n,e,t,i,s,o){i[Xc]=s,i[Ka]=e,Cv(n,i,t,1,s,o)}function ND(n,e){Cv(n,e,e[Ea],2,null,null)}function qz(n){let e=n[Cm];if(!e)return N1(n[or],n);for(;e;){let t=null;if(Qd(e))t=e[Cm];else{let i=e[ra];i&&(t=i)}if(!t){for(;e&&!e[Ya]&&e!==n;)Qd(e)&&N1(e[or],e),e=e[$s];e===null&&(e=n),Qd(e)&&N1(e[or],e),t=e&&e[Ya]}e=t}}function Yz(n,e,t,i){let s=ra+i,o=t.length;i>0&&(t[s-1][Ya]=e),i<o-ra?(e[Ya]=t[s],bD(t,ra+i,e)):(t.push(e),e[Ya]=null),e[$s]=t;let c=e[Om];c!==null&&t!==c&&Kz(c,e);let l=e[yc];l!==null&&l.insertView(n),q1(e),e[Ui]|=128}function Kz(n,e){let t=n[Yd],s=e[$s][$s][Ec];e[Ec]!==s&&(n[Ui]|=Lb.HasTransplantedViews),t===null?n[Yd]=[e]:t.push(e)}function FD(n,e){let t=n[Yd],i=t.indexOf(e);t.splice(i,1)}function ib(n,e){if(n.length<=ra)return;let t=ra+e,i=n[t];if(i){let s=i[Om];s!==null&&s!==n&&FD(s,i),e>0&&(n[t-1][Ya]=i[Ya]);let o=av(n,ra+e);Qz(i[or],i);let c=o[yc];c!==null&&c.detachView(o[or]),i[$s]=null,i[Ya]=null,i[Ui]&=-129}return i}function UD(n,e){if(!(e[Ui]&256)){let t=e[Ea];t.destroyNode&&Cv(n,e,t,3,null,null),qz(e)}}function N1(n,e){if(!(e[Ui]&256)){e[Ui]&=-129,e[Ui]|=256,e[dh]&&gR(e[dh]),Jz(n,e),$z(n,e),e[or].type===1&&e[Ea].destroy();let t=e[Om];if(t!==null&&qc(e[$s])){t!==e[$s]&&FD(t,e);let i=e[yc];i!==null&&i.detachView(n)}zz(e)}}function $z(n,e){let t=n.cleanup,i=e[wm];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let c=t[o+3];c>=0?i[c]():i[-c].unsubscribe(),o+=2}else{let c=i[t[o+1]];t[o].call(c)}i!==null&&(e[wm]=null);let s=e[_m];if(s!==null){e[_m]=null;for(let o=0;o<s.length;o++){let c=s[o];c()}}}function Jz(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let s=e[t[i]];if(!(s instanceof gh)){let o=t[i+1];if(Array.isArray(o))for(let c=0;c<o.length;c+=2){let l=s[o[c]],u=o[c+1];Ac(4,l,u);try{u.call(l)}finally{Ac(5,l,u)}}else{Ac(4,s,o);try{o.call(s)}finally{Ac(5,s,o)}}}}}function Zz(n,e,t){return eG(n,e.parent,t)}function eG(n,e,t){let i=e;for(;i!==null&&i.type&40;)e=i,i=e.parent;if(i===null)return t[Xc];{let{componentOffset:s}=i;if(s>-1){let{encapsulation:o}=n.data[i.directiveStart+s];if(o===xc.None||o===xc.Emulated)return null}return bc(i,t)}}function lv(n,e,t,i,s){n.insertBefore(e,t,i,s)}function kD(n,e,t){n.appendChild(e,t)}function h3(n,e,t,i,s){i!==null?lv(n,e,t,i,s):kD(n,e,t)}function tG(n,e,t,i){n.removeChild(e,t,i)}function qb(n,e){return n.parentNode(e)}function nG(n,e){return n.nextSibling(e)}function iG(n,e,t){return sG(n,e,t)}function rG(n,e,t){return n.type&40?bc(n,t):null}var sG=rG,d3;function VD(n,e,t,i){let s=Zz(n,i,e),o=e[Ea],c=i.parent||e[Ka],l=iG(c,i,e);if(s!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)h3(o,s,t[u],l,!1);else h3(o,s,t,l,!1);d3!==void 0&&d3(o,i,e,t,s)}function JA(n,e){if(e!==null){let t=e.type;if(t&3)return bc(e,n);if(t&4)return rb(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return JA(n,i);{let s=n[e.index];return qc(s)?rb(-1,s):_c(s)}}else{if(t&32)return Xb(e,n)()||_c(n[e.index]);{let i=HD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let s=Tm(n[Ec]);return JA(s,i)}else return JA(n,e.next)}}}return null}function HD(n,e){if(e!==null){let i=n[Ec][Ka],s=e.projection;return i.projection[s]}return null}function rb(n,e){let t=ra+n+1;if(t<e.length){let i=e[t],s=i[or].firstChild;if(s!==null)return JA(i,s)}return e[ph]}function oG(n,e,t){let i=qb(n,e);i&&tG(n,i,e,t)}function Yb(n,e,t,i,s,o,c){for(;t!=null;){let l=i[t.index],u=t.type;if(c&&e===0&&(l&&Zd(_c(l),i),t.flags|=2),(t.flags&32)!==32)if(u&8)Yb(n,e,t.child,i,s,o,!1),jd(e,n,s,l,o);else if(u&32){let h=Xb(t,i),p;for(;p=h();)jd(e,n,s,p,o);jd(e,n,s,l,o)}else u&16?aG(n,e,i,t,s,o):jd(e,n,s,l,o);t=c?t.projectionNext:t.next}}function Cv(n,e,t,i,s,o){Yb(t,i,n.firstChild,e,s,o,!1)}function aG(n,e,t,i,s,o){let c=t[Ec],u=c[Ka].projection[i.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++){let p=u[h];jd(e,n,s,p,o)}else{let h=u,p=c[$s];PD(i)&&(h.flags|=128),Yb(n,e,h,p,s,o,!0)}}function cG(n,e,t,i,s){let o=t[ph],c=_c(t);o!==c&&jd(e,n,i,o,s);for(let l=ra;l<t.length;l++){let u=t[l];Cv(u[or],u,n,e,i,o)}}function lG(n,e,t){n.setAttribute(e,"style",t)}function zD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function GD(n,e,t){let{mergedAttrs:i,classes:s,styles:o}=t;i!==null&&Q1(n,e,i),s!==null&&zD(n,e,s),o!==null&&lG(n,e,o)}var sb=class{};var uG="h",hG="b";var dG=()=>null;function Kb(n,e,t=!1){return dG(n,e,t)}var ob=class{},uv=class{};function fG(n){let e=Error(`No component factory found for ${ia(n)}.`);return e[pG]=n,e}var pG="ngComponent";var ab=class{resolveComponentFactory(e){throw fG(e)}},Sv=(()=>{let e=class e{};e.NULL=new ab;let n=e;return n})();function mG(){return sf($a(),Ws())}function sf(n,e){return new Eh(bc(n,e))}var Eh=(()=>{let e=class e{constructor(i){this.nativeElement=i}};e.__NG_ELEMENT_ID__=mG;let n=e;return n})();function gG(n){return n instanceof Eh?n.nativeElement:n}var Rm=class{};var AG=(()=>{let e=class e{};e.\u0275prov=Xi({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),F1={};function hv(n,e,t,i,s=!1){for(;t!==null;){let o=e[t.index];o!==null&&i.push(_c(o)),qc(o)&&vG(o,i);let c=t.type;if(c&8)hv(n,e,t.child,i);else if(c&32){let l=Xb(t,e),u;for(;u=l();)i.push(u)}else if(c&16){let l=HD(e,t);if(Array.isArray(l))i.push(...l);else{let u=Tm(e[Ec]);hv(u[or],u,l,i,!0)}}t=s?t.projectionNext:t.next}return i}function vG(n,e){for(let t=ra;t<n.length;t++){let i=n[t],s=i[or].firstChild;s!==null&&hv(i[or],i,s,e)}n[ph]!==n[Xc]&&e.push(n[ph])}var WD=[];function yG(n){return n[dh]??xG(n)}function xG(n){let e=WD.pop()??Object.create(_G);return e.lView=n,e}function EG(n){n.lView[dh]!==n&&(n.lView=null,WD.push(n))}var _G=As(di({},fR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Sm(n.lView)},consumerOnSignalRead(){this.lView[dh]=this}});function jD(n){return XD(n[Cm])}function QD(n){return XD(n[Ya])}function XD(n){for(;n!==null&&!qc(n);)n=n[Ya];return n}var bG="ngOriginalError";function U1(n){return n[bG]}var Qc=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&U1(e);for(;t&&U1(t);)t=U1(t);return t||null}},qD=new _r("",{providedIn:"root",factory:()=>si(Qc).handleError.bind(void 0)});var YD=!1,MG=new _r("",{providedIn:"root",factory:()=>YD});var Tv={};function KD(n=1){$D(Yc(),Ws(),Ub()+n,!1)}function $D(n,e,t,i){if(!i)if((e[Ui]&3)===3){let o=n.preOrderCheckHooks;o!==null&&qA(e,o,t)}else{let o=n.preOrderHooks;o!==null&&YA(e,o,0,t)}mh(t)}function Nm(n,e=sr.Default){let t=Ws();if(t===null)return mr(n,e);let i=$a();return xD(i,t,To(n),e)}function JD(n,e,t,i,s,o){let c=ea(null);try{let l=null;s&jl.SignalBased&&(l=e[i][dR]),l!==null&&l.transformFn!==void 0&&(o=l.transformFn(o)),s&jl.HasDecoratorInputTransform&&(o=n.inputTransforms[i].call(e,o)),n.setInput!==null?n.setInput(e,l,o,t,i):q3(e,l,i,o)}finally{ea(c)}}function wG(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let s=t[i];if(s<0)mh(~s);else{let o=s,c=t[++i],l=t[++i];oz(c,o);let u=e[o];l(2,u)}}}finally{mh(-1)}}function Iv(n,e,t,i,s,o,c,l,u,h,p){let f=e.blueprint.slice();return f[Xc]=s,f[Ui]=i|4|128|8|64,(h!==null||n&&n[Ui]&2048)&&(f[Ui]|=2048),J3(f),f[$s]=f[Bm]=n,f[jc]=t,f[Ql]=c||n&&n[Ql],f[Ea]=l||n&&n[Ea],f[qd]=u||n&&n[qd]||null,f[Ka]=o,f[Ev]=Vz(),f[nv]=p,f[W3]=h,f[Ec]=e.type==2?n[Ec]:f,f}function $b(n,e,t,i,s){let o=n.data[e];if(o===null)o=CG(n,e,t,i,s),sz()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=s;let c=tz();o.injectorIndex=c===null?-1:c.injectorIndex}return bv(o,!0),o}function CG(n,e,t,i,s){let o=tD(),c=nD(),l=c?o:o&&o.parent,u=n.data[e]=BG(n,l,t,e,i,s);return n.firstChild===null&&(n.firstChild=u),o!==null&&(c?o.child==null&&u.parent!==null&&(o.child=u):o.next===null&&(o.next=u,u.prev=o)),u}function ZD(n,e,t,i){if(t===0)return-1;let s=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return s}function eL(n,e,t,i,s){let o=Ub(),c=i&2;try{mh(-1),c&&e.length>fh&&$D(n,e,fh,!1),Ac(c?2:0,s),t(i,s)}finally{mh(o),Ac(c?3:1,s)}}function tL(n,e,t){if(Q3(e)){let i=ea(null);try{let s=e.directiveStart,o=e.directiveEnd;for(let c=s;c<o;c++){let l=n.data[c];l.contentQueries&&l.contentQueries(1,t[c],c)}}finally{ea(i)}}}function SG(n,e,t){eD()&&(kG(n,e,t,bc(t,e)),(t.flags&64)===64&&sL(n,e,t))}function TG(n,e,t=bc){let i=e.localNames;if(i!==null){let s=e.index+1;for(let o=0;o<i.length;o+=2){let c=i[o+1],l=c===-1?t(e,n):n[c];n[s++]=l}}}function nL(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=iL(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function iL(n,e,t,i,s,o,c,l,u,h,p){let f=fh+i,m=f+s,A=IG(f,m),y=typeof h=="function"?h():h;return A[or]={type:n,blueprint:A,template:t,queries:null,viewQuery:l,declTNode:e,data:A.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof c=="function"?c():c,firstChild:null,schemas:u,consts:y,incompleteFirstPass:!1,ssrId:p}}function IG(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Tv);return t}function RG(n,e,t,i){let o=i.get(MG,YD)||t===xc.ShadowDom,c=n.selectRootElement(e,o);return DG(c),c}function DG(n){LG(n)}var LG=()=>null;function PG(n,e,t,i){let s=aL(e);s.push(t),n.firstCreatePass&&cL(n).push(i,s.length-1)}function BG(n,e,t,i,s,o){let c=e?e.injectorIndex:-1,l=0;return JH()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:c,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:s,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function f3(n,e,t,i,s){for(let o in e){if(!e.hasOwnProperty(o))continue;let c=e[o];if(c===void 0)continue;i??={};let l,u=jl.None;Array.isArray(c)?(l=c[0],u=c[1]):l=c;let h=o;if(s!==null){if(!s.hasOwnProperty(o))continue;h=s[o]}n===0?p3(i,t,h,l,u):p3(i,t,h,l)}return i}function p3(n,e,t,i,s){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,i):o=n[t]=[e,i],s!==void 0&&o.push(s)}function OG(n,e,t){let i=e.directiveStart,s=e.directiveEnd,o=n.data,c=e.attrs,l=[],u=null,h=null;for(let p=i;p<s;p++){let f=o[p],m=t?t.get(f):null,A=m?m.inputs:null,y=m?m.outputs:null;u=f3(0,f.inputs,p,u,A),h=f3(1,f.outputs,p,h,y);let E=u!==null&&c!==null&&!F3(e)?qG(u,p,c):null;l.push(E)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=l,e.inputs=u,e.outputs=h}function NG(n,e,t,i){if(eD()){let s=i===null?null:{"":-1},o=HG(n,t),c,l;o===null?c=l=null:[c,l]=o,c!==null&&rL(n,e,t,c,s,l),s&&zG(t,i,s)}t.mergedAttrs=Rb(t.mergedAttrs,t.attrs)}function rL(n,e,t,i,s,o){for(let h=0;h<i.length;h++)$1(ov(t,e),n,i[h].type);WG(t,n.data.length,i.length);for(let h=0;h<i.length;h++){let p=i[h];p.providersResolver&&p.providersResolver(p)}let c=!1,l=!1,u=ZD(n,e,i.length,null);for(let h=0;h<i.length;h++){let p=i[h];t.mergedAttrs=Rb(t.mergedAttrs,p.hostAttrs),jG(n,t,e,u,p),GG(u,p,s),p.contentQueries!==null&&(t.flags|=4),(p.hostBindings!==null||p.hostAttrs!==null||p.hostVars!==0)&&(t.flags|=64);let f=p.type.prototype;!c&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),l=!0),u++}OG(n,t,o)}function FG(n,e,t,i,s){let o=s.hostBindings;if(o){let c=n.hostBindingOpCodes;c===null&&(c=n.hostBindingOpCodes=[]);let l=~e.index;UG(c)!=l&&c.push(l),c.push(t,i,o)}}function UG(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function kG(n,e,t,i){let s=t.directiveStart,o=t.directiveEnd;Pb(t)&&QG(e,t,n.data[s+t.componentOffset]),n.firstCreatePass||ov(t,e),Zd(i,e);let c=t.initialInputs;for(let l=s;l<o;l++){let u=n.data[l],h=Ah(e,n,l,t);if(Zd(h,e),c!==null&&XG(e,l-s,h,u,t,c),ef(u)){let p=tf(t.index,e);p[jc]=Ah(e,n,l,t)}}}function sL(n,e,t){let i=t.directiveStart,s=t.directiveEnd,o=t.index,c=az();try{mh(o);for(let l=i;l<s;l++){let u=n.data[l],h=e[l];Y1(l),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&VG(u,h)}}finally{mh(-1),Y1(c)}}function VG(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function HG(n,e){let t=n.directiveRegistry,i=null,s=null;if(t)for(let o=0;o<t.length;o++){let c=t[o];if(CH(e,c.selectors,!1))if(i||(i=[]),ef(c))if(c.findHostDirectiveDefs!==null){let l=[];s=s||new Map,c.findHostDirectiveDefs(c,l,s),i.unshift(...l,c);let u=l.length;cb(n,e,u)}else i.unshift(c),cb(n,e,0);else s=s||new Map,c.findHostDirectiveDefs?.(c,i,s),i.push(c)}return i===null?null:[i,s]}function cb(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function zG(n,e,t){if(e){let i=n.localNames=[];for(let s=0;s<e.length;s+=2){let o=t[e[s+1]];if(o==null)throw new ki(-301,!1);i.push(e[s],o)}}}function GG(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ef(e)&&(t[""]=n)}}function WG(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function jG(n,e,t,i,s){n.data[i]=s;let o=s.factory||(s.factory=Kd(s.type,!0)),c=new gh(o,ef(s),Nm);n.blueprint[i]=c,t[i]=c,FG(n,e,i,ZD(n,t,s.hostVars,Tv),s)}function QG(n,e,t){let i=bc(e,n),s=nL(t),o=n[Ql].rendererFactory,c=16;t.signals?c=4096:t.onPush&&(c=64);let l=Jb(n,Iv(n,s,null,c,i,e,null,o.createRenderer(i,t),null,null,null));n[e.index]=l}function XG(n,e,t,i,s,o){let c=o[e];if(c!==null)for(let l=0;l<c.length;){let u=c[l++],h=c[l++],p=c[l++],f=c[l++];JD(i,t,u,h,p,f)}}function qG(n,e,t){let i=null,s=0;for(;s<t.length;){let o=t[s];if(o===0){s+=4;continue}else if(o===5){s+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){i===null&&(i=[]);let c=n[o];for(let l=0;l<c.length;l+=3)if(c[l]===e){i.push(o,c[l+1],c[l+2],t[s+1]);break}}s+=2}return i}function YG(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function oL(n,e){let t=n.contentQueries;if(t!==null){let i=ea(null);try{for(let s=0;s<t.length;s+=2){let o=t[s],c=t[s+1];if(c!==-1){let l=n.data[c];Ob(o),l.contentQueries(2,e[c],c)}}}finally{ea(i)}}}function Jb(n,e){return n[Cm]?n[n3][Ya]=e:n[Cm]=e,n[n3]=e,e}function lb(n,e,t){Ob(0);let i=ea(null);try{e(n,t)}finally{ea(i)}}function aL(n){return n[wm]||(n[wm]=[])}function cL(n){return n.cleanup||(n.cleanup=[])}function lL(n,e){let t=n[qd],i=t?t.get(Qc,null):null;i&&i.handleError(e)}function uL(n,e,t,i,s){for(let o=0;o<t.length;){let c=t[o++],l=t[o++],u=t[o++],h=e[c],p=n.data[c];JD(p,h,i,l,u,s)}}function KG(n,e,t){let i=GH(e,n);jz(n[Ea],i,t)}var $G=100;function JG(n,e=!0){let t=n[Ql],i=t.rendererFactory,s=!1;s||i.begin?.();try{ZG(n)}catch(o){throw e&&lL(n,o),o}finally{s||(i.end?.(),t.inlineEffectRunner?.flush())}}function ZG(n){ub(n,0);let e=0;for(;Z3(n);){if(e===$G)throw new ki(103,!1);e++,ub(n,1)}}function e9(n,e,t,i){let s=e[Ui];if((s&256)===256)return;let o=!1;!o&&e[Ql].inlineEffectRunner?.flush(),Nb(e);let c=null,l=null;!o&&t9(n)&&(l=yG(e),c=pR(l));try{J3(e),iz(n.bindingStartIndex),t!==null&&eL(n,e,t,2,i);let u=(s&3)===3;if(!o)if(u){let f=n.preOrderCheckHooks;f!==null&&qA(e,f,null)}else{let f=n.preOrderHooks;f!==null&&YA(e,f,0,null),P1(e,0)}if(n9(e),hL(e,0),n.contentQueries!==null&&oL(n,e),!o)if(u){let f=n.contentCheckHooks;f!==null&&qA(e,f)}else{let f=n.contentHooks;f!==null&&YA(e,f,1),P1(e,1)}wG(n,e);let h=n.components;h!==null&&fL(e,h,0);let p=n.viewQuery;if(p!==null&&lb(2,p,i),!o)if(u){let f=n.viewCheckHooks;f!==null&&qA(e,f)}else{let f=n.viewHooks;f!==null&&YA(e,f,2),P1(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[L1]){for(let f of e[L1])f();e[L1]=null}o||(e[Ui]&=-73)}catch(u){throw Sm(e),u}finally{l!==null&&(mR(l,c),EG(l)),Fb()}}function t9(n){return n.type!==2}function hL(n,e){for(let t=jD(n);t!==null;t=QD(t))for(let i=ra;i<t.length;i++){let s=t[i];dL(s,e)}}function n9(n){for(let e=jD(n);e!==null;e=QD(e)){if(!(e[Ui]&Lb.HasTransplantedViews))continue;let t=e[Yd];for(let i=0;i<t.length;i++){let s=t[i],o=s[$s];XH(s)}}}function i9(n,e,t){let i=tf(e,n);dL(i,t)}function dL(n,e){Bb(n)&&ub(n,e)}function ub(n,e){let i=n[or],s=n[Ui],o=n[dh],c=!!(e===0&&s&16);if(c||=!!(s&64&&e===0),c||=!!(s&1024),c||=!!(o?.dirty&&f1(o)),o&&(o.dirty=!1),n[Ui]&=-9217,c)e9(i,n,i.template,n[jc]);else if(s&8192){hL(n,1);let l=i.components;l!==null&&fL(n,l,1)}}function fL(n,e,t){for(let i=0;i<e.length;i++)i9(n,e[i],t)}function Zb(n){for(n[Ql].changeDetectionScheduler?.notify();n;){n[Ui]|=64;let e=Tm(n);if(OH(n)&&!e)return n;n=e}return null}var vh=class{get rootNodes(){let e=this._lView,t=e[or];return hv(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[jc]}set context(e){this._lView[jc]=e}get destroyed(){return(this._lView[Ui]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[$s];if(qc(e)){let t=e[iv],i=t?t.indexOf(this):-1;i>-1&&(ib(e,i),av(t,i))}this._attachedToViewContainer=!1}UD(this._lView[or],this._lView)}onDestroy(e){qH(this._lView,e)}markForCheck(){Zb(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ui]&=-129}reattach(){q1(this._lView),this._lView[Ui]|=128}detectChanges(){this._lView[Ui]|=1024,JG(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ki(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,ND(this._lView[or],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ki(902,!1);this._appRef=e,q1(this._lView)}},Rv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=r9;let n=e;return n})();function r9(n){return s9($a(),Ws(),(n&16)===16)}function s9(n,e,t){if(Pb(n)&&!t){let i=tf(n.index,e);return new vh(i,i)}else if(n.type&47){let i=e[Ec];return new vh(i,e)}return null}var m3=new Set;function pL(n){m3.has(n)||(m3.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var hb=class extends na{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let s=e,o=t||(()=>null),c=i;if(e&&typeof e=="object"){let u=e;s=u.next?.bind(u),o=u.error?.bind(u),c=u.complete?.bind(u)}this.__isAsync&&(o=k1(o),s&&(s=k1(s)),c&&(c=k1(c)));let l=super.subscribe({next:s,error:o,complete:c});return e instanceof Ts&&e.add(l),l}};function k1(n){return e=>{setTimeout(n,void 0,e)}}var xa=hb;function g3(...n){}function o9(){let n=typeof xm.requestAnimationFrame=="function",e=xm[n?"requestAnimationFrame":"setTimeout"],t=xm[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);let s=t[Zone.__symbol__("OriginalDelegate")];s&&(t=s)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var vs=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xa(!1),this.onMicrotaskEmpty=new xa(!1),this.onStable=new xa(!1),this.onError=new xa(!1),typeof Zone>"u")throw new ki(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&t,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=o9().nativeRequestAnimationFrame,l9(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ki(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ki(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,s){let o=this._inner,c=o.scheduleEventTask("NgZoneEvent: "+s,e,a9,g3,g3);try{return o.runTask(c,t,i)}finally{o.cancelTask(c)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},a9={};function eM(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function c9(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(xm,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,db(n),n.isCheckStableRunning=!0,eM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),db(n))}function l9(n){let e=()=>{c9(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,s,o,c,l)=>{if(u9(l))return t.invokeTask(s,o,c,l);try{return A3(n),t.invokeTask(s,o,c,l)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),v3(n)}},onInvoke:(t,i,s,o,c,l,u)=>{try{return A3(n),t.invoke(s,o,c,l,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),v3(n)}},onHasTask:(t,i,s,o)=>{t.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,db(n),eM(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,i,s,o)=>(t.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function db(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function A3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function v3(n){n._nesting--,eM(n)}function u9(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}var mL=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let i=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let o of i)o();return!!this.handler?.execute()||i.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=Xi({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function h9(n,e){let t=tf(e,n),i=t[or];d9(i,t);let s=t[Xc];s!==null&&t[nv]===null&&(t[nv]=Kb(s,t[qd])),tM(i,t,t[jc])}function d9(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function tM(n,e,t){Nb(e);try{let i=n.viewQuery;i!==null&&lb(1,i,t);let s=n.template;s!==null&&eL(n,e,s,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&oL(n,e),n.staticViewQueries&&lb(2,n.viewQuery,t);let o=n.components;o!==null&&f9(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ui]&=-5,Fb()}}function f9(n,e){for(let t=0;t<e.length;t++)h9(n,e[t])}function fb(n,e,t){let i=t?n.styles:null,s=t?n.classes:null,o=0;if(e!==null)for(let c=0;c<e.length;c++){let l=e[c];if(typeof l=="number")o=l;else if(o==1)s=QR(s,l);else if(o==2){let u=l,h=e[++c];i=QR(i,u+": "+h+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=s:n.classesWithoutHost=s}var dv=class extends Sv{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=hh(e);return new Dm(t,this.ngModule)}};function y3(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let i=n[t];i!==void 0&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:t})}return e}function p9(n){let e=n.toLowerCase();return e==="svg"?kH:e==="math"?VH:null}var pb=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Av(i);let s=this.injector.get(e,F1,i);return s!==F1||t===F1?s:this.parentInjector.get(e,t,i)}},Dm=class extends uv{get inputs(){let e=this.componentDef,t=e.inputTransforms,i=y3(e.inputs);if(t!==null)for(let s of i)t.hasOwnProperty(s.propName)&&(s.transform=t[s.propName]);return i}get outputs(){return y3(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=RH(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,s){s=s||this.ngModule;let o=s instanceof _a?s:s?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let c=o?new pb(e,o):e,l=c.get(Rm,null);if(l===null)throw new ki(407,!1);let u=c.get(AG,null),h=c.get(mL,null),p=c.get(sb,null),f={rendererFactory:l,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:h,changeDetectionScheduler:p},m=l.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",y=i?RG(m,i,this.componentDef.encapsulation,c):OD(m,A,p9(A)),E=512;this.componentDef.signals?E|=4096:this.componentDef.onPush||(E|=16);let x=null;y!==null&&(x=Kb(y,c,!0));let v=iL(0,null,null,1,0,null,null,null,null,null,null),w=Iv(null,v,null,E,null,null,f,m,c,null,x);Nb(w);let M,T;try{let D=this.componentDef,L,I=null;D.findHostDirectiveDefs?(L=[],I=new Map,D.findHostDirectiveDefs(D,L,I),L.push(D)):L=[D];let F=m9(w,y),R=g9(F,y,D,L,w,f,m);T=WH(v,fh),y&&y9(m,D,y,i),t!==void 0&&x9(T,this.ngContentSelectors,t),M=v9(R,D,L,I,w,[E9]),tM(v,w,null)}finally{Fb()}return new mb(this.componentType,M,sf(T,w),w,T)}},mb=class extends ob{constructor(e,t,i,s,o){super(),this.location=i,this._rootLView=s,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new vh(s,void 0,!1),this.componentType=e}setInput(e,t){let i=this._tNode.inputs,s;if(i!==null&&(s=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;uL(o[or],o,s,e,t),this.previousInputValues.set(e,t);let c=tf(this._tNode.index,o);Zb(c)}}get injector(){return new uh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function m9(n,e){let t=n[or],i=fh;return n[i]=e,$b(t,i,2,"#host",null)}function g9(n,e,t,i,s,o,c){let l=s[or];A9(i,n,e,c);let u=null;e!==null&&(u=Kb(e,s[qd]));let h=o.rendererFactory.createRenderer(e,t),p=16;t.signals?p=4096:t.onPush&&(p=64);let f=Iv(s,nL(t),null,p,s[n.index],n,o,h,null,null,u);return l.firstCreatePass&&cb(l,n,i.length-1),Jb(s,f),s[n.index]=f}function A9(n,e,t,i){for(let s of n)e.mergedAttrs=Rb(e.mergedAttrs,s.hostAttrs);e.mergedAttrs!==null&&(fb(e,e.mergedAttrs,!0),t!==null&&GD(i,t,e))}function v9(n,e,t,i,s,o){let c=$a(),l=s[or],u=bc(c,s);rL(l,s,c,t,null,i);for(let p=0;p<t.length;p++){let f=c.directiveStart+p,m=Ah(s,l,f,c);Zd(m,s)}sL(l,s,c),u&&Zd(u,s);let h=Ah(s,l,c.directiveStart+c.componentOffset,c);if(n[jc]=s[jc]=h,o!==null)for(let p of o)p(h,e);return tL(l,c,n),h}function y9(n,e,t,i){if(i)Q1(n,t,["ng-version","17.1.1"]);else{let{attrs:s,classes:o}=DH(e.selectors[0]);s&&Q1(n,t,s),o&&o.length>0&&zD(n,t,o.join(" "))}}function x9(n,e,t){let i=n.projection=[];for(let s=0;s<e.length;s++){let o=t[s];i.push(o!=null?Array.from(o):null)}}function E9(){let n=$a();dD(Ws()[or],n)}var Bde=new RegExp(`^(\\d+)*(${hG}|${uG})*(.*)`);var _9=()=>null;function x3(n,e){return _9(n,e)}function b9(n,e,t,i){let s=e.tView,c=n[Ui]&4096?4096:16,l=Iv(n,s,t,c,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null),u=n[e.index];l[Om]=u;let h=n[yc];return h!==null&&(l[yc]=h.createEmbeddedView(s)),tM(s,l,t),l}function E3(n,e){return!e||e.firstChild===null||PD(n)}function M9(n,e,t,i=!0){let s=e[or];if(Yz(s,e,n,t),i){let c=rb(t,n),l=e[Ea],u=qb(l,n[ph]);u!==null&&Xz(s,n[Ka],l,e,u,c)}let o=e[nv];o!==null&&o.firstChild!==null&&(o.firstChild=null)}var of=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=w9;let n=e;return n})();function w9(){let n=$a();return AL(n,Ws())}var C9=of,gL=class extends C9{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return sf(this._hostTNode,this._hostLView)}get injector(){return new uh(this._hostTNode,this._hostLView)}get parentInjector(){let e=kb(this._hostTNode,this._hostLView);if(pD(e)){let t=sv(e,this._hostLView),i=rv(e),s=t[or].data[i+8];return new uh(s,t)}else return new uh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=_3(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ra}createEmbeddedView(e,t,i){let s,o;typeof i=="number"?s=i:i!=null&&(s=i.index,o=i.injector);let c=x3(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},o,c);return this.insertImpl(l,s,E3(this._hostTNode,c)),l}createComponent(e,t,i,s,o){let c=e&&!bz(e),l;if(c)l=t;else{let y=t||{};l=y.index,i=y.injector,s=y.projectableNodes,o=y.environmentInjector||y.ngModuleRef}let u=c?e:new Dm(hh(e)),h=i||this.parentInjector;if(!o&&u.ngModule==null){let E=(c?h:this.parentInjector).get(_a,null);E&&(o=E)}let p=hh(u.componentType??{}),f=x3(this._lContainer,p?.id??null),m=f?.firstChild??null,A=u.create(h,s,m,o);return this.insertImpl(A.hostView,l,E3(this._hostTNode,f)),A}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let s=e._lView;if(QH(s)){let l=this.indexOf(e);if(l!==-1)this.detach(l);else{let u=s[$s],h=new gL(u,u[Ka],u[$s]);h.detach(h.indexOf(e))}}let o=this._adjustIndex(t),c=this._lContainer;return M9(c,s,o,i),e.attachToViewContainerRef(),bD(V1(c),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=_3(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=ib(this._lContainer,t);i&&(av(V1(this._lContainer),t),UD(i[or],i))}detach(e){let t=this._adjustIndex(e,-1),i=ib(this._lContainer,t);return i&&av(V1(this._lContainer),t)!=null?new vh(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function _3(n){return n[iv]}function V1(n){return n[iv]||(n[iv]=[])}function AL(n,e){let t,i=e[n.index];return qc(i)?t=i:(t=YG(i,e,null,n),e[n.index]=t,Jb(e,t)),T9(t,e,n,i),new gL(t,n,e)}function S9(n,e){let t=n[Ea],i=t.createComment(""),s=bc(e,n),o=qb(t,s);return lv(t,o,i,nG(t,s),!1),i}var T9=I9;function I9(n,e,t,i){if(n[ph])return;let s;t.type&8?s=_c(i):s=S9(e,t),n[ph]=s}function R9(n,e,t){let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function D9(n,e,t,i){return R9(n,rz(),t)?e+I3(t)+i:Tv}function b3(n,e,t,i,s){let o=e.inputs,c=s?"class":"style";uL(n,t,o[c],c,i)}function L9(n,e,t,i,s,o){let c=e.consts,l=r3(c,s),u=$b(e,n,2,i,l);return NG(e,t,u,r3(c,o)),u.attrs!==null&&fb(u,u.attrs,!1),u.mergedAttrs!==null&&fb(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function Fm(n,e,t,i){let s=Ws(),o=Yc(),c=fh+n,l=s[Ea],u=o.firstCreatePass?L9(c,o,s,e,t,i):o.data[c],h=P9(o,s,u,l,e,n);s[c]=h;let p=X3(u);return bv(u,!0),GD(l,h,u),(u.flags&32)!==32&&uD()&&VD(o,s,h,u),YH()===0&&Zd(h,s),KH(),p&&(SG(o,s,u),tL(o,u,s)),i!==null&&TG(s,u),Fm}function Um(){let n=$a();nD()?nz():(n=n.parent,bv(n,!1));let e=n;ZH(e)&&ez(),$H();let t=Yc();return t.firstCreatePass&&(dD(t,n),Q3(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&fz(e)&&b3(t,e,Ws(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&pz(e)&&b3(t,e,Ws(),e.stylesWithoutHost,!1),Um}function km(n,e,t,i){return Fm(n,e,t,i),Um(),km}var P9=(n,e,t,i,s,o)=>(hD(!0),OD(i,s,lz()));var fv="en-US";var B9=fv;function O9(n){oH(n,"Expected localeId to be defined"),typeof n=="string"&&(B9=n.toLowerCase().replace(/_/g,"-"))}function Vm(n){return!!n&&typeof n.then=="function"}function vL(n){return!!n&&typeof n.subscribe=="function"}function Dv(n,e,t,i){let s=Ws(),o=Yc(),c=$a();return F9(o,s,s[Ea],c,n,e,i),Dv}function N9(n,e,t,i){let s=n.cleanup;if(s!=null)for(let o=0;o<s.length-1;o+=2){let c=s[o];if(c===t&&s[o+1]===i){let l=e[wm],u=s[o+2];return l.length>u?l[u]:null}typeof c=="string"&&(o+=2)}return null}function F9(n,e,t,i,s,o,c){let l=X3(i),h=n.firstCreatePass&&cL(n),p=e[jc],f=aL(e),m=!0;if(i.type&3||c){let E=bc(i,e),x=c?c(E):E,v=f.length,w=c?T=>c(_c(T[i.index])):i.index,M=null;if(!c&&l&&(M=N9(n,e,s,i.index)),M!==null){let T=M.__ngLastListenerFn__||M;T.__ngNextListenerFn__=o,M.__ngLastListenerFn__=o,m=!1}else{o=w3(i,e,p,o,!1);let T=t.listen(x,s,o);f.push(o,T),h&&h.push(s,w,v,v+1)}}else o=w3(i,e,p,o,!1);let A=i.outputs,y;if(m&&A!==null&&(y=A[s])){let E=y.length;if(E)for(let x=0;x<E;x+=2){let v=y[x],w=y[x+1],D=e[v][w].subscribe(o),L=f.length;f.push(o,D),h&&h.push(s,i.index,L,-(L+1))}}}function M3(n,e,t,i){try{return Ac(6,e,t),t(i)!==!1}catch(s){return lL(n,s),!1}finally{Ac(7,e,t)}}function w3(n,e,t,i,s){return function o(c){if(c===Function)return i;let l=n.componentOffset>-1?tf(n.index,e):e;Zb(l);let u=M3(e,t,i,c),h=o.__ngNextListenerFn__;for(;h;)u=M3(e,t,h,c)&&u,h=h.__ngNextListenerFn__;return s&&u===!1&&c.preventDefault(),u}}function U9(){return this._results[Symbol.iterator]()}var gb=class n{get changes(){return this._changes??=new xa}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=n.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=U9)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=wz(e);(this._changesDetected=!Mz(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}},Lm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=H9;let n=e;return n})(),k9=Lm,V9=class extends k9{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){let s=b9(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:i});return new vh(s)}};function H9(){return nM($a(),Ws())}function nM(n,e){return n.type&4?new V9(e,n,sf(n,e)):null}var Ab=class n{constructor(e){this.queryList=e,this.matches=null}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},vb=class n{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,s=[];for(let o=0;o<i;o++){let c=t.getByIndex(o),l=this.queries[c.indexInDeclarationView];s.push(l.clone())}return new n(s)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)xL(e,t).matches!==null&&this.queries[t].setDirty()}},yb=class{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}},xb=class n{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let s=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,s);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Eb=class n{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){let o=i[s];this.matchTNodeWithReadOption(e,t,z9(t,o)),this.matchTNodeWithReadOption(e,t,KA(t,e,o,!1,!1))}else i===Lm?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,KA(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let s=this.metadata.read;if(s!==null)if(s===Eh||s===of||s===Lm&&t.type&4)this.addMatch(t.index,-2);else{let o=KA(t,e,s,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function z9(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function G9(n,e){return n.type&11?sf(n,e):n.type&4?nM(n,e):null}function W9(n,e,t,i){return t===-1?G9(e,n):t===-2?j9(n,e,i):Ah(n,n[or],t,e)}function j9(n,e,t){if(t===Eh)return sf(e,n);if(t===Lm)return nM(e,n);if(t===of)return AL(e,n)}function yL(n,e,t,i){let s=e[yc].queries[i];if(s.matches===null){let o=n.data,c=t.matches,l=[];for(let u=0;u<c.length;u+=2){let h=c[u];if(h<0)l.push(null);else{let p=o[h];l.push(W9(e,p,c[u+1],t.metadata.read))}}s.matches=l}return s.matches}function _b(n,e,t,i){let s=n.queries.getByIndex(t),o=s.matches;if(o!==null){let c=yL(n,e,s,t);for(let l=0;l<o.length;l+=2){let u=o[l];if(u>0)i.push(c[l/2]);else{let h=o[l+1],p=e[-u];for(let f=ra;f<p.length;f++){let m=p[f];m[Om]===m[$s]&&_b(m[or],m,h,i)}if(p[Yd]!==null){let f=p[Yd];for(let m=0;m<f.length;m++){let A=f[m];_b(A[or],A,h,i)}}}}}return i}function Q9(n,e){return n[yc].queries[e].queryList}function X9(n,e,t){let i=new gb((t&4)===4);PG(n,e,i,i.destroy),e[yc]===null&&(e[yc]=new vb),e[yc].queries.push(new Ab(i))}function q9(n,e,t){n.queries===null&&(n.queries=new xb),n.queries.track(new Eb(e,t))}function xL(n,e){return n.queries.getByIndex(e)}function EL(n,e,t){let i=Yc();i.firstCreatePass&&(q9(i,new yb(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),X9(i,Ws(),e)}function iM(n){let e=Ws(),t=Yc(),i=iD();Ob(i+1);let s=xL(t,i);if(n.dirty&&jH(e)===((s.metadata.flags&2)===2)){if(s.matches===null)n.reset([]);else{let o=s.crossesNgTemplate?_b(t,e,i,[]):yL(t,e,s,i);n.reset(o,gG),n.notifyOnChanges()}return!0}return!1}function rM(){return Q9(Ws(),iD())}function _L(n,e=""){let t=Ws(),i=Yc(),s=n+fh,o=i.firstCreatePass?$b(i,s,1,e,null):i.data[s],c=Y9(i,t,o,e,n);t[s]=c,uD()&&VD(i,t,c,o),bv(o,!1)}var Y9=(n,e,t,i,s)=>(hD(!0),Wz(e[Ea],i));function sM(n){return bL("",n,""),sM}function bL(n,e,t){let i=Ws(),s=D9(i,n,e,t);return s!==Tv&&KG(i,Ub(),s),bL}function K9(n,e,t){let i=Yc();if(i.firstCreatePass){let s=ef(n);bb(t,i.data,i.blueprint,s,!0),bb(e,i.data,i.blueprint,s,!1)}}function bb(n,e,t,i,s){if(n=To(n),Array.isArray(n))for(let o=0;o<n.length;o++)bb(n[o],e,t,i,s);else{let o=Yc(),c=Ws(),l=$a(),u=Jd(n)?n:To(n.provide),h=ID(n),p=l.providerIndexes&1048575,f=l.directiveStart,m=l.providerIndexes>>20;if(Jd(n)||!n.multi){let A=new gh(h,s,Nm),y=z1(u,e,s?p:p+m,f);y===-1?($1(ov(l,c),o,u),H1(o,n,e.length),e.push(u),l.directiveStart++,l.directiveEnd++,s&&(l.providerIndexes+=1048576),t.push(A),c.push(A)):(t[y]=A,c[y]=A)}else{let A=z1(u,e,p+m,f),y=z1(u,e,p,p+m),E=A>=0&&t[A],x=y>=0&&t[y];if(s&&!x||!s&&!E){$1(ov(l,c),o,u);let v=Z9(s?J9:$9,t.length,s,i,h);!s&&x&&(t[y].providerFactory=v),H1(o,n,e.length,0),e.push(u),l.directiveStart++,l.directiveEnd++,s&&(l.providerIndexes+=1048576),t.push(v),c.push(v)}else{let v=ML(t[s?y:A],h,!s&&i);H1(o,n,A>-1?A:y,v)}!s&&i&&x&&t[y].componentProviders++}}}function H1(n,e,t,i){let s=Jd(e),o=Rz(e);if(s||o){let u=(o?To(e.useClass):e).prototype.ngOnDestroy;if(u){let h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&e.multi){let p=h.indexOf(t);p===-1?h.push(t,[i,u]):h[p+1].push(i,u)}else h.push(t,u)}}}function ML(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function z1(n,e,t,i){for(let s=t;s<i;s++)if(e[s]===n)return s;return-1}function $9(n,e,t,i){return Mb(this.multi,[])}function J9(n,e,t,i){let s=this.multi,o;if(this.providerFactory){let c=this.providerFactory.componentProviders,l=Ah(t,t[or],this.providerFactory.index,i);o=l.slice(0,c),Mb(s,o);for(let u=c;u<l.length;u++)o.push(l[u])}else o=[],Mb(s,o);return o}function Mb(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function Z9(n,e,t,i,s){let o=new gh(n,t,Nm);return o.multi=[],o.index=e,o.componentProviders=0,ML(o,s,i&&!t),o}function wL(n,e=[]){return t=>{t.providersResolver=(i,s)=>K9(i,s?s(n):n,e)}}var Xl=class{},Pm=class{};var wb=class extends Xl{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new dv(this);let s=H3(e);this._bootstrapComponents=LD(s.bootstrap),this._r3Injector=RD(e,t,[{provide:Xl,useValue:this},{provide:Sv,useValue:this.componentFactoryResolver},...i],ia(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Cb=class extends Pm{constructor(e){super(),this.moduleType=e}create(e){return new wb(this.moduleType,e,[])}};var pv=class extends Xl{constructor(e){super(),this.componentFactoryResolver=new dv(this),this.instance=null;let t=new Im([...e.providers,{provide:Xl,useValue:this},{provide:Sv,useValue:this.componentFactoryResolver}],e.parent||Gb(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function oM(n,e,t=null){return new pv({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var eW=(()=>{let e=class e{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i)){let s=CD(!1,i.type),o=s.length>0?oM([s],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i,o)}return this.cachedInjectors.get(i)}ngOnDestroy(){try{for(let i of this.cachedInjectors.values())i!==null&&i.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=Xi({token:e,providedIn:"environment",factory:()=>new e(mr(_a))});let n=e;return n})();function Lv(n){pL("NgStandalone"),n.getStandaloneInjector=e=>e.get(eW).getOrCreateStandaloneInjector(n)}var Pv=(()=>{let e=class e{log(i){console.log(i)}warn(i){console.warn(i)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Sb=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},aM=(()=>{let e=class e{compileModuleSync(i){return new Cb(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){let s=this.compileModuleSync(i),o=H3(i),c=LD(o.declarations).reduce((l,u)=>{let h=hh(u);return h&&l.push(new Dm(h)),l},[]);return new Sb(s,c)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Bv=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ks(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var CL=new _r("");var SL=new _r("Application Initializer"),TL=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,s)=>{this.resolve=i,this.reject=s}),this.appInits=si(SL,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let i=[];for(let o of this.appInits){let c=o();if(Vm(c))i.push(c);else if(vL(c)){let l=new Promise((u,h)=>{c.subscribe({complete:u,error:h})});i.push(l)}}let s=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{s()}).catch(o=>{this.reject(o)}),i.length===0&&s(),this.initialized=!0}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),cM=new _r("appBootstrapListener");function tW(){AR(()=>{throw new ki(600,!1)})}function nW(n){return n.isBoundToModule}function iW(n,e,t){try{let i=t();return Vm(i)?i.catch(s=>{throw e.runOutsideAngular(()=>n.handleError(s)),s}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}var Hm=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=si(qD),this.afterRenderEffectManager=si(mL),this.componentTypes=[],this.components=[],this.isStable=si(Bv).hasPendingTasks.pipe(Er(i=>!i)),this._injector=si(_a)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,s){let o=i instanceof uv;if(!this._injector.get(TL).done){let A=!o&&V3(i),y=!1;throw new ki(405,y)}let l;o?l=i:l=this._injector.get(Sv).resolveComponentFactory(i),this.componentTypes.push(l.componentType);let u=nW(l)?void 0:this._injector.get(Xl),h=s||l.selector,p=l.create(nf.NULL,[],h,u),f=p.location.nativeElement,m=p.injector.get(CL,null);return m?.registerApplication(f),p.onDestroy(()=>{this.detachView(p.hostView),G1(this.components,p),m?.unregisterApplication(f)}),this._loadComponent(p),p}tick(){if(this._runningTick)throw new ki(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{try{let i=this.afterRenderEffectManager.execute()}catch(i){this.internalErrorHandler(i)}this._runningTick=!1}}attachView(i){let s=i;this._views.push(s),s.attachToAppRef(this)}detachView(i){let s=i;G1(this._views,s),s.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);let s=this._injector.get(cM,[]);[...this._bootstrapListeners,...s].forEach(o=>o(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>G1(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new ki(406,!1);let i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function G1(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var rW=(()=>{let e=class e{constructor(){this.zone=si(vs),this.applicationRef=si(Hm)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function sW(n){return[{provide:vs,useFactory:n},{provide:$d,multi:!0,useFactory:()=>{let e=si(rW,{optional:!0});return()=>e.initialize()}},{provide:$d,multi:!0,useFactory:()=>{let e=si(lW);return()=>{e.initialize()}}},{provide:qD,useFactory:oW}]}function oW(){let n=si(vs),e=si(Qc);return t=>n.runOutsideAngular(()=>e.handleError(t))}function aW(n){let e=sW(()=>new vs(cW(n)));return Mv([[],e])}function cW(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var lW=(()=>{let e=class e{constructor(){this.subscription=new Ts,this.initialized=!1,this.zone=si(vs),this.pendingTasks=si(Bv)}initialize(){if(this.initialized)return;this.initialized=!0;let i=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(i=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{vs.assertNotInAngularZone(),queueMicrotask(()=>{i!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(i),i=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{vs.assertInAngularZone(),i??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function uW(){return typeof $localize<"u"&&$localize.locale||fv}var lM=new _r("LocaleId",{providedIn:"root",factory:()=>si(lM,sr.Optional|sr.SkipSelf)||uW()});var IL=new _r("PlatformDestroyListeners");var ZA=null;function hW(n=[],e){return nf.create({name:e,providers:[{provide:wv,useValue:"platform"},{provide:IL,useValue:new Set([()=>ZA=null])},...n]})}function dW(n=[]){if(ZA)return ZA;let e=hW(n);return ZA=e,tW(),fW(e),e}function fW(n){n.get(jb,null)?.forEach(t=>t())}function RL(n){try{let{rootComponent:e,appProviders:t,platformProviders:i}=n,s=dW(i),o=[aW(),...t||[]],l=new pv({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1}).injector,u=l.get(vs);return u.run(()=>{l.resolveInjectorInitializers();let h=l.get(Qc,null),p;u.runOutsideAngular(()=>{p=u.onError.subscribe({next:A=>{h.handleError(A)}})});let f=()=>l.destroy(),m=s.get(IL);return m.add(f),l.onDestroy(()=>{p.unsubscribe(),m.delete(f)}),iW(h,u,()=>{let A=l.get(TL);return A.runInitializers(),A.donePromise.then(()=>{let y=l.get(lM,fv);O9(y||fv);let E=l.get(Hm);return e!==void 0&&E.bootstrap(e),E})})})}catch(e){return Promise.reject(e)}}var uM=null;function af(){return uM}function OL(n){uM||(uM=n)}var Nv=class{},sa=new _r("DocumentToken"),NL=(()=>{let e=class e{historyGo(i){throw new Error("Not implemented")}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(vW),providedIn:"platform"});let n=e;return n})();var vW=(()=>{let e=class e extends NL{constructor(){super(),this._doc=si(sa),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return af().getBaseHref(this._doc)}onPopState(i){let s=af().getGlobalEventTarget(this._doc,"window");return s.addEventListener("popstate",i,!1),()=>s.removeEventListener("popstate",i)}onHashChange(i){let s=af().getGlobalEventTarget(this._doc,"window");return s.addEventListener("hashchange",i,!1),()=>s.removeEventListener("hashchange",i)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(i){this._location.pathname=i}pushState(i,s,o){this._history.pushState(i,s,o)}replaceState(i,s,o){this._history.replaceState(i,s,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function FL(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function DL(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,i=t-(n[t-1]==="/"?1:0);return n.slice(0,i)+n.slice(t)}function _h(n){return n&&n[0]!=="?"?"?"+n:n}var Uv=(()=>{let e=class e{historyGo(i){throw new Error("Not implemented")}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(UL),providedIn:"root"});let n=e;return n})(),yW=new _r("appBaseHref"),UL=(()=>{let e=class e extends Uv{constructor(i,s){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=s??this._platformLocation.getBaseHrefFromDOM()??si(sa).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return FL(this._baseHref,i)}path(i=!1){let s=this._platformLocation.pathname+_h(this._platformLocation.search),o=this._platformLocation.hash;return o&&i?`${s}${o}`:s}pushState(i,s,o,c){let l=this.prepareExternalUrl(o+_h(c));this._platformLocation.pushState(i,s,l)}replaceState(i,s,o,c){let l=this.prepareExternalUrl(o+_h(c));this._platformLocation.replaceState(i,s,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}};e.\u0275fac=function(s){return new(s||e)(mr(NL),mr(yW,8))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var zm=(()=>{let e=class e{constructor(i){this._subject=new xa,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;let s=this._locationStrategy.getBaseHref();this._basePath=_W(DL(LL(s))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,s=""){return this.path()==this.normalize(i+_h(s))}normalize(i){return e.stripTrailingSlash(EW(this._basePath,LL(i)))}prepareExternalUrl(i){return i&&i[0]!=="/"&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,s="",o=null){this._locationStrategy.pushState(o,"",i,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+_h(s)),o)}replaceState(i,s="",o=null){this._locationStrategy.replaceState(o,"",i,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+_h(s)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(s=>{this._notifyUrlChangeListeners(s.url,s.state)})),()=>{let s=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(s,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",s){this._urlChangeListeners.forEach(o=>o(i,s))}subscribe(i,s,o){return this._subject.subscribe({next:i,error:s,complete:o})}};e.normalizeQueryParams=_h,e.joinWithSlash=FL,e.stripTrailingSlash=DL,e.\u0275fac=function(s){return new(s||e)(mr(Uv))},e.\u0275prov=Xi({token:e,factory:()=>xW(),providedIn:"root"});let n=e;return n})();function xW(){return new zm(mr(Uv))}function EW(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function LL(n){return n.replace(/\/index.html$/,"")}function _W(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function kL(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[s,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(s.trim()===e)return decodeURIComponent(o)}return null}var hM=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=xv({type:e}),e.\u0275inj=mv({});let n=e;return n})(),VL="browser",bW="server";function dM(n){return n===bW}var Fv=class{};var mM=class extends Nv{constructor(){super(...arguments),this.supportsDOMEvents=!0}},gM=class n extends mM{static makeCurrent(){OL(new n)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=wW();return t==null?null:CW(t)}resetBaseElement(){Gm=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return kL(document.cookie,e)}},Gm=null;function wW(){return Gm=Gm||document.querySelector("base"),Gm?Gm.getAttribute("href"):null}function CW(n){return new URL(n,document.baseURI).pathname}var SW=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})(),AM=new _r("EventManagerPlugins"),WL=(()=>{let e=class e{constructor(i,s){this._zone=s,this._eventNameToPlugin=new Map,i.forEach(o=>{o.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,s,o){return this._findPluginFor(s).addEventListener(i,s,o)}getZone(){return this._zone}_findPluginFor(i){let s=this._eventNameToPlugin.get(i);if(s)return s;if(s=this._plugins.find(c=>c.supports(i)),!s)throw new ki(5101,!1);return this._eventNameToPlugin.set(i,s),s}};e.\u0275fac=function(s){return new(s||e)(mr(AM),mr(vs))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})(),kv=class{constructor(e){this._doc=e}},fM="ng-app-id",jL=(()=>{let e=class e{constructor(i,s,o,c={}){this.doc=i,this.appId=s,this.nonce=o,this.platformId=c,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=dM(c),this.resetHostNodes()}addStyles(i){for(let s of i)this.changeUsageCount(s,1)===1&&this.onStyleAdded(s)}removeStyles(i){for(let s of i)this.changeUsageCount(s,-1)<=0&&this.onStyleRemoved(s)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(s=>s.remove()),i.clear());for(let s of this.getAllStyles())this.onStyleRemoved(s);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let s of this.getAllStyles())this.addStyleToHost(i,s)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let s of this.hostNodes)this.addStyleToHost(s,i)}onStyleRemoved(i){let s=this.styleRef;s.get(i)?.elements?.forEach(o=>o.remove()),s.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${fM}="${this.appId}"]`);if(i?.length){let s=new Map;return i.forEach(o=>{o.textContent!=null&&s.set(o.textContent,o)}),s}return null}changeUsageCount(i,s){let o=this.styleRef;if(o.has(i)){let c=o.get(i);return c.usage+=s,c.usage}return o.set(i,{usage:s,elements:[]}),s}getStyleElement(i,s){let o=this.styleNodesInDOM,c=o?.get(s);if(c?.parentNode===i)return o.delete(s),c.removeAttribute(fM),c;{let l=this.doc.createElement("style");return this.nonce&&l.setAttribute("nonce",this.nonce),l.textContent=s,this.platformIsServer&&l.setAttribute(fM,this.appId),i.appendChild(l),l}}addStyleToHost(i,s){let o=this.getStyleElement(i,s),c=this.styleRef,l=c.get(s)?.elements;l?l.push(o):c.set(s,{elements:[o],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}};e.\u0275fac=function(s){return new(s||e)(mr(sa),mr(Wb),mr(Qb,8),mr(rf))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})(),pM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yM=/%COMP%/g,QL="%COMP%",TW=`_nghost-${QL}`,IW=`_ngcontent-${QL}`,RW=!0,DW=new _r("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>RW});function LW(n){return IW.replace(yM,n)}function PW(n){return TW.replace(yM,n)}function XL(n,e){return e.map(t=>t.replace(yM,n))}var HL=(()=>{let e=class e{constructor(i,s,o,c,l,u,h,p=null){this.eventManager=i,this.sharedStylesHost=s,this.appId=o,this.removeStylesOnCompDestroy=c,this.doc=l,this.platformId=u,this.ngZone=h,this.nonce=p,this.rendererByCompId=new Map,this.platformIsServer=dM(u),this.defaultRenderer=new Wm(i,l,h,this.platformIsServer)}createRenderer(i,s){if(!i||!s)return this.defaultRenderer;this.platformIsServer&&s.encapsulation===xc.ShadowDom&&(s=As(di({},s),{encapsulation:xc.Emulated}));let o=this.getOrCreateRenderer(i,s);return o instanceof Vv?o.applyToHost(i):o instanceof jm&&o.applyStyles(),o}getOrCreateRenderer(i,s){let o=this.rendererByCompId,c=o.get(s.id);if(!c){let l=this.doc,u=this.ngZone,h=this.eventManager,p=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(s.encapsulation){case xc.Emulated:c=new Vv(h,p,s,this.appId,f,l,u,m);break;case xc.ShadowDom:return new vM(h,p,i,s,l,u,this.nonce,m);default:c=new jm(h,p,s,f,l,u,m);break}o.set(s.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(s){return new(s||e)(mr(WL),mr(jL),mr(Wb),mr(DW),mr(sa),mr(rf),mr(vs),mr(Qb))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})(),Wm=class{constructor(e,t,i,s){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=s,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(pM[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(zL(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(zL(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new ki(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,s){if(s){t=s+":"+t;let o=pM[s];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let s=pM[i];s?e.removeAttributeNS(s,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,s){s&(xh.DashCase|xh.Important)?e.style.setProperty(t,i,s&xh.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&xh.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=af().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function zL(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var vM=class extends Wm{constructor(e,t,i,s,o,c,l,u){super(e,o,c,u),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=XL(s.id,s.styles);for(let p of h){let f=document.createElement("style");l&&f.setAttribute("nonce",l),f.textContent=p,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},jm=class extends Wm{constructor(e,t,i,s,o,c,l,u){super(e,o,c,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=s,this.styles=u?XL(u,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Vv=class extends jm{constructor(e,t,i,s,o,c,l,u){let h=s+"-"+i.id;super(e,t,i,o,c,l,u,h),this.contentAttr=LW(h),this.hostAttr=PW(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},BW=(()=>{let e=class e extends kv{constructor(i){super(i)}supports(i){return!0}addEventListener(i,s,o){return i.addEventListener(s,o,!1),()=>this.removeEventListener(i,s,o)}removeEventListener(i,s,o){return i.removeEventListener(s,o)}};e.\u0275fac=function(s){return new(s||e)(mr(sa))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})(),GL=["alt","control","meta","shift"],OW={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},NW={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},FW=(()=>{let e=class e extends kv{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,s,o){let c=e.parseEventName(s),l=e.eventCallback(c.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>af().onAndCancel(i,c.domEventName,l))}static parseEventName(i){let s=i.toLowerCase().split("."),o=s.shift();if(s.length===0||!(o==="keydown"||o==="keyup"))return null;let c=e._normalizeKey(s.pop()),l="",u=s.indexOf("code");if(u>-1&&(s.splice(u,1),l="code."),GL.forEach(p=>{let f=s.indexOf(p);f>-1&&(s.splice(f,1),l+=p+".")}),l+=c,s.length!=0||c.length===0)return null;let h={};return h.domEventName=o,h.fullKey=l,h}static matchEventFullKeyCode(i,s){let o=OW[i.key]||i.key,c="";return s.indexOf("code.")>-1&&(o=i.code,c="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),GL.forEach(l=>{if(l!==o){let u=NW[l];u(i)&&(c+=l+".")}}),c+=o,c===s)}static eventCallback(i,s,o){return c=>{e.matchEventFullKeyCode(c,i)&&o.runGuarded(()=>s(c))}}static _normalizeKey(i){return i==="esc"?"escape":i}};e.\u0275fac=function(s){return new(s||e)(mr(sa))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac});let n=e;return n})();function qL(n,e){return RL(di({rootComponent:n},UW(e)))}function UW(n){return{appProviders:[...GW,...n?.providers??[]],platformProviders:zW}}function kW(){gM.makeCurrent()}function VW(){return new Qc}function HW(){return DD(document),document}var zW=[{provide:rf,useValue:VL},{provide:jb,useValue:kW,multi:!0},{provide:sa,useFactory:HW,deps:[]}];var GW=[{provide:wv,useValue:"root"},{provide:Qc,useFactory:VW,deps:[]},{provide:AM,useClass:BW,multi:!0,deps:[sa,vs,rf]},{provide:AM,useClass:FW,multi:!0,deps:[sa]},HL,jL,WL,{provide:Rm,useExisting:HL},{provide:Fv,useClass:SW,deps:[]},[]];function WW(){return new xM(mr(sa))}var xM=(()=>{let e=class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}};e.\u0275fac=function(s){return new(s||e)(mr(sa))},e.\u0275prov=Xi({token:e,factory:function(s){let o=null;return s?o=new s:o=WW(),o},providedIn:"root"});let n=e;return n})();var qi="primary",og=Symbol("RouteTitle"),wM=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function df(n){return new wM(n)}function QW(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let s={};for(let o=0;o<i.length;o++){let c=i[o],l=n[o];if(c.startsWith(":"))s[c.substring(1)]=l;else if(c!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:s}}function XW(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Mc(n[t],e[t]))return!1;return!0}function Mc(n,e){let t=n?CM(n):void 0,i=e?CM(e):void 0;if(!t||!i||t.length!=i.length)return!1;let s;for(let o=0;o<t.length;o++)if(s=t[o],!eP(n[s],e[s]))return!1;return!0}function CM(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function eP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((s,o)=>i[o]===s)}else return n===e}function tP(n){return n.length>0?n[n.length-1]:null}function Kl(n){return w1(n)?n:Vm(n)?Is(Promise.resolve(n)):Hi(n)}var qW={exact:iP,subset:rP},nP={exact:YW,subset:KW,ignored:()=>!0};function YL(n,e,t){return qW[t.paths](n.root,e.root,t.matrixParams)&&nP[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function YW(n,e){return Mc(n,e)}function iP(n,e,t){if(!Mh(n.segments,e.segments)||!Gv(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!iP(n.children[i],e.children[i],t))return!1;return!0}function KW(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>eP(n[t],e[t]))}function rP(n,e,t){return sP(n,e,e.segments,t)}function sP(n,e,t,i){if(n.segments.length>t.length){let s=n.segments.slice(0,t.length);return!(!Mh(s,t)||e.hasChildren()||!Gv(s,t,i))}else if(n.segments.length===t.length){if(!Mh(n.segments,t)||!Gv(n.segments,t,i))return!1;for(let s in e.children)if(!n.children[s]||!rP(n.children[s],e.children[s],i))return!1;return!0}else{let s=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Mh(n.segments,s)||!Gv(n.segments,s,i)||!n.children[qi]?!1:sP(n.children[qi],e,o,i)}}function Gv(n,e,t){return e.every((i,s)=>nP[t](n[s].parameters,i.parameters))}var ql=class{constructor(e=new Nr([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=df(this.queryParams),this._queryParamMap}toString(){return ZW.serialize(this)}},Nr=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wv(this)}},bh=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=df(this.parameters),this._parameterMap}toString(){return aP(this)}};function $W(n,e){return Mh(n,e)&&n.every((t,i)=>Mc(t.parameters,e[i].parameters))}function Mh(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function JW(n,e){let t=[];return Object.entries(n.children).forEach(([i,s])=>{i===qi&&(t=t.concat(e(s,i)))}),Object.entries(n.children).forEach(([i,s])=>{i!==qi&&(t=t.concat(e(s,i)))}),t}var JM=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>new Qv,providedIn:"root"});let n=e;return n})(),Qv=class{parse(e){let t=new TM(e);return new ql(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Qm(e.root,!0)}`,i=nj(e.queryParams),s=typeof e.fragment=="string"?`#${ej(e.fragment)}`:"";return`${t}${i}${s}`}},ZW=new Qv;function Wv(n){return n.segments.map(e=>aP(e)).join("/")}function Qm(n,e){if(!n.hasChildren())return Wv(n);if(e){let t=n.children[qi]?Qm(n.children[qi],!1):"",i=[];return Object.entries(n.children).forEach(([s,o])=>{s!==qi&&i.push(`${s}:${Qm(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=JW(n,(i,s)=>s===qi?[Qm(n.children[qi],!1)]:[`${s}:${Qm(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[qi]!=null?`${Wv(n)}/${t[0]}`:`${Wv(n)}/(${t.join("//")})`}}function oP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hv(n){return oP(n).replace(/%3B/gi,";")}function ej(n){return encodeURI(n)}function SM(n){return oP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jv(n){return decodeURIComponent(n)}function KL(n){return jv(n.replace(/\+/g,"%20"))}function aP(n){return`${SM(n.path)}${tj(n.parameters)}`}function tj(n){return Object.entries(n).map(([e,t])=>`;${SM(e)}=${SM(t)}`).join("")}function nj(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(s=>`${Hv(t)}=${Hv(s)}`).join("&"):`${Hv(t)}=${Hv(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var ij=/^[^\/()?;#]+/;function EM(n){let e=n.match(ij);return e?e[0]:""}var rj=/^[^\/()?;=#]+/;function sj(n){let e=n.match(rj);return e?e[0]:""}var oj=/^[^=?&#]+/;function aj(n){let e=n.match(oj);return e?e[0]:""}var cj=/^[^&#]+/;function lj(n){let e=n.match(cj);return e?e[0]:""}var TM=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Nr([],{}):new Nr([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[qi]=new Nr(e,t)),i}parseSegment(){let e=EM(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ki(4009,!1);return this.capture(e),new bh(jv(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=sj(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=EM(this.remaining);s&&(i=s,this.capture(i))}e[jv(t)]=jv(i)}parseQueryParam(e){let t=aj(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let c=lj(this.remaining);c&&(i=c,this.capture(i))}let s=KL(t),o=KL(i);if(e.hasOwnProperty(s)){let c=e[s];Array.isArray(c)||(c=[c],e[s]=c),c.push(o)}else e[s]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=EM(this.remaining),s=this.remaining[i.length];if(s!=="/"&&s!==")"&&s!==";")throw new ki(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=qi);let c=this.parseChildren();t[o]=Object.keys(c).length===1?c[qi]:new Nr([],c),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ki(4011,!1)}};function cP(n){return n.segments.length>0?new Nr([],{[qi]:n}):n}function lP(n){let e={};for(let[i,s]of Object.entries(n.children)){let o=lP(s);if(i===qi&&o.segments.length===0&&o.hasChildren())for(let[c,l]of Object.entries(o.children))e[c]=l;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new Nr(n.segments,e);return uj(t)}function uj(n){if(n.numberOfChildren===1&&n.children[qi]){let e=n.children[qi];return new Nr(n.segments.concat(e.segments),e.children)}return n}function ff(n){return n instanceof ql}function hj(n,e,t=null,i=null){let s=uP(n);return hP(s,e,t,i)}function uP(n){let e;function t(o){let c={};for(let u of o.children){let h=t(u);c[u.outlet]=h}let l=new Nr(o.url,c);return o===n&&(e=l),l}let i=t(n.root),s=cP(i);return e??s}function hP(n,e,t,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return _M(s,s,s,t,i);let o=dj(e);if(o.toRoot())return _M(s,s,new Nr([],{}),t,i);let c=fj(o,s,n),l=c.processChildren?Ym(c.segmentGroup,c.index,o.commands):fP(c.segmentGroup,c.index,o.commands);return _M(s,c.segmentGroup,l,t,i)}function Xv(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Jm(n){return typeof n=="object"&&n!=null&&n.outlets}function _M(n,e,t,i,s){let o={};i&&Object.entries(i).forEach(([u,h])=>{o[u]=Array.isArray(h)?h.map(p=>`${p}`):`${h}`});let c;n===e?c=t:c=dP(n,e,t);let l=cP(lP(c));return new ql(l,o,s)}function dP(n,e,t){let i={};return Object.entries(n.children).forEach(([s,o])=>{o===e?i[s]=t:i[s]=dP(o,e,t)}),new Nr(n.segments,i)}var qv=class{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Xv(i[0]))throw new ki(4003,!1);let s=i.find(Jm);if(s&&s!==tP(i))throw new ki(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function dj(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new qv(!0,0,n);let e=0,t=!1,i=n.reduce((s,o,c)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let l={};return Object.entries(o.outlets).forEach(([u,h])=>{l[u]=typeof h=="string"?h.split("/"):h}),[...s,{outlets:l}]}if(o.segmentPath)return[...s,o.segmentPath]}return typeof o!="string"?[...s,o]:c===0?(o.split("/").forEach((l,u)=>{u==0&&l==="."||(u==0&&l===""?t=!0:l===".."?e++:l!=""&&s.push(l))}),s):[...s,o]},[]);return new qv(t,e,i)}var uf=class{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function fj(n,e,t){if(n.isAbsolute)return new uf(e,!0,0);if(!t)return new uf(e,!1,NaN);if(t.parent===null)return new uf(t,!0,0);let i=Xv(n.commands[0])?0:1,s=t.segments.length-1+i;return pj(t,s,n.numberOfDoubleDots)}function pj(n,e,t){let i=n,s=e,o=t;for(;o>s;){if(o-=s,i=i.parent,!i)throw new ki(4005,!1);s=i.segments.length}return new uf(i,!1,s-o)}function mj(n){return Jm(n[0])?n[0].outlets:{[qi]:n}}function fP(n,e,t){if(n??=new Nr([],{}),n.segments.length===0&&n.hasChildren())return Ym(n,e,t);let i=gj(n,e,t),s=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new Nr(n.segments.slice(0,i.pathIndex),{});return o.children[qi]=new Nr(n.segments.slice(i.pathIndex),n.children),Ym(o,0,s)}else return i.match&&s.length===0?new Nr(n.segments,{}):i.match&&!n.hasChildren()?IM(n,e,t):i.match?Ym(n,0,s):IM(n,e,t)}function Ym(n,e,t){if(t.length===0)return new Nr(n.segments,{});{let i=mj(t),s={};if(Object.keys(i).some(o=>o!==qi)&&n.children[qi]&&n.numberOfChildren===1&&n.children[qi].segments.length===0){let o=Ym(n.children[qi],e,t);return new Nr(n.segments,o.children)}return Object.entries(i).forEach(([o,c])=>{typeof c=="string"&&(c=[c]),c!==null&&(s[o]=fP(n.children[o],e,c))}),Object.entries(n.children).forEach(([o,c])=>{i[o]===void 0&&(s[o]=c)}),new Nr(n.segments,s)}}function gj(n,e,t){let i=0,s=e,o={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(i>=t.length)return o;let c=n.segments[s],l=t[i];if(Jm(l))break;let u=`${l}`,h=i<t.length-1?t[i+1]:null;if(s>0&&u===void 0)break;if(u&&h&&typeof h=="object"&&h.outlets===void 0){if(!JL(u,h,c))return o;i+=2}else{if(!JL(u,{},c))return o;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}function IM(n,e,t){let i=n.segments.slice(0,e),s=0;for(;s<t.length;){let o=t[s];if(Jm(o)){let u=Aj(o.outlets);return new Nr(i,u)}if(s===0&&Xv(t[0])){let u=n.segments[e];i.push(new bh(u.path,$L(t[0]))),s++;continue}let c=Jm(o)?o.outlets[qi]:`${o}`,l=s<t.length-1?t[s+1]:null;c&&l&&Xv(l)?(i.push(new bh(c,$L(l))),s+=2):(i.push(new bh(c,{})),s++)}return new Nr(i,{})}function Aj(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=IM(new Nr([],{}),0,i))}),e}function $L(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function JL(n,e,t){return n==t.path&&Mc(e,t.parameters)}var Km="imperative",Js=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Js||{}),Ma=class{constructor(e,t){this.id=e,this.url=t}},Zm=class extends Ma{constructor(e,t,i="imperative",s=null){super(e,t),this.type=Js.NavigationStart,this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},wh=class extends Ma{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=Js.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ba=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(ba||{}),RM=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(RM||{}),Yl=class extends Ma{constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s,this.type=Js.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ch=class extends Ma{constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s,this.type=Js.NavigationSkipped}},eg=class extends Ma{constructor(e,t,i,s){super(e,t),this.error=i,this.target=s,this.type=Js.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yv=class extends Ma{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=Js.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},DM=class extends Ma{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=Js.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},LM=class extends Ma{constructor(e,t,i,s,o){super(e,t),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=o,this.type=Js.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},PM=class extends Ma{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=Js.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},BM=class extends Ma{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=Js.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},OM=class{constructor(e){this.route=e,this.type=Js.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},NM=class{constructor(e){this.route=e,this.type=Js.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},FM=class{constructor(e){this.snapshot=e,this.type=Js.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},UM=class{constructor(e){this.snapshot=e,this.type=Js.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kM=class{constructor(e){this.snapshot=e,this.type=Js.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},VM=class{constructor(e){this.snapshot=e,this.type=Js.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var tg=class{},ng=class{constructor(e){this.url=e}};var HM=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new ty,this.attachRef=null}},ty=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,s){let o=this.getOrCreateContext(i);o.outlet=s,this.contexts.set(i,o)}onChildOutletDestroyed(i){let s=this.getContext(i);s&&(s.outlet=null,s.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let s=this.getContext(i);return s||(s=new HM,this.contexts.set(i,s)),s}getContext(i){return this.contexts.get(i)||null}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Kv=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=zM(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=zM(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=GM(e,this._root);return t.length<2?[]:t[t.length-2].children.map(s=>s.value).filter(s=>s!==e)}pathFromRoot(e){return GM(e,this._root).map(t=>t.value)}};function zM(n,e){if(n===e.value)return e;for(let t of e.children){let i=zM(n,t);if(i)return i}return null}function GM(n,e){if(n===e.value)return[e];for(let t of e.children){let i=GM(n,t);if(i.length)return i.unshift(e),i}return[]}var oa=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function lf(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var $v=class extends Kv{constructor(e,t){super(e),this.snapshot=t,ew(this,e)}toString(){return this.snapshot.toString()}};function pP(n){let e=vj(n),t=new Ks([new bh("",{})]),i=new Ks({}),s=new Ks({}),o=new Ks({}),c=new Ks(""),l=new pf(t,i,o,c,s,qi,n,e.root);return l.snapshot=e.root,new $v(new oa(l,[]),e)}function vj(n){let e={},t={},i={},s="",o=new ig([],e,i,s,t,qi,n,null,{});return new Jv("",new oa(o,[]))}var pf=class{constructor(e,t,i,s,o,c,l,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=s,this.dataSubject=o,this.outlet=c,this.component=l,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Er(h=>h[og]))??Hi(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Er(e=>df(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Er(e=>df(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function ZM(n,e,t="emptyOnly"){let i,{routeConfig:s}=n;return e!==null&&(t==="always"||s?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:di(di({},e.params),n.params),data:di(di({},e.data),n.data),resolve:di(di(di(di({},n.data),e.data),s?.data),n._resolvedData)}:i={params:di({},n.params),data:di({},n.data),resolve:di(di({},n.data),n._resolvedData??{})},s&&gP(s)&&(i.resolve[og]=s.title),i}var ig=class{get title(){return this.data?.[og]}constructor(e,t,i,s,o,c,l,u,h){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=o,this.outlet=c,this.component=l,this.routeConfig=u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=df(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=df(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Jv=class extends Kv{constructor(e,t){super(t),this.url=e,ew(this,t)}toString(){return mP(this._root)}};function ew(n,e){e.value._routerState=n,e.children.forEach(t=>ew(n,t))}function mP(n){let e=n.children.length>0?` { ${n.children.map(mP).join(", ")} } `:"";return`${n.value}${e}`}function bM(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Mc(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Mc(e.params,t.params)||n.paramsSubject.next(t.params),XW(e.url,t.url)||n.urlSubject.next(t.url),Mc(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function WM(n,e){let t=Mc(n.params,e.params)&&$W(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||WM(n.parent,e.parent))}function gP(n){return typeof n.title=="string"||n.title===null}var yj=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=qi,this.activateEvents=new xa,this.deactivateEvents=new xa,this.attachEvents=new xa,this.detachEvents=new xa,this.parentContexts=si(ty),this.location=si(of),this.changeDetector=si(Rv),this.environmentInjector=si(_a),this.inputBinder=si(tw,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:s,previousValue:o}=i.name;if(s)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ki(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ki(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ki(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,s){this.activated=i,this._activatedRoute=s,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,s){if(this.isActivated)throw new ki(4013,!1);this._activatedRoute=i;let o=this.location,l=i.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,h=new jM(i,u,o.injector);this.activated=o.createComponent(l,{index:o.length,injector:h,environmentInjector:s??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275dir=Db({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_v]});let n=e;return n})(),jM=class{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===pf?this.route:e===ty?this.childContexts:this.parent.get(e,t)}},tw=new _r("");function xj(n,e,t){let i=rg(n,e._root,t?t._root:void 0);return new $v(i,e)}function rg(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let s=Ej(n,e,t);return new oa(i,s)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let c=o.route;return c.value._futureSnapshot=e.value,c.children=e.children.map(l=>rg(n,l)),c}}let i=_j(e.value),s=e.children.map(o=>rg(n,o));return new oa(i,s)}}function Ej(n,e,t){return e.children.map(i=>{for(let s of t.children)if(n.shouldReuseRoute(i.value,s.value.snapshot))return rg(n,i,s);return rg(n,i)})}function _j(n){return new pf(new Ks(n.url),new Ks(n.params),new Ks(n.queryParams),new Ks(n.fragment),new Ks(n.data),n.outlet,n.component,n)}var AP="ngNavigationCancelingError";function vP(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=ff(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,s=yP(!1,ba.Redirect,e);return s.url=t,s.navigationBehaviorOptions=i,s}function yP(n,e,t){let i=new Error("NavigationCancelingError: "+(n||""));return i[AP]=!0,i.cancellationCode=e,t&&(i.url=t),i}function bj(n){return xP(n)&&ff(n.url)}function xP(n){return n&&n[AP]}var Mj=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=yv({type:e,selectors:[["ng-component"]],standalone:!0,features:[Lv],decls:1,vars:0,template:function(s,o){s&1&&km(0,"router-outlet")},dependencies:[yj],encapsulation:2});let n=e;return n})();function wj(n,e){return n.providers&&!n._injector&&(n._injector=oM(n.providers,e,`Route: ${n.path}`)),n._injector??e}function nw(n){let e=n.children&&n.children.map(nw),t=e?As(di({},n),{children:e}):di({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==qi&&(t.component=Mj),t}function wc(n){return n.outlet||qi}function Cj(n,e){let t=n.filter(i=>wc(i)===e);return t.push(...n.filter(i=>wc(i)!==e)),t}function ag(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Sj=(n,e,t,i)=>Er(s=>(new QM(e,s.targetRouterState,s.currentRouterState,t,i).activate(n),s)),QM=class{constructor(e,t,i,s,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=s,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),bM(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let s=lf(t);e.children.forEach(o=>{let c=o.value.outlet;this.deactivateRoutes(o,s[c],i),delete s[c]}),Object.values(s).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let s=e.value,o=t?t.value:null;if(s===o)if(s.component){let c=i.getContext(s.outlet);c&&this.deactivateChildRoutes(e,t,c.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,o=lf(e);for(let c of Object.values(o))this.deactivateRouteAndItsChildren(c,s);if(i&&i.outlet){let c=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:c,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,o=lf(e);for(let c of Object.values(o))this.deactivateRouteAndItsChildren(c,s);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let s=lf(t);e.children.forEach(o=>{this.activateRoutes(o,s[o.value.outlet],i),this.forwardEvent(new VM(o.value.snapshot))}),e.children.length&&this.forwardEvent(new UM(e.value.snapshot))}activateRoutes(e,t,i){let s=e.value,o=t?t.value:null;if(bM(s),s===o)if(s.component){let c=i.getOrCreateContext(s.outlet);this.activateChildRoutes(e,t,c.children)}else this.activateChildRoutes(e,t,i);else if(s.component){let c=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){let l=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),c.children.onOutletReAttached(l.contexts),c.attachRef=l.componentRef,c.route=l.route.value,c.outlet&&c.outlet.attach(l.componentRef,l.route.value),bM(l.route.value),this.activateChildRoutes(e,null,c.children)}else{let l=ag(s.snapshot);c.attachRef=null,c.route=s,c.injector=l,c.outlet&&c.outlet.activateWith(s,c.injector),this.activateChildRoutes(e,null,c.children)}}else this.activateChildRoutes(e,null,i)}},Zv=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},hf=class{constructor(e,t){this.component=e,this.route=t}};function Tj(n,e,t){let i=n._root,s=e?e._root:null;return Xm(i,s,t,[i.value])}function Ij(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function gf(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!R3(n)?n:e.get(n):i}function Xm(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){let o=lf(e);return n.children.forEach(c=>{Rj(c,o[c.value.outlet],t,i.concat([c.value]),s),delete o[c.value.outlet]}),Object.entries(o).forEach(([c,l])=>$m(l,t.getContext(c),s)),s}function Rj(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,c=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(c&&o.routeConfig===c.routeConfig){let u=Dj(c,o,o.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new Zv(i)):(o.data=c.data,o._resolvedData=c._resolvedData),o.component?Xm(n,e,l?l.children:null,i,s):Xm(n,e,t,i,s),u&&l&&l.outlet&&l.outlet.isActivated&&s.canDeactivateChecks.push(new hf(l.outlet.component,c))}else c&&$m(e,l,s),s.canActivateChecks.push(new Zv(i)),o.component?Xm(n,null,l?l.children:null,i,s):Xm(n,null,t,i,s);return s}function Dj(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Mh(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Mh(n.url,e.url)||!Mc(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!WM(n,e)||!Mc(n.queryParams,e.queryParams);case"paramsChange":default:return!WM(n,e)}}function $m(n,e,t){let i=lf(n),s=n.value;Object.entries(i).forEach(([o,c])=>{s.component?e?$m(c,e.children.getContext(o),t):$m(c,null,t):$m(c,e,t)}),s.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new hf(e.outlet.component,s)):t.canDeactivateChecks.push(new hf(null,s)):t.canDeactivateChecks.push(new hf(null,s))}function cg(n){return typeof n=="function"}function Lj(n){return typeof n=="boolean"}function Pj(n){return n&&cg(n.canLoad)}function Bj(n){return n&&cg(n.canActivate)}function Oj(n){return n&&cg(n.canActivateChild)}function Nj(n){return n&&cg(n.canDeactivate)}function Fj(n){return n&&cg(n.canMatch)}function EP(n){return n instanceof Gc||n?.name==="EmptyError"}var zv=Symbol("INITIAL_VALUE");function mf(){return Xa(n=>jA(n.map(e=>e.pipe(Wc(1),R1(zv)))).pipe(Er(e=>{for(let t of e)if(t!==!0){if(t===zv)return zv;if(t===!1||t instanceof ql)return t}return!0}),Qa(e=>e!==zv),Wc(1)))}function Uj(n,e){return Rs(t=>{let{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:o,canDeactivateChecks:c}}=t;return c.length===0&&o.length===0?Hi(As(di({},t),{guardsResult:!0})):kj(c,i,s,n).pipe(Rs(l=>l&&Lj(l)?Vj(i,o,n,e):Hi(l)),Er(l=>As(di({},t),{guardsResult:l})))})}function kj(n,e,t,i){return Is(n).pipe(Rs(s=>jj(s.component,s.route,t,e,i)),mc(s=>s!==!0,!0))}function Vj(n,e,t,i){return Is(e).pipe(Hd(s=>Vd(zj(s.route.parent,i),Hj(s.route,i),Wj(n,s.path,t),Gj(n,s.route,t))),mc(s=>s!==!0,!0))}function Hj(n,e){return n!==null&&e&&e(new kM(n)),Hi(!0)}function zj(n,e){return n!==null&&e&&e(new FM(n)),Hi(!0)}function Gj(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return Hi(!0);let s=i.map(o=>QA(()=>{let c=ag(e)??t,l=gf(o,c),u=Bj(l)?l.canActivate(e,n):yh(c,()=>l(e,n));return Kl(u).pipe(mc())}));return Hi(s).pipe(mf())}function Wj(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(c=>Ij(c)).filter(c=>c!==null).map(c=>QA(()=>{let l=c.guards.map(u=>{let h=ag(c.node)??t,p=gf(u,h),f=Oj(p)?p.canActivateChild(i,n):yh(h,()=>p(i,n));return Kl(f).pipe(mc())});return Hi(l).pipe(mf())}));return Hi(o).pipe(mf())}function jj(n,e,t,i,s){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Hi(!0);let c=o.map(l=>{let u=ag(e)??s,h=gf(l,u),p=Nj(h)?h.canDeactivate(n,e,t,i):yh(u,()=>h(n,e,t,i));return Kl(p).pipe(mc())});return Hi(c).pipe(mf())}function Qj(n,e,t,i){let s=e.canLoad;if(s===void 0||s.length===0)return Hi(!0);let o=s.map(c=>{let l=gf(c,n),u=Pj(l)?l.canLoad(e,t):yh(n,()=>l(e,t));return Kl(u)});return Hi(o).pipe(mf(),_P(i))}function _P(n){return E1(Gs(e=>{if(ff(e))throw vP(n,e)}),Er(e=>e===!0))}function Xj(n,e,t,i){let s=e.canMatch;if(!s||s.length===0)return Hi(!0);let o=s.map(c=>{let l=gf(c,n),u=Fj(l)?l.canMatch(e,t):yh(n,()=>l(e,t));return Kl(u)});return Hi(o).pipe(mf(),_P(i))}var sg=class{constructor(e){this.segmentGroup=e||null}},ey=class extends Error{constructor(e){super(),this.urlTree=e}};function cf(n){return kd(new sg(n))}function qj(n){return kd(new ki(4e3,!1))}function Yj(n){return kd(yP(!1,ba.GuardRejected))}var XM=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],s=t.root;for(;;){if(i=i.concat(s.segments),s.numberOfChildren===0)return Hi(i);if(s.numberOfChildren>1||!s.children[qi])return qj(e.redirectTo);s=s.children[qi]}}applyRedirectCommands(e,t,i){let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new ey(s);return s}applyRedirectCreateUrlTree(e,t,i,s){let o=this.createSegmentGroup(e,t.root,i,s);return new ql(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([s,o])=>{if(typeof o=="string"&&o.startsWith(":")){let l=o.substring(1);i[s]=t[l]}else i[s]=o}),i}createSegmentGroup(e,t,i,s){let o=this.createSegments(e,t.segments,i,s),c={};return Object.entries(t.children).forEach(([l,u])=>{c[l]=this.createSegmentGroup(e,u,i,s)}),new Nr(o,c)}createSegments(e,t,i,s){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,s):this.findOrReturn(o,i))}findPosParam(e,t,i){let s=i[t.path.substring(1)];if(!s)throw new ki(4001,!1);return s}findOrReturn(e,t){let i=0;for(let s of t){if(s.path===e.path)return t.splice(i),s;i++}return e}},qM={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Kj(n,e,t,i,s){let o=iw(n,e,t);return o.matched?(i=wj(e,i),Xj(i,e,t,s).pipe(Er(c=>c===!0?o:di({},qM)))):Hi(o)}function iw(n,e,t){if(e.path==="**")return $j(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?di({},qM):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let s=(e.matcher||QW)(t,n,e);if(!s)return di({},qM);let o={};Object.entries(s.posParams??{}).forEach(([l,u])=>{o[l]=u.path});let c=s.consumed.length>0?di(di({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:c,positionalParamSegments:s.posParams??{}}}function $j(n){return{matched:!0,parameters:n.length>0?tP(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function ZL(n,e,t,i){return t.length>0&&eQ(n,t,i)?{segmentGroup:new Nr(e,Zj(i,new Nr(t,n.children))),slicedSegments:[]}:t.length===0&&tQ(n,t,i)?{segmentGroup:new Nr(n.segments,Jj(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Nr(n.segments,n.children),slicedSegments:t}}function Jj(n,e,t,i){let s={};for(let o of t)if(ny(n,e,o)&&!i[wc(o)]){let c=new Nr([],{});s[wc(o)]=c}return di(di({},i),s)}function Zj(n,e){let t={};t[qi]=e;for(let i of n)if(i.path===""&&wc(i)!==qi){let s=new Nr([],{});t[wc(i)]=s}return t}function eQ(n,e,t){return t.some(i=>ny(n,e,i)&&wc(i)!==qi)}function tQ(n,e,t){return t.some(i=>ny(n,e,i))}function ny(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function nQ(n,e,t,i){return wc(n)!==i&&(i===qi||!ny(e,t,n))?!1:iw(e,n,t).matched}function iQ(n,e,t){return e.length===0&&!n.children[t]}var YM=class{};function rQ(n,e,t,i,s,o,c="emptyOnly"){return new KM(n,e,t,i,s,c,o).recognize()}var sQ=31,KM=class{constructor(e,t,i,s,o,c,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=s,this.urlTree=o,this.paramsInheritanceStrategy=c,this.urlSerializer=l,this.applyRedirects=new XM(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ki(4002,`'${e.segmentGroup}'`)}recognize(){let e=ZL(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Er(t=>{let i=new ig([],Object.freeze({}),Object.freeze(di({},this.urlTree.queryParams)),this.urlTree.fragment,{},qi,this.rootComponentType,null,{}),s=new oa(i,t),o=new Jv("",s),c=hj(i,[],this.urlTree.queryParams,this.urlTree.fragment);return c.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(c),this.inheritParamsAndData(o._root,null),{state:o,tree:c}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,qi).pipe(zl(i=>{if(i instanceof ey)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof sg?this.noMatchError(i):i}))}inheritParamsAndData(e,t){let i=e.value,s=ZM(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(s.params),i.data=Object.freeze(s.data),e.children.forEach(o=>this.inheritParamsAndData(o,i))}processSegmentGroup(e,t,i,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,s,!0).pipe(Er(o=>o instanceof oa?[o]:[]))}processChildren(e,t,i){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return Is(s).pipe(Hd(o=>{let c=i.children[o],l=Cj(t,o);return this.processSegmentGroup(e,l,c,o)}),I1((o,c)=>(o.push(...c),o)),Gl(null),T1(),Rs(o=>{if(o===null)return cf(i);let c=bP(o);return oQ(c),Hi(c)}))}processSegment(e,t,i,s,o,c){return Is(t).pipe(Hd(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,s,o,c).pipe(zl(u=>{if(u instanceof sg)return Hi(null);throw u}))),mc(l=>!!l),zl(l=>{if(EP(l))return iQ(i,s,o)?Hi(new YM):cf(i);throw l}))}processSegmentAgainstRoute(e,t,i,s,o,c,l){return nQ(i,s,o,c)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,s,i,o,c):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,s,t,i,o,c):cf(s):cf(s)}expandSegmentAgainstRouteUsingRedirect(e,t,i,s,o,c){let{matched:l,consumedSegments:u,positionalParamSegments:h,remainingSegments:p}=iw(t,s,o);if(!l)return cf(t);s.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>sQ&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(u,s.redirectTo,h);return this.applyRedirects.lineralizeSegments(s,f).pipe(Rs(m=>this.processSegment(e,i,t,m.concat(p),c,!1)))}matchSegmentAgainstRoute(e,t,i,s,o){let c=Kj(t,i,s,e,this.urlSerializer);return i.path==="**"&&(t.children={}),c.pipe(Xa(l=>l.matched?(e=i._injector??e,this.getChildConfig(e,i,s).pipe(Xa(({routes:u})=>{let h=i._loadedInjector??e,{consumedSegments:p,remainingSegments:f,parameters:m}=l,A=new ig(p,m,Object.freeze(di({},this.urlTree.queryParams)),this.urlTree.fragment,cQ(i),wc(i),i.component??i._loadedComponent??null,i,lQ(i)),{segmentGroup:y,slicedSegments:E}=ZL(t,p,f,u);if(E.length===0&&y.hasChildren())return this.processChildren(h,u,y).pipe(Er(v=>v===null?null:new oa(A,v)));if(u.length===0&&E.length===0)return Hi(new oa(A,[]));let x=wc(i)===o;return this.processSegment(h,u,y,E,x?qi:o,!0).pipe(Er(v=>new oa(A,v instanceof oa?[v]:[])))}))):cf(t)))}getChildConfig(e,t,i){return t.children?Hi({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Hi({routes:t._loadedRoutes,injector:t._loadedInjector}):Qj(e,t,i,this.urlSerializer).pipe(Rs(s=>s?this.configLoader.loadChildren(e,t).pipe(Gs(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):Yj(t))):Hi({routes:[],injector:e})}};function oQ(n){n.sort((e,t)=>e.value.outlet===qi?-1:t.value.outlet===qi?1:e.value.outlet.localeCompare(t.value.outlet))}function aQ(n){let e=n.value.routeConfig;return e&&e.path===""}function bP(n){let e=[],t=new Set;for(let i of n){if(!aQ(i)){e.push(i);continue}let s=e.find(o=>i.value.routeConfig===o.value.routeConfig);s!==void 0?(s.children.push(...i.children),t.add(s)):e.push(i)}for(let i of t){let s=bP(i.children);e.push(new oa(i.value,s))}return e.filter(i=>!t.has(i))}function cQ(n){return n.data||{}}function lQ(n){return n.resolve||{}}function uQ(n,e,t,i,s,o){return Rs(c=>rQ(n,e,t,i,c.extractedUrl,s,o).pipe(Er(({state:l,tree:u})=>As(di({},c),{targetSnapshot:l,urlAfterRedirects:u}))))}function hQ(n,e){return Rs(t=>{let{targetSnapshot:i,guards:{canActivateChecks:s}}=t;if(!s.length)return Hi(t);let o=new Set(s.map(u=>u.route)),c=new Set;for(let u of o)if(!c.has(u))for(let h of MP(u))c.add(h);let l=0;return Is(c).pipe(Hd(u=>o.has(u)?dQ(u,i,n,e):(u.data=ZM(u,u.parent,n).resolve,Hi(void 0))),Gs(()=>l++),zd(1),Rs(u=>l===c.size?Hi(t):va))})}function MP(n){let e=n.children.map(t=>MP(t)).flat();return[n,...e]}function dQ(n,e,t,i){let s=n.routeConfig,o=n._resolve;return s?.title!==void 0&&!gP(s)&&(o[og]=s.title),fQ(o,n,e,i).pipe(Er(c=>(n._resolvedData=c,n.data=ZM(n,n.parent,t).resolve,null)))}function fQ(n,e,t,i){let s=CM(n);if(s.length===0)return Hi({});let o={};return Is(s).pipe(Rs(c=>pQ(n[c],e,t,i).pipe(mc(),Gs(l=>{o[c]=l}))),zd(1),S1(o),zl(c=>EP(c)?va:kd(c)))}function pQ(n,e,t,i){let s=ag(e)??i,o=gf(n,s),c=o.resolve?o.resolve(e,t):yh(s,()=>o(e,t));return Kl(c)}function MM(n){return Xa(e=>{let t=n(e);return t?Is(t).pipe(Er(()=>e)):Hi(e)})}var wP=(()=>{let e=class e{buildTitle(i){let s,o=i.root;for(;o!==void 0;)s=this.getResolvedTitleForRoute(o)??s,o=o.children.find(c=>c.outlet===qi);return s}getResolvedTitleForRoute(i){return i.data[og]}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(mQ),providedIn:"root"});let n=e;return n})(),mQ=(()=>{let e=class e extends wP{constructor(i){super(),this.title=i}updateTitle(i){let s=this.buildTitle(i);s!==void 0&&this.title.setTitle(s)}};e.\u0275fac=function(s){return new(s||e)(mr(xM))},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),rw=new _r("",{providedIn:"root",factory:()=>({})}),sw=new _r("ROUTES"),gQ=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=si(aM)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Hi(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let s=Kl(i.loadComponent()).pipe(Er(CP),Gs(c=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=c}),vm(()=>{this.componentLoaders.delete(i)})),o=new Ud(s,()=>new na).pipe(Fd());return this.componentLoaders.set(i,o),o}loadChildren(i,s){if(this.childrenLoaders.get(s))return this.childrenLoaders.get(s);if(s._loadedRoutes)return Hi({routes:s._loadedRoutes,injector:s._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(s);let c=AQ(s,this.compiler,i,this.onLoadEndListener).pipe(vm(()=>{this.childrenLoaders.delete(s)})),l=new Ud(c,()=>new na).pipe(Fd());return this.childrenLoaders.set(s,l),l}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function AQ(n,e,t,i){return Kl(n.loadChildren()).pipe(Er(CP),Rs(s=>s instanceof Pm||Array.isArray(s)?Hi(s):Is(e.compileModuleAsync(s))),Er(s=>{i&&i(n);let o,c,l=!1;return Array.isArray(s)?(c=s,l=!0):(o=s.create(t).injector,c=o.get(sw,[],{optional:!0,self:!0}).flat()),{routes:c.map(nw),injector:o}}))}function vQ(n){return n&&typeof n=="object"&&"default"in n}function CP(n){return vQ(n)?n.default:n}var ow=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(yQ),providedIn:"root"});let n=e;return n})(),yQ=(()=>{let e=class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,s){return i}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),xQ=new _r("");var EQ=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new na,this.transitionAbortSubject=new na,this.configLoader=si(gQ),this.environmentInjector=si(_a),this.urlSerializer=si(JM),this.rootContexts=si(ty),this.location=si(zm),this.inputBindingEnabled=si(tw,{optional:!0})!==null,this.titleStrategy=si(wP),this.options=si(rw,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=si(ow),this.createViewTransition=si(xQ,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Hi(void 0),this.rootComponentType=null;let i=o=>this.events.next(new OM(o)),s=o=>this.events.next(new NM(o));this.configLoader.onLoadEndListener=s,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let s=++this.navigationId;this.transitions?.next(As(di(di({},this.transitions.value),i),{id:s}))}setupNavigations(i,s,o){return this.transitions=new Ks({id:0,currentUrlTree:s,currentRawUrl:s,extractedUrl:this.urlHandlingStrategy.extract(s),urlAfterRedirects:this.urlHandlingStrategy.extract(s),rawUrl:s,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Km,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Qa(c=>c.id!==0),Er(c=>As(di({},c),{extractedUrl:this.urlHandlingStrategy.extract(c.rawUrl)})),Xa(c=>{this.currentTransition=c;let l=!1,u=!1;return Hi(c).pipe(Gs(h=>{this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?As(di({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Xa(h=>{let p=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=h.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!p&&f!=="reload"){let m="";return this.events.next(new Ch(h.id,this.urlSerializer.serialize(h.rawUrl),m,RM.IgnoredSameUrlNavigation)),h.resolve(null),va}if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return Hi(h).pipe(Xa(m=>{let A=this.transitions?.getValue();return this.events.next(new Zm(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),A!==this.transitions?.getValue()?va:Promise.resolve(m)}),uQ(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),Gs(m=>{c.targetSnapshot=m.targetSnapshot,c.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=As(di({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let A=new Yv(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(A)}));if(p&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:m,extractedUrl:A,source:y,restoredState:E,extras:x}=h,v=new Zm(m,this.urlSerializer.serialize(A),y,E);this.events.next(v);let w=pP(this.rootComponentType).snapshot;return this.currentTransition=c=As(di({},h),{targetSnapshot:w,urlAfterRedirects:A,extras:As(di({},x),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=A,Hi(c)}else{let m="";return this.events.next(new Ch(h.id,this.urlSerializer.serialize(h.extractedUrl),m,RM.IgnoredByUrlHandlingStrategy)),h.resolve(null),va}}),Gs(h=>{let p=new DM(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}),Er(h=>(this.currentTransition=c=As(di({},h),{guards:Tj(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),c)),Uj(this.environmentInjector,h=>this.events.next(h)),Gs(h=>{if(c.guardsResult=h.guardsResult,ff(h.guardsResult))throw vP(this.urlSerializer,h.guardsResult);let p=new LM(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(p)}),Qa(h=>h.guardsResult?!0:(this.cancelNavigationTransition(h,"",ba.GuardRejected),!1)),MM(h=>{if(h.guards.canActivateChecks.length)return Hi(h).pipe(Gs(p=>{let f=new PM(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(f)}),Xa(p=>{let f=!1;return Hi(p).pipe(hQ(this.paramsInheritanceStrategy,this.environmentInjector),Gs({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(p,"",ba.NoDataFromResolver)}}))}),Gs(p=>{let f=new BM(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(f)}))}),MM(h=>{let p=f=>{let m=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(f.routeConfig).pipe(Gs(A=>{f.component=A}),Er(()=>{})));for(let A of f.children)m.push(...p(A));return m};return jA(p(h.targetSnapshot.root)).pipe(Gl(null),Wc(1))}),MM(()=>this.afterPreactivation()),Xa(()=>{let{currentSnapshot:h,targetSnapshot:p}=c,f=this.createViewTransition?.(this.environmentInjector,h.root,p.root);return f?Is(f).pipe(Er(()=>c)):Hi(c)}),Er(h=>{let p=xj(i.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return this.currentTransition=c=As(di({},h),{targetRouterState:p}),this.currentNavigation.targetRouterState=p,c}),Gs(()=>{this.events.next(new tg)}),Sj(this.rootContexts,i.routeReuseStrategy,h=>this.events.next(h),this.inputBindingEnabled),Wc(1),Gs({next:h=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new wh(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{l=!0}}),D1(this.transitionAbortSubject.pipe(Gs(h=>{throw h}))),vm(()=>{!l&&!u&&this.cancelNavigationTransition(c,"",ba.SupersededByNewNavigation),this.currentNavigation?.id===c.id&&(this.currentNavigation=null)}),zl(h=>{if(u=!0,xP(h))this.events.next(new Yl(c.id,this.urlSerializer.serialize(c.extractedUrl),h.message,h.cancellationCode)),bj(h)?this.events.next(new ng(h.url)):c.resolve(!1);else{this.events.next(new eg(c.id,this.urlSerializer.serialize(c.extractedUrl),h,c.targetSnapshot??void 0));try{c.resolve(i.errorHandler(h))}catch(p){this.options.resolveNavigationPromiseOnError?c.resolve(!1):c.reject(p)}}return va}))}))}cancelNavigationTransition(i,s,o){let c=new Yl(i.id,this.urlSerializer.serialize(i.extractedUrl),s,o);this.events.next(c),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function _Q(n){return n!==Km}var bQ=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(MQ),providedIn:"root"});let n=e;return n})(),$M=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},MQ=(()=>{let e=class e extends $M{};e.\u0275fac=(()=>{let i;return function(o){return(i||(i=Vb(e)))(o||e)}})(),e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),SP=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:()=>si(wQ),providedIn:"root"});let n=e;return n})(),wQ=(()=>{let e=class e extends SP{constructor(){super(...arguments),this.location=si(zm),this.urlSerializer=si(JM),this.options=si(rw,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=si(ow),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ql,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=pP(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(s=>{s.type==="popstate"&&i(s.url,s.state)})}handleRouterEvent(i,s){if(i instanceof Zm)this.stateMemento=this.createStateMemento();else if(i instanceof Ch)this.rawUrlTree=s.initialUrl;else if(i instanceof Yv){if(this.urlUpdateStrategy==="eager"&&!s.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(s.finalUrl,s.initialUrl);this.setBrowserUrl(o,s)}}else i instanceof tg?(this.currentUrlTree=s.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(s.finalUrl,s.initialUrl),this.routerState=s.targetRouterState,this.urlUpdateStrategy==="deferred"&&(s.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,s))):i instanceof Yl&&(i.code===ba.GuardRejected||i.code===ba.NoDataFromResolver)?this.restoreHistory(s):i instanceof eg?this.restoreHistory(s,!0):i instanceof wh&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,s){let o=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(o)||s.extras.replaceUrl){let c=this.browserPageId,l=di(di({},s.extras.state),this.generateNgRouterState(s.id,c));this.location.replaceState(o,"",l)}else{let c=di(di({},s.extras.state),this.generateNgRouterState(s.id,this.browserPageId+1));this.location.go(o,"",c)}}restoreHistory(i,s=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,c=this.currentPageId-o;c!==0?this.location.historyGo(c):this.currentUrlTree===i.finalUrl&&c===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(s&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,s){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:s}:{navigationId:i}}};e.\u0275fac=(()=>{let i;return function(o){return(i||(i=Vb(e)))(o||e)}})(),e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),qm=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(qm||{});function CQ(n,e){n.events.pipe(Qa(t=>t instanceof wh||t instanceof Yl||t instanceof eg||t instanceof Ch),Er(t=>t instanceof wh||t instanceof Ch?qm.COMPLETE:(t instanceof Yl?t.code===ba.Redirect||t.code===ba.SupersededByNewNavigation:!1)?qm.REDIRECTING:qm.FAILED),Qa(t=>t!==qm.REDIRECTING),Wc(1)).subscribe(()=>{e()})}function SQ(n){throw n}var TQ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},IQ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},TP=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=si(Pv),this.stateManager=si(SP),this.options=si(rw,{optional:!0})||{},this.pendingTasks=si(Bv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=si(EQ),this.urlSerializer=si(JM),this.location=si(zm),this.urlHandlingStrategy=si(ow),this._events=new na,this.errorHandler=this.options.errorHandler||SQ,this.navigated=!1,this.routeReuseStrategy=si(bQ),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=si(sw,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!si(tw,{optional:!0}),this.eventsSubscription=new Ts,this.isNgZoneEnabled=si(vs)instanceof vs&&vs.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(s=>{try{let o=this.navigationTransitions.currentTransition,c=this.navigationTransitions.currentNavigation;if(o!==null&&c!==null){if(this.stateManager.handleRouterEvent(s,c),s instanceof Yl&&s.code!==ba.Redirect&&s.code!==ba.SupersededByNewNavigation)this.navigated=!0;else if(s instanceof wh)this.navigated=!0;else if(s instanceof ng){let l=this.urlHandlingStrategy.merge(s.url,o.currentRawUrl),u={info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||_Q(o.source)};this.scheduleNavigation(l,Km,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}DQ(s)&&this._events.next(s)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Km,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,s)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",s)},0)})}navigateToSyncWithBrowser(i,s,o){let c={replaceUrl:!0},l=o?.navigationId?o:null;if(o){let h=di({},o);delete h.navigationId,delete h.\u0275routerPageId,Object.keys(h).length!==0&&(c.state=h)}let u=this.parseUrl(i);this.scheduleNavigation(u,s,l,c)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(nw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,s={}){let{relativeTo:o,queryParams:c,fragment:l,queryParamsHandling:u,preserveFragment:h}=s,p=h?this.currentUrlTree.fragment:l,f=null;switch(u){case"merge":f=di(di({},this.currentUrlTree.queryParams),c);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=c||null}f!==null&&(f=this.removeEmptyProps(f));let m;try{let A=o?o.snapshot:this.routerState.snapshot.root;m=uP(A)}catch{(typeof i[0]!="string"||!i[0].startsWith("/"))&&(i=[]),m=this.currentUrlTree.root}return hP(m,i,f,p??null)}navigateByUrl(i,s={skipLocationChange:!1}){let o=ff(i)?i:this.parseUrl(i),c=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(c,Km,null,s)}navigate(i,s={skipLocationChange:!1}){return RQ(i),this.navigateByUrl(this.createUrlTree(i,s),s)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,s){let o;if(s===!0?o=di({},TQ):s===!1?o=di({},IQ):o=s,ff(i))return YL(this.currentUrlTree,i,o);let c=this.parseUrl(i);return YL(this.currentUrlTree,c,o)}removeEmptyProps(i){return Object.entries(i).reduce((s,[o,c])=>(c!=null&&(s[o]=c),s),{})}scheduleNavigation(i,s,o,c,l){if(this.disposed)return Promise.resolve(!1);let u,h,p;l?(u=l.resolve,h=l.reject,p=l.promise):p=new Promise((m,A)=>{u=m,h=A});let f=this.pendingTasks.add();return CQ(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:s,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:c,resolve:u,reject:h,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(m=>Promise.reject(m))}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Xi({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function RQ(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ki(4008,!1)}function DQ(n){return!(n instanceof tg)&&!(n instanceof ng)}var LQ=new _r("");function IP(n,...e){return Mv([{provide:sw,multi:!0,useValue:n},[],{provide:pf,useFactory:PQ,deps:[TP]},{provide:cM,multi:!0,useFactory:BQ},e.map(t=>t.\u0275providers)])}function PQ(n){return n.routerState.root}function BQ(){let n=si(nf);return e=>{let t=n.get(Hm);if(e!==t.components[0])return;let i=n.get(TP),s=n.get(OQ);n.get(NQ)===1&&i.initialNavigation(),n.get(FQ,null,sr.Optional)?.setUpPreloading(),n.get(LQ,null,sr.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}var OQ=new _r("",{factory:()=>new na}),NQ=new _r("",{providedIn:"root",factory:()=>1});var FQ=new _r("");var RP=[];var DP={providers:[IP(RP)]};var xme=uR(LP());JP();HN();JN();t4();o4();if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("environment",{schema:{active:{default:!1},preset:{default:"default",oneOf:["none","default","contact","egypt","checkerboard","forest","goaland","yavapai","goldmine","arches","threetowers","poison","tron","japan","dream","volcano","starry","osiris"]},seed:{type:"int",default:1,min:0,max:1e3},skyType:{default:"color",oneOf:["none","color","gradient","atmosphere"]},skyColor:{type:"color"},horizonColor:{type:"color"},lighting:{default:"distant",oneOf:["none","distant","point"]},shadow:{default:!1},shadowSize:{default:10},lightPosition:{type:"vec3",default:{x:0,y:1,z:-.2}},fog:{type:"float",default:0,min:0,max:1},flatShading:{default:!1},playArea:{type:"float",default:1,min:.5,max:10},ground:{default:"hills",oneOf:["none","flat","hills","canyon","spikes","noise"]},groundYScale:{type:"float",default:3,min:0,max:50},groundTexture:{default:"none",oneOf:["none","checkerboard","squares","walkernoise"]},groundColor:{type:"color",default:"#553e35"},groundColor2:{type:"color",default:"#694439"},dressing:{default:"none",oneOf:["none","cubes","pyramids","cylinders","hexagons","stones","trees","mushrooms","towers","apparatus","arches","torii"]},dressingAmount:{type:"int",default:10,min:0,max:1e3},dressingColor:{type:"color",default:"#795449"},dressingScale:{type:"float",default:5,min:0,max:100},dressingVariance:{type:"vec3",default:{x:1,y:1,z:1}},dressingUniformScale:{default:!0},dressingOnPlayArea:{type:"float",default:0,min:0,max:1},grid:{default:"none",oneOf:["none","1x1","2x2","crosses","dots","xlines","ylines"]},gridColor:{type:"color",default:"#ccc"}},multiple:!1,presets:{none:{},default:{active:!0,seed:1,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:-.11,y:1,z:.33},fog:.78,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"checkerboard",groundColor:"#454545",groundColor2:"#5d5d5d",dressing:"none",dressingAmount:10,dressingColor:"#795449",dressingScale:1,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#ccc",shadow:!1},contact:{active:!0,seed:14,skyType:"gradient",skyColor:"#478d54",horizonColor:"#b696cb",lighting:"distant",lightPosition:{x:0,y:2.01,z:-1},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.91,groundTexture:"none",groundColor:"#2e455f",groundColor2:"#694439",dressing:"apparatus",dressingAmount:7,dressingColor:"#657067",dressingScale:20,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"1x1",gridColor:"#478d54",shadow:!1},egypt:{active:!0,seed:26,skyType:"gradient",skyColor:"#1b7660",horizonColor:"#e4b676",lighting:"distant",lightPosition:{x:0,y:1.65,z:-1},fog:.75,flatShading:!1,playArea:1,ground:"hills",groundYScale:5,groundTexture:"walkernoise",groundColor:"#664735",groundColor2:"#6c4b39",dressing:"pyramids",dressingAmount:10,dressingColor:"#7c5c45",dressingScale:5,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"spots",gridColor:"#e4b676",shadow:!1},checkerboard:{active:!0,seed:1,skyType:"gradient",skyColor:"#0d0d0d",horizonColor:"#404040",lighting:"distant",lightPosition:{x:0,y:1,z:-.2},fog:.81,flatShading:!0,playArea:1,ground:"hills",groundYScale:4.81,groundTexture:"checkerboard",groundColor:"#252525",groundColor2:"#111111",dressing:"cubes",dressingAmount:10,dressingColor:"#9f9f9f",dressingScale:1.51,dressingVariance:{x:5,y:20,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"dots",gridColor:"#ccc",shadow:!1},forest:{active:!0,seed:8,skyType:"gradient",skyColor:"#24b59f",horizonColor:"#eff9b7",lighting:"distant",lightPosition:{x:-1.2,y:.88,z:-.55},fog:.8,flatShading:!1,playArea:1,ground:"noise",groundYScale:4.18,groundTexture:"squares",groundColor:"#937a24",groundColor2:"#987d2e",dressing:"trees",dressingAmount:500,dressingColor:"#888b1d",dressingScale:1,dressingVariance:{x:10,y:10,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#c5a543",shadow:!1},goaland:{active:!0,seed:17,skyType:"gradient",skyColor:"#14645f",horizonColor:"#a3dab8",lighting:"point",lightPosition:{x:.1,y:4,z:.56},fog:.73,flatShading:!1,playArea:1,ground:"noise",groundYScale:.81,groundTexture:"none",groundColor:"#ae3241",groundColor2:"#db4453",dressing:"mushrooms",dressingAmount:150,dressingColor:"#a9313d",dressingScale:5,dressingVariance:{x:5,y:10,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"dots",gridColor:"#239893",shadow:!1},yavapai:{active:!0,seed:11,skyType:"gradient",skyColor:"#239849",horizonColor:"#cfe0af",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!0,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#C66344",groundColor2:"#c96b4b",dressing:"stones",dressingAmount:500,dressingColor:"#C66344",dressingScale:.06,dressingVariance:{x:.2,y:.1,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1},goldmine:{active:!0,seed:53,skyType:"gradient",skyColor:"#1e1c1a",horizonColor:"#8c7964",lighting:"point",lightPosition:{x:-.09,y:3,z:.33},fog:.43,flatShading:!0,playArea:1.08,ground:"canyon",groundYScale:50,groundTexture:"none",groundColor:"#353535",groundColor2:"#454545",dressing:"hexagons",dressingAmount:300,dressingColor:"#fe921b",dressingScale:.5,dressingVariance:{x:2,y:8,z:2},dressingUniformScale:!0,dressingOnPlayArea:.03,grid:"none",gridColor:"#ccc",shadow:!1},threetowers:{active:!0,seed:5,skyType:"gradient",skyColor:"#23a06b",horizonColor:"#f5e170",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.26,groundTexture:"walkernoise",groundColor:"#273a49",groundColor2:"#2b464f",dressing:"towers",dressingAmount:3,dressingColor:"#5f6d94",dressingScale:50,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#239893",shadow:!1},poison:{active:!0,seed:92,skyType:"gradient",skyColor:"#1ea84a",horizonColor:"#177132",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!1,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"none",groundColor:"#851f31",groundColor2:"#912235",dressing:"hexagons",dressingAmount:20,dressingColor:"#c7415b",dressingScale:20,dressingVariance:{x:20,y:200,z:20},dressingUniformScale:!1,dressingOnPlayArea:0,grid:"crosses",gridColor:"#1ea84a",shadow:!1},arches:{active:!0,seed:19,skyType:"atmosphere",skyColor:"#8cbdc8",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:-.11,y:.16,z:.33},fog:.67,flatShading:!0,playArea:1,ground:"canyon",groundYScale:10,groundTexture:"walkernoise",groundColor:"#a87d6f",groundColor2:"#795449",dressing:"arches",dressingAmount:6,dressingColor:"#795449",dressingScale:26,dressingVariance:{x:20,y:40,z:20},dressingUniformScale:!0,dressingOnPlayArea:.04,grid:"none",gridColor:"#ccc",shadow:!1},tron:{active:!0,seed:14,skyType:"gradient",skyColor:"#091b39",horizonColor:"#284a9e",lighting:"distant",lightPosition:{x:-.72,y:.62,z:.4},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.91,groundTexture:"none",groundColor:"#061123",groundColor2:"#694439",dressing:"towers",dressingAmount:5,dressingColor:"#fb000e",dressingScale:15,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"1x1",gridColor:"#fb000e",shadow:!1},japan:{active:!0,seed:14,skyType:"gradient",skyColor:"#7e5db5",horizonColor:"#b4adda",lighting:"distant",lightPosition:{x:1.33,y:1,z:.24},fog:.9,flatShading:!1,playArea:1,ground:"hills",groundYScale:25,groundTexture:"walkernoise",groundColor:"#7e5db5",groundColor2:"#cabdf5",dressing:"torii",dressingAmount:4,dressingColor:"#bc5e7c",dressingScale:15,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"spots",gridColor:"#e4b676",shadow:!1},dream:{active:!0,seed:17,skyType:"gradient",skyColor:"#87faf4",horizonColor:"#b34093",lighting:"distant",lightPosition:{x:-.72,y:.53,z:.97},fog:.8,flatShading:!1,playArea:1,ground:"hills",groundYScale:20,groundTexture:"checkerboard",groundColor:"#b34093",groundColor2:"#c050a2",dressing:"mushrooms",dressingAmount:300,dressingColor:"#3cf7ed",dressingScale:.2,dressingVariance:{x:.2,y:.2,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1},volcano:{active:!0,seed:92,skyType:"gradient",skyColor:"#4a070f",horizonColor:"#f62300",lighting:"point",lightPosition:{x:.5,y:2.25,z:0},fog:.87,flatShading:!1,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#fb0803",groundColor2:"#510000",dressing:"arches",dressingAmount:15,dressingColor:"#fb0803",dressingScale:3,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!1,dressingOnPlayArea:.2,grid:"none",gridColor:"#fa0e00",shadow:!1},starry:{active:!0,seed:1,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:0,y:-.01,z:-.46},fog:.7,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"none",groundColor:"#553e35",groundColor2:"#694439",dressing:"none",dressingAmount:100,dressingColor:"#795449",dressingScale:5,dressingVariance:{x:1,y:1,z:1},dressingUniformScale:!0,grid:"1x1",dressingOnPlayArea:0,gridColor:"#39d2f2",shadow:!1},osiris:{active:!0,seed:46,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:0,y:.02,z:-.46},fog:0,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"none",groundColor:"#9e7b47",groundColor2:"#9e7b47",dressing:"pyramids",dressingAmount:7,dressingColor:"#9e7b47",dressingScale:5,dressingVariance:{x:30,y:30,z:30},dressingUniformScale:!0,grid:"dots",dressingOnPlayArea:0,gridColor:"#daa452",shadow:!1},moon:{active:!0,seed:11,skyType:"gradient",skyColor:"#000000",horizonColor:"#000000",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!0,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#D1D1D1",groundColor2:"#494949",dressing:"stones",dressingAmount:500,dressingColor:"#494949",dressingScale:.06,dressingVariance:{x:.2,y:.1,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1}},init:function(){this.environmentData={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.STAGE_SIZE=200,this.assets={arches:[{type:"mesh",vertices:[409,268,4,351,228,36,336,236,-57,-152,391,69,-135,358,88,-119,330,43,-20,358,-35,-153,357,-47,37,413,-26,-20,411,-14,-302,148,154,-339,121,-126,-389,200,-88,-477,193,-76,-314,346,-19,-314,306,-30,-250,296,-73,-267,237,-82,-212,303,-68,-245,200,-67,-223,304,108,-329,299,107,-289,350,76,-320,342,69,119,373,-39,38,370,8,113,367,52,492,202,-31,462,83,-104,447,71,-80,426,112,25,482,189,-7,222,372,6,121,402,41,87,382,67,221,346,55,559,93,-13,528,47,39,505,21,-111,528,54,-101,616,31,-53,442,256,-15,300,338,19,257,308,-79,408,256,-74,312,352,-26,384,297,-31,437,257,-47,-29,415,53,-232,377,59,-139,335,77,-132,344,2,-18,377,-37,-171,387,-28,-254,384,18,-651,-27,27,-435,-28,179,-345,149,165,-272,-28,23,-215,146,-2,-279,-29,-59,-211,145,-55,-337,-28,-128,-413,247,0,-293,363,24,-214,254,-36,-164,290,33,-284,150,94,-218,362,105,75,369,29,518,147,-63,447,190,-70,445,56,-105,391,185,-60,431,49,-33,459,83,26,470,162,42,130,390,53,167,341,-30,125,394,-45,239,368,-17,91,414,10,450,18,2,449,-27,-9,436,-28,-58,496,-27,-110,582,-28,-140,647,-27,-56,325,325,-45,-307,297,-56,-647,-28,-45,-188,310,-54,-264,197,113,-367,175,139,8,387,82,426,45,-55,114,359,-28,500,27,44,461,-29,13,-512,-27,-151,-152,376,-38,-490,-28,148,12,370,-28,442,160,42,465,194,32,381,183,-33,649,-27,-34,444,16,29,616,-28,25,417,267,-66,-132,352,-34,-322,-27,130,-271,86,-115,-635,-28,-121,-291,203,-99,176,405,-10,561,52,-93,371,305,9,311,237,-22,377,200,-81,-129,406,46,-154,371,99,-82,361,71,-21,354,26,-91,363,-27,-165,413,-12,-414,215,110,-238,127,26,-408,-28,-128,-674,-28,-94,-446,232,-39,-311,226,-90,-255,210,-61,-235,192,-11,-217,218,58,-269,299,124,-386,276,78,-399,281,42,15,373,58,16,393,75,549,107,-46,481,188,-68,409,120,-41,541,81,12,230,368,41,194,350,-50,224,361,-50,604,-28,-10,602,-27,35,486,56,-121,502,69,-120,457,-27,-110,226,317,-40,-584,-28,-124,439,-26,-30,467,-26,39,547,-27,-146,21,368,14,466,229,-29,578,-27,44,609,-27,-96,291,356,-15,290,306,34,255,321,28,231,311,-5,-251,386,50,-183,307,87,-152,307,24,-264,373,-12,-392,-27,190,-333,-28,84,-281,-27,54,-270,-28,-23,-308,-28,-101,-687,-27,-59,39,418,39,413,163,25,404,206,-90,54,400,-31,121,352,8,-454,41,148,-426,9,182,-564,115,3,-427,27,-107,-548,118,-32,-556,122,-53,-517,91,-101,-475,54,140,-461,52,-134,-558,119,-71,-434,286,59,-687,-31,52,-595,146,22,-670,-28,164,-537,166,122,-575,-28,217,-566,159,65,-470,152,136,-712,-29,102,-639,-29,211,-532,-30,181,-442,-30,-100],faces:[76,104,162,1,176,103,103,76,1,2,119,73,73,105,2,2,118,152,45,161,46,46,109,45,3,120,49,49,68,3,3,121,139,139,48,3,4,122,94,94,121,4,6,123,124,9,175,81,10,169,111,10,67,92,88,43,146,11,131,114,11,128,183,13,130,15,90,184,174,90,182,184,130,184,63,14,130,63,15,130,14,16,131,12,15,168,53,18,91,17,131,16,17,65,133,132,65,132,91,67,134,166,166,92,67,20,135,92,20,166,4,4,121,20,22,135,68,25,102,96,25,157,102,69,138,157,69,157,25,39,150,71,71,141,39,28,150,149,149,72,28,142,176,105,36,140,27,27,143,36,32,115,81,32,144,161,161,80,32,77,35,144,34,26,77,78,179,96,145,152,78,178,79,145,80,146,79,147,140,36,143,108,36,143,37,148,74,95,154,154,83,74,72,149,151,151,95,72,38,150,156,40,147,106,70,140,40,40,116,70,42,162,0,35,163,162,43,145,146,46,117,41,47,158,27,48,139,175,122,138,94,157,138,123,52,178,102,52,102,6,52,124,7,7,100,52,53,125,8,57,93,181,56,169,181,59,127,58,60,173,61,62,128,11,11,112,62,65,91,167,65,167,66,126,93,21,22,68,49,72,95,29,142,29,74,74,82,142,75,107,97,75,97,103,76,97,37,104,143,31,78,152,164,78,164,179,79,178,8,97,155,159,107,98,155,83,98,82,154,95,84,39,116,86,86,156,39,87,160,116,24,145,96,162,104,0,105,118,2,43,177,119,44,177,43,91,51,167,44,88,109,46,161,117,3,68,121,3,48,120,4,166,50,50,122,4,5,123,122,123,138,122,110,124,51,170,10,111,110,91,7,7,124,110,8,125,9,9,81,8,186,12,188,92,135,10,11,114,112,64,63,137,13,15,89,89,53,100,64,168,14,14,168,15,89,100,16,16,12,89,100,18,16,17,91,132,112,19,61,18,7,91,19,17,132,133,127,59,133,59,61,136,21,22,134,127,133,20,92,166,121,135,20,158,31,27,21,135,22,23,137,136,24,102,178,178,145,24,25,179,69,26,94,138,27,140,70,27,70,141,150,177,71,28,177,150,29,142,73,73,119,29,142,82,30,30,176,142,107,75,82,31,143,27,33,81,175,31,41,104,115,79,8,32,33,144,80,115,32,33,175,139,35,162,42,77,139,34,163,26,179,163,179,164,78,96,145,177,29,119,108,143,148,148,37,159,97,159,37,74,83,82,38,149,150,156,150,39,40,106,87,87,116,40,140,147,40,161,144,42,42,117,161,41,0,104,41,117,0,0,117,42,164,118,163,1,163,118,118,176,1,118,105,176,152,118,164,43,152,145,43,119,2,71,109,141,47,41,158,44,71,177,45,109,88,45,88,146,46,47,109,141,47,27,167,50,166,49,120,165,139,121,94,5,122,50,123,51,124,157,6,102,157,123,6,100,8,178,5,167,51,6,124,52,100,178,52,53,168,125,125,165,120,54,125,168,9,48,175,120,9,125,93,10,135,181,101,56,57,169,10,59,172,61,67,170,171,67,171,127,58,127,171,129,186,113,60,61,172,61,173,112,62,112,173,174,189,129,165,64,23,64,137,23,165,22,49,64,54,168,17,114,131,17,112,114,66,133,65,19,132,133,19,133,61,134,133,66,166,134,66,166,66,167,93,135,21,68,135,121,23,136,22,94,34,139,25,96,179,26,138,69,69,179,26,30,103,176,116,141,70,39,141,116,73,142,105,143,76,37,26,35,77,103,97,76,77,144,33,33,139,77,38,151,149,80,161,45,80,45,146,81,115,8,107,155,97,82,98,107,95,151,84,38,156,85,86,116,160,96,102,24,72,29,28,29,95,74,75,30,82,108,147,36,88,44,43,91,110,51,170,67,10,11,183,131,64,14,63,89,15,53,100,7,18,112,17,19,127,134,67,136,126,21,158,41,31,33,32,81,115,80,79,177,28,29,43,2,152,71,44,109,47,46,41,141,109,47,167,5,50,123,5,51,100,53,8,125,54,165,9,120,48,93,57,10,59,58,172,174,185,189,165,54,64,165,23,22,94,26,34,30,75,103,143,104,76,26,163,35,38,85,151,192,182,191,183,128,201,12,13,89,181,169,57,186,153,113,188,183,99,184,182,63,185,13,189,180,181,93,186,99,153,189,186,129,185,184,130,186,13,12,187,93,126,193,199,194,194,196,193,200,187,195,187,197,195,187,126,197,197,190,194,190,136,137,190,196,194,63,182,192,63,192,196,192,198,196,191,182,55,193,196,198,194,199,197,195,197,199,136,197,126,190,137,63,190,63,196,197,136,190,192,191,198,201,99,183,90,55,182,181,180,101,185,130,13,186,188,99,186,189,13,187,180,93,200,101,187,183,188,131,184,185,174,180,187,101,16,18,17,12,131,188,35,42,144,163,1,162,76,162,1,79,146,145]}],stones:[{type:"mesh",vertices:[-376,189,42,230,223,-310,353,162,-62,414,-23,-67,256,90,-475,24,85,-526,-418,-16,57,-432,66,-40,-199,151,-376,-155,49,467,-91,289,201,293,197,91,81,-17,-480,42,108,431,-359,-17,-250,383,-19,-243,194,-15,270,-272,180,293,-86,212,262,234,54,297,395,97,-302,-123,-21,-444,-416,-19,-123,-323,-18,267,-100,-16,429,-300,96,-361,163,-19,409,118,201,-431,-241,-18,391,-130,274,-309,306,-19,-399,-221,96,404],faces:[31,18,17,0,17,18,3,20,2,18,11,10,29,27,8,27,29,1,0,18,10,10,29,0,16,19,26,11,2,1,20,30,4,20,3,15,30,12,4,4,12,5,5,27,4,4,27,20,21,25,5,7,8,25,22,7,14,7,25,14,23,28,31,0,7,17,24,26,9,31,28,9,8,27,5,2,20,1,13,19,18,10,11,1,19,13,26,3,11,19,19,16,3,11,3,2,11,18,19,20,15,30,29,10,1,25,21,14,8,5,25,5,12,21,6,7,22,7,6,23,8,0,29,8,7,0,23,31,7,13,31,9,18,31,13,9,28,24,26,13,9,27,1,20,7,31,17]},{type:"mesh",vertices:[-217,34,-153,198,90,20,212,85,169,-131,93,171,197,113,30,173,121,164,315,29,-16,219,24,189,282,50,-102,232,38,-181,-195,-9,-166,-156,30,-207,-51,-9,-231,-180,91,-173,-19,73,-204,-280,23,96,-242,100,107,3,158,-82,109,88,221,275,-10,-40,236,-10,-135,-178,49,184,-1,-10,-243,265,-11,109,-12,-9,237,-36,46,251,-233,86,-81,93,77,-171,-163,133,69,18,16,263,296,44,93,131,-12,-226,-89,-10,-201,-273,-10,-51,-240,-9,110,190,-12,192,-253,-11,-92,42,43,-258,-115,-11,238,168,99,-88,-285,-10,24,71,124,-158,298,-10,10,116,150,-24,-282,44,39],faces:[44,16,26,13,26,16,0,26,13,27,14,41,4,5,1,7,30,2,28,5,43,41,39,27,17,43,41,43,4,39,13,28,17,17,41,13,28,43,17,24,29,38,29,35,7,18,25,29,5,18,2,18,5,3,30,42,6,30,35,23,19,20,8,8,20,9,9,39,8,1,30,8,31,37,9,11,14,37,14,27,37,32,11,12,11,37,12,11,0,13,33,40,44,44,26,33,33,0,36,34,38,15,44,40,15,21,3,16,27,39,9,2,30,1,21,25,3,16,3,28,28,3,5,4,43,5,41,43,39,13,16,28,25,21,38,38,29,25,7,18,29,29,24,35,18,7,2,18,3,25,30,23,42,30,7,35,8,30,6,6,19,8,6,42,19,8,39,1,37,31,22,27,9,37,9,20,31,10,11,32,11,10,0,12,37,22,14,13,41,14,11,13,33,26,0,36,0,10,21,44,15,16,44,21,15,40,34,38,21,15,4,1,39,5,2,1]},{type:"mesh",vertices:[-101,102,57,99,35,102,40,72,80,59,14,-168,-186,22,45,-176,25,-30,66,-7,146,153,-7,53,-110,47,-96,-90,-8,-146,150,-7,-12,-200,-7,8,-173,-7,-55,55,46,-60,125,-7,110,136,30,-10,-149,58,68,-15,82,-71,98,-7,-86,-34,-6,-194,-33,-7,171,-36,65,137,38,-8,-192,-103,-9,147,-12,62,-152],faces:[2,17,0,17,8,0,17,24,8,19,24,22,5,11,4,2,13,17,17,13,24,21,23,20,1,2,21,7,15,1,7,10,15,5,9,12,15,18,13,0,5,16,0,8,5,1,15,2,10,18,15,3,13,18,24,3,22,11,23,4,4,16,5,16,4,23,24,13,3,15,13,2,6,1,21,6,21,20,6,14,1,2,0,21,1,14,7,3,18,22,8,24,19,8,19,9,12,11,5,5,8,9,16,23,21,16,21,0]},{type:"mesh",vertices:[86,55,-18,58,38,73,97,-12,79,135,7,10,-93,-11,-72,-133,5,33,13,68,-32,94,-11,-57,-90,52,53,-24,-11,-106,-13,-10,104,-75,49,-69,-12,18,114,49,-12,-96,-46,-11,-85,-119,-11,-26,48,5,-111,-58,-11,105,-117,-12,52,-5,35,-93,123,-11,7],faces:[5,8,11,2,3,1,8,1,6,11,8,6,6,19,11,10,12,17,20,7,3,3,7,16,16,0,3,16,9,19,14,4,9,15,18,5,5,11,15,18,17,5,19,0,16,1,3,0,0,6,1,19,6,0,12,8,17,2,1,12,12,10,2,1,8,12,3,2,20,16,13,9,16,7,13,19,4,11,15,11,4,17,8,5,9,4,19]}],torii:[{type:"mesh",mirror:!0,flatShading:!0,vertices:[692,966,-52,661,834,-52,692,966,52,661,834,52,0,894,-52,0,776,-52,0,894,52,0,776,52,518,935,52,345,913,52,170,899,52,162,779,52,328,790,52,494,808,52,170,899,-52,345,913,-52,518,935,-52,494,808,-52,328,790,-52,162,779,-52,0,618,16,0,697,16,0,618,-16,0,697,-16,586,618,16,586,697,16,586,618,-16,586,697,-16,331,-29,-75,331,766,-52,369,-29,-65,357,766,-45,396,-29,-37,377,766,-26,406,-29,0,384,766,0,396,-29,37,377,766,26,369,-29,65,357,766,45,331,-29,75,331,766,52,294,-29,65,305,766,45,267,-29,37,286,766,26,257,-29,0,279,766,0,267,-29,-37,286,766,-26,294,-29,-65,305,766,-45,0,777,85,0,681,33,333,762,-75,333,806,-75,371,762,-65,371,806,-65,398,762,-37,398,806,-37,408,762,0,408,806,0,398,762,37,398,806,37,371,762,65,371,806,65,333,762,75,333,806,75,296,762,65,296,806,65,268,762,37,268,806,37,258,762,0,258,806,0,268,762,-37,268,806,-37,296,762,-65,296,806,-65,0,681,-33,0,777,-85,52,681,33,52,777,85,52,681,-33,52,777,-85],faces:[4,10,14,1,13,17,11,6,7,0,3,1,16,1,17,4,19,5,14,18,19,15,17,18,3,8,13,13,9,12,12,10,11,19,7,5,19,12,11,18,13,12,16,2,0,15,8,16,14,9,15,23,26,22,27,24,26,25,20,24,26,20,22,23,25,27,29,30,28,31,32,30,33,34,32,35,36,34,37,38,36,39,40,38,41,42,40,43,44,42,45,46,44,47,48,46,49,50,48,51,28,50,55,56,54,57,58,56,59,60,58,61,62,60,63,64,62,79,81,83,65,66,64,82,53,78,67,68,66,81,53,80,69,70,68,83,80,82,71,72,70,79,82,78,73,74,72,75,63,59,75,76,74,77,54,76,60,68,76,4,6,10,1,3,13,11,10,6,0,2,3,16,0,1,4,14,19,14,15,18,15,16,17,3,2,8,13,8,9,12,9,10,19,11,7,19,18,12,18,17,13,16,8,2,15,9,8,14,10,9,23,27,26,27,25,24,25,21,20,26,24,20,23,21,25,29,31,30,31,33,32,33,35,34,35,37,36,37,39,38,39,41,40,41,43,42,43,45,44,45,47,46,47,49,48,49,51,50,51,29,28,55,57,56,57,59,58,59,61,60,61,63,62,63,65,64,79,52,81,65,67,66,82,80,53,67,69,68,81,52,53,69,71,70,83,81,80,71,73,72,79,83,82,73,75,74,59,57,55,55,77,75,75,73,71,71,69,75,67,65,63,63,61,59,59,55,75,75,69,67,67,63,75,75,77,76,77,55,54,76,54,56,56,58,76,60,62,68,64,66,68,68,70,72,72,74,68,76,58,60,62,64,68,68,74,76]}],hexagons:[{type:"extrude",vertices:[-.198,-.302,.197,-.3,.372,0,.199,.298,-.202,.298,-.368,0]}],towers:[{type:"extrude",vertices:[-.054,-.178,-.007,-.182,.069,-.027,.189,.079,.178,.124,-.007,.097,-.145,.182,-.178,.144,-.079,-.021]},{type:"lathe",segments:4,vertices:[.004,.02,.012,.092,.042,.166,.067,.55,.101,.594,.105,.838,.193,.934,.18,.994]},{type:"lathe",segments:5,vertices:[.069,.216,.067,.562,.126,.562,.128,.774,.191,.774,.193,.986]}],trees:[{type:"lathe",noise:.015,segments:6,vertices:[1e-6,.826,.054,.832,.105,.854,.136,.9,.136,.958,.118,.994]},{type:"lathe",noise:.015,segments:14,vertices:[1e-6,.01,.069,.022,.13,.068,.178,.18,.189,.32,.191,.59,.193,.75,.138,.79,.018,.808,.018,.996]},{type:"lathe",noise:.015,segments:14,vertices:[1e-6,.436,.126,.46,.201,.57,.219,.72,.154,.846,.028,.884,.034,.996]}],apparatus:[{type:"lathe",segments:10,vertices:[1e-6,.23,.042,.23,.069,.36,.038,.362,.038,.372,.06,.372,.073,.572,.024,.572,.024,.67,.069,.67,.075,.722,.097,.724,.105,.852,.083,.902,.065,.902,.065,.924,.128,.924,.146,.996]},{type:"lathe",segments:16,vertices:[1e-6,.232,.229,.182,.486,.07,.356,.182,.213,.242,.154,.242,.144,.262,.178,.262,.126,.314,.04,.328,.038,.374,.058,.374,.071,.408,.026,.406,.03,.42,.091,.418,.034,.496,.01,.498,.03,.506,.014,.998]}],mushrooms:[{type:"lathe",noise:.02,segments:14,vertices:[1e-6,.006,.13,.018,.341,.084,.437,.144,.492,.234,.484,.246,.276,.232,.107,.284,.046,.346,.062,.852,.097,.956,.166,.998]},{type:"lathe",noise:.02,segments:10,vertices:[1e-6,.562,.091,.572,.172,.61,.223,.666,.256,.74,.258,.806,.246,.824,.062,.826,.065,.948,.097,.998]},{type:"lathe",noise:.02,segments:10,vertices:[1e-6,.768,.099,.772,.219,.802,.306,.844,.352,.886,.352,.908,.118,.904,.107,.93,.115,.966,.14,.996]}]};for(var n in this.assets)for(var e=0;e<this.assets[n].length;e++){var t=this.assets[n][e];if(t.type=="mesh")for(var i=0,s=t.vertices.length;i<s;i++)t.vertices[i]/=1e3}this.userFog=this.el.sceneEl.getAttribute("fog"),this.sky=document.createElement("a-sky"),this.sky.setAttribute("radius",this.STAGE_SIZE),this.sky.setAttribute("theta-length",110),this.sky.classList.add("environment"),this.stars=null,this.ground=document.createElement("a-entity"),this.ground.setAttribute("rotation","-90 0 0"),this.ground.classList.add("environmentGround"),this.ground.classList.add("environment"),this.groundCanvas=null,this.groundTexture=null,this.groundMaterial=null,this.groundGeometry=null,this.dressing=document.createElement("a-entity"),this.dressing.classList.add("environmentDressing"),this.dressing.classList.add("environment"),this.gridCanvas=null,this.gridTexture=null,this.hemilight=document.createElement("a-entity"),this.hemilight.classList.add("environment"),this.hemilight.setAttribute("position","0 50 0"),this.hemilight.setAttribute("light",{type:"hemisphere",color:"#CEE4F0",intensity:.4}),this.sunlight=document.createElement("a-entity"),this.sunlight.classList.add("environment"),this.sunlight.setAttribute("position",this.data.lightPosition),this.sunlight.setAttribute("light",{intensity:.6}),this.el.appendChild(this.hemilight),this.el.appendChild(this.sunlight),this.el.appendChild(this.ground),this.el.appendChild(this.dressing),this.el.appendChild(this.sky)},getFogColor:function(n,e){var t;if(n=="color"||n=="none")t=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace);else if(n=="gradient")t=new THREE.Color().setStyle(this.environmentData.horizonColor,THREE.NoColorSpace);else if(n=="atmosphere"){var i=[1,.5,.22,.1,.05,0],s=["#C0CDCF","#81ADC5","#525e62","#2a2d2d","#141616","#000"];if(e<=0)return"#000";e=Math.min(1,e);for(var o=0;o<i.length;o++)if(e>i[o]){var c=new THREE.Color().setStyle(s[o-1],THREE.NoColorSpace),l=new THREE.Color().setStyle(s[o],THREE.NoColorSpace),u=(e-i[o])/(i[o-1]-i[o]);l.lerp(c,u),t=l;break}}return t.multiplyScalar(.9),t.lerp(new THREE.Color().setStyle(this.data.groundColor,THREE.NoColorSpace),.3),t.setRGB(t.r,t.g,t.b,THREE.SRGBColorSpace),"#"+t.getHexString()},update:function(n){var e;this.data.preset?(e=AFRAME.utils.clone(this.environmentData),this.environmentData={},Object.assign(this.environmentData,this.data),Object.assign(this.environmentData,this.presets[this.data.preset]),Object.assign(this.environmentData,this.el.components.environment.attrValue),console.log(this.environmentData)):(e=n,this.environmentData=this.data);var t=this.environmentData.skyType,i=new THREE.Vector3(this.environmentData.lightPosition.x,this.environmentData.lightPosition.y,this.environmentData.lightPosition.z);if(i.normalize(),this.sunlight){if(this.sunlight.setAttribute("position",this.environmentData.lightPosition),t!="atmosphere"){var s=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace);s.setRGB((s.r+1)/2,(s.g+1)/2,(s.b+1)/2,THREE.SRGBColorSpace),this.hemilight.setAttribute("light",{color:"#"+s.getHexString(),intensity:.6}),this.sunlight.setAttribute("light",{intensity:.6})}else this.hemilight.setAttribute("light",{color:"#CEE4F0",intensity:.1+i.y*.5}),this.sunlight.setAttribute("light",{intensity:.1+i.y*.5});this.sunlight.setAttribute("light",{castShadow:this.environmentData.shadow,shadowCameraLeft:-this.environmentData.shadowSize,shadowCameraBottom:-this.environmentData.shadowSize,shadowCameraRight:this.environmentData.shadowSize,shadowCameraTop:this.environmentData.shadowSize})}if(t!==e.skyType||this.environmentData.skyColor!=e.skyColor||this.environmentData.horizonColor!=e.horizonColor){var o={};o.shader={none:"flat",color:"flat",gradient:"gradientshader",atmosphere:"skyshader"}[t],this.stars&&this.stars.setAttribute("visible",t=="atmosphere"),t=="color"?(o.color=this.environmentData.skyColor,o.fog=!1):t=="gradient"&&(o.topColor=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace),o.bottomColor=new THREE.Color().setStyle(this.environmentData.horizonColor,THREE.NoColorSpace)),this.sky.setAttribute("material",o)}t=="atmosphere"&&(this.sky.setAttribute("material",{sunPosition:i}),this.setStars((1-Math.max(0,(i.y+.08)*8))*2e3)),this.environmentData.fog>0?this.el.sceneEl.setAttribute("fog",{color:this.getFogColor(t,i.y),far:(1.01-this.environmentData.fog)*this.STAGE_SIZE*2}):this.el.sceneEl.removeAttribute("fog"),this.sunlight.setAttribute("light",{type:this.environmentData.lighting=="point"?"point":"directional"}),this.sunlight.setAttribute("visible",this.environmentData.lighting!=="none"),this.hemilight.setAttribute("visible",this.environmentData.lighting!=="none");var c=!this.groundGeometry||this.environmentData.seed!=e.seed||this.environmentData.ground!=e.ground||this.environmentData.playArea!=e.playArea||this.environmentData.flatShading!=e.flatShading;(c||this.environmentData.groundColor!=e.groundColor||this.environmentData.groundColor2!=e.groundColor2||this.environmentData.groundYScale!=e.groundYScale||this.environmentData.groundTexture!=e.groundTexture||this.environmentData.gridColor!=e.gridColor||this.environmentData.grid!=e.grid)&&(this.updateGround(c),this.hemilight&&this.hemilight.setAttribute("light",{groundColor:this.environmentData.groundColor})),(this.environmentData.seed!=e.seed||this.environmentData.dressingOnPlayArea!=e.dressingOnPlayArea||this.environmentData.dressing!=e.dressing||this.environmentData.flatShading!=e.flatShading||this.environmentData.dressingAmount!=e.dressingAmount||this.environmentData.dressingScale!=e.dressingScale||this.environmentData.dressingColor!=e.dressingColor||this.environmentData.dressingVariance.x!=e.dressingVariance.x||this.environmentData.dressingVariance.y!=e.dressingVariance.y||this.environmentData.dressingVariance.z!=e.dressingVariance.z||this.environmentData.dressingUniformScale!=e.dressingUniformScale)&&this.updateDressing(),this.sky.setAttribute("visible",t!=="none"),this.el.setAttribute("visible",this.environmentData.active),this.environmentData.active||(this.userFog?this.el.sceneEl.setAttribute("fog",this.userFog):this.el.sceneEl.removeAttribute("fog")),this.dumpParametersDiff()},remove:function(){this.userFog?this.el.sceneEl.setAttribute("fog",this.userFog):this.el.sceneEl.removeAttribute("fog"),this.el.removeChild(this.hemilight),this.el.removeChild(this.sunlight),this.groundTexture&&this.groundTexture.dispose(),this.gridTexture&&this.gridTexture.dispose(),this.groundMaterial&&this.groundMaterial.dispose(),this.groundGeometry&&this.groundGeometry.dispose(),this.el.removeChild(this.ground);var n=this.dressing.getObject3D("mesh");if(n&&n.children.length>0&&(n.children[0].material.dispose(),n.children[0].geometry.dispose()),this.el.removeChild(this.dressing),this.el.removeChild(this.sky),this.stars){var e=this.stars.getObject3D("mesh");e.material.dispose(),e.geometry.dispose(),this.el.removeChild(this.stars)}},logPreset:function(){var n="{";for(var e in this.schema)if(e!="preset"){n+=e+": ";var t=this.schema[e].type;t=="vec3"?n+="{ x: "+this.environmentData[e].x+", y: "+this.environmentData[e].y+", z: "+this.environmentData[e].z+"}":t=="string"||t=="color"?n+='"'+this.environmentData[e]+'"':n+=this.environmentData[e],n+=", "}n+="}",console.log(n)},dumpParametersDiff:function(){function n(u){return Math.floor(u*1e3)/1e3}var e=[],t=this.data.preset!="none"?this.presets[this.data.preset]:!1;t&&e.push("preset: "+this.data.preset);for(var i in this.schema)if(!(i=="preset"||t&&t[i]===void 0)){var s=t?t[i]:this.schema[i].default,o=this.environmentData[i],c=this.schema[i].type;if(c=="vec3"){var l=s;typeof s=="string"&&(s=s.split(" "),l={x:s[0],y:s[1],z:s[2]}),(n(l.x)!=n(o.x)||n(l.y)!=n(o.y)||n(l.z)!=n(o.z))&&e.push(i+": "+n(o.x)+" "+n(o.y)+" "+n(o.z))}else s!=o&&(this.schema[i].type=="number"&&(o=n(o)),e.push(i+": "+o))}console.log("%c"+e.join("; "),"color: #f48;font-weight:bold")},random:function(n){return parseFloat("0."+Math.sin(this.environmentData.seed*9999*n).toString().substr(7))},updateGround:function(n){var e=64;if(n){var t=this.environmentData.ground!="none";if(this.ground.setAttribute("visible",t),!t)return;this.groundGeometry||(this.groundGeometry=new THREE.PlaneGeometry(this.STAGE_SIZE+2,this.STAGE_SIZE+2,e-1,e-1));for(var i=new Lp(this.environmentData.seed),s=this.groundGeometry.attributes.position.array,o=s.length,c=10,l=c/e,u=0,h=0,p=2;p<o;p+=3){if(this.environmentData.ground=="flat"){s[p]=0;continue}var f;switch(this.environmentData.ground){case"hills":{f=Math.max(0,i.noise(u,h,0));break}case"canyon":{f=.2+i.noise(u,h,0)*.8,f=Math.min(1,Math.pow(f,2)*10);break}case"spikes":{f=this.random(p)<.02?this.random(p+1):0;break}case"noise":{f=this.random(p)<.35?this.random(p+1):0;break}}f+=this.random(p+2)*.1;var m=u*2/c-1,A=h*2/c-1,y=this.environmentData.playArea;m=Math.max(0,Math.min(1,(Math.abs(m)-(y-.9))*(1/y))),A=Math.max(0,Math.min(1,(Math.abs(A)-(y-.9))*(1/y))),f*=m>A?m:A,f<.01&&(f=0),s[p]=f,u+=l,u>=10&&(u=0,h+=l)}this.groundGeometry.computeVertexNormals(),this.groundGeometry.attributes.position.needsUpdate=!0,this.groundGeometry.attributes.normal.needsUpdate=!0}this.ground.setAttribute("scale",{z:this.environmentData.groundYScale});var E=2048,x=20,v=this.STAGE_SIZE/x;(!this.groundCanvas||this.groundCanvas.width!=E)&&(this.gridCanvas=document.createElement("canvas"),this.gridCanvas.width=E,this.gridCanvas.height=E,this.gridTexture=new THREE.Texture(this.gridCanvas),this.gridTexture.wrapS=THREE.RepeatWrapping,this.gridTexture.wrapT=THREE.RepeatWrapping,this.gridTexture.repeat.set(v,v),this.gridTexture.anisotropy=4,this.rendererSystem.applyColorCorrection(this.gridTexture),this.groundCanvas=document.createElement("canvas"),this.groundCanvas.width=E,this.groundCanvas.height=E,this.groundTexture=new THREE.Texture(this.groundCanvas),this.groundTexture.wrapS=THREE.RepeatWrapping,this.groundTexture.wrapT=THREE.RepeatWrapping,this.groundTexture.repeat.set(v,v),this.groundTexture.anisotropy=4,this.rendererSystem.applyColorCorrection(this.groundTexture),this.groundMaterialProps={map:this.groundTexture,emissive:new THREE.Color(16777215),emissiveMap:this.gridTexture},this.groundMaterialProps.flatShading=this.environmentData.flatShading,this.groundMaterial=new THREE.MeshLambertMaterial(this.groundMaterialProps));var w=this.groundCanvas.getContext("2d"),M=this.gridCanvas.getContext("2d");if(this.drawTexture(w,E,x),M.fillStyle="#000000",M.fillRect(0,0,E,E),this.drawGrid(M,E,x),this.groundTexture.needsUpdate=!0,this.gridTexture.needsUpdate=!0,n){var T=new THREE.Mesh(this.groundGeometry,this.groundMaterial);this.ground.setObject3D("mesh",T)}else this.ground.getObject3D("mesh").material=this.groundMaterial;this.ground.setAttribute("shadow",{cast:!1,receive:this.environmentData.shadow})},drawGrid:function(n,e,t){if(this.environmentData.grid!="none"){var i=Math.floor(t/2),s=e/(t/2),o,c,l;switch(n.fillStyle=this.environmentData.gridColor,this.environmentData.grid){case"1x1":case"2x2":{for(this.environmentData.grid=="1x1"&&(i=i*2,s=e/t),o=0;o<i;o++)l=Math.floor(o*s),n.fillRect(0,l,e,1),n.fillRect(l,0,1,e);break}case"crosses":{var u=Math.floor(s/20);for(o=0;o<i+1;o++)for(l=Math.floor(o*s),c=0;c<i+1;c++){var h=Math.floor(-u+c*s);n.fillRect(h,l,u*2,1),n.fillRect(l,h,1,u*2)}break}case"dots":{for(o=0;o<i+1;o++)for(c=0;c<i+1;c++)n.beginPath(),n.arc(Math.floor(c*s),Math.floor(o*s),4,0,Math.PI*2),n.fill();break}case"xlines":{for(o=0;o<i;o++)n.fillRect(Math.floor(o*s),0,1,e);break}case"ylines":{for(o=0;o<i;o++)n.fillRect(0,Math.floor(o*s),e,1);break}}}},drawTexture:function(n,e,t){n.fillStyle=this.environmentData.groundColor,n.fillRect(0,0,e,e);var i,s,o,c,l,u,h;if(this.environmentData.groundTexture!="none")switch(this.environmentData.groundTexture){case"checkerboard":{n.fillStyle=this.environmentData.groundColor2;var p=Math.floor(t/2),f=e/(t/2);for(i=0;i<p+1;i+=2)for(var m=0;m<p+1;m++)n.fillRect(Math.floor((i+m%2)*f),Math.floor(m*f),Math.floor(f),Math.floor(f));break}case"squares":{var A=16,y=e/A;for(o=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),c=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace),i=0;i<A*A;i++)s=this.random(i+3)>.5?o.clone():c.clone(),s.addScalar(this.random(i+3)*.1-.05),n.fillStyle="#"+s.getHexString(THREE.NoColorSpace),n.fillRect(i%A*y,Math.floor(i/A)*y,y,y);break}case"noise":{u=n.getImageData(0,0,e,e),l=u.data,o=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),c=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace);var E=new THREE.Color(c.r-o.r,c.g-o.g,c.b-o.b),x=new Lp;for(i=0,m=0,h=l.length;i<h;i+=4,m++){var v=x.noise(m%e/e*3,m/e/e*3,0);l[i+0]=Math.floor((o.r+E.r*v)*255),l[i+1]=Math.floor((o.g+E.g*v)*255),l[i+2]=Math.floor((o.b+E.b*v)*255)}n.putImageData(u,0,0);break}case"walkernoise":{var w=Math.floor(e/2),M=document.createElement("canvas");M.width=w,M.height=w;var T=M.getContext("2d");T.fillStyle=this.environmentData.groundColor,T.fillRect(0,0,w,w),u=T.getImageData(0,0,w,w),l=u.data,o=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),c=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace);var D=[],L=1e3;for(i=0;i<L;i++)s=o.clone().lerp(c,Math.random()),D.push({x:Math.random()*w,y:Math.random()*w,r:Math.floor(s.r*255),g:Math.floor(s.g*255),b:Math.floor(s.b*255)});for(var I=5e3,F=0;F<I;F++)for(i=0;i<L;i++){var R=D[i],N=Math.floor(R.y*w+R.x)*4;l[N+0]=R.r,l[N+1]=R.g,l[N+2]=R.b,R.x+=Math.floor(Math.random()*3)-1,R.y+=Math.floor(Math.random()*3)-1,R.x>=w&&(R.x=R.x-w),R.y>=w&&(R.y=R.y-w),R.x<0&&(R.x=w+R.x),R.y<0&&(R.y=w+R.y)}T.putImageData(u,0,0),n.drawImage(M,0,0,e,e);break}}},getAssetGeometry:function(n){if(!n)return null;var e=[],t=this;function i(E,x){for(var v=new THREE.Vector3,w=E.attributes.position.array,M=w.length,T=0;T<M;T+=3)w[T]=(t.random(T)-.5)*x,w[T+1]=(t.random(T+M)-.5)*x,w[T+2]=(t.random(T+M*2)-.5)*x;E.attributes.position.needsUpdate=!0}for(var s,o,c,l=0;l<n.length;l++)if(n[l].type=="lathe"){var u=-99999,h=[];for(c=n[l].vertices,s=0;s<c.length;s+=2)h.push(new THREE.Vector2(c[s],c[s+1])),c[s+1]>u&&(u=c[s+1]);o=new THREE.LatheGeometry(h,n[l].segments||8),o.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-Math.PI,0,0))),o.applyMatrix4(new THREE.Matrix4().makeTranslation(0,u,0)),o=o.toNonIndexed(),e.push(o)}else if(n[l].type=="extrude"){var p=new THREE.Shape;for(c=n[l].vertices,s=0;s<c.length;s+=2)s==0?p.moveTo(c[s],c[s+1]):p.lineTo(c[s],c[s+1]);o=new THREE.ExtrudeGeometry(p,{amount:1,bevelEnabled:!1}),o.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-Math.PI/2,0,0))),n[l].noise&&i(o,n[l].noise),e.push(o)}else if(n[l].type=="mesh"){o=new THREE.BufferGeometry,c=n[l].vertices;var f=n[l].faces,m=new Float32Array(c);if(o.setIndex(f),o.setAttribute("position",new THREE.BufferAttribute(m,3)),n[l].mirror){var A=o.clone();A.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0,Math.PI,0)));var y=THREE.BufferGeometryUtils.mergeGeometries||THREE.BufferGeometryUtils.mergeBufferGeometries;o=y([o,A])}n[l].noise&&i(o,n[l].noise),o=o.toNonIndexed(),o.computeVertexNormals(),e.push(o)}return e},updateDressing:function(){var n=new THREE.Object3D,e=[];if(this.dressing.setAttribute("visible",this.environmentData.dressing!="none"),this.environmentData.dressing!="none"){var t;switch(this.environmentData.dressing){case"cubes":{t=[new THREE.BoxGeometry(1,1,1)],t[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break}case"pyramids":{t=[new THREE.ConeGeometry(1,1,4,1,!0)],t[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break}case"cylinders":{t=[new THREE.CylinderGeometry(.5,.5,1,8,1,!0)],t[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break}default:{if(t=this.getAssetGeometry(this.assets[this.environmentData.dressing]),!t)return;break}}for(var i=0,s=88343;i<this.environmentData.dressingAmount;i++,s++){var o=t[Math.floor(this.random(33+i)*t.length)].clone(),c=this.environmentData.dressingScale,l=new THREE.Vector3(this.environmentData.dressingVariance.x,this.environmentData.dressingVariance.y,this.environmentData.dressingVariance.z),u,h=this.random(s)<this.environmentData.dressingOnPlayArea;h?u=this.random(s+1)*15:u=10+Math.max(l.x,l.z)+10*this.random(s+1)+this.random(s+2)*this.STAGE_SIZE/3;var p=this.random(s+3)*Math.PI*2,f=new THREE.Matrix4,m=this.random(s+4),A=this.environmentData.dressingUniformScale;f.compose(new THREE.Vector3(Math.cos(p)*u,0,Math.sin(p)*u),new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),(this.random(s+5)-.5)*l.length()*Math.PI*2),new THREE.Vector3(c+(A?m:this.random(s+6))*l.x,c+(A?m:this.random(s+7))*l.y,c+(A?m:this.random(s+8))*l.z)),o.applyMatrix4(f),e.push(o)}var y=THREE.BufferGeometryUtils.mergeGeometries||THREE.BufferGeometryUtils.mergeBufferGeometries,E=y(e);E.attributes.position.needsUpdate=!0;var x=new THREE.MeshLambertMaterial({color:new THREE.Color(this.environmentData.dressingColor)});this.rendererSystem.applyColorCorrection(x.color);var v=new THREE.Mesh(E,x);n.add(v),this.dressing.setObject3D("mesh",n)}},createStars:function(){for(var n=2e3,e=new THREE.BufferGeometry,t=new Float32Array(n*3),i=this.STAGE_SIZE-1,s=new THREE.Vector3,o=0;o<t.length;o+=3)s.set(this.random(o+23)-.5,this.random(o+24),this.random(o+25)-.5),s.normalize(),s.multiplyScalar(i),t[o]=s.x,t[o+1]=s.y,t[o+2]=s.z;e.setAttribute("position",new THREE.BufferAttribute(t,3)),e.setDrawRange(0,0);var c=new THREE.PointsMaterial({size:.01,color:13421772,fog:!1});this.rendererSystem.applyColorCorrection(c.color),this.stars.setObject3D("mesh",new THREE.Points(e,c))},setStars:function(n){this.stars||(this.stars=document.createElement("a-entity"),this.stars.id="stars",this.createStars(),this.el.appendChild(this.stars)),n=Math.floor(Math.min(2e3,Math.max(0,n))),this.stars.getObject3D("mesh").geometry.setDrawRange(0,n)}});AFRAME.registerShader("skyshader",{schema:{exposureBias:{type:"number",default:1,min:0,max:10,is:"uniform"},turbidity:{type:"number",default:2,min:0,max:20,is:"uniform"},reileigh:{type:"number",default:1,min:0,max:4,is:"uniform"},mieCoefficient:{type:"number",default:.005,min:0,max:.1,is:"uniform"},mieDirectionalG:{type:"number",default:.8,min:0,max:1,is:"uniform"},sunPosition:{type:"vec3",default:{x:0,y:0,z:-1},is:"uniform"},color:{type:"color",default:"#fff"}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <dithering_pars_fragment>","uniform sampler2D skySampler;","uniform vec3 sunPosition;","varying vec3 vWorldPosition;","vec3 cameraPos = vec3(0., 0., 0.);","uniform float exposureBias;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float pn = 0.035;","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3(0.0, 1.0, 0.0);","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{   ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(sunPosition);","float sunE = sunIntensity(dot(sunDirection, up));","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","vec3 Fex = exp(-(betaR * sR + betaM * sM));","float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));","vec3 direction = normalize(vWorldPosition - cameraPos);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","vec3 L0 = vec3(0.1) * Fex;","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);","texColor *= 0.04;","texColor += vec3(0.0,0.001,0.0025)*0.3;","vec3 curr = Uncharted2Tonemap(exposureBias*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1.0;","#include <dithering_fragment>","}"].join(`
`)});AFRAME.registerShader("gradientshader",{schema:{topColor:{type:"color",default:"1 0 0",is:"uniform"},bottomColor:{type:"color",default:"0 0 1",is:"uniform"}},vertexShader:["varying vec3 vWorldPosition;","void main() {"," vec4 worldPosition = modelMatrix * vec4( position, 1.0 );"," vWorldPosition = worldPosition.xyz;"," gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <dithering_pars_fragment>","uniform vec3 bottomColor;","uniform vec3 topColor;","uniform float offset;","varying vec3 vWorldPosition;","void main() {"," float h = normalize( vWorldPosition ).y;"," gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max(h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," #include <dithering_fragment>","}"].join(`
`)});var Lp=function(n){var e;this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];var t;for(t=0;t<256;t++)e=parseFloat("0."+Math.sin(n*9999*t).toString().substr(7)),this.p[t]=Math.floor(e*256);for(this.perm=[],t=0;t<512;t++)this.perm[t]=this.p[t&255]};Lp.prototype.dot=function(n,e,t,i){return n[0]*e+n[1]*t+n[2]*i};Lp.prototype.mix=function(n,e,t){return(1-t)*n+t*e};Lp.prototype.fade=function(n){return n*n*n*(n*(n*6-15)+10)};Lp.prototype.noise=function(n,e,t){var i=Math.floor(n),s=Math.floor(e),o=Math.floor(t);n=n-i,e=e-s,t=t-o,i=i&255,s=s&255,o=o&255;var c=this.perm[i+this.perm[s+this.perm[o]]]%12,l=this.perm[i+this.perm[s+this.perm[o+1]]]%12,u=this.perm[i+this.perm[s+1+this.perm[o]]]%12,h=this.perm[i+this.perm[s+1+this.perm[o+1]]]%12,p=this.perm[i+1+this.perm[s+this.perm[o]]]%12,f=this.perm[i+1+this.perm[s+this.perm[o+1]]]%12,m=this.perm[i+1+this.perm[s+1+this.perm[o]]]%12,A=this.perm[i+1+this.perm[s+1+this.perm[o+1]]]%12,y=this.dot(this.grad3[c],n,e,t),E=this.dot(this.grad3[p],n-1,e,t),x=this.dot(this.grad3[u],n,e-1,t),v=this.dot(this.grad3[m],n-1,e-1,t),w=this.dot(this.grad3[l],n,e,t-1),M=this.dot(this.grad3[f],n-1,e,t-1),T=this.dot(this.grad3[h],n,e-1,t-1),D=this.dot(this.grad3[A],n-1,e-1,t-1),L=this.fade(n),I=this.fade(e),F=this.fade(t),R=this.mix(y,E,L),N=this.mix(w,M,L),X=this.mix(x,v,L),$=this.mix(T,D,L),te=this.mix(R,X,I),U=this.mix(N,$,I),P=this.mix(te,U,F);return P};var poe=["test"],a4=(()=>{let e=class e{ngAfterViewInit(){}constructor(){this.isAnimationPlaying=!1}playAndPauseAnimation(){let i=this.myModelEntity?.nativeElement;console.log(i.components),this.isAnimationPlaying?i.setAttribute("animation-mixer",{clip:"none"}):i.setAttribute("animation-mixer",{clip:"*"}),this.isAnimationPlaying=!this.isAnimationPlaying}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=yv({type:e,selectors:[["app-root"]],viewQuery:function(s,o){if(s&1&&EL(poe,5),s&2){let c;iM(c=rM())&&(o.myModelEntity=c.first)}},standalone:!0,features:[wL([{provide:Document,useValue:Document}]),Lv],decls:10,vars:1,consts:[[1,"button",3,"click"],["inspector","url: https://cdn.jsdelivr.net/gh/aframevr/aframe-inspector@master/dist/aframe-inspector.min.js"],["src","assets/rail.glb","scale","1 1 1","position","0 0 -5","clickable","","animation-mixer","clip: none;"],["test",""],["sun-position","1 0.4 0"],["look-controls","","wasd-controls","","position","5 1.6 0","rotation","0 0 0"],["hand-controls","hand: left"],["hand-controls","hand: right"],["environment","flatShading: true;ground: flat;seed: 3"]],template:function(s,o){s&1&&(Fm(0,"button",0),Dv("click",function(){return o.playAndPauseAnimation()}),_L(1),Um(),Fm(2,"a-scene",1),km(3,"a-gltf-model",2,3)(5,"a-simple-sun-sky",4)(6,"a-camera",5)(7,"a-entity",6)(8,"a-entity",7)(9,"a-entity",8),Um()),s&2&&(KD(),sM(o.isAnimationPlaying?"Pause":"Play"))},dependencies:[hM],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100vh}.button[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px;z-index:10;background:#fff;padding:10px;width:100px}"]});let n=e;return n})();qL(a4,DP).catch(n=>console.error(n));
